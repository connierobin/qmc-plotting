Rank =    0  Free Memory = 71039 MB
Rank =    1  Free Memory = 71038 MB
Rank =    2  Free Memory = 71038 MB
Rank =    3  Free Memory = 71038 MB
Rank =    4  Free Memory = 71038 MB
Rank =    5  Free Memory = 71038 MB
Rank =    6  Free Memory = 71037 MB
Rank =    7  Free Memory = 71036 MB
Rank =    8  Free Memory = 71036 MB
Rank =    9  Free Memory = 71036 MB
Rank =   10  Free Memory = 71036 MB
Rank =   11  Free Memory = 71036 MB
Rank =   12  Free Memory = 71036 MB
Rank =   13  Free Memory = 71036 MB
Rank =   14  Free Memory = 71036 MB
Rank =   15  Free Memory = 71023 MB
Rank =   16  Free Memory = 71022 MB
Rank =   17  Free Memory = 71022 MB
Rank =   18  Free Memory = 71022 MB
Rank =   19  Free Memory = 71022 MB
Rank =   20  Free Memory = 71022 MB
Rank =   21  Free Memory = 71022 MB
Rank =   22  Free Memory = 71022 MB
Rank =   23  Free Memory = 71022 MB
Rank =   24  Free Memory = 71022 MB
Rank =   25  Free Memory = 71022 MB
Rank =   26  Free Memory = 71022 MB
Rank =   27  Free Memory = 71022 MB
Rank =   28  Free Memory = 71022 MB
Rank =   29  Free Memory = 71022 MB
Rank =   30  Free Memory = 71022 MB
Rank =   31  Free Memory = 71022 MB
Rank =   32  Free Memory = 73091 MB
Rank =   33  Free Memory = 73091 MB
Rank =   34  Free Memory = 73090 MB
Rank =   35  Free Memory = 73090 MB
Rank =   36  Free Memory = 73090 MB
Rank =   37  Free Memory = 73090 MB
Rank =   38  Free Memory = 73090 MB
Rank =   39  Free Memory = 73090 MB
Rank =   40  Free Memory = 73090 MB
Rank =   41  Free Memory = 73090 MB
Rank =   42  Free Memory = 73090 MB
Rank =   43  Free Memory = 73090 MB
Rank =   44  Free Memory = 73090 MB
Rank =   45  Free Memory = 73090 MB
Rank =   46  Free Memory = 73089 MB
Rank =   47  Free Memory = 73089 MB
Rank =   48  Free Memory = 73089 MB
Rank =   49  Free Memory = 73089 MB
Rank =   50  Free Memory = 73089 MB
Rank =   51  Free Memory = 73089 MB
Rank =   52  Free Memory = 73089 MB
Rank =   53  Free Memory = 73089 MB
Rank =   54  Free Memory = 73089 MB
Rank =   55  Free Memory = 73089 MB
Rank =   56  Free Memory = 73089 MB
Rank =   57  Free Memory = 73089 MB
Rank =   58  Free Memory = 73089 MB
Rank =   59  Free Memory = 73089 MB
Rank =   60  Free Memory = 73089 MB
Rank =   61  Free Memory = 73089 MB
Rank =   62  Free Memory = 73089 MB
Rank =   63  Free Memory = 73089 MB
Rank =   64  Free Memory = 89679 MB
Rank =   65  Free Memory = 89679 MB
Rank =   66  Free Memory = 89679 MB
Rank =   67  Free Memory = 89679 MB
Rank =   68  Free Memory = 89679 MB
Rank =   69  Free Memory = 89679 MB
Rank =   70  Free Memory = 89679 MB
Rank =   71  Free Memory = 89679 MB
Rank =   72  Free Memory = 89679 MB
Rank =   73  Free Memory = 89679 MB
Rank =   74  Free Memory = 89679 MB
Rank =   75  Free Memory = 89679 MB
Rank =   76  Free Memory = 89679 MB
Rank =   77  Free Memory = 89679 MB
Rank =   78  Free Memory = 89679 MB
Rank =   79  Free Memory = 89679 MB
Rank =   80  Free Memory = 89679 MB
Rank =   81  Free Memory = 89679 MB
Rank =   82  Free Memory = 89679 MB
Rank =   83  Free Memory = 89678 MB
Rank =   84  Free Memory = 89678 MB
Rank =   85  Free Memory = 89678 MB
Rank =   86  Free Memory = 89678 MB
Rank =   87  Free Memory = 89678 MB
Rank =   88  Free Memory = 89678 MB
Rank =   89  Free Memory = 89678 MB
Rank =   90  Free Memory = 89678 MB
Rank =   91  Free Memory = 89678 MB
Rank =   92  Free Memory = 89678 MB
Rank =   93  Free Memory = 89678 MB
Rank =   94  Free Memory = 89678 MB
Rank =   95  Free Memory = 89678 MB
Rank =   96  Free Memory = 62910 MB
Rank =   97  Free Memory = 62910 MB
Rank =   98  Free Memory = 62910 MB
Rank =   99  Free Memory = 62910 MB
Rank =  100  Free Memory = 62910 MB
Rank =  101  Free Memory = 62910 MB
Rank =  102  Free Memory = 62910 MB
Rank =  103  Free Memory = 62910 MB
Rank =  104  Free Memory = 62910 MB
Rank =  105  Free Memory = 62910 MB
Rank =  106  Free Memory = 62910 MB
Rank =  107  Free Memory = 62910 MB
Rank =  108  Free Memory = 62910 MB
Rank =  109  Free Memory = 62910 MB
Rank =  110  Free Memory = 62910 MB
Rank =  111  Free Memory = 62910 MB
Rank =  112  Free Memory = 62910 MB
Rank =  113  Free Memory = 62910 MB
Rank =  114  Free Memory = 62910 MB
Rank =  115  Free Memory = 62910 MB
Rank =  116  Free Memory = 62910 MB
Rank =  117  Free Memory = 62910 MB
Rank =  118  Free Memory = 62910 MB
Rank =  119  Free Memory = 62910 MB
Rank =  120  Free Memory = 62910 MB
Rank =  121  Free Memory = 62910 MB
Rank =  122  Free Memory = 62910 MB
Rank =  123  Free Memory = 62910 MB
Rank =  124  Free Memory = 62910 MB
Rank =  125  Free Memory = 62910 MB
Rank =  126  Free Memory = 62910 MB
Rank =  127  Free Memory = 62910 MB
  Input file(s): opt_h2o_1b1_lmc_run001d.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: a1d851bbe8d902a0d3168a885b757a378aeaab54-dirty
  Last git commit date: Mon Feb 13 11:52:39 2023 -0800
  Last git commit subject: Print param update magnitude and largest update
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_1b1_lmc_run001d.xml

  Project = H2O
  date    = 2023-03-03 17:43:29 PST
  host    = n0082.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 577

  Range of prime numbers to use as seeds over processors and threads = 4229-5347


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 3.124302e-01    1         1  ON     0
     uu_1                 1.450253e-01    1         1  ON     1
     uu_2                 4.329183e-02    1         1  ON     2
     uu_3                -1.940605e-02    1         1  ON     3
     uu_4                -6.554892e-02    1         1  ON     4
     uu_5                -1.008264e-01    1         1  ON     5
     uu_6                -1.286163e-01    1         1  ON     6
     uu_7                -1.425313e-01    1         1  ON     7
     uu_8                -1.353611e-01    1         1  ON     8
     uu_9                -1.041471e-01    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 4.474179e-01    1         1  ON     0
     ud_1                 1.818415e-01    1         1  ON     1
     ud_2                 6.170293e-02    1         1  ON     2
     ud_3                -9.177585e-03    1         1  ON     3
     ud_4                -6.613992e-02    1         1  ON     4
     ud_5                -1.078031e-01    1         1  ON     5
     ud_6                -1.350654e-01    1         1  ON     6
     ud_7                -1.517254e-01    1         1  ON     7
     ud_8                -1.527923e-01    1         1  ON     8
     ud_9                -1.409331e-01    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -7.511564e-01    1         1  ON     0
     eO_1                -4.308196e-01    1         1  ON     1
     eO_2                -2.032148e-02    1         1  ON     2
     eO_3                 2.923260e-01    1         1  ON     3
     eO_4                 5.175077e-01    1         1  ON     4
     eO_5                 4.796197e-01    1         1  ON     5
     eO_6                 2.531149e-01    1         1  ON     6
     eO_7                -4.492298e-02    1         1  ON     7
     eO_8                -2.171485e-01    1         1  ON     8
     eO_9                -7.834457e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -2.543004e-01    1         1  ON     0
     eH1_1                -1.470866e-01    1         1  ON     1
     eH1_2                -9.771609e-02    1         1  ON     2
     eH1_3                -4.262487e-02    1         1  ON     3
     eH1_4                 6.775009e-03    1         1  ON     4
     eH1_5                 4.185569e-02    1         1  ON     5
     eH1_6                 1.016531e-01    1         1  ON     6
     eH1_7                 1.560049e-01    1         1  ON     7
     eH1_8                 1.756587e-01    1         1  ON     8
     eH1_9                 6.246097e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -2.516782e-01    1         1  ON     0
     eH2_1                -1.445551e-01    1         1  ON     1
     eH2_2                -9.509182e-02    1         1  ON     2
     eH2_3                -3.988988e-02    1         1  ON     3
     eH2_4                 9.976176e-03    1         1  ON     4
     eH2_5                 4.508373e-02    1         1  ON     5
     eH2_6                 1.037552e-01    1         1  ON     6
     eH2_7                 1.568652e-01    1         1  ON     7
     eH2_8                 1.806498e-01    1         1  ON     8
     eH2_9                 5.052010e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 75 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 9.936808e-01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 30 unique up determinants.
Found 30 unique down determinants.
Number of terms in pairs array: 20
Number of terms in pairs array: 20
CI coefficients are optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 1.9944e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u  6.1002844054e-01  1.3250453608e-01 -4.2267217978e-01
    u -4.3494847795e-01 -2.3203549626e-01  1.0876787134e-01
    u -1.5984350305e-01  8.1842956548e-01  5.1837161342e-02
    u  1.1948334779e+00  1.4453040952e+00  1.6346730752e+00
    d -9.5054657961e-01  2.3768909128e-01 -6.0876959125e-01
    d -2.0429807517e-01  1.5546410594e+00 -1.0292769217e-01
    d  4.7451519973e-01  3.4811618685e-02  3.5425821429e-01
    d -8.6403568621e-02 -1.8286319639e+00  9.9844026831e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 100
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 124
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.8899
    reference variance = 0.282795
====================================================
  Execution time = 2.4720e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5303e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3774e-01
  Total weights = 1.951712855e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.2458e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324166471424
                                         uncertainty =       0.001942420169

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324166471424
                                         uncertainty =       0.001942420169

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402604940
  error estimate for blocks of size 2^( 2) =       0.000415576722
  error estimate for blocks of size 2^( 3) =       0.000428781483
  error estimate for blocks of size 2^( 4) =       0.000440762355
  error estimate for blocks of size 2^( 5) =       0.000452332821
  error estimate for blocks of size 2^( 6) =       0.000461512383
  error estimate for blocks of size 2^( 7) =       0.000465952190

      target function =                  N/A
              le_mean =     -16.906349986463
             les_mean =     286.162409031036
             stat err =       0.000455139937
             autocorr =       1.278002465597
              std dev =       0.569369366585
             le_variance =       0.324181475605


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.690634998646e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906349986466       residual = 2.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906366392730       residual = 3.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906368297879       residual = 5.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906371024007       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906370221222       residual = 5.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906372343280       residual = 4.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906373035291       residual = 2.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906372748447       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906372208776       residual = 8.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906372059745       residual = 2.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906371986760       residual = 7.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.5000e-01 is 1.028258e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906349986466       residual = 2.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906356284195       residual = 2.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906356788961       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906358025260       residual = 9.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906358057890       residual = 4.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906358625088       residual = 3.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906358916018       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906358873857       residual = 5.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906358678930       residual = 2.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906358653384       residual = 5.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.0000e+00 is 3.582258e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906349986466       residual = 2.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906351804224       residual = 2.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906351933213       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906352301335       residual = 9.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906352359605       residual = 5.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906352542992       residual = 3.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906352610759       residual = 9.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906352627806       residual = 3.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906352576396       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906352566655       residual = 3.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 4.0000e+00 is 1.073281e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.026434 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0997e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0    3.124504e-01                 1 1 ON  0
uu_1    1.449995e-01                 1 1 ON  1
uu_2    4.333523e-02                 1 1 ON  2
uu_3    -1.941119e-02                1 1 ON  3
uu_4    -6.552532e-02                1 1 ON  4
uu_5    -1.008409e-01                1 1 ON  5
uu_6    -1.286537e-01                1 1 ON  6
uu_7    -1.426442e-01                1 1 ON  7
uu_8    -1.354623e-01                1 1 ON  8
uu_9    -1.042506e-01                1 1 ON  9
ud_0    4.476130e-01                 1 1 ON  10
ud_1    1.817802e-01                 1 1 ON  11
ud_2    6.170679e-02                 1 1 ON  12
ud_3    -9.156534e-03                1 1 ON  13
ud_4    -6.609093e-02                1 1 ON  14
ud_5    -1.077845e-01                1 1 ON  15
ud_6    -1.350550e-01                1 1 ON  16
ud_7    -1.517994e-01                1 1 ON  17
ud_8    -1.528313e-01                1 1 ON  18
ud_9    -1.409981e-01                1 1 ON  19
eO_0    -7.511618e-01                1 1 ON  20
eO_1    -4.307473e-01                1 1 ON  21
eO_2    -2.036549e-02                1 1 ON  22
eO_3    2.923197e-01                 1 1 ON  23
eO_4    5.175482e-01                 1 1 ON  24
eO_5    4.796895e-01                 1 1 ON  25
eO_6    2.531994e-01                 1 1 ON  26
eO_7    -4.492513e-02                1 1 ON  27
eO_8    -2.172505e-01                1 1 ON  28
eO_9    -7.844079e-02                1 1 ON  29
eH1_0   -2.543987e-01                1 1 ON  30
eH1_1   -1.471888e-01                1 1 ON  31
eH1_2   -9.777464e-02                1 1 ON  32
eH1_3   -4.264771e-02                1 1 ON  33
eH1_4   6.784089e-03                 1 1 ON  34
eH1_5   4.186634e-02                 1 1 ON  35
eH1_6   1.015976e-01                 1 1 ON  36
eH1_7   1.559720e-01                 1 1 ON  37
eH1_8   1.757557e-01                 1 1 ON  38
eH1_9   6.267385e-02                 1 1 ON  39
eH2_0   -2.517468e-01                1 1 ON  40
eH2_1   -1.445470e-01                1 1 ON  41
eH2_2   -9.518564e-02                1 1 ON  42
eH2_3   -3.992630e-02                1 1 ON  43
eH2_4   9.909109e-03                 1 1 ON  44
eH2_5   4.509585e-02                 1 1 ON  45
eH2_6   1.036545e-01                 1 1 ON  46
eH2_7   1.569475e-01                 1 1 ON  47
eH2_8   1.807393e-01                 1 1 ON  48
eH2_9   5.068556e-02                 1 1 ON  49
ci_0001 7.003490e-01                 3 1 ON  50
ci_0002 7.015226e-01                 3 1 ON  51
ci_0003 -2.695404e-02                3 1 ON  52
ci_0004 -2.783542e-02                3 1 ON  53
ci_0005 -3.571194e-02                3 1 ON  54
ci_0006 -3.654937e-02                3 1 ON  55
ci_0007 -2.192097e-02                3 1 ON  56
ci_0008 -2.210258e-02                3 1 ON  57
ci_0009 -1.765697e-02                3 1 ON  58
ci_0010 -1.730832e-02                3 1 ON  59
ci_0011 -1.248742e-02                3 1 ON  60
ci_0012 -1.178456e-02                3 1 ON  61
ci_0013 1.320882e-02                 3 1 ON  62
ci_0014 1.292760e-02                 3 1 ON  63
ci_0015 1.237690e-02                 3 1 ON  64
ci_0016 1.306335e-02                 3 1 ON  65
ci_0017 1.111905e-02                 3 1 ON  66
ci_0018 1.148993e-02                 3 1 ON  67
ci_0019 1.132698e-02                 3 1 ON  68
ci_0020 1.168112e-02                 3 1 ON  69
ci_0021 -3.489699e-04                3 1 ON  70
ci_0022 -7.251891e-04                3 1 ON  71
ci_0023 -1.170600e-02                3 1 ON  72
ci_0024 -1.058094e-02                3 1 ON  73
ci_0025 -1.023602e-02                3 1 ON  74
ci_0026 -1.098385e-02                3 1 ON  75
ci_0027 -1.118918e-02                3 1 ON  76
ci_0028 -1.141407e-02                3 1 ON  77
ci_0029 -1.087140e-02                3 1 ON  78
ci_0030 -1.031460e-02                3 1 ON  79
ci_0031 2.080180e-02                 3 1 ON  80
ci_0032 2.118548e-02                 3 1 ON  81
ci_0033 8.362247e-03                 3 1 ON  82
ci_0034 1.026323e-02                 3 1 ON  83
ci_0035 6.915182e-03                 3 1 ON  84
ci_0036 6.657559e-03                 3 1 ON  85
ci_0037 -1.066356e-02                3 1 ON  86
ci_0038 -1.077458e-02                3 1 ON  87
ci_0039 -2.754737e-03                3 1 ON  88
ci_0040 -2.686361e-03                3 1 ON  89
ci_0041 6.480669e-03                 3 1 ON  90
ci_0042 6.890666e-03                 3 1 ON  91
ci_0043 -1.781908e-02                3 1 ON  92
ci_0044 -1.812130e-02                3 1 ON  93
ci_0045 7.072423e-03                 3 1 ON  94
ci_0046 7.928493e-03                 3 1 ON  95
ci_0047 -1.765340e-03                3 1 ON  96
ci_0048 -1.555599e-03                3 1 ON  97
ci_0049 -4.913509e-03                3 1 ON  98
ci_0050 -5.383668e-03                3 1 ON  99
ci_0051 -3.581039e-03                3 1 ON  100
ci_0052 -3.600039e-03                3 1 ON  101
ci_0053 -4.559211e-03                3 1 ON  102
ci_0054 -4.677667e-03                3 1 ON  103
ci_0055 7.037216e-03                 3 1 ON  104
ci_0056 7.009891e-03                 3 1 ON  105
ci_0057 4.393482e-03                 3 1 ON  106
ci_0058 5.061285e-03                 3 1 ON  107
ci_0059 -4.485095e-03                3 1 ON  108
ci_0060 -5.017783e-03                3 1 ON  109
ci_0061 -2.495093e-03                3 1 ON  110
ci_0062 -3.337005e-03                3 1 ON  111
ci_0063 -9.831336e-03                3 1 ON  112
ci_0064 -8.624350e-03                3 1 ON  113
ci_0065 -5.137935e-03                3 1 ON  114
ci_0066 -5.382138e-03                3 1 ON  115
ci_0067 -4.808727e-03                3 1 ON  116
ci_0068 -5.298118e-03                3 1 ON  117
ci_0069 4.913375e-03                 3 1 ON  118
ci_0070 4.306445e-03                 3 1 ON  119
ci_0071 3.080653e-04                 3 1 ON  120
ci_0072 4.638623e-04                 3 1 ON  121
ci_0073 4.187943e-03                 3 1 ON  122
ci_0074 4.197574e-03                 3 1 ON  123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.902
    reference variance = 0.229519
====================================================
  Execution time = 2.0942e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3818e-01
  Total weights = 1.9517e+06
  Execution time = 1.9131e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322974903253
                                         uncertainty =       0.002013030947

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322974903253
                                         uncertainty =       0.002013030947

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401822454
  error estimate for blocks of size 2^( 2) =       0.000414819375
  error estimate for blocks of size 2^( 3) =       0.000427902393
  error estimate for blocks of size 2^( 4) =       0.000441713610
  error estimate for blocks of size 2^( 5) =       0.000454352546
  error estimate for blocks of size 2^( 6) =       0.000464806181
  error estimate for blocks of size 2^( 7) =       0.000469506055

      target function =                  N/A
              le_mean =     -16.906021793263
             les_mean =     286.152549360105
             stat err =       0.000457594598
             autocorr =       1.296860832760
              std dev =       0.568262764398
             le_variance =       0.322922569402

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323366539362
                                         uncertainty =       0.002028583711

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323366539362
                                         uncertainty =       0.002028583711

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402065764
  error estimate for blocks of size 2^( 2) =       0.000415040503
  error estimate for blocks of size 2^( 3) =       0.000428101429
  error estimate for blocks of size 2^( 4) =       0.000441908735
  error estimate for blocks of size 2^( 5) =       0.000454520684
  error estimate for blocks of size 2^( 6) =       0.000465002478
  error estimate for blocks of size 2^( 7) =       0.000469736360

      target function =                  N/A
              le_mean =     -16.906033228026
             les_mean =     286.153904983711
             stat err =       0.000457792064
             autocorr =       1.296409880898
              std dev =       0.568606855826
             le_variance =       0.323313756492

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323370500756
                                         uncertainty =       0.002021764927

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323370500756
                                         uncertainty =       0.002021764927

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402068322
  error estimate for blocks of size 2^( 2) =       0.000415044798
  error estimate for blocks of size 2^( 3) =       0.000428108737
  error estimate for blocks of size 2^( 4) =       0.000441914054
  error estimate for blocks of size 2^( 5) =       0.000454529525
  error estimate for blocks of size 2^( 6) =       0.000465003125
  error estimate for blocks of size 2^( 7) =       0.000469727292

      target function =                  N/A
              le_mean =     -16.906026109960
             les_mean =     286.156503817537
             stat err =       0.000457793499
             autocorr =       1.296401511674
              std dev =       0.568610473306
             le_variance =       0.323317870354

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323028468956
                                         uncertainty =       0.002013734111

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323028468956
                                         uncertainty =       0.002013734111

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401855761
  error estimate for blocks of size 2^( 2) =       0.000414849764
  error estimate for blocks of size 2^( 3) =       0.000427929711
  error estimate for blocks of size 2^( 4) =       0.000441739672
  error estimate for blocks of size 2^( 5) =       0.000454374657
  error estimate for blocks of size 2^( 6) =       0.000464831500
  error estimate for blocks of size 2^( 7) =       0.000469534022

      target function =                  N/A
              le_mean =     -16.906021049494
             les_mean =     286.152030683271
             stat err =       0.000457619963
             autocorr =       1.296789620262
              std dev =       0.568309867416
             le_variance =       0.322976105402


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906021793263        initial
     2.5000e-01     2.5000e+00             1.0283e-03       -16.906033228026  <--
     1.0000e+00     1.0000e+01             3.5823e-04       -16.906026109960
     4.0000e+00     4.0000e+01             1.0733e-04       -16.906021049494

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 3.0584e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
   uu_0                 3.124846e-01 1 1  ON 0
   uu_1                 1.449847e-01 1 1  ON 1
   uu_2                 4.339889e-02 1 1  ON 2
   uu_3                -1.938764e-02 1 1  ON 3
   uu_4                -6.550288e-02 1 1  ON 4
   uu_5                -1.008936e-01 1 1  ON 5
   uu_6                -1.287601e-01 1 1  ON 6
   uu_7                -1.429367e-01 1 1  ON 7
   uu_8                -1.357592e-01 1 1  ON 8
   uu_9                -1.045630e-01 1 1  ON 9
   ud_0                 4.478523e-01 1 1  ON 10
   ud_1                 1.817983e-01 1 1  ON 11
   ud_2                 6.175817e-02 1 1  ON 12
   ud_3                -9.073188e-03 1 1  ON 13
   ud_4                -6.597552e-02 1 1  ON 14
   ud_5                -1.077107e-01 1 1  ON 15
   ud_6                -1.350131e-01 1 1  ON 16
   ud_7                -1.519352e-01 1 1  ON 17
   ud_8                -1.529403e-01 1 1  ON 18
   ud_9                -1.411988e-01 1 1  ON 19
   eO_0                -7.511557e-01 1 1  ON 20
   eO_1                -4.306584e-01 1 1  ON 21
   eO_2                -2.040833e-02 1 1  ON 22
   eO_3                 2.922837e-01 1 1  ON 23
   eO_4                 5.176893e-01 1 1  ON 24
   eO_5                 4.799149e-01 1 1  ON 25
   eO_6                 2.534491e-01 1 1  ON 26
   eO_7                -4.492983e-02 1 1  ON 27
   eO_8                -2.175575e-01 1 1  ON 28
   eO_9                -7.872936e-02 1 1  ON 29
  eH1_0                -2.547132e-01 1 1  ON 30
  eH1_1                -1.474388e-01 1 1  ON 31
  eH1_2                -9.794032e-02 1 1  ON 32
  eH1_3                -4.273943e-02 1 1  ON 33
  eH1_4                 6.785441e-03 1 1  ON 34
  eH1_5                 4.189808e-02 1 1  ON 35
  eH1_6                 1.014463e-01 1 1  ON 36
  eH1_7                 1.558745e-01 1 1  ON 37
  eH1_8                 1.760398e-01 1 1  ON 38
  eH1_9                 6.330654e-02 1 1  ON 39
  eH2_0                -2.519567e-01 1 1  ON 40
  eH2_1                -1.446314e-01 1 1  ON 41
  eH2_2                -9.538959e-02 1 1  ON 42
  eH2_3                -4.005401e-02 1 1  ON 43
  eH2_4                 9.748885e-03 1 1  ON 44
  eH2_5                 4.511843e-02 1 1  ON 45
  eH2_6                 1.033817e-01 1 1  ON 46
  eH2_7                 1.571949e-01 1 1  ON 47
  eH2_8                 1.810081e-01 1 1  ON 48
  eH2_9                 5.117878e-02 1 1  ON 49
ci_0001                 7.004247e-01 3 1  ON 50
ci_0002                 7.014840e-01 3 1  ON 51
ci_0003                -2.713137e-02 3 1  ON 52
ci_0004                -2.739285e-02 3 1  ON 53
ci_0005                -3.535557e-02 3 1  ON 54
ci_0006                -3.622661e-02 3 1  ON 55
ci_0007                -2.210327e-02 3 1  ON 56
ci_0008                -2.194592e-02 3 1  ON 57
ci_0009                -1.770698e-02 3 1  ON 58
ci_0010                -1.757681e-02 3 1  ON 59
ci_0011                -1.251251e-02 3 1  ON 60
ci_0012                -1.139228e-02 3 1  ON 61
ci_0013                 1.325975e-02 3 1  ON 62
ci_0014                 1.285654e-02 3 1  ON 63
ci_0015                 1.235376e-02 3 1  ON 64
ci_0016                 1.294813e-02 3 1  ON 65
ci_0017                 1.134247e-02 3 1  ON 66
ci_0018                 1.165702e-02 3 1  ON 67
ci_0019                 1.156300e-02 3 1  ON 68
ci_0020                 1.152383e-02 3 1  ON 69
ci_0021                -1.697288e-04 3 1  ON 70
ci_0022                -1.304018e-03 3 1  ON 71
ci_0023                -1.175779e-02 3 1  ON 72
ci_0024                -1.103001e-02 3 1  ON 73
ci_0025                -1.043168e-02 3 1  ON 74
ci_0026                -1.101133e-02 3 1  ON 75
ci_0027                -1.087864e-02 3 1  ON 76
ci_0028                -1.146706e-02 3 1  ON 77
ci_0029                -1.115822e-02 3 1  ON 78
ci_0030                -1.016951e-02 3 1  ON 79
ci_0031                 2.088409e-02 3 1  ON 80
ci_0032                 2.098807e-02 3 1  ON 81
ci_0033                 8.891517e-03 3 1  ON 82
ci_0034                 9.911852e-03 3 1  ON 83
ci_0035                 6.963179e-03 3 1  ON 84
ci_0036                 6.563708e-03 3 1  ON 85
ci_0037                -1.091036e-02 3 1  ON 86
ci_0038                -1.090151e-02 3 1  ON 87
ci_0039                -2.669061e-03 3 1  ON 88
ci_0040                -2.638072e-03 3 1  ON 89
ci_0041                 6.238504e-03 3 1  ON 90
ci_0042                 6.987687e-03 3 1  ON 91
ci_0043                -1.766961e-02 3 1  ON 92
ci_0044                -1.815974e-02 3 1  ON 93
ci_0045                 7.462968e-03 3 1  ON 94
ci_0046                 7.825550e-03 3 1  ON 95
ci_0047                -1.561568e-03 3 1  ON 96
ci_0048                -1.492684e-03 3 1  ON 97
ci_0049                -4.917754e-03 3 1  ON 98
ci_0050                -5.596445e-03 3 1  ON 99
ci_0051                -3.647961e-03 3 1  ON 100
ci_0052                -3.770972e-03 3 1  ON 101
ci_0053                -4.413475e-03 3 1  ON 102
ci_0054                -4.808675e-03 3 1  ON 103
ci_0055                 6.367184e-03 3 1  ON 104
ci_0056                 6.667309e-03 3 1  ON 105
ci_0057                 4.395431e-03 3 1  ON 106
ci_0058                 5.077937e-03 3 1  ON 107
ci_0059                -4.771835e-03 3 1  ON 108
ci_0060                -5.312029e-03 3 1  ON 109
ci_0061                -3.006727e-03 3 1  ON 110
ci_0062                -3.372399e-03 3 1  ON 111
ci_0063                -9.331640e-03 3 1  ON 112
ci_0064                -8.676943e-03 3 1  ON 113
ci_0065                -5.073217e-03 3 1  ON 114
ci_0066                -5.396480e-03 3 1  ON 115
ci_0067                -4.831300e-03 3 1  ON 116
ci_0068                -5.527787e-03 3 1  ON 117
ci_0069                 4.773796e-03 3 1  ON 118
ci_0070                 4.528531e-03 3 1  ON 119
ci_0071                 2.684535e-04 3 1  ON 120
ci_0072                 6.046089e-04 3 1  ON 121
ci_0073                 4.184709e-03 3 1  ON 122
ci_0074                 4.312407e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.1601e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6896e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.9381
    reference variance = 0.394069
====================================================
  Execution time = 2.1382e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5261e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4880e-01
  Total weights = 1.951410410e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.3002e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333368076263
                                         uncertainty =       0.003534912475

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333368076263
                                         uncertainty =       0.003534912475

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408262162
  error estimate for blocks of size 2^( 2) =       0.000421135060
  error estimate for blocks of size 2^( 3) =       0.000434600697
  error estimate for blocks of size 2^( 4) =       0.000446880228
  error estimate for blocks of size 2^( 5) =       0.000458513099
  error estimate for blocks of size 2^( 6) =       0.000464189832
  error estimate for blocks of size 2^( 7) =       0.000467285445

      target function =                  N/A
              le_mean =     -16.906374142754
             les_mean =     286.174291373282
             stat err =       0.000459217151
             autocorr =       1.265196368151
              std dev =       0.577369887199
             le_variance =       0.333355986645


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690637414275e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906374142751       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906406162557       residual = 1.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906396440175       residual = 8.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906399841442       residual = 3.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906401728176       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906400165120       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906400628723       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906400524177       residual = 7.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906400818485       residual = 8.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906401200752       residual = 3.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906401534192       residual = 2.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906402543515       residual = 2.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906401544376       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906402134070       residual = 7.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906403078599       residual = 3.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.906403332300       residual = 2.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.906403582312       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.906403590553       residual = 6.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 6.2500e-02 is 3.359523e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906374142751       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906393668117       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906389733630       residual = 5.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906389153397       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906390434786       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906390074125       residual = 8.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906389826358       residual = 4.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906390137310       residual = 2.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906390652633       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906390666682       residual = 5.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906390690820       residual = 2.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906390513917       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906390472409       residual = 3.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.5000e-01 is 1.349204e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906374142751       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906381767327       residual = 8.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906380965181       residual = 4.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906380461190       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906380723060       residual = 8.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906380669129       residual = 4.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906380503633       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906380726762       residual = 7.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906380840955       residual = 3.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906380848755       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906380851669       residual = 5.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.0000e+00 is 4.370959e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.034921 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7694e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
   uu_0                 3.125987e-01 1 1  ON 0
   uu_1                 1.452760e-01 1 1  ON 1
   uu_2                 4.367345e-02 1 1  ON 2
   uu_3                -1.923121e-02 1 1  ON 3
   uu_4                -6.550998e-02 1 1  ON 4
   uu_5                -1.009060e-01 1 1  ON 5
   uu_6                -1.290290e-01 1 1  ON 6
   uu_7                -1.434272e-01 1 1  ON 7
   uu_8                -1.360751e-01 1 1  ON 8
   uu_9                -1.050266e-01 1 1  ON 9
   ud_0                 4.478310e-01 1 1  ON 10
   ud_1                 1.819595e-01 1 1  ON 11
   ud_2                 6.175856e-02 1 1  ON 12
   ud_3                -9.260373e-03 1 1  ON 13
   ud_4                -6.604890e-02 1 1  ON 14
   ud_5                -1.075991e-01 1 1  ON 15
   ud_6                -1.350019e-01 1 1  ON 16
   ud_7                -1.516190e-01 1 1  ON 17
   ud_8                -1.528002e-01 1 1  ON 18
   ud_9                -1.414319e-01 1 1  ON 19
   eO_0                -7.510782e-01 1 1  ON 20
   eO_1                -4.304855e-01 1 1  ON 21
   eO_2                -2.019710e-02 1 1  ON 22
   eO_3                 2.920306e-01 1 1  ON 23
   eO_4                 5.175915e-01 1 1  ON 24
   eO_5                 4.802148e-01 1 1  ON 25
   eO_6                 2.538727e-01 1 1  ON 26
   eO_7                -4.458291e-02 1 1  ON 27
   eO_8                -2.180990e-01 1 1  ON 28
   eO_9                -7.927590e-02 1 1  ON 29
  eH1_0                -2.556381e-01 1 1  ON 30
  eH1_1                -1.478004e-01 1 1  ON 31
  eH1_2                -9.793363e-02 1 1  ON 32
  eH1_3                -4.264023e-02 1 1  ON 33
  eH1_4                 6.915013e-03 1 1  ON 34
  eH1_5                 4.170435e-02 1 1  ON 35
  eH1_6                 1.013074e-01 1 1  ON 36
  eH1_7                 1.559000e-01 1 1  ON 37
  eH1_8                 1.766036e-01 1 1  ON 38
  eH1_9                 6.397397e-02 1 1  ON 39
  eH2_0                -2.524454e-01 1 1  ON 40
  eH2_1                -1.449505e-01 1 1  ON 41
  eH2_2                -9.524910e-02 1 1  ON 42
  eH2_3                -4.007158e-02 1 1  ON 43
  eH2_4                 9.669093e-03 1 1  ON 44
  eH2_5                 4.472921e-02 1 1  ON 45
  eH2_6                 1.032240e-01 1 1  ON 46
  eH2_7                 1.571524e-01 1 1  ON 47
  eH2_8                 1.815442e-01 1 1  ON 48
  eH2_9                 5.202113e-02 1 1  ON 49
ci_0001                 7.001594e-01 3 1  ON 50
ci_0002                 7.016903e-01 3 1  ON 51
ci_0003                -2.745169e-02 3 1  ON 52
ci_0004                -2.749757e-02 3 1  ON 53
ci_0005                -3.556886e-02 3 1  ON 54
ci_0006                -3.631082e-02 3 1  ON 55
ci_0007                -2.182592e-02 3 1  ON 56
ci_0008                -2.182031e-02 3 1  ON 57
ci_0009                -1.752712e-02 3 1  ON 58
ci_0010                -1.734076e-02 3 1  ON 59
ci_0011                -1.231591e-02 3 1  ON 60
ci_0012                -1.189315e-02 3 1  ON 61
ci_0013                 1.306818e-02 3 1  ON 62
ci_0014                 1.274426e-02 3 1  ON 63
ci_0015                 1.289827e-02 3 1  ON 64
ci_0016                 1.312519e-02 3 1  ON 65
ci_0017                 1.106453e-02 3 1  ON 66
ci_0018                 1.171212e-02 3 1  ON 67
ci_0019                 1.178615e-02 3 1  ON 68
ci_0020                 1.147245e-02 3 1  ON 69
ci_0021                -9.815804e-04 3 1  ON 70
ci_0022                -1.657778e-03 3 1  ON 71
ci_0023                -1.147228e-02 3 1  ON 72
ci_0024                -1.157260e-02 3 1  ON 73
ci_0025                -1.042960e-02 3 1  ON 74
ci_0026                -1.098176e-02 3 1  ON 75
ci_0027                -1.119791e-02 3 1  ON 76
ci_0028                -1.133032e-02 3 1  ON 77
ci_0029                -1.097810e-02 3 1  ON 78
ci_0030                -1.071250e-02 3 1  ON 79
ci_0031                 2.103878e-02 3 1  ON 80
ci_0032                 2.126512e-02 3 1  ON 81
ci_0033                 1.024072e-02 3 1  ON 82
ci_0034                 9.742310e-03 3 1  ON 83
ci_0035                 7.166578e-03 3 1  ON 84
ci_0036                 6.456390e-03 3 1  ON 85
ci_0037                -1.119267e-02 3 1  ON 86
ci_0038                -1.090179e-02 3 1  ON 87
ci_0039                -2.699879e-03 3 1  ON 88
ci_0040                -2.441749e-03 3 1  ON 89
ci_0041                 6.278842e-03 3 1  ON 90
ci_0042                 6.794870e-03 3 1  ON 91
ci_0043                -1.820260e-02 3 1  ON 92
ci_0044                -1.862050e-02 3 1  ON 93
ci_0045                 7.271569e-03 3 1  ON 94
ci_0046                 7.545264e-03 3 1  ON 95
ci_0047                -1.391526e-03 3 1  ON 96
ci_0048                -1.750385e-03 3 1  ON 97
ci_0049                -5.682839e-03 3 1  ON 98
ci_0050                -5.560508e-03 3 1  ON 99
ci_0051                -3.482510e-03 3 1  ON 100
ci_0052                -3.704814e-03 3 1  ON 101
ci_0053                -4.146103e-03 3 1  ON 102
ci_0054                -4.472894e-03 3 1  ON 103
ci_0055                 6.066911e-03 3 1  ON 104
ci_0056                 7.116248e-03 3 1  ON 105
ci_0057                 4.353622e-03 3 1  ON 106
ci_0058                 5.228384e-03 3 1  ON 107
ci_0059                -4.999092e-03 3 1  ON 108
ci_0060                -4.938455e-03 3 1  ON 109
ci_0061                -3.290770e-03 3 1  ON 110
ci_0062                -3.328871e-03 3 1  ON 111
ci_0063                -8.764121e-03 3 1  ON 112
ci_0064                -7.871976e-03 3 1  ON 113
ci_0065                -5.172085e-03 3 1  ON 114
ci_0066                -5.074401e-03 3 1  ON 115
ci_0067                -4.729153e-03 3 1  ON 116
ci_0068                -4.889345e-03 3 1  ON 117
ci_0069                 4.400772e-03 3 1  ON 118
ci_0070                 4.725049e-03 3 1  ON 119
ci_0071                -8.314516e-05 3 1  ON 120
ci_0072                 3.254945e-04 3 1  ON 121
ci_0073                 4.159739e-03 3 1  ON 122
ci_0074                 4.446292e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.9239
    reference variance = 0.259797
====================================================
  Execution time = 2.1277e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3631e-01
  Total weights = 1.9518e+06
  Execution time = 1.9145e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322542083431
                                         uncertainty =       0.001877218766

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322542083431
                                         uncertainty =       0.001877218766

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401602799
  error estimate for blocks of size 2^( 2) =       0.000414648693
  error estimate for blocks of size 2^( 3) =       0.000428130295
  error estimate for blocks of size 2^( 4) =       0.000441243102
  error estimate for blocks of size 2^( 5) =       0.000452062600
  error estimate for blocks of size 2^( 6) =       0.000461810734
  error estimate for blocks of size 2^( 7) =       0.000469051652

      target function =                  N/A
              le_mean =     -16.906214261482
             les_mean =     286.240802973518
             stat err =       0.000456042022
             autocorr =       1.289484906823
              std dev =       0.567952124582
             le_variance =       0.322569615818

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322008216220
                                         uncertainty =       0.001836794398

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322008216220
                                         uncertainty =       0.001836794398

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401269614
  error estimate for blocks of size 2^( 2) =       0.000414322127
  error estimate for blocks of size 2^( 3) =       0.000427825311
  error estimate for blocks of size 2^( 4) =       0.000440954437
  error estimate for blocks of size 2^( 5) =       0.000451817192
  error estimate for blocks of size 2^( 6) =       0.000461536559
  error estimate for blocks of size 2^( 7) =       0.000468775524

      target function =                  N/A
              le_mean =     -16.906204927379
             les_mean =     286.161307449962
             stat err =       0.000455770928
             autocorr =       1.290092024549
              std dev =       0.567480930552
             le_variance =       0.322034606540

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322044104286
                                         uncertainty =       0.001830844823

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322044104286
                                         uncertainty =       0.001830844823

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401291541
  error estimate for blocks of size 2^( 2) =       0.000414353831
  error estimate for blocks of size 2^( 3) =       0.000427877781
  error estimate for blocks of size 2^( 4) =       0.000441032697
  error estimate for blocks of size 2^( 5) =       0.000451910937
  error estimate for blocks of size 2^( 6) =       0.000461611432
  error estimate for blocks of size 2^( 7) =       0.000468834354

      target function =                  N/A
              le_mean =     -16.906213840651
             les_mean =     286.238600468401
             stat err =       0.000455847355
             autocorr =       1.290383696163
              std dev =       0.567511940119
             le_variance =       0.322069802178

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322204789253
                                         uncertainty =       0.001859204712

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322204789253
                                         uncertainty =       0.001859204712

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401392719
  error estimate for blocks of size 2^( 2) =       0.000414443404
  error estimate for blocks of size 2^( 3) =       0.000427928314
  error estimate for blocks of size 2^( 4) =       0.000441052527
  error estimate for blocks of size 2^( 5) =       0.000451908449
  error estimate for blocks of size 2^( 6) =       0.000461639617
  error estimate for blocks of size 2^( 7) =       0.000468881842

      target function =                  N/A
              le_mean =     -16.906211025758
             les_mean =     286.160227093277
             stat err =       0.000455870609
             autocorr =       1.289864845462
              std dev =       0.567655026343
             le_variance =       0.322232228933


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906214261482        initial  <--
     6.2500e-02     6.2500e-01             3.3595e-03       -16.906204927379
     2.5000e-01     2.5000e+00             1.3492e-03       -16.906213840651
     1.0000e+00     1.0000e+01             4.3710e-04       -16.906211025758

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.9346
  </log>
  <optVariables href="H2O.s001.opt.xml">
   uu_0                 3.124846e-01 1 1  ON 0
   uu_1                 1.449847e-01 1 1  ON 1
   uu_2                 4.339889e-02 1 1  ON 2
   uu_3                -1.938764e-02 1 1  ON 3
   uu_4                -6.550288e-02 1 1  ON 4
   uu_5                -1.008936e-01 1 1  ON 5
   uu_6                -1.287601e-01 1 1  ON 6
   uu_7                -1.429367e-01 1 1  ON 7
   uu_8                -1.357592e-01 1 1  ON 8
   uu_9                -1.045630e-01 1 1  ON 9
   ud_0                 4.478523e-01 1 1  ON 10
   ud_1                 1.817983e-01 1 1  ON 11
   ud_2                 6.175817e-02 1 1  ON 12
   ud_3                -9.073188e-03 1 1  ON 13
   ud_4                -6.597552e-02 1 1  ON 14
   ud_5                -1.077107e-01 1 1  ON 15
   ud_6                -1.350131e-01 1 1  ON 16
   ud_7                -1.519352e-01 1 1  ON 17
   ud_8                -1.529403e-01 1 1  ON 18
   ud_9                -1.411988e-01 1 1  ON 19
   eO_0                -7.511557e-01 1 1  ON 20
   eO_1                -4.306584e-01 1 1  ON 21
   eO_2                -2.040833e-02 1 1  ON 22
   eO_3                 2.922837e-01 1 1  ON 23
   eO_4                 5.176893e-01 1 1  ON 24
   eO_5                 4.799149e-01 1 1  ON 25
   eO_6                 2.534491e-01 1 1  ON 26
   eO_7                -4.492983e-02 1 1  ON 27
   eO_8                -2.175575e-01 1 1  ON 28
   eO_9                -7.872936e-02 1 1  ON 29
  eH1_0                -2.547132e-01 1 1  ON 30
  eH1_1                -1.474388e-01 1 1  ON 31
  eH1_2                -9.794032e-02 1 1  ON 32
  eH1_3                -4.273943e-02 1 1  ON 33
  eH1_4                 6.785441e-03 1 1  ON 34
  eH1_5                 4.189808e-02 1 1  ON 35
  eH1_6                 1.014463e-01 1 1  ON 36
  eH1_7                 1.558745e-01 1 1  ON 37
  eH1_8                 1.760398e-01 1 1  ON 38
  eH1_9                 6.330654e-02 1 1  ON 39
  eH2_0                -2.519567e-01 1 1  ON 40
  eH2_1                -1.446314e-01 1 1  ON 41
  eH2_2                -9.538959e-02 1 1  ON 42
  eH2_3                -4.005401e-02 1 1  ON 43
  eH2_4                 9.748885e-03 1 1  ON 44
  eH2_5                 4.511843e-02 1 1  ON 45
  eH2_6                 1.033817e-01 1 1  ON 46
  eH2_7                 1.571949e-01 1 1  ON 47
  eH2_8                 1.810081e-01 1 1  ON 48
  eH2_9                 5.117878e-02 1 1  ON 49
ci_0001                 7.004247e-01 3 1  ON 50
ci_0002                 7.014840e-01 3 1  ON 51
ci_0003                -2.713137e-02 3 1  ON 52
ci_0004                -2.739285e-02 3 1  ON 53
ci_0005                -3.535557e-02 3 1  ON 54
ci_0006                -3.622661e-02 3 1  ON 55
ci_0007                -2.210327e-02 3 1  ON 56
ci_0008                -2.194592e-02 3 1  ON 57
ci_0009                -1.770698e-02 3 1  ON 58
ci_0010                -1.757681e-02 3 1  ON 59
ci_0011                -1.251251e-02 3 1  ON 60
ci_0012                -1.139228e-02 3 1  ON 61
ci_0013                 1.325975e-02 3 1  ON 62
ci_0014                 1.285654e-02 3 1  ON 63
ci_0015                 1.235376e-02 3 1  ON 64
ci_0016                 1.294813e-02 3 1  ON 65
ci_0017                 1.134247e-02 3 1  ON 66
ci_0018                 1.165702e-02 3 1  ON 67
ci_0019                 1.156300e-02 3 1  ON 68
ci_0020                 1.152383e-02 3 1  ON 69
ci_0021                -1.697288e-04 3 1  ON 70
ci_0022                -1.304018e-03 3 1  ON 71
ci_0023                -1.175779e-02 3 1  ON 72
ci_0024                -1.103001e-02 3 1  ON 73
ci_0025                -1.043168e-02 3 1  ON 74
ci_0026                -1.101133e-02 3 1  ON 75
ci_0027                -1.087864e-02 3 1  ON 76
ci_0028                -1.146706e-02 3 1  ON 77
ci_0029                -1.115822e-02 3 1  ON 78
ci_0030                -1.016951e-02 3 1  ON 79
ci_0031                 2.088409e-02 3 1  ON 80
ci_0032                 2.098807e-02 3 1  ON 81
ci_0033                 8.891517e-03 3 1  ON 82
ci_0034                 9.911852e-03 3 1  ON 83
ci_0035                 6.963179e-03 3 1  ON 84
ci_0036                 6.563708e-03 3 1  ON 85
ci_0037                -1.091036e-02 3 1  ON 86
ci_0038                -1.090151e-02 3 1  ON 87
ci_0039                -2.669061e-03 3 1  ON 88
ci_0040                -2.638072e-03 3 1  ON 89
ci_0041                 6.238504e-03 3 1  ON 90
ci_0042                 6.987687e-03 3 1  ON 91
ci_0043                -1.766961e-02 3 1  ON 92
ci_0044                -1.815974e-02 3 1  ON 93
ci_0045                 7.462968e-03 3 1  ON 94
ci_0046                 7.825550e-03 3 1  ON 95
ci_0047                -1.561568e-03 3 1  ON 96
ci_0048                -1.492684e-03 3 1  ON 97
ci_0049                -4.917754e-03 3 1  ON 98
ci_0050                -5.596445e-03 3 1  ON 99
ci_0051                -3.647961e-03 3 1  ON 100
ci_0052                -3.770972e-03 3 1  ON 101
ci_0053                -4.413475e-03 3 1  ON 102
ci_0054                -4.808675e-03 3 1  ON 103
ci_0055                 6.367184e-03 3 1  ON 104
ci_0056                 6.667309e-03 3 1  ON 105
ci_0057                 4.395431e-03 3 1  ON 106
ci_0058                 5.077937e-03 3 1  ON 107
ci_0059                -4.771835e-03 3 1  ON 108
ci_0060                -5.312029e-03 3 1  ON 109
ci_0061                -3.006727e-03 3 1  ON 110
ci_0062                -3.372399e-03 3 1  ON 111
ci_0063                -9.331640e-03 3 1  ON 112
ci_0064                -8.676943e-03 3 1  ON 113
ci_0065                -5.073217e-03 3 1  ON 114
ci_0066                -5.396480e-03 3 1  ON 115
ci_0067                -4.831300e-03 3 1  ON 116
ci_0068                -5.527787e-03 3 1  ON 117
ci_0069                 4.773796e-03 3 1  ON 118
ci_0070                 4.528531e-03 3 1  ON 119
ci_0071                 2.684535e-04 3 1  ON 120
ci_0072                 6.046089e-04 3 1  ON 121
ci_0073                 4.184709e-03 3 1  ON 122
ci_0074                 4.312407e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8636e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6913e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.88
    reference variance = 0.199717
====================================================
  Execution time = 2.1224e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5225e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3817e-01
  Total weights = 1.951614993e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0991e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324451901353
                                         uncertainty =       0.002330852659

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324451901353
                                         uncertainty =       0.002330852659

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402742927
  error estimate for blocks of size 2^( 2) =       0.000415549564
  error estimate for blocks of size 2^( 3) =       0.000429171298
  error estimate for blocks of size 2^( 4) =       0.000441358886
  error estimate for blocks of size 2^( 5) =       0.000451227493
  error estimate for blocks of size 2^( 6) =       0.000457197386
  error estimate for blocks of size 2^( 7) =       0.000462342507

      target function =                  N/A
              le_mean =     -16.905670173654
             les_mean =     286.139853021342
             stat err =       0.000453031568
             autocorr =       1.265322078838
              std dev =       0.569564509654
             le_variance =       0.324403730657


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690567017365e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905670173634       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905676048527       residual = 7.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905677036681       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905676911966       residual = 7.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905677810201       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905677647125       residual = 5.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905677846130       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905677872063       residual = 7.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905677740164       residual = 2.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905677687448       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905677731113       residual = 2.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 6.2500e-01 is 4.202469e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905670173634       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905671971845       residual = 8.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905672235537       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905672113854       residual = 6.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905672319541       residual = 8.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905672479395       residual = 4.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905672362473       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905672379363       residual = 3.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905672371218       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905672377062       residual = 3.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.5000e+00 is 1.296879e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905670173634       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905670649897       residual = 8.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905670716847       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905670678926       residual = 7.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905670698571       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905670770821       residual = 3.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905670743849       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905670745416       residual = 2.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905670745713       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905670747736       residual = 3.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.0000e+01 is 3.448225e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.039349 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7332e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
   uu_0                 3.124969e-01 1 1  ON 0
   uu_1                 1.450565e-01 1 1  ON 1
   uu_2                 4.341062e-02 1 1  ON 2
   uu_3                -1.940493e-02 1 1  ON 3
   uu_4                -6.552932e-02 1 1  ON 4
   uu_5                -1.008875e-01 1 1  ON 5
   uu_6                -1.287865e-01 1 1  ON 6
   uu_7                -1.429569e-01 1 1  ON 7
   uu_8                -1.357654e-01 1 1  ON 8
   uu_9                -1.046240e-01 1 1  ON 9
   ud_0                 4.478148e-01 1 1  ON 10
   ud_1                 1.818257e-01 1 1  ON 11
   ud_2                 6.176728e-02 1 1  ON 12
   ud_3                -9.073709e-03 1 1  ON 13
   ud_4                -6.598610e-02 1 1  ON 14
   ud_5                -1.076649e-01 1 1  ON 15
   ud_6                -1.350345e-01 1 1  ON 16
   ud_7                -1.519028e-01 1 1  ON 17
   ud_8                -1.529418e-01 1 1  ON 18
   ud_9                -1.412214e-01 1 1  ON 19
   eO_0                -7.511869e-01 1 1  ON 20
   eO_1                -4.306919e-01 1 1  ON 21
   eO_2                -2.038551e-02 1 1  ON 22
   eO_3                 2.923185e-01 1 1  ON 23
   eO_4                 5.177295e-01 1 1  ON 24
   eO_5                 4.799592e-01 1 1  ON 25
   eO_6                 2.534835e-01 1 1  ON 26
   eO_7                -4.491551e-02 1 1  ON 27
   eO_8                -2.176103e-01 1 1  ON 28
   eO_9                -7.879161e-02 1 1  ON 29
  eH1_0                -2.547715e-01 1 1  ON 30
  eH1_1                -1.474564e-01 1 1  ON 31
  eH1_2                -9.795215e-02 1 1  ON 32
  eH1_3                -4.277555e-02 1 1  ON 33
  eH1_4                 6.786723e-03 1 1  ON 34
  eH1_5                 4.184240e-02 1 1  ON 35
  eH1_6                 1.014467e-01 1 1  ON 36
  eH1_7                 1.559131e-01 1 1  ON 37
  eH1_8                 1.761045e-01 1 1  ON 38
  eH1_9                 6.337726e-02 1 1  ON 39
  eH2_0                -2.519885e-01 1 1  ON 40
  eH2_1                -1.446904e-01 1 1  ON 41
  eH2_2                -9.540615e-02 1 1  ON 42
  eH2_3                -4.010583e-02 1 1  ON 43
  eH2_4                 9.712924e-03 1 1  ON 44
  eH2_5                 4.509395e-02 1 1  ON 45
  eH2_6                 1.033703e-01 1 1  ON 46
  eH2_7                 1.572419e-01 1 1  ON 47
  eH2_8                 1.810821e-01 1 1  ON 48
  eH2_9                 5.127970e-02 1 1  ON 49
ci_0001                 7.004310e-01 3 1  ON 50
ci_0002                 7.014774e-01 3 1  ON 51
ci_0003                -2.711447e-02 3 1  ON 52
ci_0004                -2.744909e-02 3 1  ON 53
ci_0005                -3.539598e-02 3 1  ON 54
ci_0006                -3.621958e-02 3 1  ON 55
ci_0007                -2.205026e-02 3 1  ON 56
ci_0008                -2.191722e-02 3 1  ON 57
ci_0009                -1.766525e-02 3 1  ON 58
ci_0010                -1.757923e-02 3 1  ON 59
ci_0011                -1.247115e-02 3 1  ON 60
ci_0012                -1.152197e-02 3 1  ON 61
ci_0013                 1.324430e-02 3 1  ON 62
ci_0014                 1.290717e-02 3 1  ON 63
ci_0015                 1.245412e-02 3 1  ON 64
ci_0016                 1.295188e-02 3 1  ON 65
ci_0017                 1.127814e-02 3 1  ON 66
ci_0018                 1.166240e-02 3 1  ON 67
ci_0019                 1.157995e-02 3 1  ON 68
ci_0020                 1.149701e-02 3 1  ON 69
ci_0021                -2.186321e-04 3 1  ON 70
ci_0022                -1.190284e-03 3 1  ON 71
ci_0023                -1.172545e-02 3 1  ON 72
ci_0024                -1.104837e-02 3 1  ON 73
ci_0025                -1.039157e-02 3 1  ON 74
ci_0026                -1.094578e-02 3 1  ON 75
ci_0027                -1.086187e-02 3 1  ON 76
ci_0028                -1.142655e-02 3 1  ON 77
ci_0029                -1.116082e-02 3 1  ON 78
ci_0030                -1.026477e-02 3 1  ON 79
ci_0031                 2.090075e-02 3 1  ON 80
ci_0032                 2.094476e-02 3 1  ON 81
ci_0033                 8.964819e-03 3 1  ON 82
ci_0034                 9.886144e-03 3 1  ON 83
ci_0035                 6.898194e-03 3 1  ON 84
ci_0036                 6.582779e-03 3 1  ON 85
ci_0037                -1.089000e-02 3 1  ON 86
ci_0038                -1.088153e-02 3 1  ON 87
ci_0039                -2.699624e-03 3 1  ON 88
ci_0040                -2.632237e-03 3 1  ON 89
ci_0041                 6.315009e-03 3 1  ON 90
ci_0042                 7.023779e-03 3 1  ON 91
ci_0043                -1.773004e-02 3 1  ON 92
ci_0044                -1.809868e-02 3 1  ON 93
ci_0045                 7.505085e-03 3 1  ON 94
ci_0046                 7.821616e-03 3 1  ON 95
ci_0047                -1.611335e-03 3 1  ON 96
ci_0048                -1.481341e-03 3 1  ON 97
ci_0049                -4.871337e-03 3 1  ON 98
ci_0050                -5.624372e-03 3 1  ON 99
ci_0051                -3.634944e-03 3 1  ON 100
ci_0052                -3.717281e-03 3 1  ON 101
ci_0053                -4.428200e-03 3 1  ON 102
ci_0054                -4.738764e-03 3 1  ON 103
ci_0055                 6.339393e-03 3 1  ON 104
ci_0056                 6.608761e-03 3 1  ON 105
ci_0057                 4.498957e-03 3 1  ON 106
ci_0058                 5.035060e-03 3 1  ON 107
ci_0059                -4.764741e-03 3 1  ON 108
ci_0060                -5.236746e-03 3 1  ON 109
ci_0061                -3.006446e-03 3 1  ON 110
ci_0062                -3.345413e-03 3 1  ON 111
ci_0063                -9.270938e-03 3 1  ON 112
ci_0064                -8.772830e-03 3 1  ON 113
ci_0065                -5.161616e-03 3 1  ON 114
ci_0066                -5.486510e-03 3 1  ON 115
ci_0067                -4.780569e-03 3 1  ON 116
ci_0068                -5.457011e-03 3 1  ON 117
ci_0069                 4.769513e-03 3 1  ON 118
ci_0070                 4.519796e-03 3 1  ON 119
ci_0071                 1.551670e-04 3 1  ON 120
ci_0072                 5.362489e-04 3 1  ON 121
ci_0073                 4.199504e-03 3 1  ON 122
ci_0074                 4.402989e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.9029
    reference variance = 0.246565
====================================================
  Execution time = 2.1011e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3622e-01
  Total weights = 1.9521e+06
  Execution time = 1.9125e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323794252550
                                         uncertainty =       0.001949123942

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323794252550
                                         uncertainty =       0.001949123942

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402369499
  error estimate for blocks of size 2^( 2) =       0.000415055407
  error estimate for blocks of size 2^( 3) =       0.000428235556
  error estimate for blocks of size 2^( 4) =       0.000440517930
  error estimate for blocks of size 2^( 5) =       0.000451592096
  error estimate for blocks of size 2^( 6) =       0.000460043870
  error estimate for blocks of size 2^( 7) =       0.000465991788

      target function =                  N/A
              le_mean =     -16.906099075301
             les_mean =     286.153718410730
             stat err =       0.000454536421
             autocorr =       1.276107530754
              std dev =       0.569036402376
             le_variance =       0.323802427229

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323555089212
                                         uncertainty =       0.001942981897

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323555089212
                                         uncertainty =       0.001942981897

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402221161
  error estimate for blocks of size 2^( 2) =       0.000414899645
  error estimate for blocks of size 2^( 3) =       0.000428065944
  error estimate for blocks of size 2^( 4) =       0.000440358252
  error estimate for blocks of size 2^( 5) =       0.000451445552
  error estimate for blocks of size 2^( 6) =       0.000459897517
  error estimate for blocks of size 2^( 7) =       0.000465826187

      target function =                  N/A
              le_mean =     -16.906094985818
             les_mean =     286.155081558576
             stat err =       0.000454381877
             autocorr =       1.276180695827
              std dev =       0.568826621589
             le_variance =       0.323563725429

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323611186749
                                         uncertainty =       0.001945320402

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323611186749
                                         uncertainty =       0.001945320402

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402255941
  error estimate for blocks of size 2^( 2) =       0.000414938035
  error estimate for blocks of size 2^( 3) =       0.000428109780
  error estimate for blocks of size 2^( 4) =       0.000440398852
  error estimate for blocks of size 2^( 5) =       0.000451482800
  error estimate for blocks of size 2^( 6) =       0.000459935146
  error estimate for blocks of size 2^( 7) =       0.000465871014

      target function =                  N/A
              le_mean =     -16.906095586399
             les_mean =     286.152862071565
             stat err =       0.000454421953
             autocorr =       1.276185112180
              std dev =       0.568875807450
             le_variance =       0.323619684301

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323766878922
                                         uncertainty =       0.001948613354

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323766878922
                                         uncertainty =       0.001948613354

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402352519
  error estimate for blocks of size 2^( 2) =       0.000415037876
  error estimate for blocks of size 2^( 3) =       0.000428216980
  error estimate for blocks of size 2^( 4) =       0.000440500340
  error estimate for blocks of size 2^( 5) =       0.000451575925
  error estimate for blocks of size 2^( 6) =       0.000460027640
  error estimate for blocks of size 2^( 7) =       0.000465974569

      target function =                  N/A
              le_mean =     -16.906098681837
             les_mean =     286.152630780203
             stat err =       0.000454519618
             autocorr =       1.276120888637
              std dev =       0.569012389047
             le_variance =       0.323775098889


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906099075301        initial  <--
     6.2500e-01     6.2500e+00             4.2025e-04       -16.906094985818
     2.5000e+00     2.5000e+01             1.2969e-04       -16.906095586399
     1.0000e+01     1.0000e+02             3.4482e-05       -16.906098681837

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.6647
  </log>
  <optVariables href="H2O.s002.opt.xml">
   uu_0                 3.124846e-01 1 1  ON 0
   uu_1                 1.449847e-01 1 1  ON 1
   uu_2                 4.339889e-02 1 1  ON 2
   uu_3                -1.938764e-02 1 1  ON 3
   uu_4                -6.550288e-02 1 1  ON 4
   uu_5                -1.008936e-01 1 1  ON 5
   uu_6                -1.287601e-01 1 1  ON 6
   uu_7                -1.429367e-01 1 1  ON 7
   uu_8                -1.357592e-01 1 1  ON 8
   uu_9                -1.045630e-01 1 1  ON 9
   ud_0                 4.478523e-01 1 1  ON 10
   ud_1                 1.817983e-01 1 1  ON 11
   ud_2                 6.175817e-02 1 1  ON 12
   ud_3                -9.073188e-03 1 1  ON 13
   ud_4                -6.597552e-02 1 1  ON 14
   ud_5                -1.077107e-01 1 1  ON 15
   ud_6                -1.350131e-01 1 1  ON 16
   ud_7                -1.519352e-01 1 1  ON 17
   ud_8                -1.529403e-01 1 1  ON 18
   ud_9                -1.411988e-01 1 1  ON 19
   eO_0                -7.511557e-01 1 1  ON 20
   eO_1                -4.306584e-01 1 1  ON 21
   eO_2                -2.040833e-02 1 1  ON 22
   eO_3                 2.922837e-01 1 1  ON 23
   eO_4                 5.176893e-01 1 1  ON 24
   eO_5                 4.799149e-01 1 1  ON 25
   eO_6                 2.534491e-01 1 1  ON 26
   eO_7                -4.492983e-02 1 1  ON 27
   eO_8                -2.175575e-01 1 1  ON 28
   eO_9                -7.872936e-02 1 1  ON 29
  eH1_0                -2.547132e-01 1 1  ON 30
  eH1_1                -1.474388e-01 1 1  ON 31
  eH1_2                -9.794032e-02 1 1  ON 32
  eH1_3                -4.273943e-02 1 1  ON 33
  eH1_4                 6.785441e-03 1 1  ON 34
  eH1_5                 4.189808e-02 1 1  ON 35
  eH1_6                 1.014463e-01 1 1  ON 36
  eH1_7                 1.558745e-01 1 1  ON 37
  eH1_8                 1.760398e-01 1 1  ON 38
  eH1_9                 6.330654e-02 1 1  ON 39
  eH2_0                -2.519567e-01 1 1  ON 40
  eH2_1                -1.446314e-01 1 1  ON 41
  eH2_2                -9.538959e-02 1 1  ON 42
  eH2_3                -4.005401e-02 1 1  ON 43
  eH2_4                 9.748885e-03 1 1  ON 44
  eH2_5                 4.511843e-02 1 1  ON 45
  eH2_6                 1.033817e-01 1 1  ON 46
  eH2_7                 1.571949e-01 1 1  ON 47
  eH2_8                 1.810081e-01 1 1  ON 48
  eH2_9                 5.117878e-02 1 1  ON 49
ci_0001                 7.004247e-01 3 1  ON 50
ci_0002                 7.014840e-01 3 1  ON 51
ci_0003                -2.713137e-02 3 1  ON 52
ci_0004                -2.739285e-02 3 1  ON 53
ci_0005                -3.535557e-02 3 1  ON 54
ci_0006                -3.622661e-02 3 1  ON 55
ci_0007                -2.210327e-02 3 1  ON 56
ci_0008                -2.194592e-02 3 1  ON 57
ci_0009                -1.770698e-02 3 1  ON 58
ci_0010                -1.757681e-02 3 1  ON 59
ci_0011                -1.251251e-02 3 1  ON 60
ci_0012                -1.139228e-02 3 1  ON 61
ci_0013                 1.325975e-02 3 1  ON 62
ci_0014                 1.285654e-02 3 1  ON 63
ci_0015                 1.235376e-02 3 1  ON 64
ci_0016                 1.294813e-02 3 1  ON 65
ci_0017                 1.134247e-02 3 1  ON 66
ci_0018                 1.165702e-02 3 1  ON 67
ci_0019                 1.156300e-02 3 1  ON 68
ci_0020                 1.152383e-02 3 1  ON 69
ci_0021                -1.697288e-04 3 1  ON 70
ci_0022                -1.304018e-03 3 1  ON 71
ci_0023                -1.175779e-02 3 1  ON 72
ci_0024                -1.103001e-02 3 1  ON 73
ci_0025                -1.043168e-02 3 1  ON 74
ci_0026                -1.101133e-02 3 1  ON 75
ci_0027                -1.087864e-02 3 1  ON 76
ci_0028                -1.146706e-02 3 1  ON 77
ci_0029                -1.115822e-02 3 1  ON 78
ci_0030                -1.016951e-02 3 1  ON 79
ci_0031                 2.088409e-02 3 1  ON 80
ci_0032                 2.098807e-02 3 1  ON 81
ci_0033                 8.891517e-03 3 1  ON 82
ci_0034                 9.911852e-03 3 1  ON 83
ci_0035                 6.963179e-03 3 1  ON 84
ci_0036                 6.563708e-03 3 1  ON 85
ci_0037                -1.091036e-02 3 1  ON 86
ci_0038                -1.090151e-02 3 1  ON 87
ci_0039                -2.669061e-03 3 1  ON 88
ci_0040                -2.638072e-03 3 1  ON 89
ci_0041                 6.238504e-03 3 1  ON 90
ci_0042                 6.987687e-03 3 1  ON 91
ci_0043                -1.766961e-02 3 1  ON 92
ci_0044                -1.815974e-02 3 1  ON 93
ci_0045                 7.462968e-03 3 1  ON 94
ci_0046                 7.825550e-03 3 1  ON 95
ci_0047                -1.561568e-03 3 1  ON 96
ci_0048                -1.492684e-03 3 1  ON 97
ci_0049                -4.917754e-03 3 1  ON 98
ci_0050                -5.596445e-03 3 1  ON 99
ci_0051                -3.647961e-03 3 1  ON 100
ci_0052                -3.770972e-03 3 1  ON 101
ci_0053                -4.413475e-03 3 1  ON 102
ci_0054                -4.808675e-03 3 1  ON 103
ci_0055                 6.367184e-03 3 1  ON 104
ci_0056                 6.667309e-03 3 1  ON 105
ci_0057                 4.395431e-03 3 1  ON 106
ci_0058                 5.077937e-03 3 1  ON 107
ci_0059                -4.771835e-03 3 1  ON 108
ci_0060                -5.312029e-03 3 1  ON 109
ci_0061                -3.006727e-03 3 1  ON 110
ci_0062                -3.372399e-03 3 1  ON 111
ci_0063                -9.331640e-03 3 1  ON 112
ci_0064                -8.676943e-03 3 1  ON 113
ci_0065                -5.073217e-03 3 1  ON 114
ci_0066                -5.396480e-03 3 1  ON 115
ci_0067                -4.831300e-03 3 1  ON 116
ci_0068                -5.527787e-03 3 1  ON 117
ci_0069                 4.773796e-03 3 1  ON 118
ci_0070                 4.528531e-03 3 1  ON 119
ci_0071                 2.684535e-04 3 1  ON 120
ci_0072                 6.046089e-04 3 1  ON 121
ci_0073                 4.184709e-03 3 1  ON 122
ci_0074                 4.312407e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8003e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.8847
    reference variance = 0.229262
====================================================
  Execution time = 2.1648e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5251e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4127e-01
  Total weights = 1.951719159e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1243e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325927636499
                                         uncertainty =       0.002386336522

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325927636499
                                         uncertainty =       0.002386336522

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403611922
  error estimate for blocks of size 2^( 2) =       0.000416715306
  error estimate for blocks of size 2^( 3) =       0.000429777612
  error estimate for blocks of size 2^( 4) =       0.000442475078
  error estimate for blocks of size 2^( 5) =       0.000453721070
  error estimate for blocks of size 2^( 6) =       0.000460083013
  error estimate for blocks of size 2^( 7) =       0.000467617666

      target function =                  N/A
              le_mean =     -16.906178158933
             les_mean =     286.160132760707
             stat err =       0.000455974207
             autocorr =       1.276299443204
              std dev =       0.570793454719
             le_variance =       0.325805167950


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690617815893e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906178158882       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906179214018       residual = 3.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906179385177       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906179279152       residual = 8.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906179251069       residual = 5.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906179309417       residual = 3.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906179289610       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906179292953       residual = 4.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906179309439       residual = 2.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906179317329       residual = 6.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 6.2500e+00 is 6.160783e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906178158882       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906178429670       residual = 3.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906178473243       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906178446332       residual = 8.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906178437865       residual = 5.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906178453280       residual = 3.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906178449054       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906178450326       residual = 4.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906178454659       residual = 1.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906178456893       residual = 5.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.5000e+01 is 1.559886e-05

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906178158882       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906178227031       residual = 3.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906178237975       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906178231224       residual = 9.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906178229013       residual = 5.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906178232915       residual = 3.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906178231907       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906178232258       residual = 4.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906178233359       residual = 1.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906178233935       residual = 5.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.0000e+02 is 3.912269e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.043441 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7780e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
   uu_0                 3.124868e-01 1 1  ON 0
   uu_1                 1.449942e-01 1 1  ON 1
   uu_2                 4.339592e-02 1 1  ON 2
   uu_3                -1.938769e-02 1 1  ON 3
   uu_4                -6.550349e-02 1 1  ON 4
   uu_5                -1.008970e-01 1 1  ON 5
   uu_6                -1.287612e-01 1 1  ON 6
   uu_7                -1.429382e-01 1 1  ON 7
   uu_8                -1.357638e-01 1 1  ON 8
   uu_9                -1.045666e-01 1 1  ON 9
   ud_0                 4.478534e-01 1 1  ON 10
   ud_1                 1.818071e-01 1 1  ON 11
   ud_2                 6.175630e-02 1 1  ON 12
   ud_3                -9.073394e-03 1 1  ON 13
   ud_4                -6.597582e-02 1 1  ON 14
   ud_5                -1.077088e-01 1 1  ON 15
   ud_6                -1.350125e-01 1 1  ON 16
   ud_7                -1.519355e-01 1 1  ON 17
   ud_8                -1.529421e-01 1 1  ON 18
   ud_9                -1.412022e-01 1 1  ON 19
   eO_0                -7.511569e-01 1 1  ON 20
   eO_1                -4.306626e-01 1 1  ON 21
   eO_2                -2.039919e-02 1 1  ON 22
   eO_3                 2.922819e-01 1 1  ON 23
   eO_4                 5.176919e-01 1 1  ON 24
   eO_5                 4.799158e-01 1 1  ON 25
   eO_6                 2.534532e-01 1 1  ON 26
   eO_7                -4.492829e-02 1 1  ON 27
   eO_8                -2.175623e-01 1 1  ON 28
   eO_9                -7.873467e-02 1 1  ON 29
  eH1_0                -2.547162e-01 1 1  ON 30
  eH1_1                -1.474443e-01 1 1  ON 31
  eH1_2                -9.794496e-02 1 1  ON 32
  eH1_3                -4.274044e-02 1 1  ON 33
  eH1_4                 6.785960e-03 1 1  ON 34
  eH1_5                 4.189861e-02 1 1  ON 35
  eH1_6                 1.014458e-01 1 1  ON 36
  eH1_7                 1.558775e-01 1 1  ON 37
  eH1_8                 1.760451e-01 1 1  ON 38
  eH1_9                 6.331211e-02 1 1  ON 39
  eH2_0                -2.519604e-01 1 1  ON 40
  eH2_1                -1.446341e-01 1 1  ON 41
  eH2_2                -9.538593e-02 1 1  ON 42
  eH2_3                -4.005518e-02 1 1  ON 43
  eH2_4                 9.749004e-03 1 1  ON 44
  eH2_5                 4.511375e-02 1 1  ON 45
  eH2_6                 1.033788e-01 1 1  ON 46
  eH2_7                 1.571939e-01 1 1  ON 47
  eH2_8                 1.810124e-01 1 1  ON 48
  eH2_9                 5.118632e-02 1 1  ON 49
ci_0001                 7.004217e-01 3 1  ON 50
ci_0002                 7.014861e-01 3 1  ON 51
ci_0003                -2.713498e-02 3 1  ON 52
ci_0004                -2.738708e-02 3 1  ON 53
ci_0005                -3.536111e-02 3 1  ON 54
ci_0006                -3.623145e-02 3 1  ON 55
ci_0007                -2.210727e-02 3 1  ON 56
ci_0008                -2.195250e-02 3 1  ON 57
ci_0009                -1.771067e-02 3 1  ON 58
ci_0010                -1.757448e-02 3 1  ON 59
ci_0011                -1.250877e-02 3 1  ON 60
ci_0012                -1.139886e-02 3 1  ON 61
ci_0013                 1.325653e-02 3 1  ON 62
ci_0014                 1.286546e-02 3 1  ON 63
ci_0015                 1.235937e-02 3 1  ON 64
ci_0016                 1.294880e-02 3 1  ON 65
ci_0017                 1.133396e-02 3 1  ON 66
ci_0018                 1.164462e-02 3 1  ON 67
ci_0019                 1.156964e-02 3 1  ON 68
ci_0020                 1.151068e-02 3 1  ON 69
ci_0021                -1.777938e-04 3 1  ON 70
ci_0022                -1.306719e-03 3 1  ON 71
ci_0023                -1.175388e-02 3 1  ON 72
ci_0024                -1.102453e-02 3 1  ON 73
ci_0025                -1.044063e-02 3 1  ON 74
ci_0026                -1.101116e-02 3 1  ON 75
ci_0027                -1.088582e-02 3 1  ON 76
ci_0028                -1.145798e-02 3 1  ON 77
ci_0029                -1.114774e-02 3 1  ON 78
ci_0030                -1.017229e-02 3 1  ON 79
ci_0031                 2.088100e-02 3 1  ON 80
ci_0032                 2.098721e-02 3 1  ON 81
ci_0033                 8.907115e-03 3 1  ON 82
ci_0034                 9.910597e-03 3 1  ON 83
ci_0035                 6.955885e-03 3 1  ON 84
ci_0036                 6.561521e-03 3 1  ON 85
ci_0037                -1.091861e-02 3 1  ON 86
ci_0038                -1.089813e-02 3 1  ON 87
ci_0039                -2.674327e-03 3 1  ON 88
ci_0040                -2.636143e-03 3 1  ON 89
ci_0041                 6.239805e-03 3 1  ON 90
ci_0042                 6.988939e-03 3 1  ON 91
ci_0043                -1.767836e-02 3 1  ON 92
ci_0044                -1.816187e-02 3 1  ON 93
ci_0045                 7.461013e-03 3 1  ON 94
ci_0046                 7.824730e-03 3 1  ON 95
ci_0047                -1.567610e-03 3 1  ON 96
ci_0048                -1.499508e-03 3 1  ON 97
ci_0049                -4.924796e-03 3 1  ON 98
ci_0050                -5.594508e-03 3 1  ON 99
ci_0051                -3.641247e-03 3 1  ON 100
ci_0052                -3.764419e-03 3 1  ON 101
ci_0053                -4.417695e-03 3 1  ON 102
ci_0054                -4.804875e-03 3 1  ON 103
ci_0055                 6.365706e-03 3 1  ON 104
ci_0056                 6.669352e-03 3 1  ON 105
ci_0057                 4.408633e-03 3 1  ON 106
ci_0058                 5.080771e-03 3 1  ON 107
ci_0059                -4.773397e-03 3 1  ON 108
ci_0060                -5.306243e-03 3 1  ON 109
ci_0061                -3.016357e-03 3 1  ON 110
ci_0062                -3.372437e-03 3 1  ON 111
ci_0063                -9.334645e-03 3 1  ON 112
ci_0064                -8.672987e-03 3 1  ON 113
ci_0065                -5.077492e-03 3 1  ON 114
ci_0066                -5.397209e-03 3 1  ON 115
ci_0067                -4.831874e-03 3 1  ON 116
ci_0068                -5.517337e-03 3 1  ON 117
ci_0069                 4.767197e-03 3 1  ON 118
ci_0070                 4.532582e-03 3 1  ON 119
ci_0071                 2.700654e-04 3 1  ON 120
ci_0072                 6.099276e-04 3 1  ON 121
ci_0073                 4.189349e-03 3 1  ON 122
ci_0074                 4.309205e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.9866
    reference variance = 0.405616
====================================================
  Execution time = 2.1242e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3866e-01
  Total weights = 1.9514e+06
  Execution time = 1.9048e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324496996432
                                         uncertainty =       0.002034211719

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324496996432
                                         uncertainty =       0.002034211719

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402781389
  error estimate for blocks of size 2^( 2) =       0.000415486448
  error estimate for blocks of size 2^( 3) =       0.000428523162
  error estimate for blocks of size 2^( 4) =       0.000439843432
  error estimate for blocks of size 2^( 5) =       0.000449767026
  error estimate for blocks of size 2^( 6) =       0.000456093448
  error estimate for blocks of size 2^( 7) =       0.000460211093

      target function =                  N/A
              le_mean =     -16.906688840557
             les_mean =     286.174788443656
             stat err =       0.000451478750
             autocorr =       1.256422884725
              std dev =       0.569618902375
             le_variance =       0.324465693943

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324500556097
                                         uncertainty =       0.002035336600

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324500556097
                                         uncertainty =       0.002035336600

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402783553
  error estimate for blocks of size 2^( 2) =       0.000415489254
  error estimate for blocks of size 2^( 3) =       0.000428526280
  error estimate for blocks of size 2^( 4) =       0.000439845455
  error estimate for blocks of size 2^( 5) =       0.000449769367
  error estimate for blocks of size 2^( 6) =       0.000456097412
  error estimate for blocks of size 2^( 7) =       0.000460214950

      target function =                  N/A
              le_mean =     -16.906688913634
             les_mean =     286.175109300130
             stat err =       0.000451481796
             autocorr =       1.256426334139
              std dev =       0.569621963791
             le_variance =       0.324469181633

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324498289708
                                         uncertainty =       0.002034783992

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324498289708
                                         uncertainty =       0.002034783992

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402782168
  error estimate for blocks of size 2^( 2) =       0.000415487555
  error estimate for blocks of size 2^( 3) =       0.000428524439
  error estimate for blocks of size 2^( 4) =       0.000439844167
  error estimate for blocks of size 2^( 5) =       0.000449767907
  error estimate for blocks of size 2^( 6) =       0.000456095181
  error estimate for blocks of size 2^( 7) =       0.000460212758

      target function =                  N/A
              le_mean =     -16.906688844910
             les_mean =     286.174796019430
             stat err =       0.000451480004
             autocorr =       1.256424999485
              std dev =       0.569620004669
             le_variance =       0.324466949719

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324497125973
                                         uncertainty =       0.002034283149

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324497125973
                                         uncertainty =       0.002034283149

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402781466
  error estimate for blocks of size 2^( 2) =       0.000415486566
  error estimate for blocks of size 2^( 3) =       0.000428523302
  error estimate for blocks of size 2^( 4) =       0.000439843505
  error estimate for blocks of size 2^( 5) =       0.000449767118
  error estimate for blocks of size 2^( 6) =       0.000456093647
  error estimate for blocks of size 2^( 7) =       0.000460211286

      target function =                  N/A
              le_mean =     -16.906688838645
             les_mean =     286.174786402475
             stat err =       0.000451478889
             autocorr =       1.256423173927
              std dev =       0.569619011930
             le_variance =       0.324465818752


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906688840557        initial
     6.2500e+00     6.2500e+01             6.1608e-05       -16.906688913634  <--
     2.5000e+01     2.5000e+02             1.5599e-05       -16.906688844910
     1.0000e+02     1.0000e+03             3.9123e-06       -16.906688838645

*****************************************************************************
Applying the update for shift_i =   6.2500e+00     and shift_s =   6.2500e+01
*****************************************************************************

  Execution time = 3.0863e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
   uu_0                 3.124936e-01 1 1  ON 0
   uu_1                 1.450211e-01 1 1  ON 1
   uu_2                 4.338812e-02 1 1  ON 2
   uu_3                -1.938812e-02 1 1  ON 3
   uu_4                -6.550520e-02 1 1  ON 4
   uu_5                -1.009068e-01 1 1  ON 5
   uu_6                -1.287644e-01 1 1  ON 6
   uu_7                -1.429429e-01 1 1  ON 7
   uu_8                -1.357775e-01 1 1  ON 8
   uu_9                -1.045776e-01 1 1  ON 9
   ud_0                 4.478577e-01 1 1  ON 10
   ud_1                 1.818317e-01 1 1  ON 11
   ud_2                 6.175166e-02 1 1  ON 12
   ud_3                -9.074259e-03 1 1  ON 13
   ud_4                -6.597658e-02 1 1  ON 14
   ud_5                -1.077033e-01 1 1  ON 15
   ud_6                -1.350107e-01 1 1  ON 16
   ud_7                -1.519362e-01 1 1  ON 17
   ud_8                -1.529475e-01 1 1  ON 18
   ud_9                -1.412125e-01 1 1  ON 19
   eO_0                -7.511606e-01 1 1  ON 20
   eO_1                -4.306741e-01 1 1  ON 21
   eO_2                -2.037328e-02 1 1  ON 22
   eO_3                 2.922766e-01 1 1  ON 23
   eO_4                 5.176998e-01 1 1  ON 24
   eO_5                 4.799184e-01 1 1  ON 25
   eO_6                 2.534654e-01 1 1  ON 26
   eO_7                -4.492365e-02 1 1  ON 27
   eO_8                -2.175767e-01 1 1  ON 28
   eO_9                -7.875061e-02 1 1  ON 29
  eH1_0                -2.547254e-01 1 1  ON 30
  eH1_1                -1.474607e-01 1 1  ON 31
  eH1_2                -9.795858e-02 1 1  ON 32
  eH1_3                -4.274365e-02 1 1  ON 33
  eH1_4                 6.787441e-03 1 1  ON 34
  eH1_5                 4.190029e-02 1 1  ON 35
  eH1_6                 1.014441e-01 1 1  ON 36
  eH1_7                 1.558863e-01 1 1  ON 37
  eH1_8                 1.760607e-01 1 1  ON 38
  eH1_9                 6.332884e-02 1 1  ON 39
  eH2_0                -2.519716e-01 1 1  ON 40
  eH2_1                -1.446416e-01 1 1  ON 41
  eH2_2                -9.537542e-02 1 1  ON 42
  eH2_3                -4.005849e-02 1 1  ON 43
  eH2_4                 9.749284e-03 1 1  ON 44
  eH2_5                 4.509979e-02 1 1  ON 45
  eH2_6                 1.033703e-01 1 1  ON 46
  eH2_7                 1.571912e-01 1 1  ON 47
  eH2_8                 1.810255e-01 1 1  ON 48
  eH2_9                 5.120891e-02 1 1  ON 49
ci_0001                 7.004131e-01 3 1  ON 50
ci_0002                 7.014923e-01 3 1  ON 51
ci_0003                -2.714541e-02 3 1  ON 52
ci_0004                -2.737034e-02 3 1  ON 53
ci_0005                -3.537740e-02 3 1  ON 54
ci_0006                -3.624571e-02 3 1  ON 55
ci_0007                -2.211909e-02 3 1  ON 56
ci_0008                -2.197193e-02 3 1  ON 57
ci_0009                -1.772132e-02 3 1  ON 58
ci_0010                -1.756772e-02 3 1  ON 59
ci_0011                -1.249791e-02 3 1  ON 60
ci_0012                -1.141807e-02 3 1  ON 61
ci_0013                 1.324722e-02 3 1  ON 62
ci_0014                 1.289139e-02 3 1  ON 63
ci_0015                 1.237566e-02 3 1  ON 64
ci_0016                 1.295088e-02 3 1  ON 65
ci_0017                 1.130940e-02 3 1  ON 66
ci_0018                 1.160887e-02 3 1  ON 67
ci_0019                 1.158887e-02 3 1  ON 68
ci_0020                 1.147265e-02 3 1  ON 69
ci_0021                -2.016295e-04 3 1  ON 70
ci_0022                -1.314650e-03 3 1  ON 71
ci_0023                -1.174263e-02 3 1  ON 72
ci_0024                -1.100877e-02 3 1  ON 73
ci_0025                -1.046657e-02 3 1  ON 74
ci_0026                -1.101069e-02 3 1  ON 75
ci_0027                -1.090661e-02 3 1  ON 76
ci_0028                -1.143169e-02 3 1  ON 77
ci_0029                -1.111730e-02 3 1  ON 78
ci_0030                -1.018035e-02 3 1  ON 79
ci_0031                 2.087196e-02 3 1  ON 80
ci_0032                 2.098474e-02 3 1  ON 81
ci_0033                 8.953124e-03 3 1  ON 82
ci_0034                 9.906884e-03 3 1  ON 83
ci_0035                 6.934605e-03 3 1  ON 84
ci_0036                 6.555174e-03 3 1  ON 85
ci_0037                -1.094266e-02 3 1  ON 86
ci_0038                -1.088829e-02 3 1  ON 87
ci_0039                -2.689261e-03 3 1  ON 88
ci_0040                -2.630670e-03 3 1  ON 89
ci_0041                 6.243579e-03 3 1  ON 90
ci_0042                 6.992590e-03 3 1  ON 91
ci_0043                -1.770404e-02 3 1  ON 92
ci_0044                -1.816821e-02 3 1  ON 93
ci_0045                 7.455298e-03 3 1  ON 94
ci_0046                 7.822301e-03 3 1  ON 95
ci_0047                -1.584757e-03 3 1  ON 96
ci_0048                -1.518896e-03 3 1  ON 97
ci_0049                -4.945210e-03 3 1  ON 98
ci_0050                -5.588936e-03 3 1  ON 99
ci_0051                -3.622078e-03 3 1  ON 100
ci_0052                -3.745689e-03 3 1  ON 101
ci_0053                -4.429758e-03 3 1  ON 102
ci_0054                -4.794064e-03 3 1  ON 103
ci_0055                 6.361386e-03 3 1  ON 104
ci_0056                 6.675341e-03 3 1  ON 105
ci_0057                 4.447132e-03 3 1  ON 106
ci_0058                 5.089042e-03 3 1  ON 107
ci_0059                -4.777865e-03 3 1  ON 108
ci_0060                -5.289684e-03 3 1  ON 109
ci_0061                -3.044318e-03 3 1  ON 110
ci_0062                -3.372539e-03 3 1  ON 111
ci_0063                -9.343228e-03 3 1  ON 112
ci_0064                -8.661676e-03 3 1  ON 113
ci_0065                -5.089835e-03 3 1  ON 114
ci_0066                -5.399323e-03 3 1  ON 115
ci_0067                -4.833495e-03 3 1  ON 116
ci_0068                -5.487583e-03 3 1  ON 117
ci_0069                 4.748368e-03 3 1  ON 118
ci_0070                 4.544233e-03 3 1  ON 119
ci_0071                 2.747371e-04 3 1  ON 120
ci_0072                 6.252001e-04 3 1  ON 121
ci_0073                 4.202586e-03 3 1  ON 122
ci_0074                 4.300093e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8650e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6914e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.8333
    reference variance = 0.719804
====================================================
  Execution time = 2.1422e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5265e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4548e-01
  Total weights = 1.952016315e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1537e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334039840684
                                         uncertainty =       0.011754195558

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334039840684
                                         uncertainty =       0.011754195558

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408672477
  error estimate for blocks of size 2^( 2) =       0.000421409546
  error estimate for blocks of size 2^( 3) =       0.000434264475
  error estimate for blocks of size 2^( 4) =       0.000446447022
  error estimate for blocks of size 2^( 5) =       0.000456939420
  error estimate for blocks of size 2^( 6) =       0.000464607597
  error estimate for blocks of size 2^( 7) =       0.000470553937

      target function =                  N/A
              le_mean =     -16.906094045167
             les_mean =     286.161495042868
             stat err =       0.000459636994
             autocorr =       1.264966924855
              std dev =       0.577950160226
             le_variance =       0.334026387705


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690609404517e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906094045150       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906095227220       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906095520967       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906094853200       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906094952485       residual = 7.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906094715196       residual = 3.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906094615937       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906094781704       residual = 4.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906094767671       residual = 2.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906094805891       residual = 4.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5625e+00 is 2.072426e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906094045150       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906094369047       residual = 1.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906094451271       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906094273215       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906094297893       residual = 7.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906094223912       residual = 3.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906094190665       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906094230866       residual = 3.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906094235431       residual = 1.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906094243288       residual = 3.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 6.2500e+00 is 5.651270e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906094045150       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906094128116       residual = 1.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906094149332       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906094104001       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906094110363       residual = 7.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906094090549       residual = 3.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906094081571       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906094091478       residual = 3.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906094093129       residual = 1.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906094095024       residual = 2.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.5000e+01 is 1.445649e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.047458 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7584e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
   uu_0                 3.124863e-01 1 1  ON 0
   uu_1                 1.450561e-01 1 1  ON 1
   uu_2                 4.338571e-02 1 1  ON 2
   uu_3                -1.939518e-02 1 1  ON 3
   uu_4                -6.550795e-02 1 1  ON 4
   uu_5                -1.009062e-01 1 1  ON 5
   uu_6                -1.287529e-01 1 1  ON 6
   uu_7                -1.429507e-01 1 1  ON 7
   uu_8                -1.357937e-01 1 1  ON 8
   uu_9                -1.045945e-01 1 1  ON 9
   ud_0                 4.478571e-01 1 1  ON 10
   ud_1                 1.818560e-01 1 1  ON 11
   ud_2                 6.175655e-02 1 1  ON 12
   ud_3                -9.061946e-03 1 1  ON 13
   ud_4                -6.597473e-02 1 1  ON 14
   ud_5                -1.077021e-01 1 1  ON 15
   ud_6                -1.350239e-01 1 1  ON 16
   ud_7                -1.519440e-01 1 1  ON 17
   ud_8                -1.529519e-01 1 1  ON 18
   ud_9                -1.412212e-01 1 1  ON 19
   eO_0                -7.511727e-01 1 1  ON 20
   eO_1                -4.306876e-01 1 1  ON 21
   eO_2                -2.034331e-02 1 1  ON 22
   eO_3                 2.922916e-01 1 1  ON 23
   eO_4                 5.176957e-01 1 1  ON 24
   eO_5                 4.799394e-01 1 1  ON 25
   eO_6                 2.534783e-01 1 1  ON 26
   eO_7                -4.492277e-02 1 1  ON 27
   eO_8                -2.176029e-01 1 1  ON 28
   eO_9                -7.877140e-02 1 1  ON 29
  eH1_0                -2.547337e-01 1 1  ON 30
  eH1_1                -1.474746e-01 1 1  ON 31
  eH1_2                -9.796670e-02 1 1  ON 32
  eH1_3                -4.276499e-02 1 1  ON 33
  eH1_4                 6.774910e-03 1 1  ON 34
  eH1_5                 4.190488e-02 1 1  ON 35
  eH1_6                 1.014407e-01 1 1  ON 36
  eH1_7                 1.558971e-01 1 1  ON 37
  eH1_8                 1.760858e-01 1 1  ON 38
  eH1_9                 6.335388e-02 1 1  ON 39
  eH2_0                -2.519729e-01 1 1  ON 40
  eH2_1                -1.446832e-01 1 1  ON 41
  eH2_2                -9.537687e-02 1 1  ON 42
  eH2_3                -4.005973e-02 1 1  ON 43
  eH2_4                 9.741769e-03 1 1  ON 44
  eH2_5                 4.509449e-02 1 1  ON 45
  eH2_6                 1.033626e-01 1 1  ON 46
  eH2_7                 1.571985e-01 1 1  ON 47
  eH2_8                 1.810496e-01 1 1  ON 48
  eH2_9                 5.124407e-02 1 1  ON 49
ci_0001                 7.004039e-01 3 1  ON 50
ci_0002                 7.014984e-01 3 1  ON 51
ci_0003                -2.720192e-02 3 1  ON 52
ci_0004                -2.737728e-02 3 1  ON 53
ci_0005                -3.537531e-02 3 1  ON 54
ci_0006                -3.625582e-02 3 1  ON 55
ci_0007                -2.211725e-02 3 1  ON 56
ci_0008                -2.199220e-02 3 1  ON 57
ci_0009                -1.770222e-02 3 1  ON 58
ci_0010                -1.758275e-02 3 1  ON 59
ci_0011                -1.248426e-02 3 1  ON 60
ci_0012                -1.145484e-02 3 1  ON 61
ci_0013                 1.323613e-02 3 1  ON 62
ci_0014                 1.292027e-02 3 1  ON 63
ci_0015                 1.237708e-02 3 1  ON 64
ci_0016                 1.297258e-02 3 1  ON 65
ci_0017                 1.132708e-02 3 1  ON 66
ci_0018                 1.158390e-02 3 1  ON 67
ci_0019                 1.159479e-02 3 1  ON 68
ci_0020                 1.145752e-02 3 1  ON 69
ci_0021                -2.302331e-04 3 1  ON 70
ci_0022                -1.305914e-03 3 1  ON 71
ci_0023                -1.171193e-02 3 1  ON 72
ci_0024                -1.100045e-02 3 1  ON 73
ci_0025                -1.045666e-02 3 1  ON 74
ci_0026                -1.099812e-02 3 1  ON 75
ci_0027                -1.090573e-02 3 1  ON 76
ci_0028                -1.141189e-02 3 1  ON 77
ci_0029                -1.109338e-02 3 1  ON 78
ci_0030                -1.018387e-02 3 1  ON 79
ci_0031                 2.087719e-02 3 1  ON 80
ci_0032                 2.097984e-02 3 1  ON 81
ci_0033                 8.947323e-03 3 1  ON 82
ci_0034                 9.909288e-03 3 1  ON 83
ci_0035                 6.920582e-03 3 1  ON 84
ci_0036                 6.563520e-03 3 1  ON 85
ci_0037                -1.099128e-02 3 1  ON 86
ci_0038                -1.088036e-02 3 1  ON 87
ci_0039                -2.684768e-03 3 1  ON 88
ci_0040                -2.630139e-03 3 1  ON 89
ci_0041                 6.260115e-03 3 1  ON 90
ci_0042                 6.975406e-03 3 1  ON 91
ci_0043                -1.772504e-02 3 1  ON 92
ci_0044                -1.816775e-02 3 1  ON 93
ci_0045                 7.464537e-03 3 1  ON 94
ci_0046                 7.806333e-03 3 1  ON 95
ci_0047                -1.562698e-03 3 1  ON 96
ci_0048                -1.531528e-03 3 1  ON 97
ci_0049                -4.945982e-03 3 1  ON 98
ci_0050                -5.582178e-03 3 1  ON 99
ci_0051                -3.614369e-03 3 1  ON 100
ci_0052                -3.731822e-03 3 1  ON 101
ci_0053                -4.450643e-03 3 1  ON 102
ci_0054                -4.770737e-03 3 1  ON 103
ci_0055                 6.382958e-03 3 1  ON 104
ci_0056                 6.660774e-03 3 1  ON 105
ci_0057                 4.441619e-03 3 1  ON 106
ci_0058                 5.088709e-03 3 1  ON 107
ci_0059                -4.795193e-03 3 1  ON 108
ci_0060                -5.287763e-03 3 1  ON 109
ci_0061                -3.033804e-03 3 1  ON 110
ci_0062                -3.392748e-03 3 1  ON 111
ci_0063                -9.354165e-03 3 1  ON 112
ci_0064                -8.631205e-03 3 1  ON 113
ci_0065                -5.106978e-03 3 1  ON 114
ci_0066                -5.413332e-03 3 1  ON 115
ci_0067                -4.834025e-03 3 1  ON 116
ci_0068                -5.465404e-03 3 1  ON 117
ci_0069                 4.758513e-03 3 1  ON 118
ci_0070                 4.519030e-03 3 1  ON 119
ci_0071                 2.815158e-04 3 1  ON 120
ci_0072                 6.036353e-04 3 1  ON 121
ci_0073                 4.217938e-03 3 1  ON 122
ci_0074                 4.261965e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.9304
    reference variance = 0.901254
====================================================
  Execution time = 2.1274e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3778e-01
  Total weights = 1.9520e+06
  Execution time = 1.9161e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323649884850
                                         uncertainty =       0.001992278331

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323649884850
                                         uncertainty =       0.001992278331

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402297507
  error estimate for blocks of size 2^( 2) =       0.000415158460
  error estimate for blocks of size 2^( 3) =       0.000428144722
  error estimate for blocks of size 2^( 4) =       0.000441086257
  error estimate for blocks of size 2^( 5) =       0.000452209875
  error estimate for blocks of size 2^( 6) =       0.000462620579
  error estimate for blocks of size 2^( 7) =       0.000467846808

      target function =                  N/A
              le_mean =     -16.905996744382
             les_mean =     286.150445797816
             stat err =       0.000455940880
             autocorr =       1.284465321017
              std dev =       0.568934590423
             le_variance =       0.323686568180

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00997449
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323586138953
                                         uncertainty =       0.001990695026

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323586138953
                                         uncertainty =       0.001990695026

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402258024
  error estimate for blocks of size 2^( 2) =       0.000415118194
  error estimate for blocks of size 2^( 3) =       0.000428101706
  error estimate for blocks of size 2^( 4) =       0.000441043527
  error estimate for blocks of size 2^( 5) =       0.000452169279
  error estimate for blocks of size 2^( 6) =       0.000462582854
  error estimate for blocks of size 2^( 7) =       0.000467804014

      target function =                  N/A
              le_mean =     -16.905995303990
             les_mean =     286.150815784823
             stat err =       0.000455899918
             autocorr =       1.284486655304
              std dev =       0.568878753437
             le_variance =       0.323623036112

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323608897986
                                         uncertainty =       0.001991349543

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323608897986
                                         uncertainty =       0.001991349543

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402272111
  error estimate for blocks of size 2^( 2) =       0.000415132708
  error estimate for blocks of size 2^( 3) =       0.000428117581
  error estimate for blocks of size 2^( 4) =       0.000441059419
  error estimate for blocks of size 2^( 5) =       0.000452184250
  error estimate for blocks of size 2^( 6) =       0.000462596608
  error estimate for blocks of size 2^( 7) =       0.000467820028

      target function =                  N/A
              le_mean =     -16.905995748614
             les_mean =     286.150441513819
             stat err =       0.000455915076
             autocorr =       1.284482109925
              std dev =       0.568898674467
             le_variance =       0.323645701810

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323644261870
                                         uncertainty =       0.001992152640

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323644261870
                                         uncertainty =       0.001992152640

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402294022
  error estimate for blocks of size 2^( 2) =       0.000415154931
  error estimate for blocks of size 2^( 3) =       0.000428141019
  error estimate for blocks of size 2^( 4) =       0.000441082596
  error estimate for blocks of size 2^( 5) =       0.000452206372
  error estimate for blocks of size 2^( 6) =       0.000462617295
  error estimate for blocks of size 2^( 7) =       0.000467843167

      target function =                  N/A
              le_mean =     -16.905996592427
             les_mean =     286.150436707015
             stat err =       0.000455937357
             autocorr =       1.284467725351
              std dev =       0.568929662500
             le_variance =       0.323680960873


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905996744382        initial  <--
     1.5625e+00     1.5625e+01             2.0724e-04       -16.905995303990
     6.2500e+00     6.2500e+01             5.6513e-05       -16.905995748614
     2.5000e+01     2.5000e+02             1.4456e-05       -16.905996592427

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.9654
  </log>
  <optVariables href="H2O.s004.opt.xml">
   uu_0                 3.124936e-01 1 1  ON 0
   uu_1                 1.450211e-01 1 1  ON 1
   uu_2                 4.338812e-02 1 1  ON 2
   uu_3                -1.938812e-02 1 1  ON 3
   uu_4                -6.550520e-02 1 1  ON 4
   uu_5                -1.009068e-01 1 1  ON 5
   uu_6                -1.287644e-01 1 1  ON 6
   uu_7                -1.429429e-01 1 1  ON 7
   uu_8                -1.357775e-01 1 1  ON 8
   uu_9                -1.045776e-01 1 1  ON 9
   ud_0                 4.478577e-01 1 1  ON 10
   ud_1                 1.818317e-01 1 1  ON 11
   ud_2                 6.175166e-02 1 1  ON 12
   ud_3                -9.074259e-03 1 1  ON 13
   ud_4                -6.597658e-02 1 1  ON 14
   ud_5                -1.077033e-01 1 1  ON 15
   ud_6                -1.350107e-01 1 1  ON 16
   ud_7                -1.519362e-01 1 1  ON 17
   ud_8                -1.529475e-01 1 1  ON 18
   ud_9                -1.412125e-01 1 1  ON 19
   eO_0                -7.511606e-01 1 1  ON 20
   eO_1                -4.306741e-01 1 1  ON 21
   eO_2                -2.037328e-02 1 1  ON 22
   eO_3                 2.922766e-01 1 1  ON 23
   eO_4                 5.176998e-01 1 1  ON 24
   eO_5                 4.799184e-01 1 1  ON 25
   eO_6                 2.534654e-01 1 1  ON 26
   eO_7                -4.492365e-02 1 1  ON 27
   eO_8                -2.175767e-01 1 1  ON 28
   eO_9                -7.875061e-02 1 1  ON 29
  eH1_0                -2.547254e-01 1 1  ON 30
  eH1_1                -1.474607e-01 1 1  ON 31
  eH1_2                -9.795858e-02 1 1  ON 32
  eH1_3                -4.274365e-02 1 1  ON 33
  eH1_4                 6.787441e-03 1 1  ON 34
  eH1_5                 4.190029e-02 1 1  ON 35
  eH1_6                 1.014441e-01 1 1  ON 36
  eH1_7                 1.558863e-01 1 1  ON 37
  eH1_8                 1.760607e-01 1 1  ON 38
  eH1_9                 6.332884e-02 1 1  ON 39
  eH2_0                -2.519716e-01 1 1  ON 40
  eH2_1                -1.446416e-01 1 1  ON 41
  eH2_2                -9.537542e-02 1 1  ON 42
  eH2_3                -4.005849e-02 1 1  ON 43
  eH2_4                 9.749284e-03 1 1  ON 44
  eH2_5                 4.509979e-02 1 1  ON 45
  eH2_6                 1.033703e-01 1 1  ON 46
  eH2_7                 1.571912e-01 1 1  ON 47
  eH2_8                 1.810255e-01 1 1  ON 48
  eH2_9                 5.120891e-02 1 1  ON 49
ci_0001                 7.004131e-01 3 1  ON 50
ci_0002                 7.014923e-01 3 1  ON 51
ci_0003                -2.714541e-02 3 1  ON 52
ci_0004                -2.737034e-02 3 1  ON 53
ci_0005                -3.537740e-02 3 1  ON 54
ci_0006                -3.624571e-02 3 1  ON 55
ci_0007                -2.211909e-02 3 1  ON 56
ci_0008                -2.197193e-02 3 1  ON 57
ci_0009                -1.772132e-02 3 1  ON 58
ci_0010                -1.756772e-02 3 1  ON 59
ci_0011                -1.249791e-02 3 1  ON 60
ci_0012                -1.141807e-02 3 1  ON 61
ci_0013                 1.324722e-02 3 1  ON 62
ci_0014                 1.289139e-02 3 1  ON 63
ci_0015                 1.237566e-02 3 1  ON 64
ci_0016                 1.295088e-02 3 1  ON 65
ci_0017                 1.130940e-02 3 1  ON 66
ci_0018                 1.160887e-02 3 1  ON 67
ci_0019                 1.158887e-02 3 1  ON 68
ci_0020                 1.147265e-02 3 1  ON 69
ci_0021                -2.016295e-04 3 1  ON 70
ci_0022                -1.314650e-03 3 1  ON 71
ci_0023                -1.174263e-02 3 1  ON 72
ci_0024                -1.100877e-02 3 1  ON 73
ci_0025                -1.046657e-02 3 1  ON 74
ci_0026                -1.101069e-02 3 1  ON 75
ci_0027                -1.090661e-02 3 1  ON 76
ci_0028                -1.143169e-02 3 1  ON 77
ci_0029                -1.111730e-02 3 1  ON 78
ci_0030                -1.018035e-02 3 1  ON 79
ci_0031                 2.087196e-02 3 1  ON 80
ci_0032                 2.098474e-02 3 1  ON 81
ci_0033                 8.953124e-03 3 1  ON 82
ci_0034                 9.906884e-03 3 1  ON 83
ci_0035                 6.934605e-03 3 1  ON 84
ci_0036                 6.555174e-03 3 1  ON 85
ci_0037                -1.094266e-02 3 1  ON 86
ci_0038                -1.088829e-02 3 1  ON 87
ci_0039                -2.689261e-03 3 1  ON 88
ci_0040                -2.630670e-03 3 1  ON 89
ci_0041                 6.243579e-03 3 1  ON 90
ci_0042                 6.992590e-03 3 1  ON 91
ci_0043                -1.770404e-02 3 1  ON 92
ci_0044                -1.816821e-02 3 1  ON 93
ci_0045                 7.455298e-03 3 1  ON 94
ci_0046                 7.822301e-03 3 1  ON 95
ci_0047                -1.584757e-03 3 1  ON 96
ci_0048                -1.518896e-03 3 1  ON 97
ci_0049                -4.945210e-03 3 1  ON 98
ci_0050                -5.588936e-03 3 1  ON 99
ci_0051                -3.622078e-03 3 1  ON 100
ci_0052                -3.745689e-03 3 1  ON 101
ci_0053                -4.429758e-03 3 1  ON 102
ci_0054                -4.794064e-03 3 1  ON 103
ci_0055                 6.361386e-03 3 1  ON 104
ci_0056                 6.675341e-03 3 1  ON 105
ci_0057                 4.447132e-03 3 1  ON 106
ci_0058                 5.089042e-03 3 1  ON 107
ci_0059                -4.777865e-03 3 1  ON 108
ci_0060                -5.289684e-03 3 1  ON 109
ci_0061                -3.044318e-03 3 1  ON 110
ci_0062                -3.372539e-03 3 1  ON 111
ci_0063                -9.343228e-03 3 1  ON 112
ci_0064                -8.661676e-03 3 1  ON 113
ci_0065                -5.089835e-03 3 1  ON 114
ci_0066                -5.399323e-03 3 1  ON 115
ci_0067                -4.833495e-03 3 1  ON 116
ci_0068                -5.487583e-03 3 1  ON 117
ci_0069                 4.748368e-03 3 1  ON 118
ci_0070                 4.544233e-03 3 1  ON 119
ci_0071                 2.747371e-04 3 1  ON 120
ci_0072                 6.252001e-04 3 1  ON 121
ci_0073                 4.202586e-03 3 1  ON 122
ci_0074                 4.300093e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8564e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.8137
    reference variance = 0.551032
====================================================
  Execution time = 2.3565e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5257e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3849e-01
  Total weights = 1.951707066e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1988e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325650458193
                                         uncertainty =       0.002806044642

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325650458193
                                         uncertainty =       0.002806044642

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403515569
  error estimate for blocks of size 2^( 2) =       0.000416508594
  error estimate for blocks of size 2^( 3) =       0.000429643166
  error estimate for blocks of size 2^( 4) =       0.000441108258
  error estimate for blocks of size 2^( 5) =       0.000451104676
  error estimate for blocks of size 2^( 6) =       0.000457630285
  error estimate for blocks of size 2^( 7) =       0.000462373421

      target function =                  N/A
              le_mean =     -16.906131516579
             les_mean =     286.155769403054
             stat err =       0.000453054160
             autocorr =       1.260606820298
              std dev =       0.570657190856
             le_variance =       0.325649629476


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690613151658e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906131516572       residual = 2.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906132265092       residual = 3.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906132205048       residual = 3.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906132195671       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906132242901       residual = 4.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906132270621       residual = 2.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906132235217       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906132234898       residual = 3.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906132233492       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906132238458       residual = 3.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5625e+01 is 4.946470e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906131516572       residual = 2.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906131705364       residual = 3.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906131690303       residual = 3.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906131688000       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906131699856       residual = 4.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906131707075       residual = 2.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906131698292       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906131697936       residual = 3.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906131697580       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906131698777       residual = 3.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 6.2500e+01 is 1.242707e-05

solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906131516572       residual = 2.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906131563875       residual = 3.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906131560107       residual = 3.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906131559534       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906131562501       residual = 4.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906131564323       residual = 2.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906131562134       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906131562027       residual = 3.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906131561937       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906131562234       residual = 3.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.5000e+02 is 3.110597e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.051478 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9771e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
   uu_0                 3.124948e-01 1 1  ON 0
   uu_1                 1.450214e-01 1 1  ON 1
   uu_2                 4.338861e-02 1 1  ON 2
   uu_3                -1.938906e-02 1 1  ON 3
   uu_4                -6.550535e-02 1 1  ON 4
   uu_5                -1.009071e-01 1 1  ON 5
   uu_6                -1.287655e-01 1 1  ON 6
   uu_7                -1.429443e-01 1 1  ON 7
   uu_8                -1.357774e-01 1 1  ON 8
   uu_9                -1.045792e-01 1 1  ON 9
   ud_0                 4.478578e-01 1 1  ON 10
   ud_1                 1.818346e-01 1 1  ON 11
   ud_2                 6.175201e-02 1 1  ON 12
   ud_3                -9.074074e-03 1 1  ON 13
   ud_4                -6.597697e-02 1 1  ON 14
   ud_5                -1.077033e-01 1 1  ON 15
   ud_6                -1.350114e-01 1 1  ON 16
   ud_7                -1.519365e-01 1 1  ON 17
   ud_8                -1.529481e-01 1 1  ON 18
   ud_9                -1.412137e-01 1 1  ON 19
   eO_0                -7.511612e-01 1 1  ON 20
   eO_1                -4.306759e-01 1 1  ON 21
   eO_2                -2.037080e-02 1 1  ON 22
   eO_3                 2.922773e-01 1 1  ON 23
   eO_4                 5.177010e-01 1 1  ON 24
   eO_5                 4.799199e-01 1 1  ON 25
   eO_6                 2.534661e-01 1 1  ON 26
   eO_7                -4.492392e-02 1 1  ON 27
   eO_8                -2.175784e-01 1 1  ON 28
   eO_9                -7.875255e-02 1 1  ON 29
  eH1_0                -2.547263e-01 1 1  ON 30
  eH1_1                -1.474625e-01 1 1  ON 31
  eH1_2                -9.795910e-02 1 1  ON 32
  eH1_3                -4.274502e-02 1 1  ON 33
  eH1_4                 6.785713e-03 1 1  ON 34
  eH1_5                 4.189983e-02 1 1  ON 35
  eH1_6                 1.014437e-01 1 1  ON 36
  eH1_7                 1.558874e-01 1 1  ON 37
  eH1_8                 1.760635e-01 1 1  ON 38
  eH1_9                 6.333187e-02 1 1  ON 39
  eH2_0                -2.519717e-01 1 1  ON 40
  eH2_1                -1.446431e-01 1 1  ON 41
  eH2_2                -9.537808e-02 1 1  ON 42
  eH2_3                -4.005897e-02 1 1  ON 43
  eH2_4                 9.749635e-03 1 1  ON 44
  eH2_5                 4.509798e-02 1 1  ON 45
  eH2_6                 1.033697e-01 1 1  ON 46
  eH2_7                 1.571925e-01 1 1  ON 47
  eH2_8                 1.810279e-01 1 1  ON 48
  eH2_9                 5.121163e-02 1 1  ON 49
ci_0001                 7.004136e-01 3 1  ON 50
ci_0002                 7.014918e-01 3 1  ON 51
ci_0003                -2.714339e-02 3 1  ON 52
ci_0004                -2.736946e-02 3 1  ON 53
ci_0005                -3.538161e-02 3 1  ON 54
ci_0006                -3.624483e-02 3 1  ON 55
ci_0007                -2.211383e-02 3 1  ON 56
ci_0008                -2.197270e-02 3 1  ON 57
ci_0009                -1.771915e-02 3 1  ON 58
ci_0010                -1.756853e-02 3 1  ON 59
ci_0011                -1.249572e-02 3 1  ON 60
ci_0012                -1.141890e-02 3 1  ON 61
ci_0013                 1.324974e-02 3 1  ON 62
ci_0014                 1.289396e-02 3 1  ON 63
ci_0015                 1.237947e-02 3 1  ON 64
ci_0016                 1.294885e-02 3 1  ON 65
ci_0017                 1.130834e-02 3 1  ON 66
ci_0018                 1.160562e-02 3 1  ON 67
ci_0019                 1.158907e-02 3 1  ON 68
ci_0020                 1.147348e-02 3 1  ON 69
ci_0021                -2.047883e-04 3 1  ON 70
ci_0022                -1.312430e-03 3 1  ON 71
ci_0023                -1.174269e-02 3 1  ON 72
ci_0024                -1.100813e-02 3 1  ON 73
ci_0025                -1.046752e-02 3 1  ON 74
ci_0026                -1.100589e-02 3 1  ON 75
ci_0027                -1.090946e-02 3 1  ON 76
ci_0028                -1.142872e-02 3 1  ON 77
ci_0029                -1.111421e-02 3 1  ON 78
ci_0030                -1.018475e-02 3 1  ON 79
ci_0031                 2.087161e-02 3 1  ON 80
ci_0032                 2.098770e-02 3 1  ON 81
ci_0033                 8.965551e-03 3 1  ON 82
ci_0034                 9.906068e-03 3 1  ON 83
ci_0035                 6.933012e-03 3 1  ON 84
ci_0036                 6.556808e-03 3 1  ON 85
ci_0037                -1.094165e-02 3 1  ON 86
ci_0038                -1.088702e-02 3 1  ON 87
ci_0039                -2.689898e-03 3 1  ON 88
ci_0040                -2.633220e-03 3 1  ON 89
ci_0041                 6.246360e-03 3 1  ON 90
ci_0042                 6.991588e-03 3 1  ON 91
ci_0043                -1.770394e-02 3 1  ON 92
ci_0044                -1.817172e-02 3 1  ON 93
ci_0045                 7.455928e-03 3 1  ON 94
ci_0046                 7.821575e-03 3 1  ON 95
ci_0047                -1.584246e-03 3 1  ON 96
ci_0048                -1.518800e-03 3 1  ON 97
ci_0049                -4.947120e-03 3 1  ON 98
ci_0050                -5.589855e-03 3 1  ON 99
ci_0051                -3.617894e-03 3 1  ON 100
ci_0052                -3.742763e-03 3 1  ON 101
ci_0053                -4.433385e-03 3 1  ON 102
ci_0054                -4.795408e-03 3 1  ON 103
ci_0055                 6.358342e-03 3 1  ON 104
ci_0056                 6.677164e-03 3 1  ON 105
ci_0057                 4.451823e-03 3 1  ON 106
ci_0058                 5.083128e-03 3 1  ON 107
ci_0059                -4.775907e-03 3 1  ON 108
ci_0060                -5.286688e-03 3 1  ON 109
ci_0061                -3.047943e-03 3 1  ON 110
ci_0062                -3.372909e-03 3 1  ON 111
ci_0063                -9.343825e-03 3 1  ON 112
ci_0064                -8.657467e-03 3 1  ON 113
ci_0065                -5.095416e-03 3 1  ON 114
ci_0066                -5.397204e-03 3 1  ON 115
ci_0067                -4.830144e-03 3 1  ON 116
ci_0068                -5.485965e-03 3 1  ON 117
ci_0069                 4.746167e-03 3 1  ON 118
ci_0070                 4.538991e-03 3 1  ON 119
ci_0071                 2.755659e-04 3 1  ON 120
ci_0072                 6.232720e-04 3 1  ON 121
ci_0073                 4.203393e-03 3 1  ON 122
ci_0074                 4.297361e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.909
    reference variance = 0.279582
====================================================
  Execution time = 2.1051e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4298e-01
  Total weights = 1.9519e+06
  Execution time = 1.9187e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327982386872
                                         uncertainty =       0.003153183506

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327982386872
                                         uncertainty =       0.003153183506

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404956151
  error estimate for blocks of size 2^( 2) =       0.000417938409
  error estimate for blocks of size 2^( 3) =       0.000430854328
  error estimate for blocks of size 2^( 4) =       0.000443380560
  error estimate for blocks of size 2^( 5) =       0.000454215715
  error estimate for blocks of size 2^( 6) =       0.000462044845
  error estimate for blocks of size 2^( 7) =       0.000468336198

      target function =                  N/A
              le_mean =     -16.905595296385
             les_mean =     286.142118934104
             stat err =       0.000456994330
             autocorr =       1.273519570883
              std dev =       0.572694480432
             le_variance =       0.327978967917

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327970702241
                                         uncertainty =       0.003155678884

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327970702241
                                         uncertainty =       0.003155678884

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404948950
  error estimate for blocks of size 2^( 2) =       0.000417931223
  error estimate for blocks of size 2^( 3) =       0.000430847233
  error estimate for blocks of size 2^( 4) =       0.000443373430
  error estimate for blocks of size 2^( 5) =       0.000454208061
  error estimate for blocks of size 2^( 6) =       0.000462036014
  error estimate for blocks of size 2^( 7) =       0.000468326488

      target function =                  N/A
              le_mean =     -16.905595491928
             les_mean =     286.142227997374
             stat err =       0.000456985998
             autocorr =       1.273518425729
              std dev =       0.572684297400
             le_variance =       0.327967304489

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327976336319
                                         uncertainty =       0.003154440321

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327976336319
                                         uncertainty =       0.003154440321

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404952422
  error estimate for blocks of size 2^( 2) =       0.000417934690
  error estimate for blocks of size 2^( 3) =       0.000430850655
  error estimate for blocks of size 2^( 4) =       0.000443376875
  error estimate for blocks of size 2^( 5) =       0.000454211774
  error estimate for blocks of size 2^( 6) =       0.000462040325
  error estimate for blocks of size 2^( 7) =       0.000468331226

      target function =                  N/A
              le_mean =     -16.905595394413
             les_mean =     286.142147592277
             stat err =       0.000456990050
             autocorr =       1.273519172192
              std dev =       0.572689207251
             le_variance =       0.327972928102

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327981620210
                                         uncertainty =       0.003153340692

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327981620210
                                         uncertainty =       0.003153340692

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404955678
  error estimate for blocks of size 2^( 2) =       0.000417937938
  error estimate for blocks of size 2^( 3) =       0.000430853862
  error estimate for blocks of size 2^( 4) =       0.000443380094
  error estimate for blocks of size 2^( 5) =       0.000454215217
  error estimate for blocks of size 2^( 6) =       0.000462044275
  error estimate for blocks of size 2^( 7) =       0.000468335571

      target function =                  N/A
              le_mean =     -16.905595308415
             les_mean =     286.142121279080
             stat err =       0.000456993789
             autocorr =       1.273519530079
              std dev =       0.572693812261
             le_variance =       0.327978202603


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905595296385        initial
     1.5625e+01     1.5625e+02             4.9465e-05       -16.905595491928  <--
     6.2500e+01     6.2500e+02             1.2427e-05       -16.905595394413
     2.5000e+02     2.5000e+03             3.1106e-06       -16.905595308415

*****************************************************************************
Applying the update for shift_i =   1.5625e+01     and shift_s =   1.5625e+02
*****************************************************************************

  Execution time = 3.0879e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
   uu_0                 3.124984e-01 1 1  ON 0
   uu_1                 1.450223e-01 1 1  ON 1
   uu_2                 4.339005e-02 1 1  ON 2
   uu_3                -1.939180e-02 1 1  ON 3
   uu_4                -6.550583e-02 1 1  ON 4
   uu_5                -1.009080e-01 1 1  ON 5
   uu_6                -1.287688e-01 1 1  ON 6
   uu_7                -1.429485e-01 1 1  ON 7
   uu_8                -1.357771e-01 1 1  ON 8
   uu_9                -1.045837e-01 1 1  ON 9
   ud_0                 4.478585e-01 1 1  ON 10
   ud_1                 1.818430e-01 1 1  ON 11
   ud_2                 6.175308e-02 1 1  ON 12
   ud_3                -9.073544e-03 1 1  ON 13
   ud_4                -6.597812e-02 1 1  ON 14
   ud_5                -1.077034e-01 1 1  ON 15
   ud_6                -1.350135e-01 1 1  ON 16
   ud_7                -1.519371e-01 1 1  ON 17
   ud_8                -1.529496e-01 1 1  ON 18
   ud_9                -1.412173e-01 1 1  ON 19
   eO_0                -7.511632e-01 1 1  ON 20
   eO_1                -4.306810e-01 1 1  ON 21
   eO_2                -2.036349e-02 1 1  ON 22
   eO_3                 2.922792e-01 1 1  ON 23
   eO_4                 5.177048e-01 1 1  ON 24
   eO_5                 4.799243e-01 1 1  ON 25
   eO_6                 2.534684e-01 1 1  ON 26
   eO_7                -4.492472e-02 1 1  ON 27
   eO_8                -2.175834e-01 1 1  ON 28
   eO_9                -7.875839e-02 1 1  ON 29
  eH1_0                -2.547289e-01 1 1  ON 30
  eH1_1                -1.474679e-01 1 1  ON 31
  eH1_2                -9.796068e-02 1 1  ON 32
  eH1_3                -4.274912e-02 1 1  ON 33
  eH1_4                 6.780540e-03 1 1  ON 34
  eH1_5                 4.189843e-02 1 1  ON 35
  eH1_6                 1.014426e-01 1 1  ON 36
  eH1_7                 1.558905e-01 1 1  ON 37
  eH1_8                 1.760718e-01 1 1  ON 38
  eH1_9                 6.334095e-02 1 1  ON 39
  eH2_0                -2.519723e-01 1 1  ON 40
  eH2_1                -1.446476e-01 1 1  ON 41
  eH2_2                -9.538598e-02 1 1  ON 42
  eH2_3                -4.006047e-02 1 1  ON 43
  eH2_4                 9.750665e-03 1 1  ON 44
  eH2_5                 4.509257e-02 1 1  ON 45
  eH2_6                 1.033680e-01 1 1  ON 46
  eH2_7                 1.571965e-01 1 1  ON 47
  eH2_8                 1.810349e-01 1 1  ON 48
  eH2_9                 5.121979e-02 1 1  ON 49
ci_0001                 7.004152e-01 3 1  ON 50
ci_0002                 7.014901e-01 3 1  ON 51
ci_0003                -2.713740e-02 3 1  ON 52
ci_0004                -2.736685e-02 3 1  ON 53
ci_0005                -3.539414e-02 3 1  ON 54
ci_0006                -3.624219e-02 3 1  ON 55
ci_0007                -2.209815e-02 3 1  ON 56
ci_0008                -2.197496e-02 3 1  ON 57
ci_0009                -1.771273e-02 3 1  ON 58
ci_0010                -1.757090e-02 3 1  ON 59
ci_0011                -1.248924e-02 3 1  ON 60
ci_0012                -1.142137e-02 3 1  ON 61
ci_0013                 1.325723e-02 3 1  ON 62
ci_0014                 1.290154e-02 3 1  ON 63
ci_0015                 1.239073e-02 3 1  ON 64
ci_0016                 1.294286e-02 3 1  ON 65
ci_0017                 1.130521e-02 3 1  ON 66
ci_0018                 1.159603e-02 3 1  ON 67
ci_0019                 1.158964e-02 3 1  ON 68
ci_0020                 1.147594e-02 3 1  ON 69
ci_0021                -2.142043e-04 3 1  ON 70
ci_0022                -1.305791e-03 3 1  ON 71
ci_0023                -1.174286e-02 3 1  ON 72
ci_0024                -1.100625e-02 3 1  ON 73
ci_0025                -1.047033e-02 3 1  ON 74
ci_0026                -1.099170e-02 3 1  ON 75
ci_0027                -1.091787e-02 3 1  ON 76
ci_0028                -1.141993e-02 3 1  ON 77
ci_0029                -1.110506e-02 3 1  ON 78
ci_0030                -1.019777e-02 3 1  ON 79
ci_0031                 2.087058e-02 3 1  ON 80
ci_0032                 2.099652e-02 3 1  ON 81
ci_0033                 9.002589e-03 3 1  ON 82
ci_0034                 9.903629e-03 3 1  ON 83
ci_0035                 6.928266e-03 3 1  ON 84
ci_0036                 6.561658e-03 3 1  ON 85
ci_0037                -1.093863e-02 3 1  ON 86
ci_0038                -1.088325e-02 3 1  ON 87
ci_0039                -2.691769e-03 3 1  ON 88
ci_0040                -2.640697e-03 3 1  ON 89
ci_0041                 6.254576e-03 3 1  ON 90
ci_0042                 6.988619e-03 3 1  ON 91
ci_0043                -1.770364e-02 3 1  ON 92
ci_0044                -1.818224e-02 3 1  ON 93
ci_0045                 7.457809e-03 3 1  ON 94
ci_0046                 7.819417e-03 3 1  ON 95
ci_0047                -1.582741e-03 3 1  ON 96
ci_0048                -1.518512e-03 3 1  ON 97
ci_0049                -4.952767e-03 3 1  ON 98
ci_0050                -5.592568e-03 3 1  ON 99
ci_0051                -3.605595e-03 3 1  ON 100
ci_0052                -3.734163e-03 3 1  ON 101
ci_0053                -4.444066e-03 3 1  ON 102
ci_0054                -4.799368e-03 3 1  ON 103
ci_0055                 6.349303e-03 3 1  ON 104
ci_0056                 6.682585e-03 3 1  ON 105
ci_0057                 4.465736e-03 3 1  ON 106
ci_0058                 5.065591e-03 3 1  ON 107
ci_0059                -4.770150e-03 3 1  ON 108
ci_0060                -5.277862e-03 3 1  ON 109
ci_0061                -3.058672e-03 3 1  ON 110
ci_0062                -3.374005e-03 3 1  ON 111
ci_0063                -9.345592e-03 3 1  ON 112
ci_0064                -8.645071e-03 3 1  ON 113
ci_0065                -5.111897e-03 3 1  ON 114
ci_0066                -5.390944e-03 3 1  ON 115
ci_0067                -4.820295e-03 3 1  ON 116
ci_0068                -5.481212e-03 3 1  ON 117
ci_0069                 4.739697e-03 3 1  ON 118
ci_0070                 4.523585e-03 3 1  ON 119
ci_0071                 2.780245e-04 3 1  ON 120
ci_0072                 6.175595e-04 3 1  ON 121
ci_0073                 4.205776e-03 3 1  ON 122
ci_0074                 4.289341e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.0657e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.9266
    reference variance = 0.344213
====================================================
  Execution time = 2.1097e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5256e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3894e-01
  Total weights = 1.952080752e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.2200e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324348774603
                                         uncertainty =       0.002725638138

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324348774603
                                         uncertainty =       0.002725638138

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402701553
  error estimate for blocks of size 2^( 2) =       0.000415574822
  error estimate for blocks of size 2^( 3) =       0.000428514831
  error estimate for blocks of size 2^( 4) =       0.000440414942
  error estimate for blocks of size 2^( 5) =       0.000452123075
  error estimate for blocks of size 2^( 6) =       0.000459814276
  error estimate for blocks of size 2^( 7) =       0.000465072512

      target function =                  N/A
              le_mean =     -16.906454347183
             les_mean =     286.167133790550
             stat err =       0.000454356201
             autocorr =       1.272993869586
              std dev =       0.569505997250
             le_variance =       0.324337080904


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690645434718e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906454347172       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906456771714       residual = 4.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906456798420       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906456899473       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906457014292       residual = 6.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906457123356       residual = 3.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906457246416       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906457250198       residual = 3.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906457226836       residual = 2.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906457192474       residual = 3.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.9062e+00 is 8.912001e-05

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906454347172       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906454978623       residual = 4.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906454988082       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906455016635       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906455047513       residual = 6.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906455074216       residual = 3.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906455107057       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906455109743       residual = 2.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906455105250       residual = 1.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906455097470       residual = 3.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5625e+01 is 2.276848e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906454347172       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906454506700       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906454509258       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906454516623       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906454524490       residual = 6.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906454531157       residual = 3.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906454539482       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906454540291       residual = 2.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906454539286       residual = 1.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906454537392       residual = 3.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 6.2500e+01 is 5.735008e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.055457 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7324e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
   uu_0                 3.124989e-01 1 1  ON 0
   uu_1                 1.450231e-01 1 1  ON 1
   uu_2                 4.339025e-02 1 1  ON 2
   uu_3                -1.939686e-02 1 1  ON 3
   uu_4                -6.550846e-02 1 1  ON 4
   uu_5                -1.009095e-01 1 1  ON 5
   uu_6                -1.287746e-01 1 1  ON 6
   uu_7                -1.429547e-01 1 1  ON 7
   uu_8                -1.357781e-01 1 1  ON 8
   uu_9                -1.045809e-01 1 1  ON 9
   ud_0                 4.478501e-01 1 1  ON 10
   ud_1                 1.818578e-01 1 1  ON 11
   ud_2                 6.175518e-02 1 1  ON 12
   ud_3                -9.071246e-03 1 1  ON 13
   ud_4                -6.598200e-02 1 1  ON 14
   ud_5                -1.077049e-01 1 1  ON 15
   ud_6                -1.350113e-01 1 1  ON 16
   ud_7                -1.519379e-01 1 1  ON 17
   ud_8                -1.529550e-01 1 1  ON 18
   ud_9                -1.412198e-01 1 1  ON 19
   eO_0                -7.511675e-01 1 1  ON 20
   eO_1                -4.306822e-01 1 1  ON 21
   eO_2                -2.036081e-02 1 1  ON 22
   eO_3                 2.922827e-01 1 1  ON 23
   eO_4                 5.177098e-01 1 1  ON 24
   eO_5                 4.799234e-01 1 1  ON 25
   eO_6                 2.534754e-01 1 1  ON 26
   eO_7                -4.492121e-02 1 1  ON 27
   eO_8                -2.175901e-01 1 1  ON 28
   eO_9                -7.876601e-02 1 1  ON 29
  eH1_0                -2.547404e-01 1 1  ON 30
  eH1_1                -1.474743e-01 1 1  ON 31
  eH1_2                -9.796021e-02 1 1  ON 32
  eH1_3                -4.276406e-02 1 1  ON 33
  eH1_4                 6.776184e-03 1 1  ON 34
  eH1_5                 4.190582e-02 1 1  ON 35
  eH1_6                 1.014436e-01 1 1  ON 36
  eH1_7                 1.558886e-01 1 1  ON 37
  eH1_8                 1.760825e-01 1 1  ON 38
  eH1_9                 6.335636e-02 1 1  ON 39
  eH2_0                -2.519806e-01 1 1  ON 40
  eH2_1                -1.446560e-01 1 1  ON 41
  eH2_2                -9.539043e-02 1 1  ON 42
  eH2_3                -4.006348e-02 1 1  ON 43
  eH2_4                 9.744864e-03 1 1  ON 44
  eH2_5                 4.509266e-02 1 1  ON 45
  eH2_6                 1.033666e-01 1 1  ON 46
  eH2_7                 1.572023e-01 1 1  ON 47
  eH2_8                 1.810441e-01 1 1  ON 48
  eH2_9                 5.123333e-02 1 1  ON 49
ci_0001                 7.004154e-01 3 1  ON 50
ci_0002                 7.014888e-01 3 1  ON 51
ci_0003                -2.713619e-02 3 1  ON 52
ci_0004                -2.735582e-02 3 1  ON 53
ci_0005                -3.541691e-02 3 1  ON 54
ci_0006                -3.624309e-02 3 1  ON 55
ci_0007                -2.208907e-02 3 1  ON 56
ci_0008                -2.198576e-02 3 1  ON 57
ci_0009                -1.769278e-02 3 1  ON 58
ci_0010                -1.758685e-02 3 1  ON 59
ci_0011                -1.248505e-02 3 1  ON 60
ci_0012                -1.143363e-02 3 1  ON 61
ci_0013                 1.325412e-02 3 1  ON 62
ci_0014                 1.289829e-02 3 1  ON 63
ci_0015                 1.239593e-02 3 1  ON 64
ci_0016                 1.293380e-02 3 1  ON 65
ci_0017                 1.130390e-02 3 1  ON 66
ci_0018                 1.159588e-02 3 1  ON 67
ci_0019                 1.158716e-02 3 1  ON 68
ci_0020                 1.147566e-02 3 1  ON 69
ci_0021                -2.262718e-04 3 1  ON 70
ci_0022                -1.316283e-03 3 1  ON 71
ci_0023                -1.172019e-02 3 1  ON 72
ci_0024                -1.101432e-02 3 1  ON 73
ci_0025                -1.048067e-02 3 1  ON 74
ci_0026                -1.100340e-02 3 1  ON 75
ci_0027                -1.091344e-02 3 1  ON 76
ci_0028                -1.141470e-02 3 1  ON 77
ci_0029                -1.110382e-02 3 1  ON 78
ci_0030                -1.021019e-02 3 1  ON 79
ci_0031                 2.087899e-02 3 1  ON 80
ci_0032                 2.099539e-02 3 1  ON 81
ci_0033                 9.002228e-03 3 1  ON 82
ci_0034                 9.908585e-03 3 1  ON 83
ci_0035                 6.923709e-03 3 1  ON 84
ci_0036                 6.560355e-03 3 1  ON 85
ci_0037                -1.092836e-02 3 1  ON 86
ci_0038                -1.088744e-02 3 1  ON 87
ci_0039                -2.701578e-03 3 1  ON 88
ci_0040                -2.639965e-03 3 1  ON 89
ci_0041                 6.270775e-03 3 1  ON 90
ci_0042                 7.008324e-03 3 1  ON 91
ci_0043                -1.770951e-02 3 1  ON 92
ci_0044                -1.818877e-02 3 1  ON 93
ci_0045                 7.461906e-03 3 1  ON 94
ci_0046                 7.822312e-03 3 1  ON 95
ci_0047                -1.589325e-03 3 1  ON 96
ci_0048                -1.519654e-03 3 1  ON 97
ci_0049                -4.951120e-03 3 1  ON 98
ci_0050                -5.600409e-03 3 1  ON 99
ci_0051                -3.604373e-03 3 1  ON 100
ci_0052                -3.717828e-03 3 1  ON 101
ci_0053                -4.457819e-03 3 1  ON 102
ci_0054                -4.798518e-03 3 1  ON 103
ci_0055                 6.357332e-03 3 1  ON 104
ci_0056                 6.681479e-03 3 1  ON 105
ci_0057                 4.460043e-03 3 1  ON 106
ci_0058                 5.049733e-03 3 1  ON 107
ci_0059                -4.773601e-03 3 1  ON 108
ci_0060                -5.265037e-03 3 1  ON 109
ci_0061                -3.077561e-03 3 1  ON 110
ci_0062                -3.383957e-03 3 1  ON 111
ci_0063                -9.327391e-03 3 1  ON 112
ci_0064                -8.644112e-03 3 1  ON 113
ci_0065                -5.109189e-03 3 1  ON 114
ci_0066                -5.374054e-03 3 1  ON 115
ci_0067                -4.819930e-03 3 1  ON 116
ci_0068                -5.473094e-03 3 1  ON 117
ci_0069                 4.735331e-03 3 1  ON 118
ci_0070                 4.521452e-03 3 1  ON 119
ci_0071                 2.758671e-04 3 1  ON 120
ci_0072                 6.205530e-04 3 1  ON 121
ci_0073                 4.212908e-03 3 1  ON 122
ci_0074                 4.283617e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.9056
    reference variance = 0.365573
====================================================
  Execution time = 2.1305e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4649e-01
  Total weights = 1.9516e+06
  Execution time = 1.9235e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329378931547
                                         uncertainty =       0.003345318743

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329378931547
                                         uncertainty =       0.003345318743

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405861856
  error estimate for blocks of size 2^( 2) =       0.000418516261
  error estimate for blocks of size 2^( 3) =       0.000431251096
  error estimate for blocks of size 2^( 4) =       0.000443972692
  error estimate for blocks of size 2^( 5) =       0.000453066473
  error estimate for blocks of size 2^( 6) =       0.000459563986
  error estimate for blocks of size 2^( 7) =       0.000465539131

      target function =                  N/A
              le_mean =     -16.906504085236
             les_mean =     286.176361298066
             stat err =       0.000455535570
             autocorr =       1.259760869987
              std dev =       0.573975341386
             le_variance =       0.329447692519

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329363857063
                                         uncertainty =       0.003352160530

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329363857063
                                         uncertainty =       0.003352160530

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405852618
  error estimate for blocks of size 2^( 2) =       0.000418510016
  error estimate for blocks of size 2^( 3) =       0.000431247735
  error estimate for blocks of size 2^( 4) =       0.000443970252
  error estimate for blocks of size 2^( 5) =       0.000453064625
  error estimate for blocks of size 2^( 6) =       0.000459562791
  error estimate for blocks of size 2^( 7) =       0.000465538928

      target function =                  N/A
              le_mean =     -16.906504633589
             les_mean =     286.177805900386
             stat err =       0.000455534149
             autocorr =       1.259810357834
              std dev =       0.573962276917
             le_variance =       0.329432695324

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329368390130
                                         uncertainty =       0.003348822383

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329368390130
                                         uncertainty =       0.003348822383

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405855388
  error estimate for blocks of size 2^( 2) =       0.000418511409
  error estimate for blocks of size 2^( 3) =       0.000431247784
  error estimate for blocks of size 2^( 4) =       0.000443969879
  error estimate for blocks of size 2^( 5) =       0.000453064038
  error estimate for blocks of size 2^( 6) =       0.000459562041
  error estimate for blocks of size 2^( 7) =       0.000465537853

      target function =                  N/A
              le_mean =     -16.906504296079
             les_mean =     286.176392285071
             stat err =       0.000455533453
             autocorr =       1.259789309244
              std dev =       0.573966194501
             le_variance =       0.329437192430

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329377462100
                                         uncertainty =       0.003345757386

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329377462100
                                         uncertainty =       0.003345757386

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405860954
  error estimate for blocks of size 2^( 2) =       0.000418515565
  error estimate for blocks of size 2^( 3) =       0.000431250597
  error estimate for blocks of size 2^( 4) =       0.000443972259
  error estimate for blocks of size 2^( 5) =       0.000453066092
  error estimate for blocks of size 2^( 6) =       0.000459563670
  error estimate for blocks of size 2^( 7) =       0.000465538902

      target function =                  N/A
              le_mean =     -16.906504105277
             les_mean =     286.176362584314
             stat err =       0.000455535231
             autocorr =       1.259764590682
              std dev =       0.573974065948
             le_variance =       0.329446228381


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906504085236        initial
     3.9062e+00     3.9062e+01             8.9120e-05       -16.906504633589  <--
     1.5625e+01     1.5625e+02             2.2768e-05       -16.906504296079
     6.2500e+01     6.2500e+02             5.7350e-06       -16.906504105277

*****************************************************************************
Applying the update for shift_i =   3.9062e+00     and shift_s =   3.9062e+01
*****************************************************************************

  Execution time = 3.1015e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
   uu_0                 3.125006e-01 1 1  ON 0
   uu_1                 1.450262e-01 1 1  ON 1
   uu_2                 4.339037e-02 1 1  ON 2
   uu_3                -1.941081e-02 1 1  ON 3
   uu_4                -6.551680e-02 1 1  ON 4
   uu_5                -1.009145e-01 1 1  ON 5
   uu_6                -1.287918e-01 1 1  ON 6
   uu_7                -1.429734e-01 1 1  ON 7
   uu_8                -1.357817e-01 1 1  ON 8
   uu_9                -1.045726e-01 1 1  ON 9
   ud_0                 4.478304e-01 1 1  ON 10
   ud_1                 1.818974e-01 1 1  ON 11
   ud_2                 6.176216e-02 1 1  ON 12
   ud_3                -9.065493e-03 1 1  ON 13
   ud_4                -6.599303e-02 1 1  ON 14
   ud_5                -1.077099e-01 1 1  ON 15
   ud_6                -1.350052e-01 1 1  ON 16
   ud_7                -1.519401e-01 1 1  ON 17
   ud_8                -1.529709e-01 1 1  ON 18
   ud_9                -1.412272e-01 1 1  ON 19
   eO_0                -7.511798e-01 1 1  ON 20
   eO_1                -4.306847e-01 1 1  ON 21
   eO_2                -2.035336e-02 1 1  ON 22
   eO_3                 2.922926e-01 1 1  ON 23
   eO_4                 5.177244e-01 1 1  ON 24
   eO_5                 4.799207e-01 1 1  ON 25
   eO_6                 2.534962e-01 1 1  ON 26
   eO_7                -4.491072e-02 1 1  ON 27
   eO_8                -2.176104e-01 1 1  ON 28
   eO_9                -7.878890e-02 1 1  ON 29
  eH1_0                -2.547748e-01 1 1  ON 30
  eH1_1                -1.474932e-01 1 1  ON 31
  eH1_2                -9.796030e-02 1 1  ON 32
  eH1_3                -4.280692e-02 1 1  ON 33
  eH1_4                 6.762528e-03 1 1  ON 34
  eH1_5                 4.192763e-02 1 1  ON 35
  eH1_6                 1.014469e-01 1 1  ON 36
  eH1_7                 1.558829e-01 1 1  ON 37
  eH1_8                 1.761145e-01 1 1  ON 38
  eH1_9                 6.340262e-02 1 1  ON 39
  eH2_0                -2.520056e-01 1 1  ON 40
  eH2_1                -1.446808e-01 1 1  ON 41
  eH2_2                -9.540380e-02 1 1  ON 42
  eH2_3                -4.007280e-02 1 1  ON 43
  eH2_4                 9.727861e-03 1 1  ON 44
  eH2_5                 4.509262e-02 1 1  ON 45
  eH2_6                 1.033624e-01 1 1  ON 46
  eH2_7                 1.572197e-01 1 1  ON 47
  eH2_8                 1.810717e-01 1 1  ON 48
  eH2_9                 5.127398e-02 1 1  ON 49
ci_0001                 7.004161e-01 3 1  ON 50
ci_0002                 7.014849e-01 3 1  ON 51
ci_0003                -2.713304e-02 3 1  ON 52
ci_0004                -2.732418e-02 3 1  ON 53
ci_0005                -3.548326e-02 3 1  ON 54
ci_0006                -3.624558e-02 3 1  ON 55
ci_0007                -2.206248e-02 3 1  ON 56
ci_0008                -2.201747e-02 3 1  ON 57
ci_0009                -1.763659e-02 3 1  ON 58
ci_0010                -1.763194e-02 3 1  ON 59
ci_0011                -1.247320e-02 3 1  ON 60
ci_0012                -1.146849e-02 3 1  ON 61
ci_0013                 1.324561e-02 3 1  ON 62
ci_0014                 1.288889e-02 3 1  ON 63
ci_0015                 1.241095e-02 3 1  ON 64
ci_0016                 1.290798e-02 3 1  ON 65
ci_0017                 1.130041e-02 3 1  ON 66
ci_0018                 1.159533e-02 3 1  ON 67
ci_0019                 1.158008e-02 3 1  ON 68
ci_0020                 1.147487e-02 3 1  ON 69
ci_0021                -2.614969e-04 3 1  ON 70
ci_0022                -1.346830e-03 3 1  ON 71
ci_0023                -1.165621e-02 3 1  ON 72
ci_0024                -1.103701e-02 3 1  ON 73
ci_0025                -1.051017e-02 3 1  ON 74
ci_0026                -1.103672e-02 3 1  ON 75
ci_0027                -1.090100e-02 3 1  ON 76
ci_0028                -1.139981e-02 3 1  ON 77
ci_0029                -1.110024e-02 3 1  ON 78
ci_0030                -1.024566e-02 3 1  ON 79
ci_0031                 2.090354e-02 3 1  ON 80
ci_0032                 2.099208e-02 3 1  ON 81
ci_0033                 9.001164e-03 3 1  ON 82
ci_0034                 9.923106e-03 3 1  ON 83
ci_0035                 6.910607e-03 3 1  ON 84
ci_0036                 6.556588e-03 3 1  ON 85
ci_0037                -1.089902e-02 3 1  ON 86
ci_0038                -1.089947e-02 3 1  ON 87
ci_0039                -2.728575e-03 3 1  ON 88
ci_0040                -2.637963e-03 3 1  ON 89
ci_0041                 6.316824e-03 3 1  ON 90
ci_0042                 7.064370e-03 3 1  ON 91
ci_0043                -1.772661e-02 3 1  ON 92
ci_0044                -1.820805e-02 3 1  ON 93
ci_0045                 7.473715e-03 3 1  ON 94
ci_0046                 7.830749e-03 3 1  ON 95
ci_0047                -1.607484e-03 3 1  ON 96
ci_0048                -1.522782e-03 3 1  ON 97
ci_0049                -4.946466e-03 3 1  ON 98
ci_0050                -5.622668e-03 3 1  ON 99
ci_0051                -3.601027e-03 3 1  ON 100
ci_0052                -3.672623e-03 3 1  ON 101
ci_0053                -4.496144e-03 3 1  ON 102
ci_0054                -4.796261e-03 3 1  ON 103
ci_0055                 6.380500e-03 3 1  ON 104
ci_0056                 6.678269e-03 3 1  ON 105
ci_0057                 4.443707e-03 3 1  ON 106
ci_0058                 5.004200e-03 3 1  ON 107
ci_0059                -4.783161e-03 3 1  ON 108
ci_0060                -5.229409e-03 3 1  ON 109
ci_0061                -3.131455e-03 3 1  ON 110
ci_0062                -3.412376e-03 3 1  ON 111
ci_0063                -9.276572e-03 3 1  ON 112
ci_0064                -8.641513e-03 3 1  ON 113
ci_0065                -5.101517e-03 3 1  ON 114
ci_0066                -5.326153e-03 3 1  ON 115
ci_0067                -4.818964e-03 3 1  ON 116
ci_0068                -5.450597e-03 3 1  ON 117
ci_0069                 4.723278e-03 3 1  ON 118
ci_0070                 4.515520e-03 3 1  ON 119
ci_0071                 2.697005e-04 3 1  ON 120
ci_0072                 6.288730e-04 3 1  ON 121
ci_0073                 4.232664e-03 3 1  ON 122
ci_0074                 4.267789e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8346e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.9289
    reference variance = 0.329727
====================================================
  Execution time = 2.1429e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5224e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3379e-01
  Total weights = 1.951651111e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0975e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321585631076
                                         uncertainty =       0.001906477205

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321585631076
                                         uncertainty =       0.001906477205

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400950952
  error estimate for blocks of size 2^( 2) =       0.000413681609
  error estimate for blocks of size 2^( 3) =       0.000426478194
  error estimate for blocks of size 2^( 4) =       0.000438048075
  error estimate for blocks of size 2^( 5) =       0.000447869744
  error estimate for blocks of size 2^( 6) =       0.000454495638
  error estimate for blocks of size 2^( 7) =       0.000458549249

      target function =                  N/A
              le_mean =     -16.906436095762
             les_mean =     286.161370002895
             stat err =       0.000449740676
             autocorr =       1.258177283842
              std dev =       0.567030274050
             le_variance =       0.321523331689


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690643609576e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906436095767       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906442142607       residual = 4.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906441760044       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906441364395       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906441581306       residual = 7.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906441563033       residual = 4.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906441739047       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906441937100       residual = 5.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906442025661       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906442043257       residual = 6.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.7656e-01 is 2.526804e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906436095767       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906437839297       residual = 4.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906437730730       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906437632363       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906437702215       residual = 7.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906437701047       residual = 3.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906437713432       residual = 8.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906437753484       residual = 3.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906437784724       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906437787562       residual = 3.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.9062e+00 is 7.367677e-05

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906436095767       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906436549026       residual = 4.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906436521055       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906436496741       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906436516259       residual = 7.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906436517149       residual = 3.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906436517493       residual = 7.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906436525606       residual = 2.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906436533985       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906436534939       residual = 2.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5625e+01 is 1.922462e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.059408 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7534e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
   uu_0                 3.124794e-01 1 1  ON 0
   uu_1                 1.450523e-01 1 1  ON 1
   uu_2                 4.339015e-02 1 1  ON 2
   uu_3                -1.941166e-02 1 1  ON 3
   uu_4                -6.549984e-02 1 1  ON 4
   uu_5                -1.009120e-01 1 1  ON 5
   uu_6                -1.287888e-01 1 1  ON 6
   uu_7                -1.429804e-01 1 1  ON 7
   uu_8                -1.358016e-01 1 1  ON 8
   uu_9                -1.046073e-01 1 1  ON 9
   ud_0                 4.478375e-01 1 1  ON 10
   ud_1                 1.819593e-01 1 1  ON 11
   ud_2                 6.178633e-02 1 1  ON 12
   ud_3                -9.067288e-03 1 1  ON 13
   ud_4                -6.597942e-02 1 1  ON 14
   ud_5                -1.076757e-01 1 1  ON 15
   ud_6                -1.350306e-01 1 1  ON 16
   ud_7                -1.519233e-01 1 1  ON 17
   ud_8                -1.530181e-01 1 1  ON 18
   ud_9                -1.412790e-01 1 1  ON 19
   eO_0                -7.511902e-01 1 1  ON 20
   eO_1                -4.307117e-01 1 1  ON 21
   eO_2                -2.031268e-02 1 1  ON 22
   eO_3                 2.923185e-01 1 1  ON 23
   eO_4                 5.177405e-01 1 1  ON 24
   eO_5                 4.799235e-01 1 1  ON 25
   eO_6                 2.535238e-01 1 1  ON 26
   eO_7                -4.489610e-02 1 1  ON 27
   eO_8                -2.176565e-01 1 1  ON 28
   eO_9                -7.882655e-02 1 1  ON 29
  eH1_0                -2.547913e-01 1 1  ON 30
  eH1_1                -1.475269e-01 1 1  ON 31
  eH1_2                -9.797089e-02 1 1  ON 32
  eH1_3                -4.279711e-02 1 1  ON 33
  eH1_4                 6.750370e-03 1 1  ON 34
  eH1_5                 4.194618e-02 1 1  ON 35
  eH1_6                 1.014352e-01 1 1  ON 36
  eH1_7                 1.558939e-01 1 1  ON 37
  eH1_8                 1.761404e-01 1 1  ON 38
  eH1_9                 6.342742e-02 1 1  ON 39
  eH2_0                -2.520093e-01 1 1  ON 40
  eH2_1                -1.447013e-01 1 1  ON 41
  eH2_2                -9.540743e-02 1 1  ON 42
  eH2_3                -4.009674e-02 1 1  ON 43
  eH2_4                 9.711848e-03 1 1  ON 44
  eH2_5                 4.509183e-02 1 1  ON 45
  eH2_6                 1.033339e-01 1 1  ON 46
  eH2_7                 1.572232e-01 1 1  ON 47
  eH2_8                 1.811152e-01 1 1  ON 48
  eH2_9                 5.132305e-02 1 1  ON 49
ci_0001                 7.004126e-01 3 1  ON 50
ci_0002                 7.014913e-01 3 1  ON 51
ci_0003                -2.713605e-02 3 1  ON 52
ci_0004                -2.732643e-02 3 1  ON 53
ci_0005                -3.547540e-02 3 1  ON 54
ci_0006                -3.628024e-02 3 1  ON 55
ci_0007                -2.204385e-02 3 1  ON 56
ci_0008                -2.206923e-02 3 1  ON 57
ci_0009                -1.771027e-02 3 1  ON 58
ci_0010                -1.763445e-02 3 1  ON 59
ci_0011                -1.245306e-02 3 1  ON 60
ci_0012                -1.151694e-02 3 1  ON 61
ci_0013                 1.318987e-02 3 1  ON 62
ci_0014                 1.289554e-02 3 1  ON 63
ci_0015                 1.245155e-02 3 1  ON 64
ci_0016                 1.289303e-02 3 1  ON 65
ci_0017                 1.127962e-02 3 1  ON 66
ci_0018                 1.156607e-02 3 1  ON 67
ci_0019                 1.152216e-02 3 1  ON 68
ci_0020                 1.149470e-02 3 1  ON 69
ci_0021                -2.725340e-04 3 1  ON 70
ci_0022                -1.334719e-03 3 1  ON 71
ci_0023                -1.160105e-02 3 1  ON 72
ci_0024                -1.098808e-02 3 1  ON 73
ci_0025                -1.049045e-02 3 1  ON 74
ci_0026                -1.100204e-02 3 1  ON 75
ci_0027                -1.089664e-02 3 1  ON 76
ci_0028                -1.137627e-02 3 1  ON 77
ci_0029                -1.109785e-02 3 1  ON 78
ci_0030                -1.027683e-02 3 1  ON 79
ci_0031                 2.085034e-02 3 1  ON 80
ci_0032                 2.095965e-02 3 1  ON 81
ci_0033                 9.043965e-03 3 1  ON 82
ci_0034                 9.890174e-03 3 1  ON 83
ci_0035                 6.926462e-03 3 1  ON 84
ci_0036                 6.557705e-03 3 1  ON 85
ci_0037                -1.085339e-02 3 1  ON 86
ci_0038                -1.091653e-02 3 1  ON 87
ci_0039                -2.711216e-03 3 1  ON 88
ci_0040                -2.626857e-03 3 1  ON 89
ci_0041                 6.353726e-03 3 1  ON 90
ci_0042                 7.113683e-03 3 1  ON 91
ci_0043                -1.773879e-02 3 1  ON 92
ci_0044                -1.818507e-02 3 1  ON 93
ci_0045                 7.516485e-03 3 1  ON 94
ci_0046                 7.805892e-03 3 1  ON 95
ci_0047                -1.570625e-03 3 1  ON 96
ci_0048                -1.561928e-03 3 1  ON 97
ci_0049                -5.009503e-03 3 1  ON 98
ci_0050                -5.623742e-03 3 1  ON 99
ci_0051                -3.549620e-03 3 1  ON 100
ci_0052                -3.644378e-03 3 1  ON 101
ci_0053                -4.497752e-03 3 1  ON 102
ci_0054                -4.779382e-03 3 1  ON 103
ci_0055                 6.333093e-03 3 1  ON 104
ci_0056                 6.682589e-03 3 1  ON 105
ci_0057                 4.472592e-03 3 1  ON 106
ci_0058                 4.993951e-03 3 1  ON 107
ci_0059                -4.828909e-03 3 1  ON 108
ci_0060                -5.209858e-03 3 1  ON 109
ci_0061                -3.143471e-03 3 1  ON 110
ci_0062                -3.456864e-03 3 1  ON 111
ci_0063                -9.232985e-03 3 1  ON 112
ci_0064                -8.631309e-03 3 1  ON 113
ci_0065                -5.150327e-03 3 1  ON 114
ci_0066                -5.330667e-03 3 1  ON 115
ci_0067                -4.846168e-03 3 1  ON 116
ci_0068                -5.427897e-03 3 1  ON 117
ci_0069                 4.651369e-03 3 1  ON 118
ci_0070                 4.507638e-03 3 1  ON 119
ci_0071                 2.655366e-04 3 1  ON 120
ci_0072                 6.145053e-04 3 1  ON 121
ci_0073                 4.192258e-03 3 1  ON 122
ci_0074                 4.241910e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.9282
    reference variance = 0.225326
====================================================
  Execution time = 2.1330e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3725e-01
  Total weights = 1.9516e+06
  Execution time = 1.9193e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324492824016
                                         uncertainty =       0.002481607713

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324492824016
                                         uncertainty =       0.002481607713

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402797860
  error estimate for blocks of size 2^( 2) =       0.000415653829
  error estimate for blocks of size 2^( 3) =       0.000428965147
  error estimate for blocks of size 2^( 4) =       0.000440866550
  error estimate for blocks of size 2^( 5) =       0.000453160747
  error estimate for blocks of size 2^( 6) =       0.000461058618
  error estimate for blocks of size 2^( 7) =       0.000465618454

      target function =                  N/A
              le_mean =     -16.906949451421
             les_mean =     286.182389924100
             stat err =       0.000455176092
             autocorr =       1.276981414563
              std dev =       0.569642196692
             le_variance =       0.324492232252

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324281057454
                                         uncertainty =       0.002478136781

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324281057454
                                         uncertainty =       0.002478136781

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402666653
  error estimate for blocks of size 2^( 2) =       0.000415527901
  error estimate for blocks of size 2^( 3) =       0.000428843816
  error estimate for blocks of size 2^( 4) =       0.000440747503
  error estimate for blocks of size 2^( 5) =       0.000453043146
  error estimate for blocks of size 2^( 6) =       0.000460932212
  error estimate for blocks of size 2^( 7) =       0.000465488256

      target function =                  N/A
              le_mean =     -16.906952351935
             les_mean =     286.184986504490
             stat err =       0.000455052779
             autocorr =       1.277121491847
              std dev =       0.569456641369
             le_variance =       0.324280866399

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324347065157
                                         uncertainty =       0.002479613763

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324347065157
                                         uncertainty =       0.002479613763

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402707530
  error estimate for blocks of size 2^( 2) =       0.000415567223
  error estimate for blocks of size 2^( 3) =       0.000428881961
  error estimate for blocks of size 2^( 4) =       0.000440785006
  error estimate for blocks of size 2^( 5) =       0.000453080179
  error estimate for blocks of size 2^( 6) =       0.000460973314
  error estimate for blocks of size 2^( 7) =       0.000465530378

      target function =                  N/A
              le_mean =     -16.906950779024
             les_mean =     286.182402963929
             stat err =       0.000455092219
             autocorr =       1.277083578615
              std dev =       0.569514450651
             le_variance =       0.324346709500

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324472313842
                                         uncertainty =       0.002481338966

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324472313842
                                         uncertainty =       0.002481338966

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402785149
  error estimate for blocks of size 2^( 2) =       0.000415641634
  error estimate for blocks of size 2^( 3) =       0.000428953440
  error estimate for blocks of size 2^( 4) =       0.000440855012
  error estimate for blocks of size 2^( 5) =       0.000453149411
  error estimate for blocks of size 2^( 6) =       0.000461046703
  error estimate for blocks of size 2^( 7) =       0.000465606198

      target function =                  N/A
              le_mean =     -16.906949522186
             les_mean =     286.182277977526
             stat err =       0.000455164331
             autocorr =       1.276996017091
              std dev =       0.569624221093
             le_variance =       0.324471753255


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906949451421        initial
     9.7656e-01     9.7656e+00             2.5268e-04       -16.906952351935  <--
     3.9062e+00     3.9062e+01             7.3677e-05       -16.906950779024
     1.5625e+01     1.5625e+02             1.9225e-05       -16.906949522186

*****************************************************************************
Applying the update for shift_i =   9.7656e-01     and shift_s =   9.7656e+00
*****************************************************************************

  Execution time = 3.0981e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
   uu_0                 3.124362e-01 1 1  ON 0
   uu_1                 1.451145e-01 1 1  ON 1
   uu_2                 4.339299e-02 1 1  ON 2
   uu_3                -1.940909e-02 1 1  ON 3
   uu_4                -6.545857e-02 1 1  ON 4
   uu_5                -1.009006e-01 1 1  ON 5
   uu_6                -1.287826e-01 1 1  ON 6
   uu_7                -1.430029e-01 1 1  ON 7
   uu_8                -1.358621e-01 1 1  ON 8
   uu_9                -1.047105e-01 1 1  ON 9
   ud_0                 4.478944e-01 1 1  ON 10
   ud_1                 1.821052e-01 1 1  ON 11
   ud_2                 6.185620e-02 1 1  ON 12
   ud_3                -9.059697e-03 1 1  ON 13
   ud_4                -6.594379e-02 1 1  ON 14
   ud_5                -1.075919e-01 1 1  ON 15
   ud_6                -1.350887e-01 1 1  ON 16
   ud_7                -1.518807e-01 1 1  ON 17
   ud_8                -1.531560e-01 1 1  ON 18
   ud_9                -1.414313e-01 1 1  ON 19
   eO_0                -7.512218e-01 1 1  ON 20
   eO_1                -4.307669e-01 1 1  ON 21
   eO_2                -2.021355e-02 1 1  ON 22
   eO_3                 2.923894e-01 1 1  ON 23
   eO_4                 5.177886e-01 1 1  ON 24
   eO_5                 4.799360e-01 1 1  ON 25
   eO_6                 2.536043e-01 1 1  ON 26
   eO_7                -4.485433e-02 1 1  ON 27
   eO_8                -2.177922e-01 1 1  ON 28
   eO_9                -7.893750e-02 1 1  ON 29
  eH1_0                -2.548425e-01 1 1  ON 30
  eH1_1                -1.476150e-01 1 1  ON 31
  eH1_2                -9.800191e-02 1 1  ON 32
  eH1_3                -4.277730e-02 1 1  ON 33
  eH1_4                 6.718877e-03 1 1  ON 34
  eH1_5                 4.199814e-02 1 1  ON 35
  eH1_6                 1.014015e-01 1 1  ON 36
  eH1_7                 1.559253e-01 1 1  ON 37
  eH1_8                 1.762158e-01 1 1  ON 38
  eH1_9                 6.349999e-02 1 1  ON 39
  eH2_0                -2.520214e-01 1 1  ON 40
  eH2_1                -1.447571e-01 1 1  ON 41
  eH2_2                -9.542451e-02 1 1  ON 42
  eH2_3                -4.016035e-02 1 1  ON 43
  eH2_4                 9.661821e-03 1 1  ON 44
  eH2_5                 4.508864e-02 1 1  ON 45
  eH2_6                 1.032517e-01 1 1  ON 46
  eH2_7                 1.572332e-01 1 1  ON 47
  eH2_8                 1.812425e-01 1 1  ON 48
  eH2_9                 5.146703e-02 1 1  ON 49
ci_0001                 7.003993e-01 3 1  ON 50
ci_0002                 7.015109e-01 3 1  ON 51
ci_0003                -2.714757e-02 3 1  ON 52
ci_0004                -2.733275e-02 3 1  ON 53
ci_0005                -3.545310e-02 3 1  ON 54
ci_0006                -3.637122e-02 3 1  ON 55
ci_0007                -2.199117e-02 3 1  ON 56
ci_0008                -2.221067e-02 3 1  ON 57
ci_0009                -1.788927e-02 3 1  ON 58
ci_0010                -1.764123e-02 3 1  ON 59
ci_0011                -1.240602e-02 3 1  ON 60
ci_0012                -1.163733e-02 3 1  ON 61
ci_0013                 1.305380e-02 3 1  ON 62
ci_0014                 1.291250e-02 3 1  ON 63
ci_0015                 1.255272e-02 3 1  ON 64
ci_0016                 1.285688e-02 3 1  ON 65
ci_0017                 1.123155e-02 3 1  ON 66
ci_0018                 1.149611e-02 3 1  ON 67
ci_0019                 1.138045e-02 3 1  ON 68
ci_0020                 1.154421e-02 3 1  ON 69
ci_0021                -3.020389e-04 3 1  ON 70
ci_0022                -1.297959e-03 3 1  ON 71
ci_0023                -1.147045e-02 3 1  ON 72
ci_0024                -1.087063e-02 3 1  ON 73
ci_0025                -1.044238e-02 3 1  ON 74
ci_0026                -1.091864e-02 3 1  ON 75
ci_0027                -1.088678e-02 3 1  ON 76
ci_0028                -1.131909e-02 3 1  ON 77
ci_0029                -1.109062e-02 3 1  ON 78
ci_0030                -1.035355e-02 3 1  ON 79
ci_0031                 2.070604e-02 3 1  ON 80
ci_0032                 2.087408e-02 3 1  ON 81
ci_0033                 9.159303e-03 3 1  ON 82
ci_0034                 9.800220e-03 3 1  ON 83
ci_0035                 6.965219e-03 3 1  ON 84
ci_0036                 6.560209e-03 3 1  ON 85
ci_0037                -1.073834e-02 3 1  ON 86
ci_0038                -1.095950e-02 3 1  ON 87
ci_0039                -2.673163e-03 3 1  ON 88
ci_0040                -2.602306e-03 3 1  ON 89
ci_0041                 6.444654e-03 3 1  ON 90
ci_0042                 7.235835e-03 3 1  ON 91
ci_0043                -1.777156e-02 3 1  ON 92
ci_0044                -1.812063e-02 3 1  ON 93
ci_0045                 7.627772e-03 3 1  ON 94
ci_0046                 7.741135e-03 3 1  ON 95
ci_0047                -1.489063e-03 3 1  ON 96
ci_0048                -1.648195e-03 3 1  ON 97
ci_0049                -5.163833e-03 3 1  ON 98
ci_0050                -5.625953e-03 3 1  ON 99
ci_0051                -3.435803e-03 3 1  ON 100
ci_0052                -3.581140e-03 3 1  ON 101
ci_0053                -4.502213e-03 3 1  ON 102
ci_0054                -4.741374e-03 3 1  ON 103
ci_0055                 6.210488e-03 3 1  ON 104
ci_0056                 6.692829e-03 3 1  ON 105
ci_0057                 4.546525e-03 3 1  ON 106
ci_0058                 4.967521e-03 3 1  ON 107
ci_0059                -4.933190e-03 3 1  ON 108
ci_0060                -5.165377e-03 3 1  ON 109
ci_0061                -3.173689e-03 3 1  ON 110
ci_0062                -3.567397e-03 3 1  ON 111
ci_0063                -9.133272e-03 3 1  ON 112
ci_0064                -8.607548e-03 3 1  ON 113
ci_0065                -5.266222e-03 3 1  ON 114
ci_0066                -5.340488e-03 3 1  ON 115
ci_0067                -4.908456e-03 3 1  ON 116
ci_0068                -5.376865e-03 3 1  ON 117
ci_0069                 4.489444e-03 3 1  ON 118
ci_0070                 4.490242e-03 3 1  ON 119
ci_0071                 2.563099e-04 3 1  ON 120
ci_0072                 5.784234e-04 3 1  ON 121
ci_0073                 4.102716e-03 3 1  ON 122
ci_0074                 4.184057e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8522e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.8883
    reference variance = 0.189016
====================================================
  Execution time = 2.1822e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5239e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3371e-01
  Total weights = 1.951547535e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1197e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321027533764
                                         uncertainty =       0.002314101401

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321027533764
                                         uncertainty =       0.002314101401

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400566437
  error estimate for blocks of size 2^( 2) =       0.000413369619
  error estimate for blocks of size 2^( 3) =       0.000426269151
  error estimate for blocks of size 2^( 4) =       0.000438701681
  error estimate for blocks of size 2^( 5) =       0.000450464534
  error estimate for blocks of size 2^( 6) =       0.000458039866
  error estimate for blocks of size 2^( 7) =       0.000464876186

      target function =                  N/A
              le_mean =     -16.905923444367
             les_mean =     286.143952994788
             stat err =       0.000453020567
             autocorr =       1.279047650484
              std dev =       0.566486487328
             le_variance =       0.320906940325


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690592344437e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905923444368       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905931929068       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905929878242       residual = 4.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905930129759       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905929730398       residual = 7.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905929845503       residual = 6.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905930426450       residual = 2.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905929840011       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905929922170       residual = 8.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905930197692       residual = 2.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905930212740       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905930280621       residual = 7.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.4414e-01 is 9.111193e-04

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905923444368       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905926748087       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905926044640       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905926120566       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905926056239       residual = 5.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905925907701       residual = 4.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905926102968       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905926044966       residual = 4.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905925997894       residual = 3.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905926084684       residual = 4.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.7656e-01 is 2.974256e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905923444368       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905924404053       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905924204851       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905924232530       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905924223604       residual = 5.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905924145938       residual = 3.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905924182323       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905924183704       residual = 2.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905924183923       residual = 1.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905924199702       residual = 3.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.9062e+00 is 8.774257e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.063934 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7950e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
   uu_0                 3.124954e-01 1 1  ON 0
   uu_1                 1.451126e-01 1 1  ON 1
   uu_2                 4.330304e-02 1 1  ON 2
   uu_3                -1.946365e-02 1 1  ON 3
   uu_4                -6.548702e-02 1 1  ON 4
   uu_5                -1.009300e-01 1 1  ON 5
   uu_6                -1.288625e-01 1 1  ON 6
   uu_7                -1.430501e-01 1 1  ON 7
   uu_8                -1.357641e-01 1 1  ON 8
   uu_9                -1.047217e-01 1 1  ON 9
   ud_0                 4.479170e-01 1 1  ON 10
   ud_1                 1.820638e-01 1 1  ON 11
   ud_2                 6.193132e-02 1 1  ON 12
   ud_3                -9.022069e-03 1 1  ON 13
   ud_4                -6.600917e-02 1 1  ON 14
   ud_5                -1.076131e-01 1 1  ON 15
   ud_6                -1.351086e-01 1 1  ON 16
   ud_7                -1.519425e-01 1 1  ON 17
   ud_8                -1.531348e-01 1 1  ON 18
   ud_9                -1.413869e-01 1 1  ON 19
   eO_0                -7.512914e-01 1 1  ON 20
   eO_1                -4.308642e-01 1 1  ON 21
   eO_2                -2.005687e-02 1 1  ON 22
   eO_3                 2.924289e-01 1 1  ON 23
   eO_4                 5.177951e-01 1 1  ON 24
   eO_5                 4.800296e-01 1 1  ON 25
   eO_6                 2.536456e-01 1 1  ON 26
   eO_7                -4.483318e-02 1 1  ON 27
   eO_8                -2.178687e-01 1 1  ON 28
   eO_9                -7.903512e-02 1 1  ON 29
  eH1_0                -2.549177e-01 1 1  ON 30
  eH1_1                -1.476113e-01 1 1  ON 31
  eH1_2                -9.801885e-02 1 1  ON 32
  eH1_3                -4.290760e-02 1 1  ON 33
  eH1_4                 6.539610e-03 1 1  ON 34
  eH1_5                 4.197391e-02 1 1  ON 35
  eH1_6                 1.013007e-01 1 1  ON 36
  eH1_7                 1.559820e-01 1 1  ON 37
  eH1_8                 1.764368e-01 1 1  ON 38
  eH1_9                 6.372894e-02 1 1  ON 39
  eH2_0                -2.520841e-01 1 1  ON 40
  eH2_1                -1.449434e-01 1 1  ON 41
  eH2_2                -9.551453e-02 1 1  ON 42
  eH2_3                -4.018941e-02 1 1  ON 43
  eH2_4                 9.596537e-03 1 1  ON 44
  eH2_5                 4.500202e-02 1 1  ON 45
  eH2_6                 1.033295e-01 1 1  ON 46
  eH2_7                 1.573038e-01 1 1  ON 47
  eH2_8                 1.813830e-01 1 1  ON 48
  eH2_9                 5.167771e-02 1 1  ON 49
ci_0001                 7.003580e-01 3 1  ON 50
ci_0002                 7.015916e-01 3 1  ON 51
ci_0003                -2.721900e-02 3 1  ON 52
ci_0004                -2.734896e-02 3 1  ON 53
ci_0005                -3.533387e-02 3 1  ON 54
ci_0006                -3.623976e-02 3 1  ON 55
ci_0007                -2.184656e-02 3 1  ON 56
ci_0008                -2.212507e-02 3 1  ON 57
ci_0009                -1.759184e-02 3 1  ON 58
ci_0010                -1.752674e-02 3 1  ON 59
ci_0011                -1.231783e-02 3 1  ON 60
ci_0012                -1.170897e-02 3 1  ON 61
ci_0013                 1.322960e-02 3 1  ON 62
ci_0014                 1.304820e-02 3 1  ON 63
ci_0015                 1.244499e-02 3 1  ON 64
ci_0016                 1.288560e-02 3 1  ON 65
ci_0017                 1.126455e-02 3 1  ON 66
ci_0018                 1.143551e-02 3 1  ON 67
ci_0019                 1.134772e-02 3 1  ON 68
ci_0020                 1.161600e-02 3 1  ON 69
ci_0021                -2.557510e-04 3 1  ON 70
ci_0022                -1.202385e-03 3 1  ON 71
ci_0023                -1.137872e-02 3 1  ON 72
ci_0024                -1.079038e-02 3 1  ON 73
ci_0025                -1.060035e-02 3 1  ON 74
ci_0026                -1.082657e-02 3 1  ON 75
ci_0027                -1.088266e-02 3 1  ON 76
ci_0028                -1.123618e-02 3 1  ON 77
ci_0029                -1.083644e-02 3 1  ON 78
ci_0030                -1.029190e-02 3 1  ON 79
ci_0031                 2.060878e-02 3 1  ON 80
ci_0032                 2.090719e-02 3 1  ON 81
ci_0033                 9.187031e-03 3 1  ON 82
ci_0034                 9.898001e-03 3 1  ON 83
ci_0035                 6.940122e-03 3 1  ON 84
ci_0036                 6.464716e-03 3 1  ON 85
ci_0037                -1.074159e-02 3 1  ON 86
ci_0038                -1.086912e-02 3 1  ON 87
ci_0039                -2.690534e-03 3 1  ON 88
ci_0040                -2.675905e-03 3 1  ON 89
ci_0041                 6.674573e-03 3 1  ON 90
ci_0042                 7.141029e-03 3 1  ON 91
ci_0043                -1.777598e-02 3 1  ON 92
ci_0044                -1.815602e-02 3 1  ON 93
ci_0045                 7.461702e-03 3 1  ON 94
ci_0046                 7.848198e-03 3 1  ON 95
ci_0047                -1.537277e-03 3 1  ON 96
ci_0048                -1.638024e-03 3 1  ON 97
ci_0049                -5.102337e-03 3 1  ON 98
ci_0050                -5.467851e-03 3 1  ON 99
ci_0051                -3.474606e-03 3 1  ON 100
ci_0052                -3.581833e-03 3 1  ON 101
ci_0053                -4.773064e-03 3 1  ON 102
ci_0054                -4.607413e-03 3 1  ON 103
ci_0055                 6.378903e-03 3 1  ON 104
ci_0056                 6.508654e-03 3 1  ON 105
ci_0057                 4.338158e-03 3 1  ON 106
ci_0058                 4.897918e-03 3 1  ON 107
ci_0059                -4.800355e-03 3 1  ON 108
ci_0060                -4.949420e-03 3 1  ON 109
ci_0061                -3.347162e-03 3 1  ON 110
ci_0062                -3.532199e-03 3 1  ON 111
ci_0063                -9.045781e-03 3 1  ON 112
ci_0064                -8.456390e-03 3 1  ON 113
ci_0065                -5.484689e-03 3 1  ON 114
ci_0066                -5.284687e-03 3 1  ON 115
ci_0067                -4.913400e-03 3 1  ON 116
ci_0068                -5.281393e-03 3 1  ON 117
ci_0069                 4.441271e-03 3 1  ON 118
ci_0070                 4.429784e-03 3 1  ON 119
ci_0071                 3.963375e-04 3 1  ON 120
ci_0072                 5.739539e-04 3 1  ON 121
ci_0073                 4.127787e-03 3 1  ON 122
ci_0074                 4.228332e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.8625
    reference variance = 0.299377
====================================================
  Execution time = 2.0855e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3324e-01
  Total weights = 1.9517e+06
  Execution time = 1.9159e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321058566473
                                         uncertainty =       0.002413014394

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321058566473
                                         uncertainty =       0.002413014394

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400634028
  error estimate for blocks of size 2^( 2) =       0.000413662955
  error estimate for blocks of size 2^( 3) =       0.000427334138
  error estimate for blocks of size 2^( 4) =       0.000440860350
  error estimate for blocks of size 2^( 5) =       0.000453806511
  error estimate for blocks of size 2^( 6) =       0.000462579983
  error estimate for blocks of size 2^( 7) =       0.000471755603

      target function =                  N/A
              le_mean =     -16.906295624222
             les_mean =     286.161258696973
             stat err =       0.000457250612
             autocorr =       1.302605549222
              std dev =       0.566582075596
             le_variance =       0.321015248387

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321059222256
                                         uncertainty =       0.002402072485

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321059222256
                                         uncertainty =       0.002402072485

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400634632
  error estimate for blocks of size 2^( 2) =       0.000413675035
  error estimate for blocks of size 2^( 3) =       0.000427354562
  error estimate for blocks of size 2^( 4) =       0.000440903518
  error estimate for blocks of size 2^( 5) =       0.000453863517
  error estimate for blocks of size 2^( 6) =       0.000462637385
  error estimate for blocks of size 2^( 7) =       0.000471822120

      target function =                  N/A
              le_mean =     -16.906299880578
             les_mean =     286.157037337562
             stat err =       0.000457306635
             autocorr =       1.302920837422
              std dev =       0.566582929452
             le_variance =       0.321016215946

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321031551021
                                         uncertainty =       0.002404128773

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321031551021
                                         uncertainty =       0.002404128773

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400617364
  error estimate for blocks of size 2^( 2) =       0.000413656693
  error estimate for blocks of size 2^( 3) =       0.000427337549
  error estimate for blocks of size 2^( 4) =       0.000440884567
  error estimate for blocks of size 2^( 5) =       0.000453840762
  error estimate for blocks of size 2^( 6) =       0.000462612132
  error estimate for blocks of size 2^( 7) =       0.000471799534

      target function =                  N/A
              le_mean =     -16.906296902233
             les_mean =     286.185769294610
             stat err =       0.000457284249
             autocorr =       1.302905585568
              std dev =       0.566558509984
             le_variance =       0.320988545235

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321044471769
                                         uncertainty =       0.002411243244

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321044471769
                                         uncertainty =       0.002411243244

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400625267
  error estimate for blocks of size 2^( 2) =       0.000413656239
  error estimate for blocks of size 2^( 3) =       0.000427328999
  error estimate for blocks of size 2^( 4) =       0.000440859449
  error estimate for blocks of size 2^( 5) =       0.000453809942
  error estimate for blocks of size 2^( 6) =       0.000462583123
  error estimate for blocks of size 2^( 7) =       0.000471759614

      target function =                  N/A
              le_mean =     -16.906294979598
             les_mean =     286.164666100684
             stat err =       0.000457253032
             autocorr =       1.302676313329
              std dev =       0.566569685390
             le_variance =       0.321001208403


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906295624222        initial
     2.4414e-01     2.4414e+00             9.1112e-04       -16.906299880578  <--
     9.7656e-01     9.7656e+00             2.9743e-04       -16.906296902233
     3.9062e+00     3.9062e+01             8.7743e-05       -16.906294979598

*****************************************************************************
Applying the update for shift_i =   2.4414e-01     and shift_s =   2.4414e+00
*****************************************************************************

  Execution time = 3.0518e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
   uu_0                 3.125608e-01 1 1  ON 0
   uu_1                 1.450722e-01 1 1  ON 1
   uu_2                 4.316298e-02 1 1  ON 2
   uu_3                -1.959130e-02 1 1  ON 3
   uu_4                -6.556686e-02 1 1  ON 4
   uu_5                -1.010335e-01 1 1  ON 5
   uu_6                -1.290263e-01 1 1  ON 6
   uu_7                -1.432025e-01 1 1  ON 7
   uu_8                -1.355366e-01 1 1  ON 8
   uu_9                -1.047607e-01 1 1  ON 9
   ud_0                 4.479625e-01 1 1  ON 10
   ud_1                 1.820699e-01 1 1  ON 11
   ud_2                 6.201869e-02 1 1  ON 12
   ud_3                -8.977063e-03 1 1  ON 13
   ud_4                -6.608468e-02 1 1  ON 14
   ud_5                -1.076920e-01 1 1  ON 15
   ud_6                -1.351626e-01 1 1  ON 16
   ud_7                -1.520945e-01 1 1  ON 17
   ud_8                -1.531078e-01 1 1  ON 18
   ud_9                -1.412659e-01 1 1  ON 19
   eO_0                -7.515126e-01 1 1  ON 20
   eO_1                -4.310377e-01 1 1  ON 21
   eO_2                -1.975952e-02 1 1  ON 22
   eO_3                 2.926458e-01 1 1  ON 23
   eO_4                 5.178194e-01 1 1  ON 24
   eO_5                 4.802785e-01 1 1  ON 25
   eO_6                 2.537772e-01 1 1  ON 26
   eO_7                -4.478015e-02 1 1  ON 27
   eO_8                -2.181031e-01 1 1  ON 28
   eO_9                -7.932605e-02 1 1  ON 29
  eH1_0                -2.551017e-01 1 1  ON 30
  eH1_1                -1.476994e-01 1 1  ON 31
  eH1_2                -9.815074e-02 1 1  ON 32
  eH1_3                -4.321565e-02 1 1  ON 33
  eH1_4                 6.080044e-03 1 1  ON 34
  eH1_5                 4.186401e-02 1 1  ON 35
  eH1_6                 1.010235e-01 1 1  ON 36
  eH1_7                 1.561556e-01 1 1  ON 37
  eH1_8                 1.770896e-01 1 1  ON 38
  eH1_9                 6.441111e-02 1 1  ON 39
  eH2_0                -2.523180e-01 1 1  ON 40
  eH2_1                -1.453521e-01 1 1  ON 41
  eH2_2                -9.579813e-02 1 1  ON 42
  eH2_3                -4.036108e-02 1 1  ON 43
  eH2_4                 9.419734e-03 1 1  ON 44
  eH2_5                 4.477962e-02 1 1  ON 45
  eH2_6                 1.035201e-01 1 1  ON 46
  eH2_7                 1.575063e-01 1 1  ON 47
  eH2_8                 1.817986e-01 1 1  ON 48
  eH2_9                 5.230505e-02 1 1  ON 49
ci_0001                 7.002231e-01 3 1  ON 50
ci_0002                 7.017956e-01 3 1  ON 51
ci_0003                -2.734603e-02 3 1  ON 52
ci_0004                -2.738181e-02 3 1  ON 53
ci_0005                -3.508815e-02 3 1  ON 54
ci_0006                -3.595693e-02 3 1  ON 55
ci_0007                -2.152979e-02 3 1  ON 56
ci_0008                -2.194223e-02 3 1  ON 57
ci_0009                -1.715250e-02 3 1  ON 58
ci_0010                -1.735466e-02 3 1  ON 59
ci_0011                -1.218394e-02 3 1  ON 60
ci_0012                -1.183295e-02 3 1  ON 61
ci_0013                 1.352181e-02 3 1  ON 62
ci_0014                 1.327123e-02 3 1  ON 63
ci_0015                 1.228072e-02 3 1  ON 64
ci_0016                 1.293227e-02 3 1  ON 65
ci_0017                 1.132401e-02 3 1  ON 66
ci_0018                 1.134531e-02 3 1  ON 67
ci_0019                 1.129225e-02 3 1  ON 68
ci_0020                 1.174883e-02 3 1  ON 69
ci_0021                -1.427915e-04 3 1  ON 70
ci_0022                -9.803596e-04 3 1  ON 71
ci_0023                -1.124188e-02 3 1  ON 72
ci_0024                -1.067600e-02 3 1  ON 73
ci_0025                -1.083449e-02 3 1  ON 74
ci_0026                -1.067451e-02 3 1  ON 75
ci_0027                -1.087831e-02 3 1  ON 76
ci_0028                -1.110339e-02 3 1  ON 77
ci_0029                -1.043203e-02 3 1  ON 78
ci_0030                -1.019595e-02 3 1  ON 79
ci_0031                 2.041475e-02 3 1  ON 80
ci_0032                 2.095136e-02 3 1  ON 81
ci_0033                 9.235836e-03 3 1  ON 82
ci_0034                 1.010864e-02 3 1  ON 83
ci_0035                 6.900203e-03 3 1  ON 84
ci_0036                 6.314162e-03 3 1  ON 85
ci_0037                -1.074874e-02 3 1  ON 86
ci_0038                -1.072044e-02 3 1  ON 87
ci_0039                -2.709692e-03 3 1  ON 88
ci_0040                -2.765651e-03 3 1  ON 89
ci_0041                 7.043104e-03 3 1  ON 90
ci_0042                 6.993068e-03 3 1  ON 91
ci_0043                -1.779668e-02 3 1  ON 92
ci_0044                -1.823597e-02 3 1  ON 93
ci_0045                 7.151072e-03 3 1  ON 94
ci_0046                 8.050458e-03 3 1  ON 95
ci_0047                -1.596945e-03 3 1  ON 96
ci_0048                -1.623346e-03 3 1  ON 97
ci_0049                -5.015421e-03 3 1  ON 98
ci_0050                -5.222626e-03 3 1  ON 99
ci_0051                -3.523942e-03 3 1  ON 100
ci_0052                -3.583266e-03 3 1  ON 101
ci_0053                -5.144452e-03 3 1  ON 102
ci_0054                -4.427285e-03 3 1  ON 103
ci_0055                 6.689894e-03 3 1  ON 104
ci_0056                 6.170204e-03 3 1  ON 105
ci_0057                 3.976631e-03 3 1  ON 106
ci_0058                 4.783204e-03 3 1  ON 107
ci_0059                -4.625114e-03 3 1  ON 108
ci_0060                -4.654578e-03 3 1  ON 109
ci_0061                -3.638002e-03 3 1  ON 110
ci_0062                -3.468532e-03 3 1  ON 111
ci_0063                -8.922024e-03 3 1  ON 112
ci_0064                -8.248268e-03 3 1  ON 113
ci_0065                -5.813613e-03 3 1  ON 114
ci_0066                -5.205952e-03 3 1  ON 115
ci_0067                -4.925096e-03 3 1  ON 116
ci_0068                -5.157732e-03 3 1  ON 117
ci_0069                 4.379807e-03 3 1  ON 118
ci_0070                 4.355289e-03 3 1  ON 119
ci_0071                 6.373630e-04 3 1  ON 120
ci_0072                 5.526394e-04 3 1  ON 121
ci_0073                 4.164100e-03 3 1  ON 122
ci_0074                 4.288780e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8476e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.9751
    reference variance = 0.241858
====================================================
  Execution time = 2.1243e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5271e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3599e-01
  Total weights = 1.951818467e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1339e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322456711029
                                         uncertainty =       0.002366489303

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322456711029
                                         uncertainty =       0.002366489303

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401484804
  error estimate for blocks of size 2^( 2) =       0.000414676957
  error estimate for blocks of size 2^( 3) =       0.000427260133
  error estimate for blocks of size 2^( 4) =       0.000439326910
  error estimate for blocks of size 2^( 5) =       0.000449384337
  error estimate for blocks of size 2^( 6) =       0.000456847822
  error estimate for blocks of size 2^( 7) =       0.000460361102

      target function =                  N/A
              le_mean =     -16.906897866966
             les_mean =     286.179188453750
             stat err =       0.000451480042
             autocorr =       1.264558398437
              std dev =       0.567785254943
             le_variance =       0.322380095731


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690689786697e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-02, overlap shift 6.1035e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906897866947       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906906272000       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906907969326       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906910315934       residual = 3.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906912740938       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906914776477       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906913906208       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906913279196       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906912611370       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906913015030       residual = 3.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906913690999       residual = 2.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906915120637       residual = 2.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906916304854       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906915835353       residual = 9.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906914970948       residual = 4.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.906915186451       residual = 2.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.906914942585       residual = 1.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.906914891308       residual = 7.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 6.1035e-02 is 2.998313e-03

solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906897866947       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906902846053       residual = 8.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906903537558       residual = 5.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906905171796       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906906486622       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906906305289       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906906229877       residual = 3.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906905737751       residual = 2.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906905545716       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906905804879       residual = 5.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906905944896       residual = 2.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906906040021       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906906044067       residual = 5.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.4414e-01 is 8.340188e-04

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906897866947       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906899759838       residual = 6.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906899980765       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906900794157       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906901209903       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906901114225       residual = 4.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906900925277       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906900872189       residual = 7.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906900868939       residual = 3.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906900956130       residual = 8.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.7656e-01 is 2.648487e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.071324 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7388e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
   uu_0                 3.129539e-01 1 1  ON 0
   uu_1                 1.454737e-01 1 1  ON 1
   uu_2                 4.350538e-02 1 1  ON 2
   uu_3                -1.932662e-02 1 1  ON 3
   uu_4                -6.547054e-02 1 1  ON 4
   uu_5                -1.009366e-01 1 1  ON 5
   uu_6                -1.292228e-01 1 1  ON 6
   uu_7                -1.434348e-01 1 1  ON 7
   uu_8                -1.362813e-01 1 1  ON 8
   uu_9                -1.055947e-01 1 1  ON 9
   ud_0                 4.482125e-01 1 1  ON 10
   ud_1                 1.823628e-01 1 1  ON 11
   ud_2                 6.222306e-02 1 1  ON 12
   ud_3                -8.781963e-03 1 1  ON 13
   ud_4                -6.590874e-02 1 1  ON 14
   ud_5                -1.076043e-01 1 1  ON 15
   ud_6                -1.350163e-01 1 1  ON 16
   ud_7                -1.517139e-01 1 1  ON 17
   ud_8                -1.534967e-01 1 1  ON 18
   ud_9                -1.420175e-01 1 1  ON 19
   eO_0                -7.513191e-01 1 1  ON 20
   eO_1                -4.307640e-01 1 1  ON 21
   eO_2                -1.978978e-02 1 1  ON 22
   eO_3                 2.927116e-01 1 1  ON 23
   eO_4                 5.180368e-01 1 1  ON 24
   eO_5                 4.805111e-01 1 1  ON 25
   eO_6                 2.541085e-01 1 1  ON 26
   eO_7                -4.457578e-02 1 1  ON 27
   eO_8                -2.188287e-01 1 1  ON 28
   eO_9                -8.000799e-02 1 1  ON 29
  eH1_0                -2.554119e-01 1 1  ON 30
  eH1_1                -1.479938e-01 1 1  ON 31
  eH1_2                -9.841215e-02 1 1  ON 32
  eH1_3                -4.325073e-02 1 1  ON 33
  eH1_4                 6.321540e-03 1 1  ON 34
  eH1_5                 4.190775e-02 1 1  ON 35
  eH1_6                 1.007749e-01 1 1  ON 36
  eH1_7                 1.559592e-01 1 1  ON 37
  eH1_8                 1.775890e-01 1 1  ON 38
  eH1_9                 6.499012e-02 1 1  ON 39
  eH2_0                -2.530737e-01 1 1  ON 40
  eH2_1                -1.459213e-01 1 1  ON 41
  eH2_2                -9.597386e-02 1 1  ON 42
  eH2_3                -4.065112e-02 1 1  ON 43
  eH2_4                 9.368779e-03 1 1  ON 44
  eH2_5                 4.480117e-02 1 1  ON 45
  eH2_6                 1.037082e-01 1 1  ON 46
  eH2_7                 1.578981e-01 1 1  ON 47
  eH2_8                 1.823986e-01 1 1  ON 48
  eH2_9                 5.304502e-02 1 1  ON 49
ci_0001                 7.005583e-01 3 1  ON 50
ci_0002                 7.013808e-01 3 1  ON 51
ci_0003                -2.779023e-02 3 1  ON 52
ci_0004                -2.757234e-02 3 1  ON 53
ci_0005                -3.556806e-02 3 1  ON 54
ci_0006                -3.601729e-02 3 1  ON 55
ci_0007                -2.137015e-02 3 1  ON 56
ci_0008                -2.189452e-02 3 1  ON 57
ci_0009                -1.684639e-02 3 1  ON 58
ci_0010                -1.734988e-02 3 1  ON 59
ci_0011                -1.233939e-02 3 1  ON 60
ci_0012                -1.223227e-02 3 1  ON 61
ci_0013                 1.326034e-02 3 1  ON 62
ci_0014                 1.276672e-02 3 1  ON 63
ci_0015                 1.292665e-02 3 1  ON 64
ci_0016                 1.270678e-02 3 1  ON 65
ci_0017                 1.144730e-02 3 1  ON 66
ci_0018                 1.113688e-02 3 1  ON 67
ci_0019                 1.160505e-02 3 1  ON 68
ci_0020                 1.148144e-02 3 1  ON 69
ci_0021                -2.260978e-04 3 1  ON 70
ci_0022                -1.503015e-03 3 1  ON 71
ci_0023                -1.110224e-02 3 1  ON 72
ci_0024                -1.082430e-02 3 1  ON 73
ci_0025                -1.086402e-02 3 1  ON 74
ci_0026                -1.098706e-02 3 1  ON 75
ci_0027                -1.100876e-02 3 1  ON 76
ci_0028                -1.043738e-02 3 1  ON 77
ci_0029                -1.093665e-02 3 1  ON 78
ci_0030                -1.071799e-02 3 1  ON 79
ci_0031                 2.068292e-02 3 1  ON 80
ci_0032                 2.146430e-02 3 1  ON 81
ci_0033                 9.955280e-03 3 1  ON 82
ci_0034                 9.322924e-03 3 1  ON 83
ci_0035                 6.562649e-03 3 1  ON 84
ci_0036                 6.099619e-03 3 1  ON 85
ci_0037                -1.072127e-02 3 1  ON 86
ci_0038                -1.067659e-02 3 1  ON 87
ci_0039                -2.716626e-03 3 1  ON 88
ci_0040                -2.803392e-03 3 1  ON 89
ci_0041                 7.048121e-03 3 1  ON 90
ci_0042                 7.032366e-03 3 1  ON 91
ci_0043                -1.810297e-02 3 1  ON 92
ci_0044                -1.817182e-02 3 1  ON 93
ci_0045                 7.266274e-03 3 1  ON 94
ci_0046                 7.989974e-03 3 1  ON 95
ci_0047                -1.750726e-03 3 1  ON 96
ci_0048                -1.607830e-03 3 1  ON 97
ci_0049                -5.377689e-03 3 1  ON 98
ci_0050                -5.260085e-03 3 1  ON 99
ci_0051                -3.703950e-03 3 1  ON 100
ci_0052                -3.446390e-03 3 1  ON 101
ci_0053                -4.914674e-03 3 1  ON 102
ci_0054                -4.438226e-03 3 1  ON 103
ci_0055                 6.585354e-03 3 1  ON 104
ci_0056                 6.567528e-03 3 1  ON 105
ci_0057                 4.694794e-03 3 1  ON 106
ci_0058                 4.938180e-03 3 1  ON 107
ci_0059                -4.806674e-03 3 1  ON 108
ci_0060                -4.680043e-03 3 1  ON 109
ci_0061                -3.458062e-03 3 1  ON 110
ci_0062                -3.366179e-03 3 1  ON 111
ci_0063                -8.800750e-03 3 1  ON 112
ci_0064                -8.771614e-03 3 1  ON 113
ci_0065                -5.354945e-03 3 1  ON 114
ci_0066                -5.484659e-03 3 1  ON 115
ci_0067                -4.445175e-03 3 1  ON 116
ci_0068                -4.919079e-03 3 1  ON 117
ci_0069                 4.500586e-03 3 1  ON 118
ci_0070                 4.509899e-03 3 1  ON 119
ci_0071                 2.630951e-04 3 1  ON 120
ci_0072                 8.789335e-04 3 1  ON 121
ci_0073                 3.954246e-03 3 1  ON 122
ci_0074                 4.163070e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.9431
    reference variance = 0.348153
====================================================
  Execution time = 2.1019e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3555e-01
  Total weights = 1.9519e+06
  Execution time = 1.9126e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322344847070
                                         uncertainty =       0.002033974609

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322344847070
                                         uncertainty =       0.002033974609

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401463654
  error estimate for blocks of size 2^( 2) =       0.000414276523
  error estimate for blocks of size 2^( 3) =       0.000427954659
  error estimate for blocks of size 2^( 4) =       0.000439976788
  error estimate for blocks of size 2^( 5) =       0.000451337909
  error estimate for blocks of size 2^( 6) =       0.000459834064
  error estimate for blocks of size 2^( 7) =       0.000466819473

      target function =                  N/A
              le_mean =     -16.905901797087
             les_mean =     286.146475684683
             stat err =       0.000454492059
             autocorr =       1.281622526499
              std dev =       0.567755344229
             le_variance =       0.322346130901

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322679107471
                                         uncertainty =       0.002043429489

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322679107471
                                         uncertainty =       0.002043429489

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401673909
  error estimate for blocks of size 2^( 2) =       0.000414470022
  error estimate for blocks of size 2^( 3) =       0.000428118066
  error estimate for blocks of size 2^( 4) =       0.000440102723
  error estimate for blocks of size 2^( 5) =       0.000451450650
  error estimate for blocks of size 2^( 6) =       0.000459970604
  error estimate for blocks of size 2^( 7) =       0.000467012258

      target function =                  N/A
              le_mean =     -16.905910233589
             les_mean =     286.151222414845
             stat err =       0.000454634059
             autocorr =       1.281081293381
              std dev =       0.568052690148
             le_variance =       0.322683858784

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322752491122
                                         uncertainty =       0.002043381856

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322752491122
                                         uncertainty =       0.002043381856

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401719495
  error estimate for blocks of size 2^( 2) =       0.000414516015
  error estimate for blocks of size 2^( 3) =       0.000428167446
  error estimate for blocks of size 2^( 4) =       0.000440145554
  error estimate for blocks of size 2^( 5) =       0.000451484706
  error estimate for blocks of size 2^( 6) =       0.000460001369
  error estimate for blocks of size 2^( 7) =       0.000467058811

      target function =                  N/A
              le_mean =     -16.905911359722
             les_mean =     286.147337249232
             stat err =       0.000454672610
             autocorr =       1.281007782627
              std dev =       0.568117158712
             le_variance =       0.322757106023

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322334276163
                                         uncertainty =       0.002033810239

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322334276163
                                         uncertainty =       0.002033810239

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401457468
  error estimate for blocks of size 2^( 2) =       0.000414267251
  error estimate for blocks of size 2^( 3) =       0.000427941411
  error estimate for blocks of size 2^( 4) =       0.000439956921
  error estimate for blocks of size 2^( 5) =       0.000451318175
  error estimate for blocks of size 2^( 6) =       0.000459817919
  error estimate for blocks of size 2^( 7) =       0.000466814615

      target function =                  N/A
              le_mean =     -16.905897649958
             les_mean =     286.145573796681
             stat err =       0.000454476908
             autocorr =       1.281576569882
              std dev =       0.567746596602
             le_variance =       0.322336197953


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905901797087        initial
     6.1035e-02     6.1035e-01             2.9983e-03       -16.905910233589
     2.4414e-01     2.4414e+00             8.3402e-04       -16.905911359722  <--
     9.7656e-01     9.7656e+00             2.6485e-04       -16.905897649958

*****************************************************************************
Applying the update for shift_i =   2.4414e-01     and shift_s =   2.4414e+00
*****************************************************************************

  Execution time = 3.0663e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
   uu_0                 3.129539e-01 1 1  ON 0
   uu_1                 1.454737e-01 1 1  ON 1
   uu_2                 4.350538e-02 1 1  ON 2
   uu_3                -1.932662e-02 1 1  ON 3
   uu_4                -6.547054e-02 1 1  ON 4
   uu_5                -1.009366e-01 1 1  ON 5
   uu_6                -1.292228e-01 1 1  ON 6
   uu_7                -1.434348e-01 1 1  ON 7
   uu_8                -1.362813e-01 1 1  ON 8
   uu_9                -1.055947e-01 1 1  ON 9
   ud_0                 4.482125e-01 1 1  ON 10
   ud_1                 1.823628e-01 1 1  ON 11
   ud_2                 6.222306e-02 1 1  ON 12
   ud_3                -8.781963e-03 1 1  ON 13
   ud_4                -6.590874e-02 1 1  ON 14
   ud_5                -1.076043e-01 1 1  ON 15
   ud_6                -1.350163e-01 1 1  ON 16
   ud_7                -1.517139e-01 1 1  ON 17
   ud_8                -1.534967e-01 1 1  ON 18
   ud_9                -1.420175e-01 1 1  ON 19
   eO_0                -7.513191e-01 1 1  ON 20
   eO_1                -4.307640e-01 1 1  ON 21
   eO_2                -1.978978e-02 1 1  ON 22
   eO_3                 2.927116e-01 1 1  ON 23
   eO_4                 5.180368e-01 1 1  ON 24
   eO_5                 4.805111e-01 1 1  ON 25
   eO_6                 2.541085e-01 1 1  ON 26
   eO_7                -4.457578e-02 1 1  ON 27
   eO_8                -2.188287e-01 1 1  ON 28
   eO_9                -8.000799e-02 1 1  ON 29
  eH1_0                -2.554119e-01 1 1  ON 30
  eH1_1                -1.479938e-01 1 1  ON 31
  eH1_2                -9.841215e-02 1 1  ON 32
  eH1_3                -4.325073e-02 1 1  ON 33
  eH1_4                 6.321540e-03 1 1  ON 34
  eH1_5                 4.190775e-02 1 1  ON 35
  eH1_6                 1.007749e-01 1 1  ON 36
  eH1_7                 1.559592e-01 1 1  ON 37
  eH1_8                 1.775890e-01 1 1  ON 38
  eH1_9                 6.499012e-02 1 1  ON 39
  eH2_0                -2.530737e-01 1 1  ON 40
  eH2_1                -1.459213e-01 1 1  ON 41
  eH2_2                -9.597386e-02 1 1  ON 42
  eH2_3                -4.065112e-02 1 1  ON 43
  eH2_4                 9.368779e-03 1 1  ON 44
  eH2_5                 4.480117e-02 1 1  ON 45
  eH2_6                 1.037082e-01 1 1  ON 46
  eH2_7                 1.578981e-01 1 1  ON 47
  eH2_8                 1.823986e-01 1 1  ON 48
  eH2_9                 5.304502e-02 1 1  ON 49
ci_0001                 7.005583e-01 3 1  ON 50
ci_0002                 7.013808e-01 3 1  ON 51
ci_0003                -2.779023e-02 3 1  ON 52
ci_0004                -2.757234e-02 3 1  ON 53
ci_0005                -3.556806e-02 3 1  ON 54
ci_0006                -3.601729e-02 3 1  ON 55
ci_0007                -2.137015e-02 3 1  ON 56
ci_0008                -2.189452e-02 3 1  ON 57
ci_0009                -1.684639e-02 3 1  ON 58
ci_0010                -1.734988e-02 3 1  ON 59
ci_0011                -1.233939e-02 3 1  ON 60
ci_0012                -1.223227e-02 3 1  ON 61
ci_0013                 1.326034e-02 3 1  ON 62
ci_0014                 1.276672e-02 3 1  ON 63
ci_0015                 1.292665e-02 3 1  ON 64
ci_0016                 1.270678e-02 3 1  ON 65
ci_0017                 1.144730e-02 3 1  ON 66
ci_0018                 1.113688e-02 3 1  ON 67
ci_0019                 1.160505e-02 3 1  ON 68
ci_0020                 1.148144e-02 3 1  ON 69
ci_0021                -2.260978e-04 3 1  ON 70
ci_0022                -1.503015e-03 3 1  ON 71
ci_0023                -1.110224e-02 3 1  ON 72
ci_0024                -1.082430e-02 3 1  ON 73
ci_0025                -1.086402e-02 3 1  ON 74
ci_0026                -1.098706e-02 3 1  ON 75
ci_0027                -1.100876e-02 3 1  ON 76
ci_0028                -1.043738e-02 3 1  ON 77
ci_0029                -1.093665e-02 3 1  ON 78
ci_0030                -1.071799e-02 3 1  ON 79
ci_0031                 2.068292e-02 3 1  ON 80
ci_0032                 2.146430e-02 3 1  ON 81
ci_0033                 9.955280e-03 3 1  ON 82
ci_0034                 9.322924e-03 3 1  ON 83
ci_0035                 6.562649e-03 3 1  ON 84
ci_0036                 6.099619e-03 3 1  ON 85
ci_0037                -1.072127e-02 3 1  ON 86
ci_0038                -1.067659e-02 3 1  ON 87
ci_0039                -2.716626e-03 3 1  ON 88
ci_0040                -2.803392e-03 3 1  ON 89
ci_0041                 7.048121e-03 3 1  ON 90
ci_0042                 7.032366e-03 3 1  ON 91
ci_0043                -1.810297e-02 3 1  ON 92
ci_0044                -1.817182e-02 3 1  ON 93
ci_0045                 7.266274e-03 3 1  ON 94
ci_0046                 7.989974e-03 3 1  ON 95
ci_0047                -1.750726e-03 3 1  ON 96
ci_0048                -1.607830e-03 3 1  ON 97
ci_0049                -5.377689e-03 3 1  ON 98
ci_0050                -5.260085e-03 3 1  ON 99
ci_0051                -3.703950e-03 3 1  ON 100
ci_0052                -3.446390e-03 3 1  ON 101
ci_0053                -4.914674e-03 3 1  ON 102
ci_0054                -4.438226e-03 3 1  ON 103
ci_0055                 6.585354e-03 3 1  ON 104
ci_0056                 6.567528e-03 3 1  ON 105
ci_0057                 4.694794e-03 3 1  ON 106
ci_0058                 4.938180e-03 3 1  ON 107
ci_0059                -4.806674e-03 3 1  ON 108
ci_0060                -4.680043e-03 3 1  ON 109
ci_0061                -3.458062e-03 3 1  ON 110
ci_0062                -3.366179e-03 3 1  ON 111
ci_0063                -8.800750e-03 3 1  ON 112
ci_0064                -8.771614e-03 3 1  ON 113
ci_0065                -5.354945e-03 3 1  ON 114
ci_0066                -5.484659e-03 3 1  ON 115
ci_0067                -4.445175e-03 3 1  ON 116
ci_0068                -4.919079e-03 3 1  ON 117
ci_0069                 4.500586e-03 3 1  ON 118
ci_0070                 4.509899e-03 3 1  ON 119
ci_0071                 2.630951e-04 3 1  ON 120
ci_0072                 8.789335e-04 3 1  ON 121
ci_0073                 3.954246e-03 3 1  ON 122
ci_0074                 4.163070e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8058e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.8516
    reference variance = 0.193859
====================================================
  Execution time = 2.3177e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5270e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3638e-01
  Total weights = 1.951791464e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.2433e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323789623097
                                         uncertainty =       0.002733087587

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323789623097
                                         uncertainty =       0.002733087587

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402363579
  error estimate for blocks of size 2^( 2) =       0.000415188020
  error estimate for blocks of size 2^( 3) =       0.000428294068
  error estimate for blocks of size 2^( 4) =       0.000440456772
  error estimate for blocks of size 2^( 5) =       0.000450317733
  error estimate for blocks of size 2^( 6) =       0.000456819284
  error estimate for blocks of size 2^( 7) =       0.000461581601

      target function =                  N/A
              le_mean =     -16.906068305819
             les_mean =     286.151530346859
             stat err =       0.000452293848
             autocorr =       1.263583762129
              std dev =       0.569028029834
             le_variance =       0.323792898736


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690606830582e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-02, overlap shift 6.1035e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906068305790       residual = 9.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906097368616       residual = 8.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906101104739       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906101409669       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906102204980       residual = 6.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906103593797       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906106429404       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906106150990       residual = 9.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906108180230       residual = 6.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906106853421       residual = 2.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906107198049       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906107369969       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906107545682       residual = 7.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906107605805       residual = 3.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906107399563       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.906107375245       residual = 5.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 6.1035e-02 is 3.340672e-03

solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906068305790       residual = 9.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906085929952       residual = 4.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906087386890       residual = 3.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906087665726       residual = 8.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906087711206       residual = 7.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906088901507       residual = 6.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906089522028       residual = 3.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906089239458       residual = 2.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906089492568       residual = 7.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906089370412       residual = 2.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906089373875       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906089373682       residual = 6.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.4414e-01 is 8.432638e-04

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906068305790       residual = 9.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906075151872       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906075535940       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906075751908       residual = 9.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906075782301       residual = 5.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906076199964       residual = 3.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906076236961       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906076125480       residual = 5.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906076190176       residual = 2.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906076224183       residual = 3.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.7656e-01 is 2.993995e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.077614 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9430e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
   uu_0                 3.129913e-01 1 1  ON 0
   uu_1                 1.455515e-01 1 1  ON 1
   uu_2                 4.362369e-02 1 1  ON 2
   uu_3                -1.929747e-02 1 1  ON 3
   uu_4                -6.551433e-02 1 1  ON 4
   uu_5                -1.012368e-01 1 1  ON 5
   uu_6                -1.293320e-01 1 1  ON 6
   uu_7                -1.435859e-01 1 1  ON 7
   uu_8                -1.362606e-01 1 1  ON 8
   uu_9                -1.058380e-01 1 1  ON 9
   ud_0                 4.483848e-01 1 1  ON 10
   ud_1                 1.826288e-01 1 1  ON 11
   ud_2                 6.231752e-02 1 1  ON 12
   ud_3                -8.906930e-03 1 1  ON 13
   ud_4                -6.575869e-02 1 1  ON 14
   ud_5                -1.076772e-01 1 1  ON 15
   ud_6                -1.352225e-01 1 1  ON 16
   ud_7                -1.521077e-01 1 1  ON 17
   ud_8                -1.532905e-01 1 1  ON 18
   ud_9                -1.418770e-01 1 1  ON 19
   eO_0                -7.515611e-01 1 1  ON 20
   eO_1                -4.307963e-01 1 1  ON 21
   eO_2                -1.985950e-02 1 1  ON 22
   eO_3                 2.928373e-01 1 1  ON 23
   eO_4                 5.184476e-01 1 1  ON 24
   eO_5                 4.808628e-01 1 1  ON 25
   eO_6                 2.543990e-01 1 1  ON 26
   eO_7                -4.444015e-02 1 1  ON 27
   eO_8                -2.191866e-01 1 1  ON 28
   eO_9                -8.054027e-02 1 1  ON 29
  eH1_0                -2.560221e-01 1 1  ON 30
  eH1_1                -1.485258e-01 1 1  ON 31
  eH1_2                -9.860392e-02 1 1  ON 32
  eH1_3                -4.358325e-02 1 1  ON 33
  eH1_4                 5.981668e-03 1 1  ON 34
  eH1_5                 4.198288e-02 1 1  ON 35
  eH1_6                 1.007792e-01 1 1  ON 36
  eH1_7                 1.561754e-01 1 1  ON 37
  eH1_8                 1.783419e-01 1 1  ON 38
  eH1_9                 6.583338e-02 1 1  ON 39
  eH2_0                -2.533913e-01 1 1  ON 40
  eH2_1                -1.460478e-01 1 1  ON 41
  eH2_2                -9.609605e-02 1 1  ON 42
  eH2_3                -4.073047e-02 1 1  ON 43
  eH2_4                 9.130614e-03 1 1  ON 44
  eH2_5                 4.444466e-02 1 1  ON 45
  eH2_6                 1.038466e-01 1 1  ON 46
  eH2_7                 1.580244e-01 1 1  ON 47
  eH2_8                 1.827769e-01 1 1  ON 48
  eH2_9                 5.373619e-02 1 1  ON 49
ci_0001                 7.006222e-01 3 1  ON 50
ci_0002                 7.012864e-01 3 1  ON 51
ci_0003                -2.725935e-02 3 1  ON 52
ci_0004                -2.763421e-02 3 1  ON 53
ci_0005                -3.616253e-02 3 1  ON 54
ci_0006                -3.619669e-02 3 1  ON 55
ci_0007                -2.097763e-02 3 1  ON 56
ci_0008                -2.177788e-02 3 1  ON 57
ci_0009                -1.710850e-02 3 1  ON 58
ci_0010                -1.725570e-02 3 1  ON 59
ci_0011                -1.199802e-02 3 1  ON 60
ci_0012                -1.247320e-02 3 1  ON 61
ci_0013                 1.306996e-02 3 1  ON 62
ci_0014                 1.305708e-02 3 1  ON 63
ci_0015                 1.283334e-02 3 1  ON 64
ci_0016                 1.298142e-02 3 1  ON 65
ci_0017                 1.139056e-02 3 1  ON 66
ci_0018                 1.123388e-02 3 1  ON 67
ci_0019                 1.120221e-02 3 1  ON 68
ci_0020                 1.133746e-02 3 1  ON 69
ci_0021                -7.496428e-04 3 1  ON 70
ci_0022                -1.313068e-03 3 1  ON 71
ci_0023                -1.166735e-02 3 1  ON 72
ci_0024                -1.107301e-02 3 1  ON 73
ci_0025                -1.095991e-02 3 1  ON 74
ci_0026                -1.065273e-02 3 1  ON 75
ci_0027                -1.103325e-02 3 1  ON 76
ci_0028                -1.120650e-02 3 1  ON 77
ci_0029                -1.071845e-02 3 1  ON 78
ci_0030                -1.112601e-02 3 1  ON 79
ci_0031                 2.087543e-02 3 1  ON 80
ci_0032                 2.139614e-02 3 1  ON 81
ci_0033                 9.371297e-03 3 1  ON 82
ci_0034                 9.670849e-03 3 1  ON 83
ci_0035                 6.446909e-03 3 1  ON 84
ci_0036                 6.289839e-03 3 1  ON 85
ci_0037                -1.056792e-02 3 1  ON 86
ci_0038                -1.071816e-02 3 1  ON 87
ci_0039                -2.529538e-03 3 1  ON 88
ci_0040                -2.716581e-03 3 1  ON 89
ci_0041                 7.533014e-03 3 1  ON 90
ci_0042                 6.938796e-03 3 1  ON 91
ci_0043                -1.838927e-02 3 1  ON 92
ci_0044                -1.834785e-02 3 1  ON 93
ci_0045                 7.610676e-03 3 1  ON 94
ci_0046                 7.872530e-03 3 1  ON 95
ci_0047                -1.864891e-03 3 1  ON 96
ci_0048                -1.894657e-03 3 1  ON 97
ci_0049                -5.293454e-03 3 1  ON 98
ci_0050                -5.722178e-03 3 1  ON 99
ci_0051                -3.391864e-03 3 1  ON 100
ci_0052                -3.096484e-03 3 1  ON 101
ci_0053                -4.735540e-03 3 1  ON 102
ci_0054                -4.678342e-03 3 1  ON 103
ci_0055                 6.412865e-03 3 1  ON 104
ci_0056                 6.554614e-03 3 1  ON 105
ci_0057                 4.442482e-03 3 1  ON 106
ci_0058                 4.857762e-03 3 1  ON 107
ci_0059                -4.990885e-03 3 1  ON 108
ci_0060                -4.564487e-03 3 1  ON 109
ci_0061                -3.393596e-03 3 1  ON 110
ci_0062                -3.196756e-03 3 1  ON 111
ci_0063                -8.521853e-03 3 1  ON 112
ci_0064                -8.743044e-03 3 1  ON 113
ci_0065                -5.028547e-03 3 1  ON 114
ci_0066                -5.376347e-03 3 1  ON 115
ci_0067                -4.481175e-03 3 1  ON 116
ci_0068                -4.976546e-03 3 1  ON 117
ci_0069                 4.387729e-03 3 1  ON 118
ci_0070                 4.464486e-03 3 1  ON 119
ci_0071                 9.903617e-05 3 1  ON 120
ci_0072                 4.565700e-04 3 1  ON 121
ci_0073                 3.981327e-03 3 1  ON 122
ci_0074                 4.067015e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.8651
    reference variance = 0.259502
====================================================
  Execution time = 2.1458e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3414e-01
  Total weights = 1.9517e+06
  Execution time = 1.9147e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323525981568
                                         uncertainty =       0.002148957733

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323525981568
                                         uncertainty =       0.002148957733

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402166955
  error estimate for blocks of size 2^( 2) =       0.000415627232
  error estimate for blocks of size 2^( 3) =       0.000428654827
  error estimate for blocks of size 2^( 4) =       0.000441399385
  error estimate for blocks of size 2^( 5) =       0.000452614779
  error estimate for blocks of size 2^( 6) =       0.000459725706
  error estimate for blocks of size 2^( 7) =       0.000465407258

      target function =                  N/A
              le_mean =     -16.906528650797
             les_mean =     286.166661547429
             stat err =       0.000454786782
             autocorr =       1.278800807744
              std dev =       0.568749962165
             le_variance =       0.323476519463

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323473507766
                                         uncertainty =       0.002173153240

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323473507766
                                         uncertainty =       0.002173153240

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402133772
  error estimate for blocks of size 2^( 2) =       0.000415603129
  error estimate for blocks of size 2^( 3) =       0.000428626829
  error estimate for blocks of size 2^( 4) =       0.000441366423
  error estimate for blocks of size 2^( 5) =       0.000452599966
  error estimate for blocks of size 2^( 6) =       0.000459739079
  error estimate for blocks of size 2^( 7) =       0.000465453339

      target function =                  N/A
              le_mean =     -16.906539794275
             les_mean =     286.166710204768
             stat err =       0.000454789702
             autocorr =       1.279028285545
              std dev =       0.568703033899
             le_variance =       0.323423140766

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323364225141
                                         uncertainty =       0.002176870524

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323364225141
                                         uncertainty =       0.002176870524

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402065631
  error estimate for blocks of size 2^( 2) =       0.000415534185
  error estimate for blocks of size 2^( 3) =       0.000428562129
  error estimate for blocks of size 2^( 4) =       0.000441310212
  error estimate for blocks of size 2^( 5) =       0.000452548117
  error estimate for blocks of size 2^( 6) =       0.000459702376
  error estimate for blocks of size 2^( 7) =       0.000465434290

      target function =                  N/A
              le_mean =     -16.906543396196
             les_mean =     286.171995605752
             stat err =       0.000454748749
             autocorr =       1.279231439177
              std dev =       0.568606668349
             le_variance =       0.323313543291

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323410989443
                                         uncertainty =       0.002153591348

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323410989443
                                         uncertainty =       0.002153591348

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402095328
  error estimate for blocks of size 2^( 2) =       0.000415556464
  error estimate for blocks of size 2^( 3) =       0.000428585404
  error estimate for blocks of size 2^( 4) =       0.000441331960
  error estimate for blocks of size 2^( 5) =       0.000452554346
  error estimate for blocks of size 2^( 6) =       0.000459675099
  error estimate for blocks of size 2^( 7) =       0.000465360467

      target function =                  N/A
              le_mean =     -16.906524167397
             les_mean =     286.167457399240
             stat err =       0.000454730468
             autocorr =       1.278939657561
              std dev =       0.568648665967
             le_variance =       0.323361305306


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906528650797        initial
     6.1035e-02     6.1035e-01             3.3407e-03       -16.906539794275
     2.4414e-01     2.4414e+00             8.4326e-04       -16.906543396196  <--
     9.7656e-01     9.7656e+00             2.9940e-04       -16.906524167397

*****************************************************************************
Applying the update for shift_i =   2.4414e-01     and shift_s =   2.4414e+00
*****************************************************************************

  Execution time = 3.1106e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
   uu_0                 3.129913e-01 1 1  ON 0
   uu_1                 1.455515e-01 1 1  ON 1
   uu_2                 4.362369e-02 1 1  ON 2
   uu_3                -1.929747e-02 1 1  ON 3
   uu_4                -6.551433e-02 1 1  ON 4
   uu_5                -1.012368e-01 1 1  ON 5
   uu_6                -1.293320e-01 1 1  ON 6
   uu_7                -1.435859e-01 1 1  ON 7
   uu_8                -1.362606e-01 1 1  ON 8
   uu_9                -1.058380e-01 1 1  ON 9
   ud_0                 4.483848e-01 1 1  ON 10
   ud_1                 1.826288e-01 1 1  ON 11
   ud_2                 6.231752e-02 1 1  ON 12
   ud_3                -8.906930e-03 1 1  ON 13
   ud_4                -6.575869e-02 1 1  ON 14
   ud_5                -1.076772e-01 1 1  ON 15
   ud_6                -1.352225e-01 1 1  ON 16
   ud_7                -1.521077e-01 1 1  ON 17
   ud_8                -1.532905e-01 1 1  ON 18
   ud_9                -1.418770e-01 1 1  ON 19
   eO_0                -7.515611e-01 1 1  ON 20
   eO_1                -4.307963e-01 1 1  ON 21
   eO_2                -1.985950e-02 1 1  ON 22
   eO_3                 2.928373e-01 1 1  ON 23
   eO_4                 5.184476e-01 1 1  ON 24
   eO_5                 4.808628e-01 1 1  ON 25
   eO_6                 2.543990e-01 1 1  ON 26
   eO_7                -4.444015e-02 1 1  ON 27
   eO_8                -2.191866e-01 1 1  ON 28
   eO_9                -8.054027e-02 1 1  ON 29
  eH1_0                -2.560221e-01 1 1  ON 30
  eH1_1                -1.485258e-01 1 1  ON 31
  eH1_2                -9.860392e-02 1 1  ON 32
  eH1_3                -4.358325e-02 1 1  ON 33
  eH1_4                 5.981668e-03 1 1  ON 34
  eH1_5                 4.198288e-02 1 1  ON 35
  eH1_6                 1.007792e-01 1 1  ON 36
  eH1_7                 1.561754e-01 1 1  ON 37
  eH1_8                 1.783419e-01 1 1  ON 38
  eH1_9                 6.583338e-02 1 1  ON 39
  eH2_0                -2.533913e-01 1 1  ON 40
  eH2_1                -1.460478e-01 1 1  ON 41
  eH2_2                -9.609605e-02 1 1  ON 42
  eH2_3                -4.073047e-02 1 1  ON 43
  eH2_4                 9.130614e-03 1 1  ON 44
  eH2_5                 4.444466e-02 1 1  ON 45
  eH2_6                 1.038466e-01 1 1  ON 46
  eH2_7                 1.580244e-01 1 1  ON 47
  eH2_8                 1.827769e-01 1 1  ON 48
  eH2_9                 5.373619e-02 1 1  ON 49
ci_0001                 7.006222e-01 3 1  ON 50
ci_0002                 7.012864e-01 3 1  ON 51
ci_0003                -2.725935e-02 3 1  ON 52
ci_0004                -2.763421e-02 3 1  ON 53
ci_0005                -3.616253e-02 3 1  ON 54
ci_0006                -3.619669e-02 3 1  ON 55
ci_0007                -2.097763e-02 3 1  ON 56
ci_0008                -2.177788e-02 3 1  ON 57
ci_0009                -1.710850e-02 3 1  ON 58
ci_0010                -1.725570e-02 3 1  ON 59
ci_0011                -1.199802e-02 3 1  ON 60
ci_0012                -1.247320e-02 3 1  ON 61
ci_0013                 1.306996e-02 3 1  ON 62
ci_0014                 1.305708e-02 3 1  ON 63
ci_0015                 1.283334e-02 3 1  ON 64
ci_0016                 1.298142e-02 3 1  ON 65
ci_0017                 1.139056e-02 3 1  ON 66
ci_0018                 1.123388e-02 3 1  ON 67
ci_0019                 1.120221e-02 3 1  ON 68
ci_0020                 1.133746e-02 3 1  ON 69
ci_0021                -7.496428e-04 3 1  ON 70
ci_0022                -1.313068e-03 3 1  ON 71
ci_0023                -1.166735e-02 3 1  ON 72
ci_0024                -1.107301e-02 3 1  ON 73
ci_0025                -1.095991e-02 3 1  ON 74
ci_0026                -1.065273e-02 3 1  ON 75
ci_0027                -1.103325e-02 3 1  ON 76
ci_0028                -1.120650e-02 3 1  ON 77
ci_0029                -1.071845e-02 3 1  ON 78
ci_0030                -1.112601e-02 3 1  ON 79
ci_0031                 2.087543e-02 3 1  ON 80
ci_0032                 2.139614e-02 3 1  ON 81
ci_0033                 9.371297e-03 3 1  ON 82
ci_0034                 9.670849e-03 3 1  ON 83
ci_0035                 6.446909e-03 3 1  ON 84
ci_0036                 6.289839e-03 3 1  ON 85
ci_0037                -1.056792e-02 3 1  ON 86
ci_0038                -1.071816e-02 3 1  ON 87
ci_0039                -2.529538e-03 3 1  ON 88
ci_0040                -2.716581e-03 3 1  ON 89
ci_0041                 7.533014e-03 3 1  ON 90
ci_0042                 6.938796e-03 3 1  ON 91
ci_0043                -1.838927e-02 3 1  ON 92
ci_0044                -1.834785e-02 3 1  ON 93
ci_0045                 7.610676e-03 3 1  ON 94
ci_0046                 7.872530e-03 3 1  ON 95
ci_0047                -1.864891e-03 3 1  ON 96
ci_0048                -1.894657e-03 3 1  ON 97
ci_0049                -5.293454e-03 3 1  ON 98
ci_0050                -5.722178e-03 3 1  ON 99
ci_0051                -3.391864e-03 3 1  ON 100
ci_0052                -3.096484e-03 3 1  ON 101
ci_0053                -4.735540e-03 3 1  ON 102
ci_0054                -4.678342e-03 3 1  ON 103
ci_0055                 6.412865e-03 3 1  ON 104
ci_0056                 6.554614e-03 3 1  ON 105
ci_0057                 4.442482e-03 3 1  ON 106
ci_0058                 4.857762e-03 3 1  ON 107
ci_0059                -4.990885e-03 3 1  ON 108
ci_0060                -4.564487e-03 3 1  ON 109
ci_0061                -3.393596e-03 3 1  ON 110
ci_0062                -3.196756e-03 3 1  ON 111
ci_0063                -8.521853e-03 3 1  ON 112
ci_0064                -8.743044e-03 3 1  ON 113
ci_0065                -5.028547e-03 3 1  ON 114
ci_0066                -5.376347e-03 3 1  ON 115
ci_0067                -4.481175e-03 3 1  ON 116
ci_0068                -4.976546e-03 3 1  ON 117
ci_0069                 4.387729e-03 3 1  ON 118
ci_0070                 4.464486e-03 3 1  ON 119
ci_0071                 9.903617e-05 3 1  ON 120
ci_0072                 4.565700e-04 3 1  ON 121
ci_0073                 3.981327e-03 3 1  ON 122
ci_0074                 4.067015e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.0551e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.8455
    reference variance = 0.265447
====================================================
  Execution time = 2.1356e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5238e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3751e-01
  Total weights = 1.951933568e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1018e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324218620961
                                         uncertainty =       0.002120150075

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324218620961
                                         uncertainty =       0.002120150075

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402560932
  error estimate for blocks of size 2^( 2) =       0.000415393847
  error estimate for blocks of size 2^( 3) =       0.000428886693
  error estimate for blocks of size 2^( 4) =       0.000441466879
  error estimate for blocks of size 2^( 5) =       0.000452399848
  error estimate for blocks of size 2^( 6) =       0.000461438896
  error estimate for blocks of size 2^( 7) =       0.000467554990

      target function =                  N/A
              le_mean =     -16.905798589215
             les_mean =     286.143533944413
             stat err =       0.000455715153
             autocorr =       1.281514984194
              std dev =       0.569307130327
             le_variance =       0.324110608641


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690579858921e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-02, overlap shift 6.1035e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905798589184       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905802447665       residual = 2.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905805277252       residual = 7.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905809319880       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905807753791       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905807449471       residual = 6.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905808251680       residual = 7.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905808990402       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905811637067       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905810003137       residual = 3.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905809914812       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905810414210       residual = 8.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905810240134       residual = 6.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905810767684       residual = 3.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.905810745317       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.905810820953       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.905810865324       residual = 7.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 6.1035e-02 is 3.536842e-03

solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905798589184       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905800900258       residual = 2.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905801794930       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905802803901       residual = 7.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905802692695       residual = 8.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905801952374       residual = 5.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905802743984       residual = 2.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905802998963       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905803332542       residual = 6.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905803061119       residual = 2.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905803195568       residual = 8.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.4414e-01 is 8.760770e-04

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905798589184       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905799476638       residual = 2.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905799636671       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905799551850       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905799652769       residual = 5.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905799575828       residual = 2.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905799705946       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905799843579       residual = 4.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905799790459       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905799857444       residual = 6.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.7656e-01 is 2.613339e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.084030 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7468e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
   uu_0                 3.134240e-01 1 1  ON 0
   uu_1                 1.455945e-01 1 1  ON 1
   uu_2                 4.379190e-02 1 1  ON 2
   uu_3                -1.923464e-02 1 1  ON 3
   uu_4                -6.540617e-02 1 1  ON 4
   uu_5                -1.012630e-01 1 1  ON 5
   uu_6                -1.294820e-01 1 1  ON 6
   uu_7                -1.437881e-01 1 1  ON 7
   uu_8                -1.366309e-01 1 1  ON 8
   uu_9                -1.064807e-01 1 1  ON 9
   ud_0                 4.488119e-01 1 1  ON 10
   ud_1                 1.828884e-01 1 1  ON 11
   ud_2                 6.244248e-02 1 1  ON 12
   ud_3                -8.677301e-03 1 1  ON 13
   ud_4                -6.560694e-02 1 1  ON 14
   ud_5                -1.075284e-01 1 1  ON 15
   ud_6                -1.353132e-01 1 1  ON 16
   ud_7                -1.523139e-01 1 1  ON 17
   ud_8                -1.533664e-01 1 1  ON 18
   ud_9                -1.423486e-01 1 1  ON 19
   eO_0                -7.513374e-01 1 1  ON 20
   eO_1                -4.309213e-01 1 1  ON 21
   eO_2                -1.980789e-02 1 1  ON 22
   eO_3                 2.930550e-01 1 1  ON 23
   eO_4                 5.186595e-01 1 1  ON 24
   eO_5                 4.809179e-01 1 1  ON 25
   eO_6                 2.547113e-01 1 1  ON 26
   eO_7                -4.425420e-02 1 1  ON 27
   eO_8                -2.196811e-01 1 1  ON 28
   eO_9                -8.109513e-02 1 1  ON 29
  eH1_0                -2.560183e-01 1 1  ON 30
  eH1_1                -1.487077e-01 1 1  ON 31
  eH1_2                -9.885953e-02 1 1  ON 32
  eH1_3                -4.380224e-02 1 1  ON 33
  eH1_4                 5.764678e-03 1 1  ON 34
  eH1_5                 4.156317e-02 1 1  ON 35
  eH1_6                 1.008850e-01 1 1  ON 36
  eH1_7                 1.562761e-01 1 1  ON 37
  eH1_8                 1.787600e-01 1 1  ON 38
  eH1_9                 6.650055e-02 1 1  ON 39
  eH2_0                -2.536651e-01 1 1  ON 40
  eH2_1                -1.461452e-01 1 1  ON 41
  eH2_2                -9.628899e-02 1 1  ON 42
  eH2_3                -4.116869e-02 1 1  ON 43
  eH2_4                 8.924249e-03 1 1  ON 44
  eH2_5                 4.438744e-02 1 1  ON 45
  eH2_6                 1.037535e-01 1 1  ON 46
  eH2_7                 1.579570e-01 1 1  ON 47
  eH2_8                 1.832418e-01 1 1  ON 48
  eH2_9                 5.461227e-02 1 1  ON 49
ci_0001                 7.009486e-01 3 1  ON 50
ci_0002                 7.009615e-01 3 1  ON 51
ci_0003                -2.751794e-02 3 1  ON 52
ci_0004                -2.713473e-02 3 1  ON 53
ci_0005                -3.626312e-02 3 1  ON 54
ci_0006                -3.650432e-02 3 1  ON 55
ci_0007                -2.063060e-02 3 1  ON 56
ci_0008                -2.188188e-02 3 1  ON 57
ci_0009                -1.761026e-02 3 1  ON 58
ci_0010                -1.706254e-02 3 1  ON 59
ci_0011                -1.166815e-02 3 1  ON 60
ci_0012                -1.188690e-02 3 1  ON 61
ci_0013                 1.318024e-02 3 1  ON 62
ci_0014                 1.341231e-02 3 1  ON 63
ci_0015                 1.302440e-02 3 1  ON 64
ci_0016                 1.355826e-02 3 1  ON 65
ci_0017                 1.156264e-02 3 1  ON 66
ci_0018                 1.109928e-02 3 1  ON 67
ci_0019                 1.166058e-02 3 1  ON 68
ci_0020                 1.136976e-02 3 1  ON 69
ci_0021                -8.588254e-04 3 1  ON 70
ci_0022                -7.430592e-04 3 1  ON 71
ci_0023                -1.165107e-02 3 1  ON 72
ci_0024                -1.052712e-02 3 1  ON 73
ci_0025                -1.071895e-02 3 1  ON 74
ci_0026                -1.043030e-02 3 1  ON 75
ci_0027                -1.131260e-02 3 1  ON 76
ci_0028                -1.149702e-02 3 1  ON 77
ci_0029                -1.057448e-02 3 1  ON 78
ci_0030                -1.113114e-02 3 1  ON 79
ci_0031                 2.099925e-02 3 1  ON 80
ci_0032                 2.112692e-02 3 1  ON 81
ci_0033                 9.903306e-03 3 1  ON 82
ci_0034                 1.009720e-02 3 1  ON 83
ci_0035                 6.876868e-03 3 1  ON 84
ci_0036                 6.691533e-03 3 1  ON 85
ci_0037                -1.027066e-02 3 1  ON 86
ci_0038                -1.072515e-02 3 1  ON 87
ci_0039                -2.395032e-03 3 1  ON 88
ci_0040                -2.633530e-03 3 1  ON 89
ci_0041                 7.131154e-03 3 1  ON 90
ci_0042                 7.093969e-03 3 1  ON 91
ci_0043                -1.837937e-02 3 1  ON 92
ci_0044                -1.808447e-02 3 1  ON 93
ci_0045                 8.010928e-03 3 1  ON 94
ci_0046                 7.438605e-03 3 1  ON 95
ci_0047                -1.983400e-03 3 1  ON 96
ci_0048                -1.697990e-03 3 1  ON 97
ci_0049                -5.538186e-03 3 1  ON 98
ci_0050                -5.760476e-03 3 1  ON 99
ci_0051                -3.484024e-03 3 1  ON 100
ci_0052                -3.451651e-03 3 1  ON 101
ci_0053                -4.811994e-03 3 1  ON 102
ci_0054                -4.722879e-03 3 1  ON 103
ci_0055                 6.084502e-03 3 1  ON 104
ci_0056                 6.170118e-03 3 1  ON 105
ci_0057                 4.501917e-03 3 1  ON 106
ci_0058                 4.434973e-03 3 1  ON 107
ci_0059                -4.926970e-03 3 1  ON 108
ci_0060                -4.619565e-03 3 1  ON 109
ci_0061                -3.511076e-03 3 1  ON 110
ci_0062                -3.048567e-03 3 1  ON 111
ci_0063                -7.904285e-03 3 1  ON 112
ci_0064                -8.134451e-03 3 1  ON 113
ci_0065                -5.111682e-03 3 1  ON 114
ci_0066                -5.496984e-03 3 1  ON 115
ci_0067                -4.771365e-03 3 1  ON 116
ci_0068                -4.888368e-03 3 1  ON 117
ci_0069                 4.037757e-03 3 1  ON 118
ci_0070                 4.376988e-03 3 1  ON 119
ci_0071                -1.911130e-05 3 1  ON 120
ci_0072                 5.376444e-04 3 1  ON 121
ci_0073                 4.047310e-03 3 1  ON 122
ci_0074                 4.179316e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.9809
    reference variance = 0.326599
====================================================
  Execution time = 2.0756e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3690e-01
  Total weights = 1.9517e+06
  Execution time = 1.9183e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324064562233
                                         uncertainty =       0.002860203444

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324064562233
                                         uncertainty =       0.002860203444

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402548751
  error estimate for blocks of size 2^( 2) =       0.000415002556
  error estimate for blocks of size 2^( 3) =       0.000427670327
  error estimate for blocks of size 2^( 4) =       0.000439306573
  error estimate for blocks of size 2^( 5) =       0.000449935600
  error estimate for blocks of size 2^( 6) =       0.000457448234
  error estimate for blocks of size 2^( 7) =       0.000462319381

      target function =                  N/A
              le_mean =     -16.906193703136
             les_mean =     286.263882951414
             stat err =       0.000452252447
             autocorr =       1.262190431000
              std dev =       0.569289903572
             le_variance =       0.324090994309

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324058157188
                                         uncertainty =       0.002827001162

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324058157188
                                         uncertainty =       0.002827001162

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402545636
  error estimate for blocks of size 2^( 2) =       0.000414985380
  error estimate for blocks of size 2^( 3) =       0.000427621902
  error estimate for blocks of size 2^( 4) =       0.000439236740
  error estimate for blocks of size 2^( 5) =       0.000449838612
  error estimate for blocks of size 2^( 6) =       0.000457328622
  error estimate for blocks of size 2^( 7) =       0.000462216149

      target function =                  N/A
              le_mean =     -16.906188793063
             les_mean =     286.175698776609
             stat err =       0.000452155031
             autocorr =       1.261666257371
              std dev =       0.569285498391
             le_variance =       0.324085978678

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350510414556
                                         uncertainty =       0.026250539889

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350510414556
                                         uncertainty =       0.026250539889

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418563543
  error estimate for blocks of size 2^( 2) =       0.000430508989
  error estimate for blocks of size 2^( 3) =       0.000442508661
  error estimate for blocks of size 2^( 4) =       0.000453677872
  error estimate for blocks of size 2^( 5) =       0.000463998835
  error estimate for blocks of size 2^( 6) =       0.000471554595
  error estimate for blocks of size 2^( 7) =       0.000475962845

      target function =                  N/A
              le_mean =     -16.906305346942
             les_mean =     288.047652820965
             stat err =       0.000466298537
             autocorr =       1.241095808072
              std dev =       0.591938238942
             le_variance =       0.350390878722

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323953198267
                                         uncertainty =       0.002839117994

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323953198267
                                         uncertainty =       0.002839117994

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402480041
  error estimate for blocks of size 2^( 2) =       0.000414936761
  error estimate for blocks of size 2^( 3) =       0.000427598453
  error estimate for blocks of size 2^( 4) =       0.000439232132
  error estimate for blocks of size 2^( 5) =       0.000449856674
  error estimate for blocks of size 2^( 6) =       0.000457356761
  error estimate for blocks of size 2^( 7) =       0.000462232927

      target function =                  N/A
              le_mean =     -16.906191412070
             les_mean =     286.158668282551
             stat err =       0.000452169624
             autocorr =       1.262159002034
              std dev =       0.569192732838
             le_variance =       0.323980367116


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906193703136        initial
     6.1035e-02     6.1035e-01             3.5368e-03       -16.906188793063
     2.4414e-01     2.4414e+00             8.7608e-04       -16.906305346942  <--
     9.7656e-01     9.7656e+00             2.6133e-04       -16.906191412070

*****************************************************************************
Applying the update for shift_i =   2.4414e-01     and shift_s =   2.4414e+00
*****************************************************************************

  Execution time = 3.0437e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
   uu_0                 3.134240e-01 1 1  ON 0
   uu_1                 1.455945e-01 1 1  ON 1
   uu_2                 4.379190e-02 1 1  ON 2
   uu_3                -1.923464e-02 1 1  ON 3
   uu_4                -6.540617e-02 1 1  ON 4
   uu_5                -1.012630e-01 1 1  ON 5
   uu_6                -1.294820e-01 1 1  ON 6
   uu_7                -1.437881e-01 1 1  ON 7
   uu_8                -1.366309e-01 1 1  ON 8
   uu_9                -1.064807e-01 1 1  ON 9
   ud_0                 4.488119e-01 1 1  ON 10
   ud_1                 1.828884e-01 1 1  ON 11
   ud_2                 6.244248e-02 1 1  ON 12
   ud_3                -8.677301e-03 1 1  ON 13
   ud_4                -6.560694e-02 1 1  ON 14
   ud_5                -1.075284e-01 1 1  ON 15
   ud_6                -1.353132e-01 1 1  ON 16
   ud_7                -1.523139e-01 1 1  ON 17
   ud_8                -1.533664e-01 1 1  ON 18
   ud_9                -1.423486e-01 1 1  ON 19
   eO_0                -7.513374e-01 1 1  ON 20
   eO_1                -4.309213e-01 1 1  ON 21
   eO_2                -1.980789e-02 1 1  ON 22
   eO_3                 2.930550e-01 1 1  ON 23
   eO_4                 5.186595e-01 1 1  ON 24
   eO_5                 4.809179e-01 1 1  ON 25
   eO_6                 2.547113e-01 1 1  ON 26
   eO_7                -4.425420e-02 1 1  ON 27
   eO_8                -2.196811e-01 1 1  ON 28
   eO_9                -8.109513e-02 1 1  ON 29
  eH1_0                -2.560183e-01 1 1  ON 30
  eH1_1                -1.487077e-01 1 1  ON 31
  eH1_2                -9.885953e-02 1 1  ON 32
  eH1_3                -4.380224e-02 1 1  ON 33
  eH1_4                 5.764678e-03 1 1  ON 34
  eH1_5                 4.156317e-02 1 1  ON 35
  eH1_6                 1.008850e-01 1 1  ON 36
  eH1_7                 1.562761e-01 1 1  ON 37
  eH1_8                 1.787600e-01 1 1  ON 38
  eH1_9                 6.650055e-02 1 1  ON 39
  eH2_0                -2.536651e-01 1 1  ON 40
  eH2_1                -1.461452e-01 1 1  ON 41
  eH2_2                -9.628899e-02 1 1  ON 42
  eH2_3                -4.116869e-02 1 1  ON 43
  eH2_4                 8.924249e-03 1 1  ON 44
  eH2_5                 4.438744e-02 1 1  ON 45
  eH2_6                 1.037535e-01 1 1  ON 46
  eH2_7                 1.579570e-01 1 1  ON 47
  eH2_8                 1.832418e-01 1 1  ON 48
  eH2_9                 5.461227e-02 1 1  ON 49
ci_0001                 7.009486e-01 3 1  ON 50
ci_0002                 7.009615e-01 3 1  ON 51
ci_0003                -2.751794e-02 3 1  ON 52
ci_0004                -2.713473e-02 3 1  ON 53
ci_0005                -3.626312e-02 3 1  ON 54
ci_0006                -3.650432e-02 3 1  ON 55
ci_0007                -2.063060e-02 3 1  ON 56
ci_0008                -2.188188e-02 3 1  ON 57
ci_0009                -1.761026e-02 3 1  ON 58
ci_0010                -1.706254e-02 3 1  ON 59
ci_0011                -1.166815e-02 3 1  ON 60
ci_0012                -1.188690e-02 3 1  ON 61
ci_0013                 1.318024e-02 3 1  ON 62
ci_0014                 1.341231e-02 3 1  ON 63
ci_0015                 1.302440e-02 3 1  ON 64
ci_0016                 1.355826e-02 3 1  ON 65
ci_0017                 1.156264e-02 3 1  ON 66
ci_0018                 1.109928e-02 3 1  ON 67
ci_0019                 1.166058e-02 3 1  ON 68
ci_0020                 1.136976e-02 3 1  ON 69
ci_0021                -8.588254e-04 3 1  ON 70
ci_0022                -7.430592e-04 3 1  ON 71
ci_0023                -1.165107e-02 3 1  ON 72
ci_0024                -1.052712e-02 3 1  ON 73
ci_0025                -1.071895e-02 3 1  ON 74
ci_0026                -1.043030e-02 3 1  ON 75
ci_0027                -1.131260e-02 3 1  ON 76
ci_0028                -1.149702e-02 3 1  ON 77
ci_0029                -1.057448e-02 3 1  ON 78
ci_0030                -1.113114e-02 3 1  ON 79
ci_0031                 2.099925e-02 3 1  ON 80
ci_0032                 2.112692e-02 3 1  ON 81
ci_0033                 9.903306e-03 3 1  ON 82
ci_0034                 1.009720e-02 3 1  ON 83
ci_0035                 6.876868e-03 3 1  ON 84
ci_0036                 6.691533e-03 3 1  ON 85
ci_0037                -1.027066e-02 3 1  ON 86
ci_0038                -1.072515e-02 3 1  ON 87
ci_0039                -2.395032e-03 3 1  ON 88
ci_0040                -2.633530e-03 3 1  ON 89
ci_0041                 7.131154e-03 3 1  ON 90
ci_0042                 7.093969e-03 3 1  ON 91
ci_0043                -1.837937e-02 3 1  ON 92
ci_0044                -1.808447e-02 3 1  ON 93
ci_0045                 8.010928e-03 3 1  ON 94
ci_0046                 7.438605e-03 3 1  ON 95
ci_0047                -1.983400e-03 3 1  ON 96
ci_0048                -1.697990e-03 3 1  ON 97
ci_0049                -5.538186e-03 3 1  ON 98
ci_0050                -5.760476e-03 3 1  ON 99
ci_0051                -3.484024e-03 3 1  ON 100
ci_0052                -3.451651e-03 3 1  ON 101
ci_0053                -4.811994e-03 3 1  ON 102
ci_0054                -4.722879e-03 3 1  ON 103
ci_0055                 6.084502e-03 3 1  ON 104
ci_0056                 6.170118e-03 3 1  ON 105
ci_0057                 4.501917e-03 3 1  ON 106
ci_0058                 4.434973e-03 3 1  ON 107
ci_0059                -4.926970e-03 3 1  ON 108
ci_0060                -4.619565e-03 3 1  ON 109
ci_0061                -3.511076e-03 3 1  ON 110
ci_0062                -3.048567e-03 3 1  ON 111
ci_0063                -7.904285e-03 3 1  ON 112
ci_0064                -8.134451e-03 3 1  ON 113
ci_0065                -5.111682e-03 3 1  ON 114
ci_0066                -5.496984e-03 3 1  ON 115
ci_0067                -4.771365e-03 3 1  ON 116
ci_0068                -4.888368e-03 3 1  ON 117
ci_0069                 4.037757e-03 3 1  ON 118
ci_0070                 4.376988e-03 3 1  ON 119
ci_0071                -1.911130e-05 3 1  ON 120
ci_0072                 5.376444e-04 3 1  ON 121
ci_0073                 4.047310e-03 3 1  ON 122
ci_0074                 4.179316e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7912e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.9534
    reference variance = 0.172693
====================================================
  Execution time = 2.1422e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5243e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4780e-01
  Total weights = 1.952116665e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1450e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326613328946
                                         uncertainty =       0.002693663749

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326613328946
                                         uncertainty =       0.002693663749

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404122098
  error estimate for blocks of size 2^( 2) =       0.000416935311
  error estimate for blocks of size 2^( 3) =       0.000429989129
  error estimate for blocks of size 2^( 4) =       0.000441566637
  error estimate for blocks of size 2^( 5) =       0.000452601586
  error estimate for blocks of size 2^( 6) =       0.000459286749
  error estimate for blocks of size 2^( 7) =       0.000463946502

      target function =                  N/A
              le_mean =     -16.905632850775
             les_mean =     286.148223572489
             stat err =       0.000454350369
             autocorr =       1.264027640857
              std dev =       0.571514952184
             le_variance =       0.326629340570


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690563285078e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-02, overlap shift 6.1035e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905632850731       residual = 1.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905642017753       residual = 2.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905650900671       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905652489273       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905653541455       residual = 4.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905656251653       residual = 8.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905655958242       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905659668907       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905658936575       residual = 4.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905659134381       residual = 3.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905658380393       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905658313855       residual = 5.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905658310749       residual = 2.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905658338134       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.905658280136       residual = 4.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         14 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 6.1035e-02 is 4.056810e-03

solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905632850731       residual = 1.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905638360838       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905640995274       residual = 5.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905642411246       residual = 5.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905643127485       residual = 4.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905644995629       residual = 5.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905644787911       residual = 4.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905645384232       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905644666055       residual = 4.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905644372918       residual = 1.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905644193749       residual = 5.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.4414e-01 is 1.055708e-03

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905632850731       residual = 1.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905634973526       residual = 9.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905635461143       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905635874849       residual = 3.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905636448855       residual = 4.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905636581047       residual = 3.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905636896540       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905636733523       residual = 4.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905636584271       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905636541185       residual = 2.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.7656e-01 is 3.688227e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.089750 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7576e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
   uu_0                 3.134199e-01 1 1  ON 0
   uu_1                 1.455098e-01 1 1  ON 1
   uu_2                 4.375156e-02 1 1  ON 2
   uu_3                -1.916418e-02 1 1  ON 3
   uu_4                -6.539323e-02 1 1  ON 4
   uu_5                -1.012992e-01 1 1  ON 5
   uu_6                -1.293928e-01 1 1  ON 6
   uu_7                -1.441901e-01 1 1  ON 7
   uu_8                -1.367636e-01 1 1  ON 8
   uu_9                -1.065437e-01 1 1  ON 9
   ud_0                 4.488771e-01 1 1  ON 10
   ud_1                 1.829060e-01 1 1  ON 11
   ud_2                 6.247779e-02 1 1  ON 12
   ud_3                -8.571885e-03 1 1  ON 13
   ud_4                -6.545030e-02 1 1  ON 14
   ud_5                -1.073728e-01 1 1  ON 15
   ud_6                -1.353407e-01 1 1  ON 16
   ud_7                -1.524312e-01 1 1  ON 17
   ud_8                -1.535438e-01 1 1  ON 18
   ud_9                -1.424299e-01 1 1  ON 19
   eO_0                -7.513190e-01 1 1  ON 20
   eO_1                -4.307375e-01 1 1  ON 21
   eO_2                -1.983906e-02 1 1  ON 22
   eO_3                 2.931806e-01 1 1  ON 23
   eO_4                 5.187785e-01 1 1  ON 24
   eO_5                 4.811136e-01 1 1  ON 25
   eO_6                 2.550427e-01 1 1  ON 26
   eO_7                -4.412333e-02 1 1  ON 27
   eO_8                -2.201185e-01 1 1  ON 28
   eO_9                -8.162383e-02 1 1  ON 29
  eH1_0                -2.562790e-01 1 1  ON 30
  eH1_1                -1.489341e-01 1 1  ON 31
  eH1_2                -9.909336e-02 1 1  ON 32
  eH1_3                -4.388531e-02 1 1  ON 33
  eH1_4                 5.385057e-03 1 1  ON 34
  eH1_5                 4.137127e-02 1 1  ON 35
  eH1_6                 1.006906e-01 1 1  ON 36
  eH1_7                 1.563179e-01 1 1  ON 37
  eH1_8                 1.794084e-01 1 1  ON 38
  eH1_9                 6.727218e-02 1 1  ON 39
  eH2_0                -2.539030e-01 1 1  ON 40
  eH2_1                -1.463206e-01 1 1  ON 41
  eH2_2                -9.655617e-02 1 1  ON 42
  eH2_3                -4.140554e-02 1 1  ON 43
  eH2_4                 8.611178e-03 1 1  ON 44
  eH2_5                 4.406817e-02 1 1  ON 45
  eH2_6                 1.035326e-01 1 1  ON 46
  eH2_7                 1.579936e-01 1 1  ON 47
  eH2_8                 1.837214e-01 1 1  ON 48
  eH2_9                 5.562916e-02 1 1  ON 49
ci_0001                 7.010436e-01 3 1  ON 50
ci_0002                 7.009082e-01 3 1  ON 51
ci_0003                -2.756698e-02 3 1  ON 52
ci_0004                -2.719257e-02 3 1  ON 53
ci_0005                -3.572641e-02 3 1  ON 54
ci_0006                -3.562555e-02 3 1  ON 55
ci_0007                -2.110800e-02 3 1  ON 56
ci_0008                -2.171746e-02 3 1  ON 57
ci_0009                -1.717200e-02 3 1  ON 58
ci_0010                -1.748040e-02 3 1  ON 59
ci_0011                -1.170150e-02 3 1  ON 60
ci_0012                -1.209396e-02 3 1  ON 61
ci_0013                 1.326647e-02 3 1  ON 62
ci_0014                 1.315689e-02 3 1  ON 63
ci_0015                 1.284607e-02 3 1  ON 64
ci_0016                 1.370344e-02 3 1  ON 65
ci_0017                 1.125919e-02 3 1  ON 66
ci_0018                 1.143279e-02 3 1  ON 67
ci_0019                 1.166587e-02 3 1  ON 68
ci_0020                 1.188136e-02 3 1  ON 69
ci_0021                -8.880744e-04 3 1  ON 70
ci_0022                -2.551665e-04 3 1  ON 71
ci_0023                -1.121779e-02 3 1  ON 72
ci_0024                -1.121353e-02 3 1  ON 73
ci_0025                -1.090609e-02 3 1  ON 74
ci_0026                -1.044388e-02 3 1  ON 75
ci_0027                -1.111917e-02 3 1  ON 76
ci_0028                -1.112050e-02 3 1  ON 77
ci_0029                -1.076572e-02 3 1  ON 78
ci_0030                -1.082196e-02 3 1  ON 79
ci_0031                 2.095867e-02 3 1  ON 80
ci_0032                 2.045503e-02 3 1  ON 81
ci_0033                 9.702952e-03 3 1  ON 82
ci_0034                 9.929043e-03 3 1  ON 83
ci_0035                 6.418020e-03 3 1  ON 84
ci_0036                 6.092930e-03 3 1  ON 85
ci_0037                -1.047264e-02 3 1  ON 86
ci_0038                -1.101356e-02 3 1  ON 87
ci_0039                -2.394827e-03 3 1  ON 88
ci_0040                -2.368726e-03 3 1  ON 89
ci_0041                 7.074389e-03 3 1  ON 90
ci_0042                 7.265226e-03 3 1  ON 91
ci_0043                -1.868323e-02 3 1  ON 92
ci_0044                -1.882577e-02 3 1  ON 93
ci_0045                 7.564642e-03 3 1  ON 94
ci_0046                 7.457046e-03 3 1  ON 95
ci_0047                -2.204282e-03 3 1  ON 96
ci_0048                -2.132403e-03 3 1  ON 97
ci_0049                -5.101026e-03 3 1  ON 98
ci_0050                -5.818766e-03 3 1  ON 99
ci_0051                -3.394083e-03 3 1  ON 100
ci_0052                -4.012354e-03 3 1  ON 101
ci_0053                -4.774931e-03 3 1  ON 102
ci_0054                -4.140757e-03 3 1  ON 103
ci_0055                 6.188244e-03 3 1  ON 104
ci_0056                 7.225825e-03 3 1  ON 105
ci_0057                 4.746503e-03 3 1  ON 106
ci_0058                 4.781539e-03 3 1  ON 107
ci_0059                -4.957296e-03 3 1  ON 108
ci_0060                -4.906958e-03 3 1  ON 109
ci_0061                -3.534929e-03 3 1  ON 110
ci_0062                -3.089797e-03 3 1  ON 111
ci_0063                -7.916697e-03 3 1  ON 112
ci_0064                -8.245391e-03 3 1  ON 113
ci_0065                -5.824005e-03 3 1  ON 114
ci_0066                -5.510048e-03 3 1  ON 115
ci_0067                -4.791443e-03 3 1  ON 116
ci_0068                -5.257876e-03 3 1  ON 117
ci_0069                 4.109364e-03 3 1  ON 118
ci_0070                 4.716323e-03 3 1  ON 119
ci_0071                -1.772070e-04 3 1  ON 120
ci_0072                -5.607456e-05 3 1  ON 121
ci_0073                 3.920125e-03 3 1  ON 122
ci_0074                 4.084921e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.8667
    reference variance = 0.307524
====================================================
  Execution time = 2.1143e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3432e-01
  Total weights = 1.9520e+06
  Execution time = 1.9059e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321194390928
                                         uncertainty =       0.001811899968

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321194390928
                                         uncertainty =       0.001811899968

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401112844
  error estimate for blocks of size 2^( 2) =       0.000413969525
  error estimate for blocks of size 2^( 3) =       0.000426967693
  error estimate for blocks of size 2^( 4) =       0.000439459299
  error estimate for blocks of size 2^( 5) =       0.000450075463
  error estimate for blocks of size 2^( 6) =       0.000458069964
  error estimate for blocks of size 2^( 7) =       0.000462686449

      target function =                  N/A
              le_mean =     -16.905735640503
             les_mean =     286.154284822493
             stat err =       0.000452572794
             autocorr =       1.273044976825
              std dev =       0.567259224448
             le_variance =       0.321783027721

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321611520826
                                         uncertainty =       0.001798091402

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321611520826
                                         uncertainty =       0.001798091402

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401385500
  error estimate for blocks of size 2^( 2) =       0.000414195130
  error estimate for blocks of size 2^( 3) =       0.000427169712
  error estimate for blocks of size 2^( 4) =       0.000439647356
  error estimate for blocks of size 2^( 5) =       0.000450203720
  error estimate for blocks of size 2^( 6) =       0.000458216570
  error estimate for blocks of size 2^( 7) =       0.000462908668

      target function =                  N/A
              le_mean =     -16.905726453098
             les_mean =     286.139219380361
             stat err =       0.000452744078
             autocorr =       1.272278529202
              std dev =       0.567644817980
             le_variance =       0.322220639380

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321850866825
                                         uncertainty =       0.001796184285

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321850866825
                                         uncertainty =       0.001796184285

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401538284
  error estimate for blocks of size 2^( 2) =       0.000414340395
  error estimate for blocks of size 2^( 3) =       0.000427310959
  error estimate for blocks of size 2^( 4) =       0.000439797208
  error estimate for blocks of size 2^( 5) =       0.000450345868
  error estimate for blocks of size 2^( 6) =       0.000458364804
  error estimate for blocks of size 2^( 7) =       0.000463086172

      target function =                  N/A
              le_mean =     -16.905733617560
             les_mean =     286.143077561507
             stat err =       0.000452898513
             autocorr =       1.272177974010
              std dev =       0.567860886818
             le_variance =       0.322465986778

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321225399421
                                         uncertainty =       0.001806110554

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321225399421
                                         uncertainty =       0.001806110554

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401135360
  error estimate for blocks of size 2^( 2) =       0.000413979746
  error estimate for blocks of size 2^( 3) =       0.000426974453
  error estimate for blocks of size 2^( 4) =       0.000439464085
  error estimate for blocks of size 2^( 5) =       0.000450064301
  error estimate for blocks of size 2^( 6) =       0.000458073835
  error estimate for blocks of size 2^( 7) =       0.000462700601

      target function =                  N/A
              le_mean =     -16.905721078010
             les_mean =     286.139981043411
             stat err =       0.000452575706
             autocorr =       1.272918448334
              std dev =       0.567291066732
             le_variance =       0.321819154394


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905735640503        initial  <--
     6.1035e-02     6.1035e-01             4.0568e-03       -16.905726453098
     2.4414e-01     2.4414e+00             1.0557e-03       -16.905733617560
     9.7656e-01     9.7656e+00             3.6882e-04       -16.905721078010

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.7680
  </log>
  <optVariables href="H2O.s012.opt.xml">
   uu_0                 3.134240e-01 1 1  ON 0
   uu_1                 1.455945e-01 1 1  ON 1
   uu_2                 4.379190e-02 1 1  ON 2
   uu_3                -1.923464e-02 1 1  ON 3
   uu_4                -6.540617e-02 1 1  ON 4
   uu_5                -1.012630e-01 1 1  ON 5
   uu_6                -1.294820e-01 1 1  ON 6
   uu_7                -1.437881e-01 1 1  ON 7
   uu_8                -1.366309e-01 1 1  ON 8
   uu_9                -1.064807e-01 1 1  ON 9
   ud_0                 4.488119e-01 1 1  ON 10
   ud_1                 1.828884e-01 1 1  ON 11
   ud_2                 6.244248e-02 1 1  ON 12
   ud_3                -8.677301e-03 1 1  ON 13
   ud_4                -6.560694e-02 1 1  ON 14
   ud_5                -1.075284e-01 1 1  ON 15
   ud_6                -1.353132e-01 1 1  ON 16
   ud_7                -1.523139e-01 1 1  ON 17
   ud_8                -1.533664e-01 1 1  ON 18
   ud_9                -1.423486e-01 1 1  ON 19
   eO_0                -7.513374e-01 1 1  ON 20
   eO_1                -4.309213e-01 1 1  ON 21
   eO_2                -1.980789e-02 1 1  ON 22
   eO_3                 2.930550e-01 1 1  ON 23
   eO_4                 5.186595e-01 1 1  ON 24
   eO_5                 4.809179e-01 1 1  ON 25
   eO_6                 2.547113e-01 1 1  ON 26
   eO_7                -4.425420e-02 1 1  ON 27
   eO_8                -2.196811e-01 1 1  ON 28
   eO_9                -8.109513e-02 1 1  ON 29
  eH1_0                -2.560183e-01 1 1  ON 30
  eH1_1                -1.487077e-01 1 1  ON 31
  eH1_2                -9.885953e-02 1 1  ON 32
  eH1_3                -4.380224e-02 1 1  ON 33
  eH1_4                 5.764678e-03 1 1  ON 34
  eH1_5                 4.156317e-02 1 1  ON 35
  eH1_6                 1.008850e-01 1 1  ON 36
  eH1_7                 1.562761e-01 1 1  ON 37
  eH1_8                 1.787600e-01 1 1  ON 38
  eH1_9                 6.650055e-02 1 1  ON 39
  eH2_0                -2.536651e-01 1 1  ON 40
  eH2_1                -1.461452e-01 1 1  ON 41
  eH2_2                -9.628899e-02 1 1  ON 42
  eH2_3                -4.116869e-02 1 1  ON 43
  eH2_4                 8.924249e-03 1 1  ON 44
  eH2_5                 4.438744e-02 1 1  ON 45
  eH2_6                 1.037535e-01 1 1  ON 46
  eH2_7                 1.579570e-01 1 1  ON 47
  eH2_8                 1.832418e-01 1 1  ON 48
  eH2_9                 5.461227e-02 1 1  ON 49
ci_0001                 7.009486e-01 3 1  ON 50
ci_0002                 7.009615e-01 3 1  ON 51
ci_0003                -2.751794e-02 3 1  ON 52
ci_0004                -2.713473e-02 3 1  ON 53
ci_0005                -3.626312e-02 3 1  ON 54
ci_0006                -3.650432e-02 3 1  ON 55
ci_0007                -2.063060e-02 3 1  ON 56
ci_0008                -2.188188e-02 3 1  ON 57
ci_0009                -1.761026e-02 3 1  ON 58
ci_0010                -1.706254e-02 3 1  ON 59
ci_0011                -1.166815e-02 3 1  ON 60
ci_0012                -1.188690e-02 3 1  ON 61
ci_0013                 1.318024e-02 3 1  ON 62
ci_0014                 1.341231e-02 3 1  ON 63
ci_0015                 1.302440e-02 3 1  ON 64
ci_0016                 1.355826e-02 3 1  ON 65
ci_0017                 1.156264e-02 3 1  ON 66
ci_0018                 1.109928e-02 3 1  ON 67
ci_0019                 1.166058e-02 3 1  ON 68
ci_0020                 1.136976e-02 3 1  ON 69
ci_0021                -8.588254e-04 3 1  ON 70
ci_0022                -7.430592e-04 3 1  ON 71
ci_0023                -1.165107e-02 3 1  ON 72
ci_0024                -1.052712e-02 3 1  ON 73
ci_0025                -1.071895e-02 3 1  ON 74
ci_0026                -1.043030e-02 3 1  ON 75
ci_0027                -1.131260e-02 3 1  ON 76
ci_0028                -1.149702e-02 3 1  ON 77
ci_0029                -1.057448e-02 3 1  ON 78
ci_0030                -1.113114e-02 3 1  ON 79
ci_0031                 2.099925e-02 3 1  ON 80
ci_0032                 2.112692e-02 3 1  ON 81
ci_0033                 9.903306e-03 3 1  ON 82
ci_0034                 1.009720e-02 3 1  ON 83
ci_0035                 6.876868e-03 3 1  ON 84
ci_0036                 6.691533e-03 3 1  ON 85
ci_0037                -1.027066e-02 3 1  ON 86
ci_0038                -1.072515e-02 3 1  ON 87
ci_0039                -2.395032e-03 3 1  ON 88
ci_0040                -2.633530e-03 3 1  ON 89
ci_0041                 7.131154e-03 3 1  ON 90
ci_0042                 7.093969e-03 3 1  ON 91
ci_0043                -1.837937e-02 3 1  ON 92
ci_0044                -1.808447e-02 3 1  ON 93
ci_0045                 8.010928e-03 3 1  ON 94
ci_0046                 7.438605e-03 3 1  ON 95
ci_0047                -1.983400e-03 3 1  ON 96
ci_0048                -1.697990e-03 3 1  ON 97
ci_0049                -5.538186e-03 3 1  ON 98
ci_0050                -5.760476e-03 3 1  ON 99
ci_0051                -3.484024e-03 3 1  ON 100
ci_0052                -3.451651e-03 3 1  ON 101
ci_0053                -4.811994e-03 3 1  ON 102
ci_0054                -4.722879e-03 3 1  ON 103
ci_0055                 6.084502e-03 3 1  ON 104
ci_0056                 6.170118e-03 3 1  ON 105
ci_0057                 4.501917e-03 3 1  ON 106
ci_0058                 4.434973e-03 3 1  ON 107
ci_0059                -4.926970e-03 3 1  ON 108
ci_0060                -4.619565e-03 3 1  ON 109
ci_0061                -3.511076e-03 3 1  ON 110
ci_0062                -3.048567e-03 3 1  ON 111
ci_0063                -7.904285e-03 3 1  ON 112
ci_0064                -8.134451e-03 3 1  ON 113
ci_0065                -5.111682e-03 3 1  ON 114
ci_0066                -5.496984e-03 3 1  ON 115
ci_0067                -4.771365e-03 3 1  ON 116
ci_0068                -4.888368e-03 3 1  ON 117
ci_0069                 4.037757e-03 3 1  ON 118
ci_0070                 4.376988e-03 3 1  ON 119
ci_0071                -1.911130e-05 3 1  ON 120
ci_0072                 5.376444e-04 3 1  ON 121
ci_0073                 4.047310e-03 3 1  ON 122
ci_0074                 4.179316e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8351e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.8476
    reference variance = 0.339602
====================================================
  Execution time = 2.1349e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5266e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4871e-01
  Total weights = 1.951694160e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0494e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329254886895
                                         uncertainty =       0.002454912262

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329254886895
                                         uncertainty =       0.002454912262

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405686117
  error estimate for blocks of size 2^( 2) =       0.000418442442
  error estimate for blocks of size 2^( 3) =       0.000431427763
  error estimate for blocks of size 2^( 4) =       0.000444162820
  error estimate for blocks of size 2^( 5) =       0.000456266518
  error estimate for blocks of size 2^( 6) =       0.000463139437
  error estimate for blocks of size 2^( 7) =       0.000466468199

      target function =                  N/A
              le_mean =     -16.906318263200
             les_mean =     286.172309828911
             stat err =       0.000457509243
             autocorr =       1.271801857168
              std dev =       0.573726808061
             le_variance =       0.329162450288


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690631826320e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906318263199       residual = 2.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906336855385       residual = 2.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906336411129       residual = 4.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906336231423       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906336834800       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906337363523       residual = 6.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906337765304       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906337689541       residual = 8.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906337445716       residual = 5.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906337399383       residual = 1.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906337363054       residual = 8.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 6.1035e-01 is 7.003307e-04

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906318263199       residual = 2.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906324084769       residual = 2.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906323978045       residual = 3.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906323980363       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906324175621       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906324322065       residual = 4.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906324456292       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906324454361       residual = 5.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906324387135       residual = 2.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906324374895       residual = 8.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.4414e+00 is 2.148153e-04

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906318263199       residual = 2.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906319816643       residual = 2.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906319791173       residual = 3.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906319799486       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906319851211       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906319886960       residual = 4.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906319926439       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906319927565       residual = 5.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906319911779       residual = 2.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906319909255       residual = 6.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.7656e+00 is 5.694414e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.093929 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7407e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
   uu_0                 3.134670e-01 1 1  ON 0
   uu_1                 1.456726e-01 1 1  ON 1
   uu_2                 4.381050e-02 1 1  ON 2
   uu_3                -1.922691e-02 1 1  ON 3
   uu_4                -6.543876e-02 1 1  ON 4
   uu_5                -1.012722e-01 1 1  ON 5
   uu_6                -1.295307e-01 1 1  ON 6
   uu_7                -1.438379e-01 1 1  ON 7
   uu_8                -1.366864e-01 1 1  ON 8
   uu_9                -1.065012e-01 1 1  ON 9
   ud_0                 4.487813e-01 1 1  ON 10
   ud_1                 1.828941e-01 1 1  ON 11
   ud_2                 6.245436e-02 1 1  ON 12
   ud_3                -8.664213e-03 1 1  ON 13
   ud_4                -6.566328e-02 1 1  ON 14
   ud_5                -1.075234e-01 1 1  ON 15
   ud_6                -1.352645e-01 1 1  ON 16
   ud_7                -1.523050e-01 1 1  ON 17
   ud_8                -1.533712e-01 1 1  ON 18
   ud_9                -1.423405e-01 1 1  ON 19
   eO_0                -7.513140e-01 1 1  ON 20
   eO_1                -4.308860e-01 1 1  ON 21
   eO_2                -1.982325e-02 1 1  ON 22
   eO_3                 2.930286e-01 1 1  ON 23
   eO_4                 5.186902e-01 1 1  ON 24
   eO_5                 4.809462e-01 1 1  ON 25
   eO_6                 2.547426e-01 1 1  ON 26
   eO_7                -4.426082e-02 1 1  ON 27
   eO_8                -2.197289e-01 1 1  ON 28
   eO_9                -8.113744e-02 1 1  ON 29
  eH1_0                -2.560900e-01 1 1  ON 30
  eH1_1                -1.487308e-01 1 1  ON 31
  eH1_2                -9.894185e-02 1 1  ON 32
  eH1_3                -4.385700e-02 1 1  ON 33
  eH1_4                 5.847106e-03 1 1  ON 34
  eH1_5                 4.158607e-02 1 1  ON 35
  eH1_6                 1.008650e-01 1 1  ON 36
  eH1_7                 1.562922e-01 1 1  ON 37
  eH1_8                 1.788211e-01 1 1  ON 38
  eH1_9                 6.656675e-02 1 1  ON 39
  eH2_0                -2.537439e-01 1 1  ON 40
  eH2_1                -1.461974e-01 1 1  ON 41
  eH2_2                -9.634214e-02 1 1  ON 42
  eH2_3                -4.116690e-02 1 1  ON 43
  eH2_4                 8.914750e-03 1 1  ON 44
  eH2_5                 4.440826e-02 1 1  ON 45
  eH2_6                 1.037469e-01 1 1  ON 46
  eH2_7                 1.579701e-01 1 1  ON 47
  eH2_8                 1.832938e-01 1 1  ON 48
  eH2_9                 5.470951e-02 1 1  ON 49
ci_0001                 7.009474e-01 3 1  ON 50
ci_0002                 7.009595e-01 3 1  ON 51
ci_0003                -2.761115e-02 3 1  ON 52
ci_0004                -2.714446e-02 3 1  ON 53
ci_0005                -3.633900e-02 3 1  ON 54
ci_0006                -3.661107e-02 3 1  ON 55
ci_0007                -2.060054e-02 3 1  ON 56
ci_0008                -2.185068e-02 3 1  ON 57
ci_0009                -1.750959e-02 3 1  ON 58
ci_0010                -1.698806e-02 3 1  ON 59
ci_0011                -1.162486e-02 3 1  ON 60
ci_0012                -1.184781e-02 3 1  ON 61
ci_0013                 1.319183e-02 3 1  ON 62
ci_0014                 1.341672e-02 3 1  ON 63
ci_0015                 1.307160e-02 3 1  ON 64
ci_0016                 1.346761e-02 3 1  ON 65
ci_0017                 1.153058e-02 3 1  ON 66
ci_0018                 1.115667e-02 3 1  ON 67
ci_0019                 1.158786e-02 3 1  ON 68
ci_0020                 1.132841e-02 3 1  ON 69
ci_0021                -9.007696e-04 3 1  ON 70
ci_0022                -8.237101e-04 3 1  ON 71
ci_0023                -1.144590e-02 3 1  ON 72
ci_0024                -1.072524e-02 3 1  ON 73
ci_0025                -1.070053e-02 3 1  ON 74
ci_0026                -1.038832e-02 3 1  ON 75
ci_0027                -1.134404e-02 3 1  ON 76
ci_0028                -1.139580e-02 3 1  ON 77
ci_0029                -1.066035e-02 3 1  ON 78
ci_0030                -1.115689e-02 3 1  ON 79
ci_0031                 2.097188e-02 3 1  ON 80
ci_0032                 2.116270e-02 3 1  ON 81
ci_0033                 9.826865e-03 3 1  ON 82
ci_0034                 1.011307e-02 3 1  ON 83
ci_0035                 6.808934e-03 3 1  ON 84
ci_0036                 6.476717e-03 3 1  ON 85
ci_0037                -1.028566e-02 3 1  ON 86
ci_0038                -1.069168e-02 3 1  ON 87
ci_0039                -2.434889e-03 3 1  ON 88
ci_0040                -2.651184e-03 3 1  ON 89
ci_0041                 7.141897e-03 3 1  ON 90
ci_0042                 7.131321e-03 3 1  ON 91
ci_0043                -1.841501e-02 3 1  ON 92
ci_0044                -1.816629e-02 3 1  ON 93
ci_0045                 8.033660e-03 3 1  ON 94
ci_0046                 7.330232e-03 3 1  ON 95
ci_0047                -1.999635e-03 3 1  ON 96
ci_0048                -1.740893e-03 3 1  ON 97
ci_0049                -5.433773e-03 3 1  ON 98
ci_0050                -5.623343e-03 3 1  ON 99
ci_0051                -3.519420e-03 3 1  ON 100
ci_0052                -3.491526e-03 3 1  ON 101
ci_0053                -4.779042e-03 3 1  ON 102
ci_0054                -4.730496e-03 3 1  ON 103
ci_0055                 6.064975e-03 3 1  ON 104
ci_0056                 6.181763e-03 3 1  ON 105
ci_0057                 4.527735e-03 3 1  ON 106
ci_0058                 4.524244e-03 3 1  ON 107
ci_0059                -4.859444e-03 3 1  ON 108
ci_0060                -4.594027e-03 3 1  ON 109
ci_0061                -3.465495e-03 3 1  ON 110
ci_0062                -3.072057e-03 3 1  ON 111
ci_0063                -7.995436e-03 3 1  ON 112
ci_0064                -8.142989e-03 3 1  ON 113
ci_0065                -5.076381e-03 3 1  ON 114
ci_0066                -5.483425e-03 3 1  ON 115
ci_0067                -4.838482e-03 3 1  ON 116
ci_0068                -4.910853e-03 3 1  ON 117
ci_0069                 4.021894e-03 3 1  ON 118
ci_0070                 4.467481e-03 3 1  ON 119
ci_0071                -7.219437e-05 3 1  ON 120
ci_0072                 5.761137e-04 3 1  ON 121
ci_0073                 4.075890e-03 3 1  ON 122
ci_0074                 4.246000e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.009
    reference variance = 0.59553
====================================================
  Execution time = 2.1129e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3562e-01
  Total weights = 1.9516e+06
  Execution time = 1.9194e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323155419023
                                         uncertainty =       0.002305751218

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323155419023
                                         uncertainty =       0.002305751218

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401983185
  error estimate for blocks of size 2^( 2) =       0.000414746812
  error estimate for blocks of size 2^( 3) =       0.000428267904
  error estimate for blocks of size 2^( 4) =       0.000441083112
  error estimate for blocks of size 2^( 5) =       0.000451790493
  error estimate for blocks of size 2^( 6) =       0.000461015984
  error estimate for blocks of size 2^( 7) =       0.000465768388

      target function =                  N/A
              le_mean =     -16.906240940414
             les_mean =     286.161989567407
             stat err =       0.000454914494
             autocorr =       1.280689283061
              std dev =       0.568490072059
             le_variance =       0.323180962029

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323144766571
                                         uncertainty =       0.002296278792

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323144766571
                                         uncertainty =       0.002296278792

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401976907
  error estimate for blocks of size 2^( 2) =       0.000414731616
  error estimate for blocks of size 2^( 3) =       0.000428256035
  error estimate for blocks of size 2^( 4) =       0.000441076081
  error estimate for blocks of size 2^( 5) =       0.000451779925
  error estimate for blocks of size 2^( 6) =       0.000460979723
  error estimate for blocks of size 2^( 7) =       0.000465758140

      target function =                  N/A
              le_mean =     -16.906247970166
             les_mean =     286.226773964450
             stat err =       0.000454898467
             autocorr =       1.280639046114
              std dev =       0.568481193210
             le_variance =       0.323170867033

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323044476377
                                         uncertainty =       0.002299703548

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323044476377
                                         uncertainty =       0.002299703548

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401914446
  error estimate for blocks of size 2^( 2) =       0.000414682749
  error estimate for blocks of size 2^( 3) =       0.000428208055
  error estimate for blocks of size 2^( 4) =       0.000441027001
  error estimate for blocks of size 2^( 5) =       0.000451746283
  error estimate for blocks of size 2^( 6) =       0.000460977528
  error estimate for blocks of size 2^( 7) =       0.000465738067

      target function =                  N/A
              le_mean =     -16.906238143185
             les_mean =     286.156594046009
             stat err =       0.000454872220
             autocorr =       1.280889293680
              std dev =       0.568392860369
             le_variance =       0.323070443718

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323137611274
                                         uncertainty =       0.002304887685

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323137611274
                                         uncertainty =       0.002304887685

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401972143
  error estimate for blocks of size 2^( 2) =       0.000414736363
  error estimate for blocks of size 2^( 3) =       0.000428257908
  error estimate for blocks of size 2^( 4) =       0.000441073658
  error estimate for blocks of size 2^( 5) =       0.000451782383
  error estimate for blocks of size 2^( 6) =       0.000461008719
  error estimate for blocks of size 2^( 7) =       0.000465762496

      target function =                  N/A
              le_mean =     -16.906240255050
             les_mean =     286.156770132505
             stat err =       0.000454906814
             autocorr =       1.280716396689
              std dev =       0.568474456229
             le_variance =       0.323163207384


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906240940414        initial
     6.1035e-01     6.1035e+00             7.0033e-04       -16.906247970166  <--
     2.4414e+00     2.4414e+01             2.1482e-04       -16.906238143185
     9.7656e+00     9.7656e+01             5.6944e-05       -16.906240255050

*****************************************************************************
Applying the update for shift_i =   6.1035e-01     and shift_s =   6.1035e+00
*****************************************************************************

  Execution time = 3.0812e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
   uu_0                 3.136111e-01 1 1  ON 0
   uu_1                 1.458386e-01 1 1  ON 1
   uu_2                 4.386880e-02 1 1  ON 2
   uu_3                -1.921634e-02 1 1  ON 3
   uu_4                -6.550292e-02 1 1  ON 4
   uu_5                -1.013069e-01 1 1  ON 5
   uu_6                -1.296485e-01 1 1  ON 6
   uu_7                -1.439755e-01 1 1  ON 7
   uu_8                -1.368544e-01 1 1  ON 8
   uu_9                -1.065666e-01 1 1  ON 9
   ud_0                 4.487328e-01 1 1  ON 10
   ud_1                 1.829084e-01 1 1  ON 11
   ud_2                 6.247729e-02 1 1  ON 12
   ud_3                -8.647795e-03 1 1  ON 13
   ud_4                -6.577983e-02 1 1  ON 14
   ud_5                -1.075337e-01 1 1  ON 15
   ud_6                -1.351614e-01 1 1  ON 16
   ud_7                -1.522722e-01 1 1  ON 17
   ud_8                -1.533797e-01 1 1  ON 18
   ud_9                -1.423165e-01 1 1  ON 19
   eO_0                -7.512317e-01 1 1  ON 20
   eO_1                -4.307968e-01 1 1  ON 21
   eO_2                -1.984663e-02 1 1  ON 22
   eO_3                 2.929487e-01 1 1  ON 23
   eO_4                 5.187590e-01 1 1  ON 24
   eO_5                 4.810336e-01 1 1  ON 25
   eO_6                 2.548429e-01 1 1  ON 26
   eO_7                -4.427790e-02 1 1  ON 27
   eO_8                -2.198748e-01 1 1  ON 28
   eO_9                -8.126713e-02 1 1  ON 29
  eH1_0                -2.563001e-01 1 1  ON 30
  eH1_1                -1.488247e-01 1 1  ON 31
  eH1_2                -9.915751e-02 1 1  ON 32
  eH1_3                -4.399016e-02 1 1  ON 33
  eH1_4                 6.031503e-03 1 1  ON 34
  eH1_5                 4.165986e-02 1 1  ON 35
  eH1_6                 1.008139e-01 1 1  ON 36
  eH1_7                 1.563410e-01 1 1  ON 37
  eH1_8                 1.790063e-01 1 1  ON 38
  eH1_9                 6.676918e-02 1 1  ON 39
  eH2_0                -2.539777e-01 1 1  ON 40
  eH2_1                -1.463429e-01 1 1  ON 41
  eH2_2                -9.648535e-02 1 1  ON 42
  eH2_3                -4.118257e-02 1 1  ON 43
  eH2_4                 8.887672e-03 1 1  ON 44
  eH2_5                 4.445046e-02 1 1  ON 45
  eH2_6                 1.037251e-01 1 1  ON 46
  eH2_7                 1.580113e-01 1 1  ON 47
  eH2_8                 1.834535e-01 1 1  ON 48
  eH2_9                 5.500681e-02 1 1  ON 49
ci_0001                 7.009411e-01 3 1  ON 50
ci_0002                 7.009569e-01 3 1  ON 51
ci_0003                -2.781943e-02 3 1  ON 52
ci_0004                -2.716702e-02 3 1  ON 53
ci_0005                -3.652921e-02 3 1  ON 54
ci_0006                -3.687174e-02 3 1  ON 55
ci_0007                -2.052209e-02 3 1  ON 56
ci_0008                -2.177117e-02 3 1  ON 57
ci_0009                -1.729611e-02 3 1  ON 58
ci_0010                -1.682476e-02 3 1  ON 59
ci_0011                -1.152776e-02 3 1  ON 60
ci_0012                -1.175702e-02 3 1  ON 61
ci_0013                 1.321518e-02 3 1  ON 62
ci_0014                 1.342378e-02 3 1  ON 63
ci_0015                 1.317344e-02 3 1  ON 64
ci_0016                 1.326569e-02 3 1  ON 65
ci_0017                 1.146337e-02 3 1  ON 66
ci_0018                 1.128098e-02 3 1  ON 67
ci_0019                 1.142529e-02 3 1  ON 68
ci_0020                 1.123577e-02 3 1  ON 69
ci_0021                -1.006634e-03 3 1  ON 70
ci_0022                -1.031289e-03 3 1  ON 71
ci_0023                -1.100852e-02 3 1  ON 72
ci_0024                -1.115482e-02 3 1  ON 73
ci_0025                -1.065581e-02 3 1  ON 74
ci_0026                -1.029475e-02 3 1  ON 75
ci_0027                -1.141981e-02 3 1  ON 76
ci_0028                -1.117133e-02 3 1  ON 77
ci_0029                -1.085745e-02 3 1  ON 78
ci_0030                -1.121929e-02 3 1  ON 79
ci_0031                 2.089905e-02 3 1  ON 80
ci_0032                 2.125248e-02 3 1  ON 81
ci_0033                 9.637612e-03 3 1  ON 82
ci_0034                 1.015580e-02 3 1  ON 83
ci_0035                 6.656126e-03 3 1  ON 84
ci_0036                 5.991202e-03 3 1  ON 85
ci_0037                -1.032089e-02 3 1  ON 86
ci_0038                -1.061046e-02 3 1  ON 87
ci_0039                -2.507001e-03 3 1  ON 88
ci_0040                -2.683514e-03 3 1  ON 89
ci_0041                 7.162525e-03 3 1  ON 90
ci_0042                 7.212911e-03 3 1  ON 91
ci_0043                -1.850162e-02 3 1  ON 92
ci_0044                -1.837630e-02 3 1  ON 93
ci_0045                 8.087273e-03 3 1  ON 94
ci_0046                 7.069409e-03 3 1  ON 95
ci_0047                -2.029916e-03 3 1  ON 96
ci_0048                -1.822248e-03 3 1  ON 97
ci_0049                -5.202950e-03 3 1  ON 98
ci_0050                -5.323544e-03 3 1  ON 99
ci_0051                -3.588176e-03 3 1  ON 100
ci_0052                -3.569127e-03 3 1  ON 101
ci_0053                -4.709996e-03 3 1  ON 102
ci_0054                -4.744895e-03 3 1  ON 103
ci_0055                 6.023316e-03 3 1  ON 104
ci_0056                 6.208982e-03 3 1  ON 105
ci_0057                 4.590639e-03 3 1  ON 106
ci_0058                 4.734617e-03 3 1  ON 107
ci_0059                -4.724620e-03 3 1  ON 108
ci_0060                -4.542856e-03 3 1  ON 109
ci_0061                -3.364864e-03 3 1  ON 110
ci_0062                -3.123887e-03 3 1  ON 111
ci_0063                -8.177968e-03 3 1  ON 112
ci_0064                -8.161590e-03 3 1  ON 113
ci_0065                -4.999721e-03 3 1  ON 114
ci_0066                -5.452683e-03 3 1  ON 115
ci_0067                -4.968464e-03 3 1  ON 116
ci_0068                -4.953777e-03 3 1  ON 117
ci_0069                 3.991087e-03 3 1  ON 118
ci_0070                 4.638575e-03 3 1  ON 119
ci_0071                -1.924224e-04 3 1  ON 120
ci_0072                 6.584625e-04 3 1  ON 121
ci_0073                 4.129523e-03 3 1  ON 122
ci_0074                 4.375223e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8226e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.0119
    reference variance = 0.567115
====================================================
  Execution time = 2.1408e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5257e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3998e-01
  Total weights = 1.951898868e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1381e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325252265500
                                         uncertainty =       0.002953010196

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325252265500
                                         uncertainty =       0.002953010196

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403249974
  error estimate for blocks of size 2^( 2) =       0.000416052466
  error estimate for blocks of size 2^( 3) =       0.000428747281
  error estimate for blocks of size 2^( 4) =       0.000440378699
  error estimate for blocks of size 2^( 5) =       0.000449288861
  error estimate for blocks of size 2^( 6) =       0.000454894353
  error estimate for blocks of size 2^( 7) =       0.000459174432

      target function =                  N/A
              le_mean =     -16.906586261761
             les_mean =     286.172634929335
             stat err =       0.000450934086
             autocorr =       1.250481967917
              std dev =       0.570281582422
             le_variance =       0.325221083250


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690658626176e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906586261750       residual = 3.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906606697368       residual = 2.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906602644182       residual = 8.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906603912204       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906606211686       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906603817928       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906607343047       residual = 7.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906607066079       residual = 2.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906607306295       residual = 2.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906606816132       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906607157738       residual = 7.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906606900182       residual = 2.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906606838712       residual = 2.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906606995070       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906607072300       residual = 3.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         14 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e-01 is 1.465700e-03

solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906586261750       residual = 3.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906595960683       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906594748328       residual = 4.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906595534124       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906596230532       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906595604817       residual = 6.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906596267290       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906596199647       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906596345087       residual = 3.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906596460976       residual = 2.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906596425025       residual = 6.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 6.1035e-01 is 7.533811e-04

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906586261750       residual = 3.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906589388857       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906589150739       residual = 3.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906589526903       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906589619855       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906589528418       residual = 3.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906589590855       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906589590139       residual = 7.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906589640168       residual = 1.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906589677499       residual = 7.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.4414e+00 is 2.559980e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.099595 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7555e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
   uu_0                 3.135499e-01 1 1  ON 0
   uu_1                 1.459214e-01 1 1  ON 1
   uu_2                 4.403793e-02 1 1  ON 2
   uu_3                -1.908659e-02 1 1  ON 3
   uu_4                -6.546159e-02 1 1  ON 4
   uu_5                -1.012483e-01 1 1  ON 5
   uu_6                -1.295269e-01 1 1  ON 6
   uu_7                -1.439992e-01 1 1  ON 7
   uu_8                -1.372598e-01 1 1  ON 8
   uu_9                -1.068782e-01 1 1  ON 9
   ud_0                 4.489306e-01 1 1  ON 10
   ud_1                 1.830594e-01 1 1  ON 11
   ud_2                 6.262400e-02 1 1  ON 12
   ud_3                -8.588660e-03 1 1  ON 13
   ud_4                -6.581701e-02 1 1  ON 14
   ud_5                -1.073898e-01 1 1  ON 15
   ud_6                -1.351510e-01 1 1  ON 16
   ud_7                -1.522719e-01 1 1  ON 17
   ud_8                -1.536487e-01 1 1  ON 18
   ud_9                -1.425586e-01 1 1  ON 19
   eO_0                -7.512437e-01 1 1  ON 20
   eO_1                -4.308315e-01 1 1  ON 21
   eO_2                -1.971966e-02 1 1  ON 22
   eO_3                 2.931382e-01 1 1  ON 23
   eO_4                 5.187892e-01 1 1  ON 24
   eO_5                 4.811884e-01 1 1  ON 25
   eO_6                 2.549960e-01 1 1  ON 26
   eO_7                -4.423131e-02 1 1  ON 27
   eO_8                -2.202056e-01 1 1  ON 28
   eO_9                -8.154475e-02 1 1  ON 29
  eH1_0                -2.564537e-01 1 1  ON 30
  eH1_1                -1.488994e-01 1 1  ON 31
  eH1_2                -9.928017e-02 1 1  ON 32
  eH1_3                -4.398573e-02 1 1  ON 33
  eH1_4                 6.049496e-03 1 1  ON 34
  eH1_5                 4.164806e-02 1 1  ON 35
  eH1_6                 1.008807e-01 1 1  ON 36
  eH1_7                 1.563711e-01 1 1  ON 37
  eH1_8                 1.790586e-01 1 1  ON 38
  eH1_9                 6.696725e-02 1 1  ON 39
  eH2_0                -2.540120e-01 1 1  ON 40
  eH2_1                -1.464814e-01 1 1  ON 41
  eH2_2                -9.654938e-02 1 1  ON 42
  eH2_3                -4.132105e-02 1 1  ON 43
  eH2_4                 8.889624e-03 1 1  ON 44
  eH2_5                 4.443139e-02 1 1  ON 45
  eH2_6                 1.037042e-01 1 1  ON 46
  eH2_7                 1.579750e-01 1 1  ON 47
  eH2_8                 1.835722e-01 1 1  ON 48
  eH2_9                 5.531120e-02 1 1  ON 49
ci_0001                 7.010050e-01 3 1  ON 50
ci_0002                 7.008991e-01 3 1  ON 51
ci_0003                -2.761329e-02 3 1  ON 52
ci_0004                -2.728596e-02 3 1  ON 53
ci_0005                -3.627590e-02 3 1  ON 54
ci_0006                -3.695097e-02 3 1  ON 55
ci_0007                -2.038675e-02 3 1  ON 56
ci_0008                -2.170941e-02 3 1  ON 57
ci_0009                -1.685094e-02 3 1  ON 58
ci_0010                -1.714540e-02 3 1  ON 59
ci_0011                -1.150602e-02 3 1  ON 60
ci_0012                -1.172618e-02 3 1  ON 61
ci_0013                 1.331002e-02 3 1  ON 62
ci_0014                 1.315366e-02 3 1  ON 63
ci_0015                 1.319808e-02 3 1  ON 64
ci_0016                 1.317920e-02 3 1  ON 65
ci_0017                 1.185862e-02 3 1  ON 66
ci_0018                 1.131048e-02 3 1  ON 67
ci_0019                 1.165981e-02 3 1  ON 68
ci_0020                 1.119330e-02 3 1  ON 69
ci_0021                -1.037539e-03 3 1  ON 70
ci_0022                -1.167994e-03 3 1  ON 71
ci_0023                -1.117187e-02 3 1  ON 72
ci_0024                -1.126839e-02 3 1  ON 73
ci_0025                -1.074225e-02 3 1  ON 74
ci_0026                -1.006751e-02 3 1  ON 75
ci_0027                -1.150041e-02 3 1  ON 76
ci_0028                -1.119813e-02 3 1  ON 77
ci_0029                -1.090193e-02 3 1  ON 78
ci_0030                -1.114140e-02 3 1  ON 79
ci_0031                 2.075066e-02 3 1  ON 80
ci_0032                 2.115716e-02 3 1  ON 81
ci_0033                 9.250040e-03 3 1  ON 82
ci_0034                 1.057229e-02 3 1  ON 83
ci_0035                 6.895496e-03 3 1  ON 84
ci_0036                 6.008605e-03 3 1  ON 85
ci_0037                -1.027033e-02 3 1  ON 86
ci_0038                -1.077937e-02 3 1  ON 87
ci_0039                -2.619982e-03 3 1  ON 88
ci_0040                -2.519339e-03 3 1  ON 89
ci_0041                 7.292006e-03 3 1  ON 90
ci_0042                 7.162053e-03 3 1  ON 91
ci_0043                -1.863611e-02 3 1  ON 92
ci_0044                -1.850460e-02 3 1  ON 93
ci_0045                 7.884780e-03 3 1  ON 94
ci_0046                 7.127158e-03 3 1  ON 95
ci_0047                -1.805164e-03 3 1  ON 96
ci_0048                -1.586920e-03 3 1  ON 97
ci_0049                -4.584025e-03 3 1  ON 98
ci_0050                -5.343396e-03 3 1  ON 99
ci_0051                -3.607096e-03 3 1  ON 100
ci_0052                -3.515732e-03 3 1  ON 101
ci_0053                -4.457459e-03 3 1  ON 102
ci_0054                -4.997931e-03 3 1  ON 103
ci_0055                 6.254924e-03 3 1  ON 104
ci_0056                 6.255597e-03 3 1  ON 105
ci_0057                 4.931540e-03 3 1  ON 106
ci_0058                 4.680140e-03 3 1  ON 107
ci_0059                -4.795359e-03 3 1  ON 108
ci_0060                -4.645834e-03 3 1  ON 109
ci_0061                -3.337066e-03 3 1  ON 110
ci_0062                -3.128066e-03 3 1  ON 111
ci_0063                -8.523008e-03 3 1  ON 112
ci_0064                -8.250587e-03 3 1  ON 113
ci_0065                -5.077784e-03 3 1  ON 114
ci_0066                -5.453855e-03 3 1  ON 115
ci_0067                -4.388184e-03 3 1  ON 116
ci_0068                -4.848173e-03 3 1  ON 117
ci_0069                 4.744468e-03 3 1  ON 118
ci_0070                 4.571132e-03 3 1  ON 119
ci_0071                -1.311272e-04 3 1  ON 120
ci_0072                 4.742590e-04 3 1  ON 121
ci_0073                 4.269287e-03 3 1  ON 122
ci_0074                 4.251818e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.9539
    reference variance = 0.233717
====================================================
  Execution time = 2.0942e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3659e-01
  Total weights = 1.9516e+06
  Execution time = 1.9052e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321269970191
                                         uncertainty =       0.002432263183

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321269970191
                                         uncertainty =       0.002432263183

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400826724
  error estimate for blocks of size 2^( 2) =       0.000413910612
  error estimate for blocks of size 2^( 3) =       0.000426849867
  error estimate for blocks of size 2^( 4) =       0.000438692347
  error estimate for blocks of size 2^( 5) =       0.000449353855
  error estimate for blocks of size 2^( 6) =       0.000457922346
  error estimate for blocks of size 2^( 7) =       0.000464258036

      target function =                  N/A
              le_mean =     -16.906034151283
             les_mean =     286.157876934493
             stat err =       0.000452556646
             autocorr =       1.274772114293
              std dev =       0.566854589943
             le_variance =       0.321324126139

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321388609914
                                         uncertainty =       0.002468466870

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321388609914
                                         uncertainty =       0.002468466870

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400901148
  error estimate for blocks of size 2^( 2) =       0.000413950323
  error estimate for blocks of size 2^( 3) =       0.000426848191
  error estimate for blocks of size 2^( 4) =       0.000438662544
  error estimate for blocks of size 2^( 5) =       0.000449316699
  error estimate for blocks of size 2^( 6) =       0.000457851067
  error estimate for blocks of size 2^( 7) =       0.000464176706

      target function =                  N/A
              le_mean =     -16.906046969216
             les_mean =     286.157537208194
             stat err =       0.000452501754
             autocorr =       1.273989748521
              std dev =       0.566959841105
             le_variance =       0.321443461426

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321331311613
                                         uncertainty =       0.002471354383

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321331311613
                                         uncertainty =       0.002471354383

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400865142
  error estimate for blocks of size 2^( 2) =       0.000413919820
  error estimate for blocks of size 2^( 3) =       0.000426825442
  error estimate for blocks of size 2^( 4) =       0.000438643481
  error estimate for blocks of size 2^( 5) =       0.000449297711
  error estimate for blocks of size 2^( 6) =       0.000457828741
  error estimate for blocks of size 2^( 7) =       0.000464157872

      target function =                  N/A
              le_mean =     -16.906044440976
             les_mean =     286.151627787691
             stat err =       0.000452481951
             autocorr =       1.274107097815
              std dev =       0.566908920582
             le_variance =       0.321385724236

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321232647155
                                         uncertainty =       0.002436509153

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321232647155
                                         uncertainty =       0.002436509153

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400803461
  error estimate for blocks of size 2^( 2) =       0.000413876782
  error estimate for blocks of size 2^( 3) =       0.000426812265
  error estimate for blocks of size 2^( 4) =       0.000438640269
  error estimate for blocks of size 2^( 5) =       0.000449307536
  error estimate for blocks of size 2^( 6) =       0.000457863088
  error estimate for blocks of size 2^( 7) =       0.000464175163

      target function =                  N/A
              le_mean =     -16.906034619562
             les_mean =     286.155537214116
             stat err =       0.000452496514
             autocorr =       1.274581319892
              std dev =       0.566821690263
             le_variance =       0.321286828552


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906034151283        initial
     1.5259e-01     1.5259e+00             1.4657e-03       -16.906046969216  <--
     6.1035e-01     6.1035e+00             7.5338e-04       -16.906044440976
     2.4414e+00     2.4414e+01             2.5600e-04       -16.906034619562

*****************************************************************************
Applying the update for shift_i =   1.5259e-01     and shift_s =   1.5259e+00
*****************************************************************************

  Execution time = 3.0548e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
   uu_0                 3.136589e-01 1 1  ON 0
   uu_1                 1.461882e-01 1 1  ON 1
   uu_2                 4.433315e-02 1 1  ON 2
   uu_3                -1.883621e-02 1 1  ON 3
   uu_4                -6.534159e-02 1 1  ON 4
   uu_5                -1.011316e-01 1 1  ON 5
   uu_6                -1.294375e-01 1 1  ON 6
   uu_7                -1.440631e-01 1 1  ON 7
   uu_8                -1.381658e-01 1 1  ON 8
   uu_9                -1.077509e-01 1 1  ON 9
   ud_0                 4.493500e-01 1 1  ON 10
   ud_1                 1.834130e-01 1 1  ON 11
   ud_2                 6.293253e-02 1 1  ON 12
   ud_3                -8.394831e-03 1 1  ON 13
   ud_4                -6.571231e-02 1 1  ON 14
   ud_5                -1.071585e-01 1 1  ON 15
   ud_6                -1.350614e-01 1 1  ON 16
   ud_7                -1.522826e-01 1 1  ON 17
   ud_8                -1.541780e-01 1 1  ON 18
   ud_9                -1.432116e-01 1 1  ON 19
   eO_0                -7.512333e-01 1 1  ON 20
   eO_1                -4.308200e-01 1 1  ON 21
   eO_2                -1.944300e-02 1 1  ON 22
   eO_3                 2.935471e-01 1 1  ON 23
   eO_4                 5.189389e-01 1 1  ON 24
   eO_5                 4.816385e-01 1 1  ON 25
   eO_6                 2.554369e-01 1 1  ON 26
   eO_7                -4.402798e-02 1 1  ON 27
   eO_8                -2.211625e-01 1 1  ON 28
   eO_9                -8.239567e-02 1 1  ON 29
  eH1_0                -2.568468e-01 1 1  ON 30
  eH1_1                -1.491358e-01 1 1  ON 31
  eH1_2                -9.952883e-02 1 1  ON 32
  eH1_3                -4.408530e-02 1 1  ON 33
  eH1_4                 6.032867e-03 1 1  ON 34
  eH1_5                 4.158984e-02 1 1  ON 35
  eH1_6                 1.010427e-01 1 1  ON 36
  eH1_7                 1.564695e-01 1 1  ON 37
  eH1_8                 1.792463e-01 1 1  ON 38
  eH1_9                 6.759115e-02 1 1  ON 39
  eH2_0                -2.542494e-01 1 1  ON 40
  eH2_1                -1.468207e-01 1 1  ON 41
  eH2_2                -9.679297e-02 1 1  ON 42
  eH2_3                -4.160484e-02 1 1  ON 43
  eH2_4                 8.792786e-03 1 1  ON 44
  eH2_5                 4.434350e-02 1 1  ON 45
  eH2_6                 1.036680e-01 1 1  ON 46
  eH2_7                 1.578909e-01 1 1  ON 47
  eH2_8                 1.839502e-01 1 1  ON 48
  eH2_9                 5.625731e-02 1 1  ON 49
ci_0001                 7.011889e-01 3 1  ON 50
ci_0002                 7.007351e-01 3 1  ON 51
ci_0003                -2.731043e-02 3 1  ON 52
ci_0004                -2.744049e-02 3 1  ON 53
ci_0005                -3.583676e-02 3 1  ON 54
ci_0006                -3.706308e-02 3 1  ON 55
ci_0007                -2.010094e-02 3 1  ON 56
ci_0008                -2.155847e-02 3 1  ON 57
ci_0009                -1.632407e-02 3 1  ON 58
ci_0010                -1.752146e-02 3 1  ON 59
ci_0011                -1.148006e-02 3 1  ON 60
ci_0012                -1.167153e-02 3 1  ON 61
ci_0013                 1.343390e-02 3 1  ON 62
ci_0014                 1.281156e-02 3 1  ON 63
ci_0015                 1.323282e-02 3 1  ON 64
ci_0016                 1.306216e-02 3 1  ON 65
ci_0017                 1.233156e-02 3 1  ON 66
ci_0018                 1.134542e-02 3 1  ON 67
ci_0019                 1.196830e-02 3 1  ON 68
ci_0020                 1.112031e-02 3 1  ON 69
ci_0021                -1.097580e-03 3 1  ON 70
ci_0022                -1.412246e-03 3 1  ON 71
ci_0023                -1.135484e-02 3 1  ON 72
ci_0024                -1.140067e-02 3 1  ON 73
ci_0025                -1.084087e-02 3 1  ON 74
ci_0026                -9.787120e-03 3 1  ON 75
ci_0027                -1.159542e-02 3 1  ON 76
ci_0028                -1.123354e-02 3 1  ON 77
ci_0029                -1.096049e-02 3 1  ON 78
ci_0030                -1.104085e-02 3 1  ON 79
ci_0031                 2.051666e-02 3 1  ON 80
ci_0032                 2.099984e-02 3 1  ON 81
ci_0033                 8.570551e-03 3 1  ON 82
ci_0034                 1.130443e-02 3 1  ON 83
ci_0035                 7.221706e-03 3 1  ON 84
ci_0036                 6.024129e-03 3 1  ON 85
ci_0037                -1.019645e-02 3 1  ON 86
ci_0038                -1.100235e-02 3 1  ON 87
ci_0039                -2.720868e-03 3 1  ON 88
ci_0040                -2.370316e-03 3 1  ON 89
ci_0041                 7.461089e-03 3 1  ON 90
ci_0042                 7.104410e-03 3 1  ON 91
ci_0043                -1.887966e-02 3 1  ON 92
ci_0044                -1.874871e-02 3 1  ON 93
ci_0045                 7.568819e-03 3 1  ON 94
ci_0046                 7.220526e-03 3 1  ON 95
ci_0047                -1.606901e-03 3 1  ON 96
ci_0048                -1.366961e-03 3 1  ON 97
ci_0049                -3.822470e-03 3 1  ON 98
ci_0050                -5.363801e-03 3 1  ON 99
ci_0051                -3.619921e-03 3 1  ON 100
ci_0052                -3.469579e-03 3 1  ON 101
ci_0053                -4.205522e-03 3 1  ON 102
ci_0054                -5.247333e-03 3 1  ON 103
ci_0055                 6.592943e-03 3 1  ON 104
ci_0056                 6.333178e-03 3 1  ON 105
ci_0057                 5.384778e-03 3 1  ON 106
ci_0058                 4.598309e-03 3 1  ON 107
ci_0059                -4.867252e-03 3 1  ON 108
ci_0060                -4.747690e-03 3 1  ON 109
ci_0061                -3.299319e-03 3 1  ON 110
ci_0062                -3.123704e-03 3 1  ON 111
ci_0063                -8.868772e-03 3 1  ON 112
ci_0064                -8.335590e-03 3 1  ON 113
ci_0065                -5.173275e-03 3 1  ON 114
ci_0066                -5.468279e-03 3 1  ON 115
ci_0067                -3.847202e-03 3 1  ON 116
ci_0068                -4.739784e-03 3 1  ON 117
ci_0069                 5.456787e-03 3 1  ON 118
ci_0070                 4.498465e-03 3 1  ON 119
ci_0071                -8.419428e-05 3 1  ON 120
ci_0072                 2.472287e-04 3 1  ON 121
ci_0073                 4.402570e-03 3 1  ON 122
ci_0074                 4.130274e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8111e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6911e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.8471
    reference variance = 0.351375
====================================================
  Execution time = 2.1448e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5237e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3274e-01
  Total weights = 1.951856561e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.4875e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321533209046
                                         uncertainty =       0.002107292895

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321533209046
                                         uncertainty =       0.002107292895

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401027802
  error estimate for blocks of size 2^( 2) =       0.000413716204
  error estimate for blocks of size 2^( 3) =       0.000427586288
  error estimate for blocks of size 2^( 4) =       0.000440361799
  error estimate for blocks of size 2^( 5) =       0.000452773780
  error estimate for blocks of size 2^( 6) =       0.000461148183
  error estimate for blocks of size 2^( 7) =       0.000468545075

      target function =                  N/A
              le_mean =     -16.906131163270
             les_mean =     286.150014241249
             stat err =       0.000455707209
             autocorr =       1.291287166007
              std dev =       0.567138956422
             le_variance =       0.321646595891


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690613116327e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-02, overlap shift 3.8147e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906131163248       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906155448920       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906156546528       residual = 8.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906156773902       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906155062014       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906155881471       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906153732291       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906155392560       residual = 8.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906155533675       residual = 9.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906158027265       residual = 8.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906159050874       residual = 4.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906160567480       residual = 4.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906159487053       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906159270161       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906159980959       residual = 5.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.906160094038       residual = 2.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.906160398232       residual = 9.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e-02 is 5.698328e-03

solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906131163248       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906148345679       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906149380371       residual = 5.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906149792214       residual = 8.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906148340670       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906148737361       residual = 6.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906148138465       residual = 4.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906148518464       residual = 2.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906148697245       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906149483705       residual = 8.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906149594015       residual = 3.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906149750182       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906149513761       residual = 6.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e-01 is 1.667569e-03

solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906131163248       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906139081594       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906139654085       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906140150730       residual = 8.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906139670856       residual = 6.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906139426098       residual = 3.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906139591569       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906139492849       residual = 7.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906139557981       residual = 3.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906139649880       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906139710786       residual = 4.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 6.1035e-01 is 7.328131e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.106843 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9686e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
   uu_0                 3.136631e-01 1 1  ON 0
   uu_1                 1.459957e-01 1 1  ON 1
   uu_2                 4.407291e-02 1 1  ON 2
   uu_3                -1.895442e-02 1 1  ON 3
   uu_4                -6.535596e-02 1 1  ON 4
   uu_5                -1.013576e-01 1 1  ON 5
   uu_6                -1.293674e-01 1 1  ON 6
   uu_7                -1.441049e-01 1 1  ON 7
   uu_8                -1.381161e-01 1 1  ON 8
   uu_9                -1.081283e-01 1 1  ON 9
   ud_0                 4.492461e-01 1 1  ON 10
   ud_1                 1.833911e-01 1 1  ON 11
   ud_2                 6.297597e-02 1 1  ON 12
   ud_3                -8.201535e-03 1 1  ON 13
   ud_4                -6.556944e-02 1 1  ON 14
   ud_5                -1.073095e-01 1 1  ON 15
   ud_6                -1.351451e-01 1 1  ON 16
   ud_7                -1.521094e-01 1 1  ON 17
   ud_8                -1.540021e-01 1 1  ON 18
   ud_9                -1.432348e-01 1 1  ON 19
   eO_0                -7.511427e-01 1 1  ON 20
   eO_1                -4.305067e-01 1 1  ON 21
   eO_2                -1.949495e-02 1 1  ON 22
   eO_3                 2.932528e-01 1 1  ON 23
   eO_4                 5.194432e-01 1 1  ON 24
   eO_5                 4.820201e-01 1 1  ON 25
   eO_6                 2.555061e-01 1 1  ON 26
   eO_7                -4.347970e-02 1 1  ON 27
   eO_8                -2.216945e-01 1 1  ON 28
   eO_9                -8.329420e-02 1 1  ON 29
  eH1_0                -2.571479e-01 1 1  ON 30
  eH1_1                -1.501030e-01 1 1  ON 31
  eH1_2                -1.001702e-01 1 1  ON 32
  eH1_3                -4.456037e-02 1 1  ON 33
  eH1_4                 5.659552e-03 1 1  ON 34
  eH1_5                 4.147097e-02 1 1  ON 35
  eH1_6                 1.012915e-01 1 1  ON 36
  eH1_7                 1.565322e-01 1 1  ON 37
  eH1_8                 1.802139e-01 1 1  ON 38
  eH1_9                 6.903293e-02 1 1  ON 39
  eH2_0                -2.550250e-01 1 1  ON 40
  eH2_1                -1.470703e-01 1 1  ON 41
  eH2_2                -9.714834e-02 1 1  ON 42
  eH2_3                -4.184503e-02 1 1  ON 43
  eH2_4                 8.504115e-03 1 1  ON 44
  eH2_5                 4.386164e-02 1 1  ON 45
  eH2_6                 1.036420e-01 1 1  ON 46
  eH2_7                 1.580359e-01 1 1  ON 47
  eH2_8                 1.848442e-01 1 1  ON 48
  eH2_9                 5.759895e-02 1 1  ON 49
ci_0001                 7.012038e-01 3 1  ON 50
ci_0002                 7.007727e-01 3 1  ON 51
ci_0003                -2.732630e-02 3 1  ON 52
ci_0004                -2.717005e-02 3 1  ON 53
ci_0005                -3.588716e-02 3 1  ON 54
ci_0006                -3.636161e-02 3 1  ON 55
ci_0007                -2.009330e-02 3 1  ON 56
ci_0008                -2.140884e-02 3 1  ON 57
ci_0009                -1.680659e-02 3 1  ON 58
ci_0010                -1.809142e-02 3 1  ON 59
ci_0011                -1.234048e-02 3 1  ON 60
ci_0012                -1.156346e-02 3 1  ON 61
ci_0013                 1.383160e-02 3 1  ON 62
ci_0014                 1.318332e-02 3 1  ON 63
ci_0015                 1.283762e-02 3 1  ON 64
ci_0016                 1.309230e-02 3 1  ON 65
ci_0017                 1.158604e-02 3 1  ON 66
ci_0018                 1.136159e-02 3 1  ON 67
ci_0019                 1.148135e-02 3 1  ON 68
ci_0020                 1.122915e-02 3 1  ON 69
ci_0021                -1.208765e-03 3 1  ON 70
ci_0022                -1.293568e-03 3 1  ON 71
ci_0023                -1.166173e-02 3 1  ON 72
ci_0024                -1.105762e-02 3 1  ON 73
ci_0025                -1.107289e-02 3 1  ON 74
ci_0026                -1.081136e-02 3 1  ON 75
ci_0027                -1.145368e-02 3 1  ON 76
ci_0028                -1.137086e-02 3 1  ON 77
ci_0029                -1.073617e-02 3 1  ON 78
ci_0030                -1.073164e-02 3 1  ON 79
ci_0031                 2.026085e-02 3 1  ON 80
ci_0032                 2.090015e-02 3 1  ON 81
ci_0033                 8.644194e-03 3 1  ON 82
ci_0034                 1.086762e-02 3 1  ON 83
ci_0035                 7.240928e-03 3 1  ON 84
ci_0036                 6.198496e-03 3 1  ON 85
ci_0037                -1.019209e-02 3 1  ON 86
ci_0038                -1.039377e-02 3 1  ON 87
ci_0039                -2.320008e-03 3 1  ON 88
ci_0040                -2.418447e-03 3 1  ON 89
ci_0041                 6.769204e-03 3 1  ON 90
ci_0042                 7.270705e-03 3 1  ON 91
ci_0043                -1.927545e-02 3 1  ON 92
ci_0044                -1.837671e-02 3 1  ON 93
ci_0045                 7.556590e-03 3 1  ON 94
ci_0046                 7.117055e-03 3 1  ON 95
ci_0047                -1.662904e-03 3 1  ON 96
ci_0048                -1.649840e-03 3 1  ON 97
ci_0049                -5.490039e-03 3 1  ON 98
ci_0050                -6.143522e-03 3 1  ON 99
ci_0051                -3.540497e-03 3 1  ON 100
ci_0052                -3.512573e-03 3 1  ON 101
ci_0053                -4.433975e-03 3 1  ON 102
ci_0054                -5.335093e-03 3 1  ON 103
ci_0055                 6.269699e-03 3 1  ON 104
ci_0056                 6.639793e-03 3 1  ON 105
ci_0057                 5.053834e-03 3 1  ON 106
ci_0058                 4.592022e-03 3 1  ON 107
ci_0059                -4.581459e-03 3 1  ON 108
ci_0060                -4.459616e-03 3 1  ON 109
ci_0061                -3.210111e-03 3 1  ON 110
ci_0062                -3.453833e-03 3 1  ON 111
ci_0063                -8.346912e-03 3 1  ON 112
ci_0064                -8.356864e-03 3 1  ON 113
ci_0065                -5.128982e-03 3 1  ON 114
ci_0066                -5.145011e-03 3 1  ON 115
ci_0067                -3.972405e-03 3 1  ON 116
ci_0068                -4.784424e-03 3 1  ON 117
ci_0069                 4.334994e-03 3 1  ON 118
ci_0070                 4.386362e-03 3 1  ON 119
ci_0071                -6.627623e-04 3 1  ON 120
ci_0072                 8.446719e-04 3 1  ON 121
ci_0073                 4.247368e-03 3 1  ON 122
ci_0074                 4.279920e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.9439
    reference variance = 0.612466
====================================================
  Execution time = 2.1264e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3735e-01
  Total weights = 1.9519e+06
  Execution time = 1.9192e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322370941555
                                         uncertainty =       0.003505719591

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322370941555
                                         uncertainty =       0.003505719591

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401441287
  error estimate for blocks of size 2^( 2) =       0.000413596360
  error estimate for blocks of size 2^( 3) =       0.000426418069
  error estimate for blocks of size 2^( 4) =       0.000439757077
  error estimate for blocks of size 2^( 5) =       0.000450467602
  error estimate for blocks of size 2^( 6) =       0.000458777018
  error estimate for blocks of size 2^( 7) =       0.000467155637

      target function =                  N/A
              le_mean =     -16.905872193948
             les_mean =     286.155190751753
             stat err =       0.000454039333
             autocorr =       1.279213051683
              std dev =       0.567723712795
             le_variance =       0.322310214070

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322846292806
                                         uncertainty =       0.003467164196

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322846292806
                                         uncertainty =       0.003467164196

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401736437
  error estimate for blocks of size 2^( 2) =       0.000413898505
  error estimate for blocks of size 2^( 3) =       0.000426757582
  error estimate for blocks of size 2^( 4) =       0.000440117804
  error estimate for blocks of size 2^( 5) =       0.000450830151
  error estimate for blocks of size 2^( 6) =       0.000459094517
  error estimate for blocks of size 2^( 7) =       0.000467489723

      target function =                  N/A
              le_mean =     -16.905828480210
             les_mean =     286.146192703031
             stat err =       0.000454383049
             autocorr =       1.279268759235
              std dev =       0.568141118407
             le_variance =       0.322784330425

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323320917592
                                         uncertainty =       0.003461470134

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323320917592
                                         uncertainty =       0.003461470134

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402031220
  error estimate for blocks of size 2^( 2) =       0.000414194563
  error estimate for blocks of size 2^( 3) =       0.000427060059
  error estimate for blocks of size 2^( 4) =       0.000440425284
  error estimate for blocks of size 2^( 5) =       0.000451145158
  error estimate for blocks of size 2^( 6) =       0.000459416294
  error estimate for blocks of size 2^( 7) =       0.000467817171

      target function =                  N/A
              le_mean =     -16.905840894910
             les_mean =     286.160262249903
             stat err =       0.000454700977
             autocorr =       1.279181633295
              std dev =       0.568558003668
             le_variance =       0.323258203535

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322393948819
                                         uncertainty =       0.003493216443

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322393948819
                                         uncertainty =       0.003493216443

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401454934
  error estimate for blocks of size 2^( 2) =       0.000413613245
  error estimate for blocks of size 2^( 3) =       0.000426452997
  error estimate for blocks of size 2^( 4) =       0.000439798822
  error estimate for blocks of size 2^( 5) =       0.000450520897
  error estimate for blocks of size 2^( 6) =       0.000458814704
  error estimate for blocks of size 2^( 7) =       0.000467194213

      target function =                  N/A
              le_mean =     -16.905843660400
             les_mean =     286.148299944875
             stat err =       0.000454082159
             autocorr =       1.279367394735
              std dev =       0.567743012158
             le_variance =       0.322332127855


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905872193948        initial  <--
     3.8147e-02     3.8147e-01             5.6983e-03       -16.905828480210
     1.5259e-01     1.5259e+00             1.6676e-03       -16.905840894910
     6.1035e-01     6.1035e+00             7.3281e-04       -16.905843660400

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.9542
  </log>
  <optVariables href="H2O.s015.opt.xml">
   uu_0                 3.136589e-01 1 1  ON 0
   uu_1                 1.461882e-01 1 1  ON 1
   uu_2                 4.433315e-02 1 1  ON 2
   uu_3                -1.883621e-02 1 1  ON 3
   uu_4                -6.534159e-02 1 1  ON 4
   uu_5                -1.011316e-01 1 1  ON 5
   uu_6                -1.294375e-01 1 1  ON 6
   uu_7                -1.440631e-01 1 1  ON 7
   uu_8                -1.381658e-01 1 1  ON 8
   uu_9                -1.077509e-01 1 1  ON 9
   ud_0                 4.493500e-01 1 1  ON 10
   ud_1                 1.834130e-01 1 1  ON 11
   ud_2                 6.293253e-02 1 1  ON 12
   ud_3                -8.394831e-03 1 1  ON 13
   ud_4                -6.571231e-02 1 1  ON 14
   ud_5                -1.071585e-01 1 1  ON 15
   ud_6                -1.350614e-01 1 1  ON 16
   ud_7                -1.522826e-01 1 1  ON 17
   ud_8                -1.541780e-01 1 1  ON 18
   ud_9                -1.432116e-01 1 1  ON 19
   eO_0                -7.512333e-01 1 1  ON 20
   eO_1                -4.308200e-01 1 1  ON 21
   eO_2                -1.944300e-02 1 1  ON 22
   eO_3                 2.935471e-01 1 1  ON 23
   eO_4                 5.189389e-01 1 1  ON 24
   eO_5                 4.816385e-01 1 1  ON 25
   eO_6                 2.554369e-01 1 1  ON 26
   eO_7                -4.402798e-02 1 1  ON 27
   eO_8                -2.211625e-01 1 1  ON 28
   eO_9                -8.239567e-02 1 1  ON 29
  eH1_0                -2.568468e-01 1 1  ON 30
  eH1_1                -1.491358e-01 1 1  ON 31
  eH1_2                -9.952883e-02 1 1  ON 32
  eH1_3                -4.408530e-02 1 1  ON 33
  eH1_4                 6.032867e-03 1 1  ON 34
  eH1_5                 4.158984e-02 1 1  ON 35
  eH1_6                 1.010427e-01 1 1  ON 36
  eH1_7                 1.564695e-01 1 1  ON 37
  eH1_8                 1.792463e-01 1 1  ON 38
  eH1_9                 6.759115e-02 1 1  ON 39
  eH2_0                -2.542494e-01 1 1  ON 40
  eH2_1                -1.468207e-01 1 1  ON 41
  eH2_2                -9.679297e-02 1 1  ON 42
  eH2_3                -4.160484e-02 1 1  ON 43
  eH2_4                 8.792786e-03 1 1  ON 44
  eH2_5                 4.434350e-02 1 1  ON 45
  eH2_6                 1.036680e-01 1 1  ON 46
  eH2_7                 1.578909e-01 1 1  ON 47
  eH2_8                 1.839502e-01 1 1  ON 48
  eH2_9                 5.625731e-02 1 1  ON 49
ci_0001                 7.011889e-01 3 1  ON 50
ci_0002                 7.007351e-01 3 1  ON 51
ci_0003                -2.731043e-02 3 1  ON 52
ci_0004                -2.744049e-02 3 1  ON 53
ci_0005                -3.583676e-02 3 1  ON 54
ci_0006                -3.706308e-02 3 1  ON 55
ci_0007                -2.010094e-02 3 1  ON 56
ci_0008                -2.155847e-02 3 1  ON 57
ci_0009                -1.632407e-02 3 1  ON 58
ci_0010                -1.752146e-02 3 1  ON 59
ci_0011                -1.148006e-02 3 1  ON 60
ci_0012                -1.167153e-02 3 1  ON 61
ci_0013                 1.343390e-02 3 1  ON 62
ci_0014                 1.281156e-02 3 1  ON 63
ci_0015                 1.323282e-02 3 1  ON 64
ci_0016                 1.306216e-02 3 1  ON 65
ci_0017                 1.233156e-02 3 1  ON 66
ci_0018                 1.134542e-02 3 1  ON 67
ci_0019                 1.196830e-02 3 1  ON 68
ci_0020                 1.112031e-02 3 1  ON 69
ci_0021                -1.097580e-03 3 1  ON 70
ci_0022                -1.412246e-03 3 1  ON 71
ci_0023                -1.135484e-02 3 1  ON 72
ci_0024                -1.140067e-02 3 1  ON 73
ci_0025                -1.084087e-02 3 1  ON 74
ci_0026                -9.787120e-03 3 1  ON 75
ci_0027                -1.159542e-02 3 1  ON 76
ci_0028                -1.123354e-02 3 1  ON 77
ci_0029                -1.096049e-02 3 1  ON 78
ci_0030                -1.104085e-02 3 1  ON 79
ci_0031                 2.051666e-02 3 1  ON 80
ci_0032                 2.099984e-02 3 1  ON 81
ci_0033                 8.570551e-03 3 1  ON 82
ci_0034                 1.130443e-02 3 1  ON 83
ci_0035                 7.221706e-03 3 1  ON 84
ci_0036                 6.024129e-03 3 1  ON 85
ci_0037                -1.019645e-02 3 1  ON 86
ci_0038                -1.100235e-02 3 1  ON 87
ci_0039                -2.720868e-03 3 1  ON 88
ci_0040                -2.370316e-03 3 1  ON 89
ci_0041                 7.461089e-03 3 1  ON 90
ci_0042                 7.104410e-03 3 1  ON 91
ci_0043                -1.887966e-02 3 1  ON 92
ci_0044                -1.874871e-02 3 1  ON 93
ci_0045                 7.568819e-03 3 1  ON 94
ci_0046                 7.220526e-03 3 1  ON 95
ci_0047                -1.606901e-03 3 1  ON 96
ci_0048                -1.366961e-03 3 1  ON 97
ci_0049                -3.822470e-03 3 1  ON 98
ci_0050                -5.363801e-03 3 1  ON 99
ci_0051                -3.619921e-03 3 1  ON 100
ci_0052                -3.469579e-03 3 1  ON 101
ci_0053                -4.205522e-03 3 1  ON 102
ci_0054                -5.247333e-03 3 1  ON 103
ci_0055                 6.592943e-03 3 1  ON 104
ci_0056                 6.333178e-03 3 1  ON 105
ci_0057                 5.384778e-03 3 1  ON 106
ci_0058                 4.598309e-03 3 1  ON 107
ci_0059                -4.867252e-03 3 1  ON 108
ci_0060                -4.747690e-03 3 1  ON 109
ci_0061                -3.299319e-03 3 1  ON 110
ci_0062                -3.123704e-03 3 1  ON 111
ci_0063                -8.868772e-03 3 1  ON 112
ci_0064                -8.335590e-03 3 1  ON 113
ci_0065                -5.173275e-03 3 1  ON 114
ci_0066                -5.468279e-03 3 1  ON 115
ci_0067                -3.847202e-03 3 1  ON 116
ci_0068                -4.739784e-03 3 1  ON 117
ci_0069                 5.456787e-03 3 1  ON 118
ci_0070                 4.498465e-03 3 1  ON 119
ci_0071                -8.419428e-05 3 1  ON 120
ci_0072                 2.472287e-04 3 1  ON 121
ci_0073                 4.402570e-03 3 1  ON 122
ci_0074                 4.130274e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.0649e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.9901
    reference variance = 0.539084
====================================================
  Execution time = 2.1286e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5233e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3577e-01
  Total weights = 1.952192393e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1825e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322639448859
                                         uncertainty =       0.002287053324

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322639448859
                                         uncertainty =       0.002287053324

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401665305
  error estimate for blocks of size 2^( 2) =       0.000414183551
  error estimate for blocks of size 2^( 3) =       0.000426918664
  error estimate for blocks of size 2^( 4) =       0.000438801778
  error estimate for blocks of size 2^( 5) =       0.000448197371
  error estimate for blocks of size 2^( 6) =       0.000455707441
  error estimate for blocks of size 2^( 7) =       0.000460407411

      target function =                  N/A
              le_mean =     -16.906187736820
             les_mean =     286.154953107045
             stat err =       0.000450778500
             autocorr =       1.259498771690
              std dev =       0.568040522428
             le_variance =       0.322670035120


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690618773682e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906187736816       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906202460905       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906204874425       residual = 5.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906205104676       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906204693576       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906206436284       residual = 7.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906206384699       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906206337910       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906206207888       residual = 4.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906206326129       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906206262690       residual = 7.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e-01 is 7.407181e-04

solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906187736816       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906192787782       residual = 8.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906193421742       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906193696951       residual = 8.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906193552346       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906193862758       residual = 4.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906193940449       residual = 9.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906193940993       residual = 7.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906193892554       residual = 2.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906193953909       residual = 5.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e+00 is 2.544224e-04

solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906187736816       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906189129096       residual = 7.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906189291300       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906189382586       residual = 8.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906189339056       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906189401783       residual = 3.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906189421264       residual = 8.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906189432374       residual = 5.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906189423419       residual = 1.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906189435940       residual = 4.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 6.1035e+00 is 7.024213e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.110993 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7476e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
   uu_0                 3.137074e-01 1 1  ON 0
   uu_1                 1.462693e-01 1 1  ON 1
   uu_2                 4.431762e-02 1 1  ON 2
   uu_3                -1.877969e-02 1 1  ON 3
   uu_4                -6.527881e-02 1 1  ON 4
   uu_5                -1.011517e-01 1 1  ON 5
   uu_6                -1.294419e-01 1 1  ON 6
   uu_7                -1.440229e-01 1 1  ON 7
   uu_8                -1.382738e-01 1 1  ON 8
   uu_9                -1.078987e-01 1 1  ON 9
   ud_0                 4.493458e-01 1 1  ON 10
   ud_1                 1.834824e-01 1 1  ON 11
   ud_2                 6.298395e-02 1 1  ON 12
   ud_3                -8.352915e-03 1 1  ON 13
   ud_4                -6.565786e-02 1 1  ON 14
   ud_5                -1.071151e-01 1 1  ON 15
   ud_6                -1.350408e-01 1 1  ON 16
   ud_7                -1.522921e-01 1 1  ON 17
   ud_8                -1.542629e-01 1 1  ON 18
   ud_9                -1.433116e-01 1 1  ON 19
   eO_0                -7.512240e-01 1 1  ON 20
   eO_1                -4.307393e-01 1 1  ON 21
   eO_2                -1.946220e-02 1 1  ON 22
   eO_3                 2.935605e-01 1 1  ON 23
   eO_4                 5.189662e-01 1 1  ON 24
   eO_5                 4.816852e-01 1 1  ON 25
   eO_6                 2.555251e-01 1 1  ON 26
   eO_7                -4.400210e-02 1 1  ON 27
   eO_8                -2.213130e-01 1 1  ON 28
   eO_9                -8.250291e-02 1 1  ON 29
  eH1_0                -2.569342e-01 1 1  ON 30
  eH1_1                -1.491967e-01 1 1  ON 31
  eH1_2                -9.957096e-02 1 1  ON 32
  eH1_3                -4.413215e-02 1 1  ON 33
  eH1_4                 6.054032e-03 1 1  ON 34
  eH1_5                 4.164576e-02 1 1  ON 35
  eH1_6                 1.010491e-01 1 1  ON 36
  eH1_7                 1.564842e-01 1 1  ON 37
  eH1_8                 1.793290e-01 1 1  ON 38
  eH1_9                 6.766418e-02 1 1  ON 39
  eH2_0                -2.542680e-01 1 1  ON 40
  eH2_1                -1.467806e-01 1 1  ON 41
  eH2_2                -9.686182e-02 1 1  ON 42
  eH2_3                -4.161069e-02 1 1  ON 43
  eH2_4                 8.730751e-03 1 1  ON 44
  eH2_5                 4.436066e-02 1 1  ON 45
  eH2_6                 1.036731e-01 1 1  ON 46
  eH2_7                 1.578705e-01 1 1  ON 47
  eH2_8                 1.839481e-01 1 1  ON 48
  eH2_9                 5.636547e-02 1 1  ON 49
ci_0001                 7.012219e-01 3 1  ON 50
ci_0002                 7.006897e-01 3 1  ON 51
ci_0003                -2.741468e-02 3 1  ON 52
ci_0004                -2.741676e-02 3 1  ON 53
ci_0005                -3.584466e-02 3 1  ON 54
ci_0006                -3.700824e-02 3 1  ON 55
ci_0007                -2.019520e-02 3 1  ON 56
ci_0008                -2.149643e-02 3 1  ON 57
ci_0009                -1.652048e-02 3 1  ON 58
ci_0010                -1.748244e-02 3 1  ON 59
ci_0011                -1.156616e-02 3 1  ON 60
ci_0012                -1.175870e-02 3 1  ON 61
ci_0013                 1.335922e-02 3 1  ON 62
ci_0014                 1.283436e-02 3 1  ON 63
ci_0015                 1.328108e-02 3 1  ON 64
ci_0016                 1.315213e-02 3 1  ON 65
ci_0017                 1.234579e-02 3 1  ON 66
ci_0018                 1.130603e-02 3 1  ON 67
ci_0019                 1.206764e-02 3 1  ON 68
ci_0020                 1.113017e-02 3 1  ON 69
ci_0021                -1.210438e-03 3 1  ON 70
ci_0022                -1.420802e-03 3 1  ON 71
ci_0023                -1.135157e-02 3 1  ON 72
ci_0024                -1.136062e-02 3 1  ON 73
ci_0025                -1.069156e-02 3 1  ON 74
ci_0026                -1.004154e-02 3 1  ON 75
ci_0027                -1.150721e-02 3 1  ON 76
ci_0028                -1.113400e-02 3 1  ON 77
ci_0029                -1.095791e-02 3 1  ON 78
ci_0030                -1.098318e-02 3 1  ON 79
ci_0031                 2.053233e-02 3 1  ON 80
ci_0032                 2.111046e-02 3 1  ON 81
ci_0033                 8.713856e-03 3 1  ON 82
ci_0034                 1.114376e-02 3 1  ON 83
ci_0035                 7.115364e-03 3 1  ON 84
ci_0036                 6.049632e-03 3 1  ON 85
ci_0037                -1.043067e-02 3 1  ON 86
ci_0038                -1.092721e-02 3 1  ON 87
ci_0039                -2.694857e-03 3 1  ON 88
ci_0040                -2.356568e-03 3 1  ON 89
ci_0041                 7.341317e-03 3 1  ON 90
ci_0042                 7.074761e-03 3 1  ON 91
ci_0043                -1.883363e-02 3 1  ON 92
ci_0044                -1.876754e-02 3 1  ON 93
ci_0045                 7.658869e-03 3 1  ON 94
ci_0046                 7.166882e-03 3 1  ON 95
ci_0047                -1.631982e-03 3 1  ON 96
ci_0048                -1.358736e-03 3 1  ON 97
ci_0049                -4.027590e-03 3 1  ON 98
ci_0050                -5.431007e-03 3 1  ON 99
ci_0051                -3.594739e-03 3 1  ON 100
ci_0052                -3.504208e-03 3 1  ON 101
ci_0053                -4.242624e-03 3 1  ON 102
ci_0054                -5.129035e-03 3 1  ON 103
ci_0055                 6.554268e-03 3 1  ON 104
ci_0056                 6.416194e-03 3 1  ON 105
ci_0057                 5.311961e-03 3 1  ON 106
ci_0058                 4.744411e-03 3 1  ON 107
ci_0059                -4.786157e-03 3 1  ON 108
ci_0060                -4.837847e-03 3 1  ON 109
ci_0061                -3.247935e-03 3 1  ON 110
ci_0062                -3.187882e-03 3 1  ON 111
ci_0063                -8.848553e-03 3 1  ON 112
ci_0064                -8.390646e-03 3 1  ON 113
ci_0065                -5.245706e-03 3 1  ON 114
ci_0066                -5.455568e-03 3 1  ON 115
ci_0067                -3.961797e-03 3 1  ON 116
ci_0068                -4.737271e-03 3 1  ON 117
ci_0069                 5.347719e-03 3 1  ON 118
ci_0070                 4.630210e-03 3 1  ON 119
ci_0071                -4.773153e-05 3 1  ON 120
ci_0072                 2.882736e-04 3 1  ON 121
ci_0073                 4.278820e-03 3 1  ON 122
ci_0074                 4.110625e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.8389
    reference variance = 0.247241
====================================================
  Execution time = 2.1182e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5078e-01
  Total weights = 1.9520e+06
  Execution time = 1.9165e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331992638325
                                         uncertainty =       0.006444536160

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331992638325
                                         uncertainty =       0.006444536160

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407431502
  error estimate for blocks of size 2^( 2) =       0.000420082766
  error estimate for blocks of size 2^( 3) =       0.000432930575
  error estimate for blocks of size 2^( 4) =       0.000444163969
  error estimate for blocks of size 2^( 5) =       0.000454280545
  error estimate for blocks of size 2^( 6) =       0.000461722873
  error estimate for blocks of size 2^( 7) =       0.000467038250

      target function =                  N/A
              le_mean =     -16.905848549007
             les_mean =     286.158412627286
             stat err =       0.000456801409
             autocorr =       1.257030050601
              std dev =       0.576195155912
             le_variance =       0.332000857696

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332660243460
                                         uncertainty =       0.006913716205

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332660243460
                                         uncertainty =       0.006913716205

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407840976
  error estimate for blocks of size 2^( 2) =       0.000420481058
  error estimate for blocks of size 2^( 3) =       0.000433302557
  error estimate for blocks of size 2^( 4) =       0.000444501283
  error estimate for blocks of size 2^( 5) =       0.000454602518
  error estimate for blocks of size 2^( 6) =       0.000462055042
  error estimate for blocks of size 2^( 7) =       0.000467365390

      target function =                  N/A
              le_mean =     -16.905864555406
             les_mean =     286.169385631509
             stat err =       0.000457131058
             autocorr =       1.256318464229
              std dev =       0.576774239718
             le_variance =       0.332668523602

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332350063040
                                         uncertainty =       0.006736093788

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332350063040
                                         uncertainty =       0.006736093788

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407650832
  error estimate for blocks of size 2^( 2) =       0.000420296658
  error estimate for blocks of size 2^( 3) =       0.000433129224
  error estimate for blocks of size 2^( 4) =       0.000444341393
  error estimate for blocks of size 2^( 5) =       0.000454451565
  error estimate for blocks of size 2^( 6) =       0.000461902309
  error estimate for blocks of size 2^( 7) =       0.000467210062

      target function =                  N/A
              le_mean =     -16.905856069916
             les_mean =     286.161684513679
             stat err =       0.000456976332
             autocorr =       1.256639625072
              std dev =       0.576505334992
             le_variance =       0.332358401274

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332034204168
                                         uncertainty =       0.006481990427

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332034204168
                                         uncertainty =       0.006481990427

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407457010
  error estimate for blocks of size 2^( 2) =       0.000420103872
  error estimate for blocks of size 2^( 3) =       0.000432950170
  error estimate for blocks of size 2^( 4) =       0.000444180725
  error estimate for blocks of size 2^( 5) =       0.000454295716
  error estimate for blocks of size 2^( 6) =       0.000461737543
  error estimate for blocks of size 2^( 7) =       0.000467052301

      target function =                  N/A
              le_mean =     -16.905850314045
             les_mean =     286.172816434443
             stat err =       0.000456816571
             autocorr =       1.256956104050
              std dev =       0.576231229884
             le_variance =       0.332042430294


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905848549007        initial
     3.8147e-01     3.8147e+00             7.4072e-04       -16.905864555406  <--
     1.5259e+00     1.5259e+01             2.5442e-04       -16.905856069916
     6.1035e+00     6.1035e+01             7.0242e-05       -16.905850314045

*****************************************************************************
Applying the update for shift_i =   3.8147e-01     and shift_s =   3.8147e+00
*****************************************************************************

  Execution time = 3.0868e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
   uu_0                 3.138642e-01 1 1  ON 0
   uu_1                 1.464249e-01 1 1  ON 1
   uu_2                 4.436244e-02 1 1  ON 2
   uu_3                -1.865556e-02 1 1  ON 3
   uu_4                -6.513427e-02 1 1  ON 4
   uu_5                -1.011464e-01 1 1  ON 5
   uu_6                -1.294632e-01 1 1  ON 6
   uu_7                -1.439354e-01 1 1  ON 7
   uu_8                -1.385638e-01 1 1  ON 8
   uu_9                -1.083236e-01 1 1  ON 9
   ud_0                 4.494215e-01 1 1  ON 10
   ud_1                 1.836397e-01 1 1  ON 11
   ud_2                 6.312445e-02 1 1  ON 12
   ud_3                -8.214246e-03 1 1  ON 13
   ud_4                -6.552977e-02 1 1  ON 14
   ud_5                -1.070098e-01 1 1  ON 15
   ud_6                -1.350083e-01 1 1  ON 16
   ud_7                -1.523138e-01 1 1  ON 17
   ud_8                -1.544860e-01 1 1  ON 18
   ud_9                -1.435996e-01 1 1  ON 19
   eO_0                -7.511390e-01 1 1  ON 20
   eO_1                -4.305817e-01 1 1  ON 21
   eO_2                -1.947792e-02 1 1  ON 22
   eO_3                 2.935759e-01 1 1  ON 23
   eO_4                 5.190587e-01 1 1  ON 24
   eO_5                 4.818266e-01 1 1  ON 25
   eO_6                 2.557699e-01 1 1  ON 26
   eO_7                -4.392554e-02 1 1  ON 27
   eO_8                -2.217517e-01 1 1  ON 28
   eO_9                -8.281924e-02 1 1  ON 29
  eH1_0                -2.571853e-01 1 1  ON 30
  eH1_1                -1.493615e-01 1 1  ON 31
  eH1_2                -9.970922e-02 1 1  ON 32
  eH1_3                -4.424213e-02 1 1  ON 33
  eH1_4                 6.086321e-03 1 1  ON 34
  eH1_5                 4.179642e-02 1 1  ON 35
  eH1_6                 1.010777e-01 1 1  ON 36
  eH1_7                 1.565273e-01 1 1  ON 37
  eH1_8                 1.795711e-01 1 1  ON 38
  eH1_9                 6.788066e-02 1 1  ON 39
  eH2_0                -2.543181e-01 1 1  ON 40
  eH2_1                -1.467483e-01 1 1  ON 41
  eH2_2                -9.700300e-02 1 1  ON 42
  eH2_3                -4.165019e-02 1 1  ON 43
  eH2_4                 8.596608e-03 1 1  ON 44
  eH2_5                 4.439529e-02 1 1  ON 45
  eH2_6                 1.036902e-01 1 1  ON 46
  eH2_7                 1.578130e-01 1 1  ON 47
  eH2_8                 1.839442e-01 1 1  ON 48
  eH2_9                 5.668600e-02 1 1  ON 49
ci_0001                 7.013307e-01 3 1  ON 50
ci_0002                 7.005569e-01 3 1  ON 51
ci_0003                -2.761905e-02 3 1  ON 52
ci_0004                -2.737180e-02 3 1  ON 53
ci_0005                -3.586238e-02 3 1  ON 54
ci_0006                -3.688775e-02 3 1  ON 55
ci_0007                -2.041703e-02 3 1  ON 56
ci_0008                -2.135277e-02 3 1  ON 57
ci_0009                -1.688343e-02 3 1  ON 58
ci_0010                -1.740854e-02 3 1  ON 59
ci_0011                -1.172301e-02 3 1  ON 60
ci_0012                -1.193080e-02 3 1  ON 61
ci_0013                 1.321649e-02 3 1  ON 62
ci_0014                 1.288096e-02 3 1  ON 63
ci_0015                 1.337010e-02 3 1  ON 64
ci_0016                 1.333071e-02 3 1  ON 65
ci_0017                 1.236533e-02 3 1  ON 66
ci_0018                 1.123495e-02 3 1  ON 67
ci_0019                 1.225299e-02 3 1  ON 68
ci_0020                 1.114866e-02 3 1  ON 69
ci_0021                -1.480287e-03 3 1  ON 70
ci_0022                -1.436177e-03 3 1  ON 71
ci_0023                -1.134145e-02 3 1  ON 72
ci_0024                -1.128434e-02 3 1  ON 73
ci_0025                -1.040765e-02 3 1  ON 74
ci_0026                -1.052784e-02 3 1  ON 75
ci_0027                -1.133353e-02 3 1  ON 76
ci_0028                -1.094122e-02 3 1  ON 77
ci_0029                -1.094893e-02 3 1  ON 78
ci_0030                -1.086286e-02 3 1  ON 79
ci_0031                 2.056526e-02 3 1  ON 80
ci_0032                 2.136413e-02 3 1  ON 81
ci_0033                 9.052799e-03 3 1  ON 82
ci_0034                 1.077106e-02 3 1  ON 83
ci_0035                 6.898827e-03 3 1  ON 84
ci_0036                 6.093972e-03 3 1  ON 85
ci_0037                -1.092050e-02 3 1  ON 86
ci_0038                -1.077043e-02 3 1  ON 87
ci_0039                -2.655174e-03 3 1  ON 88
ci_0040                -2.333713e-03 3 1  ON 89
ci_0041                 7.104578e-03 3 1  ON 90
ci_0042                 7.018731e-03 3 1  ON 91
ci_0043                -1.872145e-02 3 1  ON 92
ci_0044                -1.880824e-02 3 1  ON 93
ci_0045                 7.856818e-03 3 1  ON 94
ci_0046                 7.047683e-03 3 1  ON 95
ci_0047                -1.670015e-03 3 1  ON 96
ci_0048                -1.345735e-03 3 1  ON 97
ci_0049                -4.416139e-03 3 1  ON 98
ci_0050                -5.559564e-03 3 1  ON 99
ci_0051                -3.549608e-03 3 1  ON 100
ci_0052                -3.558806e-03 3 1  ON 101
ci_0053                -4.303755e-03 3 1  ON 102
ci_0054                -4.932304e-03 3 1  ON 103
ci_0055                 6.469391e-03 3 1  ON 104
ci_0056                 6.590575e-03 3 1  ON 105
ci_0057                 5.169425e-03 3 1  ON 106
ci_0058                 5.029151e-03 3 1  ON 107
ci_0059                -4.650024e-03 3 1  ON 108
ci_0060                -4.986749e-03 3 1  ON 109
ci_0061                -3.142689e-03 3 1  ON 110
ci_0062                -3.313659e-03 3 1  ON 111
ci_0063                -8.808397e-03 3 1  ON 112
ci_0064                -8.486280e-03 3 1  ON 113
ci_0065                -5.376494e-03 3 1  ON 114
ci_0066                -5.434935e-03 3 1  ON 115
ci_0067                -4.144695e-03 3 1  ON 116
ci_0068                -4.732465e-03 3 1  ON 117
ci_0069                 5.173076e-03 3 1  ON 118
ci_0070                 4.842538e-03 3 1  ON 119
ci_0071                 2.954434e-05 3 1  ON 120
ci_0072                 3.613515e-04 3 1  ON 121
ci_0073                 4.086642e-03 3 1  ON 122
ci_0074                 4.080592e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8351e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6911e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.9053
    reference variance = 0.324239
====================================================
  Execution time = 2.1623e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5256e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3486e-01
  Total weights = 1.951544191e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0507e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321840172322
                                         uncertainty =       0.001878409397

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321840172322
                                         uncertainty =       0.001878409397

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401158516
  error estimate for blocks of size 2^( 2) =       0.000413973202
  error estimate for blocks of size 2^( 3) =       0.000426914039
  error estimate for blocks of size 2^( 4) =       0.000439762006
  error estimate for blocks of size 2^( 5) =       0.000450874441
  error estimate for blocks of size 2^( 6) =       0.000458948329
  error estimate for blocks of size 2^( 7) =       0.000463512427

      target function =                  N/A
              le_mean =     -16.906074862138
             les_mean =     286.150223721793
             stat err =       0.000453274301
             autocorr =       1.276703829490
              std dev =       0.567323813974
             le_variance =       0.321856309902


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690607486214e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-02, overlap shift 9.5367e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906074862123       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906084478716       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906083103679       residual = 7.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906084322013       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906085065358       residual = 7.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906085790174       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906085451156       residual = 9.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906085716330       residual = 5.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906085653424       residual = 3.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906087048770       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906087793815       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906087667752       residual = 5.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906087462230       residual = 2.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906087612636       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906087515772       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.906087399071       residual = 3.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.5367e-02 is 2.534667e-03

solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906074862123       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906080086155       residual = 5.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906079342777       residual = 4.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906079541002       residual = 7.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906079513490       residual = 7.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906079567088       residual = 7.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906079482874       residual = 2.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906079723840       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906079878502       residual = 5.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906079973756       residual = 2.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906080034763       residual = 7.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e-01 is 6.764750e-04

solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906074862123       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906076709978       residual = 3.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906076489092       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906076434984       residual = 6.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906076387364       residual = 9.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906076394773       residual = 3.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906076419986       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906076482454       residual = 4.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906076498353       residual = 1.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906076515999       residual = 5.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e+00 is 2.220625e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.117074 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7684e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
   uu_0                 3.138643e-01 1 1  ON 0
   uu_1                 1.463431e-01 1 1  ON 1
   uu_2                 4.432489e-02 1 1  ON 2
   uu_3                -1.884317e-02 1 1  ON 3
   uu_4                -6.528575e-02 1 1  ON 4
   uu_5                -1.010446e-01 1 1  ON 5
   uu_6                -1.298315e-01 1 1  ON 6
   uu_7                -1.440174e-01 1 1  ON 7
   uu_8                -1.383509e-01 1 1  ON 8
   uu_9                -1.082605e-01 1 1  ON 9
   ud_0                 4.493965e-01 1 1  ON 10
   ud_1                 1.835452e-01 1 1  ON 11
   ud_2                 6.297513e-02 1 1  ON 12
   ud_3                -8.139690e-03 1 1  ON 13
   ud_4                -6.539087e-02 1 1  ON 14
   ud_5                -1.070510e-01 1 1  ON 15
   ud_6                -1.350774e-01 1 1  ON 16
   ud_7                -1.523543e-01 1 1  ON 17
   ud_8                -1.544880e-01 1 1  ON 18
   ud_9                -1.434732e-01 1 1  ON 19
   eO_0                -7.511279e-01 1 1  ON 20
   eO_1                -4.304995e-01 1 1  ON 21
   eO_2                -1.934881e-02 1 1  ON 22
   eO_3                 2.936796e-01 1 1  ON 23
   eO_4                 5.188417e-01 1 1  ON 24
   eO_5                 4.819652e-01 1 1  ON 25
   eO_6                 2.557790e-01 1 1  ON 26
   eO_7                -4.367317e-02 1 1  ON 27
   eO_8                -2.219029e-01 1 1  ON 28
   eO_9                -8.313046e-02 1 1  ON 29
  eH1_0                -2.572356e-01 1 1  ON 30
  eH1_1                -1.495765e-01 1 1  ON 31
  eH1_2                -9.988044e-02 1 1  ON 32
  eH1_3                -4.428462e-02 1 1  ON 33
  eH1_4                 5.977081e-03 1 1  ON 34
  eH1_5                 4.156139e-02 1 1  ON 35
  eH1_6                 1.008636e-01 1 1  ON 36
  eH1_7                 1.567211e-01 1 1  ON 37
  eH1_8                 1.799621e-01 1 1  ON 38
  eH1_9                 6.831892e-02 1 1  ON 39
  eH2_0                -2.545383e-01 1 1  ON 40
  eH2_1                -1.471864e-01 1 1  ON 41
  eH2_2                -9.725854e-02 1 1  ON 42
  eH2_3                -4.176362e-02 1 1  ON 43
  eH2_4                 8.304037e-03 1 1  ON 44
  eH2_5                 4.413932e-02 1 1  ON 45
  eH2_6                 1.037752e-01 1 1  ON 46
  eH2_7                 1.581382e-01 1 1  ON 47
  eH2_8                 1.843636e-01 1 1  ON 48
  eH2_9                 5.730736e-02 1 1  ON 49
ci_0001                 7.013284e-01 3 1  ON 50
ci_0002                 7.005529e-01 3 1  ON 51
ci_0003                -2.767904e-02 3 1  ON 52
ci_0004                -2.755061e-02 3 1  ON 53
ci_0005                -3.574216e-02 3 1  ON 54
ci_0006                -3.685418e-02 3 1  ON 55
ci_0007                -2.078319e-02 3 1  ON 56
ci_0008                -2.123222e-02 3 1  ON 57
ci_0009                -1.703394e-02 3 1  ON 58
ci_0010                -1.722875e-02 3 1  ON 59
ci_0011                -1.201084e-02 3 1  ON 60
ci_0012                -1.195796e-02 3 1  ON 61
ci_0013                 1.329323e-02 3 1  ON 62
ci_0014                 1.284863e-02 3 1  ON 63
ci_0015                 1.357380e-02 3 1  ON 64
ci_0016                 1.329339e-02 3 1  ON 65
ci_0017                 1.173204e-02 3 1  ON 66
ci_0018                 1.115507e-02 3 1  ON 67
ci_0019                 1.206358e-02 3 1  ON 68
ci_0020                 1.120245e-02 3 1  ON 69
ci_0021                -1.555250e-03 3 1  ON 70
ci_0022                -1.003694e-03 3 1  ON 71
ci_0023                -1.120467e-02 3 1  ON 72
ci_0024                -1.123630e-02 3 1  ON 73
ci_0025                -1.101826e-02 3 1  ON 74
ci_0026                -1.049972e-02 3 1  ON 75
ci_0027                -1.140237e-02 3 1  ON 76
ci_0028                -1.122232e-02 3 1  ON 77
ci_0029                -1.077545e-02 3 1  ON 78
ci_0030                -1.082055e-02 3 1  ON 79
ci_0031                 2.059522e-02 3 1  ON 80
ci_0032                 2.068766e-02 3 1  ON 81
ci_0033                 9.246003e-03 3 1  ON 82
ci_0034                 1.048556e-02 3 1  ON 83
ci_0035                 7.154038e-03 3 1  ON 84
ci_0036                 6.181341e-03 3 1  ON 85
ci_0037                -1.123566e-02 3 1  ON 86
ci_0038                -1.094374e-02 3 1  ON 87
ci_0039                -2.818631e-03 3 1  ON 88
ci_0040                -2.548441e-03 3 1  ON 89
ci_0041                 7.329767e-03 3 1  ON 90
ci_0042                 7.261091e-03 3 1  ON 91
ci_0043                -1.878889e-02 3 1  ON 92
ci_0044                -1.886937e-02 3 1  ON 93
ci_0045                 7.915075e-03 3 1  ON 94
ci_0046                 7.127753e-03 3 1  ON 95
ci_0047                -1.475558e-03 3 1  ON 96
ci_0048                -1.875182e-03 3 1  ON 97
ci_0049                -4.684169e-03 3 1  ON 98
ci_0050                -5.534666e-03 3 1  ON 99
ci_0051                -3.727013e-03 3 1  ON 100
ci_0052                -3.577959e-03 3 1  ON 101
ci_0053                -4.403786e-03 3 1  ON 102
ci_0054                -4.845163e-03 3 1  ON 103
ci_0055                 6.477284e-03 3 1  ON 104
ci_0056                 6.279184e-03 3 1  ON 105
ci_0057                 5.323295e-03 3 1  ON 106
ci_0058                 5.024134e-03 3 1  ON 107
ci_0059                -4.895885e-03 3 1  ON 108
ci_0060                -4.949063e-03 3 1  ON 109
ci_0061                -3.104573e-03 3 1  ON 110
ci_0062                -3.196272e-03 3 1  ON 111
ci_0063                -8.533078e-03 3 1  ON 112
ci_0064                -8.863823e-03 3 1  ON 113
ci_0065                -5.412748e-03 3 1  ON 114
ci_0066                -5.039135e-03 3 1  ON 115
ci_0067                -4.421566e-03 3 1  ON 116
ci_0068                -4.689917e-03 3 1  ON 117
ci_0069                 4.602672e-03 3 1  ON 118
ci_0070                 4.692638e-03 3 1  ON 119
ci_0071                 2.860995e-04 3 1  ON 120
ci_0072                 3.724764e-04 3 1  ON 121
ci_0073                 4.410606e-03 3 1  ON 122
ci_0074                 3.878682e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.85
    reference variance = 0.269727
====================================================
  Execution time = 2.1028e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3553e-01
  Total weights = 1.9517e+06
  Execution time = 1.9215e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322379283784
                                         uncertainty =       0.002008116114

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322379283784
                                         uncertainty =       0.002008116114

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401474835
  error estimate for blocks of size 2^( 2) =       0.000414800638
  error estimate for blocks of size 2^( 3) =       0.000428516388
  error estimate for blocks of size 2^( 4) =       0.000441768820
  error estimate for blocks of size 2^( 5) =       0.000455331510
  error estimate for blocks of size 2^( 6) =       0.000467210325
  error estimate for blocks of size 2^( 7) =       0.000477082234

      target function =                  N/A
              le_mean =     -16.906382461152
             les_mean =     286.215242838657
             stat err =       0.000460348222
             autocorr =       1.314789675308
              std dev =       0.567771156001
             le_variance =       0.322364085586

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322771682975
                                         uncertainty =       0.002030356190

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322771682975
                                         uncertainty =       0.002030356190

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401720165
  error estimate for blocks of size 2^( 2) =       0.000415044091
  error estimate for blocks of size 2^( 3) =       0.000428724840
  error estimate for blocks of size 2^( 4) =       0.000441962950
  error estimate for blocks of size 2^( 5) =       0.000455562082
  error estimate for blocks of size 2^( 6) =       0.000467445189
  error estimate for blocks of size 2^( 7) =       0.000477383339

      target function =                  N/A
              le_mean =     -16.906386801387
             les_mean =     286.163555368136
             stat err =       0.000460588390
             autocorr =       1.314554839436
              std dev =       0.568118105646
             le_variance =       0.322758181962

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322881417486
                                         uncertainty =       0.002024547908

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322881417486
                                         uncertainty =       0.002024547908

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401788487
  error estimate for blocks of size 2^( 2) =       0.000415107865
  error estimate for blocks of size 2^( 3) =       0.000428782563
  error estimate for blocks of size 2^( 4) =       0.000442022940
  error estimate for blocks of size 2^( 5) =       0.000455629258
  error estimate for blocks of size 2^( 6) =       0.000467511685
  error estimate for blocks of size 2^( 7) =       0.000477455659

      target function =                  N/A
              le_mean =     -16.906389132966
             les_mean =     286.163731473437
             stat err =       0.000460654886
             autocorr =       1.314487277854
              std dev =       0.568214727233
             le_variance =       0.322867976244

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322394452839
                                         uncertainty =       0.002009105197

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322394452839
                                         uncertainty =       0.002009105197

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401484494
  error estimate for blocks of size 2^( 2) =       0.000414810241
  error estimate for blocks of size 2^( 3) =       0.000428519179
  error estimate for blocks of size 2^( 4) =       0.000441780239
  error estimate for blocks of size 2^( 5) =       0.000455368040
  error estimate for blocks of size 2^( 6) =       0.000467234626
  error estimate for blocks of size 2^( 7) =       0.000477137060

      target function =                  N/A
              le_mean =     -16.906373800544
             les_mean =     286.161702581366
             stat err =       0.000460379991
             autocorr =       1.314907877903
              std dev =       0.567784816326
             le_variance =       0.322379597650


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906382461152        initial
     9.5367e-02     9.5367e-01             2.5347e-03       -16.906386801387
     3.8147e-01     3.8147e+00             6.7648e-04       -16.906389132966  <--
     1.5259e+00     1.5259e+01             2.2206e-04       -16.906373800544

*****************************************************************************
Applying the update for shift_i =   3.8147e-01     and shift_s =   3.8147e+00
*****************************************************************************

  Execution time = 3.0720e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
   uu_0                 3.138643e-01 1 1  ON 0
   uu_1                 1.463431e-01 1 1  ON 1
   uu_2                 4.432489e-02 1 1  ON 2
   uu_3                -1.884317e-02 1 1  ON 3
   uu_4                -6.528575e-02 1 1  ON 4
   uu_5                -1.010446e-01 1 1  ON 5
   uu_6                -1.298315e-01 1 1  ON 6
   uu_7                -1.440174e-01 1 1  ON 7
   uu_8                -1.383509e-01 1 1  ON 8
   uu_9                -1.082605e-01 1 1  ON 9
   ud_0                 4.493965e-01 1 1  ON 10
   ud_1                 1.835452e-01 1 1  ON 11
   ud_2                 6.297513e-02 1 1  ON 12
   ud_3                -8.139690e-03 1 1  ON 13
   ud_4                -6.539087e-02 1 1  ON 14
   ud_5                -1.070510e-01 1 1  ON 15
   ud_6                -1.350774e-01 1 1  ON 16
   ud_7                -1.523543e-01 1 1  ON 17
   ud_8                -1.544880e-01 1 1  ON 18
   ud_9                -1.434732e-01 1 1  ON 19
   eO_0                -7.511279e-01 1 1  ON 20
   eO_1                -4.304995e-01 1 1  ON 21
   eO_2                -1.934881e-02 1 1  ON 22
   eO_3                 2.936796e-01 1 1  ON 23
   eO_4                 5.188417e-01 1 1  ON 24
   eO_5                 4.819652e-01 1 1  ON 25
   eO_6                 2.557790e-01 1 1  ON 26
   eO_7                -4.367317e-02 1 1  ON 27
   eO_8                -2.219029e-01 1 1  ON 28
   eO_9                -8.313046e-02 1 1  ON 29
  eH1_0                -2.572356e-01 1 1  ON 30
  eH1_1                -1.495765e-01 1 1  ON 31
  eH1_2                -9.988044e-02 1 1  ON 32
  eH1_3                -4.428462e-02 1 1  ON 33
  eH1_4                 5.977081e-03 1 1  ON 34
  eH1_5                 4.156139e-02 1 1  ON 35
  eH1_6                 1.008636e-01 1 1  ON 36
  eH1_7                 1.567211e-01 1 1  ON 37
  eH1_8                 1.799621e-01 1 1  ON 38
  eH1_9                 6.831892e-02 1 1  ON 39
  eH2_0                -2.545383e-01 1 1  ON 40
  eH2_1                -1.471864e-01 1 1  ON 41
  eH2_2                -9.725854e-02 1 1  ON 42
  eH2_3                -4.176362e-02 1 1  ON 43
  eH2_4                 8.304037e-03 1 1  ON 44
  eH2_5                 4.413932e-02 1 1  ON 45
  eH2_6                 1.037752e-01 1 1  ON 46
  eH2_7                 1.581382e-01 1 1  ON 47
  eH2_8                 1.843636e-01 1 1  ON 48
  eH2_9                 5.730736e-02 1 1  ON 49
ci_0001                 7.013284e-01 3 1  ON 50
ci_0002                 7.005529e-01 3 1  ON 51
ci_0003                -2.767904e-02 3 1  ON 52
ci_0004                -2.755061e-02 3 1  ON 53
ci_0005                -3.574216e-02 3 1  ON 54
ci_0006                -3.685418e-02 3 1  ON 55
ci_0007                -2.078319e-02 3 1  ON 56
ci_0008                -2.123222e-02 3 1  ON 57
ci_0009                -1.703394e-02 3 1  ON 58
ci_0010                -1.722875e-02 3 1  ON 59
ci_0011                -1.201084e-02 3 1  ON 60
ci_0012                -1.195796e-02 3 1  ON 61
ci_0013                 1.329323e-02 3 1  ON 62
ci_0014                 1.284863e-02 3 1  ON 63
ci_0015                 1.357380e-02 3 1  ON 64
ci_0016                 1.329339e-02 3 1  ON 65
ci_0017                 1.173204e-02 3 1  ON 66
ci_0018                 1.115507e-02 3 1  ON 67
ci_0019                 1.206358e-02 3 1  ON 68
ci_0020                 1.120245e-02 3 1  ON 69
ci_0021                -1.555250e-03 3 1  ON 70
ci_0022                -1.003694e-03 3 1  ON 71
ci_0023                -1.120467e-02 3 1  ON 72
ci_0024                -1.123630e-02 3 1  ON 73
ci_0025                -1.101826e-02 3 1  ON 74
ci_0026                -1.049972e-02 3 1  ON 75
ci_0027                -1.140237e-02 3 1  ON 76
ci_0028                -1.122232e-02 3 1  ON 77
ci_0029                -1.077545e-02 3 1  ON 78
ci_0030                -1.082055e-02 3 1  ON 79
ci_0031                 2.059522e-02 3 1  ON 80
ci_0032                 2.068766e-02 3 1  ON 81
ci_0033                 9.246003e-03 3 1  ON 82
ci_0034                 1.048556e-02 3 1  ON 83
ci_0035                 7.154038e-03 3 1  ON 84
ci_0036                 6.181341e-03 3 1  ON 85
ci_0037                -1.123566e-02 3 1  ON 86
ci_0038                -1.094374e-02 3 1  ON 87
ci_0039                -2.818631e-03 3 1  ON 88
ci_0040                -2.548441e-03 3 1  ON 89
ci_0041                 7.329767e-03 3 1  ON 90
ci_0042                 7.261091e-03 3 1  ON 91
ci_0043                -1.878889e-02 3 1  ON 92
ci_0044                -1.886937e-02 3 1  ON 93
ci_0045                 7.915075e-03 3 1  ON 94
ci_0046                 7.127753e-03 3 1  ON 95
ci_0047                -1.475558e-03 3 1  ON 96
ci_0048                -1.875182e-03 3 1  ON 97
ci_0049                -4.684169e-03 3 1  ON 98
ci_0050                -5.534666e-03 3 1  ON 99
ci_0051                -3.727013e-03 3 1  ON 100
ci_0052                -3.577959e-03 3 1  ON 101
ci_0053                -4.403786e-03 3 1  ON 102
ci_0054                -4.845163e-03 3 1  ON 103
ci_0055                 6.477284e-03 3 1  ON 104
ci_0056                 6.279184e-03 3 1  ON 105
ci_0057                 5.323295e-03 3 1  ON 106
ci_0058                 5.024134e-03 3 1  ON 107
ci_0059                -4.895885e-03 3 1  ON 108
ci_0060                -4.949063e-03 3 1  ON 109
ci_0061                -3.104573e-03 3 1  ON 110
ci_0062                -3.196272e-03 3 1  ON 111
ci_0063                -8.533078e-03 3 1  ON 112
ci_0064                -8.863823e-03 3 1  ON 113
ci_0065                -5.412748e-03 3 1  ON 114
ci_0066                -5.039135e-03 3 1  ON 115
ci_0067                -4.421566e-03 3 1  ON 116
ci_0068                -4.689917e-03 3 1  ON 117
ci_0069                 4.602672e-03 3 1  ON 118
ci_0070                 4.692638e-03 3 1  ON 119
ci_0071                 2.860995e-04 3 1  ON 120
ci_0072                 3.724764e-04 3 1  ON 121
ci_0073                 4.410606e-03 3 1  ON 122
ci_0074                 3.878682e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8411e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.9711
    reference variance = 0.478283
====================================================
  Execution time = 2.1266e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5257e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3409e-01
  Total weights = 1.951711513e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0906e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323181101877
                                         uncertainty =       0.002128181160

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323181101877
                                         uncertainty =       0.002128181160

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401930650
  error estimate for blocks of size 2^( 2) =       0.000414399200
  error estimate for blocks of size 2^( 3) =       0.000427553378
  error estimate for blocks of size 2^( 4) =       0.000439966664
  error estimate for blocks of size 2^( 5) =       0.000450328146
  error estimate for blocks of size 2^( 6) =       0.000458464100
  error estimate for blocks of size 2^( 7) =       0.000464134222

      target function =                  N/A
              le_mean =     -16.906211049659
             les_mean =     286.154067019437
             stat err =       0.000453223283
             autocorr =       1.271517007732
              std dev =       0.568415776615
             le_variance =       0.323096495105


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690621104966e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-02, overlap shift 9.5367e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906211049655       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906225971161       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906228249408       residual = 8.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906231701953       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906233428719       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906232025655       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906233583403       residual = 8.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906235066228       residual = 6.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906234921729       residual = 3.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906234902121       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906234993608       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906235307577       residual = 4.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906235217531       residual = 3.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906235334405       residual = 2.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906235301588       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.906235429131       residual = 3.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.5367e-02 is 2.486176e-03

solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906211049655       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906219073518       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906219807632       residual = 3.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906221033361       residual = 8.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906221084448       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906221916709       residual = 5.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906221989423       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906222185217       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906221947620       residual = 4.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906221955094       residual = 1.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906222035841       residual = 7.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e-01 is 7.132843e-04

solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906211049655       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906213865983       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906214081055       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906214333585       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906214335205       residual = 9.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906214699165       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906214700326       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906214684441       residual = 6.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906214687666       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906214689598       residual = 5.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e+00 is 2.355212e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.123134 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7366e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
   uu_0                 3.136007e-01 1 1  ON 0
   uu_1                 1.461882e-01 1 1  ON 1
   uu_2                 4.417272e-02 1 1  ON 2
   uu_3                -1.892426e-02 1 1  ON 3
   uu_4                -6.544779e-02 1 1  ON 4
   uu_5                -1.009731e-01 1 1  ON 5
   uu_6                -1.297968e-01 1 1  ON 6
   uu_7                -1.441445e-01 1 1  ON 7
   uu_8                -1.381125e-01 1 1  ON 8
   uu_9                -1.081911e-01 1 1  ON 9
   ud_0                 4.491825e-01 1 1  ON 10
   ud_1                 1.835322e-01 1 1  ON 11
   ud_2                 6.301213e-02 1 1  ON 12
   ud_3                -8.207397e-03 1 1  ON 13
   ud_4                -6.539397e-02 1 1  ON 14
   ud_5                -1.071254e-01 1 1  ON 15
   ud_6                -1.353128e-01 1 1  ON 16
   ud_7                -1.524113e-01 1 1  ON 17
   ud_8                -1.542090e-01 1 1  ON 18
   ud_9                -1.432696e-01 1 1  ON 19
   eO_0                -7.512460e-01 1 1  ON 20
   eO_1                -4.304713e-01 1 1  ON 21
   eO_2                -1.949875e-02 1 1  ON 22
   eO_3                 2.936341e-01 1 1  ON 23
   eO_4                 5.190503e-01 1 1  ON 24
   eO_5                 4.822037e-01 1 1  ON 25
   eO_6                 2.560590e-01 1 1  ON 26
   eO_7                -4.356147e-02 1 1  ON 27
   eO_8                -2.221423e-01 1 1  ON 28
   eO_9                -8.340392e-02 1 1  ON 29
  eH1_0                -2.572401e-01 1 1  ON 30
  eH1_1                -1.499082e-01 1 1  ON 31
  eH1_2                -9.992445e-02 1 1  ON 32
  eH1_3                -4.436322e-02 1 1  ON 33
  eH1_4                 5.627446e-03 1 1  ON 34
  eH1_5                 4.162114e-02 1 1  ON 35
  eH1_6                 1.006138e-01 1 1  ON 36
  eH1_7                 1.567512e-01 1 1  ON 37
  eH1_8                 1.803379e-01 1 1  ON 38
  eH1_9                 6.880667e-02 1 1  ON 39
  eH2_0                -2.547691e-01 1 1  ON 40
  eH2_1                -1.473164e-01 1 1  ON 41
  eH2_2                -9.747373e-02 1 1  ON 42
  eH2_3                -4.190879e-02 1 1  ON 43
  eH2_4                 8.097968e-03 1 1  ON 44
  eH2_5                 4.363481e-02 1 1  ON 45
  eH2_6                 1.037917e-01 1 1  ON 46
  eH2_7                 1.583891e-01 1 1  ON 47
  eH2_8                 1.847650e-01 1 1  ON 48
  eH2_9                 5.791243e-02 1 1  ON 49
ci_0001                 7.015799e-01 3 1  ON 50
ci_0002                 7.003142e-01 3 1  ON 51
ci_0003                -2.775636e-02 3 1  ON 52
ci_0004                -2.761856e-02 3 1  ON 53
ci_0005                -3.587172e-02 3 1  ON 54
ci_0006                -3.691710e-02 3 1  ON 55
ci_0007                -2.084509e-02 3 1  ON 56
ci_0008                -2.151084e-02 3 1  ON 57
ci_0009                -1.721276e-02 3 1  ON 58
ci_0010                -1.716151e-02 3 1  ON 59
ci_0011                -1.186703e-02 3 1  ON 60
ci_0012                -1.193946e-02 3 1  ON 61
ci_0013                 1.368126e-02 3 1  ON 62
ci_0014                 1.282871e-02 3 1  ON 63
ci_0015                 1.341868e-02 3 1  ON 64
ci_0016                 1.310535e-02 3 1  ON 65
ci_0017                 1.123463e-02 3 1  ON 66
ci_0018                 1.113562e-02 3 1  ON 67
ci_0019                 1.184307e-02 3 1  ON 68
ci_0020                 1.142885e-02 3 1  ON 69
ci_0021                -1.865469e-03 3 1  ON 70
ci_0022                -7.617253e-04 3 1  ON 71
ci_0023                -1.129119e-02 3 1  ON 72
ci_0024                -1.106723e-02 3 1  ON 73
ci_0025                -1.080449e-02 3 1  ON 74
ci_0026                -1.047723e-02 3 1  ON 75
ci_0027                -1.113115e-02 3 1  ON 76
ci_0028                -1.098372e-02 3 1  ON 77
ci_0029                -1.063605e-02 3 1  ON 78
ci_0030                -1.080945e-02 3 1  ON 79
ci_0031                 2.065397e-02 3 1  ON 80
ci_0032                 2.065335e-02 3 1  ON 81
ci_0033                 9.359547e-03 3 1  ON 82
ci_0034                 1.007873e-02 3 1  ON 83
ci_0035                 6.916114e-03 3 1  ON 84
ci_0036                 6.320656e-03 3 1  ON 85
ci_0037                -1.097037e-02 3 1  ON 86
ci_0038                -1.098925e-02 3 1  ON 87
ci_0039                -2.235006e-03 3 1  ON 88
ci_0040                -2.692774e-03 3 1  ON 89
ci_0041                 7.173496e-03 3 1  ON 90
ci_0042                 7.147895e-03 3 1  ON 91
ci_0043                -1.883842e-02 3 1  ON 92
ci_0044                -1.874502e-02 3 1  ON 93
ci_0045                 7.785088e-03 3 1  ON 94
ci_0046                 7.395083e-03 3 1  ON 95
ci_0047                -1.669700e-03 3 1  ON 96
ci_0048                -1.997639e-03 3 1  ON 97
ci_0049                -4.830912e-03 3 1  ON 98
ci_0050                -5.463355e-03 3 1  ON 99
ci_0051                -3.615124e-03 3 1  ON 100
ci_0052                -3.577362e-03 3 1  ON 101
ci_0053                -4.474676e-03 3 1  ON 102
ci_0054                -4.732601e-03 3 1  ON 103
ci_0055                 6.262073e-03 3 1  ON 104
ci_0056                 6.402121e-03 3 1  ON 105
ci_0057                 4.610011e-03 3 1  ON 106
ci_0058                 5.068962e-03 3 1  ON 107
ci_0059                -4.707006e-03 3 1  ON 108
ci_0060                -4.755488e-03 3 1  ON 109
ci_0061                -3.033656e-03 3 1  ON 110
ci_0062                -3.312849e-03 3 1  ON 111
ci_0063                -8.624149e-03 3 1  ON 112
ci_0064                -9.249704e-03 3 1  ON 113
ci_0065                -5.269093e-03 3 1  ON 114
ci_0066                -4.925645e-03 3 1  ON 115
ci_0067                -4.859148e-03 3 1  ON 116
ci_0068                -4.604238e-03 3 1  ON 117
ci_0069                 4.643063e-03 3 1  ON 118
ci_0070                 4.910006e-03 3 1  ON 119
ci_0071                 3.895940e-04 3 1  ON 120
ci_0072                 2.884834e-04 3 1  ON 121
ci_0073                 4.169732e-03 3 1  ON 122
ci_0074                 3.970711e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.8993
    reference variance = 0.331514
====================================================
  Execution time = 2.1096e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3692e-01
  Total weights = 1.9522e+06
  Execution time = 1.9137e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0925722
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324438861502
                                         uncertainty =       0.002932841043

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324438861502
                                         uncertainty =       0.002932841043

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402730018
  error estimate for blocks of size 2^( 2) =       0.000415824947
  error estimate for blocks of size 2^( 3) =       0.000429173127
  error estimate for blocks of size 2^( 4) =       0.000442046817
  error estimate for blocks of size 2^( 5) =       0.000454288249
  error estimate for blocks of size 2^( 6) =       0.000463803017
  error estimate for blocks of size 2^( 7) =       0.000468251002

      target function =                  N/A
              le_mean =     -16.905565288523
             les_mean =     286.135924186664
             stat err =       0.000457097271
             autocorr =       1.288217674696
              std dev =       0.569546254068
             le_variance =       0.324382935523

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.122117
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323950329049
                                         uncertainty =       0.002915541292

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323950329049
                                         uncertainty =       0.002915541292

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402426355
  error estimate for blocks of size 2^( 2) =       0.000415547270
  error estimate for blocks of size 2^( 3) =       0.000428930255
  error estimate for blocks of size 2^( 4) =       0.000441829850
  error estimate for blocks of size 2^( 5) =       0.000454068634
  error estimate for blocks of size 2^( 6) =       0.000463549398
  error estimate for blocks of size 2^( 7) =       0.000467965759

      target function =                  N/A
              le_mean =     -16.905561385273
             les_mean =     286.138866168506
             stat err =       0.000456853410
             autocorr =       1.288786300825
              std dev =       0.569116809696
             le_variance =       0.323893943079

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0900778
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323828410876
                                         uncertainty =       0.002911429775

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323828410876
                                         uncertainty =       0.002911429775

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402350639
  error estimate for blocks of size 2^( 2) =       0.000415474924
  error estimate for blocks of size 2^( 3) =       0.000428859090
  error estimate for blocks of size 2^( 4) =       0.000441760360
  error estimate for blocks of size 2^( 5) =       0.000454007533
  error estimate for blocks of size 2^( 6) =       0.000463499253
  error estimate for blocks of size 2^( 7) =       0.000467924310

      target function =                  N/A
              le_mean =     -16.905567488007
             les_mean =     286.206292736510
             stat err =       0.000456797864
             autocorr =       1.288957917900
              std dev =       0.569009730275
             le_variance =       0.323772073147

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324271364346
                                         uncertainty =       0.002928595283

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324271364346
                                         uncertainty =       0.002928595283

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402626013
  error estimate for blocks of size 2^( 2) =       0.000415726572
  error estimate for blocks of size 2^( 3) =       0.000429081615
  error estimate for blocks of size 2^( 4) =       0.000441960903
  error estimate for blocks of size 2^( 5) =       0.000454205073
  error estimate for blocks of size 2^( 6) =       0.000463716385
  error estimate for blocks of size 2^( 7) =       0.000468160679

      target function =                  N/A
              le_mean =     -16.905561072353
             les_mean =     286.135205647546
             stat err =       0.000457010760
             autocorr =       1.288395472599
              std dev =       0.569399167732
             le_variance =       0.324215412214


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905565288523        initial
     9.5367e-02     9.5367e-01             2.4862e-03       -16.905561385273
     3.8147e-01     3.8147e+00             7.1328e-04       -16.905567488007  <--
     1.5259e+00     1.5259e+01             2.3552e-04       -16.905561072353

*****************************************************************************
Applying the update for shift_i =   3.8147e-01     and shift_s =   3.8147e+00
*****************************************************************************

  Execution time = 3.0750e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
   uu_0                 3.136007e-01 1 1  ON 0
   uu_1                 1.461882e-01 1 1  ON 1
   uu_2                 4.417272e-02 1 1  ON 2
   uu_3                -1.892426e-02 1 1  ON 3
   uu_4                -6.544779e-02 1 1  ON 4
   uu_5                -1.009731e-01 1 1  ON 5
   uu_6                -1.297968e-01 1 1  ON 6
   uu_7                -1.441445e-01 1 1  ON 7
   uu_8                -1.381125e-01 1 1  ON 8
   uu_9                -1.081911e-01 1 1  ON 9
   ud_0                 4.491825e-01 1 1  ON 10
   ud_1                 1.835322e-01 1 1  ON 11
   ud_2                 6.301213e-02 1 1  ON 12
   ud_3                -8.207397e-03 1 1  ON 13
   ud_4                -6.539397e-02 1 1  ON 14
   ud_5                -1.071254e-01 1 1  ON 15
   ud_6                -1.353128e-01 1 1  ON 16
   ud_7                -1.524113e-01 1 1  ON 17
   ud_8                -1.542090e-01 1 1  ON 18
   ud_9                -1.432696e-01 1 1  ON 19
   eO_0                -7.512460e-01 1 1  ON 20
   eO_1                -4.304713e-01 1 1  ON 21
   eO_2                -1.949875e-02 1 1  ON 22
   eO_3                 2.936341e-01 1 1  ON 23
   eO_4                 5.190503e-01 1 1  ON 24
   eO_5                 4.822037e-01 1 1  ON 25
   eO_6                 2.560590e-01 1 1  ON 26
   eO_7                -4.356147e-02 1 1  ON 27
   eO_8                -2.221423e-01 1 1  ON 28
   eO_9                -8.340392e-02 1 1  ON 29
  eH1_0                -2.572401e-01 1 1  ON 30
  eH1_1                -1.499082e-01 1 1  ON 31
  eH1_2                -9.992445e-02 1 1  ON 32
  eH1_3                -4.436322e-02 1 1  ON 33
  eH1_4                 5.627446e-03 1 1  ON 34
  eH1_5                 4.162114e-02 1 1  ON 35
  eH1_6                 1.006138e-01 1 1  ON 36
  eH1_7                 1.567512e-01 1 1  ON 37
  eH1_8                 1.803379e-01 1 1  ON 38
  eH1_9                 6.880667e-02 1 1  ON 39
  eH2_0                -2.547691e-01 1 1  ON 40
  eH2_1                -1.473164e-01 1 1  ON 41
  eH2_2                -9.747373e-02 1 1  ON 42
  eH2_3                -4.190879e-02 1 1  ON 43
  eH2_4                 8.097968e-03 1 1  ON 44
  eH2_5                 4.363481e-02 1 1  ON 45
  eH2_6                 1.037917e-01 1 1  ON 46
  eH2_7                 1.583891e-01 1 1  ON 47
  eH2_8                 1.847650e-01 1 1  ON 48
  eH2_9                 5.791243e-02 1 1  ON 49
ci_0001                 7.015799e-01 3 1  ON 50
ci_0002                 7.003142e-01 3 1  ON 51
ci_0003                -2.775636e-02 3 1  ON 52
ci_0004                -2.761856e-02 3 1  ON 53
ci_0005                -3.587172e-02 3 1  ON 54
ci_0006                -3.691710e-02 3 1  ON 55
ci_0007                -2.084509e-02 3 1  ON 56
ci_0008                -2.151084e-02 3 1  ON 57
ci_0009                -1.721276e-02 3 1  ON 58
ci_0010                -1.716151e-02 3 1  ON 59
ci_0011                -1.186703e-02 3 1  ON 60
ci_0012                -1.193946e-02 3 1  ON 61
ci_0013                 1.368126e-02 3 1  ON 62
ci_0014                 1.282871e-02 3 1  ON 63
ci_0015                 1.341868e-02 3 1  ON 64
ci_0016                 1.310535e-02 3 1  ON 65
ci_0017                 1.123463e-02 3 1  ON 66
ci_0018                 1.113562e-02 3 1  ON 67
ci_0019                 1.184307e-02 3 1  ON 68
ci_0020                 1.142885e-02 3 1  ON 69
ci_0021                -1.865469e-03 3 1  ON 70
ci_0022                -7.617253e-04 3 1  ON 71
ci_0023                -1.129119e-02 3 1  ON 72
ci_0024                -1.106723e-02 3 1  ON 73
ci_0025                -1.080449e-02 3 1  ON 74
ci_0026                -1.047723e-02 3 1  ON 75
ci_0027                -1.113115e-02 3 1  ON 76
ci_0028                -1.098372e-02 3 1  ON 77
ci_0029                -1.063605e-02 3 1  ON 78
ci_0030                -1.080945e-02 3 1  ON 79
ci_0031                 2.065397e-02 3 1  ON 80
ci_0032                 2.065335e-02 3 1  ON 81
ci_0033                 9.359547e-03 3 1  ON 82
ci_0034                 1.007873e-02 3 1  ON 83
ci_0035                 6.916114e-03 3 1  ON 84
ci_0036                 6.320656e-03 3 1  ON 85
ci_0037                -1.097037e-02 3 1  ON 86
ci_0038                -1.098925e-02 3 1  ON 87
ci_0039                -2.235006e-03 3 1  ON 88
ci_0040                -2.692774e-03 3 1  ON 89
ci_0041                 7.173496e-03 3 1  ON 90
ci_0042                 7.147895e-03 3 1  ON 91
ci_0043                -1.883842e-02 3 1  ON 92
ci_0044                -1.874502e-02 3 1  ON 93
ci_0045                 7.785088e-03 3 1  ON 94
ci_0046                 7.395083e-03 3 1  ON 95
ci_0047                -1.669700e-03 3 1  ON 96
ci_0048                -1.997639e-03 3 1  ON 97
ci_0049                -4.830912e-03 3 1  ON 98
ci_0050                -5.463355e-03 3 1  ON 99
ci_0051                -3.615124e-03 3 1  ON 100
ci_0052                -3.577362e-03 3 1  ON 101
ci_0053                -4.474676e-03 3 1  ON 102
ci_0054                -4.732601e-03 3 1  ON 103
ci_0055                 6.262073e-03 3 1  ON 104
ci_0056                 6.402121e-03 3 1  ON 105
ci_0057                 4.610011e-03 3 1  ON 106
ci_0058                 5.068962e-03 3 1  ON 107
ci_0059                -4.707006e-03 3 1  ON 108
ci_0060                -4.755488e-03 3 1  ON 109
ci_0061                -3.033656e-03 3 1  ON 110
ci_0062                -3.312849e-03 3 1  ON 111
ci_0063                -8.624149e-03 3 1  ON 112
ci_0064                -9.249704e-03 3 1  ON 113
ci_0065                -5.269093e-03 3 1  ON 114
ci_0066                -4.925645e-03 3 1  ON 115
ci_0067                -4.859148e-03 3 1  ON 116
ci_0068                -4.604238e-03 3 1  ON 117
ci_0069                 4.643063e-03 3 1  ON 118
ci_0070                 4.910006e-03 3 1  ON 119
ci_0071                 3.895940e-04 3 1  ON 120
ci_0072                 2.884834e-04 3 1  ON 121
ci_0073                 4.169732e-03 3 1  ON 122
ci_0074                 3.970711e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8131e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.8727
    reference variance = 0.186468
====================================================
  Execution time = 2.1468e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5256e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3701e-01
  Total weights = 1.952025789e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0819e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323682730066
                                         uncertainty =       0.003513857782

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323682730066
                                         uncertainty =       0.003513857782

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402251675
  error estimate for blocks of size 2^( 2) =       0.000415173133
  error estimate for blocks of size 2^( 3) =       0.000428388094
  error estimate for blocks of size 2^( 4) =       0.000441168923
  error estimate for blocks of size 2^( 5) =       0.000452094723
  error estimate for blocks of size 2^( 6) =       0.000460272559
  error estimate for blocks of size 2^( 7) =       0.000465622963

      target function =                  N/A
              le_mean =     -16.905368763679
             les_mean =     286.128503186730
             stat err =       0.000454789792
             autocorr =       1.278279117744
              std dev =       0.568869774002
             le_variance =       0.323612819773


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690536876368e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-02, overlap shift 9.5367e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905368763651       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905361399197       residual = 2.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905363525050       residual = 9.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905365366154       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905363053628       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905363680468       residual = 9.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905364929309       residual = 9.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905364979582       residual = 4.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905366125589       residual = 2.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905366637230       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905366476463       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905366563507       residual = 8.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905366225405       residual = 3.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905366143484       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.905366215134       residual = 7.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         14 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.5367e-02 is 2.550064e-03

solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905368763651       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905364848531       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905365551263       residual = 3.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905366707818       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905365834757       residual = 9.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905365222729       residual = 5.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905365648591       residual = 2.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905365692603       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905365726572       residual = 5.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905365956958       residual = 2.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905365961192       residual = 9.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e-01 is 6.431232e-04

solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905368763651       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905367401160       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905367574451       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905367922834       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905367724178       residual = 7.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905367348333       residual = 3.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905367401151       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905367470847       residual = 3.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905367440134       residual = 2.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905367470982       residual = 4.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e+00 is 2.101217e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.134315 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7568e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
   uu_0                 3.136469e-01 1 1  ON 0
   uu_1                 1.459976e-01 1 1  ON 1
   uu_2                 4.404785e-02 1 1  ON 2
   uu_3                -1.906188e-02 1 1  ON 3
   uu_4                -6.543295e-02 1 1  ON 4
   uu_5                -1.009373e-01 1 1  ON 5
   uu_6                -1.297587e-01 1 1  ON 6
   uu_7                -1.443157e-01 1 1  ON 7
   uu_8                -1.381801e-01 1 1  ON 8
   uu_9                -1.081099e-01 1 1  ON 9
   ud_0                 4.493130e-01 1 1  ON 10
   ud_1                 1.834490e-01 1 1  ON 11
   ud_2                 6.302179e-02 1 1  ON 12
   ud_3                -8.193797e-03 1 1  ON 13
   ud_4                -6.534822e-02 1 1  ON 14
   ud_5                -1.072943e-01 1 1  ON 15
   ud_6                -1.352738e-01 1 1  ON 16
   ud_7                -1.524955e-01 1 1  ON 17
   ud_8                -1.540322e-01 1 1  ON 18
   ud_9                -1.433024e-01 1 1  ON 19
   eO_0                -7.511994e-01 1 1  ON 20
   eO_1                -4.307225e-01 1 1  ON 21
   eO_2                -1.948762e-02 1 1  ON 22
   eO_3                 2.937804e-01 1 1  ON 23
   eO_4                 5.191939e-01 1 1  ON 24
   eO_5                 4.823823e-01 1 1  ON 25
   eO_6                 2.562193e-01 1 1  ON 26
   eO_7                -4.355304e-02 1 1  ON 27
   eO_8                -2.222614e-01 1 1  ON 28
   eO_9                -8.368618e-02 1 1  ON 29
  eH1_0                -2.574837e-01 1 1  ON 30
  eH1_1                -1.499242e-01 1 1  ON 31
  eH1_2                -1.000015e-01 1 1  ON 32
  eH1_3                -4.449646e-02 1 1  ON 33
  eH1_4                 5.454735e-03 1 1  ON 34
  eH1_5                 4.150408e-02 1 1  ON 35
  eH1_6                 1.006655e-01 1 1  ON 36
  eH1_7                 1.568508e-01 1 1  ON 37
  eH1_8                 1.804984e-01 1 1  ON 38
  eH1_9                 6.915937e-02 1 1  ON 39
  eH2_0                -2.544975e-01 1 1  ON 40
  eH2_1                -1.476153e-01 1 1  ON 41
  eH2_2                -9.771082e-02 1 1  ON 42
  eH2_3                -4.201310e-02 1 1  ON 43
  eH2_4                 7.785973e-03 1 1  ON 44
  eH2_5                 4.315028e-02 1 1  ON 45
  eH2_6                 1.034831e-01 1 1  ON 46
  eH2_7                 1.586840e-01 1 1  ON 47
  eH2_8                 1.852438e-01 1 1  ON 48
  eH2_9                 5.853256e-02 1 1  ON 49
ci_0001                 7.015993e-01 3 1  ON 50
ci_0002                 7.003036e-01 3 1  ON 51
ci_0003                -2.760574e-02 3 1  ON 52
ci_0004                -2.737174e-02 3 1  ON 53
ci_0005                -3.566559e-02 3 1  ON 54
ci_0006                -3.669945e-02 3 1  ON 55
ci_0007                -2.148821e-02 3 1  ON 56
ci_0008                -2.162812e-02 3 1  ON 57
ci_0009                -1.743285e-02 3 1  ON 58
ci_0010                -1.728774e-02 3 1  ON 59
ci_0011                -1.249289e-02 3 1  ON 60
ci_0012                -1.204047e-02 3 1  ON 61
ci_0013                 1.337974e-02 3 1  ON 62
ci_0014                 1.290884e-02 3 1  ON 63
ci_0015                 1.364605e-02 3 1  ON 64
ci_0016                 1.312878e-02 3 1  ON 65
ci_0017                 1.123067e-02 3 1  ON 66
ci_0018                 1.128093e-02 3 1  ON 67
ci_0019                 1.191655e-02 3 1  ON 68
ci_0020                 1.144278e-02 3 1  ON 69
ci_0021                -1.627897e-03 3 1  ON 70
ci_0022                -6.555935e-04 3 1  ON 71
ci_0023                -1.134217e-02 3 1  ON 72
ci_0024                -1.144081e-02 3 1  ON 73
ci_0025                -1.072096e-02 3 1  ON 74
ci_0026                -1.106102e-02 3 1  ON 75
ci_0027                -1.106508e-02 3 1  ON 76
ci_0028                -1.090868e-02 3 1  ON 77
ci_0029                -1.076670e-02 3 1  ON 78
ci_0030                -1.086518e-02 3 1  ON 79
ci_0031                 2.034579e-02 3 1  ON 80
ci_0032                 2.068815e-02 3 1  ON 81
ci_0033                 9.319350e-03 3 1  ON 82
ci_0034                 9.969562e-03 3 1  ON 83
ci_0035                 6.595291e-03 3 1  ON 84
ci_0036                 6.256347e-03 3 1  ON 85
ci_0037                -1.089312e-02 3 1  ON 86
ci_0038                -1.057704e-02 3 1  ON 87
ci_0039                -2.605070e-03 3 1  ON 88
ci_0040                -2.470276e-03 3 1  ON 89
ci_0041                 7.097826e-03 3 1  ON 90
ci_0042                 7.046643e-03 3 1  ON 91
ci_0043                -1.826454e-02 3 1  ON 92
ci_0044                -1.874212e-02 3 1  ON 93
ci_0045                 7.878873e-03 3 1  ON 94
ci_0046                 7.460873e-03 3 1  ON 95
ci_0047                -1.702398e-03 3 1  ON 96
ci_0048                -1.926586e-03 3 1  ON 97
ci_0049                -4.966145e-03 3 1  ON 98
ci_0050                -5.913738e-03 3 1  ON 99
ci_0051                -4.159120e-03 3 1  ON 100
ci_0052                -3.551734e-03 3 1  ON 101
ci_0053                -4.276833e-03 3 1  ON 102
ci_0054                -4.641755e-03 3 1  ON 103
ci_0055                 6.096052e-03 3 1  ON 104
ci_0056                 6.673139e-03 3 1  ON 105
ci_0057                 4.423976e-03 3 1  ON 106
ci_0058                 5.038064e-03 3 1  ON 107
ci_0059                -4.437274e-03 3 1  ON 108
ci_0060                -4.677443e-03 3 1  ON 109
ci_0061                -3.322745e-03 3 1  ON 110
ci_0062                -3.161996e-03 3 1  ON 111
ci_0063                -8.774262e-03 3 1  ON 112
ci_0064                -9.103020e-03 3 1  ON 113
ci_0065                -5.442829e-03 3 1  ON 114
ci_0066                -5.173222e-03 3 1  ON 115
ci_0067                -4.728532e-03 3 1  ON 116
ci_0068                -4.665742e-03 3 1  ON 117
ci_0069                 4.796983e-03 3 1  ON 118
ci_0070                 4.647069e-03 3 1  ON 119
ci_0071                 8.194116e-05 3 1  ON 120
ci_0072                 3.609242e-04 3 1  ON 121
ci_0073                 4.321110e-03 3 1  ON 122
ci_0074                 3.755309e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.9143
    reference variance = 0.604597
====================================================
  Execution time = 2.0993e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3331e-01
  Total weights = 1.9514e+06
  Execution time = 1.9144e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319408197306
                                         uncertainty =       0.001691627528

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319408197306
                                         uncertainty =       0.001691627528

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399650641
  error estimate for blocks of size 2^( 2) =       0.000412784411
  error estimate for blocks of size 2^( 3) =       0.000426186489
  error estimate for blocks of size 2^( 4) =       0.000439079022
  error estimate for blocks of size 2^( 5) =       0.000449757888
  error estimate for blocks of size 2^( 6) =       0.000459038217
  error estimate for blocks of size 2^( 7) =       0.000465769789

      target function =                  N/A
              le_mean =     -16.905857766436
             les_mean =     286.249658145849
             stat err =       0.000453411229
             autocorr =       1.287133270564
              std dev =       0.565191356107
             le_variance =       0.319441269018

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319901732960
                                         uncertainty =       0.001666483208

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319901732960
                                         uncertainty =       0.001666483208

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399959371
  error estimate for blocks of size 2^( 2) =       0.000413088337
  error estimate for blocks of size 2^( 3) =       0.000426480290
  error estimate for blocks of size 2^( 4) =       0.000439345962
  error estimate for blocks of size 2^( 5) =       0.000450023549
  error estimate for blocks of size 2^( 6) =       0.000459301759
  error estimate for blocks of size 2^( 7) =       0.000466026244

      target function =                  N/A
              le_mean =     -16.905881029754
             les_mean =     286.145246012584
             stat err =       0.000453674379
             autocorr =       1.286639123300
              std dev =       0.565627966706
             le_variance =       0.319934996720

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320172947469
                                         uncertainty =       0.001653219092

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320172947469
                                         uncertainty =       0.001653219092

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400128696
  error estimate for blocks of size 2^( 2) =       0.000413250355
  error estimate for blocks of size 2^( 3) =       0.000426639395
  error estimate for blocks of size 2^( 4) =       0.000439488238
  error estimate for blocks of size 2^( 5) =       0.000450172671
  error estimate for blocks of size 2^( 6) =       0.000459472238
  error estimate for blocks of size 2^( 7) =       0.000466220226

      target function =                  N/A
              le_mean =     -16.905868802362
             les_mean =     286.729295771684
             stat err =       0.000453838343
             autocorr =       1.286479804294
              std dev =       0.565867428381
             le_variance =       0.320205946503

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319402192471
                                         uncertainty =       0.001675715031

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319402192471
                                         uncertainty =       0.001675715031

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399647089
  error estimate for blocks of size 2^( 2) =       0.000412781991
  error estimate for blocks of size 2^( 3) =       0.000426188305
  error estimate for blocks of size 2^( 4) =       0.000439075215
  error estimate for blocks of size 2^( 5) =       0.000449758400
  error estimate for blocks of size 2^( 6) =       0.000459064612
  error estimate for blocks of size 2^( 7) =       0.000465819210

      target function =                  N/A
              le_mean =     -16.905862902751
             les_mean =     286.142441981421
             stat err =       0.000453429359
             autocorr =       1.287259085149
              std dev =       0.565186333613
             le_variance =       0.319435591703


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905857766436        initial
     9.5367e-02     9.5367e-01             2.5501e-03       -16.905881029754  <--
     3.8147e-01     3.8147e+00             6.4312e-04       -16.905868802362
     1.5259e+00     1.5259e+01             2.1012e-04       -16.905862902751

*****************************************************************************
Applying the update for shift_i =   9.5367e-02     and shift_s =   9.5367e-01
*****************************************************************************

  Execution time = 3.0651e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
   uu_0                 3.134764e-01 1 1  ON 0
   uu_1                 1.457058e-01 1 1  ON 1
   uu_2                 4.381678e-02 1 1  ON 2
   uu_3                -1.931370e-02 1 1  ON 3
   uu_4                -6.553718e-02 1 1  ON 4
   uu_5                -1.009599e-01 1 1  ON 5
   uu_6                -1.298188e-01 1 1  ON 6
   uu_7                -1.446001e-01 1 1  ON 7
   uu_8                -1.384267e-01 1 1  ON 8
   uu_9                -1.079342e-01 1 1  ON 9
   ud_0                 4.494106e-01 1 1  ON 10
   ud_1                 1.834872e-01 1 1  ON 11
   ud_2                 6.308920e-02 1 1  ON 12
   ud_3                -8.144895e-03 1 1  ON 13
   ud_4                -6.531468e-02 1 1  ON 14
   ud_5                -1.074521e-01 1 1  ON 15
   ud_6                -1.352648e-01 1 1  ON 16
   ud_7                -1.526287e-01 1 1  ON 17
   ud_8                -1.537490e-01 1 1  ON 18
   ud_9                -1.434399e-01 1 1  ON 19
   eO_0                -7.514330e-01 1 1  ON 20
   eO_1                -4.310361e-01 1 1  ON 21
   eO_2                -1.944858e-02 1 1  ON 22
   eO_3                 2.941708e-01 1 1  ON 23
   eO_4                 5.197093e-01 1 1  ON 24
   eO_5                 4.829142e-01 1 1  ON 25
   eO_6                 2.566983e-01 1 1  ON 26
   eO_7                -4.353470e-02 1 1  ON 27
   eO_8                -2.226691e-01 1 1  ON 28
   eO_9                -8.457297e-02 1 1  ON 29
  eH1_0                -2.578583e-01 1 1  ON 30
  eH1_1                -1.502265e-01 1 1  ON 31
  eH1_2                -1.003438e-01 1 1  ON 32
  eH1_3                -4.493711e-02 1 1  ON 33
  eH1_4                 5.052339e-03 1 1  ON 34
  eH1_5                 4.108644e-02 1 1  ON 35
  eH1_6                 1.006963e-01 1 1  ON 36
  eH1_7                 1.571797e-01 1 1  ON 37
  eH1_8                 1.810252e-01 1 1  ON 38
  eH1_9                 7.025582e-02 1 1  ON 39
  eH2_0                -2.543757e-01 1 1  ON 40
  eH2_1                -1.482625e-01 1 1  ON 41
  eH2_2                -9.830865e-02 1 1  ON 42
  eH2_3                -4.257407e-02 1 1  ON 43
  eH2_4                 7.067533e-03 1 1  ON 44
  eH2_5                 4.205709e-02 1 1  ON 45
  eH2_6                 1.025959e-01 1 1  ON 46
  eH2_7                 1.594431e-01 1 1  ON 47
  eH2_8                 1.866837e-01 1 1  ON 48
  eH2_9                 6.046249e-02 1 1  ON 49
ci_0001                 7.016735e-01 3 1  ON 50
ci_0002                 7.002492e-01 3 1  ON 51
ci_0003                -2.743518e-02 3 1  ON 52
ci_0004                -2.712577e-02 3 1  ON 53
ci_0005                -3.539146e-02 3 1  ON 54
ci_0006                -3.640830e-02 3 1  ON 55
ci_0007                -2.253272e-02 3 1  ON 56
ci_0008                -2.187417e-02 3 1  ON 57
ci_0009                -1.762205e-02 3 1  ON 58
ci_0010                -1.738490e-02 3 1  ON 59
ci_0011                -1.310741e-02 3 1  ON 60
ci_0012                -1.212355e-02 3 1  ON 61
ci_0013                 1.307462e-02 3 1  ON 62
ci_0014                 1.297490e-02 3 1  ON 63
ci_0015                 1.385260e-02 3 1  ON 64
ci_0016                 1.314709e-02 3 1  ON 65
ci_0017                 1.120528e-02 3 1  ON 66
ci_0018                 1.138883e-02 3 1  ON 67
ci_0019                 1.199260e-02 3 1  ON 68
ci_0020                 1.144847e-02 3 1  ON 69
ci_0021                -1.271119e-03 3 1  ON 70
ci_0022                -5.328335e-04 3 1  ON 71
ci_0023                -1.138497e-02 3 1  ON 72
ci_0024                -1.175831e-02 3 1  ON 73
ci_0025                -1.065192e-02 3 1  ON 74
ci_0026                -1.160445e-02 3 1  ON 75
ci_0027                -1.100440e-02 3 1  ON 76
ci_0028                -1.083722e-02 3 1  ON 77
ci_0029                -1.088476e-02 3 1  ON 78
ci_0030                -1.091398e-02 3 1  ON 79
ci_0031                 1.994474e-02 3 1  ON 80
ci_0032                 2.076228e-02 3 1  ON 81
ci_0033                 9.267949e-03 3 1  ON 82
ci_0034                 9.815464e-03 3 1  ON 83
ci_0035                 6.274273e-03 3 1  ON 84
ci_0036                 6.178644e-03 3 1  ON 85
ci_0037                -1.081507e-02 3 1  ON 86
ci_0038                -1.011626e-02 3 1  ON 87
ci_0039                -2.840047e-03 3 1  ON 88
ci_0040                -2.327937e-03 3 1  ON 89
ci_0041                 7.029000e-03 3 1  ON 90
ci_0042                 6.961347e-03 3 1  ON 91
ci_0043                -1.733084e-02 3 1  ON 92
ci_0044                -1.870409e-02 3 1  ON 93
ci_0045                 7.980021e-03 3 1  ON 94
ci_0046                 7.529761e-03 3 1  ON 95
ci_0047                -1.725710e-03 3 1  ON 96
ci_0048                -1.883946e-03 3 1  ON 97
ci_0049                -5.096358e-03 3 1  ON 98
ci_0050                -6.320588e-03 3 1  ON 99
ci_0051                -4.520631e-03 3 1  ON 100
ci_0052                -3.530704e-03 3 1  ON 101
ci_0053                -4.130536e-03 3 1  ON 102
ci_0054                -4.579712e-03 3 1  ON 103
ci_0055                 5.898607e-03 3 1  ON 104
ci_0056                 6.975807e-03 3 1  ON 105
ci_0057                 4.241570e-03 3 1  ON 106
ci_0058                 5.024394e-03 3 1  ON 107
ci_0059                -4.242163e-03 3 1  ON 108
ci_0060                -4.620527e-03 3 1  ON 109
ci_0061                -3.619248e-03 3 1  ON 110
ci_0062                -3.014656e-03 3 1  ON 111
ci_0063                -8.905755e-03 3 1  ON 112
ci_0064                -8.999928e-03 3 1  ON 113
ci_0065                -5.594794e-03 3 1  ON 114
ci_0066                -5.387305e-03 3 1  ON 115
ci_0067                -4.633408e-03 3 1  ON 116
ci_0068                -4.717123e-03 3 1  ON 117
ci_0069                 4.904371e-03 3 1  ON 118
ci_0070                 4.460072e-03 3 1  ON 119
ci_0071                -2.101532e-04 3 1  ON 120
ci_0072                 4.371898e-04 3 1  ON 121
ci_0073                 4.429839e-03 3 1  ON 122
ci_0074                 3.603312e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8242e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.9177
    reference variance = 0.559247
====================================================
  Execution time = 2.1290e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5198e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4019e-01
  Total weights = 1.951654223e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0875e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327134158326
                                         uncertainty =       0.002965117862

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327134158326
                                         uncertainty =       0.002965117862

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404450213
  error estimate for blocks of size 2^( 2) =       0.000417451674
  error estimate for blocks of size 2^( 3) =       0.000430547256
  error estimate for blocks of size 2^( 4) =       0.000442703937
  error estimate for blocks of size 2^( 5) =       0.000453309390
  error estimate for blocks of size 2^( 6) =       0.000461609183
  error estimate for blocks of size 2^( 7) =       0.000466609396

      target function =                  N/A
              le_mean =     -16.906384501826
             les_mean =     286.166022055800
             stat err =       0.000456057977
             autocorr =       1.271481291712
              std dev =       0.571978977103
             le_variance =       0.327159950247


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690638450183e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e-02, overlap shift 2.3842e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906384501840       residual = 2.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906403115202       residual = 3.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906400482391       residual = 2.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906401255639       residual = 4.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906398417946       residual = 4.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906403472782       residual = 3.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906405736488       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906402799368       residual = 7.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906401419179       residual = 5.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906399554800       residual = 8.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906397454495       residual = 9.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906399088875       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906403233310       residual = 8.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906405752801       residual = 4.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906406339581       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.906408343209       residual = 2.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.906407641403       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.906408046986       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.906408240454       residual = 6.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.906407578913       residual = 2.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.906407682316       residual = 1.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.906407707722       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.906407886861       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.906407483342       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.906407174558       residual = 5.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.3842e-02 is 9.353326e-03

solving harmonic davidson linear method for identity shift 9.5367e-02, overlap shift 9.5367e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906384501840       residual = 2.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906398766053       residual = 3.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906397391202       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906397857860       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906396783372       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906399176548       residual = 9.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906400835527       residual = 6.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906400018108       residual = 4.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906399839466       residual = 3.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906399820900       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906399509232       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906399807912       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906399684211       residual = 3.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906400052451       residual = 2.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906400407357       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.906400558786       residual = 3.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.5367e-02 is 2.361569e-03

solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906384501840       residual = 2.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906391874927       residual = 2.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906391547368       residual = 5.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906392014881       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906391800216       residual = 8.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906392707927       residual = 5.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906393049432       residual = 1.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906392843818       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906392531171       residual = 6.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906392470953       residual = 2.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906392339442       residual = 7.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e-01 is 7.867019e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.155035 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7405e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
   uu_0                 3.133405e-01 1 1  ON 0
   uu_1                 1.457427e-01 1 1  ON 1
   uu_2                 4.382440e-02 1 1  ON 2
   uu_3                -1.915218e-02 1 1  ON 3
   uu_4                -6.565484e-02 1 1  ON 4
   uu_5                -1.015035e-01 1 1  ON 5
   uu_6                -1.301596e-01 1 1  ON 6
   uu_7                -1.451401e-01 1 1  ON 7
   uu_8                -1.375955e-01 1 1  ON 8
   uu_9                -1.080841e-01 1 1  ON 9
   ud_0                 4.493081e-01 1 1  ON 10
   ud_1                 1.837209e-01 1 1  ON 11
   ud_2                 6.304901e-02 1 1  ON 12
   ud_3                -8.025094e-03 1 1  ON 13
   ud_4                -6.498375e-02 1 1  ON 14
   ud_5                -1.069729e-01 1 1  ON 15
   ud_6                -1.350734e-01 1 1  ON 16
   ud_7                -1.523292e-01 1 1  ON 17
   ud_8                -1.539850e-01 1 1  ON 18
   ud_9                -1.438279e-01 1 1  ON 19
   eO_0                -7.514518e-01 1 1  ON 20
   eO_1                -4.306811e-01 1 1  ON 21
   eO_2                -1.932275e-02 1 1  ON 22
   eO_3                 2.938629e-01 1 1  ON 23
   eO_4                 5.202926e-01 1 1  ON 24
   eO_5                 4.841184e-01 1 1  ON 25
   eO_6                 2.572890e-01 1 1  ON 26
   eO_7                -4.314624e-02 1 1  ON 27
   eO_8                -2.237184e-01 1 1  ON 28
   eO_9                -8.611229e-02 1 1  ON 29
  eH1_0                -2.581355e-01 1 1  ON 30
  eH1_1                -1.501785e-01 1 1  ON 31
  eH1_2                -1.005131e-01 1 1  ON 32
  eH1_3                -4.528440e-02 1 1  ON 33
  eH1_4                 4.571608e-03 1 1  ON 34
  eH1_5                 3.956355e-02 1 1  ON 35
  eH1_6                 1.003615e-01 1 1  ON 36
  eH1_7                 1.577170e-01 1 1  ON 37
  eH1_8                 1.821838e-01 1 1  ON 38
  eH1_9                 7.185379e-02 1 1  ON 39
  eH2_0                -2.556306e-01 1 1  ON 40
  eH2_1                -1.489402e-01 1 1  ON 41
  eH2_2                -9.889777e-02 1 1  ON 42
  eH2_3                -4.352619e-02 1 1  ON 43
  eH2_4                 6.059735e-03 1 1  ON 44
  eH2_5                 4.199399e-02 1 1  ON 45
  eH2_6                 1.031507e-01 1 1  ON 46
  eH2_7                 1.596939e-01 1 1  ON 47
  eH2_8                 1.876609e-01 1 1  ON 48
  eH2_9                 6.282406e-02 1 1  ON 49
ci_0001                 7.006896e-01 3 1  ON 50
ci_0002                 7.013000e-01 3 1  ON 51
ci_0003                -2.715741e-02 3 1  ON 52
ci_0004                -2.716229e-02 3 1  ON 53
ci_0005                -3.646113e-02 3 1  ON 54
ci_0006                -3.563723e-02 3 1  ON 55
ci_0007                -2.264292e-02 3 1  ON 56
ci_0008                -2.125173e-02 3 1  ON 57
ci_0009                -1.749859e-02 3 1  ON 58
ci_0010                -1.701023e-02 3 1  ON 59
ci_0011                -1.204703e-02 3 1  ON 60
ci_0012                -1.150083e-02 3 1  ON 61
ci_0013                 1.341394e-02 3 1  ON 62
ci_0014                 1.277559e-02 3 1  ON 63
ci_0015                 1.254865e-02 3 1  ON 64
ci_0016                 1.261560e-02 3 1  ON 65
ci_0017                 1.085906e-02 3 1  ON 66
ci_0018                 1.144552e-02 3 1  ON 67
ci_0019                 1.169406e-02 3 1  ON 68
ci_0020                 1.115810e-02 3 1  ON 69
ci_0021                -1.168673e-03 3 1  ON 70
ci_0022                -7.295607e-04 3 1  ON 71
ci_0023                -1.107917e-02 3 1  ON 72
ci_0024                -1.161285e-02 3 1  ON 73
ci_0025                -9.688240e-03 3 1  ON 74
ci_0026                -1.024589e-02 3 1  ON 75
ci_0027                -1.069342e-02 3 1  ON 76
ci_0028                -1.132248e-02 3 1  ON 77
ci_0029                -1.104017e-02 3 1  ON 78
ci_0030                -1.235374e-02 3 1  ON 79
ci_0031                 1.961369e-02 3 1  ON 80
ci_0032                 2.172094e-02 3 1  ON 81
ci_0033                 1.114064e-02 3 1  ON 82
ci_0034                 8.990485e-03 3 1  ON 83
ci_0035                 6.003732e-03 3 1  ON 84
ci_0036                 7.118921e-03 3 1  ON 85
ci_0037                -1.103896e-02 3 1  ON 86
ci_0038                -8.610798e-03 3 1  ON 87
ci_0039                -2.352887e-03 3 1  ON 88
ci_0040                -2.344577e-03 3 1  ON 89
ci_0041                 7.216700e-03 3 1  ON 90
ci_0042                 6.904879e-03 3 1  ON 91
ci_0043                -1.826950e-02 3 1  ON 92
ci_0044                -1.891180e-02 3 1  ON 93
ci_0045                 7.532080e-03 3 1  ON 94
ci_0046                 7.024057e-03 3 1  ON 95
ci_0047                -1.301590e-03 3 1  ON 96
ci_0048                -1.588460e-03 3 1  ON 97
ci_0049                -4.634565e-03 3 1  ON 98
ci_0050                -7.323463e-03 3 1  ON 99
ci_0051                -3.936591e-03 3 1  ON 100
ci_0052                -3.783768e-03 3 1  ON 101
ci_0053                -4.723384e-03 3 1  ON 102
ci_0054                -5.472470e-03 3 1  ON 103
ci_0055                 6.832855e-03 3 1  ON 104
ci_0056                 7.129038e-03 3 1  ON 105
ci_0057                 4.296281e-03 3 1  ON 106
ci_0058                 4.082593e-03 3 1  ON 107
ci_0059                -4.949691e-03 3 1  ON 108
ci_0060                -4.773048e-03 3 1  ON 109
ci_0061                -4.433756e-03 3 1  ON 110
ci_0062                -2.519396e-03 3 1  ON 111
ci_0063                -8.355008e-03 3 1  ON 112
ci_0064                -8.853907e-03 3 1  ON 113
ci_0065                -5.633967e-03 3 1  ON 114
ci_0066                -4.918564e-03 3 1  ON 115
ci_0067                -5.377725e-03 3 1  ON 116
ci_0068                -5.432259e-03 3 1  ON 117
ci_0069                 4.741766e-03 3 1  ON 118
ci_0070                 4.483241e-03 3 1  ON 119
ci_0071                 5.466113e-04 3 1  ON 120
ci_0072                -2.626072e-04 3 1  ON 121
ci_0073                 4.083878e-03 3 1  ON 122
ci_0074                 4.009638e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.0041
    reference variance = 0.335815
====================================================
  Execution time = 2.3109e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3589e-01
  Total weights = 1.9517e+06
  Execution time = 1.9255e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 7.90526e-05
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323908407644
                                         uncertainty =       0.002071014927

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323908407644
                                         uncertainty =       0.002071014927

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402365729
  error estimate for blocks of size 2^( 2) =       0.000415362038
  error estimate for blocks of size 2^( 3) =       0.000428053653
  error estimate for blocks of size 2^( 4) =       0.000439972798
  error estimate for blocks of size 2^( 5) =       0.000451310689
  error estimate for blocks of size 2^( 6) =       0.000458917272
  error estimate for blocks of size 2^( 7) =       0.000464771954

      target function =                  N/A
              le_mean =     -16.906250188580
             les_mean =     286.166995089648
             stat err =       0.000453743178
             autocorr =       1.271681198977
              std dev =       0.569031071542
             le_variance =       0.323796360381

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.000163574
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323611730061
                                         uncertainty =       0.002046289968

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323611730061
                                         uncertainty =       0.002046289968

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402182134
  error estimate for blocks of size 2^( 2) =       0.000415229279
  error estimate for blocks of size 2^( 3) =       0.000427954992
  error estimate for blocks of size 2^( 4) =       0.000439907545
  error estimate for blocks of size 2^( 5) =       0.000451246129
  error estimate for blocks of size 2^( 6) =       0.000458907662
  error estimate for blocks of size 2^( 7) =       0.000464802363

      target function =                  N/A
              le_mean =     -16.906174535889
             les_mean =     286.186378983483
             stat err =       0.000453715925
             autocorr =       1.272689606262
              std dev =       0.568771428069
             le_variance =       0.323500937388

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 7.89817e-05
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323787130397
                                         uncertainty =       0.002059490321

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323787130397
                                         uncertainty =       0.002059490321

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402291501
  error estimate for blocks of size 2^( 2) =       0.000415357393
  error estimate for blocks of size 2^( 3) =       0.000428116582
  error estimate for blocks of size 2^( 4) =       0.000440087939
  error estimate for blocks of size 2^( 5) =       0.000451419695
  error estimate for blocks of size 2^( 6) =       0.000459064902
  error estimate for blocks of size 2^( 7) =       0.000464989366

      target function =                  N/A
              le_mean =     -16.906239814733
             les_mean =     286.163938662270
             stat err =       0.000453890476
             autocorr =       1.272976609996
              std dev =       0.568926096946
             le_variance =       0.323676903787

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.000127589
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340472673650
                                         uncertainty =       0.016972934202

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340472673650
                                         uncertainty =       0.016972934202

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412513291
  error estimate for blocks of size 2^( 2) =       0.000425201591
  error estimate for blocks of size 2^( 3) =       0.000437570247
  error estimate for blocks of size 2^( 4) =       0.000449252563
  error estimate for blocks of size 2^( 5) =       0.000459903355
  error estimate for blocks of size 2^( 6) =       0.000467923051
  error estimate for blocks of size 2^( 7) =       0.000473958401

      target function =                  N/A
              le_mean =     -16.906295559241
             les_mean =     290.811940868300
             stat err =       0.000462759342
             autocorr =       1.258445753614
              std dev =       0.583381890237
             le_variance =       0.340334429857


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906250188580        initial
     2.3842e-02     2.3842e-01             9.3533e-03       -16.906174535889
     9.5367e-02     9.5367e-01             2.3616e-03       -16.906239814733
     3.8147e-01     3.8147e+00             7.8670e-04       -16.906295559241  <--

*****************************************************************************
Applying the update for shift_i =   3.8147e-01     and shift_s =   3.8147e+00
*****************************************************************************

  Execution time = 3.2831e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
   uu_0                 3.134050e-01 1 1  ON 0
   uu_1                 1.457287e-01 1 1  ON 1
   uu_2                 4.382364e-02 1 1  ON 2
   uu_3                -1.920232e-02 1 1  ON 3
   uu_4                -6.558084e-02 1 1  ON 4
   uu_5                -1.011655e-01 1 1  ON 5
   uu_6                -1.299268e-01 1 1  ON 6
   uu_7                -1.447700e-01 1 1  ON 7
   uu_8                -1.381285e-01 1 1  ON 8
   uu_9                -1.079643e-01 1 1  ON 9
   ud_0                 4.492603e-01 1 1  ON 10
   ud_1                 1.836026e-01 1 1  ON 11
   ud_2                 6.301376e-02 1 1  ON 12
   ud_3                -8.143108e-03 1 1  ON 13
   ud_4                -6.519812e-02 1 1  ON 14
   ud_5                -1.072504e-01 1 1  ON 15
   ud_6                -1.352141e-01 1 1  ON 16
   ud_7                -1.525008e-01 1 1  ON 17
   ud_8                -1.538245e-01 1 1  ON 18
   ud_9                -1.435416e-01 1 1  ON 19
   eO_0                -7.514889e-01 1 1  ON 20
   eO_1                -4.308736e-01 1 1  ON 21
   eO_2                -1.939679e-02 1 1  ON 22
   eO_3                 2.939773e-01 1 1  ON 23
   eO_4                 5.198718e-01 1 1  ON 24
   eO_5                 4.832646e-01 1 1  ON 25
   eO_6                 2.568200e-01 1 1  ON 26
   eO_7                -4.343098e-02 1 1  ON 27
   eO_8                -2.229186e-01 1 1  ON 28
   eO_9                -8.494625e-02 1 1  ON 29
  eH1_0                -2.579353e-01 1 1  ON 30
  eH1_1                -1.501138e-01 1 1  ON 31
  eH1_2                -1.003669e-01 1 1  ON 32
  eH1_3                -4.503435e-02 1 1  ON 33
  eH1_4                 4.955262e-03 1 1  ON 34
  eH1_5                 4.053962e-02 1 1  ON 35
  eH1_6                 1.006393e-01 1 1  ON 36
  eH1_7                 1.573393e-01 1 1  ON 37
  eH1_8                 1.813152e-01 1 1  ON 38
  eH1_9                 7.064354e-02 1 1  ON 39
  eH2_0                -2.547450e-01 1 1  ON 40
  eH2_1                -1.483911e-01 1 1  ON 41
  eH2_2                -9.840239e-02 1 1  ON 42
  eH2_3                -4.286083e-02 1 1  ON 43
  eH2_4                 6.752504e-03 1 1  ON 44
  eH2_5                 4.212541e-02 1 1  ON 45
  eH2_6                 1.027829e-01 1 1  ON 46
  eH2_7                 1.594802e-01 1 1  ON 47
  eH2_8                 1.869134e-01 1 1  ON 48
  eH2_9                 6.103814e-02 1 1  ON 49
ci_0001                 7.014315e-01 3 1  ON 50
ci_0002                 7.005300e-01 3 1  ON 51
ci_0003                -2.729112e-02 3 1  ON 52
ci_0004                -2.714119e-02 3 1  ON 53
ci_0005                -3.585099e-02 3 1  ON 54
ci_0006                -3.607013e-02 3 1  ON 55
ci_0007                -2.259031e-02 3 1  ON 56
ci_0008                -2.164486e-02 3 1  ON 57
ci_0009                -1.755378e-02 3 1  ON 58
ci_0010                -1.717608e-02 3 1  ON 59
ci_0011                -1.256797e-02 3 1  ON 60
ci_0012                -1.180365e-02 3 1  ON 61
ci_0013                 1.325092e-02 3 1  ON 62
ci_0014                 1.288062e-02 3 1  ON 63
ci_0015                 1.318070e-02 3 1  ON 64
ci_0016                 1.287822e-02 3 1  ON 65
ci_0017                 1.101445e-02 3 1  ON 66
ci_0018                 1.141456e-02 3 1  ON 67
ci_0019                 1.184206e-02 3 1  ON 68
ci_0020                 1.129694e-02 3 1  ON 69
ci_0021                -1.249586e-03 3 1  ON 70
ci_0022                -6.065990e-04 3 1  ON 71
ci_0023                -1.122240e-02 3 1  ON 72
ci_0024                -1.167379e-02 3 1  ON 73
ci_0025                -1.015383e-02 3 1  ON 74
ci_0026                -1.089233e-02 3 1  ON 75
ci_0027                -1.084034e-02 3 1  ON 76
ci_0028                -1.107637e-02 3 1  ON 77
ci_0029                -1.095237e-02 3 1  ON 78
ci_0030                -1.164277e-02 3 1  ON 79
ci_0031                 1.981453e-02 3 1  ON 80
ci_0032                 2.118239e-02 3 1  ON 81
ci_0033                 1.005465e-02 3 1  ON 82
ci_0034                 9.482218e-03 3 1  ON 83
ci_0035                 6.142110e-03 3 1  ON 84
ci_0036                 6.653814e-03 3 1  ON 85
ci_0037                -1.091516e-02 3 1  ON 86
ci_0038                -9.398606e-03 3 1  ON 87
ci_0039                -2.536157e-03 3 1  ON 88
ci_0040                -2.332324e-03 3 1  ON 89
ci_0041                 7.134327e-03 3 1  ON 90
ci_0042                 6.929769e-03 3 1  ON 91
ci_0043                -1.767972e-02 3 1  ON 92
ci_0044                -1.878032e-02 3 1  ON 93
ci_0045                 7.769545e-03 3 1  ON 94
ci_0046                 7.313085e-03 3 1  ON 95
ci_0047                -1.470579e-03 3 1  ON 96
ci_0048                -1.701661e-03 3 1  ON 97
ci_0049                -4.858617e-03 3 1  ON 98
ci_0050                -6.848619e-03 3 1  ON 99
ci_0051                -4.174386e-03 3 1  ON 100
ci_0052                -3.678047e-03 3 1  ON 101
ci_0053                -4.466525e-03 3 1  ON 102
ci_0054                -5.102562e-03 3 1  ON 103
ci_0055                 6.335570e-03 3 1  ON 104
ci_0056                 7.035284e-03 3 1  ON 105
ci_0057                 4.279828e-03 3 1  ON 106
ci_0058                 4.562122e-03 3 1  ON 107
ci_0059                -4.651603e-03 3 1  ON 108
ci_0060                -4.708872e-03 3 1  ON 109
ci_0061                -4.033913e-03 3 1  ON 110
ci_0062                -2.761113e-03 3 1  ON 111
ci_0063                -8.600840e-03 3 1  ON 112
ci_0064                -8.907177e-03 3 1  ON 113
ci_0065                -5.625604e-03 3 1  ON 114
ci_0066                -5.132752e-03 3 1  ON 115
ci_0067                -5.067396e-03 3 1  ON 116
ci_0068                -5.149264e-03 3 1  ON 117
ci_0069                 4.804829e-03 3 1  ON 118
ci_0070                 4.480403e-03 3 1  ON 119
ci_0071                 1.507858e-04 3 1  ON 120
ci_0072                 6.235765e-05 3 1  ON 121
ci_0073                 4.223231e-03 3 1  ON 122
ci_0074                 3.852446e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.0261e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6912e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.9397
    reference variance = 0.499585
====================================================
  Execution time = 2.1370e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5264e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3512e-01
  Total weights = 1.951607371e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1231e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322158300961
                                         uncertainty =       0.002732059112

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322158300961
                                         uncertainty =       0.002732059112

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401321207
  error estimate for blocks of size 2^( 2) =       0.000414004894
  error estimate for blocks of size 2^( 3) =       0.000427316625
  error estimate for blocks of size 2^( 4) =       0.000439999200
  error estimate for blocks of size 2^( 5) =       0.000451676778
  error estimate for blocks of size 2^( 6) =       0.000458563427
  error estimate for blocks of size 2^( 7) =       0.000465206708

      target function =                  N/A
              le_mean =     -16.905155360662
             les_mean =     286.119400093203
             stat err =       0.000453861528
             autocorr =       1.278976378191
              std dev =       0.567553893258
             le_variance =       0.322117421753


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690515536066e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-02, overlap shift 9.5367e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905155360663       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905171670424       residual = 6.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905174676675       residual = 9.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905172588845       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905174691567       residual = 7.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905173812734       residual = 8.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905175443891       residual = 6.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905176682130       residual = 7.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905175337442       residual = 3.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905175830156       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905175934283       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905175674417       residual = 7.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905175521585       residual = 2.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905175490490       residual = 2.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.905175738286       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.905175638678       residual = 3.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.5367e-02 is 2.289286e-03

solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905155360663       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905163762757       residual = 5.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905164988888       residual = 3.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905164130231       residual = 6.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905165055942       residual = 7.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905165082926       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905165209571       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905165455281       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905165026344       residual = 3.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905165081454       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905165223091       residual = 7.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e-01 is 8.126673e-04

solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905155360663       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905158219126       residual = 5.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905158599987       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905158353009       residual = 5.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905158549348       residual = 5.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905158581635       residual = 2.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905158683050       residual = 7.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905158653486       residual = 4.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905158602599       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905158596577       residual = 5.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e+00 is 2.693529e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.166640 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7513e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
   uu_0                 3.131738e-01 1 1  ON 0
   uu_1                 1.456703e-01 1 1  ON 1
   uu_2                 4.367085e-02 1 1  ON 2
   uu_3                -1.919481e-02 1 1  ON 3
   uu_4                -6.547193e-02 1 1  ON 4
   uu_5                -1.012107e-01 1 1  ON 5
   uu_6                -1.298533e-01 1 1  ON 6
   uu_7                -1.448795e-01 1 1  ON 7
   uu_8                -1.380637e-01 1 1  ON 8
   uu_9                -1.079794e-01 1 1  ON 9
   ud_0                 4.496386e-01 1 1  ON 10
   ud_1                 1.837845e-01 1 1  ON 11
   ud_2                 6.311003e-02 1 1  ON 12
   ud_3                -8.116979e-03 1 1  ON 13
   ud_4                -6.535785e-02 1 1  ON 14
   ud_5                -1.075088e-01 1 1  ON 15
   ud_6                -1.355727e-01 1 1  ON 16
   ud_7                -1.526779e-01 1 1  ON 17
   ud_8                -1.536542e-01 1 1  ON 18
   ud_9                -1.434604e-01 1 1  ON 19
   eO_0                -7.514519e-01 1 1  ON 20
   eO_1                -4.308131e-01 1 1  ON 21
   eO_2                -1.936670e-02 1 1  ON 22
   eO_3                 2.937698e-01 1 1  ON 23
   eO_4                 5.199259e-01 1 1  ON 24
   eO_5                 4.836307e-01 1 1  ON 25
   eO_6                 2.569137e-01 1 1  ON 26
   eO_7                -4.333573e-02 1 1  ON 27
   eO_8                -2.230913e-01 1 1  ON 28
   eO_9                -8.524919e-02 1 1  ON 29
  eH1_0                -2.580991e-01 1 1  ON 30
  eH1_1                -1.503230e-01 1 1  ON 31
  eH1_2                -1.005129e-01 1 1  ON 32
  eH1_3                -4.532995e-02 1 1  ON 33
  eH1_4                 4.921345e-03 1 1  ON 34
  eH1_5                 4.059350e-02 1 1  ON 35
  eH1_6                 1.004308e-01 1 1  ON 36
  eH1_7                 1.574649e-01 1 1  ON 37
  eH1_8                 1.817436e-01 1 1  ON 38
  eH1_9                 7.105750e-02 1 1  ON 39
  eH2_0                -2.553310e-01 1 1  ON 40
  eH2_1                -1.484316e-01 1 1  ON 41
  eH2_2                -9.852594e-02 1 1  ON 42
  eH2_3                -4.297529e-02 1 1  ON 43
  eH2_4                 6.664073e-03 1 1  ON 44
  eH2_5                 4.222028e-02 1 1  ON 45
  eH2_6                 1.027457e-01 1 1  ON 46
  eH2_7                 1.594161e-01 1 1  ON 47
  eH2_8                 1.872849e-01 1 1  ON 48
  eH2_9                 6.160020e-02 1 1  ON 49
ci_0001                 7.016356e-01 3 1  ON 50
ci_0002                 7.003271e-01 3 1  ON 51
ci_0003                -2.770930e-02 3 1  ON 52
ci_0004                -2.717957e-02 3 1  ON 53
ci_0005                -3.542558e-02 3 1  ON 54
ci_0006                -3.623934e-02 3 1  ON 55
ci_0007                -2.209262e-02 3 1  ON 56
ci_0008                -2.213873e-02 3 1  ON 57
ci_0009                -1.755709e-02 3 1  ON 58
ci_0010                -1.722405e-02 3 1  ON 59
ci_0011                -1.256969e-02 3 1  ON 60
ci_0012                -1.163672e-02 3 1  ON 61
ci_0013                 1.310780e-02 3 1  ON 62
ci_0014                 1.275273e-02 3 1  ON 63
ci_0015                 1.335235e-02 3 1  ON 64
ci_0016                 1.267229e-02 3 1  ON 65
ci_0017                 1.162953e-02 3 1  ON 66
ci_0018                 1.153388e-02 3 1  ON 67
ci_0019                 1.177804e-02 3 1  ON 68
ci_0020                 1.140143e-02 3 1  ON 69
ci_0021                -1.080050e-03 3 1  ON 70
ci_0022                -1.080155e-03 3 1  ON 71
ci_0023                -1.130509e-02 3 1  ON 72
ci_0024                -1.125576e-02 3 1  ON 73
ci_0025                -1.030998e-02 3 1  ON 74
ci_0026                -1.058558e-02 3 1  ON 75
ci_0027                -1.135172e-02 3 1  ON 76
ci_0028                -1.093162e-02 3 1  ON 77
ci_0029                -1.072825e-02 3 1  ON 78
ci_0030                -1.136851e-02 3 1  ON 79
ci_0031                 2.025544e-02 3 1  ON 80
ci_0032                 2.112084e-02 3 1  ON 81
ci_0033                 1.005856e-02 3 1  ON 82
ci_0034                 9.613912e-03 3 1  ON 83
ci_0035                 6.954777e-03 3 1  ON 84
ci_0036                 6.773758e-03 3 1  ON 85
ci_0037                -1.068316e-02 3 1  ON 86
ci_0038                -9.517628e-03 3 1  ON 87
ci_0039                -2.443270e-03 3 1  ON 88
ci_0040                -2.486841e-03 3 1  ON 89
ci_0041                 6.686146e-03 3 1  ON 90
ci_0042                 7.233786e-03 3 1  ON 91
ci_0043                -1.776805e-02 3 1  ON 92
ci_0044                -1.863847e-02 3 1  ON 93
ci_0045                 7.593604e-03 3 1  ON 94
ci_0046                 7.214761e-03 3 1  ON 95
ci_0047                -1.437768e-03 3 1  ON 96
ci_0048                -1.981372e-03 3 1  ON 97
ci_0049                -5.480751e-03 3 1  ON 98
ci_0050                -6.135135e-03 3 1  ON 99
ci_0051                -3.724895e-03 3 1  ON 100
ci_0052                -3.590063e-03 3 1  ON 101
ci_0053                -4.334141e-03 3 1  ON 102
ci_0054                -4.988001e-03 3 1  ON 103
ci_0055                 6.358871e-03 3 1  ON 104
ci_0056                 6.857049e-03 3 1  ON 105
ci_0057                 4.627349e-03 3 1  ON 106
ci_0058                 4.548476e-03 3 1  ON 107
ci_0059                -4.809789e-03 3 1  ON 108
ci_0060                -4.956103e-03 3 1  ON 109
ci_0061                -3.729185e-03 3 1  ON 110
ci_0062                -2.781037e-03 3 1  ON 111
ci_0063                -8.752755e-03 3 1  ON 112
ci_0064                -8.566133e-03 3 1  ON 113
ci_0065                -5.434324e-03 3 1  ON 114
ci_0066                -5.135644e-03 3 1  ON 115
ci_0067                -4.862012e-03 3 1  ON 116
ci_0068                -5.157563e-03 3 1  ON 117
ci_0069                 4.662424e-03 3 1  ON 118
ci_0070                 4.499303e-03 3 1  ON 119
ci_0071                 5.726716e-05 3 1  ON 120
ci_0072                 1.895934e-04 3 1  ON 121
ci_0073                 4.193823e-03 3 1  ON 122
ci_0074                 3.685268e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.8399
    reference variance = 0.224297
====================================================
  Execution time = 2.1303e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3994e-01
  Total weights = 1.9516e+06
  Execution time = 1.9168e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323156451755
                                         uncertainty =       0.002041526816

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323156451755
                                         uncertainty =       0.002041526816

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401908956
  error estimate for blocks of size 2^( 2) =       0.000414927974
  error estimate for blocks of size 2^( 3) =       0.000428369084
  error estimate for blocks of size 2^( 4) =       0.000441534106
  error estimate for blocks of size 2^( 5) =       0.000453165796
  error estimate for blocks of size 2^( 6) =       0.000461835905
  error estimate for blocks of size 2^( 7) =       0.000468947400

      target function =                  N/A
              le_mean =     -16.905298262498
             les_mean =     286.213785602969
             stat err =       0.000456370802
             autocorr =       1.289378233552
              std dev =       0.568385096144
             le_variance =       0.323061617518

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323033833454
                                         uncertainty =       0.001996304509

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323033833454
                                         uncertainty =       0.001996304509

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401833580
  error estimate for blocks of size 2^( 2) =       0.000414840932
  error estimate for blocks of size 2^( 3) =       0.000428286190
  error estimate for blocks of size 2^( 4) =       0.000441459951
  error estimate for blocks of size 2^( 5) =       0.000453066709
  error estimate for blocks of size 2^( 6) =       0.000461754829
  error estimate for blocks of size 2^( 7) =       0.000468877751

      target function =                  N/A
              le_mean =     -16.905278588211
             les_mean =     286.130033023094
             stat err =       0.000456289810
             autocorr =       1.289404221520
              std dev =       0.568278498507
             le_variance =       0.322940451866

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322994969436
                                         uncertainty =       0.001989786115

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322994969436
                                         uncertainty =       0.001989786115

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401809288
  error estimate for blocks of size 2^( 2) =       0.000414817621
  error estimate for blocks of size 2^( 3) =       0.000428265293
  error estimate for blocks of size 2^( 4) =       0.000441442280
  error estimate for blocks of size 2^( 5) =       0.000453056029
  error estimate for blocks of size 2^( 6) =       0.000461748500
  error estimate for blocks of size 2^( 7) =       0.000468881534

      target function =                  N/A
              le_mean =     -16.905279189710
             les_mean =     286.131579400442
             stat err =       0.000456282086
             autocorr =       1.289516472708
              std dev =       0.568244144044
             le_variance =       0.322901407240

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323324540551
                                         uncertainty =       0.002076346270

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323324540551
                                         uncertainty =       0.002076346270

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402013614
  error estimate for blocks of size 2^( 2) =       0.000415012752
  error estimate for blocks of size 2^( 3) =       0.000428444417
  error estimate for blocks of size 2^( 4) =       0.000441620826
  error estimate for blocks of size 2^( 5) =       0.000453201747
  error estimate for blocks of size 2^( 6) =       0.000461908303
  error estimate for blocks of size 2^( 7) =       0.000468967696

      target function =                  N/A
              le_mean =     -16.905268429974
             les_mean =     286.591773774459
             stat err =       0.000456424643
             autocorr =       1.289011071373
              std dev =       0.568533105710
             le_variance =       0.323229892288


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905298262498        initial  <--
     9.5367e-02     9.5367e-01             2.2893e-03       -16.905278588211
     3.8147e-01     3.8147e+00             8.1267e-04       -16.905279189710
     1.5259e+00     1.5259e+01             2.6935e-04       -16.905268429974

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.9956
  </log>
  <optVariables href="H2O.s021.opt.xml">
   uu_0                 3.134050e-01 1 1  ON 0
   uu_1                 1.457287e-01 1 1  ON 1
   uu_2                 4.382364e-02 1 1  ON 2
   uu_3                -1.920232e-02 1 1  ON 3
   uu_4                -6.558084e-02 1 1  ON 4
   uu_5                -1.011655e-01 1 1  ON 5
   uu_6                -1.299268e-01 1 1  ON 6
   uu_7                -1.447700e-01 1 1  ON 7
   uu_8                -1.381285e-01 1 1  ON 8
   uu_9                -1.079643e-01 1 1  ON 9
   ud_0                 4.492603e-01 1 1  ON 10
   ud_1                 1.836026e-01 1 1  ON 11
   ud_2                 6.301376e-02 1 1  ON 12
   ud_3                -8.143108e-03 1 1  ON 13
   ud_4                -6.519812e-02 1 1  ON 14
   ud_5                -1.072504e-01 1 1  ON 15
   ud_6                -1.352141e-01 1 1  ON 16
   ud_7                -1.525008e-01 1 1  ON 17
   ud_8                -1.538245e-01 1 1  ON 18
   ud_9                -1.435416e-01 1 1  ON 19
   eO_0                -7.514889e-01 1 1  ON 20
   eO_1                -4.308736e-01 1 1  ON 21
   eO_2                -1.939679e-02 1 1  ON 22
   eO_3                 2.939773e-01 1 1  ON 23
   eO_4                 5.198718e-01 1 1  ON 24
   eO_5                 4.832646e-01 1 1  ON 25
   eO_6                 2.568200e-01 1 1  ON 26
   eO_7                -4.343098e-02 1 1  ON 27
   eO_8                -2.229186e-01 1 1  ON 28
   eO_9                -8.494625e-02 1 1  ON 29
  eH1_0                -2.579353e-01 1 1  ON 30
  eH1_1                -1.501138e-01 1 1  ON 31
  eH1_2                -1.003669e-01 1 1  ON 32
  eH1_3                -4.503435e-02 1 1  ON 33
  eH1_4                 4.955262e-03 1 1  ON 34
  eH1_5                 4.053962e-02 1 1  ON 35
  eH1_6                 1.006393e-01 1 1  ON 36
  eH1_7                 1.573393e-01 1 1  ON 37
  eH1_8                 1.813152e-01 1 1  ON 38
  eH1_9                 7.064354e-02 1 1  ON 39
  eH2_0                -2.547450e-01 1 1  ON 40
  eH2_1                -1.483911e-01 1 1  ON 41
  eH2_2                -9.840239e-02 1 1  ON 42
  eH2_3                -4.286083e-02 1 1  ON 43
  eH2_4                 6.752504e-03 1 1  ON 44
  eH2_5                 4.212541e-02 1 1  ON 45
  eH2_6                 1.027829e-01 1 1  ON 46
  eH2_7                 1.594802e-01 1 1  ON 47
  eH2_8                 1.869134e-01 1 1  ON 48
  eH2_9                 6.103814e-02 1 1  ON 49
ci_0001                 7.014315e-01 3 1  ON 50
ci_0002                 7.005300e-01 3 1  ON 51
ci_0003                -2.729112e-02 3 1  ON 52
ci_0004                -2.714119e-02 3 1  ON 53
ci_0005                -3.585099e-02 3 1  ON 54
ci_0006                -3.607013e-02 3 1  ON 55
ci_0007                -2.259031e-02 3 1  ON 56
ci_0008                -2.164486e-02 3 1  ON 57
ci_0009                -1.755378e-02 3 1  ON 58
ci_0010                -1.717608e-02 3 1  ON 59
ci_0011                -1.256797e-02 3 1  ON 60
ci_0012                -1.180365e-02 3 1  ON 61
ci_0013                 1.325092e-02 3 1  ON 62
ci_0014                 1.288062e-02 3 1  ON 63
ci_0015                 1.318070e-02 3 1  ON 64
ci_0016                 1.287822e-02 3 1  ON 65
ci_0017                 1.101445e-02 3 1  ON 66
ci_0018                 1.141456e-02 3 1  ON 67
ci_0019                 1.184206e-02 3 1  ON 68
ci_0020                 1.129694e-02 3 1  ON 69
ci_0021                -1.249586e-03 3 1  ON 70
ci_0022                -6.065990e-04 3 1  ON 71
ci_0023                -1.122240e-02 3 1  ON 72
ci_0024                -1.167379e-02 3 1  ON 73
ci_0025                -1.015383e-02 3 1  ON 74
ci_0026                -1.089233e-02 3 1  ON 75
ci_0027                -1.084034e-02 3 1  ON 76
ci_0028                -1.107637e-02 3 1  ON 77
ci_0029                -1.095237e-02 3 1  ON 78
ci_0030                -1.164277e-02 3 1  ON 79
ci_0031                 1.981453e-02 3 1  ON 80
ci_0032                 2.118239e-02 3 1  ON 81
ci_0033                 1.005465e-02 3 1  ON 82
ci_0034                 9.482218e-03 3 1  ON 83
ci_0035                 6.142110e-03 3 1  ON 84
ci_0036                 6.653814e-03 3 1  ON 85
ci_0037                -1.091516e-02 3 1  ON 86
ci_0038                -9.398606e-03 3 1  ON 87
ci_0039                -2.536157e-03 3 1  ON 88
ci_0040                -2.332324e-03 3 1  ON 89
ci_0041                 7.134327e-03 3 1  ON 90
ci_0042                 6.929769e-03 3 1  ON 91
ci_0043                -1.767972e-02 3 1  ON 92
ci_0044                -1.878032e-02 3 1  ON 93
ci_0045                 7.769545e-03 3 1  ON 94
ci_0046                 7.313085e-03 3 1  ON 95
ci_0047                -1.470579e-03 3 1  ON 96
ci_0048                -1.701661e-03 3 1  ON 97
ci_0049                -4.858617e-03 3 1  ON 98
ci_0050                -6.848619e-03 3 1  ON 99
ci_0051                -4.174386e-03 3 1  ON 100
ci_0052                -3.678047e-03 3 1  ON 101
ci_0053                -4.466525e-03 3 1  ON 102
ci_0054                -5.102562e-03 3 1  ON 103
ci_0055                 6.335570e-03 3 1  ON 104
ci_0056                 7.035284e-03 3 1  ON 105
ci_0057                 4.279828e-03 3 1  ON 106
ci_0058                 4.562122e-03 3 1  ON 107
ci_0059                -4.651603e-03 3 1  ON 108
ci_0060                -4.708872e-03 3 1  ON 109
ci_0061                -4.033913e-03 3 1  ON 110
ci_0062                -2.761113e-03 3 1  ON 111
ci_0063                -8.600840e-03 3 1  ON 112
ci_0064                -8.907177e-03 3 1  ON 113
ci_0065                -5.625604e-03 3 1  ON 114
ci_0066                -5.132752e-03 3 1  ON 115
ci_0067                -5.067396e-03 3 1  ON 116
ci_0068                -5.149264e-03 3 1  ON 117
ci_0069                 4.804829e-03 3 1  ON 118
ci_0070                 4.480403e-03 3 1  ON 119
ci_0071                 1.507858e-04 3 1  ON 120
ci_0072                 6.235765e-05 3 1  ON 121
ci_0073                 4.223231e-03 3 1  ON 122
ci_0074                 3.852446e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8532e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6911e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.8334
    reference variance = 0.301925
====================================================
  Execution time = 2.1176e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5232e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3918e-01
  Total weights = 1.951985732e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1417e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325673584669
                                         uncertainty =       0.002507926653

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325673584669
                                         uncertainty =       0.002507926653

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403525853
  error estimate for blocks of size 2^( 2) =       0.000416089581
  error estimate for blocks of size 2^( 3) =       0.000428986845
  error estimate for blocks of size 2^( 4) =       0.000441584049
  error estimate for blocks of size 2^( 5) =       0.000451489160
  error estimate for blocks of size 2^( 6) =       0.000459066316
  error estimate for blocks of size 2^( 7) =       0.000463294942

      target function =                  N/A
              le_mean =     -16.906652108863
             les_mean =     286.174064430477
             stat err =       0.000453858617
             autocorr =       1.265023057023
              std dev =       0.570671734300
             le_variance =       0.325666228329


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690665210886e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906652108874       residual = 2.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906657502436       residual = 3.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906656813835       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906656681838       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906657226279       residual = 5.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906656765793       residual = 3.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906657060747       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906657090193       residual = 5.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906657090366       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906657032125       residual = 7.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.5367e-01 is 3.703977e-04

solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906652108874       residual = 2.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906653684291       residual = 3.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906653466415       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906653409774       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906653540709       residual = 4.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906653434194       residual = 2.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906653496139       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906653510556       residual = 3.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906653520046       residual = 8.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e+00 is 1.073789e-04

solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906652108874       residual = 2.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906652520035       residual = 3.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906652461779       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906652445969       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906652477663       residual = 4.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906652452619       residual = 2.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906652465857       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906652469647       residual = 3.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906652473529       residual = 8.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e+01 is 2.795966e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.175045 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7334e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
   uu_0                 3.133921e-01 1 1  ON 0
   uu_1                 1.457618e-01 1 1  ON 1
   uu_2                 4.380814e-02 1 1  ON 2
   uu_3                -1.920254e-02 1 1  ON 3
   uu_4                -6.557974e-02 1 1  ON 4
   uu_5                -1.011824e-01 1 1  ON 5
   uu_6                -1.299220e-01 1 1  ON 6
   uu_7                -1.447626e-01 1 1  ON 7
   uu_8                -1.381403e-01 1 1  ON 8
   uu_9                -1.079812e-01 1 1  ON 9
   ud_0                 4.493002e-01 1 1  ON 10
   ud_1                 1.836050e-01 1 1  ON 11
   ud_2                 6.303530e-02 1 1  ON 12
   ud_3                -8.136398e-03 1 1  ON 13
   ud_4                -6.522269e-02 1 1  ON 14
   ud_5                -1.072448e-01 1 1  ON 15
   ud_6                -1.352260e-01 1 1  ON 16
   ud_7                -1.525020e-01 1 1  ON 17
   ud_8                -1.538364e-01 1 1  ON 18
   ud_9                -1.435341e-01 1 1  ON 19
   eO_0                -7.515103e-01 1 1  ON 20
   eO_1                -4.308671e-01 1 1  ON 21
   eO_2                -1.937766e-02 1 1  ON 22
   eO_3                 2.940019e-01 1 1  ON 23
   eO_4                 5.198929e-01 1 1  ON 24
   eO_5                 4.832653e-01 1 1  ON 25
   eO_6                 2.568256e-01 1 1  ON 26
   eO_7                -4.342332e-02 1 1  ON 27
   eO_8                -2.229444e-01 1 1  ON 28
   eO_9                -8.497732e-02 1 1  ON 29
  eH1_0                -2.579225e-01 1 1  ON 30
  eH1_1                -1.501405e-01 1 1  ON 31
  eH1_2                -1.003950e-01 1 1  ON 32
  eH1_3                -4.503875e-02 1 1  ON 33
  eH1_4                 4.937077e-03 1 1  ON 34
  eH1_5                 4.054747e-02 1 1  ON 35
  eH1_6                 1.006123e-01 1 1  ON 36
  eH1_7                 1.573349e-01 1 1  ON 37
  eH1_8                 1.813537e-01 1 1  ON 38
  eH1_9                 7.069428e-02 1 1  ON 39
  eH2_0                -2.547947e-01 1 1  ON 40
  eH2_1                -1.484296e-01 1 1  ON 41
  eH2_2                -9.841054e-02 1 1  ON 42
  eH2_3                -4.285451e-02 1 1  ON 43
  eH2_4                 6.757647e-03 1 1  ON 44
  eH2_5                 4.211824e-02 1 1  ON 45
  eH2_6                 1.027804e-01 1 1  ON 46
  eH2_7                 1.594794e-01 1 1  ON 47
  eH2_8                 1.869462e-01 1 1  ON 48
  eH2_9                 6.109277e-02 1 1  ON 49
ci_0001                 7.014392e-01 3 1  ON 50
ci_0002                 7.005326e-01 3 1  ON 51
ci_0003                -2.730240e-02 3 1  ON 52
ci_0004                -2.715440e-02 3 1  ON 53
ci_0005                -3.582616e-02 3 1  ON 54
ci_0006                -3.604501e-02 3 1  ON 55
ci_0007                -2.260394e-02 3 1  ON 56
ci_0008                -2.163888e-02 3 1  ON 57
ci_0009                -1.755556e-02 3 1  ON 58
ci_0010                -1.718119e-02 3 1  ON 59
ci_0011                -1.255634e-02 3 1  ON 60
ci_0012                -1.186633e-02 3 1  ON 61
ci_0013                 1.319781e-02 3 1  ON 62
ci_0014                 1.285175e-02 3 1  ON 63
ci_0015                 1.311152e-02 3 1  ON 64
ci_0016                 1.287923e-02 3 1  ON 65
ci_0017                 1.103327e-02 3 1  ON 66
ci_0018                 1.138536e-02 3 1  ON 67
ci_0019                 1.183194e-02 3 1  ON 68
ci_0020                 1.123698e-02 3 1  ON 69
ci_0021                -1.278902e-03 3 1  ON 70
ci_0022                -6.272510e-04 3 1  ON 71
ci_0023                -1.124411e-02 3 1  ON 72
ci_0024                -1.163949e-02 3 1  ON 73
ci_0025                -1.018131e-02 3 1  ON 74
ci_0026                -1.084835e-02 3 1  ON 75
ci_0027                -1.090855e-02 3 1  ON 76
ci_0028                -1.108805e-02 3 1  ON 77
ci_0029                -1.084710e-02 3 1  ON 78
ci_0030                -1.160189e-02 3 1  ON 79
ci_0031                 1.979696e-02 3 1  ON 80
ci_0032                 2.118572e-02 3 1  ON 81
ci_0033                 1.009380e-02 3 1  ON 82
ci_0034                 9.404177e-03 3 1  ON 83
ci_0035                 6.125077e-03 3 1  ON 84
ci_0036                 6.608502e-03 3 1  ON 85
ci_0037                -1.083815e-02 3 1  ON 86
ci_0038                -9.451395e-03 3 1  ON 87
ci_0039                -2.593120e-03 3 1  ON 88
ci_0040                -2.352283e-03 3 1  ON 89
ci_0041                 7.180308e-03 3 1  ON 90
ci_0042                 6.873883e-03 3 1  ON 91
ci_0043                -1.770630e-02 3 1  ON 92
ci_0044                -1.875983e-02 3 1  ON 93
ci_0045                 7.702499e-03 3 1  ON 94
ci_0046                 7.305746e-03 3 1  ON 95
ci_0047                -1.405699e-03 3 1  ON 96
ci_0048                -1.650378e-03 3 1  ON 97
ci_0049                -4.930235e-03 3 1  ON 98
ci_0050                -6.741240e-03 3 1  ON 99
ci_0051                -4.084134e-03 3 1  ON 100
ci_0052                -3.658015e-03 3 1  ON 101
ci_0053                -4.479522e-03 3 1  ON 102
ci_0054                -5.066252e-03 3 1  ON 103
ci_0055                 6.425663e-03 3 1  ON 104
ci_0056                 6.991204e-03 3 1  ON 105
ci_0057                 4.283780e-03 3 1  ON 106
ci_0058                 4.564669e-03 3 1  ON 107
ci_0059                -4.711773e-03 3 1  ON 108
ci_0060                -4.735756e-03 3 1  ON 109
ci_0061                -4.062668e-03 3 1  ON 110
ci_0062                -2.849553e-03 3 1  ON 111
ci_0063                -8.597013e-03 3 1  ON 112
ci_0064                -8.918019e-03 3 1  ON 113
ci_0065                -5.575292e-03 3 1  ON 114
ci_0066                -5.154895e-03 3 1  ON 115
ci_0067                -5.037198e-03 3 1  ON 116
ci_0068                -5.089492e-03 3 1  ON 117
ci_0069                 4.809534e-03 3 1  ON 118
ci_0070                 4.418248e-03 3 1  ON 119
ci_0071                 1.776437e-04 3 1  ON 120
ci_0072                 1.332182e-04 3 1  ON 121
ci_0073                 4.148377e-03 3 1  ON 122
ci_0074                 3.831146e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.8894
    reference variance = 1.84449
====================================================
  Execution time = 2.0920e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3637e-01
  Total weights = 1.9519e+06
  Execution time = 2.0544e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323589159623
                                         uncertainty =       0.001872338460

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323589159623
                                         uncertainty =       0.001872338460

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402399667
  error estimate for blocks of size 2^( 2) =       0.000415129389
  error estimate for blocks of size 2^( 3) =       0.000428617637
  error estimate for blocks of size 2^( 4) =       0.000440834224
  error estimate for blocks of size 2^( 5) =       0.000452382591
  error estimate for blocks of size 2^( 6) =       0.000460024040
  error estimate for blocks of size 2^( 7) =       0.000466485446

      target function =                  N/A
              le_mean =     -16.906141746631
             les_mean =     286.153960011092
             stat err =       0.000454931575
             autocorr =       1.278135614996
              std dev =       0.569079066475
             le_variance =       0.323850983900

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323994426148
                                         uncertainty =       0.001915430164

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323994426148
                                         uncertainty =       0.001915430164

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402650550
  error estimate for blocks of size 2^( 2) =       0.000415380965
  error estimate for blocks of size 2^( 3) =       0.000428871648
  error estimate for blocks of size 2^( 4) =       0.000441059531
  error estimate for blocks of size 2^( 5) =       0.000452584565
  error estimate for blocks of size 2^( 6) =       0.000460235977
  error estimate for blocks of size 2^( 7) =       0.000466698404

      target function =                  N/A
              le_mean =     -16.906153888024
             les_mean =     288.127469173453
             stat err =       0.000455144619
             autocorr =       1.277739236750
              std dev =       0.569433869225
             le_variance =       0.324254931420

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323535922137
                                         uncertainty =       0.001870576377

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323535922137
                                         uncertainty =       0.001870576377

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402366862
  error estimate for blocks of size 2^( 2) =       0.000415099302
  error estimate for blocks of size 2^( 3) =       0.000428589642
  error estimate for blocks of size 2^( 4) =       0.000440807587
  error estimate for blocks of size 2^( 5) =       0.000452355335
  error estimate for blocks of size 2^( 6) =       0.000460003270
  error estimate for blocks of size 2^( 7) =       0.000466445692

      target function =                  N/A
              le_mean =     -16.906139001078
             les_mean =     286.154345382383
             stat err =       0.000454902971
             autocorr =       1.278183284148
              std dev =       0.569032673861
             le_variance =       0.323798183921

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323580900089
                                         uncertainty =       0.001872086057

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323580900089
                                         uncertainty =       0.001872086057

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402394573
  error estimate for blocks of size 2^( 2) =       0.000415124605
  error estimate for blocks of size 2^( 3) =       0.000428613108
  error estimate for blocks of size 2^( 4) =       0.000440829893
  error estimate for blocks of size 2^( 5) =       0.000452378225
  error estimate for blocks of size 2^( 6) =       0.000460020542
  error estimate for blocks of size 2^( 7) =       0.000466479491

      target function =                  N/A
              le_mean =     -16.906141231138
             les_mean =     286.153923849921
             stat err =       0.000454927038
             autocorr =       1.278142476153
              std dev =       0.569071863046
             le_variance =       0.323842785311


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906141746631        initial
     9.5367e-01     9.5367e+00             3.7040e-04       -16.906153888024  <--
     3.8147e+00     3.8147e+01             1.0738e-04       -16.906139001078
     1.5259e+01     1.5259e+02             2.7960e-05       -16.906141231138

*****************************************************************************
Applying the update for shift_i =   9.5367e-01     and shift_s =   9.5367e+00
*****************************************************************************

  Execution time = 3.0722e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
   uu_0                 3.133737e-01 1 1  ON 0
   uu_1                 1.458290e-01 1 1  ON 1
   uu_2                 4.377485e-02 1 1  ON 2
   uu_3                -1.920709e-02 1 1  ON 3
   uu_4                -6.558122e-02 1 1  ON 4
   uu_5                -1.012190e-01 1 1  ON 5
   uu_6                -1.299132e-01 1 1  ON 6
   uu_7                -1.447443e-01 1 1  ON 7
   uu_8                -1.381747e-01 1 1  ON 8
   uu_9                -1.080322e-01 1 1  ON 9
   ud_0                 4.493953e-01 1 1  ON 10
   ud_1                 1.836309e-01 1 1  ON 11
   ud_2                 6.308898e-02 1 1  ON 12
   ud_3                -8.119627e-03 1 1  ON 13
   ud_4                -6.527473e-02 1 1  ON 14
   ud_5                -1.072399e-01 1 1  ON 15
   ud_6                -1.352506e-01 1 1  ON 16
   ud_7                -1.525037e-01 1 1  ON 17
   ud_8                -1.538722e-01 1 1  ON 18
   ud_9                -1.435116e-01 1 1  ON 19
   eO_0                -7.515639e-01 1 1  ON 20
   eO_1                -4.308596e-01 1 1  ON 21
   eO_2                -1.931920e-02 1 1  ON 22
   eO_3                 2.940764e-01 1 1  ON 23
   eO_4                 5.199529e-01 1 1  ON 24
   eO_5                 4.832715e-01 1 1  ON 25
   eO_6                 2.568448e-01 1 1  ON 26
   eO_7                -4.339975e-02 1 1  ON 27
   eO_8                -2.230231e-01 1 1  ON 28
   eO_9                -8.507268e-02 1 1  ON 29
  eH1_0                -2.578949e-01 1 1  ON 30
  eH1_1                -1.502175e-01 1 1  ON 31
  eH1_2                -1.004667e-01 1 1  ON 32
  eH1_3                -4.506504e-02 1 1  ON 33
  eH1_4                 4.886902e-03 1 1  ON 34
  eH1_5                 4.056532e-02 1 1  ON 35
  eH1_6                 1.005339e-01 1 1  ON 36
  eH1_7                 1.573228e-01 1 1  ON 37
  eH1_8                 1.814709e-01 1 1  ON 38
  eH1_9                 7.085017e-02 1 1  ON 39
  eH2_0                -2.549400e-01 1 1  ON 40
  eH2_1                -1.485306e-01 1 1  ON 41
  eH2_2                -9.843857e-02 1 1  ON 42
  eH2_3                -4.284397e-02 1 1  ON 43
  eH2_4                 6.767355e-03 1 1  ON 44
  eH2_5                 4.209097e-02 1 1  ON 45
  eH2_6                 1.027717e-01 1 1  ON 46
  eH2_7                 1.594773e-01 1 1  ON 47
  eH2_8                 1.870466e-01 1 1  ON 48
  eH2_9                 6.126070e-02 1 1  ON 49
ci_0001                 7.014603e-01 3 1  ON 50
ci_0002                 7.005371e-01 3 1  ON 51
ci_0003                -2.733378e-02 3 1  ON 52
ci_0004                -2.718642e-02 3 1  ON 53
ci_0005                -3.575725e-02 3 1  ON 54
ci_0006                -3.597690e-02 3 1  ON 55
ci_0007                -2.264274e-02 3 1  ON 56
ci_0008                -2.162280e-02 3 1  ON 57
ci_0009                -1.756083e-02 3 1  ON 58
ci_0010                -1.719344e-02 3 1  ON 59
ci_0011                -1.252880e-02 3 1  ON 60
ci_0012                -1.202310e-02 3 1  ON 61
ci_0013                 1.306516e-02 3 1  ON 62
ci_0014                 1.277972e-02 3 1  ON 63
ci_0015                 1.293925e-02 3 1  ON 64
ci_0016                 1.288219e-02 3 1  ON 65
ci_0017                 1.108113e-02 3 1  ON 66
ci_0018                 1.131564e-02 3 1  ON 67
ci_0019                 1.180775e-02 3 1  ON 68
ci_0020                 1.109226e-02 3 1  ON 69
ci_0021                -1.358752e-03 3 1  ON 70
ci_0022                -6.821613e-04 3 1  ON 71
ci_0023                -1.129793e-02 3 1  ON 72
ci_0024                -1.156046e-02 3 1  ON 73
ci_0025                -1.024527e-02 3 1  ON 74
ci_0026                -1.074039e-02 3 1  ON 75
ci_0027                -1.107889e-02 3 1  ON 76
ci_0028                -1.112120e-02 3 1  ON 77
ci_0029                -1.059281e-02 3 1  ON 78
ci_0030                -1.150208e-02 3 1  ON 79
ci_0031                 1.975010e-02 3 1  ON 80
ci_0032                 2.119274e-02 3 1  ON 81
ci_0033                 1.019878e-02 3 1  ON 82
ci_0034                 9.193212e-03 3 1  ON 83
ci_0035                 6.082585e-03 3 1  ON 84
ci_0036                 6.496813e-03 3 1  ON 85
ci_0037                -1.063988e-02 3 1  ON 86
ci_0038                -9.584373e-03 3 1  ON 87
ci_0039                -2.716496e-03 3 1  ON 88
ci_0040                -2.395550e-03 3 1  ON 89
ci_0041                 7.292051e-03 3 1  ON 90
ci_0042                 6.736439e-03 3 1  ON 91
ci_0043                -1.777393e-02 3 1  ON 92
ci_0044                -1.870051e-02 3 1  ON 93
ci_0045                 7.529718e-03 3 1  ON 94
ci_0046                 7.284326e-03 3 1  ON 95
ci_0047                -1.262047e-03 3 1  ON 96
ci_0048                -1.534610e-03 3 1  ON 97
ci_0049                -5.105257e-03 3 1  ON 98
ci_0050                -6.478221e-03 3 1  ON 99
ci_0051                -3.886214e-03 3 1  ON 100
ci_0052                -3.612283e-03 3 1  ON 101
ci_0053                -4.509644e-03 3 1  ON 102
ci_0054                -4.985908e-03 3 1  ON 103
ci_0055                 6.659081e-03 3 1  ON 104
ci_0056                 6.878010e-03 3 1  ON 105
ci_0057                 4.294214e-03 3 1  ON 106
ci_0058                 4.570703e-03 3 1  ON 107
ci_0059                -4.850802e-03 3 1  ON 108
ci_0060                -4.796777e-03 3 1  ON 109
ci_0061                -4.133992e-03 3 1  ON 110
ci_0062                -3.068756e-03 3 1  ON 111
ci_0063                -8.592045e-03 3 1  ON 112
ci_0064                -8.940560e-03 3 1  ON 113
ci_0065                -5.454243e-03 3 1  ON 114
ci_0066                -5.208296e-03 3 1  ON 115
ci_0067                -4.967930e-03 3 1  ON 116
ci_0068                -4.960490e-03 3 1  ON 117
ci_0069                 4.818521e-03 3 1  ON 118
ci_0070                 4.281388e-03 3 1  ON 119
ci_0071                 2.426983e-04 3 1  ON 120
ci_0072                 2.998179e-04 3 1  ON 121
ci_0073                 3.980889e-03 3 1  ON 122
ci_0074                 3.782732e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8080e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.9317
    reference variance = 0.706024
====================================================
  Execution time = 2.1029e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5250e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4556e-01
  Total weights = 1.951476674e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0283e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328188925666
                                         uncertainty =       0.003138740553

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328188925666
                                         uncertainty =       0.003138740553

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405119050
  error estimate for blocks of size 2^( 2) =       0.000417387868
  error estimate for blocks of size 2^( 3) =       0.000429912683
  error estimate for blocks of size 2^( 4) =       0.000442214375
  error estimate for blocks of size 2^( 5) =       0.000452714693
  error estimate for blocks of size 2^( 6) =       0.000459820978
  error estimate for blocks of size 2^( 7) =       0.000467516255

      target function =                  N/A
              le_mean =     -16.906470096837
             les_mean =     286.174295774735
             stat err =       0.000455566575
             autocorr =       1.264556894358
              std dev =       0.572924855194
             le_variance =       0.328242889699


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690647009684e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e-01, overlap shift 2.3842e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906470096866       residual = 1.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906471652325       residual = 9.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906472289121       residual = 5.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906473974256       residual = 8.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906473050574       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906475870212       residual = 7.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906476393194       residual = 2.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906476592547       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906476319998       residual = 6.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906475968556       residual = 2.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906475861101       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906475892318       residual = 6.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.3842e-01 is 1.217971e-03

solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906470096866       residual = 1.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906470693963       residual = 6.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906470892980       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906471519854       residual = 9.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906471166644       residual = 8.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906472254525       residual = 2.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906472279419       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906472416068       residual = 6.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906472252546       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906472183688       residual = 5.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.5367e-01 is 4.659425e-04

solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906470096866       residual = 1.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906470269213       residual = 6.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906470326119       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906470485544       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906470397952       residual = 7.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906470703937       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906470706316       residual = 9.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906470755773       residual = 4.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906470721460       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906470696229       residual = 3.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e+00 is 1.340024e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.184651 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7074e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
   uu_0                 3.132904e-01 1 1  ON 0
   uu_1                 1.458636e-01 1 1  ON 1
   uu_2                 4.378859e-02 1 1  ON 2
   uu_3                -1.917513e-02 1 1  ON 3
   uu_4                -6.555151e-02 1 1  ON 4
   uu_5                -1.012063e-01 1 1  ON 5
   uu_6                -1.298912e-01 1 1  ON 6
   uu_7                -1.447830e-01 1 1  ON 7
   uu_8                -1.382822e-01 1 1  ON 8
   uu_9                -1.081094e-01 1 1  ON 9
   ud_0                 4.494426e-01 1 1  ON 10
   ud_1                 1.836383e-01 1 1  ON 11
   ud_2                 6.315337e-02 1 1  ON 12
   ud_3                -8.048506e-03 1 1  ON 13
   ud_4                -6.527748e-02 1 1  ON 14
   ud_5                -1.071880e-01 1 1  ON 15
   ud_6                -1.351926e-01 1 1  ON 16
   ud_7                -1.524880e-01 1 1  ON 17
   ud_8                -1.540323e-01 1 1  ON 18
   ud_9                -1.435995e-01 1 1  ON 19
   eO_0                -7.515714e-01 1 1  ON 20
   eO_1                -4.307055e-01 1 1  ON 21
   eO_2                -1.931058e-02 1 1  ON 22
   eO_3                 2.940408e-01 1 1  ON 23
   eO_4                 5.200199e-01 1 1  ON 24
   eO_5                 4.832855e-01 1 1  ON 25
   eO_6                 2.569264e-01 1 1  ON 26
   eO_7                -4.338170e-02 1 1  ON 27
   eO_8                -2.231822e-01 1 1  ON 28
   eO_9                -8.519536e-02 1 1  ON 29
  eH1_0                -2.579370e-01 1 1  ON 30
  eH1_1                -1.502428e-01 1 1  ON 31
  eH1_2                -1.005471e-01 1 1  ON 32
  eH1_3                -4.522858e-02 1 1  ON 33
  eH1_4                 4.823381e-03 1 1  ON 34
  eH1_5                 4.051312e-02 1 1  ON 35
  eH1_6                 1.005039e-01 1 1  ON 36
  eH1_7                 1.573747e-01 1 1  ON 37
  eH1_8                 1.816536e-01 1 1  ON 38
  eH1_9                 7.106327e-02 1 1  ON 39
  eH2_0                -2.551124e-01 1 1  ON 40
  eH2_1                -1.485256e-01 1 1  ON 41
  eH2_2                -9.850641e-02 1 1  ON 42
  eH2_3                -4.298979e-02 1 1  ON 43
  eH2_4                 6.746477e-03 1 1  ON 44
  eH2_5                 4.218330e-02 1 1  ON 45
  eH2_6                 1.028703e-01 1 1  ON 46
  eH2_7                 1.594448e-01 1 1  ON 47
  eH2_8                 1.870492e-01 1 1  ON 48
  eH2_9                 6.145188e-02 1 1  ON 49
ci_0001                 7.014189e-01 3 1  ON 50
ci_0002                 7.005857e-01 3 1  ON 51
ci_0003                -2.736236e-02 3 1  ON 52
ci_0004                -2.711718e-02 3 1  ON 53
ci_0005                -3.581063e-02 3 1  ON 54
ci_0006                -3.587128e-02 3 1  ON 55
ci_0007                -2.245642e-02 3 1  ON 56
ci_0008                -2.171222e-02 3 1  ON 57
ci_0009                -1.751417e-02 3 1  ON 58
ci_0010                -1.698488e-02 3 1  ON 59
ci_0011                -1.245822e-02 3 1  ON 60
ci_0012                -1.202572e-02 3 1  ON 61
ci_0013                 1.306719e-02 3 1  ON 62
ci_0014                 1.275304e-02 3 1  ON 63
ci_0015                 1.297039e-02 3 1  ON 64
ci_0016                 1.301661e-02 3 1  ON 65
ci_0017                 1.094049e-02 3 1  ON 66
ci_0018                 1.146414e-02 3 1  ON 67
ci_0019                 1.170837e-02 3 1  ON 68
ci_0020                 1.122380e-02 3 1  ON 69
ci_0021                -1.299094e-03 3 1  ON 70
ci_0022                -7.195272e-04 3 1  ON 71
ci_0023                -1.120716e-02 3 1  ON 72
ci_0024                -1.153281e-02 3 1  ON 73
ci_0025                -1.042675e-02 3 1  ON 74
ci_0026                -1.057030e-02 3 1  ON 75
ci_0027                -1.115897e-02 3 1  ON 76
ci_0028                -1.128957e-02 3 1  ON 77
ci_0029                -1.059154e-02 3 1  ON 78
ci_0030                -1.103613e-02 3 1  ON 79
ci_0031                 1.991991e-02 3 1  ON 80
ci_0032                 2.128256e-02 3 1  ON 81
ci_0033                 1.030047e-02 3 1  ON 82
ci_0034                 9.568352e-03 3 1  ON 83
ci_0035                 6.113653e-03 3 1  ON 84
ci_0036                 6.435970e-03 3 1  ON 85
ci_0037                -1.040968e-02 3 1  ON 86
ci_0038                -9.806308e-03 3 1  ON 87
ci_0039                -2.568055e-03 3 1  ON 88
ci_0040                -2.428412e-03 3 1  ON 89
ci_0041                 7.315740e-03 3 1  ON 90
ci_0042                 6.790951e-03 3 1  ON 91
ci_0043                -1.784063e-02 3 1  ON 92
ci_0044                -1.866827e-02 3 1  ON 93
ci_0045                 7.394498e-03 3 1  ON 94
ci_0046                 7.477844e-03 3 1  ON 95
ci_0047                -1.463786e-03 3 1  ON 96
ci_0048                -1.574666e-03 3 1  ON 97
ci_0049                -4.815913e-03 3 1  ON 98
ci_0050                -6.468402e-03 3 1  ON 99
ci_0051                -3.739622e-03 3 1  ON 100
ci_0052                -3.638792e-03 3 1  ON 101
ci_0053                -4.560154e-03 3 1  ON 102
ci_0054                -4.883765e-03 3 1  ON 103
ci_0055                 6.927126e-03 3 1  ON 104
ci_0056                 6.762092e-03 3 1  ON 105
ci_0057                 4.239247e-03 3 1  ON 106
ci_0058                 4.658398e-03 3 1  ON 107
ci_0059                -4.809113e-03 3 1  ON 108
ci_0060                -4.870223e-03 3 1  ON 109
ci_0061                -3.880911e-03 3 1  ON 110
ci_0062                -3.269289e-03 3 1  ON 111
ci_0063                -8.465550e-03 3 1  ON 112
ci_0064                -8.920069e-03 3 1  ON 113
ci_0065                -5.268630e-03 3 1  ON 114
ci_0066                -5.333035e-03 3 1  ON 115
ci_0067                -4.889138e-03 3 1  ON 116
ci_0068                -4.808967e-03 3 1  ON 117
ci_0069                 4.835457e-03 3 1  ON 118
ci_0070                 4.201566e-03 3 1  ON 119
ci_0071                 2.066877e-04 3 1  ON 120
ci_0072                 3.199347e-04 3 1  ON 121
ci_0073                 3.994058e-03 3 1  ON 122
ci_0074                 4.043123e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.9509
    reference variance = 0.317577
====================================================
  Execution time = 2.0941e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.2994e-01
  Total weights = 1.9518e+06
  Execution time = 1.9177e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319353391814
                                         uncertainty =       0.002502599155

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319353391814
                                         uncertainty =       0.002502599155

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399600325
  error estimate for blocks of size 2^( 2) =       0.000412283620
  error estimate for blocks of size 2^( 3) =       0.000426168790
  error estimate for blocks of size 2^( 4) =       0.000438123285
  error estimate for blocks of size 2^( 5) =       0.000449396409
  error estimate for blocks of size 2^( 6) =       0.000456580772
  error estimate for blocks of size 2^( 7) =       0.000461569301

      target function =                  N/A
              le_mean =     -16.906348378808
             les_mean =     286.154961868687
             stat err =       0.000451417442
             autocorr =       1.276159641181
              std dev =       0.565120198763
             le_variance =       0.319360839050

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319379772687
                                         uncertainty =       0.002498680066

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319379772687
                                         uncertainty =       0.002498680066

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399616791
  error estimate for blocks of size 2^( 2) =       0.000412304615
  error estimate for blocks of size 2^( 3) =       0.000426193976
  error estimate for blocks of size 2^( 4) =       0.000438147900
  error estimate for blocks of size 2^( 5) =       0.000449429505
  error estimate for blocks of size 2^( 6) =       0.000456612773
  error estimate for blocks of size 2^( 7) =       0.000461604677

      target function =                  N/A
              le_mean =     -16.906357568026
             les_mean =     286.160836490235
             stat err =       0.000451448714
             autocorr =       1.276231278872
              std dev =       0.565143485309
             le_variance =       0.319387158988

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319323234326
                                         uncertainty =       0.002499413082

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319323234326
                                         uncertainty =       0.002499413082

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399581520
  error estimate for blocks of size 2^( 2) =       0.000412271855
  error estimate for blocks of size 2^( 3) =       0.000426158489
  error estimate for blocks of size 2^( 4) =       0.000438113412
  error estimate for blocks of size 2^( 5) =       0.000449403045
  error estimate for blocks of size 2^( 6) =       0.000456589993
  error estimate for blocks of size 2^( 7) =       0.000461564789

      target function =                  N/A
              le_mean =     -16.906353766095
             les_mean =     286.156437197625
             stat err =       0.000451417810
             autocorr =       1.276281839505
              std dev =       0.565093604700
             le_variance =       0.319330782073

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319334768205
                                         uncertainty =       0.002501946139

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319334768205
                                         uncertainty =       0.002501946139

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399588694
  error estimate for blocks of size 2^( 2) =       0.000412273147
  error estimate for blocks of size 2^( 3) =       0.000426158666
  error estimate for blocks of size 2^( 4) =       0.000438113251
  error estimate for blocks of size 2^( 5) =       0.000449389036
  error estimate for blocks of size 2^( 6) =       0.000456574501
  error estimate for blocks of size 2^( 7) =       0.000461560152

      target function =                  N/A
              le_mean =     -16.906347947396
             les_mean =     286.154584725814
             stat err =       0.000451409235
             autocorr =       1.276187525867
              std dev =       0.565103750999
             le_variance =       0.319342249393


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906348378808        initial
     2.3842e-01     2.3842e+00             1.2180e-03       -16.906357568026  <--
     9.5367e-01     9.5367e+00             4.6594e-04       -16.906353766095
     3.8147e+00     3.8147e+01             1.3400e-04       -16.906347947396

*****************************************************************************
Applying the update for shift_i =   2.3842e-01     and shift_s =   2.3842e+00
*****************************************************************************

  Execution time = 3.0670e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
   uu_0                 3.132096e-01 1 1  ON 0
   uu_1                 1.458961e-01 1 1  ON 1
   uu_2                 4.380851e-02 1 1  ON 2
   uu_3                -1.912101e-02 1 1  ON 3
   uu_4                -6.551534e-02 1 1  ON 4
   uu_5                -1.011822e-01 1 1  ON 5
   uu_6                -1.298871e-01 1 1  ON 6
   uu_7                -1.448683e-01 1 1  ON 7
   uu_8                -1.385501e-01 1 1  ON 8
   uu_9                -1.083323e-01 1 1  ON 9
   ud_0                 4.495654e-01 1 1  ON 10
   ud_1                 1.837338e-01 1 1  ON 11
   ud_2                 6.330015e-02 1 1  ON 12
   ud_3                -7.882962e-03 1 1  ON 13
   ud_4                -6.521863e-02 1 1  ON 14
   ud_5                -1.070506e-01 1 1  ON 15
   ud_6                -1.351037e-01 1 1  ON 16
   ud_7                -1.524517e-01 1 1  ON 17
   ud_8                -1.544249e-01 1 1  ON 18
   ud_9                -1.438544e-01 1 1  ON 19
   eO_0                -7.514569e-01 1 1  ON 20
   eO_1                -4.304430e-01 1 1  ON 21
   eO_2                -1.921889e-02 1 1  ON 22
   eO_3                 2.939844e-01 1 1  ON 23
   eO_4                 5.201455e-01 1 1  ON 24
   eO_5                 4.833420e-01 1 1  ON 25
   eO_6                 2.571620e-01 1 1  ON 26
   eO_7                -4.331545e-02 1 1  ON 27
   eO_8                -2.236506e-01 1 1  ON 28
   eO_9                -8.556645e-02 1 1  ON 29
  eH1_0                -2.580929e-01 1 1  ON 30
  eH1_1                -1.504107e-01 1 1  ON 31
  eH1_2                -1.007892e-01 1 1  ON 32
  eH1_3                -4.560257e-02 1 1  ON 33
  eH1_4                 4.612671e-03 1 1  ON 34
  eH1_5                 4.036826e-02 1 1  ON 35
  eH1_6                 1.004277e-01 1 1  ON 36
  eH1_7                 1.575242e-01 1 1  ON 37
  eH1_8                 1.822007e-01 1 1  ON 38
  eH1_9                 7.170963e-02 1 1  ON 39
  eH2_0                -2.555336e-01 1 1  ON 40
  eH2_1                -1.486271e-01 1 1  ON 41
  eH2_2                -9.872097e-02 1 1  ON 42
  eH2_3                -4.330981e-02 1 1  ON 43
  eH2_4                 6.653048e-03 1 1  ON 44
  eH2_5                 4.238322e-02 1 1  ON 45
  eH2_6                 1.031488e-01 1 1  ON 46
  eH2_7                 1.593712e-01 1 1  ON 47
  eH2_8                 1.870668e-01 1 1  ON 48
  eH2_9                 6.203045e-02 1 1  ON 49
ci_0001                 7.012568e-01 3 1  ON 50
ci_0002                 7.007525e-01 3 1  ON 51
ci_0003                -2.741886e-02 3 1  ON 52
ci_0004                -2.700207e-02 3 1  ON 53
ci_0005                -3.592059e-02 3 1  ON 54
ci_0006                -3.565428e-02 3 1  ON 55
ci_0007                -2.205204e-02 3 1  ON 56
ci_0008                -2.191670e-02 3 1  ON 57
ci_0009                -1.744312e-02 3 1  ON 58
ci_0010                -1.667730e-02 3 1  ON 59
ci_0011                -1.235572e-02 3 1  ON 60
ci_0012                -1.203696e-02 3 1  ON 61
ci_0013                 1.305921e-02 3 1  ON 62
ci_0014                 1.273514e-02 3 1  ON 63
ci_0015                 1.301959e-02 3 1  ON 64
ci_0016                 1.324625e-02 3 1  ON 65
ci_0017                 1.073200e-02 3 1  ON 66
ci_0018                 1.169587e-02 3 1  ON 67
ci_0019                 1.154819e-02 3 1  ON 68
ci_0020                 1.143341e-02 3 1  ON 69
ci_0021                -1.171101e-03 3 1  ON 70
ci_0022                -8.170705e-04 3 1  ON 71
ci_0023                -1.108414e-02 3 1  ON 72
ci_0024                -1.149363e-02 3 1  ON 73
ci_0025                -1.071066e-02 3 1  ON 74
ci_0026                -1.030782e-02 3 1  ON 75
ci_0027                -1.128820e-02 3 1  ON 76
ci_0028                -1.156595e-02 3 1  ON 77
ci_0029                -1.059791e-02 3 1  ON 78
ci_0030                -1.028410e-02 3 1  ON 79
ci_0031                 2.024165e-02 3 1  ON 80
ci_0032                 2.145143e-02 3 1  ON 81
ci_0033                 1.050315e-02 3 1  ON 82
ci_0034                 1.033564e-02 3 1  ON 83
ci_0035                 6.179820e-03 3 1  ON 84
ci_0036                 6.330174e-03 3 1  ON 85
ci_0037                -9.996763e-03 3 1  ON 86
ci_0038                -1.020673e-02 3 1  ON 87
ci_0039                -2.393648e-03 3 1  ON 88
ci_0040                -2.466837e-03 3 1  ON 89
ci_0041                 7.349956e-03 3 1  ON 90
ci_0042                 6.871863e-03 3 1  ON 91
ci_0043                -1.799610e-02 3 1  ON 92
ci_0044                -1.860042e-02 3 1  ON 93
ci_0045                 7.147902e-03 3 1  ON 94
ci_0046                 7.849931e-03 3 1  ON 95
ci_0047                -1.706370e-03 3 1  ON 96
ci_0048                -1.622682e-03 3 1  ON 97
ci_0049                -4.355154e-03 3 1  ON 98
ci_0050                -6.456517e-03 3 1  ON 99
ci_0051                -3.546235e-03 3 1  ON 100
ci_0052                -3.673043e-03 3 1  ON 101
ci_0053                -4.621712e-03 3 1  ON 102
ci_0054                -4.743663e-03 3 1  ON 103
ci_0055                 7.412390e-03 3 1  ON 104
ci_0056                 6.546844e-03 3 1  ON 105
ci_0057                 4.146816e-03 3 1  ON 106
ci_0058                 4.804444e-03 3 1  ON 107
ci_0059                -4.751781e-03 3 1  ON 108
ci_0060                -4.969637e-03 3 1  ON 109
ci_0061                -3.458983e-03 3 1  ON 110
ci_0062                -3.593615e-03 3 1  ON 111
ci_0063                -8.292627e-03 3 1  ON 112
ci_0064                -8.896387e-03 3 1  ON 113
ci_0065                -4.988633e-03 3 1  ON 114
ci_0066                -5.522148e-03 3 1  ON 115
ci_0067                -4.788057e-03 3 1  ON 116
ci_0068                -4.622676e-03 3 1  ON 117
ci_0069                 4.856416e-03 3 1  ON 118
ci_0070                 4.099318e-03 3 1  ON 119
ci_0071                 1.469294e-04 3 1  ON 120
ci_0072                 3.307942e-04 3 1  ON 121
ci_0073                 4.006960e-03 3 1  ON 122
ci_0074                 4.376016e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7768e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.878
    reference variance = 0.210512
====================================================
  Execution time = 2.1065e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5255e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3674e-01
  Total weights = 1.951564950e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0858e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323211701715
                                         uncertainty =       0.003078617118

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323211701715
                                         uncertainty =       0.003078617118

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401980809
  error estimate for blocks of size 2^( 2) =       0.000415023343
  error estimate for blocks of size 2^( 3) =       0.000428277564
  error estimate for blocks of size 2^( 4) =       0.000441328599
  error estimate for blocks of size 2^( 5) =       0.000452396017
  error estimate for blocks of size 2^( 6) =       0.000462120834
  error estimate for blocks of size 2^( 7) =       0.000467397732

      target function =                  N/A
              le_mean =     -16.906075461016
             les_mean =     286.152124483853
             stat err =       0.000455810796
             autocorr =       1.285756044611
              std dev =       0.568486711470
             le_variance =       0.323177141118


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690607546102e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e-02, overlap shift 5.9605e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906075460983       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906076974705       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906079884692       residual = 8.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906078593312       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906079588274       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906080018295       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906078705450       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906079200064       residual = 7.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906083100760       residual = 5.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906084430827       residual = 3.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906083929619       residual = 2.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906083745540       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906084113380       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906083890954       residual = 4.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906083953307       residual = 2.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.906084084496       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.906083948275       residual = 6.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.9605e-02 is 3.016050e-03

solving harmonic davidson linear method for identity shift 2.3842e-01, overlap shift 2.3842e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906075460983       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906076395971       residual = 7.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906077149064       residual = 4.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906076127014       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906076106163       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906075781971       residual = 6.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906075664275       residual = 3.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906076244732       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906077210017       residual = 8.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906077264260       residual = 4.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906077111505       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906077224233       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906077158107       residual = 3.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.3842e-01 is 8.059155e-04

solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906075460983       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906075830645       residual = 5.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906075832923       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906075297082       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906075196228       residual = 7.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906074969223       residual = 3.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906075080213       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906075189837       residual = 6.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906075316962       residual = 2.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906075422265       residual = 8.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.5367e-01 is 3.565938e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.197483 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7170e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
   uu_0                 3.133506e-01 1 1  ON 0
   uu_1                 1.460078e-01 1 1  ON 1
   uu_2                 4.366679e-02 1 1  ON 2
   uu_3                -1.922001e-02 1 1  ON 3
   uu_4                -6.541915e-02 1 1  ON 4
   uu_5                -1.010321e-01 1 1  ON 5
   uu_6                -1.295488e-01 1 1  ON 6
   uu_7                -1.444845e-01 1 1  ON 7
   uu_8                -1.387959e-01 1 1  ON 8
   uu_9                -1.090234e-01 1 1  ON 9
   ud_0                 4.499418e-01 1 1  ON 10
   ud_1                 1.841128e-01 1 1  ON 11
   ud_2                 6.341082e-02 1 1  ON 12
   ud_3                -7.887236e-03 1 1  ON 13
   ud_4                -6.507106e-02 1 1  ON 14
   ud_5                -1.069817e-01 1 1  ON 15
   ud_6                -1.351914e-01 1 1  ON 16
   ud_7                -1.524819e-01 1 1  ON 17
   ud_8                -1.544576e-01 1 1  ON 18
   ud_9                -1.442541e-01 1 1  ON 19
   eO_0                -7.516571e-01 1 1  ON 20
   eO_1                -4.307147e-01 1 1  ON 21
   eO_2                -1.896131e-02 1 1  ON 22
   eO_3                 2.943820e-01 1 1  ON 23
   eO_4                 5.202848e-01 1 1  ON 24
   eO_5                 4.836849e-01 1 1  ON 25
   eO_6                 2.577462e-01 1 1  ON 26
   eO_7                -4.301630e-02 1 1  ON 27
   eO_8                -2.243126e-01 1 1  ON 28
   eO_9                -8.630890e-02 1 1  ON 29
  eH1_0                -2.582930e-01 1 1  ON 30
  eH1_1                -1.506648e-01 1 1  ON 31
  eH1_2                -1.010177e-01 1 1  ON 32
  eH1_3                -4.550577e-02 1 1  ON 33
  eH1_4                 4.541294e-03 1 1  ON 34
  eH1_5                 4.013480e-02 1 1  ON 35
  eH1_6                 1.002680e-01 1 1  ON 36
  eH1_7                 1.575574e-01 1 1  ON 37
  eH1_8                 1.827171e-01 1 1  ON 38
  eH1_9                 7.232781e-02 1 1  ON 39
  eH2_0                -2.554710e-01 1 1  ON 40
  eH2_1                -1.485958e-01 1 1  ON 41
  eH2_2                -9.905642e-02 1 1  ON 42
  eH2_3                -4.357796e-02 1 1  ON 43
  eH2_4                 6.139758e-03 1 1  ON 44
  eH2_5                 4.213922e-02 1 1  ON 45
  eH2_6                 1.028982e-01 1 1  ON 46
  eH2_7                 1.595253e-01 1 1  ON 47
  eH2_8                 1.876027e-01 1 1  ON 48
  eH2_9                 6.278517e-02 1 1  ON 49
ci_0001                 7.012194e-01 3 1  ON 50
ci_0002                 7.008474e-01 3 1  ON 51
ci_0003                -2.786895e-02 3 1  ON 52
ci_0004                -2.688066e-02 3 1  ON 53
ci_0005                -3.617727e-02 3 1  ON 54
ci_0006                -3.629161e-02 3 1  ON 55
ci_0007                -2.196833e-02 3 1  ON 56
ci_0008                -2.212108e-02 3 1  ON 57
ci_0009                -1.712408e-02 3 1  ON 58
ci_0010                -1.661072e-02 3 1  ON 59
ci_0011                -1.214714e-02 3 1  ON 60
ci_0012                -1.210968e-02 3 1  ON 61
ci_0013                 1.265626e-02 3 1  ON 62
ci_0014                 1.271320e-02 3 1  ON 63
ci_0015                 1.336615e-02 3 1  ON 64
ci_0016                 1.288101e-02 3 1  ON 65
ci_0017                 1.073928e-02 3 1  ON 66
ci_0018                 1.106156e-02 3 1  ON 67
ci_0019                 1.113419e-02 3 1  ON 68
ci_0020                 1.160239e-02 3 1  ON 69
ci_0021                -1.310641e-03 3 1  ON 70
ci_0022                -7.181206e-04 3 1  ON 71
ci_0023                -1.102566e-02 3 1  ON 72
ci_0024                -1.068772e-02 3 1  ON 73
ci_0025                -1.040841e-02 3 1  ON 74
ci_0026                -1.037819e-02 3 1  ON 75
ci_0027                -1.162977e-02 3 1  ON 76
ci_0028                -1.086873e-02 3 1  ON 77
ci_0029                -1.046673e-02 3 1  ON 78
ci_0030                -9.767675e-03 3 1  ON 79
ci_0031                 2.009904e-02 3 1  ON 80
ci_0032                 2.087299e-02 3 1  ON 81
ci_0033                 1.070252e-02 3 1  ON 82
ci_0034                 9.989691e-03 3 1  ON 83
ci_0035                 6.601819e-03 3 1  ON 84
ci_0036                 6.302392e-03 3 1  ON 85
ci_0037                -9.986970e-03 3 1  ON 86
ci_0038                -1.024221e-02 3 1  ON 87
ci_0039                -2.243833e-03 3 1  ON 88
ci_0040                -2.497354e-03 3 1  ON 89
ci_0041                 7.063977e-03 3 1  ON 90
ci_0042                 7.478312e-03 3 1  ON 91
ci_0043                -1.770799e-02 3 1  ON 92
ci_0044                -1.822010e-02 3 1  ON 93
ci_0045                 6.573525e-03 3 1  ON 94
ci_0046                 7.373945e-03 3 1  ON 95
ci_0047                -1.353101e-03 3 1  ON 96
ci_0048                -1.405779e-03 3 1  ON 97
ci_0049                -4.325645e-03 3 1  ON 98
ci_0050                -5.925139e-03 3 1  ON 99
ci_0051                -3.391727e-03 3 1  ON 100
ci_0052                -3.423209e-03 3 1  ON 101
ci_0053                -4.535110e-03 3 1  ON 102
ci_0054                -4.770022e-03 3 1  ON 103
ci_0055                 7.431466e-03 3 1  ON 104
ci_0056                 6.168971e-03 3 1  ON 105
ci_0057                 4.301781e-03 3 1  ON 106
ci_0058                 5.017830e-03 3 1  ON 107
ci_0059                -4.495158e-03 3 1  ON 108
ci_0060                -4.771686e-03 3 1  ON 109
ci_0061                -3.166535e-03 3 1  ON 110
ci_0062                -3.597693e-03 3 1  ON 111
ci_0063                -8.379700e-03 3 1  ON 112
ci_0064                -8.900522e-03 3 1  ON 113
ci_0065                -5.432364e-03 3 1  ON 114
ci_0066                -5.793962e-03 3 1  ON 115
ci_0067                -4.664618e-03 3 1  ON 116
ci_0068                -4.716166e-03 3 1  ON 117
ci_0069                 4.369378e-03 3 1  ON 118
ci_0070                 4.420288e-03 3 1  ON 119
ci_0071                 3.067606e-04 3 1  ON 120
ci_0072                 5.448047e-04 3 1  ON 121
ci_0073                 4.806809e-03 3 1  ON 122
ci_0074                 4.313442e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.8778
    reference variance = 0.191336
====================================================
  Execution time = 2.0875e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3096e-01
  Total weights = 1.9515e+06
  Execution time = 1.9126e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321153280756
                                         uncertainty =       0.001981040161

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321153280756
                                         uncertainty =       0.001981040161

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400641875
  error estimate for blocks of size 2^( 2) =       0.000413862405
  error estimate for blocks of size 2^( 3) =       0.000427500511
  error estimate for blocks of size 2^( 4) =       0.000440053495
  error estimate for blocks of size 2^( 5) =       0.000452386097
  error estimate for blocks of size 2^( 6) =       0.000460709584
  error estimate for blocks of size 2^( 7) =       0.000466381161

      target function =                  N/A
              le_mean =     -16.905896020732
             les_mean =     286.144029114323
             stat err =       0.000454882584
             autocorr =       1.289098017496
              std dev =       0.566593172586
             le_variance =       0.321027823221

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493217314723
                                         uncertainty =       0.170835190336

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.493217314723
                                         uncertainty =       0.170835190336

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000496303528
  error estimate for blocks of size 2^( 2) =       0.000507086905
  error estimate for blocks of size 2^( 3) =       0.000518439265
  error estimate for blocks of size 2^( 4) =       0.000528796813
  error estimate for blocks of size 2^( 5) =       0.000538945774
  error estimate for blocks of size 2^( 6) =       0.000545967362
  error estimate for blocks of size 2^( 7) =       0.000550233913

      target function =                  N/A
              le_mean =     -16.906158100006
             les_mean =     391.383934748206
             stat err =       0.000540985966
             autocorr =       1.188166417572
              std dev =       0.701879179725
             le_variance =       0.492634382932

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321151940080
                                         uncertainty =       0.001973086538

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321151940080
                                         uncertainty =       0.001973086538

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400640533
  error estimate for blocks of size 2^( 2) =       0.000413909207
  error estimate for blocks of size 2^( 3) =       0.000427602465
  error estimate for blocks of size 2^( 4) =       0.000440222854
  error estimate for blocks of size 2^( 5) =       0.000452612495
  error estimate for blocks of size 2^( 6) =       0.000460954964
  error estimate for blocks of size 2^( 7) =       0.000466527749

      target function =                  N/A
              le_mean =     -16.905875503434
             les_mean =     286.207434888447
             stat err =       0.000455079516
             autocorr =       1.290223071552
              std dev =       0.566591275867
             le_variance =       0.321025673888

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320994841202
                                         uncertainty =       0.001974311128

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320994841202
                                         uncertainty =       0.001974311128

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400542942
  error estimate for blocks of size 2^( 2) =       0.000413773725
  error estimate for blocks of size 2^( 3) =       0.000427425592
  error estimate for blocks of size 2^( 4) =       0.000439990811
  error estimate for blocks of size 2^( 5) =       0.000452332998
  error estimate for blocks of size 2^( 6) =       0.000460662871
  error estimate for blocks of size 2^( 7) =       0.000466307912

      target function =                  N/A
              le_mean =     -16.905881101626
             les_mean =     286.140534107859
             stat err =       0.000454823648
             autocorr =       1.289400715836
              std dev =       0.566453261098
             le_variance =       0.320869297009


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905896020732        initial
     5.9605e-02     5.9605e-01             3.0161e-03       -16.906158100006  <--
     2.3842e-01     2.3842e+00             8.0592e-04       -16.905875503434
     9.5367e-01     9.5367e+00             3.5659e-04       -16.905881101626

*****************************************************************************
Applying the update for shift_i =   5.9605e-02     and shift_s =   5.9605e-01
*****************************************************************************

  Execution time = 3.0553e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
   uu_0                 3.136568e-01 1 1  ON 0
   uu_1                 1.461884e-01 1 1  ON 1
   uu_2                 4.375371e-02 1 1  ON 2
   uu_3                -1.913790e-02 1 1  ON 3
   uu_4                -6.521903e-02 1 1  ON 4
   uu_5                -1.007419e-01 1 1  ON 5
   uu_6                -1.291480e-01 1 1  ON 6
   uu_7                -1.440414e-01 1 1  ON 7
   uu_8                -1.389813e-01 1 1  ON 8
   uu_9                -1.106821e-01 1 1  ON 9
   ud_0                 4.505484e-01 1 1  ON 10
   ud_1                 1.846417e-01 1 1  ON 11
   ud_2                 6.379656e-02 1 1  ON 12
   ud_3                -7.614995e-03 1 1  ON 13
   ud_4                -6.479818e-02 1 1  ON 14
   ud_5                -1.067466e-01 1 1  ON 15
   ud_6                -1.351554e-01 1 1  ON 16
   ud_7                -1.525301e-01 1 1  ON 17
   ud_8                -1.543286e-01 1 1  ON 18
   ud_9                -1.451368e-01 1 1  ON 19
   eO_0                -7.520272e-01 1 1  ON 20
   eO_1                -4.310132e-01 1 1  ON 21
   eO_2                -1.882632e-02 1 1  ON 22
   eO_3                 2.949608e-01 1 1  ON 23
   eO_4                 5.210659e-01 1 1  ON 24
   eO_5                 4.848264e-01 1 1  ON 25
   eO_6                 2.592611e-01 1 1  ON 26
   eO_7                -4.212159e-02 1 1  ON 27
   eO_8                -2.261045e-01 1 1  ON 28
   eO_9                -8.846638e-02 1 1  ON 29
  eH1_0                -2.587128e-01 1 1  ON 30
  eH1_1                -1.512044e-01 1 1  ON 31
  eH1_2                -1.014760e-01 1 1  ON 32
  eH1_3                -4.579268e-02 1 1  ON 33
  eH1_4                 4.247485e-03 1 1  ON 34
  eH1_5                 3.955092e-02 1 1  ON 35
  eH1_6                 9.981782e-02 1 1  ON 36
  eH1_7                 1.575972e-01 1 1  ON 37
  eH1_8                 1.841927e-01 1 1  ON 38
  eH1_9                 7.417680e-02 1 1  ON 39
  eH2_0                -2.557023e-01 1 1  ON 40
  eH2_1                -1.490897e-01 1 1  ON 41
  eH2_2                -9.977865e-02 1 1  ON 42
  eH2_3                -4.428685e-02 1 1  ON 43
  eH2_4                 5.127818e-03 1 1  ON 44
  eH2_5                 4.135876e-02 1 1  ON 45
  eH2_6                 1.023249e-01 1 1  ON 46
  eH2_7                 1.599682e-01 1 1  ON 47
  eH2_8                 1.891872e-01 1 1  ON 48
  eH2_9                 6.504650e-02 1 1  ON 49
ci_0001                 7.010924e-01 3 1  ON 50
ci_0002                 7.010096e-01 3 1  ON 51
ci_0003                -2.820578e-02 3 1  ON 52
ci_0004                -2.683625e-02 3 1  ON 53
ci_0005                -3.640674e-02 3 1  ON 54
ci_0006                -3.692551e-02 3 1  ON 55
ci_0007                -2.186501e-02 3 1  ON 56
ci_0008                -2.240158e-02 3 1  ON 57
ci_0009                -1.692935e-02 3 1  ON 58
ci_0010                -1.660375e-02 3 1  ON 59
ci_0011                -1.200600e-02 3 1  ON 60
ci_0012                -1.218756e-02 3 1  ON 61
ci_0013                 1.237477e-02 3 1  ON 62
ci_0014                 1.273566e-02 3 1  ON 63
ci_0015                 1.359193e-02 3 1  ON 64
ci_0016                 1.267208e-02 3 1  ON 65
ci_0017                 1.075461e-02 3 1  ON 66
ci_0018                 1.069367e-02 3 1  ON 67
ci_0019                 1.085520e-02 3 1  ON 68
ci_0020                 1.174986e-02 3 1  ON 69
ci_0021                -1.504832e-03 3 1  ON 70
ci_0022                -5.629922e-04 3 1  ON 71
ci_0023                -1.101336e-02 3 1  ON 72
ci_0024                -1.021408e-02 3 1  ON 73
ci_0025                -1.021055e-02 3 1  ON 74
ci_0026                -1.042470e-02 3 1  ON 75
ci_0027                -1.185754e-02 3 1  ON 76
ci_0028                -1.042085e-02 3 1  ON 77
ci_0029                -1.036866e-02 3 1  ON 78
ci_0030                -9.434692e-03 3 1  ON 79
ci_0031                 1.993960e-02 3 1  ON 80
ci_0032                 2.031572e-02 3 1  ON 81
ci_0033                 1.091265e-02 3 1  ON 82
ci_0034                 9.601381e-03 3 1  ON 83
ci_0035                 6.900247e-03 3 1  ON 84
ci_0036                 6.284536e-03 3 1  ON 85
ci_0037                -9.982466e-03 3 1  ON 86
ci_0038                -1.025989e-02 3 1  ON 87
ci_0039                -2.175498e-03 3 1  ON 88
ci_0040                -2.510149e-03 3 1  ON 89
ci_0041                 6.891957e-03 3 1  ON 90
ci_0042                 7.882462e-03 3 1  ON 91
ci_0043                -1.728631e-02 3 1  ON 92
ci_0044                -1.772928e-02 3 1  ON 93
ci_0045                 6.051883e-03 3 1  ON 94
ci_0046                 6.957710e-03 3 1  ON 95
ci_0047                -1.197318e-03 3 1  ON 96
ci_0048                -1.308964e-03 3 1  ON 97
ci_0049                -4.292185e-03 3 1  ON 98
ci_0050                -5.574158e-03 3 1  ON 99
ci_0051                -3.317393e-03 3 1  ON 100
ci_0052                -3.307123e-03 3 1  ON 101
ci_0053                -4.500802e-03 3 1  ON 102
ci_0054                -4.787845e-03 3 1  ON 103
ci_0055                 7.451479e-03 3 1  ON 104
ci_0056                 5.840440e-03 3 1  ON 105
ci_0057                 4.421303e-03 3 1  ON 106
ci_0058                 5.178106e-03 3 1  ON 107
ci_0059                -4.360180e-03 3 1  ON 108
ci_0060                -4.689053e-03 3 1  ON 109
ci_0061                -2.959669e-03 3 1  ON 110
ci_0062                -3.597148e-03 3 1  ON 111
ci_0063                -8.410638e-03 3 1  ON 112
ci_0064                -8.907317e-03 3 1  ON 113
ci_0065                -5.715599e-03 3 1  ON 114
ci_0066                -5.960738e-03 3 1  ON 115
ci_0067                -4.613111e-03 3 1  ON 116
ci_0068                -4.762460e-03 3 1  ON 117
ci_0069                 4.140634e-03 3 1  ON 118
ci_0070                 4.579676e-03 3 1  ON 119
ci_0071                 4.036302e-04 3 1  ON 120
ci_0072                 7.123560e-04 3 1  ON 121
ci_0073                 5.172369e-03 3 1  ON 122
ci_0074                 4.293073e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7747e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.9322
    reference variance = 0.322019
====================================================
  Execution time = 2.1179e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5267e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4245e-01
  Total weights = 1.951352955e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1069e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326877655898
                                         uncertainty =       0.002902457142

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326877655898
                                         uncertainty =       0.002902457142

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404276329
  error estimate for blocks of size 2^( 2) =       0.000417524859
  error estimate for blocks of size 2^( 3) =       0.000430349685
  error estimate for blocks of size 2^( 4) =       0.000442922778
  error estimate for blocks of size 2^( 5) =       0.000454357567
  error estimate for blocks of size 2^( 6) =       0.000461916540
  error estimate for blocks of size 2^( 7) =       0.000467937463

      target function =                  N/A
              le_mean =     -16.906611873585
             les_mean =     286.175972559245
             stat err =       0.000456783587
             autocorr =       1.276627966188
              std dev =       0.571733067591
             le_variance =       0.326878700577


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690661187359e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e-02, overlap shift 1.4901e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906611873576       residual = 2.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906652897553       residual = 2.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906661463051       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906664130374       residual = 4.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906663494825       residual = 4.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906669210565       residual = 6.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906666796975       residual = 3.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906667831830       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906668670456       residual = 8.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906667711941       residual = 8.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906666223987       residual = 9.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906667350567       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906665406232       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906671616171       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906673087304       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.906674441194       residual = 8.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.906673963042       residual = 5.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.906673551875       residual = 2.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.906673093381       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.906674188566       residual = 7.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.906674138303       residual = 5.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.906673520999       residual = 4.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.906673779396       residual = 4.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.906674013624       residual = 3.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.906674626926       residual = 2.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.906674758883       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.906675226130       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.906675353296       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.906675225062       residual = 9.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         28 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4901e-02 is 1.697397e-02

solving harmonic davidson linear method for identity shift 5.9605e-02, overlap shift 5.9605e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906611873576       residual = 2.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906646475456       residual = 2.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906652822013       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906655250213       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906654703308       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906657829398       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906656627872       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906657258664       residual = 8.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906658480309       residual = 6.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906657559034       residual = 3.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906657134423       residual = 2.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906657756692       residual = 3.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906657625793       residual = 2.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906658958024       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906658510979       residual = 6.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.906658317488       residual = 2.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.906658186458       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.906658250223       residual = 9.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.9605e-02 is 4.341463e-03

solving harmonic davidson linear method for identity shift 2.3842e-01, overlap shift 2.3842e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906611873576       residual = 2.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906633151539       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906636219413       residual = 9.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906638463732       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906638647463       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906639931207       residual = 7.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906639254840       residual = 5.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906639746795       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906639745952       residual = 9.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906639014483       residual = 4.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906638939400       residual = 3.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906639146049       residual = 1.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906639205046       residual = 6.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.3842e-01 is 1.088081e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.223905 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7319e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
   uu_0                 3.138082e-01 1 1  ON 0
   uu_1                 1.464310e-01 1 1  ON 1
   uu_2                 4.438771e-02 1 1  ON 2
   uu_3                -1.868720e-02 1 1  ON 3
   uu_4                -6.550775e-02 1 1  ON 4
   uu_5                -1.018017e-01 1 1  ON 5
   uu_6                -1.304728e-01 1 1  ON 6
   uu_7                -1.456022e-01 1 1  ON 7
   uu_8                -1.384207e-01 1 1  ON 8
   uu_9                -1.107279e-01 1 1  ON 9
   ud_0                 4.502095e-01 1 1  ON 10
   ud_1                 1.841581e-01 1 1  ON 11
   ud_2                 6.340735e-02 1 1  ON 12
   ud_3                -7.797458e-03 1 1  ON 13
   ud_4                -6.477368e-02 1 1  ON 14
   ud_5                -1.068517e-01 1 1  ON 15
   ud_6                -1.350790e-01 1 1  ON 16
   ud_7                -1.529988e-01 1 1  ON 17
   ud_8                -1.534183e-01 1 1  ON 18
   ud_9                -1.438154e-01 1 1  ON 19
   eO_0                -7.513341e-01 1 1  ON 20
   eO_1                -4.305358e-01 1 1  ON 21
   eO_2                -1.902319e-02 1 1  ON 22
   eO_3                 2.946315e-01 1 1  ON 23
   eO_4                 5.219707e-01 1 1  ON 24
   eO_5                 4.864820e-01 1 1  ON 25
   eO_6                 2.596881e-01 1 1  ON 26
   eO_7                -4.270232e-02 1 1  ON 27
   eO_8                -2.271147e-01 1 1  ON 28
   eO_9                -9.009270e-02 1 1  ON 29
  eH1_0                -2.590880e-01 1 1  ON 30
  eH1_1                -1.519947e-01 1 1  ON 31
  eH1_2                -1.022221e-01 1 1  ON 32
  eH1_3                -4.693855e-02 1 1  ON 33
  eH1_4                 3.021176e-03 1 1  ON 34
  eH1_5                 3.721068e-02 1 1  ON 35
  eH1_6                 9.965350e-02 1 1  ON 36
  eH1_7                 1.586046e-01 1 1  ON 37
  eH1_8                 1.869226e-01 1 1  ON 38
  eH1_9                 7.713755e-02 1 1  ON 39
  eH2_0                -2.575804e-01 1 1  ON 40
  eH2_1                -1.510317e-01 1 1  ON 41
  eH2_2                -1.011814e-01 1 1  ON 42
  eH2_3                -4.540487e-02 1 1  ON 43
  eH2_4                 4.449830e-03 1 1  ON 44
  eH2_5                 4.065255e-02 1 1  ON 45
  eH2_6                 1.022174e-01 1 1  ON 46
  eH2_7                 1.602760e-01 1 1  ON 47
  eH2_8                 1.911794e-01 1 1  ON 48
  eH2_9                 6.938797e-02 1 1  ON 49
ci_0001                 6.998068e-01 3 1  ON 50
ci_0002                 7.019773e-01 3 1  ON 51
ci_0003                -2.691502e-02 3 1  ON 52
ci_0004                -2.828561e-02 3 1  ON 53
ci_0005                -3.712719e-02 3 1  ON 54
ci_0006                -3.806897e-02 3 1  ON 55
ci_0007                -2.251852e-02 3 1  ON 56
ci_0008                -2.296877e-02 3 1  ON 57
ci_0009                -1.608524e-02 3 1  ON 58
ci_0010                -1.727247e-02 3 1  ON 59
ci_0011                -1.246643e-02 3 1  ON 60
ci_0012                -1.178749e-02 3 1  ON 61
ci_0013                 1.307718e-02 3 1  ON 62
ci_0014                 1.402514e-02 3 1  ON 63
ci_0015                 1.445028e-02 3 1  ON 64
ci_0016                 1.302242e-02 3 1  ON 65
ci_0017                 1.030357e-02 3 1  ON 66
ci_0018                 1.089237e-02 3 1  ON 67
ci_0019                 1.143308e-02 3 1  ON 68
ci_0020                 1.110166e-02 3 1  ON 69
ci_0021                -1.339294e-03 3 1  ON 70
ci_0022                -5.884910e-04 3 1  ON 71
ci_0023                -1.059517e-02 3 1  ON 72
ci_0024                -1.138320e-02 3 1  ON 73
ci_0025                -1.025097e-02 3 1  ON 74
ci_0026                -1.074743e-02 3 1  ON 75
ci_0027                -1.241895e-02 3 1  ON 76
ci_0028                -1.160162e-02 3 1  ON 77
ci_0029                -1.077156e-02 3 1  ON 78
ci_0030                -1.116129e-02 3 1  ON 79
ci_0031                 2.137480e-02 3 1  ON 80
ci_0032                 2.057927e-02 3 1  ON 81
ci_0033                 1.021918e-02 3 1  ON 82
ci_0034                 9.488491e-03 3 1  ON 83
ci_0035                 6.644349e-03 3 1  ON 84
ci_0036                 6.497530e-03 3 1  ON 85
ci_0037                -1.092426e-02 3 1  ON 86
ci_0038                -1.020605e-02 3 1  ON 87
ci_0039                -2.202778e-03 3 1  ON 88
ci_0040                -2.460482e-03 3 1  ON 89
ci_0041                 6.014405e-03 3 1  ON 90
ci_0042                 6.744360e-03 3 1  ON 91
ci_0043                -1.713385e-02 3 1  ON 92
ci_0044                -1.843019e-02 3 1  ON 93
ci_0045                 7.616223e-03 3 1  ON 94
ci_0046                 6.819959e-03 3 1  ON 95
ci_0047                -1.674880e-03 3 1  ON 96
ci_0048                -1.837572e-03 3 1  ON 97
ci_0049                -4.923159e-03 3 1  ON 98
ci_0050                -5.965177e-03 3 1  ON 99
ci_0051                -3.567736e-03 3 1  ON 100
ci_0052                -3.306704e-03 3 1  ON 101
ci_0053                -3.772958e-03 3 1  ON 102
ci_0054                -4.538780e-03 3 1  ON 103
ci_0055                 6.975254e-03 3 1  ON 104
ci_0056                 5.600070e-03 3 1  ON 105
ci_0057                 5.750992e-03 3 1  ON 106
ci_0058                 3.988378e-03 3 1  ON 107
ci_0059                -4.230341e-03 3 1  ON 108
ci_0060                -4.654431e-03 3 1  ON 109
ci_0061                -2.521826e-03 3 1  ON 110
ci_0062                -2.994612e-03 3 1  ON 111
ci_0063                -9.433025e-03 3 1  ON 112
ci_0064                -9.407553e-03 3 1  ON 113
ci_0065                -5.514281e-03 3 1  ON 114
ci_0066                -5.421609e-03 3 1  ON 115
ci_0067                -5.428723e-03 3 1  ON 116
ci_0068                -5.149798e-03 3 1  ON 117
ci_0069                 4.837995e-03 3 1  ON 118
ci_0070                 4.187946e-03 3 1  ON 119
ci_0071                 3.621390e-04 3 1  ON 120
ci_0072                 1.260936e-03 3 1  ON 121
ci_0073                 4.446734e-03 3 1  ON 122
ci_0074                 3.834922e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.9464
    reference variance = 0.882156
====================================================
  Execution time = 2.3189e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3220e-01
  Total weights = 1.9516e+06
  Execution time = 1.9100e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320391122775
                                         uncertainty =       0.001751514310

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320391122775
                                         uncertainty =       0.001751514310

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400277803
  error estimate for blocks of size 2^( 2) =       0.000413338933
  error estimate for blocks of size 2^( 3) =       0.000426381140
  error estimate for blocks of size 2^( 4) =       0.000438235550
  error estimate for blocks of size 2^( 5) =       0.000447840414
  error estimate for blocks of size 2^( 6) =       0.000454994578
  error estimate for blocks of size 2^( 7) =       0.000457007259

      target function =                  N/A
              le_mean =     -16.907002544012
             les_mean =     286.191716463628
             stat err =       0.000449519450
             autocorr =       1.261170957190
              std dev =       0.566078297389
             le_variance =       0.320444638775

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320388534071
                                         uncertainty =       0.001738884789

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320388534071
                                         uncertainty =       0.001738884789

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400257657
  error estimate for blocks of size 2^( 2) =       0.000413312349
  error estimate for blocks of size 2^( 3) =       0.000426305596
  error estimate for blocks of size 2^( 4) =       0.000438140373
  error estimate for blocks of size 2^( 5) =       0.000447712242
  error estimate for blocks of size 2^( 6) =       0.000454858634
  error estimate for blocks of size 2^( 7) =       0.000456804548

      target function =                  N/A
              le_mean =     -16.906962967923
             les_mean =     286.186912417509
             stat err =       0.000449378949
             autocorr =       1.260509584465
              std dev =       0.566049806272
             le_variance =       0.320412383180

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321908093999
                                         uncertainty =       0.001855734463

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321908093999
                                         uncertainty =       0.001855734463

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401197416
  error estimate for blocks of size 2^( 2) =       0.000414241684
  error estimate for blocks of size 2^( 3) =       0.000427171745
  error estimate for blocks of size 2^( 4) =       0.000439024366
  error estimate for blocks of size 2^( 5) =       0.000448580459
  error estimate for blocks of size 2^( 6) =       0.000455639918
  error estimate for blocks of size 2^( 7) =       0.000457451103

      target function =                  N/A
              le_mean =     -16.907033117419
             les_mean =     286.259140302142
             stat err =       0.000450173962
             autocorr =       1.259054380826
              std dev =       0.567378827066
             le_variance =       0.321918733403

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320115910038
                                         uncertainty =       0.001746518104

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320115910038
                                         uncertainty =       0.001746518104

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400095736
  error estimate for blocks of size 2^( 2) =       0.000413151776
  error estimate for blocks of size 2^( 3) =       0.000426166342
  error estimate for blocks of size 2^( 4) =       0.000438019173
  error estimate for blocks of size 2^( 5) =       0.000447611115
  error estimate for blocks of size 2^( 6) =       0.000454761589
  error estimate for blocks of size 2^( 7) =       0.000456749831

      target function =                  N/A
              le_mean =     -16.906958838781
             les_mean =     286.178641019122
             stat err =       0.000449285427
             autocorr =       1.261005025474
              std dev =       0.565820816608
             le_variance =       0.320153196507


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.907002544012        initial
     1.4901e-02     1.4901e-01             1.6974e-02       -16.906962967923
     5.9605e-02     5.9605e-01             4.3415e-03       -16.907033117419  <--
     2.3842e-01     2.3842e+00             1.0881e-03       -16.906958838781

*****************************************************************************
Applying the update for shift_i =   5.9605e-02     and shift_s =   5.9605e-01
*****************************************************************************

  Execution time = 3.2838e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
   uu_0                 3.138082e-01 1 1  ON 0
   uu_1                 1.464310e-01 1 1  ON 1
   uu_2                 4.438771e-02 1 1  ON 2
   uu_3                -1.868720e-02 1 1  ON 3
   uu_4                -6.550775e-02 1 1  ON 4
   uu_5                -1.018017e-01 1 1  ON 5
   uu_6                -1.304728e-01 1 1  ON 6
   uu_7                -1.456022e-01 1 1  ON 7
   uu_8                -1.384207e-01 1 1  ON 8
   uu_9                -1.107279e-01 1 1  ON 9
   ud_0                 4.502095e-01 1 1  ON 10
   ud_1                 1.841581e-01 1 1  ON 11
   ud_2                 6.340735e-02 1 1  ON 12
   ud_3                -7.797458e-03 1 1  ON 13
   ud_4                -6.477368e-02 1 1  ON 14
   ud_5                -1.068517e-01 1 1  ON 15
   ud_6                -1.350790e-01 1 1  ON 16
   ud_7                -1.529988e-01 1 1  ON 17
   ud_8                -1.534183e-01 1 1  ON 18
   ud_9                -1.438154e-01 1 1  ON 19
   eO_0                -7.513341e-01 1 1  ON 20
   eO_1                -4.305358e-01 1 1  ON 21
   eO_2                -1.902319e-02 1 1  ON 22
   eO_3                 2.946315e-01 1 1  ON 23
   eO_4                 5.219707e-01 1 1  ON 24
   eO_5                 4.864820e-01 1 1  ON 25
   eO_6                 2.596881e-01 1 1  ON 26
   eO_7                -4.270232e-02 1 1  ON 27
   eO_8                -2.271147e-01 1 1  ON 28
   eO_9                -9.009270e-02 1 1  ON 29
  eH1_0                -2.590880e-01 1 1  ON 30
  eH1_1                -1.519947e-01 1 1  ON 31
  eH1_2                -1.022221e-01 1 1  ON 32
  eH1_3                -4.693855e-02 1 1  ON 33
  eH1_4                 3.021176e-03 1 1  ON 34
  eH1_5                 3.721068e-02 1 1  ON 35
  eH1_6                 9.965350e-02 1 1  ON 36
  eH1_7                 1.586046e-01 1 1  ON 37
  eH1_8                 1.869226e-01 1 1  ON 38
  eH1_9                 7.713755e-02 1 1  ON 39
  eH2_0                -2.575804e-01 1 1  ON 40
  eH2_1                -1.510317e-01 1 1  ON 41
  eH2_2                -1.011814e-01 1 1  ON 42
  eH2_3                -4.540487e-02 1 1  ON 43
  eH2_4                 4.449830e-03 1 1  ON 44
  eH2_5                 4.065255e-02 1 1  ON 45
  eH2_6                 1.022174e-01 1 1  ON 46
  eH2_7                 1.602760e-01 1 1  ON 47
  eH2_8                 1.911794e-01 1 1  ON 48
  eH2_9                 6.938797e-02 1 1  ON 49
ci_0001                 6.998068e-01 3 1  ON 50
ci_0002                 7.019773e-01 3 1  ON 51
ci_0003                -2.691502e-02 3 1  ON 52
ci_0004                -2.828561e-02 3 1  ON 53
ci_0005                -3.712719e-02 3 1  ON 54
ci_0006                -3.806897e-02 3 1  ON 55
ci_0007                -2.251852e-02 3 1  ON 56
ci_0008                -2.296877e-02 3 1  ON 57
ci_0009                -1.608524e-02 3 1  ON 58
ci_0010                -1.727247e-02 3 1  ON 59
ci_0011                -1.246643e-02 3 1  ON 60
ci_0012                -1.178749e-02 3 1  ON 61
ci_0013                 1.307718e-02 3 1  ON 62
ci_0014                 1.402514e-02 3 1  ON 63
ci_0015                 1.445028e-02 3 1  ON 64
ci_0016                 1.302242e-02 3 1  ON 65
ci_0017                 1.030357e-02 3 1  ON 66
ci_0018                 1.089237e-02 3 1  ON 67
ci_0019                 1.143308e-02 3 1  ON 68
ci_0020                 1.110166e-02 3 1  ON 69
ci_0021                -1.339294e-03 3 1  ON 70
ci_0022                -5.884910e-04 3 1  ON 71
ci_0023                -1.059517e-02 3 1  ON 72
ci_0024                -1.138320e-02 3 1  ON 73
ci_0025                -1.025097e-02 3 1  ON 74
ci_0026                -1.074743e-02 3 1  ON 75
ci_0027                -1.241895e-02 3 1  ON 76
ci_0028                -1.160162e-02 3 1  ON 77
ci_0029                -1.077156e-02 3 1  ON 78
ci_0030                -1.116129e-02 3 1  ON 79
ci_0031                 2.137480e-02 3 1  ON 80
ci_0032                 2.057927e-02 3 1  ON 81
ci_0033                 1.021918e-02 3 1  ON 82
ci_0034                 9.488491e-03 3 1  ON 83
ci_0035                 6.644349e-03 3 1  ON 84
ci_0036                 6.497530e-03 3 1  ON 85
ci_0037                -1.092426e-02 3 1  ON 86
ci_0038                -1.020605e-02 3 1  ON 87
ci_0039                -2.202778e-03 3 1  ON 88
ci_0040                -2.460482e-03 3 1  ON 89
ci_0041                 6.014405e-03 3 1  ON 90
ci_0042                 6.744360e-03 3 1  ON 91
ci_0043                -1.713385e-02 3 1  ON 92
ci_0044                -1.843019e-02 3 1  ON 93
ci_0045                 7.616223e-03 3 1  ON 94
ci_0046                 6.819959e-03 3 1  ON 95
ci_0047                -1.674880e-03 3 1  ON 96
ci_0048                -1.837572e-03 3 1  ON 97
ci_0049                -4.923159e-03 3 1  ON 98
ci_0050                -5.965177e-03 3 1  ON 99
ci_0051                -3.567736e-03 3 1  ON 100
ci_0052                -3.306704e-03 3 1  ON 101
ci_0053                -3.772958e-03 3 1  ON 102
ci_0054                -4.538780e-03 3 1  ON 103
ci_0055                 6.975254e-03 3 1  ON 104
ci_0056                 5.600070e-03 3 1  ON 105
ci_0057                 5.750992e-03 3 1  ON 106
ci_0058                 3.988378e-03 3 1  ON 107
ci_0059                -4.230341e-03 3 1  ON 108
ci_0060                -4.654431e-03 3 1  ON 109
ci_0061                -2.521826e-03 3 1  ON 110
ci_0062                -2.994612e-03 3 1  ON 111
ci_0063                -9.433025e-03 3 1  ON 112
ci_0064                -9.407553e-03 3 1  ON 113
ci_0065                -5.514281e-03 3 1  ON 114
ci_0066                -5.421609e-03 3 1  ON 115
ci_0067                -5.428723e-03 3 1  ON 116
ci_0068                -5.149798e-03 3 1  ON 117
ci_0069                 4.837995e-03 3 1  ON 118
ci_0070                 4.187946e-03 3 1  ON 119
ci_0071                 3.621390e-04 3 1  ON 120
ci_0072                 1.260936e-03 3 1  ON 121
ci_0073                 4.446734e-03 3 1  ON 122
ci_0074                 3.834922e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.0172e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.8356
    reference variance = 0.372258
====================================================
  Execution time = 2.1137e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5216e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4243e-01
  Total weights = 1.952025566e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1104e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328950003989
                                         uncertainty =       0.003844820470

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328950003989
                                         uncertainty =       0.003844820470

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405525912
  error estimate for blocks of size 2^( 2) =       0.000417071569
  error estimate for blocks of size 2^( 3) =       0.000429999551
  error estimate for blocks of size 2^( 4) =       0.000441794660
  error estimate for blocks of size 2^( 5) =       0.000452566480
  error estimate for blocks of size 2^( 6) =       0.000460261896
  error estimate for blocks of size 2^( 7) =       0.000466675994

      target function =                  N/A
              le_mean =     -16.905566987460
             les_mean =     286.140620367535
             stat err =       0.000455324757
             autocorr =       1.260681296861
              std dev =       0.573500245022
             le_variance =       0.328902531040


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690556698746e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e-02, overlap shift 1.4901e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905566987427       residual = 2.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905616292374       residual = 2.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905620712696       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905618767693       residual = 3.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905621204070       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905621281973       residual = 7.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905620243841       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905622138859       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905625980253       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905625320456       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905628146281       residual = 9.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905626921910       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905629244141       residual = 9.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905629254112       residual = 9.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.905628458962       residual = 8.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.905629372410       residual = 4.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.905629547704       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.905628813948       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.905628739352       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.905628462334       residual = 5.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.905629442624       residual = 4.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.905630422307       residual = 3.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.905631243557       residual = 2.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.905630966943       residual = 1.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.905630840868       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.905630580702       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.905630483180       residual = 6.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         26 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4901e-02 is 1.533350e-02

solving harmonic davidson linear method for identity shift 5.9605e-02, overlap shift 5.9605e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905566987427       residual = 2.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905607990242       residual = 2.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905611215938       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905609870111       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905611139674       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905611299131       residual = 6.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905610433454       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905611401837       residual = 7.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905613201956       residual = 4.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905612690378       residual = 2.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905613872111       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905613286302       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905613653437       residual = 8.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905613481446       residual = 5.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.905613537510       residual = 3.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.905613654968       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.905613483097       residual = 4.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.9605e-02 is 3.899725e-03

solving harmonic davidson linear method for identity shift 2.3842e-01, overlap shift 2.3842e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905566987427       residual = 2.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905591488089       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905593122313       residual = 5.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905592910379       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905593211787       residual = 6.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905593152914       residual = 6.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905592862127       residual = 3.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905592769018       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905593494060       residual = 8.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905593401185       residual = 2.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905593610480       residual = 1.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905593376603       residual = 5.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.3842e-01 is 9.780968e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.239134 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7266e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
   uu_0                 3.141385e-01 1 1  ON 0
   uu_1                 1.464375e-01 1 1  ON 1
   uu_2                 4.410988e-02 1 1  ON 2
   uu_3                -1.932257e-02 1 1  ON 3
   uu_4                -6.588035e-02 1 1  ON 4
   uu_5                -1.019888e-01 1 1  ON 5
   uu_6                -1.306760e-01 1 1  ON 6
   uu_7                -1.462856e-01 1 1  ON 7
   uu_8                -1.383597e-01 1 1  ON 8
   uu_9                -1.113473e-01 1 1  ON 9
   ud_0                 4.501723e-01 1 1  ON 10
   ud_1                 1.843821e-01 1 1  ON 11
   ud_2                 6.382169e-02 1 1  ON 12
   ud_3                -7.411827e-03 1 1  ON 13
   ud_4                -6.480926e-02 1 1  ON 14
   ud_5                -1.068464e-01 1 1  ON 15
   ud_6                -1.353434e-01 1 1  ON 16
   ud_7                -1.537700e-01 1 1  ON 17
   ud_8                -1.538509e-01 1 1  ON 18
   ud_9                -1.434070e-01 1 1  ON 19
   eO_0                -7.509000e-01 1 1  ON 20
   eO_1                -4.303490e-01 1 1  ON 21
   eO_2                -1.882097e-02 1 1  ON 22
   eO_3                 2.953561e-01 1 1  ON 23
   eO_4                 5.236926e-01 1 1  ON 24
   eO_5                 4.862787e-01 1 1  ON 25
   eO_6                 2.603493e-01 1 1  ON 26
   eO_7                -4.225573e-02 1 1  ON 27
   eO_8                -2.287534e-01 1 1  ON 28
   eO_9                -9.219374e-02 1 1  ON 29
  eH1_0                -2.609460e-01 1 1  ON 30
  eH1_1                -1.531151e-01 1 1  ON 31
  eH1_2                -1.033709e-01 1 1  ON 32
  eH1_3                -4.768352e-02 1 1  ON 33
  eH1_4                 2.367857e-03 1 1  ON 34
  eH1_5                 3.744542e-02 1 1  ON 35
  eH1_6                 1.000394e-01 1 1  ON 36
  eH1_7                 1.584648e-01 1 1  ON 37
  eH1_8                 1.884206e-01 1 1  ON 38
  eH1_9                 8.015851e-02 1 1  ON 39
  eH2_0                -2.588519e-01 1 1  ON 40
  eH2_1                -1.518031e-01 1 1  ON 41
  eH2_2                -1.020109e-01 1 1  ON 42
  eH2_3                -4.634178e-02 1 1  ON 43
  eH2_4                 3.818488e-03 1 1  ON 44
  eH2_5                 4.006368e-02 1 1  ON 45
  eH2_6                 1.017196e-01 1 1  ON 46
  eH2_7                 1.597924e-01 1 1  ON 47
  eH2_8                 1.929823e-01 1 1  ON 48
  eH2_9                 7.328769e-02 1 1  ON 49
ci_0001                 6.998296e-01 3 1  ON 50
ci_0002                 7.019414e-01 3 1  ON 51
ci_0003                -2.723338e-02 3 1  ON 52
ci_0004                -2.829304e-02 3 1  ON 53
ci_0005                -3.647189e-02 3 1  ON 54
ci_0006                -3.794587e-02 3 1  ON 55
ci_0007                -2.238185e-02 3 1  ON 56
ci_0008                -2.277718e-02 3 1  ON 57
ci_0009                -1.719930e-02 3 1  ON 58
ci_0010                -1.712484e-02 3 1  ON 59
ci_0011                -1.165117e-02 3 1  ON 60
ci_0012                -1.199310e-02 3 1  ON 61
ci_0013                 1.386284e-02 3 1  ON 62
ci_0014                 1.364952e-02 3 1  ON 63
ci_0015                 1.320445e-02 3 1  ON 64
ci_0016                 1.431389e-02 3 1  ON 65
ci_0017                 1.079689e-02 3 1  ON 66
ci_0018                 1.077300e-02 3 1  ON 67
ci_0019                 1.166751e-02 3 1  ON 68
ci_0020                 1.095090e-02 3 1  ON 69
ci_0021                -1.533061e-04 3 1  ON 70
ci_0022                -2.412936e-04 3 1  ON 71
ci_0023                -1.096909e-02 3 1  ON 72
ci_0024                -1.181444e-02 3 1  ON 73
ci_0025                -1.003706e-02 3 1  ON 74
ci_0026                -1.045755e-02 3 1  ON 75
ci_0027                -1.084805e-02 3 1  ON 76
ci_0028                -1.084110e-02 3 1  ON 77
ci_0029                -1.089065e-02 3 1  ON 78
ci_0030                -1.091340e-02 3 1  ON 79
ci_0031                 2.001070e-02 3 1  ON 80
ci_0032                 2.103905e-02 3 1  ON 81
ci_0033                 1.001713e-02 3 1  ON 82
ci_0034                 1.049980e-02 3 1  ON 83
ci_0035                 6.370138e-03 3 1  ON 84
ci_0036                 6.652642e-03 3 1  ON 85
ci_0037                -1.052952e-02 3 1  ON 86
ci_0038                -1.131545e-02 3 1  ON 87
ci_0039                -2.701263e-03 3 1  ON 88
ci_0040                -2.884329e-03 3 1  ON 89
ci_0041                 6.836906e-03 3 1  ON 90
ci_0042                 6.472442e-03 3 1  ON 91
ci_0043                -1.941326e-02 3 1  ON 92
ci_0044                -1.951185e-02 3 1  ON 93
ci_0045                 8.617525e-03 3 1  ON 94
ci_0046                 7.449421e-03 3 1  ON 95
ci_0047                -1.621252e-03 3 1  ON 96
ci_0048                -1.916705e-03 3 1  ON 97
ci_0049                -4.574469e-03 3 1  ON 98
ci_0050                -5.018992e-03 3 1  ON 99
ci_0051                -3.222140e-03 3 1  ON 100
ci_0052                -3.016920e-03 3 1  ON 101
ci_0053                -4.816179e-03 3 1  ON 102
ci_0054                -4.092532e-03 3 1  ON 103
ci_0055                 6.497395e-03 3 1  ON 104
ci_0056                 6.647201e-03 3 1  ON 105
ci_0057                 4.085217e-03 3 1  ON 106
ci_0058                 3.914237e-03 3 1  ON 107
ci_0059                -4.865268e-03 3 1  ON 108
ci_0060                -4.863236e-03 3 1  ON 109
ci_0061                -3.728681e-03 3 1  ON 110
ci_0062                -3.650633e-03 3 1  ON 111
ci_0063                -8.566857e-03 3 1  ON 112
ci_0064                -9.130684e-03 3 1  ON 113
ci_0065                -4.832842e-03 3 1  ON 114
ci_0066                -5.346264e-03 3 1  ON 115
ci_0067                -5.347853e-03 3 1  ON 116
ci_0068                -5.126766e-03 3 1  ON 117
ci_0069                 4.709312e-03 3 1  ON 118
ci_0070                 4.567778e-03 3 1  ON 119
ci_0071                 4.183903e-04 3 1  ON 120
ci_0072                 6.165648e-04 3 1  ON 121
ci_0073                 4.329934e-03 3 1  ON 122
ci_0074                 4.006358e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.9275
    reference variance = 0.198607
====================================================
  Execution time = 2.1099e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3621e-01
  Total weights = 1.9516e+06
  Execution time = 1.9125e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.000210177
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354657575029
                                         uncertainty =       0.029471218452

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354657575029
                                         uncertainty =       0.029471218452

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421023239
  error estimate for blocks of size 2^( 2) =       0.000433275684
  error estimate for blocks of size 2^( 3) =       0.000446004908
  error estimate for blocks of size 2^( 4) =       0.000457395494
  error estimate for blocks of size 2^( 5) =       0.000467634257
  error estimate for blocks of size 2^( 6) =       0.000476270434
  error estimate for blocks of size 2^( 7) =       0.000480657263

      target function =                  N/A
              le_mean =     -16.905465729080
             les_mean =     288.145214307484
             stat err =       0.000470489362
             autocorr =       1.248784445671
              std dev =       0.595416774552
             le_variance =       0.354521135418

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00113915
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324127946873
                                         uncertainty =       0.002046795772

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324127946873
                                         uncertainty =       0.002046795772

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402529113
  error estimate for blocks of size 2^( 2) =       0.000415266447
  error estimate for blocks of size 2^( 3) =       0.000428490080
  error estimate for blocks of size 2^( 4) =       0.000440281200
  error estimate for blocks of size 2^( 5) =       0.000450761286
  error estimate for blocks of size 2^( 6) =       0.000459460975
  error estimate for blocks of size 2^( 7) =       0.000463462274

      target function =                  N/A
              le_mean =     -16.905490540683
             les_mean =     286.137080426807
             stat err =       0.000453491434
             autocorr =       1.269239509892
              std dev =       0.569262131069
             le_variance =       0.324059373869

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.000209503
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324623608932
                                         uncertainty =       0.002033878539

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324623608932
                                         uncertainty =       0.002033878539

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402836590
  error estimate for blocks of size 2^( 2) =       0.000415577452
  error estimate for blocks of size 2^( 3) =       0.000428848529
  error estimate for blocks of size 2^( 4) =       0.000440670811
  error estimate for blocks of size 2^( 5) =       0.000451102569
  error estimate for blocks of size 2^( 6) =       0.000459755830
  error estimate for blocks of size 2^( 7) =       0.000463728642

      target function =                  N/A
              le_mean =     -16.905523118084
             les_mean =     286.147161267694
             stat err =       0.000453814463
             autocorr =       1.269108768562
              std dev =       0.569696968338
             le_variance =       0.324554635733

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.000777941
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324166946037
                                         uncertainty =       0.002120047461

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324166946037
                                         uncertainty =       0.002120047461

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402552619
  error estimate for blocks of size 2^( 2) =       0.000415289399
  error estimate for blocks of size 2^( 3) =       0.000428499541
  error estimate for blocks of size 2^( 4) =       0.000440318373
  error estimate for blocks of size 2^( 5) =       0.000450852175
  error estimate for blocks of size 2^( 6) =       0.000459598125
  error estimate for blocks of size 2^( 7) =       0.000463569548

      target function =                  N/A
              le_mean =     -16.905522363234
             les_mean =     286.136186796076
             stat err =       0.000453584555
             autocorr =       1.269612539048
              std dev =       0.569295373901
             le_variance =       0.324097222745


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905465729080        initial
     1.4901e-02     1.4901e-01             1.5334e-02       -16.905490540683
     5.9605e-02     5.9605e-01             3.8997e-03       -16.905523118084  <--
     2.3842e-01     2.3842e+00             9.7810e-04       -16.905522363234

*****************************************************************************
Applying the update for shift_i =   5.9605e-02     and shift_s =   5.9605e-01
*****************************************************************************

  Execution time = 3.0779e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
   uu_0                 3.141385e-01 1 1  ON 0
   uu_1                 1.464375e-01 1 1  ON 1
   uu_2                 4.410988e-02 1 1  ON 2
   uu_3                -1.932257e-02 1 1  ON 3
   uu_4                -6.588035e-02 1 1  ON 4
   uu_5                -1.019888e-01 1 1  ON 5
   uu_6                -1.306760e-01 1 1  ON 6
   uu_7                -1.462856e-01 1 1  ON 7
   uu_8                -1.383597e-01 1 1  ON 8
   uu_9                -1.113473e-01 1 1  ON 9
   ud_0                 4.501723e-01 1 1  ON 10
   ud_1                 1.843821e-01 1 1  ON 11
   ud_2                 6.382169e-02 1 1  ON 12
   ud_3                -7.411827e-03 1 1  ON 13
   ud_4                -6.480926e-02 1 1  ON 14
   ud_5                -1.068464e-01 1 1  ON 15
   ud_6                -1.353434e-01 1 1  ON 16
   ud_7                -1.537700e-01 1 1  ON 17
   ud_8                -1.538509e-01 1 1  ON 18
   ud_9                -1.434070e-01 1 1  ON 19
   eO_0                -7.509000e-01 1 1  ON 20
   eO_1                -4.303490e-01 1 1  ON 21
   eO_2                -1.882097e-02 1 1  ON 22
   eO_3                 2.953561e-01 1 1  ON 23
   eO_4                 5.236926e-01 1 1  ON 24
   eO_5                 4.862787e-01 1 1  ON 25
   eO_6                 2.603493e-01 1 1  ON 26
   eO_7                -4.225573e-02 1 1  ON 27
   eO_8                -2.287534e-01 1 1  ON 28
   eO_9                -9.219374e-02 1 1  ON 29
  eH1_0                -2.609460e-01 1 1  ON 30
  eH1_1                -1.531151e-01 1 1  ON 31
  eH1_2                -1.033709e-01 1 1  ON 32
  eH1_3                -4.768352e-02 1 1  ON 33
  eH1_4                 2.367857e-03 1 1  ON 34
  eH1_5                 3.744542e-02 1 1  ON 35
  eH1_6                 1.000394e-01 1 1  ON 36
  eH1_7                 1.584648e-01 1 1  ON 37
  eH1_8                 1.884206e-01 1 1  ON 38
  eH1_9                 8.015851e-02 1 1  ON 39
  eH2_0                -2.588519e-01 1 1  ON 40
  eH2_1                -1.518031e-01 1 1  ON 41
  eH2_2                -1.020109e-01 1 1  ON 42
  eH2_3                -4.634178e-02 1 1  ON 43
  eH2_4                 3.818488e-03 1 1  ON 44
  eH2_5                 4.006368e-02 1 1  ON 45
  eH2_6                 1.017196e-01 1 1  ON 46
  eH2_7                 1.597924e-01 1 1  ON 47
  eH2_8                 1.929823e-01 1 1  ON 48
  eH2_9                 7.328769e-02 1 1  ON 49
ci_0001                 6.998296e-01 3 1  ON 50
ci_0002                 7.019414e-01 3 1  ON 51
ci_0003                -2.723338e-02 3 1  ON 52
ci_0004                -2.829304e-02 3 1  ON 53
ci_0005                -3.647189e-02 3 1  ON 54
ci_0006                -3.794587e-02 3 1  ON 55
ci_0007                -2.238185e-02 3 1  ON 56
ci_0008                -2.277718e-02 3 1  ON 57
ci_0009                -1.719930e-02 3 1  ON 58
ci_0010                -1.712484e-02 3 1  ON 59
ci_0011                -1.165117e-02 3 1  ON 60
ci_0012                -1.199310e-02 3 1  ON 61
ci_0013                 1.386284e-02 3 1  ON 62
ci_0014                 1.364952e-02 3 1  ON 63
ci_0015                 1.320445e-02 3 1  ON 64
ci_0016                 1.431389e-02 3 1  ON 65
ci_0017                 1.079689e-02 3 1  ON 66
ci_0018                 1.077300e-02 3 1  ON 67
ci_0019                 1.166751e-02 3 1  ON 68
ci_0020                 1.095090e-02 3 1  ON 69
ci_0021                -1.533061e-04 3 1  ON 70
ci_0022                -2.412936e-04 3 1  ON 71
ci_0023                -1.096909e-02 3 1  ON 72
ci_0024                -1.181444e-02 3 1  ON 73
ci_0025                -1.003706e-02 3 1  ON 74
ci_0026                -1.045755e-02 3 1  ON 75
ci_0027                -1.084805e-02 3 1  ON 76
ci_0028                -1.084110e-02 3 1  ON 77
ci_0029                -1.089065e-02 3 1  ON 78
ci_0030                -1.091340e-02 3 1  ON 79
ci_0031                 2.001070e-02 3 1  ON 80
ci_0032                 2.103905e-02 3 1  ON 81
ci_0033                 1.001713e-02 3 1  ON 82
ci_0034                 1.049980e-02 3 1  ON 83
ci_0035                 6.370138e-03 3 1  ON 84
ci_0036                 6.652642e-03 3 1  ON 85
ci_0037                -1.052952e-02 3 1  ON 86
ci_0038                -1.131545e-02 3 1  ON 87
ci_0039                -2.701263e-03 3 1  ON 88
ci_0040                -2.884329e-03 3 1  ON 89
ci_0041                 6.836906e-03 3 1  ON 90
ci_0042                 6.472442e-03 3 1  ON 91
ci_0043                -1.941326e-02 3 1  ON 92
ci_0044                -1.951185e-02 3 1  ON 93
ci_0045                 8.617525e-03 3 1  ON 94
ci_0046                 7.449421e-03 3 1  ON 95
ci_0047                -1.621252e-03 3 1  ON 96
ci_0048                -1.916705e-03 3 1  ON 97
ci_0049                -4.574469e-03 3 1  ON 98
ci_0050                -5.018992e-03 3 1  ON 99
ci_0051                -3.222140e-03 3 1  ON 100
ci_0052                -3.016920e-03 3 1  ON 101
ci_0053                -4.816179e-03 3 1  ON 102
ci_0054                -4.092532e-03 3 1  ON 103
ci_0055                 6.497395e-03 3 1  ON 104
ci_0056                 6.647201e-03 3 1  ON 105
ci_0057                 4.085217e-03 3 1  ON 106
ci_0058                 3.914237e-03 3 1  ON 107
ci_0059                -4.865268e-03 3 1  ON 108
ci_0060                -4.863236e-03 3 1  ON 109
ci_0061                -3.728681e-03 3 1  ON 110
ci_0062                -3.650633e-03 3 1  ON 111
ci_0063                -8.566857e-03 3 1  ON 112
ci_0064                -9.130684e-03 3 1  ON 113
ci_0065                -4.832842e-03 3 1  ON 114
ci_0066                -5.346264e-03 3 1  ON 115
ci_0067                -5.347853e-03 3 1  ON 116
ci_0068                -5.126766e-03 3 1  ON 117
ci_0069                 4.709312e-03 3 1  ON 118
ci_0070                 4.567778e-03 3 1  ON 119
ci_0071                 4.183903e-04 3 1  ON 120
ci_0072                 6.165648e-04 3 1  ON 121
ci_0073                 4.329934e-03 3 1  ON 122
ci_0074                 4.006358e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8060e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.8843
    reference variance = 0.189629
====================================================
  Execution time = 2.1279e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5271e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3642e-01
  Total weights = 1.951685449e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1178e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322170113451
                                         uncertainty =       0.001904603020

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322170113451
                                         uncertainty =       0.001904603020

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401313386
  error estimate for blocks of size 2^( 2) =       0.000414016780
  error estimate for blocks of size 2^( 3) =       0.000427226608
  error estimate for blocks of size 2^( 4) =       0.000439645866
  error estimate for blocks of size 2^( 5) =       0.000450763524
  error estimate for blocks of size 2^( 6) =       0.000458627568
  error estimate for blocks of size 2^( 7) =       0.000461215133

      target function =                  N/A
              le_mean =     -16.906414294118
             les_mean =     286.163264342265
             stat err =       0.000452563023
             autocorr =       1.271718062767
              std dev =       0.567542833838
             le_variance =       0.322104868241


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690641429412e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e-02, overlap shift 1.4901e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906414294147       residual = 2.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906426880237       residual = 2.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906420765335       residual = 2.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906421163361       residual = 4.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906428650741       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906423125047       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906427536590       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906431513644       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906431959456       residual = 7.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906429223610       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906432270389       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906431572950       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906434716872       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906433658301       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906437195575       residual = 7.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.906436879357       residual = 6.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.906439687863       residual = 4.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.906437930663       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.906438031425       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.906438407276       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.906438151423       residual = 7.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.906438255781       residual = 4.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.906437868774       residual = 4.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.906438072032       residual = 2.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.906438360134       residual = 9.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4901e-02 is 1.279408e-02

solving harmonic davidson linear method for identity shift 5.9605e-02, overlap shift 5.9605e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906414294147       residual = 2.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906424812532       residual = 2.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906421276079       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906421162249       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906426556431       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906423378695       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906425437138       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906427740720       residual = 5.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906428752172       residual = 7.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906428126002       residual = 4.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906429630392       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906429400676       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906429458552       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906428666927       residual = 6.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906429013390       residual = 2.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.906428770202       residual = 2.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.906428937737       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.906428691374       residual = 6.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.9605e-02 is 3.263528e-03

solving harmonic davidson linear method for identity shift 2.3842e-01, overlap shift 2.3842e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906414294147       residual = 2.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906420641456       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906420063172       residual = 6.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906420061971       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906422446769       residual = 9.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906421689082       residual = 7.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906422132283       residual = 2.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906423051189       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906423074480       residual = 8.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906422881782       residual = 3.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906422974319       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906422851501       residual = 9.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.3842e-01 is 1.126572e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.260358 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7426e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
   uu_0                 3.137425e-01 1 1  ON 0
   uu_1                 1.462981e-01 1 1  ON 1
   uu_2                 4.416382e-02 1 1  ON 2
   uu_3                -1.904889e-02 1 1  ON 3
   uu_4                -6.571582e-02 1 1  ON 4
   uu_5                -1.019440e-01 1 1  ON 5
   uu_6                -1.311728e-01 1 1  ON 6
   uu_7                -1.467348e-01 1 1  ON 7
   uu_8                -1.397676e-01 1 1  ON 8
   uu_9                -1.121981e-01 1 1  ON 9
   ud_0                 4.508661e-01 1 1  ON 10
   ud_1                 1.850179e-01 1 1  ON 11
   ud_2                 6.454632e-02 1 1  ON 12
   ud_3                -6.807801e-03 1 1  ON 13
   ud_4                -6.448132e-02 1 1  ON 14
   ud_5                -1.068947e-01 1 1  ON 15
   ud_6                -1.355334e-01 1 1  ON 16
   ud_7                -1.538992e-01 1 1  ON 17
   ud_8                -1.549284e-01 1 1  ON 18
   ud_9                -1.436587e-01 1 1  ON 19
   eO_0                -7.497775e-01 1 1  ON 20
   eO_1                -4.293297e-01 1 1  ON 21
   eO_2                -1.834820e-02 1 1  ON 22
   eO_3                 2.952951e-01 1 1  ON 23
   eO_4                 5.235904e-01 1 1  ON 24
   eO_5                 4.873796e-01 1 1  ON 25
   eO_6                 2.610934e-01 1 1  ON 26
   eO_7                -4.252830e-02 1 1  ON 27
   eO_8                -2.301603e-01 1 1  ON 28
   eO_9                -9.437149e-02 1 1  ON 29
  eH1_0                -2.625560e-01 1 1  ON 30
  eH1_1                -1.550834e-01 1 1  ON 31
  eH1_2                -1.051105e-01 1 1  ON 32
  eH1_3                -4.886736e-02 1 1  ON 33
  eH1_4                 1.882042e-03 1 1  ON 34
  eH1_5                 3.810412e-02 1 1  ON 35
  eH1_6                 9.914826e-02 1 1  ON 36
  eH1_7                 1.590090e-01 1 1  ON 37
  eH1_8                 1.914428e-01 1 1  ON 38
  eH1_9                 8.342204e-02 1 1  ON 39
  eH2_0                -2.598693e-01 1 1  ON 40
  eH2_1                -1.530511e-01 1 1  ON 41
  eH2_2                -1.033129e-01 1 1  ON 42
  eH2_3                -4.714427e-02 1 1  ON 43
  eH2_4                 3.647777e-03 1 1  ON 44
  eH2_5                 3.979475e-02 1 1  ON 45
  eH2_6                 1.016395e-01 1 1  ON 46
  eH2_7                 1.600755e-01 1 1  ON 47
  eH2_8                 1.942644e-01 1 1  ON 48
  eH2_9                 7.626859e-02 1 1  ON 49
ci_0001                 6.990974e-01 3 1  ON 50
ci_0002                 7.028413e-01 3 1  ON 51
ci_0003                -2.576960e-02 3 1  ON 52
ci_0004                -2.832158e-02 3 1  ON 53
ci_0005                -3.582345e-02 3 1  ON 54
ci_0006                -3.682216e-02 3 1  ON 55
ci_0007                -1.982919e-02 3 1  ON 56
ci_0008                -2.182030e-02 3 1  ON 57
ci_0009                -1.714494e-02 3 1  ON 58
ci_0010                -1.798544e-02 3 1  ON 59
ci_0011                -1.287868e-02 3 1  ON 60
ci_0012                -1.241790e-02 3 1  ON 61
ci_0013                 1.442424e-02 3 1  ON 62
ci_0014                 1.353126e-02 3 1  ON 63
ci_0015                 1.346968e-02 3 1  ON 64
ci_0016                 1.362278e-02 3 1  ON 65
ci_0017                 1.070461e-02 3 1  ON 66
ci_0018                 1.150507e-02 3 1  ON 67
ci_0019                 1.097196e-02 3 1  ON 68
ci_0020                 1.186949e-02 3 1  ON 69
ci_0021                -8.896767e-04 3 1  ON 70
ci_0022                -1.724185e-03 3 1  ON 71
ci_0023                -1.073307e-02 3 1  ON 72
ci_0024                -1.237119e-02 3 1  ON 73
ci_0025                -1.068753e-02 3 1  ON 74
ci_0026                -1.045506e-02 3 1  ON 75
ci_0027                -1.152078e-02 3 1  ON 76
ci_0028                -1.170028e-02 3 1  ON 77
ci_0029                -1.020966e-02 3 1  ON 78
ci_0030                -1.135767e-02 3 1  ON 79
ci_0031                 2.015982e-02 3 1  ON 80
ci_0032                 2.085621e-02 3 1  ON 81
ci_0033                 9.643332e-03 3 1  ON 82
ci_0034                 1.023344e-02 3 1  ON 83
ci_0035                 6.794711e-03 3 1  ON 84
ci_0036                 6.650437e-03 3 1  ON 85
ci_0037                -1.086070e-02 3 1  ON 86
ci_0038                -1.092757e-02 3 1  ON 87
ci_0039                -2.447712e-03 3 1  ON 88
ci_0040                -2.570300e-03 3 1  ON 89
ci_0041                 7.189035e-03 3 1  ON 90
ci_0042                 7.965872e-03 3 1  ON 91
ci_0043                -1.992510e-02 3 1  ON 92
ci_0044                -1.922074e-02 3 1  ON 93
ci_0045                 8.850858e-03 3 1  ON 94
ci_0046                 6.926790e-03 3 1  ON 95
ci_0047                -2.178817e-03 3 1  ON 96
ci_0048                -1.440402e-03 3 1  ON 97
ci_0049                -4.885117e-03 3 1  ON 98
ci_0050                -5.458604e-03 3 1  ON 99
ci_0051                -3.515152e-03 3 1  ON 100
ci_0052                -3.530054e-03 3 1  ON 101
ci_0053                -5.086416e-03 3 1  ON 102
ci_0054                -4.768155e-03 3 1  ON 103
ci_0055                 6.153792e-03 3 1  ON 104
ci_0056                 5.704952e-03 3 1  ON 105
ci_0057                 4.283792e-03 3 1  ON 106
ci_0058                 4.266882e-03 3 1  ON 107
ci_0059                -4.624623e-03 3 1  ON 108
ci_0060                -4.580162e-03 3 1  ON 109
ci_0061                -3.533572e-03 3 1  ON 110
ci_0062                -3.485408e-03 3 1  ON 111
ci_0063                -8.488505e-03 3 1  ON 112
ci_0064                -9.226043e-03 3 1  ON 113
ci_0065                -5.252580e-03 3 1  ON 114
ci_0066                -4.422322e-03 3 1  ON 115
ci_0067                -5.140919e-03 3 1  ON 116
ci_0068                -4.459575e-03 3 1  ON 117
ci_0069                 3.891239e-03 3 1  ON 118
ci_0070                 4.891473e-03 3 1  ON 119
ci_0071                 6.423157e-04 3 1  ON 120
ci_0072                 1.151570e-03 3 1  ON 121
ci_0073                 4.516569e-03 3 1  ON 122
ci_0074                 3.854555e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.9168
    reference variance = 0.272726
====================================================
  Execution time = 2.1165e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4673e-01
  Total weights = 1.9515e+06
  Execution time = 1.9176e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340247572356
                                         uncertainty =       0.007292788271

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340247572356
                                         uncertainty =       0.007292788271

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412424653
  error estimate for blocks of size 2^( 2) =       0.000425115743
  error estimate for blocks of size 2^( 3) =       0.000438770057
  error estimate for blocks of size 2^( 4) =       0.000452300007
  error estimate for blocks of size 2^( 5) =       0.000462840929
  error estimate for blocks of size 2^( 6) =       0.000472963275
  error estimate for blocks of size 2^( 7) =       0.000478136571

      target function =                  N/A
              le_mean =     -16.906433924155
             les_mean =     286.938292683560
             stat err =       0.000466560196
             autocorr =       1.279752933868
              std dev =       0.583256537336
             le_variance =       0.340188188345

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330817960522
                                         uncertainty =       0.003291624154

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330817960522
                                         uncertainty =       0.003291624154

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406672959
  error estimate for blocks of size 2^( 2) =       0.000419508820
  error estimate for blocks of size 2^( 3) =       0.000433290168
  error estimate for blocks of size 2^( 4) =       0.000446922085
  error estimate for blocks of size 2^( 5) =       0.000457418197
  error estimate for blocks of size 2^( 6) =       0.000467703485
  error estimate for blocks of size 2^( 7) =       0.000473105906

      target function =                  N/A
              le_mean =     -16.906281497355
             les_mean =     286.174409835818
             stat err =       0.000461287418
             autocorr =       1.286626901701
              std dev =       0.575122413876
             le_variance =       0.330765790942

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331332310831
                                         uncertainty =       0.003338187718

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331332310831
                                         uncertainty =       0.003338187718

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406988203
  error estimate for blocks of size 2^( 2) =       0.000419813690
  error estimate for blocks of size 2^( 3) =       0.000433595320
  error estimate for blocks of size 2^( 4) =       0.000447241398
  error estimate for blocks of size 2^( 5) =       0.000457718718
  error estimate for blocks of size 2^( 6) =       0.000467952856
  error estimate for blocks of size 2^( 7) =       0.000473350064

      target function =                  N/A
              le_mean =     -16.906346017284
             les_mean =     286.189847836913
             stat err =       0.000461565759
             autocorr =       1.286185249710
              std dev =       0.575568237027
             le_variance =       0.331278795474

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330799025467
                                         uncertainty =       0.003194132965

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330799025467
                                         uncertainty =       0.003194132965

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406661364
  error estimate for blocks of size 2^( 2) =       0.000419502861
  error estimate for blocks of size 2^( 3) =       0.000433294935
  error estimate for blocks of size 2^( 4) =       0.000446934629
  error estimate for blocks of size 2^( 5) =       0.000457478622
  error estimate for blocks of size 2^( 6) =       0.000467806396
  error estimate for blocks of size 2^( 7) =       0.000473287950

      target function =                  N/A
              le_mean =     -16.906286699478
             les_mean =     286.181289918105
             stat err =       0.000461376899
             autocorr =       1.287199509139
              std dev =       0.575106016586
             le_variance =       0.330746930314


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906433924155        initial  <--
     1.4901e-02     1.4901e-01             1.2794e-02       -16.906281497355
     5.9605e-02     5.9605e-01             3.2635e-03       -16.906346017284
     2.3842e-01     2.3842e+00             1.1266e-03       -16.906286699478

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.8357
  </log>
  <optVariables href="H2O.s027.opt.xml">
   uu_0                 3.141385e-01 1 1  ON 0
   uu_1                 1.464375e-01 1 1  ON 1
   uu_2                 4.410988e-02 1 1  ON 2
   uu_3                -1.932257e-02 1 1  ON 3
   uu_4                -6.588035e-02 1 1  ON 4
   uu_5                -1.019888e-01 1 1  ON 5
   uu_6                -1.306760e-01 1 1  ON 6
   uu_7                -1.462856e-01 1 1  ON 7
   uu_8                -1.383597e-01 1 1  ON 8
   uu_9                -1.113473e-01 1 1  ON 9
   ud_0                 4.501723e-01 1 1  ON 10
   ud_1                 1.843821e-01 1 1  ON 11
   ud_2                 6.382169e-02 1 1  ON 12
   ud_3                -7.411827e-03 1 1  ON 13
   ud_4                -6.480926e-02 1 1  ON 14
   ud_5                -1.068464e-01 1 1  ON 15
   ud_6                -1.353434e-01 1 1  ON 16
   ud_7                -1.537700e-01 1 1  ON 17
   ud_8                -1.538509e-01 1 1  ON 18
   ud_9                -1.434070e-01 1 1  ON 19
   eO_0                -7.509000e-01 1 1  ON 20
   eO_1                -4.303490e-01 1 1  ON 21
   eO_2                -1.882097e-02 1 1  ON 22
   eO_3                 2.953561e-01 1 1  ON 23
   eO_4                 5.236926e-01 1 1  ON 24
   eO_5                 4.862787e-01 1 1  ON 25
   eO_6                 2.603493e-01 1 1  ON 26
   eO_7                -4.225573e-02 1 1  ON 27
   eO_8                -2.287534e-01 1 1  ON 28
   eO_9                -9.219374e-02 1 1  ON 29
  eH1_0                -2.609460e-01 1 1  ON 30
  eH1_1                -1.531151e-01 1 1  ON 31
  eH1_2                -1.033709e-01 1 1  ON 32
  eH1_3                -4.768352e-02 1 1  ON 33
  eH1_4                 2.367857e-03 1 1  ON 34
  eH1_5                 3.744542e-02 1 1  ON 35
  eH1_6                 1.000394e-01 1 1  ON 36
  eH1_7                 1.584648e-01 1 1  ON 37
  eH1_8                 1.884206e-01 1 1  ON 38
  eH1_9                 8.015851e-02 1 1  ON 39
  eH2_0                -2.588519e-01 1 1  ON 40
  eH2_1                -1.518031e-01 1 1  ON 41
  eH2_2                -1.020109e-01 1 1  ON 42
  eH2_3                -4.634178e-02 1 1  ON 43
  eH2_4                 3.818488e-03 1 1  ON 44
  eH2_5                 4.006368e-02 1 1  ON 45
  eH2_6                 1.017196e-01 1 1  ON 46
  eH2_7                 1.597924e-01 1 1  ON 47
  eH2_8                 1.929823e-01 1 1  ON 48
  eH2_9                 7.328769e-02 1 1  ON 49
ci_0001                 6.998296e-01 3 1  ON 50
ci_0002                 7.019414e-01 3 1  ON 51
ci_0003                -2.723338e-02 3 1  ON 52
ci_0004                -2.829304e-02 3 1  ON 53
ci_0005                -3.647189e-02 3 1  ON 54
ci_0006                -3.794587e-02 3 1  ON 55
ci_0007                -2.238185e-02 3 1  ON 56
ci_0008                -2.277718e-02 3 1  ON 57
ci_0009                -1.719930e-02 3 1  ON 58
ci_0010                -1.712484e-02 3 1  ON 59
ci_0011                -1.165117e-02 3 1  ON 60
ci_0012                -1.199310e-02 3 1  ON 61
ci_0013                 1.386284e-02 3 1  ON 62
ci_0014                 1.364952e-02 3 1  ON 63
ci_0015                 1.320445e-02 3 1  ON 64
ci_0016                 1.431389e-02 3 1  ON 65
ci_0017                 1.079689e-02 3 1  ON 66
ci_0018                 1.077300e-02 3 1  ON 67
ci_0019                 1.166751e-02 3 1  ON 68
ci_0020                 1.095090e-02 3 1  ON 69
ci_0021                -1.533061e-04 3 1  ON 70
ci_0022                -2.412936e-04 3 1  ON 71
ci_0023                -1.096909e-02 3 1  ON 72
ci_0024                -1.181444e-02 3 1  ON 73
ci_0025                -1.003706e-02 3 1  ON 74
ci_0026                -1.045755e-02 3 1  ON 75
ci_0027                -1.084805e-02 3 1  ON 76
ci_0028                -1.084110e-02 3 1  ON 77
ci_0029                -1.089065e-02 3 1  ON 78
ci_0030                -1.091340e-02 3 1  ON 79
ci_0031                 2.001070e-02 3 1  ON 80
ci_0032                 2.103905e-02 3 1  ON 81
ci_0033                 1.001713e-02 3 1  ON 82
ci_0034                 1.049980e-02 3 1  ON 83
ci_0035                 6.370138e-03 3 1  ON 84
ci_0036                 6.652642e-03 3 1  ON 85
ci_0037                -1.052952e-02 3 1  ON 86
ci_0038                -1.131545e-02 3 1  ON 87
ci_0039                -2.701263e-03 3 1  ON 88
ci_0040                -2.884329e-03 3 1  ON 89
ci_0041                 6.836906e-03 3 1  ON 90
ci_0042                 6.472442e-03 3 1  ON 91
ci_0043                -1.941326e-02 3 1  ON 92
ci_0044                -1.951185e-02 3 1  ON 93
ci_0045                 8.617525e-03 3 1  ON 94
ci_0046                 7.449421e-03 3 1  ON 95
ci_0047                -1.621252e-03 3 1  ON 96
ci_0048                -1.916705e-03 3 1  ON 97
ci_0049                -4.574469e-03 3 1  ON 98
ci_0050                -5.018992e-03 3 1  ON 99
ci_0051                -3.222140e-03 3 1  ON 100
ci_0052                -3.016920e-03 3 1  ON 101
ci_0053                -4.816179e-03 3 1  ON 102
ci_0054                -4.092532e-03 3 1  ON 103
ci_0055                 6.497395e-03 3 1  ON 104
ci_0056                 6.647201e-03 3 1  ON 105
ci_0057                 4.085217e-03 3 1  ON 106
ci_0058                 3.914237e-03 3 1  ON 107
ci_0059                -4.865268e-03 3 1  ON 108
ci_0060                -4.863236e-03 3 1  ON 109
ci_0061                -3.728681e-03 3 1  ON 110
ci_0062                -3.650633e-03 3 1  ON 111
ci_0063                -8.566857e-03 3 1  ON 112
ci_0064                -9.130684e-03 3 1  ON 113
ci_0065                -4.832842e-03 3 1  ON 114
ci_0066                -5.346264e-03 3 1  ON 115
ci_0067                -5.347853e-03 3 1  ON 116
ci_0068                -5.126766e-03 3 1  ON 117
ci_0069                 4.709312e-03 3 1  ON 118
ci_0070                 4.567778e-03 3 1  ON 119
ci_0071                 4.183903e-04 3 1  ON 120
ci_0072                 6.165648e-04 3 1  ON 121
ci_0073                 4.329934e-03 3 1  ON 122
ci_0074                 4.006358e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8286e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.783
    reference variance = 0.312284
====================================================
  Execution time = 2.1321e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5286e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3113e-01
  Total weights = 1.951907703e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1159e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319382689280
                                         uncertainty =       0.001933284710

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319382689280
                                         uncertainty =       0.001933284710

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399632554
  error estimate for blocks of size 2^( 2) =       0.000412922875
  error estimate for blocks of size 2^( 3) =       0.000426394300
  error estimate for blocks of size 2^( 4) =       0.000439724804
  error estimate for blocks of size 2^( 5) =       0.000450668318
  error estimate for blocks of size 2^( 6) =       0.000459817190
  error estimate for blocks of size 2^( 7) =       0.000464015011

      target function =                  N/A
              le_mean =     -16.906146611181
             les_mean =     286.148922972734
             stat err =       0.000453556331
             autocorr =       1.288073808512
              std dev =       0.565165777749
             le_variance =       0.319412356339


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690614661118e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e-01, overlap shift 1.4901e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906146611183       residual = 1.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906159248738       residual = 9.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906157966752       residual = 5.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906160374457       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906162045621       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906161937874       residual = 7.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906163223572       residual = 4.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906162423605       residual = 3.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906163513917       residual = 2.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906163233185       residual = 8.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906164080452       residual = 4.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906164250910       residual = 2.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906163921868       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906163693085       residual = 4.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4901e-01 is 1.447351e-03

solving harmonic davidson linear method for identity shift 5.9605e-01, overlap shift 5.9605e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906146611183       residual = 1.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906152044730       residual = 6.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906151272259       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906152054694       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906152006059       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906151984602       residual = 4.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906152791465       residual = 2.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906152441420       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906152234281       residual = 3.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906152356321       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906152496044       residual = 5.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.9605e-01 is 4.980660e-04

solving harmonic davidson linear method for identity shift 2.3842e+00, overlap shift 2.3842e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906146611183       residual = 1.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906148267655       residual = 7.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906148016382       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906148095138       residual = 9.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906148150748       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906148089379       residual = 3.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906148274183       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906148263237       residual = 6.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906148207324       residual = 2.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906148178476       residual = 4.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.3842e+00 is 1.550774e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.270977 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7455e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
   uu_0                 3.140025e-01 1 1  ON 0
   uu_1                 1.462548e-01 1 1  ON 1
   uu_2                 4.399951e-02 1 1  ON 2
   uu_3                -1.925242e-02 1 1  ON 3
   uu_4                -6.577542e-02 1 1  ON 4
   uu_5                -1.018471e-01 1 1  ON 5
   uu_6                -1.308260e-01 1 1  ON 6
   uu_7                -1.461224e-01 1 1  ON 7
   uu_8                -1.384927e-01 1 1  ON 8
   uu_9                -1.114633e-01 1 1  ON 9
   ud_0                 4.504391e-01 1 1  ON 10
   ud_1                 1.845521e-01 1 1  ON 11
   ud_2                 6.390064e-02 1 1  ON 12
   ud_3                -7.353306e-03 1 1  ON 13
   ud_4                -6.490438e-02 1 1  ON 14
   ud_5                -1.069541e-01 1 1  ON 15
   ud_6                -1.354117e-01 1 1  ON 16
   ud_7                -1.537804e-01 1 1  ON 17
   ud_8                -1.539550e-01 1 1  ON 18
   ud_9                -1.435366e-01 1 1  ON 19
   eO_0                -7.508660e-01 1 1  ON 20
   eO_1                -4.302922e-01 1 1  ON 21
   eO_2                -1.869361e-02 1 1  ON 22
   eO_3                 2.953963e-01 1 1  ON 23
   eO_4                 5.235238e-01 1 1  ON 24
   eO_5                 4.864455e-01 1 1  ON 25
   eO_6                 2.604306e-01 1 1  ON 26
   eO_7                -4.215947e-02 1 1  ON 27
   eO_8                -2.289480e-01 1 1  ON 28
   eO_9                -9.241816e-02 1 1  ON 29
  eH1_0                -2.609935e-01 1 1  ON 30
  eH1_1                -1.532535e-01 1 1  ON 31
  eH1_2                -1.034253e-01 1 1  ON 32
  eH1_3                -4.778860e-02 1 1  ON 33
  eH1_4                 2.280907e-03 1 1  ON 34
  eH1_5                 3.732953e-02 1 1  ON 35
  eH1_6                 9.995828e-02 1 1  ON 36
  eH1_7                 1.585332e-01 1 1  ON 37
  eH1_8                 1.886203e-01 1 1  ON 38
  eH1_9                 8.048689e-02 1 1  ON 39
  eH2_0                -2.589409e-01 1 1  ON 40
  eH2_1                -1.520835e-01 1 1  ON 41
  eH2_2                -1.022053e-01 1 1  ON 42
  eH2_3                -4.635572e-02 1 1  ON 43
  eH2_4                 3.757295e-03 1 1  ON 44
  eH2_5                 3.998319e-02 1 1  ON 45
  eH2_6                 1.016002e-01 1 1  ON 46
  eH2_7                 1.599609e-01 1 1  ON 47
  eH2_8                 1.932413e-01 1 1  ON 48
  eH2_9                 7.364199e-02 1 1  ON 49
ci_0001                 6.998402e-01 3 1  ON 50
ci_0002                 7.020019e-01 3 1  ON 51
ci_0003                -2.698207e-02 3 1  ON 52
ci_0004                -2.795659e-02 3 1  ON 53
ci_0005                -3.622827e-02 3 1  ON 54
ci_0006                -3.780778e-02 3 1  ON 55
ci_0007                -2.194850e-02 3 1  ON 56
ci_0008                -2.271833e-02 3 1  ON 57
ci_0009                -1.720017e-02 3 1  ON 58
ci_0010                -1.747114e-02 3 1  ON 59
ci_0011                -1.190438e-02 3 1  ON 60
ci_0012                -1.198137e-02 3 1  ON 61
ci_0013                 1.370678e-02 3 1  ON 62
ci_0014                 1.322439e-02 3 1  ON 63
ci_0015                 1.340360e-02 3 1  ON 64
ci_0016                 1.410292e-02 3 1  ON 65
ci_0017                 1.070030e-02 3 1  ON 66
ci_0018                 1.089914e-02 3 1  ON 67
ci_0019                 1.159904e-02 3 1  ON 68
ci_0020                 1.083639e-02 3 1  ON 69
ci_0021                -5.282267e-04 3 1  ON 70
ci_0022                -3.573106e-04 3 1  ON 71
ci_0023                -1.102998e-02 3 1  ON 72
ci_0024                -1.156536e-02 3 1  ON 73
ci_0025                -1.035890e-02 3 1  ON 74
ci_0026                -1.075149e-02 3 1  ON 75
ci_0027                -1.087908e-02 3 1  ON 76
ci_0028                -1.116718e-02 3 1  ON 77
ci_0029                -1.098063e-02 3 1  ON 78
ci_0030                -1.091596e-02 3 1  ON 79
ci_0031                 1.972910e-02 3 1  ON 80
ci_0032                 2.118981e-02 3 1  ON 81
ci_0033                 9.967319e-03 3 1  ON 82
ci_0034                 1.037391e-02 3 1  ON 83
ci_0035                 6.701451e-03 3 1  ON 84
ci_0036                 6.707123e-03 3 1  ON 85
ci_0037                -1.019811e-02 3 1  ON 86
ci_0038                -1.096500e-02 3 1  ON 87
ci_0039                -2.651298e-03 3 1  ON 88
ci_0040                -2.810429e-03 3 1  ON 89
ci_0041                 7.030447e-03 3 1  ON 90
ci_0042                 6.726843e-03 3 1  ON 91
ci_0043                -1.917905e-02 3 1  ON 92
ci_0044                -1.927808e-02 3 1  ON 93
ci_0045                 8.335924e-03 3 1  ON 94
ci_0046                 7.249387e-03 3 1  ON 95
ci_0047                -1.548107e-03 3 1  ON 96
ci_0048                -1.657213e-03 3 1  ON 97
ci_0049                -5.072535e-03 3 1  ON 98
ci_0050                -5.165808e-03 3 1  ON 99
ci_0051                -3.179325e-03 3 1  ON 100
ci_0052                -3.072284e-03 3 1  ON 101
ci_0053                -4.769590e-03 3 1  ON 102
ci_0054                -4.111724e-03 3 1  ON 103
ci_0055                 6.416396e-03 3 1  ON 104
ci_0056                 6.641871e-03 3 1  ON 105
ci_0057                 4.230051e-03 3 1  ON 106
ci_0058                 3.931973e-03 3 1  ON 107
ci_0059                -4.806384e-03 3 1  ON 108
ci_0060                -4.936327e-03 3 1  ON 109
ci_0061                -3.700584e-03 3 1  ON 110
ci_0062                -3.660430e-03 3 1  ON 111
ci_0063                -8.491323e-03 3 1  ON 112
ci_0064                -9.062922e-03 3 1  ON 113
ci_0065                -4.961275e-03 3 1  ON 114
ci_0066                -5.589529e-03 3 1  ON 115
ci_0067                -5.185812e-03 3 1  ON 116
ci_0068                -5.181507e-03 3 1  ON 117
ci_0069                 4.645435e-03 3 1  ON 118
ci_0070                 4.601397e-03 3 1  ON 119
ci_0071                 5.778604e-04 3 1  ON 120
ci_0072                 4.819638e-04 3 1  ON 121
ci_0073                 4.446908e-03 3 1  ON 122
ci_0074                 4.228327e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.9485
    reference variance = 0.220964
====================================================
  Execution time = 2.0925e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4441e-01
  Total weights = 1.9514e+06
  Execution time = 1.9035e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326343560048
                                         uncertainty =       0.005564784751

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326343560048
                                         uncertainty =       0.005564784751

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403946052
  error estimate for blocks of size 2^( 2) =       0.000416851863
  error estimate for blocks of size 2^( 3) =       0.000430019280
  error estimate for blocks of size 2^( 4) =       0.000441904082
  error estimate for blocks of size 2^( 5) =       0.000452728032
  error estimate for blocks of size 2^( 6) =       0.000459238686
  error estimate for blocks of size 2^( 7) =       0.000464273087

      target function =                  N/A
              le_mean =     -16.906205030292
             les_mean =     286.177571896161
             stat err =       0.000454535972
             autocorr =       1.266163479316
              std dev =       0.571265984686
             le_variance =       0.326344825260

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327054092825
                                         uncertainty =       0.005530529124

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327054092825
                                         uncertainty =       0.005530529124

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404386532
  error estimate for blocks of size 2^( 2) =       0.000417268252
  error estimate for blocks of size 2^( 3) =       0.000430456128
  error estimate for blocks of size 2^( 4) =       0.000442304698
  error estimate for blocks of size 2^( 5) =       0.000453144410
  error estimate for blocks of size 2^( 6) =       0.000459651400
  error estimate for blocks of size 2^( 7) =       0.000464737388

      target function =                  N/A
              le_mean =     -16.906230865524
             les_mean =     286.978734590896
             stat err =       0.000454959474
             autocorr =       1.265762022992
              std dev =       0.571888917315
             le_variance =       0.327056933748

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327034333511
                                         uncertainty =       0.005504471151

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327034333511
                                         uncertainty =       0.005504471151

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404373435
  error estimate for blocks of size 2^( 2) =       0.000417261776
  error estimate for blocks of size 2^( 3) =       0.000430425714
  error estimate for blocks of size 2^( 4) =       0.000442281148
  error estimate for blocks of size 2^( 5) =       0.000453102084
  error estimate for blocks of size 2^( 6) =       0.000459620476
  error estimate for blocks of size 2^( 7) =       0.000464726190

      target function =                  N/A
              le_mean =     -16.906227013388
             les_mean =     286.463809285906
             stat err =       0.000454932475
             autocorr =       1.265693776243
              std dev =       0.571870395799
             le_variance =       0.327035749591

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326379962337
                                         uncertainty =       0.005554421500

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326379962337
                                         uncertainty =       0.005554421500

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403968664
  error estimate for blocks of size 2^( 2) =       0.000416873316
  error estimate for blocks of size 2^( 3) =       0.000430041809
  error estimate for blocks of size 2^( 4) =       0.000441916024
  error estimate for blocks of size 2^( 5) =       0.000452751385
  error estimate for blocks of size 2^( 6) =       0.000459277619
  error estimate for blocks of size 2^( 7) =       0.000464312253

      target function =                  N/A
              le_mean =     -16.906206370757
             les_mean =     286.165866390008
             stat err =       0.000454564320
             autocorr =       1.266179655612
              std dev =       0.571297963767
             le_variance =       0.326381363404


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906205030292        initial
     1.4901e-01     1.4901e+00             1.4474e-03       -16.906230865524  <--
     5.9605e-01     5.9605e+00             4.9807e-04       -16.906227013388
     2.3842e+00     2.3842e+01             1.5508e-04       -16.906206370757

*****************************************************************************
Applying the update for shift_i =   1.4901e-01     and shift_s =   1.4901e+00
*****************************************************************************

  Execution time = 3.0529e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
   uu_0                 3.137037e-01 1 1  ON 0
   uu_1                 1.459607e-01 1 1  ON 1
   uu_2                 4.384180e-02 1 1  ON 2
   uu_3                -1.923316e-02 1 1  ON 3
   uu_4                -6.562188e-02 1 1  ON 4
   uu_5                -1.016914e-01 1 1  ON 5
   uu_6                -1.310477e-01 1 1  ON 6
   uu_7                -1.459183e-01 1 1  ON 7
   uu_8                -1.388197e-01 1 1  ON 8
   uu_9                -1.117635e-01 1 1  ON 9
   ud_0                 4.508722e-01 1 1  ON 10
   ud_1                 1.848774e-01 1 1  ON 11
   ud_2                 6.412718e-02 1 1  ON 12
   ud_3                -7.227563e-03 1 1  ON 13
   ud_4                -6.492855e-02 1 1  ON 14
   ud_5                -1.070967e-01 1 1  ON 15
   ud_6                -1.355310e-01 1 1  ON 16
   ud_7                -1.538561e-01 1 1  ON 17
   ud_8                -1.541819e-01 1 1  ON 18
   ud_9                -1.438794e-01 1 1  ON 19
   eO_0                -7.507177e-01 1 1  ON 20
   eO_1                -4.301652e-01 1 1  ON 21
   eO_2                -1.846943e-02 1 1  ON 22
   eO_3                 2.955658e-01 1 1  ON 23
   eO_4                 5.232585e-01 1 1  ON 24
   eO_5                 4.868317e-01 1 1  ON 25
   eO_6                 2.606417e-01 1 1  ON 26
   eO_7                -4.186286e-02 1 1  ON 27
   eO_8                -2.295163e-01 1 1  ON 28
   eO_9                -9.310123e-02 1 1  ON 29
  eH1_0                -2.611941e-01 1 1  ON 30
  eH1_1                -1.535863e-01 1 1  ON 31
  eH1_2                -1.036625e-01 1 1  ON 32
  eH1_3                -4.808805e-02 1 1  ON 33
  eH1_4                 1.982852e-03 1 1  ON 34
  eH1_5                 3.701526e-02 1 1  ON 35
  eH1_6                 9.972734e-02 1 1  ON 36
  eH1_7                 1.587198e-01 1 1  ON 37
  eH1_8                 1.892320e-01 1 1  ON 38
  eH1_9                 8.149924e-02 1 1  ON 39
  eH2_0                -2.593219e-01 1 1  ON 40
  eH2_1                -1.526657e-01 1 1  ON 41
  eH2_2                -1.026513e-01 1 1  ON 42
  eH2_3                -4.663000e-02 1 1  ON 43
  eH2_4                 3.510885e-03 1 1  ON 44
  eH2_5                 3.974002e-02 1 1  ON 45
  eH2_6                 1.012579e-01 1 1  ON 46
  eH2_7                 1.604191e-01 1 1  ON 47
  eH2_8                 1.940265e-01 1 1  ON 48
  eH2_9                 7.473504e-02 1 1  ON 49
ci_0001                 6.998470e-01 3 1  ON 50
ci_0002                 7.021152e-01 3 1  ON 51
ci_0003                -2.663364e-02 3 1  ON 52
ci_0004                -2.752272e-02 3 1  ON 53
ci_0005                -3.581563e-02 3 1  ON 54
ci_0006                -3.761563e-02 3 1  ON 55
ci_0007                -2.110761e-02 3 1  ON 56
ci_0008                -2.262974e-02 3 1  ON 57
ci_0009                -1.720885e-02 3 1  ON 58
ci_0010                -1.787515e-02 3 1  ON 59
ci_0011                -1.221948e-02 3 1  ON 60
ci_0012                -1.198972e-02 3 1  ON 61
ci_0013                 1.349622e-02 3 1  ON 62
ci_0014                 1.268299e-02 3 1  ON 63
ci_0015                 1.365492e-02 3 1  ON 64
ci_0016                 1.382726e-02 3 1  ON 65
ci_0017                 1.057655e-02 3 1  ON 66
ci_0018                 1.105336e-02 3 1  ON 67
ci_0019                 1.152402e-02 3 1  ON 68
ci_0020                 1.071373e-02 3 1  ON 69
ci_0021                -1.256563e-03 3 1  ON 70
ci_0022                -6.150338e-04 3 1  ON 71
ci_0023                -1.110624e-02 3 1  ON 72
ci_0024                -1.127100e-02 3 1  ON 73
ci_0025                -1.074088e-02 3 1  ON 74
ci_0026                -1.112139e-02 3 1  ON 75
ci_0027                -1.092204e-02 3 1  ON 76
ci_0028                -1.160071e-02 3 1  ON 77
ci_0029                -1.108910e-02 3 1  ON 78
ci_0030                -1.092661e-02 3 1  ON 79
ci_0031                 1.922273e-02 3 1  ON 80
ci_0032                 2.146625e-02 3 1  ON 81
ci_0033                 9.881650e-03 3 1  ON 82
ci_0034                 1.014893e-02 3 1  ON 83
ci_0035                 7.118906e-03 3 1  ON 84
ci_0036                 6.795956e-03 3 1  ON 85
ci_0037                -9.736854e-03 3 1  ON 86
ci_0038                -1.047197e-02 3 1  ON 87
ci_0039                -2.602068e-03 3 1  ON 88
ci_0040                -2.741145e-03 3 1  ON 89
ci_0041                 7.254243e-03 3 1  ON 90
ci_0042                 7.048457e-03 3 1  ON 91
ci_0043                -1.875250e-02 3 1  ON 92
ci_0044                -1.886924e-02 3 1  ON 93
ci_0045                 7.896596e-03 3 1  ON 94
ci_0046                 6.938298e-03 3 1  ON 95
ci_0047                -1.485499e-03 3 1  ON 96
ci_0048                -1.414719e-03 3 1  ON 97
ci_0049                -5.699792e-03 3 1  ON 98
ci_0050                -5.348962e-03 3 1  ON 99
ci_0051                -3.136528e-03 3 1  ON 100
ci_0052                -3.118728e-03 3 1  ON 101
ci_0053                -4.735466e-03 3 1  ON 102
ci_0054                -4.121060e-03 3 1  ON 103
ci_0055                 6.297837e-03 3 1  ON 104
ci_0056                 6.625409e-03 3 1  ON 105
ci_0057                 4.426612e-03 3 1  ON 106
ci_0058                 3.937659e-03 3 1  ON 107
ci_0059                -4.743185e-03 3 1  ON 108
ci_0060                -5.010292e-03 3 1  ON 109
ci_0061                -3.659500e-03 3 1  ON 110
ci_0062                -3.682024e-03 3 1  ON 111
ci_0063                -8.420394e-03 3 1  ON 112
ci_0064                -9.009311e-03 3 1  ON 113
ci_0065                -5.103207e-03 3 1  ON 114
ci_0066                -5.878464e-03 3 1  ON 115
ci_0067                -5.039075e-03 3 1  ON 116
ci_0068                -5.231895e-03 3 1  ON 117
ci_0069                 4.587189e-03 3 1  ON 118
ci_0070                 4.631029e-03 3 1  ON 119
ci_0071                 7.563775e-04 3 1  ON 120
ci_0072                 3.032592e-04 3 1  ON 121
ci_0073                 4.556675e-03 3 1  ON 122
ci_0074                 4.432451e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8008e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.9477
    reference variance = 0.26409
====================================================
  Execution time = 2.1136e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5237e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4130e-01
  Total weights = 1.951570170e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1040e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327301548044
                                         uncertainty =       0.003115872437

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327301548044
                                         uncertainty =       0.003115872437

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404539253
  error estimate for blocks of size 2^( 2) =       0.000417297899
  error estimate for blocks of size 2^( 3) =       0.000430765949
  error estimate for blocks of size 2^( 4) =       0.000443297625
  error estimate for blocks of size 2^( 5) =       0.000454136076
  error estimate for blocks of size 2^( 6) =       0.000460288680
  error estimate for blocks of size 2^( 7) =       0.000464062608

      target function =                  N/A
              le_mean =     -16.906643429392
             les_mean =     286.175891608476
             stat err =       0.000455446247
             autocorr =       1.267514446698
              std dev =       0.572104898731
             le_variance =       0.327304015152


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690664342939e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e-02, overlap shift 3.7253e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906643429402       residual = 3.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906658148292       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906653012519       residual = 9.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906654290151       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906653444981       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906654726800       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906654452460       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906656351510       residual = 7.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906658634961       residual = 8.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906661389760       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906659731939       residual = 5.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906660599253       residual = 3.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906660416379       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906661464055       residual = 9.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906661357060       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.906661513817       residual = 7.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.906661384000       residual = 2.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.906661032859       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.906660708763       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.906660745806       residual = 7.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         19 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.7253e-02 is 5.780839e-03

solving harmonic davidson linear method for identity shift 1.4901e-01, overlap shift 1.4901e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906643429402       residual = 3.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906654013503       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906651640146       residual = 8.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906652187201       residual = 9.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906651632012       residual = 9.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906652525375       residual = 7.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906652685468       residual = 5.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906653854543       residual = 3.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906654740091       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906655150424       residual = 6.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906654435326       residual = 4.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906654436490       residual = 2.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906654185247       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906654301804       residual = 3.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4901e-01 is 2.190619e-03

solving harmonic davidson linear method for identity shift 5.9605e-01, overlap shift 5.9605e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906643429402       residual = 3.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906648413272       residual = 8.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906647949073       residual = 4.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906648233556       residual = 7.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906647854970       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906648104332       residual = 3.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906648175473       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906648477288       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906648601991       residual = 2.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906648719130       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906648654340       residual = 2.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.9605e-01 is 9.385141e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.286265 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7262e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
   uu_0                 3.134457e-01 1 1  ON 0
   uu_1                 1.458427e-01 1 1  ON 1
   uu_2                 4.383362e-02 1 1  ON 2
   uu_3                -1.910473e-02 1 1  ON 3
   uu_4                -6.563155e-02 1 1  ON 4
   uu_5                -1.017283e-01 1 1  ON 5
   uu_6                -1.309607e-01 1 1  ON 6
   uu_7                -1.460001e-01 1 1  ON 7
   uu_8                -1.388103e-01 1 1  ON 8
   uu_9                -1.123017e-01 1 1  ON 9
   ud_0                 4.508458e-01 1 1  ON 10
   ud_1                 1.852106e-01 1 1  ON 11
   ud_2                 6.450332e-02 1 1  ON 12
   ud_3                -6.984961e-03 1 1  ON 13
   ud_4                -6.468818e-02 1 1  ON 14
   ud_5                -1.072473e-01 1 1  ON 15
   ud_6                -1.355133e-01 1 1  ON 16
   ud_7                -1.533108e-01 1 1  ON 17
   ud_8                -1.542789e-01 1 1  ON 18
   ud_9                -1.445494e-01 1 1  ON 19
   eO_0                -7.507340e-01 1 1  ON 20
   eO_1                -4.301014e-01 1 1  ON 21
   eO_2                -1.865145e-02 1 1  ON 22
   eO_3                 2.956052e-01 1 1  ON 23
   eO_4                 5.235536e-01 1 1  ON 24
   eO_5                 4.877599e-01 1 1  ON 25
   eO_6                 2.613428e-01 1 1  ON 26
   eO_7                -4.180230e-02 1 1  ON 27
   eO_8                -2.301178e-01 1 1  ON 28
   eO_9                -9.416546e-02 1 1  ON 29
  eH1_0                -2.613792e-01 1 1  ON 30
  eH1_1                -1.539954e-01 1 1  ON 31
  eH1_2                -1.040055e-01 1 1  ON 32
  eH1_3                -4.871210e-02 1 1  ON 33
  eH1_4                 1.889307e-03 1 1  ON 34
  eH1_5                 3.753335e-02 1 1  ON 35
  eH1_6                 9.923482e-02 1 1  ON 36
  eH1_7                 1.587868e-01 1 1  ON 37
  eH1_8                 1.899847e-01 1 1  ON 38
  eH1_9                 8.246078e-02 1 1  ON 39
  eH2_0                -2.600277e-01 1 1  ON 40
  eH2_1                -1.531748e-01 1 1  ON 41
  eH2_2                -1.030452e-01 1 1  ON 42
  eH2_3                -4.737306e-02 1 1  ON 43
  eH2_4                 3.091001e-03 1 1  ON 44
  eH2_5                 3.993172e-02 1 1  ON 45
  eH2_6                 1.010914e-01 1 1  ON 46
  eH2_7                 1.606047e-01 1 1  ON 47
  eH2_8                 1.947456e-01 1 1  ON 48
  eH2_9                 7.617450e-02 1 1  ON 49
ci_0001                 6.994678e-01 3 1  ON 50
ci_0002                 7.024242e-01 3 1  ON 51
ci_0003                -2.735641e-02 3 1  ON 52
ci_0004                -2.729479e-02 3 1  ON 53
ci_0005                -3.609703e-02 3 1  ON 54
ci_0006                -3.725660e-02 3 1  ON 55
ci_0007                -2.076143e-02 3 1  ON 56
ci_0008                -2.255888e-02 3 1  ON 57
ci_0009                -1.843597e-02 3 1  ON 58
ci_0010                -1.801655e-02 3 1  ON 59
ci_0011                -1.200401e-02 3 1  ON 60
ci_0012                -1.216458e-02 3 1  ON 61
ci_0013                 1.328873e-02 3 1  ON 62
ci_0014                 1.348872e-02 3 1  ON 63
ci_0015                 1.365314e-02 3 1  ON 64
ci_0016                 1.370638e-02 3 1  ON 65
ci_0017                 1.029713e-02 3 1  ON 66
ci_0018                 1.086470e-02 3 1  ON 67
ci_0019                 1.072939e-02 3 1  ON 68
ci_0020                 1.146442e-02 3 1  ON 69
ci_0021                -1.466091e-03 3 1  ON 70
ci_0022                -8.850364e-04 3 1  ON 71
ci_0023                -1.089796e-02 3 1  ON 72
ci_0024                -1.187317e-02 3 1  ON 73
ci_0025                -1.066736e-02 3 1  ON 74
ci_0026                -1.048769e-02 3 1  ON 75
ci_0027                -1.082525e-02 3 1  ON 76
ci_0028                -1.149360e-02 3 1  ON 77
ci_0029                -1.142544e-02 3 1  ON 78
ci_0030                -1.130159e-02 3 1  ON 79
ci_0031                 1.915485e-02 3 1  ON 80
ci_0032                 2.142884e-02 3 1  ON 81
ci_0033                 1.006349e-02 3 1  ON 82
ci_0034                 1.072027e-02 3 1  ON 83
ci_0035                 7.056820e-03 3 1  ON 84
ci_0036                 6.788283e-03 3 1  ON 85
ci_0037                -1.192747e-02 3 1  ON 86
ci_0038                -1.082047e-02 3 1  ON 87
ci_0039                -2.707752e-03 3 1  ON 88
ci_0040                -2.094305e-03 3 1  ON 89
ci_0041                 7.007203e-03 3 1  ON 90
ci_0042                 7.247739e-03 3 1  ON 91
ci_0043                -1.858741e-02 3 1  ON 92
ci_0044                -1.885048e-02 3 1  ON 93
ci_0045                 7.177102e-03 3 1  ON 94
ci_0046                 7.345872e-03 3 1  ON 95
ci_0047                -1.844167e-03 3 1  ON 96
ci_0048                -1.894523e-03 3 1  ON 97
ci_0049                -5.935413e-03 3 1  ON 98
ci_0050                -5.303723e-03 3 1  ON 99
ci_0051                -3.198402e-03 3 1  ON 100
ci_0052                -3.158280e-03 3 1  ON 101
ci_0053                -4.093689e-03 3 1  ON 102
ci_0054                -4.676980e-03 3 1  ON 103
ci_0055                 5.743773e-03 3 1  ON 104
ci_0056                 6.815872e-03 3 1  ON 105
ci_0057                 3.117643e-03 3 1  ON 106
ci_0058                 3.846741e-03 3 1  ON 107
ci_0059                -4.908857e-03 3 1  ON 108
ci_0060                -4.988935e-03 3 1  ON 109
ci_0061                -3.904746e-03 3 1  ON 110
ci_0062                -3.335227e-03 3 1  ON 111
ci_0063                -9.858889e-03 3 1  ON 112
ci_0064                -9.212384e-03 3 1  ON 113
ci_0065                -5.833566e-03 3 1  ON 114
ci_0066                -4.966400e-03 3 1  ON 115
ci_0067                -5.086995e-03 3 1  ON 116
ci_0068                -4.974626e-03 3 1  ON 117
ci_0069                 4.147084e-03 3 1  ON 118
ci_0070                 4.157090e-03 3 1  ON 119
ci_0071                 1.152726e-03 3 1  ON 120
ci_0072                 1.408305e-04 3 1  ON 121
ci_0073                 4.017622e-03 3 1  ON 122
ci_0074                 4.932138e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.9479
    reference variance = 0.264955
====================================================
  Execution time = 2.0953e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3571e-01
  Total weights = 1.9518e+06
  Execution time = 1.9077e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325862097642
                                         uncertainty =       0.002736215040

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325862097642
                                         uncertainty =       0.002736215040

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403640666
  error estimate for blocks of size 2^( 2) =       0.000415863023
  error estimate for blocks of size 2^( 3) =       0.000428911968
  error estimate for blocks of size 2^( 4) =       0.000440054118
  error estimate for blocks of size 2^( 5) =       0.000450349450
  error estimate for blocks of size 2^( 6) =       0.000457217713
  error estimate for blocks of size 2^( 7) =       0.000461899674

      target function =                  N/A
              le_mean =     -16.906771933249
             les_mean =     286.196685078866
             stat err =       0.000452380239
             autocorr =       1.256080352671
              std dev =       0.570834104564
             le_variance =       0.325851574933

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324544019274
                                         uncertainty =       0.002765200740

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324544019274
                                         uncertainty =       0.002765200740

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402823017
  error estimate for blocks of size 2^( 2) =       0.000415049109
  error estimate for blocks of size 2^( 3) =       0.000428107828
  error estimate for blocks of size 2^( 4) =       0.000439250263
  error estimate for blocks of size 2^( 5) =       0.000449591202
  error estimate for blocks of size 2^( 6) =       0.000456382236
  error estimate for blocks of size 2^( 7) =       0.000461089726

      target function =                  N/A
              le_mean =     -16.906735832250
             les_mean =     286.174401670200
             stat err =       0.000451578357
             autocorr =       1.256717558630
              std dev =       0.569677773185
             le_variance =       0.324532765260

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324407105994
                                         uncertainty =       0.002807518340

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324407105994
                                         uncertainty =       0.002807518340

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402737949
  error estimate for blocks of size 2^( 2) =       0.000414958464
  error estimate for blocks of size 2^( 3) =       0.000428025147
  error estimate for blocks of size 2^( 4) =       0.000439166269
  error estimate for blocks of size 2^( 5) =       0.000449550102
  error estimate for blocks of size 2^( 6) =       0.000456332144
  error estimate for blocks of size 2^( 7) =       0.000461012608

      target function =                  N/A
              le_mean =     -16.906763096737
             les_mean =     286.180821277116
             stat err =       0.000451515281
             autocorr =       1.256897312113
              std dev =       0.569557469701
             le_variance =       0.324395711292

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325111894446
                                         uncertainty =       0.002736855322

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325111894446
                                         uncertainty =       0.002736855322

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403176020
  error estimate for blocks of size 2^( 2) =       0.000415411113
  error estimate for blocks of size 2^( 3) =       0.000428468302
  error estimate for blocks of size 2^( 4) =       0.000439627562
  error estimate for blocks of size 2^( 5) =       0.000449921169
  error estimate for blocks of size 2^( 6) =       0.000456761478
  error estimate for blocks of size 2^( 7) =       0.000461502725

      target function =                  N/A
              le_mean =     -16.906738374575
             les_mean =     286.176969442798
             stat err =       0.000451953234
             autocorr =       1.256601603002
              std dev =       0.570176995447
             le_variance =       0.325101806137


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906771933249        initial  <--
     3.7253e-02     3.7253e-01             5.7808e-03       -16.906735832250
     1.4901e-01     1.4901e+00             2.1906e-03       -16.906763096737
     5.9605e-01     5.9605e+00             9.3851e-04       -16.906738374575

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.5990
  </log>
  <optVariables href="H2O.s029.opt.xml">
   uu_0                 3.137037e-01 1 1  ON 0
   uu_1                 1.459607e-01 1 1  ON 1
   uu_2                 4.384180e-02 1 1  ON 2
   uu_3                -1.923316e-02 1 1  ON 3
   uu_4                -6.562188e-02 1 1  ON 4
   uu_5                -1.016914e-01 1 1  ON 5
   uu_6                -1.310477e-01 1 1  ON 6
   uu_7                -1.459183e-01 1 1  ON 7
   uu_8                -1.388197e-01 1 1  ON 8
   uu_9                -1.117635e-01 1 1  ON 9
   ud_0                 4.508722e-01 1 1  ON 10
   ud_1                 1.848774e-01 1 1  ON 11
   ud_2                 6.412718e-02 1 1  ON 12
   ud_3                -7.227563e-03 1 1  ON 13
   ud_4                -6.492855e-02 1 1  ON 14
   ud_5                -1.070967e-01 1 1  ON 15
   ud_6                -1.355310e-01 1 1  ON 16
   ud_7                -1.538561e-01 1 1  ON 17
   ud_8                -1.541819e-01 1 1  ON 18
   ud_9                -1.438794e-01 1 1  ON 19
   eO_0                -7.507177e-01 1 1  ON 20
   eO_1                -4.301652e-01 1 1  ON 21
   eO_2                -1.846943e-02 1 1  ON 22
   eO_3                 2.955658e-01 1 1  ON 23
   eO_4                 5.232585e-01 1 1  ON 24
   eO_5                 4.868317e-01 1 1  ON 25
   eO_6                 2.606417e-01 1 1  ON 26
   eO_7                -4.186286e-02 1 1  ON 27
   eO_8                -2.295163e-01 1 1  ON 28
   eO_9                -9.310123e-02 1 1  ON 29
  eH1_0                -2.611941e-01 1 1  ON 30
  eH1_1                -1.535863e-01 1 1  ON 31
  eH1_2                -1.036625e-01 1 1  ON 32
  eH1_3                -4.808805e-02 1 1  ON 33
  eH1_4                 1.982852e-03 1 1  ON 34
  eH1_5                 3.701526e-02 1 1  ON 35
  eH1_6                 9.972734e-02 1 1  ON 36
  eH1_7                 1.587198e-01 1 1  ON 37
  eH1_8                 1.892320e-01 1 1  ON 38
  eH1_9                 8.149924e-02 1 1  ON 39
  eH2_0                -2.593219e-01 1 1  ON 40
  eH2_1                -1.526657e-01 1 1  ON 41
  eH2_2                -1.026513e-01 1 1  ON 42
  eH2_3                -4.663000e-02 1 1  ON 43
  eH2_4                 3.510885e-03 1 1  ON 44
  eH2_5                 3.974002e-02 1 1  ON 45
  eH2_6                 1.012579e-01 1 1  ON 46
  eH2_7                 1.604191e-01 1 1  ON 47
  eH2_8                 1.940265e-01 1 1  ON 48
  eH2_9                 7.473504e-02 1 1  ON 49
ci_0001                 6.998470e-01 3 1  ON 50
ci_0002                 7.021152e-01 3 1  ON 51
ci_0003                -2.663364e-02 3 1  ON 52
ci_0004                -2.752272e-02 3 1  ON 53
ci_0005                -3.581563e-02 3 1  ON 54
ci_0006                -3.761563e-02 3 1  ON 55
ci_0007                -2.110761e-02 3 1  ON 56
ci_0008                -2.262974e-02 3 1  ON 57
ci_0009                -1.720885e-02 3 1  ON 58
ci_0010                -1.787515e-02 3 1  ON 59
ci_0011                -1.221948e-02 3 1  ON 60
ci_0012                -1.198972e-02 3 1  ON 61
ci_0013                 1.349622e-02 3 1  ON 62
ci_0014                 1.268299e-02 3 1  ON 63
ci_0015                 1.365492e-02 3 1  ON 64
ci_0016                 1.382726e-02 3 1  ON 65
ci_0017                 1.057655e-02 3 1  ON 66
ci_0018                 1.105336e-02 3 1  ON 67
ci_0019                 1.152402e-02 3 1  ON 68
ci_0020                 1.071373e-02 3 1  ON 69
ci_0021                -1.256563e-03 3 1  ON 70
ci_0022                -6.150338e-04 3 1  ON 71
ci_0023                -1.110624e-02 3 1  ON 72
ci_0024                -1.127100e-02 3 1  ON 73
ci_0025                -1.074088e-02 3 1  ON 74
ci_0026                -1.112139e-02 3 1  ON 75
ci_0027                -1.092204e-02 3 1  ON 76
ci_0028                -1.160071e-02 3 1  ON 77
ci_0029                -1.108910e-02 3 1  ON 78
ci_0030                -1.092661e-02 3 1  ON 79
ci_0031                 1.922273e-02 3 1  ON 80
ci_0032                 2.146625e-02 3 1  ON 81
ci_0033                 9.881650e-03 3 1  ON 82
ci_0034                 1.014893e-02 3 1  ON 83
ci_0035                 7.118906e-03 3 1  ON 84
ci_0036                 6.795956e-03 3 1  ON 85
ci_0037                -9.736854e-03 3 1  ON 86
ci_0038                -1.047197e-02 3 1  ON 87
ci_0039                -2.602068e-03 3 1  ON 88
ci_0040                -2.741145e-03 3 1  ON 89
ci_0041                 7.254243e-03 3 1  ON 90
ci_0042                 7.048457e-03 3 1  ON 91
ci_0043                -1.875250e-02 3 1  ON 92
ci_0044                -1.886924e-02 3 1  ON 93
ci_0045                 7.896596e-03 3 1  ON 94
ci_0046                 6.938298e-03 3 1  ON 95
ci_0047                -1.485499e-03 3 1  ON 96
ci_0048                -1.414719e-03 3 1  ON 97
ci_0049                -5.699792e-03 3 1  ON 98
ci_0050                -5.348962e-03 3 1  ON 99
ci_0051                -3.136528e-03 3 1  ON 100
ci_0052                -3.118728e-03 3 1  ON 101
ci_0053                -4.735466e-03 3 1  ON 102
ci_0054                -4.121060e-03 3 1  ON 103
ci_0055                 6.297837e-03 3 1  ON 104
ci_0056                 6.625409e-03 3 1  ON 105
ci_0057                 4.426612e-03 3 1  ON 106
ci_0058                 3.937659e-03 3 1  ON 107
ci_0059                -4.743185e-03 3 1  ON 108
ci_0060                -5.010292e-03 3 1  ON 109
ci_0061                -3.659500e-03 3 1  ON 110
ci_0062                -3.682024e-03 3 1  ON 111
ci_0063                -8.420394e-03 3 1  ON 112
ci_0064                -9.009311e-03 3 1  ON 113
ci_0065                -5.103207e-03 3 1  ON 114
ci_0066                -5.878464e-03 3 1  ON 115
ci_0067                -5.039075e-03 3 1  ON 116
ci_0068                -5.231895e-03 3 1  ON 117
ci_0069                 4.587189e-03 3 1  ON 118
ci_0070                 4.631029e-03 3 1  ON 119
ci_0071                 7.563775e-04 3 1  ON 120
ci_0072                 3.032592e-04 3 1  ON 121
ci_0073                 4.556675e-03 3 1  ON 122
ci_0074                 4.432451e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7885e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.963
    reference variance = 0.332108
====================================================
  Execution time = 2.1179e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5228e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4213e-01
  Total weights = 1.951483710e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0874e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326852243623
                                         uncertainty =       0.003251821830

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326852243623
                                         uncertainty =       0.003251821830

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404243580
  error estimate for blocks of size 2^( 2) =       0.000417084591
  error estimate for blocks of size 2^( 3) =       0.000430389349
  error estimate for blocks of size 2^( 4) =       0.000442976203
  error estimate for blocks of size 2^( 5) =       0.000453941273
  error estimate for blocks of size 2^( 6) =       0.000460706564
  error estimate for blocks of size 2^( 7) =       0.000463452530

      target function =                  N/A
              le_mean =     -16.906123516600
             les_mean =     286.159144228304
             stat err =       0.000455269142
             autocorr =       1.268382286943
              std dev =       0.571686753015
             le_variance =       0.326825743573


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690612351660e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e-01, overlap shift 3.7253e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906123516574       residual = 2.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906132521253       residual = 2.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906132461694       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906132670858       residual = 6.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906133175809       residual = 6.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906132843228       residual = 6.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906132870450       residual = 2.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906132589832       residual = 8.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906132423874       residual = 3.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906132395764       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906132676275       residual = 5.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.7253e-01 is 1.134903e-03

solving harmonic davidson linear method for identity shift 1.4901e+00, overlap shift 1.4901e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906123516574       residual = 2.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906126644674       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906126642818       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906126679141       residual = 6.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906126898269       residual = 6.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906126951622       residual = 4.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906126881974       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906126730534       residual = 3.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906126694308       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906126666462       residual = 5.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4901e+00 is 3.916882e-04

solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906123516574       residual = 2.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906124382974       residual = 2.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906124385021       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906124394898       residual = 6.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906124458718       residual = 6.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906124491335       residual = 3.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906124476862       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906124431962       residual = 2.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906124415678       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906124406730       residual = 4.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.9605e+00 is 1.082728e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.295416 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7283e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
   uu_0                 3.137590e-01 1 1  ON 0
   uu_1                 1.459330e-01 1 1  ON 1
   uu_2                 4.386168e-02 1 1  ON 2
   uu_3                -1.924624e-02 1 1  ON 3
   uu_4                -6.565031e-02 1 1  ON 4
   uu_5                -1.017087e-01 1 1  ON 5
   uu_6                -1.310732e-01 1 1  ON 6
   uu_7                -1.459444e-01 1 1  ON 7
   uu_8                -1.388864e-01 1 1  ON 8
   uu_9                -1.117497e-01 1 1  ON 9
   ud_0                 4.508664e-01 1 1  ON 10
   ud_1                 1.849109e-01 1 1  ON 11
   ud_2                 6.412221e-02 1 1  ON 12
   ud_3                -7.215961e-03 1 1  ON 13
   ud_4                -6.489470e-02 1 1  ON 14
   ud_5                -1.071576e-01 1 1  ON 15
   ud_6                -1.354704e-01 1 1  ON 16
   ud_7                -1.538027e-01 1 1  ON 17
   ud_8                -1.542265e-01 1 1  ON 18
   ud_9                -1.438899e-01 1 1  ON 19
   eO_0                -7.507075e-01 1 1  ON 20
   eO_1                -4.301506e-01 1 1  ON 21
   eO_2                -1.845209e-02 1 1  ON 22
   eO_3                 2.955801e-01 1 1  ON 23
   eO_4                 5.232876e-01 1 1  ON 24
   eO_5                 4.869336e-01 1 1  ON 25
   eO_6                 2.606276e-01 1 1  ON 26
   eO_7                -4.190533e-02 1 1  ON 27
   eO_8                -2.295574e-01 1 1  ON 28
   eO_9                -9.317887e-02 1 1  ON 29
  eH1_0                -2.612114e-01 1 1  ON 30
  eH1_1                -1.536528e-01 1 1  ON 31
  eH1_2                -1.037141e-01 1 1  ON 32
  eH1_3                -4.811422e-02 1 1  ON 33
  eH1_4                 1.979137e-03 1 1  ON 34
  eH1_5                 3.695270e-02 1 1  ON 35
  eH1_6                 9.966414e-02 1 1  ON 36
  eH1_7                 1.587454e-01 1 1  ON 37
  eH1_8                 1.893317e-01 1 1  ON 38
  eH1_9                 8.163899e-02 1 1  ON 39
  eH2_0                -2.594729e-01 1 1  ON 40
  eH2_1                -1.526261e-01 1 1  ON 41
  eH2_2                -1.026562e-01 1 1  ON 42
  eH2_3                -4.666489e-02 1 1  ON 43
  eH2_4                 3.435391e-03 1 1  ON 44
  eH2_5                 3.973824e-02 1 1  ON 45
  eH2_6                 1.012942e-01 1 1  ON 46
  eH2_7                 1.604649e-01 1 1  ON 47
  eH2_8                 1.940470e-01 1 1  ON 48
  eH2_9                 7.483875e-02 1 1  ON 49
ci_0001                 6.998988e-01 3 1  ON 50
ci_0002                 7.020760e-01 3 1  ON 51
ci_0003                -2.671169e-02 3 1  ON 52
ci_0004                -2.755492e-02 3 1  ON 53
ci_0005                -3.592641e-02 3 1  ON 54
ci_0006                -3.758522e-02 3 1  ON 55
ci_0007                -2.123892e-02 3 1  ON 56
ci_0008                -2.266181e-02 3 1  ON 57
ci_0009                -1.717589e-02 3 1  ON 58
ci_0010                -1.794803e-02 3 1  ON 59
ci_0011                -1.229086e-02 3 1  ON 60
ci_0012                -1.196153e-02 3 1  ON 61
ci_0013                 1.339000e-02 3 1  ON 62
ci_0014                 1.276479e-02 3 1  ON 63
ci_0015                 1.347072e-02 3 1  ON 64
ci_0016                 1.369600e-02 3 1  ON 65
ci_0017                 1.061626e-02 3 1  ON 66
ci_0018                 1.103248e-02 3 1  ON 67
ci_0019                 1.141374e-02 3 1  ON 68
ci_0020                 1.076208e-02 3 1  ON 69
ci_0021                -1.290672e-03 3 1  ON 70
ci_0022                -7.098845e-04 3 1  ON 71
ci_0023                -1.114665e-02 3 1  ON 72
ci_0024                -1.136891e-02 3 1  ON 73
ci_0025                -1.067434e-02 3 1  ON 74
ci_0026                -1.096861e-02 3 1  ON 75
ci_0027                -1.090441e-02 3 1  ON 76
ci_0028                -1.157000e-02 3 1  ON 77
ci_0029                -1.091847e-02 3 1  ON 78
ci_0030                -1.103182e-02 3 1  ON 79
ci_0031                 1.929030e-02 3 1  ON 80
ci_0032                 2.140058e-02 3 1  ON 81
ci_0033                 9.770310e-03 3 1  ON 82
ci_0034                 1.008010e-02 3 1  ON 83
ci_0035                 7.020364e-03 3 1  ON 84
ci_0036                 6.809387e-03 3 1  ON 85
ci_0037                -9.690325e-03 3 1  ON 86
ci_0038                -1.065806e-02 3 1  ON 87
ci_0039                -2.519948e-03 3 1  ON 88
ci_0040                -2.735125e-03 3 1  ON 89
ci_0041                 7.133710e-03 3 1  ON 90
ci_0042                 6.912167e-03 3 1  ON 91
ci_0043                -1.875133e-02 3 1  ON 92
ci_0044                -1.887934e-02 3 1  ON 93
ci_0045                 7.803497e-03 3 1  ON 94
ci_0046                 6.965108e-03 3 1  ON 95
ci_0047                -1.483381e-03 3 1  ON 96
ci_0048                -1.626917e-03 3 1  ON 97
ci_0049                -5.308104e-03 3 1  ON 98
ci_0050                -5.313873e-03 3 1  ON 99
ci_0051                -3.215393e-03 3 1  ON 100
ci_0052                -3.202214e-03 3 1  ON 101
ci_0053                -4.684813e-03 3 1  ON 102
ci_0054                -4.240413e-03 3 1  ON 103
ci_0055                 6.149287e-03 3 1  ON 104
ci_0056                 6.588754e-03 3 1  ON 105
ci_0057                 4.333175e-03 3 1  ON 106
ci_0058                 4.016863e-03 3 1  ON 107
ci_0059                -4.670163e-03 3 1  ON 108
ci_0060                -4.913042e-03 3 1  ON 109
ci_0061                -3.593823e-03 3 1  ON 110
ci_0062                -3.550590e-03 3 1  ON 111
ci_0063                -8.374465e-03 3 1  ON 112
ci_0064                -8.976630e-03 3 1  ON 113
ci_0065                -5.038719e-03 3 1  ON 114
ci_0066                -5.727462e-03 3 1  ON 115
ci_0067                -4.983116e-03 3 1  ON 116
ci_0068                -5.136480e-03 3 1  ON 117
ci_0069                 4.564856e-03 3 1  ON 118
ci_0070                 4.567993e-03 3 1  ON 119
ci_0071                 7.157139e-04 3 1  ON 120
ci_0072                 3.085766e-04 3 1  ON 121
ci_0073                 4.478387e-03 3 1  ON 122
ci_0074                 4.265103e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.9128
    reference variance = 0.143135
====================================================
  Execution time = 2.2635e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3971e-01
  Total weights = 1.9522e+06
  Execution time = 2.0833e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325829162384
                                         uncertainty =       0.002197424548

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325829162384
                                         uncertainty =       0.002197424548

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403605746
  error estimate for blocks of size 2^( 2) =       0.000416989630
  error estimate for blocks of size 2^( 3) =       0.000430618433
  error estimate for blocks of size 2^( 4) =       0.000444062161
  error estimate for blocks of size 2^( 5) =       0.000454951571
  error estimate for blocks of size 2^( 6) =       0.000461541819
  error estimate for blocks of size 2^( 7) =       0.000467423101

      target function =                  N/A
              le_mean =     -16.905532677842
             les_mean =     286.138071104548
             stat err =       0.000456994663
             autocorr =       1.282057709931
              std dev =       0.570784720395
             le_variance =       0.325795197036

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325864373061
                                         uncertainty =       0.002268075249

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325864373061
                                         uncertainty =       0.002268075249

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403631739
  error estimate for blocks of size 2^( 2) =       0.000417012214
  error estimate for blocks of size 2^( 3) =       0.000430655362
  error estimate for blocks of size 2^( 4) =       0.000444166396
  error estimate for blocks of size 2^( 5) =       0.000455030446
  error estimate for blocks of size 2^( 6) =       0.000461685547
  error estimate for blocks of size 2^( 7) =       0.000467586414

      target function =                  N/A
              le_mean =     -16.905537561305
             les_mean =     286.174065509398
             stat err =       0.000457117201
             autocorr =       1.282580133041
              std dev =       0.570821479878
             le_variance =       0.325837161890

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325702526191
                                         uncertainty =       0.002216894111

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325702526191
                                         uncertainty =       0.002216894111

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403529946
  error estimate for blocks of size 2^( 2) =       0.000416914311
  error estimate for blocks of size 2^( 3) =       0.000430554887
  error estimate for blocks of size 2^( 4) =       0.000444035692
  error estimate for blocks of size 2^( 5) =       0.000454911077
  error estimate for blocks of size 2^( 6) =       0.000461539398
  error estimate for blocks of size 2^( 7) =       0.000467434578

      target function =                  N/A
              le_mean =     -16.905530178261
             les_mean =     286.140161691657
             stat err =       0.000456980186
             autocorr =       1.282458146596
              std dev =       0.570677523118
             le_variance =       0.325672835392

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325792004712
                                         uncertainty =       0.002197206665

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325792004712
                                         uncertainty =       0.002197206665

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403583053
  error estimate for blocks of size 2^( 2) =       0.000416967391
  error estimate for blocks of size 2^( 3) =       0.000430597985
  error estimate for blocks of size 2^( 4) =       0.000444046173
  error estimate for blocks of size 2^( 5) =       0.000454934485
  error estimate for blocks of size 2^( 6) =       0.000461529685
  error estimate for blocks of size 2^( 7) =       0.000467411332

      target function =                  N/A
              le_mean =     -16.905530904470
             les_mean =     286.143269063327
             stat err =       0.000456980419
             autocorr =       1.282121961229
              std dev =       0.570752627419
             le_variance =       0.325758561705


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905532677842        initial
     3.7253e-01     3.7253e+00             1.1349e-03       -16.905537561305  <--
     1.4901e+00     1.4901e+01             3.9169e-04       -16.905530178261
     5.9605e+00     5.9605e+01             1.0827e-04       -16.905530904470

*****************************************************************************
Applying the update for shift_i =   3.7253e-01     and shift_s =   3.7253e+00
*****************************************************************************

  Execution time = 3.2449e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
   uu_0                 3.138661e-01 1 1  ON 0
   uu_1                 1.459059e-01 1 1  ON 1
   uu_2                 4.388004e-02 1 1  ON 2
   uu_3                -1.928057e-02 1 1  ON 3
   uu_4                -6.572038e-02 1 1  ON 4
   uu_5                -1.017738e-01 1 1  ON 5
   uu_6                -1.311432e-01 1 1  ON 6
   uu_7                -1.460073e-01 1 1  ON 7
   uu_8                -1.390674e-01 1 1  ON 8
   uu_9                -1.117090e-01 1 1  ON 9
   ud_0                 4.508851e-01 1 1  ON 10
   ud_1                 1.849694e-01 1 1  ON 11
   ud_2                 6.413164e-02 1 1  ON 12
   ud_3                -7.188760e-03 1 1  ON 13
   ud_4                -6.484256e-02 1 1  ON 14
   ud_5                -1.072313e-01 1 1  ON 15
   ud_6                -1.353732e-01 1 1  ON 16
   ud_7                -1.536578e-01 1 1  ON 17
   ud_8                -1.543315e-01 1 1  ON 18
   ud_9                -1.439206e-01 1 1  ON 19
   eO_0                -7.506868e-01 1 1  ON 20
   eO_1                -4.301089e-01 1 1  ON 21
   eO_2                -1.839536e-02 1 1  ON 22
   eO_3                 2.956467e-01 1 1  ON 23
   eO_4                 5.233765e-01 1 1  ON 24
   eO_5                 4.872050e-01 1 1  ON 25
   eO_6                 2.605886e-01 1 1  ON 26
   eO_7                -4.202367e-02 1 1  ON 27
   eO_8                -2.296787e-01 1 1  ON 28
   eO_9                -9.341020e-02 1 1  ON 29
  eH1_0                -2.612934e-01 1 1  ON 30
  eH1_1                -1.538149e-01 1 1  ON 31
  eH1_2                -1.038615e-01 1 1  ON 32
  eH1_3                -4.819680e-02 1 1  ON 33
  eH1_4                 1.946135e-03 1 1  ON 34
  eH1_5                 3.678894e-02 1 1  ON 35
  eH1_6                 9.947674e-02 1 1  ON 36
  eH1_7                 1.588158e-01 1 1  ON 37
  eH1_8                 1.896272e-01 1 1  ON 38
  eH1_9                 8.205419e-02 1 1  ON 39
  eH2_0                -2.598541e-01 1 1  ON 40
  eH2_1                -1.525742e-01 1 1  ON 41
  eH2_2                -1.027062e-01 1 1  ON 42
  eH2_3                -4.675874e-02 1 1  ON 43
  eH2_4                 3.246717e-03 1 1  ON 44
  eH2_5                 3.971958e-02 1 1  ON 45
  eH2_6                 1.013921e-01 1 1  ON 46
  eH2_7                 1.606054e-01 1 1  ON 47
  eH2_8                 1.941146e-01 1 1  ON 48
  eH2_9                 7.514771e-02 1 1  ON 49
ci_0001                 7.000217e-01 3 1  ON 50
ci_0002                 7.019723e-01 3 1  ON 51
ci_0003                -2.688492e-02 3 1  ON 52
ci_0004                -2.761315e-02 3 1  ON 53
ci_0005                -3.617179e-02 3 1  ON 54
ci_0006                -3.750871e-02 3 1  ON 55
ci_0007                -2.156244e-02 3 1  ON 56
ci_0008                -2.274184e-02 3 1  ON 57
ci_0009                -1.712283e-02 3 1  ON 58
ci_0010                -1.807645e-02 3 1  ON 59
ci_0011                -1.243719e-02 3 1  ON 60
ci_0012                -1.189369e-02 3 1  ON 61
ci_0013                 1.319398e-02 3 1  ON 62
ci_0014                 1.292244e-02 3 1  ON 63
ci_0015                 1.312451e-02 3 1  ON 64
ci_0016                 1.343590e-02 3 1  ON 65
ci_0017                 1.069558e-02 3 1  ON 66
ci_0018                 1.099077e-02 3 1  ON 67
ci_0019                 1.119918e-02 3 1  ON 68
ci_0020                 1.085253e-02 3 1  ON 69
ci_0021                -1.371345e-03 3 1  ON 70
ci_0022                -9.430833e-04 3 1  ON 71
ci_0023                -1.122156e-02 3 1  ON 72
ci_0024                -1.154468e-02 3 1  ON 73
ci_0025                -1.055319e-02 3 1  ON 74
ci_0026                -1.067290e-02 3 1  ON 75
ci_0027                -1.087949e-02 3 1  ON 76
ci_0028                -1.150432e-02 3 1  ON 77
ci_0029                -1.059664e-02 3 1  ON 78
ci_0030                -1.124101e-02 3 1  ON 79
ci_0031                 1.946169e-02 3 1  ON 80
ci_0032                 2.125194e-02 3 1  ON 81
ci_0033                 9.512855e-03 3 1  ON 82
ci_0034                 9.923157e-03 3 1  ON 83
ci_0035                 6.838465e-03 3 1  ON 84
ci_0036                 6.824283e-03 3 1  ON 85
ci_0037                -9.592249e-03 3 1  ON 86
ci_0038                -1.104445e-02 3 1  ON 87
ci_0039                -2.396510e-03 3 1  ON 88
ci_0040                -2.722976e-03 3 1  ON 89
ci_0041                 6.906886e-03 3 1  ON 90
ci_0042                 6.645438e-03 3 1  ON 91
ci_0043                -1.875188e-02 3 1  ON 92
ci_0044                -1.889427e-02 3 1  ON 93
ci_0045                 7.598999e-03 3 1  ON 94
ci_0046                 7.023919e-03 3 1  ON 95
ci_0047                -1.480785e-03 3 1  ON 96
ci_0048                -1.950110e-03 3 1  ON 97
ci_0049                -4.564890e-03 3 1  ON 98
ci_0050                -5.249933e-03 3 1  ON 99
ci_0051                -3.345724e-03 3 1  ON 100
ci_0052                -3.336955e-03 3 1  ON 101
ci_0053                -4.601284e-03 3 1  ON 102
ci_0054                -4.436638e-03 3 1  ON 103
ci_0055                 5.832577e-03 3 1  ON 104
ci_0056                 6.513520e-03 3 1  ON 105
ci_0057                 4.149054e-03 3 1  ON 106
ci_0058                 4.179847e-03 3 1  ON 107
ci_0059                -4.548441e-03 3 1  ON 108
ci_0060                -4.750028e-03 3 1  ON 109
ci_0061                -3.462977e-03 3 1  ON 110
ci_0062                -3.286603e-03 3 1  ON 111
ci_0063                -8.297730e-03 3 1  ON 112
ci_0064                -8.913627e-03 3 1  ON 113
ci_0065                -4.925590e-03 3 1  ON 114
ci_0066                -5.450025e-03 3 1  ON 115
ci_0067                -4.894319e-03 3 1  ON 116
ci_0068                -4.982433e-03 3 1  ON 117
ci_0069                 4.526272e-03 3 1  ON 118
ci_0070                 4.465546e-03 3 1  ON 119
ci_0071                 6.252801e-04 3 1  ON 120
ci_0072                 3.143026e-04 3 1  ON 121
ci_0073                 4.359664e-03 3 1  ON 122
ci_0074                 3.996464e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9756e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.7678
    reference variance = 0.272802
====================================================
  Execution time = 2.1148e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5240e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4128e-01
  Total weights = 1.951820215e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0126e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327183728131
                                         uncertainty =       0.002367044894

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327183728131
                                         uncertainty =       0.002367044894

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404505406
  error estimate for blocks of size 2^( 2) =       0.000417928466
  error estimate for blocks of size 2^( 3) =       0.000430983648
  error estimate for blocks of size 2^( 4) =       0.000443672090
  error estimate for blocks of size 2^( 5) =       0.000454815450
  error estimate for blocks of size 2^( 6) =       0.000463889119
  error estimate for blocks of size 2^( 7) =       0.000469489060

      target function =                  N/A
              le_mean =     -16.906205262508
             les_mean =     286.161054238041
             stat err =       0.000457966429
             autocorr =       1.281795158219
              std dev =       0.572057031624
             le_variance =       0.327249247431


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690620526251e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e-02, overlap shift 9.3132e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906205262526       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906225294669       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906226346286       residual = 6.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906228792485       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906228135919       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906227422024       residual = 8.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906229983531       residual = 5.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906229705416       residual = 3.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906229637172       residual = 4.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906229513530       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906229471830       residual = 9.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906230018759       residual = 5.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906230149597       residual = 2.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906230271887       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906230184193       residual = 8.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         14 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.3132e-02 is 2.619799e-03

solving harmonic davidson linear method for identity shift 3.7253e-01, overlap shift 3.7253e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906205262526       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906215525170       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906215594649       residual = 3.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906216344562       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906216558624       residual = 6.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906216574518       residual = 3.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906217161793       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906217201440       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906216919600       residual = 4.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906216888369       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906216897825       residual = 6.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.7253e-01 is 7.103914e-04

solving harmonic davidson linear method for identity shift 1.4901e+00, overlap shift 1.4901e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906205262526       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906208740481       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906208712495       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906208878305       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906209001616       residual = 5.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906209084632       residual = 2.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906209132403       residual = 9.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906209218968       residual = 5.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906209195115       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906209144497       residual = 7.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4901e+00 is 2.366353e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.306683 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7179e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
   uu_0                 3.136875e-01 1 1  ON 0
   uu_1                 1.459076e-01 1 1  ON 1
   uu_2                 4.379345e-02 1 1  ON 2
   uu_3                -1.934669e-02 1 1  ON 3
   uu_4                -6.591154e-02 1 1  ON 4
   uu_5                -1.018819e-01 1 1  ON 5
   uu_6                -1.311668e-01 1 1  ON 6
   uu_7                -1.461324e-01 1 1  ON 7
   uu_8                -1.389924e-01 1 1  ON 8
   uu_9                -1.115545e-01 1 1  ON 9
   ud_0                 4.508229e-01 1 1  ON 10
   ud_1                 1.848387e-01 1 1  ON 11
   ud_2                 6.411420e-02 1 1  ON 12
   ud_3                -7.358996e-03 1 1  ON 13
   ud_4                -6.489770e-02 1 1  ON 14
   ud_5                -1.070558e-01 1 1  ON 15
   ud_6                -1.355865e-01 1 1  ON 16
   ud_7                -1.535829e-01 1 1  ON 17
   ud_8                -1.540460e-01 1 1  ON 18
   ud_9                -1.437297e-01 1 1  ON 19
   eO_0                -7.509226e-01 1 1  ON 20
   eO_1                -4.300681e-01 1 1  ON 21
   eO_2                -1.847936e-02 1 1  ON 22
   eO_3                 2.958137e-01 1 1  ON 23
   eO_4                 5.235750e-01 1 1  ON 24
   eO_5                 4.873191e-01 1 1  ON 25
   eO_6                 2.608104e-01 1 1  ON 26
   eO_7                -4.197832e-02 1 1  ON 27
   eO_8                -2.298561e-01 1 1  ON 28
   eO_9                -9.366803e-02 1 1  ON 29
  eH1_0                -2.614230e-01 1 1  ON 30
  eH1_1                -1.540967e-01 1 1  ON 31
  eH1_2                -1.040703e-01 1 1  ON 32
  eH1_3                -4.837412e-02 1 1  ON 33
  eH1_4                 1.639118e-03 1 1  ON 34
  eH1_5                 3.696001e-02 1 1  ON 35
  eH1_6                 9.940541e-02 1 1  ON 36
  eH1_7                 1.587360e-01 1 1  ON 37
  eH1_8                 1.899545e-01 1 1  ON 38
  eH1_9                 8.270382e-02 1 1  ON 39
  eH2_0                -2.601614e-01 1 1  ON 40
  eH2_1                -1.528773e-01 1 1  ON 41
  eH2_2                -1.028050e-01 1 1  ON 42
  eH2_3                -4.695283e-02 1 1  ON 43
  eH2_4                 3.207083e-03 1 1  ON 44
  eH2_5                 3.963513e-02 1 1  ON 45
  eH2_6                 1.014688e-01 1 1  ON 46
  eH2_7                 1.606571e-01 1 1  ON 47
  eH2_8                 1.943940e-01 1 1  ON 48
  eH2_9                 7.571570e-02 1 1  ON 49
ci_0001                 7.000332e-01 3 1  ON 50
ci_0002                 7.020052e-01 3 1  ON 51
ci_0003                -2.681919e-02 3 1  ON 52
ci_0004                -2.720781e-02 3 1  ON 53
ci_0005                -3.615827e-02 3 1  ON 54
ci_0006                -3.750857e-02 3 1  ON 55
ci_0007                -2.170558e-02 3 1  ON 56
ci_0008                -2.275913e-02 3 1  ON 57
ci_0009                -1.717478e-02 3 1  ON 58
ci_0010                -1.753181e-02 3 1  ON 59
ci_0011                -1.233353e-02 3 1  ON 60
ci_0012                -1.215399e-02 3 1  ON 61
ci_0013                 1.306423e-02 3 1  ON 62
ci_0014                 1.274856e-02 3 1  ON 63
ci_0015                 1.314415e-02 3 1  ON 64
ci_0016                 1.314037e-02 3 1  ON 65
ci_0017                 1.095015e-02 3 1  ON 66
ci_0018                 1.102992e-02 3 1  ON 67
ci_0019                 1.126738e-02 3 1  ON 68
ci_0020                 1.115960e-02 3 1  ON 69
ci_0021                -1.405421e-03 3 1  ON 70
ci_0022                -1.037199e-03 3 1  ON 71
ci_0023                -1.099552e-02 3 1  ON 72
ci_0024                -1.093759e-02 3 1  ON 73
ci_0025                -1.032712e-02 3 1  ON 74
ci_0026                -1.064323e-02 3 1  ON 75
ci_0027                -1.105962e-02 3 1  ON 76
ci_0028                -1.138127e-02 3 1  ON 77
ci_0029                -1.049058e-02 3 1  ON 78
ci_0030                -1.081934e-02 3 1  ON 79
ci_0031                 1.967978e-02 3 1  ON 80
ci_0032                 2.118706e-02 3 1  ON 81
ci_0033                 9.806547e-03 3 1  ON 82
ci_0034                 1.051591e-02 3 1  ON 83
ci_0035                 6.128073e-03 3 1  ON 84
ci_0036                 6.674722e-03 3 1  ON 85
ci_0037                -9.690293e-03 3 1  ON 86
ci_0038                -1.035386e-02 3 1  ON 87
ci_0039                -2.562526e-03 3 1  ON 88
ci_0040                -2.714621e-03 3 1  ON 89
ci_0041                 7.402046e-03 3 1  ON 90
ci_0042                 7.031560e-03 3 1  ON 91
ci_0043                -1.867180e-02 3 1  ON 92
ci_0044                -1.857373e-02 3 1  ON 93
ci_0045                 7.350228e-03 3 1  ON 94
ci_0046                 6.998673e-03 3 1  ON 95
ci_0047                -1.464969e-03 3 1  ON 96
ci_0048                -2.004852e-03 3 1  ON 97
ci_0049                -4.586381e-03 3 1  ON 98
ci_0050                -5.369031e-03 3 1  ON 99
ci_0051                -3.246669e-03 3 1  ON 100
ci_0052                -3.341662e-03 3 1  ON 101
ci_0053                -4.538447e-03 3 1  ON 102
ci_0054                -4.782391e-03 3 1  ON 103
ci_0055                 6.152552e-03 3 1  ON 104
ci_0056                 6.591106e-03 3 1  ON 105
ci_0057                 4.259310e-03 3 1  ON 106
ci_0058                 4.392090e-03 3 1  ON 107
ci_0059                -4.753917e-03 3 1  ON 108
ci_0060                -4.854501e-03 3 1  ON 109
ci_0061                -3.650013e-03 3 1  ON 110
ci_0062                -3.789296e-03 3 1  ON 111
ci_0063                -8.477528e-03 3 1  ON 112
ci_0064                -8.799964e-03 3 1  ON 113
ci_0065                -5.121549e-03 3 1  ON 114
ci_0066                -5.339949e-03 3 1  ON 115
ci_0067                -5.111935e-03 3 1  ON 116
ci_0068                -4.732114e-03 3 1  ON 117
ci_0069                 4.313731e-03 3 1  ON 118
ci_0070                 4.544317e-03 3 1  ON 119
ci_0071                 3.077334e-04 3 1  ON 120
ci_0072                 2.046350e-04 3 1  ON 121
ci_0073                 4.241970e-03 3 1  ON 122
ci_0074                 3.909618e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.8869
    reference variance = 0.235317
====================================================
  Execution time = 2.0949e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3773e-01
  Total weights = 1.9522e+06
  Execution time = 1.9194e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325028126551
                                         uncertainty =       0.002390165678

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325028126551
                                         uncertainty =       0.002390165678

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403172791
  error estimate for blocks of size 2^( 2) =       0.000416293649
  error estimate for blocks of size 2^( 3) =       0.000429317514
  error estimate for blocks of size 2^( 4) =       0.000441712124
  error estimate for blocks of size 2^( 5) =       0.000451863595
  error estimate for blocks of size 2^( 6) =       0.000459569276
  error estimate for blocks of size 2^( 7) =       0.000463213948

      target function =                  N/A
              le_mean =     -16.906642036051
             les_mean =     286.233767790214
             stat err =       0.000454089736
             autocorr =       1.268530573832
              std dev =       0.570172429704
             le_variance =       0.325096599595

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325026466513
                                         uncertainty =       0.002394819944

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325026466513
                                         uncertainty =       0.002394819944

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403171561
  error estimate for blocks of size 2^( 2) =       0.000416318866
  error estimate for blocks of size 2^( 3) =       0.000429328730
  error estimate for blocks of size 2^( 4) =       0.000441735467
  error estimate for blocks of size 2^( 5) =       0.000451835954
  error estimate for blocks of size 2^( 6) =       0.000459551362
  error estimate for blocks of size 2^( 7) =       0.000463165837

      target function =                  N/A
              le_mean =     -16.906657770729
             les_mean =     286.172672709475
             stat err =       0.000454072155
             autocorr =       1.268440095005
              std dev =       0.570170689074
             le_variance =       0.325094614680

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324958020539
                                         uncertainty =       0.002393185196

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324958020539
                                         uncertainty =       0.002393185196

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403128778
  error estimate for blocks of size 2^( 2) =       0.000416278631
  error estimate for blocks of size 2^( 3) =       0.000429287604
  error estimate for blocks of size 2^( 4) =       0.000441693638
  error estimate for blocks of size 2^( 5) =       0.000451796575
  error estimate for blocks of size 2^( 6) =       0.000459516667
  error estimate for blocks of size 2^( 7) =       0.000463125863

      target function =                  N/A
              le_mean =     -16.906658977158
             les_mean =     286.172972688120
             stat err =       0.000454033186
             autocorr =       1.268491585144
              std dev =       0.570110184708
             le_variance =       0.325025622708

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324849103752
                                         uncertainty =       0.002386508318

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324849103752
                                         uncertainty =       0.002386508318

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403061782
  error estimate for blocks of size 2^( 2) =       0.000416188573
  error estimate for blocks of size 2^( 3) =       0.000429196169
  error estimate for blocks of size 2^( 4) =       0.000441605383
  error estimate for blocks of size 2^( 5) =       0.000451740832
  error estimate for blocks of size 2^( 6) =       0.000459451296
  error estimate for blocks of size 2^( 7) =       0.000463056763

      target function =                  N/A
              le_mean =     -16.906648722694
             les_mean =     286.172735863781
             stat err =       0.000453963569
             autocorr =       1.268524216398
              std dev =       0.570015438008
             le_variance =       0.324917599567


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906642036051        initial
     9.3132e-02     9.3132e-01             2.6198e-03       -16.906657770729
     3.7253e-01     3.7253e+00             7.1039e-04       -16.906658977158  <--
     1.4901e+00     1.4901e+01             2.3664e-04       -16.906648722694

*****************************************************************************
Applying the update for shift_i =   3.7253e-01     and shift_s =   3.7253e+00
*****************************************************************************

  Execution time = 3.0591e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
   uu_0                 3.136875e-01 1 1  ON 0
   uu_1                 1.459076e-01 1 1  ON 1
   uu_2                 4.379345e-02 1 1  ON 2
   uu_3                -1.934669e-02 1 1  ON 3
   uu_4                -6.591154e-02 1 1  ON 4
   uu_5                -1.018819e-01 1 1  ON 5
   uu_6                -1.311668e-01 1 1  ON 6
   uu_7                -1.461324e-01 1 1  ON 7
   uu_8                -1.389924e-01 1 1  ON 8
   uu_9                -1.115545e-01 1 1  ON 9
   ud_0                 4.508229e-01 1 1  ON 10
   ud_1                 1.848387e-01 1 1  ON 11
   ud_2                 6.411420e-02 1 1  ON 12
   ud_3                -7.358996e-03 1 1  ON 13
   ud_4                -6.489770e-02 1 1  ON 14
   ud_5                -1.070558e-01 1 1  ON 15
   ud_6                -1.355865e-01 1 1  ON 16
   ud_7                -1.535829e-01 1 1  ON 17
   ud_8                -1.540460e-01 1 1  ON 18
   ud_9                -1.437297e-01 1 1  ON 19
   eO_0                -7.509226e-01 1 1  ON 20
   eO_1                -4.300681e-01 1 1  ON 21
   eO_2                -1.847936e-02 1 1  ON 22
   eO_3                 2.958137e-01 1 1  ON 23
   eO_4                 5.235750e-01 1 1  ON 24
   eO_5                 4.873191e-01 1 1  ON 25
   eO_6                 2.608104e-01 1 1  ON 26
   eO_7                -4.197832e-02 1 1  ON 27
   eO_8                -2.298561e-01 1 1  ON 28
   eO_9                -9.366803e-02 1 1  ON 29
  eH1_0                -2.614230e-01 1 1  ON 30
  eH1_1                -1.540967e-01 1 1  ON 31
  eH1_2                -1.040703e-01 1 1  ON 32
  eH1_3                -4.837412e-02 1 1  ON 33
  eH1_4                 1.639118e-03 1 1  ON 34
  eH1_5                 3.696001e-02 1 1  ON 35
  eH1_6                 9.940541e-02 1 1  ON 36
  eH1_7                 1.587360e-01 1 1  ON 37
  eH1_8                 1.899545e-01 1 1  ON 38
  eH1_9                 8.270382e-02 1 1  ON 39
  eH2_0                -2.601614e-01 1 1  ON 40
  eH2_1                -1.528773e-01 1 1  ON 41
  eH2_2                -1.028050e-01 1 1  ON 42
  eH2_3                -4.695283e-02 1 1  ON 43
  eH2_4                 3.207083e-03 1 1  ON 44
  eH2_5                 3.963513e-02 1 1  ON 45
  eH2_6                 1.014688e-01 1 1  ON 46
  eH2_7                 1.606571e-01 1 1  ON 47
  eH2_8                 1.943940e-01 1 1  ON 48
  eH2_9                 7.571570e-02 1 1  ON 49
ci_0001                 7.000332e-01 3 1  ON 50
ci_0002                 7.020052e-01 3 1  ON 51
ci_0003                -2.681919e-02 3 1  ON 52
ci_0004                -2.720781e-02 3 1  ON 53
ci_0005                -3.615827e-02 3 1  ON 54
ci_0006                -3.750857e-02 3 1  ON 55
ci_0007                -2.170558e-02 3 1  ON 56
ci_0008                -2.275913e-02 3 1  ON 57
ci_0009                -1.717478e-02 3 1  ON 58
ci_0010                -1.753181e-02 3 1  ON 59
ci_0011                -1.233353e-02 3 1  ON 60
ci_0012                -1.215399e-02 3 1  ON 61
ci_0013                 1.306423e-02 3 1  ON 62
ci_0014                 1.274856e-02 3 1  ON 63
ci_0015                 1.314415e-02 3 1  ON 64
ci_0016                 1.314037e-02 3 1  ON 65
ci_0017                 1.095015e-02 3 1  ON 66
ci_0018                 1.102992e-02 3 1  ON 67
ci_0019                 1.126738e-02 3 1  ON 68
ci_0020                 1.115960e-02 3 1  ON 69
ci_0021                -1.405421e-03 3 1  ON 70
ci_0022                -1.037199e-03 3 1  ON 71
ci_0023                -1.099552e-02 3 1  ON 72
ci_0024                -1.093759e-02 3 1  ON 73
ci_0025                -1.032712e-02 3 1  ON 74
ci_0026                -1.064323e-02 3 1  ON 75
ci_0027                -1.105962e-02 3 1  ON 76
ci_0028                -1.138127e-02 3 1  ON 77
ci_0029                -1.049058e-02 3 1  ON 78
ci_0030                -1.081934e-02 3 1  ON 79
ci_0031                 1.967978e-02 3 1  ON 80
ci_0032                 2.118706e-02 3 1  ON 81
ci_0033                 9.806547e-03 3 1  ON 82
ci_0034                 1.051591e-02 3 1  ON 83
ci_0035                 6.128073e-03 3 1  ON 84
ci_0036                 6.674722e-03 3 1  ON 85
ci_0037                -9.690293e-03 3 1  ON 86
ci_0038                -1.035386e-02 3 1  ON 87
ci_0039                -2.562526e-03 3 1  ON 88
ci_0040                -2.714621e-03 3 1  ON 89
ci_0041                 7.402046e-03 3 1  ON 90
ci_0042                 7.031560e-03 3 1  ON 91
ci_0043                -1.867180e-02 3 1  ON 92
ci_0044                -1.857373e-02 3 1  ON 93
ci_0045                 7.350228e-03 3 1  ON 94
ci_0046                 6.998673e-03 3 1  ON 95
ci_0047                -1.464969e-03 3 1  ON 96
ci_0048                -2.004852e-03 3 1  ON 97
ci_0049                -4.586381e-03 3 1  ON 98
ci_0050                -5.369031e-03 3 1  ON 99
ci_0051                -3.246669e-03 3 1  ON 100
ci_0052                -3.341662e-03 3 1  ON 101
ci_0053                -4.538447e-03 3 1  ON 102
ci_0054                -4.782391e-03 3 1  ON 103
ci_0055                 6.152552e-03 3 1  ON 104
ci_0056                 6.591106e-03 3 1  ON 105
ci_0057                 4.259310e-03 3 1  ON 106
ci_0058                 4.392090e-03 3 1  ON 107
ci_0059                -4.753917e-03 3 1  ON 108
ci_0060                -4.854501e-03 3 1  ON 109
ci_0061                -3.650013e-03 3 1  ON 110
ci_0062                -3.789296e-03 3 1  ON 111
ci_0063                -8.477528e-03 3 1  ON 112
ci_0064                -8.799964e-03 3 1  ON 113
ci_0065                -5.121549e-03 3 1  ON 114
ci_0066                -5.339949e-03 3 1  ON 115
ci_0067                -5.111935e-03 3 1  ON 116
ci_0068                -4.732114e-03 3 1  ON 117
ci_0069                 4.313731e-03 3 1  ON 118
ci_0070                 4.544317e-03 3 1  ON 119
ci_0071                 3.077334e-04 3 1  ON 120
ci_0072                 2.046350e-04 3 1  ON 121
ci_0073                 4.241970e-03 3 1  ON 122
ci_0074                 3.909618e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7793e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.8539
    reference variance = 0.325399
====================================================
  Execution time = 2.1049e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5229e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4008e-01
  Total weights = 1.951831609e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1577e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327869805351
                                         uncertainty =       0.002080700682

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327869805351
                                         uncertainty =       0.002080700682

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404877861
  error estimate for blocks of size 2^( 2) =       0.000417351007
  error estimate for blocks of size 2^( 3) =       0.000430943363
  error estimate for blocks of size 2^( 4) =       0.000443136444
  error estimate for blocks of size 2^( 5) =       0.000453409471
  error estimate for blocks of size 2^( 6) =       0.000461182271
  error estimate for blocks of size 2^( 7) =       0.000464433577

      target function =                  N/A
              le_mean =     -16.905761187299
             les_mean =     286.144844647131
             stat err =       0.000455540441
             autocorr =       1.265918702636
              std dev =       0.572583761468
             le_variance =       0.327852163897


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690576118730e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e-02, overlap shift 9.3132e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905761187280       residual = 2.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905776135470       residual = 5.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905770291288       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905766913624       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905769465716       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905770184337       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905770954358       residual = 8.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905772153643       residual = 4.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905773115194       residual = 4.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905772982537       residual = 2.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905771476724       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905771230254       residual = 7.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905770705531       residual = 4.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905771693204       residual = 2.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.905771649183       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.905771811294       residual = 9.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.3132e-02 is 2.320496e-03

solving harmonic davidson linear method for identity shift 3.7253e-01, overlap shift 3.7253e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905761187280       residual = 2.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905769205572       residual = 5.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905766664201       residual = 4.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905765056574       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905765848287       residual = 8.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905766115868       residual = 4.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905766342949       residual = 3.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905766591311       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905766842177       residual = 6.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905766726433       residual = 3.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905766498380       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905766484213       residual = 3.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.7253e-01 is 7.005912e-04

solving harmonic davidson linear method for identity shift 1.4901e+00, overlap shift 1.4901e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905761187280       residual = 2.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905763996398       residual = 6.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905763217252       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905762818911       residual = 9.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905762854863       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905762892194       residual = 4.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905762984525       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905763081354       residual = 6.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905763163381       residual = 2.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905763167798       residual = 7.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4901e+00 is 2.297617e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.318805 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7226e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
   uu_0                 3.138424e-01 1 1  ON 0
   uu_1                 1.459686e-01 1 1  ON 1
   uu_2                 4.364873e-02 1 1  ON 2
   uu_3                -1.956387e-02 1 1  ON 3
   uu_4                -6.623303e-02 1 1  ON 4
   uu_5                -1.021968e-01 1 1  ON 5
   uu_6                -1.315018e-01 1 1  ON 6
   uu_7                -1.461362e-01 1 1  ON 7
   uu_8                -1.387242e-01 1 1  ON 8
   uu_9                -1.114319e-01 1 1  ON 9
   ud_0                 4.505921e-01 1 1  ON 10
   ud_1                 1.847358e-01 1 1  ON 11
   ud_2                 6.414682e-02 1 1  ON 12
   ud_3                -7.219399e-03 1 1  ON 13
   ud_4                -6.490111e-02 1 1  ON 14
   ud_5                -1.071373e-01 1 1  ON 15
   ud_6                -1.356756e-01 1 1  ON 16
   ud_7                -1.534799e-01 1 1  ON 17
   ud_8                -1.541349e-01 1 1  ON 18
   ud_9                -1.436084e-01 1 1  ON 19
   eO_0                -7.507356e-01 1 1  ON 20
   eO_1                -4.298756e-01 1 1  ON 21
   eO_2                -1.850522e-02 1 1  ON 22
   eO_3                 2.958214e-01 1 1  ON 23
   eO_4                 5.234605e-01 1 1  ON 24
   eO_5                 4.874443e-01 1 1  ON 25
   eO_6                 2.608781e-01 1 1  ON 26
   eO_7                -4.205570e-02 1 1  ON 27
   eO_8                -2.299777e-01 1 1  ON 28
   eO_9                -9.389500e-02 1 1  ON 29
  eH1_0                -2.618234e-01 1 1  ON 30
  eH1_1                -1.544568e-01 1 1  ON 31
  eH1_2                -1.043442e-01 1 1  ON 32
  eH1_3                -4.847691e-02 1 1  ON 33
  eH1_4                 1.772339e-03 1 1  ON 34
  eH1_5                 3.694831e-02 1 1  ON 35
  eH1_6                 9.946991e-02 1 1  ON 36
  eH1_7                 1.587808e-01 1 1  ON 37
  eH1_8                 1.901953e-01 1 1  ON 38
  eH1_9                 8.325234e-02 1 1  ON 39
  eH2_0                -2.607253e-01 1 1  ON 40
  eH2_1                -1.532679e-01 1 1  ON 41
  eH2_2                -1.029732e-01 1 1  ON 42
  eH2_3                -4.710966e-02 1 1  ON 43
  eH2_4                 3.239595e-03 1 1  ON 44
  eH2_5                 3.985574e-02 1 1  ON 45
  eH2_6                 1.014203e-01 1 1  ON 46
  eH2_7                 1.606251e-01 1 1  ON 47
  eH2_8                 1.948143e-01 1 1  ON 48
  eH2_9                 7.629685e-02 1 1  ON 49
ci_0001                 7.000646e-01 3 1  ON 50
ci_0002                 7.019216e-01 3 1  ON 51
ci_0003                -2.659085e-02 3 1  ON 52
ci_0004                -2.756055e-02 3 1  ON 53
ci_0005                -3.631869e-02 3 1  ON 54
ci_0006                -3.767905e-02 3 1  ON 55
ci_0007                -2.216558e-02 3 1  ON 56
ci_0008                -2.304618e-02 3 1  ON 57
ci_0009                -1.718374e-02 3 1  ON 58
ci_0010                -1.750166e-02 3 1  ON 59
ci_0011                -1.204190e-02 3 1  ON 60
ci_0012                -1.203129e-02 3 1  ON 61
ci_0013                 1.321489e-02 3 1  ON 62
ci_0014                 1.306992e-02 3 1  ON 63
ci_0015                 1.279284e-02 3 1  ON 64
ci_0016                 1.323194e-02 3 1  ON 65
ci_0017                 1.136419e-02 3 1  ON 66
ci_0018                 1.096286e-02 3 1  ON 67
ci_0019                 1.107555e-02 3 1  ON 68
ci_0020                 1.105548e-02 3 1  ON 69
ci_0021                -1.518363e-03 3 1  ON 70
ci_0022                -1.224853e-03 3 1  ON 71
ci_0023                -1.081804e-02 3 1  ON 72
ci_0024                -1.116769e-02 3 1  ON 73
ci_0025                -1.036534e-02 3 1  ON 74
ci_0026                -1.032127e-02 3 1  ON 75
ci_0027                -1.102797e-02 3 1  ON 76
ci_0028                -1.097165e-02 3 1  ON 77
ci_0029                -1.004902e-02 3 1  ON 78
ci_0030                -1.081559e-02 3 1  ON 79
ci_0031                 2.011275e-02 3 1  ON 80
ci_0032                 2.092235e-02 3 1  ON 81
ci_0033                 9.105956e-03 3 1  ON 82
ci_0034                 1.002738e-02 3 1  ON 83
ci_0035                 5.732508e-03 3 1  ON 84
ci_0036                 6.926471e-03 3 1  ON 85
ci_0037                -9.917460e-03 3 1  ON 86
ci_0038                -1.048144e-02 3 1  ON 87
ci_0039                -2.645989e-03 3 1  ON 88
ci_0040                -2.400658e-03 3 1  ON 89
ci_0041                 7.463942e-03 3 1  ON 90
ci_0042                 7.127576e-03 3 1  ON 91
ci_0043                -1.888170e-02 3 1  ON 92
ci_0044                -1.915222e-02 3 1  ON 93
ci_0045                 7.518713e-03 3 1  ON 94
ci_0046                 6.866222e-03 3 1  ON 95
ci_0047                -1.334037e-03 3 1  ON 96
ci_0048                -1.903133e-03 3 1  ON 97
ci_0049                -4.665112e-03 3 1  ON 98
ci_0050                -5.390979e-03 3 1  ON 99
ci_0051                -3.312838e-03 3 1  ON 100
ci_0052                -3.645649e-03 3 1  ON 101
ci_0053                -4.567853e-03 3 1  ON 102
ci_0054                -4.463459e-03 3 1  ON 103
ci_0055                 6.284988e-03 3 1  ON 104
ci_0056                 6.573860e-03 3 1  ON 105
ci_0057                 4.381094e-03 3 1  ON 106
ci_0058                 4.950632e-03 3 1  ON 107
ci_0059                -5.050356e-03 3 1  ON 108
ci_0060                -4.778739e-03 3 1  ON 109
ci_0061                -3.720802e-03 3 1  ON 110
ci_0062                -3.294952e-03 3 1  ON 111
ci_0063                -8.008927e-03 3 1  ON 112
ci_0064                -9.373284e-03 3 1  ON 113
ci_0065                -5.419445e-03 3 1  ON 114
ci_0066                -5.425132e-03 3 1  ON 115
ci_0067                -4.669175e-03 3 1  ON 116
ci_0068                -5.025511e-03 3 1  ON 117
ci_0069                 4.447529e-03 3 1  ON 118
ci_0070                 4.700574e-03 3 1  ON 119
ci_0071                 5.516724e-04 3 1  ON 120
ci_0072                 2.118625e-04 3 1  ON 121
ci_0073                 4.391950e-03 3 1  ON 122
ci_0074                 4.500989e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.8585
    reference variance = 0.201781
====================================================
  Execution time = 2.1193e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3263e-01
  Total weights = 1.9516e+06
  Execution time = 1.9136e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320073603718
                                         uncertainty =       0.002141887198

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320073603718
                                         uncertainty =       0.002141887198

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400044968
  error estimate for blocks of size 2^( 2) =       0.000412937865
  error estimate for blocks of size 2^( 3) =       0.000426307455
  error estimate for blocks of size 2^( 4) =       0.000439258455
  error estimate for blocks of size 2^( 5) =       0.000451559893
  error estimate for blocks of size 2^( 6) =       0.000457823153
  error estimate for blocks of size 2^( 7) =       0.000464658862

      target function =                  N/A
              le_mean =     -16.905701172754
             les_mean =     286.137836727212
             stat err =       0.000453325091
             autocorr =       1.284109002815
              std dev =       0.565749019345
             le_variance =       0.320071952890

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320405203486
                                         uncertainty =       0.002162734881

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320405203486
                                         uncertainty =       0.002162734881

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400256620
  error estimate for blocks of size 2^( 2) =       0.000413142900
  error estimate for blocks of size 2^( 3) =       0.000426513514
  error estimate for blocks of size 2^( 4) =       0.000439436287
  error estimate for blocks of size 2^( 5) =       0.000451697020
  error estimate for blocks of size 2^( 6) =       0.000457926893
  error estimate for blocks of size 2^( 7) =       0.000464737065

      target function =                  N/A
              le_mean =     -16.905715916181
             les_mean =     286.167676097276
             stat err =       0.000453449316
             autocorr =       1.283454435045
              std dev =       0.566048340648
             le_variance =       0.320410723950

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320391676151
                                         uncertainty =       0.002167257141

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320391676151
                                         uncertainty =       0.002167257141

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400248089
  error estimate for blocks of size 2^( 2) =       0.000413134652
  error estimate for blocks of size 2^( 3) =       0.000426505446
  error estimate for blocks of size 2^( 4) =       0.000439430009
  error estimate for blocks of size 2^( 5) =       0.000451687060
  error estimate for blocks of size 2^( 6) =       0.000457917862
  error estimate for blocks of size 2^( 7) =       0.000464735320

      target function =                  N/A
              le_mean =     -16.905713008812
             les_mean =     286.166265732308
             stat err =       0.000453442563
             autocorr =       1.283470919547
              std dev =       0.566036275346
             le_variance =       0.320397065007

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320042090854
                                         uncertainty =       0.002144041760

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320042090854
                                         uncertainty =       0.002144041760

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400025839
  error estimate for blocks of size 2^( 2) =       0.000412917137
  error estimate for blocks of size 2^( 3) =       0.000426288499
  error estimate for blocks of size 2^( 4) =       0.000439234244
  error estimate for blocks of size 2^( 5) =       0.000451527785
  error estimate for blocks of size 2^( 6) =       0.000457792209
  error estimate for blocks of size 2^( 7) =       0.000464630384

      target function =                  N/A
              le_mean =     -16.905692815538
             les_mean =     286.136816166567
             stat err =       0.000453296156
             autocorr =       1.284067881935
              std dev =       0.565721966293
             le_variance =       0.320041343147


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905701172754        initial
     9.3132e-02     9.3132e-01             2.3205e-03       -16.905715916181  <--
     3.7253e-01     3.7253e+00             7.0059e-04       -16.905713008812
     1.4901e+00     1.4901e+01             2.2976e-04       -16.905692815538

*****************************************************************************
Applying the update for shift_i =   9.3132e-02     and shift_s =   9.3132e-01
*****************************************************************************

  Execution time = 3.0876e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
   uu_0                 3.138005e-01 1 1  ON 0
   uu_1                 1.457750e-01 1 1  ON 1
   uu_2                 4.333412e-02 1 1  ON 2
   uu_3                -2.000210e-02 1 1  ON 3
   uu_4                -6.678932e-02 1 1  ON 4
   uu_5                -1.028599e-01 1 1  ON 5
   uu_6                -1.320870e-01 1 1  ON 6
   uu_7                -1.463624e-01 1 1  ON 7
   uu_8                -1.382737e-01 1 1  ON 8
   uu_9                -1.110945e-01 1 1  ON 9
   ud_0                 4.503888e-01 1 1  ON 10
   ud_1                 1.846796e-01 1 1  ON 11
   ud_2                 6.416193e-02 1 1  ON 12
   ud_3                -7.124479e-03 1 1  ON 13
   ud_4                -6.493558e-02 1 1  ON 14
   ud_5                -1.072650e-01 1 1  ON 15
   ud_6                -1.359371e-01 1 1  ON 16
   ud_7                -1.534878e-01 1 1  ON 17
   ud_8                -1.544449e-01 1 1  ON 18
   ud_9                -1.433146e-01 1 1  ON 19
   eO_0                -7.502032e-01 1 1  ON 20
   eO_1                -4.294477e-01 1 1  ON 21
   eO_2                -1.840643e-02 1 1  ON 22
   eO_3                 2.958642e-01 1 1  ON 23
   eO_4                 5.232721e-01 1 1  ON 24
   eO_5                 4.876885e-01 1 1  ON 25
   eO_6                 2.610934e-01 1 1  ON 26
   eO_7                -4.231068e-02 1 1  ON 27
   eO_8                -2.303701e-01 1 1  ON 28
   eO_9                -9.457963e-02 1 1  ON 29
  eH1_0                -2.628821e-01 1 1  ON 30
  eH1_1                -1.552494e-01 1 1  ON 31
  eH1_2                -1.049995e-01 1 1  ON 32
  eH1_3                -4.887078e-02 1 1  ON 33
  eH1_4                 1.696770e-03 1 1  ON 34
  eH1_5                 3.694553e-02 1 1  ON 35
  eH1_6                 9.961022e-02 1 1  ON 36
  eH1_7                 1.589033e-01 1 1  ON 37
  eH1_8                 1.909064e-01 1 1  ON 38
  eH1_9                 8.489935e-02 1 1  ON 39
  eH2_0                -2.620338e-01 1 1  ON 40
  eH2_1                -1.541154e-01 1 1  ON 41
  eH2_2                -1.036041e-01 1 1  ON 42
  eH2_3                -4.758388e-02 1 1  ON 43
  eH2_4                 3.014279e-03 1 1  ON 44
  eH2_5                 4.016218e-02 1 1  ON 45
  eH2_6                 1.013556e-01 1 1  ON 46
  eH2_7                 1.605784e-01 1 1  ON 47
  eH2_8                 1.960441e-01 1 1  ON 48
  eH2_9                 7.803620e-02 1 1  ON 49
ci_0001                 7.000946e-01 3 1  ON 50
ci_0002                 7.018141e-01 3 1  ON 51
ci_0003                -2.639543e-02 3 1  ON 52
ci_0004                -2.788730e-02 3 1  ON 53
ci_0005                -3.657704e-02 3 1  ON 54
ci_0006                -3.789213e-02 3 1  ON 55
ci_0007                -2.287883e-02 3 1  ON 56
ci_0008                -2.347309e-02 3 1  ON 57
ci_0009                -1.719949e-02 3 1  ON 58
ci_0010                -1.747362e-02 3 1  ON 59
ci_0011                -1.176751e-02 3 1  ON 60
ci_0012                -1.188572e-02 3 1  ON 61
ci_0013                 1.338783e-02 3 1  ON 62
ci_0014                 1.336854e-02 3 1  ON 63
ci_0015                 1.249989e-02 3 1  ON 64
ci_0016                 1.332825e-02 3 1  ON 65
ci_0017                 1.174953e-02 3 1  ON 66
ci_0018                 1.090347e-02 3 1  ON 67
ci_0019                 1.092359e-02 3 1  ON 68
ci_0020                 1.094563e-02 3 1  ON 69
ci_0021                -1.759016e-03 3 1  ON 70
ci_0022                -1.507853e-03 3 1  ON 71
ci_0023                -1.066787e-02 3 1  ON 72
ci_0024                -1.137181e-02 3 1  ON 73
ci_0025                -1.042105e-02 3 1  ON 74
ci_0026                -1.002011e-02 3 1  ON 75
ci_0027                -1.101353e-02 3 1  ON 76
ci_0028                -1.057408e-02 3 1  ON 77
ci_0029                -9.646970e-03 3 1  ON 78
ci_0030                -1.078871e-02 3 1  ON 79
ci_0031                 2.072036e-02 3 1  ON 80
ci_0032                 2.056951e-02 3 1  ON 81
ci_0033                 8.148478e-03 3 1  ON 82
ci_0034                 9.372151e-03 3 1  ON 83
ci_0035                 5.321039e-03 3 1  ON 84
ci_0036                 7.147790e-03 3 1  ON 85
ci_0037                -1.016876e-02 3 1  ON 86
ci_0038                -1.058171e-02 3 1  ON 87
ci_0039                -2.701680e-03 3 1  ON 88
ci_0040                -2.207267e-03 3 1  ON 89
ci_0041                 7.515528e-03 3 1  ON 90
ci_0042                 7.208975e-03 3 1  ON 91
ci_0043                -1.918557e-02 3 1  ON 92
ci_0044                -1.997473e-02 3 1  ON 93
ci_0045                 7.713703e-03 3 1  ON 94
ci_0046                 6.711548e-03 3 1  ON 95
ci_0047                -1.253214e-03 3 1  ON 96
ci_0048                -1.841649e-03 3 1  ON 97
ci_0049                -4.749660e-03 3 1  ON 98
ci_0050                -5.410494e-03 3 1  ON 99
ci_0051                -3.359165e-03 3 1  ON 100
ci_0052                -3.843078e-03 3 1  ON 101
ci_0053                -4.597027e-03 3 1  ON 102
ci_0054                -4.231242e-03 3 1  ON 103
ci_0055                 6.425275e-03 3 1  ON 104
ci_0056                 6.541869e-03 3 1  ON 105
ci_0057                 4.519012e-03 3 1  ON 106
ci_0058                 5.525531e-03 3 1  ON 107
ci_0059                -5.252086e-03 3 1  ON 108
ci_0060                -4.729891e-03 3 1  ON 109
ci_0061                -3.783224e-03 3 1  ON 110
ci_0062                -2.800673e-03 3 1  ON 111
ci_0063                -7.676352e-03 3 1  ON 112
ci_0064                -9.794019e-03 3 1  ON 113
ci_0065                -5.664227e-03 3 1  ON 114
ci_0066                -5.491584e-03 3 1  ON 115
ci_0067                -4.370491e-03 3 1  ON 116
ci_0068                -5.217285e-03 3 1  ON 117
ci_0069                 4.542124e-03 3 1  ON 118
ci_0070                 4.801297e-03 3 1  ON 119
ci_0071                 7.381367e-04 3 1  ON 120
ci_0072                 2.113355e-04 3 1  ON 121
ci_0073                 4.485651e-03 3 1  ON 122
ci_0074                 4.890990e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8127e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.8965
    reference variance = 0.278822
====================================================
  Execution time = 2.1468e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5256e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3543e-01
  Total weights = 1.951536398e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1628e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322825738307
                                         uncertainty =       0.002409627873

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322825738307
                                         uncertainty =       0.002409627873

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401762272
  error estimate for blocks of size 2^( 2) =       0.000414578681
  error estimate for blocks of size 2^( 3) =       0.000427902271
  error estimate for blocks of size 2^( 4) =       0.000440500714
  error estimate for blocks of size 2^( 5) =       0.000452195847
  error estimate for blocks of size 2^( 6) =       0.000461138299
  error estimate for blocks of size 2^( 7) =       0.000468672448

      target function =                  N/A
              le_mean =     -16.905929162677
             les_mean =     286.145873929470
             stat err =       0.000455626827
             autocorr =       1.286116383989
              std dev =       0.568177654185
             le_variance =       0.322825846716


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690592916268e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e-02, overlap shift 2.3283e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905929162639       residual = 2.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905988372739       residual = 3.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905987613681       residual = 9.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905988654581       residual = 8.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905993741800       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905988776455       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905993367800       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905994118324       residual = 7.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905993787443       residual = 4.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905995479143       residual = 7.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905993751809       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905995416508       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905996355149       residual = 4.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905996596787       residual = 4.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.905994505762       residual = 2.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.905995170519       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.905996516122       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.905997113916       residual = 9.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.905997290794       residual = 6.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.905997949960       residual = 3.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.905998369149       residual = 2.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.905998566355       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.905998564612       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.905998290506       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.905998475575       residual = 7.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.3283e-02 is 7.856691e-03

solving harmonic davidson linear method for identity shift 9.3132e-02, overlap shift 9.3132e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905929162639       residual = 2.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905974996268       residual = 2.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905972543312       residual = 5.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905972732933       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905975424257       residual = 9.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905973077270       residual = 7.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905973167789       residual = 7.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905972958806       residual = 4.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905972520408       residual = 3.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905973164115       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905972878493       residual = 9.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905973707187       residual = 8.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905974014463       residual = 2.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905974137697       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.905973882548       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.905974065195       residual = 3.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.3132e-02 is 2.160315e-03

solving harmonic davidson linear method for identity shift 3.7253e-01, overlap shift 3.7253e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905929162639       residual = 2.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905953239088       residual = 8.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905951627226       residual = 3.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905951434875       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905952477989       residual = 5.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905951535694       residual = 5.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905951213299       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905951234243       residual = 7.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905951469214       residual = 4.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905951646082       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905951646292       residual = 5.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.7253e-01 is 9.384834e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.338654 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7658e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
   uu_0                 3.137646e-01 1 1  ON 0
   uu_1                 1.457505e-01 1 1  ON 1
   uu_2                 4.349666e-02 1 1  ON 2
   uu_3                -1.973707e-02 1 1  ON 3
   uu_4                -6.658694e-02 1 1  ON 4
   uu_5                -1.028683e-01 1 1  ON 5
   uu_6                -1.321035e-01 1 1  ON 6
   uu_7                -1.465703e-01 1 1  ON 7
   uu_8                -1.395533e-01 1 1  ON 8
   uu_9                -1.116110e-01 1 1  ON 9
   ud_0                 4.507882e-01 1 1  ON 10
   ud_1                 1.847463e-01 1 1  ON 11
   ud_2                 6.434893e-02 1 1  ON 12
   ud_3                -6.923167e-03 1 1  ON 13
   ud_4                -6.433183e-02 1 1  ON 14
   ud_5                -1.069781e-01 1 1  ON 15
   ud_6                -1.359558e-01 1 1  ON 16
   ud_7                -1.532034e-01 1 1  ON 17
   ud_8                -1.548754e-01 1 1  ON 18
   ud_9                -1.444499e-01 1 1  ON 19
   eO_0                -7.493982e-01 1 1  ON 20
   eO_1                -4.287407e-01 1 1  ON 21
   eO_2                -1.795823e-02 1 1  ON 22
   eO_3                 2.957163e-01 1 1  ON 23
   eO_4                 5.232397e-01 1 1  ON 24
   eO_5                 4.879465e-01 1 1  ON 25
   eO_6                 2.620850e-01 1 1  ON 26
   eO_7                -4.226437e-02 1 1  ON 27
   eO_8                -2.318863e-01 1 1  ON 28
   eO_9                -9.596646e-02 1 1  ON 29
  eH1_0                -2.635259e-01 1 1  ON 30
  eH1_1                -1.556437e-01 1 1  ON 31
  eH1_2                -1.051953e-01 1 1  ON 32
  eH1_3                -4.934619e-02 1 1  ON 33
  eH1_4                 9.699847e-04 1 1  ON 34
  eH1_5                 3.664728e-02 1 1  ON 35
  eH1_6                 9.881694e-02 1 1  ON 36
  eH1_7                 1.587742e-01 1 1  ON 37
  eH1_8                 1.923871e-01 1 1  ON 38
  eH1_9                 8.672590e-02 1 1  ON 39
  eH2_0                -2.625024e-01 1 1  ON 40
  eH2_1                -1.543313e-01 1 1  ON 41
  eH2_2                -1.038598e-01 1 1  ON 42
  eH2_3                -4.802891e-02 1 1  ON 43
  eH2_4                 2.532884e-03 1 1  ON 44
  eH2_5                 3.922090e-02 1 1  ON 45
  eH2_6                 1.008199e-01 1 1  ON 46
  eH2_7                 1.608268e-01 1 1  ON 47
  eH2_8                 1.968993e-01 1 1  ON 48
  eH2_9                 7.998389e-02 1 1  ON 49
ci_0001                 7.008647e-01 3 1  ON 50
ci_0002                 7.011650e-01 3 1  ON 51
ci_0003                -2.826517e-02 3 1  ON 52
ci_0004                -2.770055e-02 3 1  ON 53
ci_0005                -3.735034e-02 3 1  ON 54
ci_0006                -3.692025e-02 3 1  ON 55
ci_0007                -2.071851e-02 3 1  ON 56
ci_0008                -2.174314e-02 3 1  ON 57
ci_0009                -1.721435e-02 3 1  ON 58
ci_0010                -1.786711e-02 3 1  ON 59
ci_0011                -1.149383e-02 3 1  ON 60
ci_0012                -1.190656e-02 3 1  ON 61
ci_0013                 1.249764e-02 3 1  ON 62
ci_0014                 1.272798e-02 3 1  ON 63
ci_0015                 1.278449e-02 3 1  ON 64
ci_0016                 1.349063e-02 3 1  ON 65
ci_0017                 1.161129e-02 3 1  ON 66
ci_0018                 1.086354e-02 3 1  ON 67
ci_0019                 1.175068e-02 3 1  ON 68
ci_0020                 1.094067e-02 3 1  ON 69
ci_0021                -2.408660e-03 3 1  ON 70
ci_0022                -2.100248e-03 3 1  ON 71
ci_0023                -1.004226e-02 3 1  ON 72
ci_0024                -1.112591e-02 3 1  ON 73
ci_0025                -1.048592e-02 3 1  ON 74
ci_0026                -1.016957e-02 3 1  ON 75
ci_0027                -1.012418e-02 3 1  ON 76
ci_0028                -1.095914e-02 3 1  ON 77
ci_0029                -1.046252e-02 3 1  ON 78
ci_0030                -1.025947e-02 3 1  ON 79
ci_0031                 2.067563e-02 3 1  ON 80
ci_0032                 2.006211e-02 3 1  ON 81
ci_0033                 9.960844e-03 3 1  ON 82
ci_0034                 9.665848e-03 3 1  ON 83
ci_0035                 6.278167e-03 3 1  ON 84
ci_0036                 6.362784e-03 3 1  ON 85
ci_0037                -1.093807e-02 3 1  ON 86
ci_0038                -1.008754e-02 3 1  ON 87
ci_0039                -2.855867e-03 3 1  ON 88
ci_0040                -2.926624e-03 3 1  ON 89
ci_0041                 7.615181e-03 3 1  ON 90
ci_0042                 6.614109e-03 3 1  ON 91
ci_0043                -1.862098e-02 3 1  ON 92
ci_0044                -2.024406e-02 3 1  ON 93
ci_0045                 7.145994e-03 3 1  ON 94
ci_0046                 7.173659e-03 3 1  ON 95
ci_0047                -1.828388e-03 3 1  ON 96
ci_0048                -1.646010e-03 3 1  ON 97
ci_0049                -5.062060e-03 3 1  ON 98
ci_0050                -5.614004e-03 3 1  ON 99
ci_0051                -3.545290e-03 3 1  ON 100
ci_0052                -3.103790e-03 3 1  ON 101
ci_0053                -4.387116e-03 3 1  ON 102
ci_0054                -4.455636e-03 3 1  ON 103
ci_0055                 6.275532e-03 3 1  ON 104
ci_0056                 6.327967e-03 3 1  ON 105
ci_0057                 3.983094e-03 3 1  ON 106
ci_0058                 4.381231e-03 3 1  ON 107
ci_0059                -4.848259e-03 3 1  ON 108
ci_0060                -4.658118e-03 3 1  ON 109
ci_0061                -3.857455e-03 3 1  ON 110
ci_0062                -2.630482e-03 3 1  ON 111
ci_0063                -8.603247e-03 3 1  ON 112
ci_0064                -8.868300e-03 3 1  ON 113
ci_0065                -6.125702e-03 3 1  ON 114
ci_0066                -5.572339e-03 3 1  ON 115
ci_0067                -5.109970e-03 3 1  ON 116
ci_0068                -4.645792e-03 3 1  ON 117
ci_0069                 4.714067e-03 3 1  ON 118
ci_0070                 4.098352e-03 3 1  ON 119
ci_0071                 4.998106e-04 3 1  ON 120
ci_0072                 2.198762e-04 3 1  ON 121
ci_0073                 4.416627e-03 3 1  ON 122
ci_0074                 4.517999e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.8292
    reference variance = 0.444492
====================================================
  Execution time = 2.1184e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3120e-01
  Total weights = 1.9517e+06
  Execution time = 1.9065e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320592423078
                                         uncertainty =       0.001732808343

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320592423078
                                         uncertainty =       0.001732808343

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400321179
  error estimate for blocks of size 2^( 2) =       0.000413174228
  error estimate for blocks of size 2^( 3) =       0.000426176536
  error estimate for blocks of size 2^( 4) =       0.000439099829
  error estimate for blocks of size 2^( 5) =       0.000449203043
  error estimate for blocks of size 2^( 6) =       0.000456183127
  error estimate for blocks of size 2^( 7) =       0.000461188225

      target function =                  N/A
              le_mean =     -16.906541446246
             les_mean =     286.220259387733
             stat err =       0.000451418556
             autocorr =       1.271574119349
              std dev =       0.566139640975
             le_variance =       0.320514093083

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320050438711
                                         uncertainty =       0.001735940517

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320050438711
                                         uncertainty =       0.001735940517

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399983879
  error estimate for blocks of size 2^( 2) =       0.000412823492
  error estimate for blocks of size 2^( 3) =       0.000425848507
  error estimate for blocks of size 2^( 4) =       0.000438754494
  error estimate for blocks of size 2^( 5) =       0.000448922520
  error estimate for blocks of size 2^( 6) =       0.000455974139
  error estimate for blocks of size 2^( 7) =       0.000460840180

      target function =                  N/A
              le_mean =     -16.906532570151
             les_mean =     286.327320675954
             stat err =       0.000451122833
             autocorr =       1.272051344773
              std dev =       0.565662627022
             le_variance =       0.319974207609

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320159187023
                                         uncertainty =       0.001700042536

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320159187023
                                         uncertainty =       0.001700042536

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400052047
  error estimate for blocks of size 2^( 2) =       0.000412913100
  error estimate for blocks of size 2^( 3) =       0.000425968678
  error estimate for blocks of size 2^( 4) =       0.000438881684
  error estimate for blocks of size 2^( 5) =       0.000449038292
  error estimate for blocks of size 2^( 6) =       0.000456105721
  error estimate for blocks of size 2^( 7) =       0.000460989907

      target function =                  N/A
              le_mean =     -16.906545938245
             les_mean =     286.168483544847
             stat err =       0.000451253901
             autocorr =       1.272356883025
              std dev =       0.565759031176
             le_variance =       0.320083281357

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320093499389
                                         uncertainty =       0.001730980469

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320093499389
                                         uncertainty =       0.001730980469

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400010347
  error estimate for blocks of size 2^( 2) =       0.000412860889
  error estimate for blocks of size 2^( 3) =       0.000425874172
  error estimate for blocks of size 2^( 4) =       0.000438814655
  error estimate for blocks of size 2^( 5) =       0.000448966378
  error estimate for blocks of size 2^( 6) =       0.000455963500
  error estimate for blocks of size 2^( 7) =       0.000461013178

      target function =                  N/A
              le_mean =     -16.906512368753
             les_mean =     286.214817632467
             stat err =       0.000451189428
             autocorr =       1.272258554153
              std dev =       0.565700057130
             le_variance =       0.320016554637


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906541446246        initial
     2.3283e-02     2.3283e-01             7.8567e-03       -16.906532570151
     9.3132e-02     9.3132e-01             2.1603e-03       -16.906545938245  <--
     3.7253e-01     3.7253e+00             9.3848e-04       -16.906512368753

*****************************************************************************
Applying the update for shift_i =   9.3132e-02     and shift_s =   9.3132e-01
*****************************************************************************

  Execution time = 3.0825e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
   uu_0                 3.137646e-01 1 1  ON 0
   uu_1                 1.457505e-01 1 1  ON 1
   uu_2                 4.349666e-02 1 1  ON 2
   uu_3                -1.973707e-02 1 1  ON 3
   uu_4                -6.658694e-02 1 1  ON 4
   uu_5                -1.028683e-01 1 1  ON 5
   uu_6                -1.321035e-01 1 1  ON 6
   uu_7                -1.465703e-01 1 1  ON 7
   uu_8                -1.395533e-01 1 1  ON 8
   uu_9                -1.116110e-01 1 1  ON 9
   ud_0                 4.507882e-01 1 1  ON 10
   ud_1                 1.847463e-01 1 1  ON 11
   ud_2                 6.434893e-02 1 1  ON 12
   ud_3                -6.923167e-03 1 1  ON 13
   ud_4                -6.433183e-02 1 1  ON 14
   ud_5                -1.069781e-01 1 1  ON 15
   ud_6                -1.359558e-01 1 1  ON 16
   ud_7                -1.532034e-01 1 1  ON 17
   ud_8                -1.548754e-01 1 1  ON 18
   ud_9                -1.444499e-01 1 1  ON 19
   eO_0                -7.493982e-01 1 1  ON 20
   eO_1                -4.287407e-01 1 1  ON 21
   eO_2                -1.795823e-02 1 1  ON 22
   eO_3                 2.957163e-01 1 1  ON 23
   eO_4                 5.232397e-01 1 1  ON 24
   eO_5                 4.879465e-01 1 1  ON 25
   eO_6                 2.620850e-01 1 1  ON 26
   eO_7                -4.226437e-02 1 1  ON 27
   eO_8                -2.318863e-01 1 1  ON 28
   eO_9                -9.596646e-02 1 1  ON 29
  eH1_0                -2.635259e-01 1 1  ON 30
  eH1_1                -1.556437e-01 1 1  ON 31
  eH1_2                -1.051953e-01 1 1  ON 32
  eH1_3                -4.934619e-02 1 1  ON 33
  eH1_4                 9.699847e-04 1 1  ON 34
  eH1_5                 3.664728e-02 1 1  ON 35
  eH1_6                 9.881694e-02 1 1  ON 36
  eH1_7                 1.587742e-01 1 1  ON 37
  eH1_8                 1.923871e-01 1 1  ON 38
  eH1_9                 8.672590e-02 1 1  ON 39
  eH2_0                -2.625024e-01 1 1  ON 40
  eH2_1                -1.543313e-01 1 1  ON 41
  eH2_2                -1.038598e-01 1 1  ON 42
  eH2_3                -4.802891e-02 1 1  ON 43
  eH2_4                 2.532884e-03 1 1  ON 44
  eH2_5                 3.922090e-02 1 1  ON 45
  eH2_6                 1.008199e-01 1 1  ON 46
  eH2_7                 1.608268e-01 1 1  ON 47
  eH2_8                 1.968993e-01 1 1  ON 48
  eH2_9                 7.998389e-02 1 1  ON 49
ci_0001                 7.008647e-01 3 1  ON 50
ci_0002                 7.011650e-01 3 1  ON 51
ci_0003                -2.826517e-02 3 1  ON 52
ci_0004                -2.770055e-02 3 1  ON 53
ci_0005                -3.735034e-02 3 1  ON 54
ci_0006                -3.692025e-02 3 1  ON 55
ci_0007                -2.071851e-02 3 1  ON 56
ci_0008                -2.174314e-02 3 1  ON 57
ci_0009                -1.721435e-02 3 1  ON 58
ci_0010                -1.786711e-02 3 1  ON 59
ci_0011                -1.149383e-02 3 1  ON 60
ci_0012                -1.190656e-02 3 1  ON 61
ci_0013                 1.249764e-02 3 1  ON 62
ci_0014                 1.272798e-02 3 1  ON 63
ci_0015                 1.278449e-02 3 1  ON 64
ci_0016                 1.349063e-02 3 1  ON 65
ci_0017                 1.161129e-02 3 1  ON 66
ci_0018                 1.086354e-02 3 1  ON 67
ci_0019                 1.175068e-02 3 1  ON 68
ci_0020                 1.094067e-02 3 1  ON 69
ci_0021                -2.408660e-03 3 1  ON 70
ci_0022                -2.100248e-03 3 1  ON 71
ci_0023                -1.004226e-02 3 1  ON 72
ci_0024                -1.112591e-02 3 1  ON 73
ci_0025                -1.048592e-02 3 1  ON 74
ci_0026                -1.016957e-02 3 1  ON 75
ci_0027                -1.012418e-02 3 1  ON 76
ci_0028                -1.095914e-02 3 1  ON 77
ci_0029                -1.046252e-02 3 1  ON 78
ci_0030                -1.025947e-02 3 1  ON 79
ci_0031                 2.067563e-02 3 1  ON 80
ci_0032                 2.006211e-02 3 1  ON 81
ci_0033                 9.960844e-03 3 1  ON 82
ci_0034                 9.665848e-03 3 1  ON 83
ci_0035                 6.278167e-03 3 1  ON 84
ci_0036                 6.362784e-03 3 1  ON 85
ci_0037                -1.093807e-02 3 1  ON 86
ci_0038                -1.008754e-02 3 1  ON 87
ci_0039                -2.855867e-03 3 1  ON 88
ci_0040                -2.926624e-03 3 1  ON 89
ci_0041                 7.615181e-03 3 1  ON 90
ci_0042                 6.614109e-03 3 1  ON 91
ci_0043                -1.862098e-02 3 1  ON 92
ci_0044                -2.024406e-02 3 1  ON 93
ci_0045                 7.145994e-03 3 1  ON 94
ci_0046                 7.173659e-03 3 1  ON 95
ci_0047                -1.828388e-03 3 1  ON 96
ci_0048                -1.646010e-03 3 1  ON 97
ci_0049                -5.062060e-03 3 1  ON 98
ci_0050                -5.614004e-03 3 1  ON 99
ci_0051                -3.545290e-03 3 1  ON 100
ci_0052                -3.103790e-03 3 1  ON 101
ci_0053                -4.387116e-03 3 1  ON 102
ci_0054                -4.455636e-03 3 1  ON 103
ci_0055                 6.275532e-03 3 1  ON 104
ci_0056                 6.327967e-03 3 1  ON 105
ci_0057                 3.983094e-03 3 1  ON 106
ci_0058                 4.381231e-03 3 1  ON 107
ci_0059                -4.848259e-03 3 1  ON 108
ci_0060                -4.658118e-03 3 1  ON 109
ci_0061                -3.857455e-03 3 1  ON 110
ci_0062                -2.630482e-03 3 1  ON 111
ci_0063                -8.603247e-03 3 1  ON 112
ci_0064                -8.868300e-03 3 1  ON 113
ci_0065                -6.125702e-03 3 1  ON 114
ci_0066                -5.572339e-03 3 1  ON 115
ci_0067                -5.109970e-03 3 1  ON 116
ci_0068                -4.645792e-03 3 1  ON 117
ci_0069                 4.714067e-03 3 1  ON 118
ci_0070                 4.098352e-03 3 1  ON 119
ci_0071                 4.998106e-04 3 1  ON 120
ci_0072                 2.198762e-04 3 1  ON 121
ci_0073                 4.416627e-03 3 1  ON 122
ci_0074                 4.517999e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8508e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.9707
    reference variance = 0.306175
====================================================
  Execution time = 2.1493e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5254e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3822e-01
  Total weights = 1.951581838e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1275e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324206793014
                                         uncertainty =       0.002471800307

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324206793014
                                         uncertainty =       0.002471800307

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402621424
  error estimate for blocks of size 2^( 2) =       0.000415707768
  error estimate for blocks of size 2^( 3) =       0.000428413488
  error estimate for blocks of size 2^( 4) =       0.000440512884
  error estimate for blocks of size 2^( 5) =       0.000450324842
  error estimate for blocks of size 2^( 6) =       0.000459024045
  error estimate for blocks of size 2^( 7) =       0.000462178871

      target function =                  N/A
              le_mean =     -16.906809943775
             les_mean =     286.178437564318
             stat err =       0.000453010161
             autocorr =       1.265966243980
              std dev =       0.569392677885
             le_variance =       0.324208021629


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690680994378e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e-02, overlap shift 2.3283e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906809943779       residual = 2.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906833843965       residual = 2.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906833450131       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906836250223       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906838743176       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906841299089       residual = 7.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906845185687       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906850692730       residual = 8.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906850413954       residual = 4.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906849787576       residual = 6.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906849746113       residual = 6.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906850875579       residual = 8.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906854072994       residual = 6.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906854619321       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906853597774       residual = 9.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.906853492269       residual = 8.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.906853468172       residual = 8.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.906852998816       residual = 4.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.906852916094       residual = 2.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.906852779992       residual = 1.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.906852768932       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.906852641793       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.906852356420       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.906852241540       residual = 7.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.3283e-02 is 7.044974e-03

solving harmonic davidson linear method for identity shift 9.3132e-02, overlap shift 9.3132e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906809943779       residual = 2.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906828626431       residual = 1.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906828124550       residual = 8.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906829606016       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906830625699       residual = 7.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906832643434       residual = 4.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906834891927       residual = 4.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906837526063       residual = 3.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906837582717       residual = 2.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906837482669       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906837281305       residual = 6.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906836721504       residual = 6.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906836652516       residual = 2.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906836633102       residual = 9.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.3132e-02 is 1.757343e-03

solving harmonic davidson linear method for identity shift 3.7253e-01, overlap shift 3.7253e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906809943779       residual = 2.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906819917306       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906819645239       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906820100319       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906820449911       residual = 5.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906822090885       residual = 3.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906822475927       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906823221703       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906823321531       residual = 4.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906822956959       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906822889950       residual = 6.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.7253e-01 is 7.973802e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.356884 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7646e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
   uu_0                 3.131715e-01 1 1  ON 0
   uu_1                 1.453426e-01 1 1  ON 1
   uu_2                 4.331872e-02 1 1  ON 2
   uu_3                -2.001012e-02 1 1  ON 3
   uu_4                -6.656937e-02 1 1  ON 4
   uu_5                -1.029371e-01 1 1  ON 5
   uu_6                -1.318300e-01 1 1  ON 6
   uu_7                -1.470332e-01 1 1  ON 7
   uu_8                -1.403445e-01 1 1  ON 8
   uu_9                -1.113427e-01 1 1  ON 9
   ud_0                 4.504585e-01 1 1  ON 10
   ud_1                 1.848644e-01 1 1  ON 11
   ud_2                 6.446204e-02 1 1  ON 12
   ud_3                -6.784853e-03 1 1  ON 13
   ud_4                -6.468937e-02 1 1  ON 14
   ud_5                -1.070227e-01 1 1  ON 15
   ud_6                -1.357013e-01 1 1  ON 16
   ud_7                -1.534531e-01 1 1  ON 17
   ud_8                -1.548269e-01 1 1  ON 18
   ud_9                -1.441872e-01 1 1  ON 19
   eO_0                -7.490817e-01 1 1  ON 20
   eO_1                -4.282753e-01 1 1  ON 21
   eO_2                -1.821030e-02 1 1  ON 22
   eO_3                 2.954868e-01 1 1  ON 23
   eO_4                 5.239650e-01 1 1  ON 24
   eO_5                 4.884367e-01 1 1  ON 25
   eO_6                 2.623297e-01 1 1  ON 26
   eO_7                -4.218929e-02 1 1  ON 27
   eO_8                -2.325417e-01 1 1  ON 28
   eO_9                -9.702819e-02 1 1  ON 29
  eH1_0                -2.642235e-01 1 1  ON 30
  eH1_1                -1.558868e-01 1 1  ON 31
  eH1_2                -1.057499e-01 1 1  ON 32
  eH1_3                -4.997040e-02 1 1  ON 33
  eH1_4                 8.555579e-04 1 1  ON 34
  eH1_5                 3.624619e-02 1 1  ON 35
  eH1_6                 9.843920e-02 1 1  ON 36
  eH1_7                 1.588694e-01 1 1  ON 37
  eH1_8                 1.929520e-01 1 1  ON 38
  eH1_9                 8.848325e-02 1 1  ON 39
  eH2_0                -2.638273e-01 1 1  ON 40
  eH2_1                -1.551956e-01 1 1  ON 41
  eH2_2                -1.045251e-01 1 1  ON 42
  eH2_3                -4.840224e-02 1 1  ON 43
  eH2_4                 1.947815e-03 1 1  ON 44
  eH2_5                 3.905894e-02 1 1  ON 45
  eH2_6                 1.010317e-01 1 1  ON 46
  eH2_7                 1.618274e-01 1 1  ON 47
  eH2_8                 1.979503e-01 1 1  ON 48
  eH2_9                 8.164600e-02 1 1  ON 49
ci_0001                 7.004238e-01 3 1  ON 50
ci_0002                 7.015131e-01 3 1  ON 51
ci_0003                -2.721086e-02 3 1  ON 52
ci_0004                -2.748523e-02 3 1  ON 53
ci_0005                -3.794746e-02 3 1  ON 54
ci_0006                -3.754002e-02 3 1  ON 55
ci_0007                -1.998027e-02 3 1  ON 56
ci_0008                -2.114764e-02 3 1  ON 57
ci_0009                -1.865903e-02 3 1  ON 58
ci_0010                -1.672565e-02 3 1  ON 59
ci_0011                -1.172674e-02 3 1  ON 60
ci_0012                -1.134945e-02 3 1  ON 61
ci_0013                 1.321057e-02 3 1  ON 62
ci_0014                 1.284816e-02 3 1  ON 63
ci_0015                 1.389435e-02 3 1  ON 64
ci_0016                 1.386895e-02 3 1  ON 65
ci_0017                 1.159529e-02 3 1  ON 66
ci_0018                 1.104775e-02 3 1  ON 67
ci_0019                 1.167227e-02 3 1  ON 68
ci_0020                 1.132840e-02 3 1  ON 69
ci_0021                -3.553463e-03 3 1  ON 70
ci_0022                -1.173872e-03 3 1  ON 71
ci_0023                -1.033808e-02 3 1  ON 72
ci_0024                -1.121263e-02 3 1  ON 73
ci_0025                -1.178462e-02 3 1  ON 74
ci_0026                -9.793436e-03 3 1  ON 75
ci_0027                -1.089572e-02 3 1  ON 76
ci_0028                -1.163982e-02 3 1  ON 77
ci_0029                -1.111710e-02 3 1  ON 78
ci_0030                -1.085043e-02 3 1  ON 79
ci_0031                 2.046905e-02 3 1  ON 80
ci_0032                 2.032512e-02 3 1  ON 81
ci_0033                 1.037129e-02 3 1  ON 82
ci_0034                 1.043133e-02 3 1  ON 83
ci_0035                 6.429777e-03 3 1  ON 84
ci_0036                 6.555050e-03 3 1  ON 85
ci_0037                -1.049304e-02 3 1  ON 86
ci_0038                -1.054367e-02 3 1  ON 87
ci_0039                -3.176361e-03 3 1  ON 88
ci_0040                -2.492525e-03 3 1  ON 89
ci_0041                 6.908884e-03 3 1  ON 90
ci_0042                 6.742611e-03 3 1  ON 91
ci_0043                -1.875550e-02 3 1  ON 92
ci_0044                -2.007897e-02 3 1  ON 93
ci_0045                 7.313205e-03 3 1  ON 94
ci_0046                 7.112162e-03 3 1  ON 95
ci_0047                -1.352052e-03 3 1  ON 96
ci_0048                -2.285447e-03 3 1  ON 97
ci_0049                -4.921015e-03 3 1  ON 98
ci_0050                -5.150993e-03 3 1  ON 99
ci_0051                -3.397358e-03 3 1  ON 100
ci_0052                -3.390229e-03 3 1  ON 101
ci_0053                -4.102673e-03 3 1  ON 102
ci_0054                -4.340316e-03 3 1  ON 103
ci_0055                 6.102196e-03 3 1  ON 104
ci_0056                 5.864769e-03 3 1  ON 105
ci_0057                 4.656879e-03 3 1  ON 106
ci_0058                 4.583631e-03 3 1  ON 107
ci_0059                -5.062659e-03 3 1  ON 108
ci_0060                -5.380564e-03 3 1  ON 109
ci_0061                -3.392310e-03 3 1  ON 110
ci_0062                -3.562366e-03 3 1  ON 111
ci_0063                -9.057205e-03 3 1  ON 112
ci_0064                -8.891833e-03 3 1  ON 113
ci_0065                -4.940643e-03 3 1  ON 114
ci_0066                -5.508313e-03 3 1  ON 115
ci_0067                -4.962671e-03 3 1  ON 116
ci_0068                -4.785241e-03 3 1  ON 117
ci_0069                 4.009295e-03 3 1  ON 118
ci_0070                 4.091944e-03 3 1  ON 119
ci_0071                 1.262545e-04 3 1  ON 120
ci_0072                 9.668351e-05 3 1  ON 121
ci_0073                 4.384993e-03 3 1  ON 122
ci_0074                 5.280798e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.7985
    reference variance = 0.478752
====================================================
  Execution time = 2.1111e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3082e-01
  Total weights = 1.9516e+06
  Execution time = 1.9138e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320324271650
                                         uncertainty =       0.001862494620

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320324271650
                                         uncertainty =       0.001862494620

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400231297
  error estimate for blocks of size 2^( 2) =       0.000413019933
  error estimate for blocks of size 2^( 3) =       0.000426945394
  error estimate for blocks of size 2^( 4) =       0.000439717865
  error estimate for blocks of size 2^( 5) =       0.000450737858
  error estimate for blocks of size 2^( 6) =       0.000459904098
  error estimate for blocks of size 2^( 7) =       0.000464854540

      target function =                  N/A
              le_mean =     -16.906018872614
             les_mean =     286.147232802939
             stat err =       0.000453803590
             autocorr =       1.285623383763
              std dev =       0.566012527929
             le_variance =       0.320370181773

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320084059971
                                         uncertainty =       0.001857630825

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320084059971
                                         uncertainty =       0.001857630825

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400087500
  error estimate for blocks of size 2^( 2) =       0.000412887813
  error estimate for blocks of size 2^( 3) =       0.000426831008
  error estimate for blocks of size 2^( 4) =       0.000439616977
  error estimate for blocks of size 2^( 5) =       0.000450662914
  error estimate for blocks of size 2^( 6) =       0.000459843082
  error estimate for blocks of size 2^( 7) =       0.000464726868

      target function =                  N/A
              le_mean =     -16.905955969257
             les_mean =     286.173845815340
             stat err =       0.000453712460
             autocorr =       1.286031026820
              std dev =       0.565809169022
             le_variance =       0.320140015750

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320562278421
                                         uncertainty =       0.001885355298

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320562278421
                                         uncertainty =       0.001885355298

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400389140
  error estimate for blocks of size 2^( 2) =       0.000413185908
  error estimate for blocks of size 2^( 3) =       0.000427125285
  error estimate for blocks of size 2^( 4) =       0.000439916987
  error estimate for blocks of size 2^( 5) =       0.000450966234
  error estimate for blocks of size 2^( 6) =       0.000460156667
  error estimate for blocks of size 2^( 7) =       0.000464986031

      target function =                  N/A
              le_mean =     -16.906000082243
             les_mean =     286.157513104726
             stat err =       0.000454006480
             autocorr =       1.285758856766
              std dev =       0.566235751888
             le_variance =       0.320622926716

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320037056486
                                         uncertainty =       0.001860843055

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320037056486
                                         uncertainty =       0.001860843055

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400054074
  error estimate for blocks of size 2^( 2) =       0.000412843236
  error estimate for blocks of size 2^( 3) =       0.000426769337
  error estimate for blocks of size 2^( 4) =       0.000439543760
  error estimate for blocks of size 2^( 5) =       0.000450581189
  error estimate for blocks of size 2^( 6) =       0.000459789079
  error estimate for blocks of size 2^( 7) =       0.000464699772

      target function =                  N/A
              le_mean =     -16.905965843455
             les_mean =     286.222621337058
             stat err =       0.000453653450
             autocorr =       1.285911386897
              std dev =       0.565761896491
             le_variance =       0.320086523522


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906018872614        initial  <--
     2.3283e-02     2.3283e-01             7.0450e-03       -16.905955969257
     9.3132e-02     9.3132e-01             1.7573e-03       -16.906000082243
     3.7253e-01     3.7253e+00             7.9738e-04       -16.905965843455

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.7800
  </log>
  <optVariables href="H2O.s034.opt.xml">
   uu_0                 3.137646e-01 1 1  ON 0
   uu_1                 1.457505e-01 1 1  ON 1
   uu_2                 4.349666e-02 1 1  ON 2
   uu_3                -1.973707e-02 1 1  ON 3
   uu_4                -6.658694e-02 1 1  ON 4
   uu_5                -1.028683e-01 1 1  ON 5
   uu_6                -1.321035e-01 1 1  ON 6
   uu_7                -1.465703e-01 1 1  ON 7
   uu_8                -1.395533e-01 1 1  ON 8
   uu_9                -1.116110e-01 1 1  ON 9
   ud_0                 4.507882e-01 1 1  ON 10
   ud_1                 1.847463e-01 1 1  ON 11
   ud_2                 6.434893e-02 1 1  ON 12
   ud_3                -6.923167e-03 1 1  ON 13
   ud_4                -6.433183e-02 1 1  ON 14
   ud_5                -1.069781e-01 1 1  ON 15
   ud_6                -1.359558e-01 1 1  ON 16
   ud_7                -1.532034e-01 1 1  ON 17
   ud_8                -1.548754e-01 1 1  ON 18
   ud_9                -1.444499e-01 1 1  ON 19
   eO_0                -7.493982e-01 1 1  ON 20
   eO_1                -4.287407e-01 1 1  ON 21
   eO_2                -1.795823e-02 1 1  ON 22
   eO_3                 2.957163e-01 1 1  ON 23
   eO_4                 5.232397e-01 1 1  ON 24
   eO_5                 4.879465e-01 1 1  ON 25
   eO_6                 2.620850e-01 1 1  ON 26
   eO_7                -4.226437e-02 1 1  ON 27
   eO_8                -2.318863e-01 1 1  ON 28
   eO_9                -9.596646e-02 1 1  ON 29
  eH1_0                -2.635259e-01 1 1  ON 30
  eH1_1                -1.556437e-01 1 1  ON 31
  eH1_2                -1.051953e-01 1 1  ON 32
  eH1_3                -4.934619e-02 1 1  ON 33
  eH1_4                 9.699847e-04 1 1  ON 34
  eH1_5                 3.664728e-02 1 1  ON 35
  eH1_6                 9.881694e-02 1 1  ON 36
  eH1_7                 1.587742e-01 1 1  ON 37
  eH1_8                 1.923871e-01 1 1  ON 38
  eH1_9                 8.672590e-02 1 1  ON 39
  eH2_0                -2.625024e-01 1 1  ON 40
  eH2_1                -1.543313e-01 1 1  ON 41
  eH2_2                -1.038598e-01 1 1  ON 42
  eH2_3                -4.802891e-02 1 1  ON 43
  eH2_4                 2.532884e-03 1 1  ON 44
  eH2_5                 3.922090e-02 1 1  ON 45
  eH2_6                 1.008199e-01 1 1  ON 46
  eH2_7                 1.608268e-01 1 1  ON 47
  eH2_8                 1.968993e-01 1 1  ON 48
  eH2_9                 7.998389e-02 1 1  ON 49
ci_0001                 7.008647e-01 3 1  ON 50
ci_0002                 7.011650e-01 3 1  ON 51
ci_0003                -2.826517e-02 3 1  ON 52
ci_0004                -2.770055e-02 3 1  ON 53
ci_0005                -3.735034e-02 3 1  ON 54
ci_0006                -3.692025e-02 3 1  ON 55
ci_0007                -2.071851e-02 3 1  ON 56
ci_0008                -2.174314e-02 3 1  ON 57
ci_0009                -1.721435e-02 3 1  ON 58
ci_0010                -1.786711e-02 3 1  ON 59
ci_0011                -1.149383e-02 3 1  ON 60
ci_0012                -1.190656e-02 3 1  ON 61
ci_0013                 1.249764e-02 3 1  ON 62
ci_0014                 1.272798e-02 3 1  ON 63
ci_0015                 1.278449e-02 3 1  ON 64
ci_0016                 1.349063e-02 3 1  ON 65
ci_0017                 1.161129e-02 3 1  ON 66
ci_0018                 1.086354e-02 3 1  ON 67
ci_0019                 1.175068e-02 3 1  ON 68
ci_0020                 1.094067e-02 3 1  ON 69
ci_0021                -2.408660e-03 3 1  ON 70
ci_0022                -2.100248e-03 3 1  ON 71
ci_0023                -1.004226e-02 3 1  ON 72
ci_0024                -1.112591e-02 3 1  ON 73
ci_0025                -1.048592e-02 3 1  ON 74
ci_0026                -1.016957e-02 3 1  ON 75
ci_0027                -1.012418e-02 3 1  ON 76
ci_0028                -1.095914e-02 3 1  ON 77
ci_0029                -1.046252e-02 3 1  ON 78
ci_0030                -1.025947e-02 3 1  ON 79
ci_0031                 2.067563e-02 3 1  ON 80
ci_0032                 2.006211e-02 3 1  ON 81
ci_0033                 9.960844e-03 3 1  ON 82
ci_0034                 9.665848e-03 3 1  ON 83
ci_0035                 6.278167e-03 3 1  ON 84
ci_0036                 6.362784e-03 3 1  ON 85
ci_0037                -1.093807e-02 3 1  ON 86
ci_0038                -1.008754e-02 3 1  ON 87
ci_0039                -2.855867e-03 3 1  ON 88
ci_0040                -2.926624e-03 3 1  ON 89
ci_0041                 7.615181e-03 3 1  ON 90
ci_0042                 6.614109e-03 3 1  ON 91
ci_0043                -1.862098e-02 3 1  ON 92
ci_0044                -2.024406e-02 3 1  ON 93
ci_0045                 7.145994e-03 3 1  ON 94
ci_0046                 7.173659e-03 3 1  ON 95
ci_0047                -1.828388e-03 3 1  ON 96
ci_0048                -1.646010e-03 3 1  ON 97
ci_0049                -5.062060e-03 3 1  ON 98
ci_0050                -5.614004e-03 3 1  ON 99
ci_0051                -3.545290e-03 3 1  ON 100
ci_0052                -3.103790e-03 3 1  ON 101
ci_0053                -4.387116e-03 3 1  ON 102
ci_0054                -4.455636e-03 3 1  ON 103
ci_0055                 6.275532e-03 3 1  ON 104
ci_0056                 6.327967e-03 3 1  ON 105
ci_0057                 3.983094e-03 3 1  ON 106
ci_0058                 4.381231e-03 3 1  ON 107
ci_0059                -4.848259e-03 3 1  ON 108
ci_0060                -4.658118e-03 3 1  ON 109
ci_0061                -3.857455e-03 3 1  ON 110
ci_0062                -2.630482e-03 3 1  ON 111
ci_0063                -8.603247e-03 3 1  ON 112
ci_0064                -8.868300e-03 3 1  ON 113
ci_0065                -6.125702e-03 3 1  ON 114
ci_0066                -5.572339e-03 3 1  ON 115
ci_0067                -5.109970e-03 3 1  ON 116
ci_0068                -4.645792e-03 3 1  ON 117
ci_0069                 4.714067e-03 3 1  ON 118
ci_0070                 4.098352e-03 3 1  ON 119
ci_0071                 4.998106e-04 3 1  ON 120
ci_0072                 2.198762e-04 3 1  ON 121
ci_0073                 4.416627e-03 3 1  ON 122
ci_0074                 4.517999e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8449e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.938
    reference variance = 0.347208
====================================================
  Execution time = 2.1114e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5257e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3236e-01
  Total weights = 1.952023821e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0783e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321238415418
                                         uncertainty =       0.002185713262

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321238415418
                                         uncertainty =       0.002185713262

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400751845
  error estimate for blocks of size 2^( 2) =       0.000413657289
  error estimate for blocks of size 2^( 3) =       0.000426461688
  error estimate for blocks of size 2^( 4) =       0.000438434726
  error estimate for blocks of size 2^( 5) =       0.000449688031
  error estimate for blocks of size 2^( 6) =       0.000457965262
  error estimate for blocks of size 2^( 7) =       0.000463306987

      target function =                  N/A
              le_mean =     -16.906362279589
             les_mean =     286.157443480777
             stat err =       0.000452348752
             autocorr =       1.274077161515
              std dev =       0.566748694498
             le_variance =       0.321204082715


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690636227959e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e-01, overlap shift 2.3283e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906362279579       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906360450157       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906360754116       residual = 7.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906360047600       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906361084517       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906361419955       residual = 6.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906362000868       residual = 3.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906362738477       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906363440413       residual = 9.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906363390016       residual = 5.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906363276305       residual = 3.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906363083412       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906362977658       residual = 3.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.3283e-01 is 9.252089e-04

solving harmonic davidson linear method for identity shift 9.3132e-01, overlap shift 9.3132e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906362279579       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906361564314       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906361643176       residual = 5.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906361390091       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906361791302       residual = 8.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906361974809       residual = 3.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906361944781       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906362181462       residual = 8.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906362410644       residual = 2.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906362422423       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906362372484       residual = 5.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.3132e-01 is 3.630901e-04

solving harmonic davidson linear method for identity shift 3.7253e+00, overlap shift 3.7253e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906362279579       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906362071416       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906362089917       residual = 4.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906362022998       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906362143743       residual = 8.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906362193980       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906362162860       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906362214536       residual = 6.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906362274508       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906362278031       residual = 5.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.7253e+00 is 1.055521e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.367050 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7210e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
   uu_0                 3.135955e-01 1 1  ON 0
   uu_1                 1.457047e-01 1 1  ON 1
   uu_2                 4.348089e-02 1 1  ON 2
   uu_3                -1.977656e-02 1 1  ON 3
   uu_4                -6.644467e-02 1 1  ON 4
   uu_5                -1.028454e-01 1 1  ON 5
   uu_6                -1.318809e-01 1 1  ON 6
   uu_7                -1.466573e-01 1 1  ON 7
   uu_8                -1.396882e-01 1 1  ON 8
   uu_9                -1.116873e-01 1 1  ON 9
   ud_0                 4.508603e-01 1 1  ON 10
   ud_1                 1.848851e-01 1 1  ON 11
   ud_2                 6.434695e-02 1 1  ON 12
   ud_3                -6.902402e-03 1 1  ON 13
   ud_4                -6.433085e-02 1 1  ON 14
   ud_5                -1.068879e-01 1 1  ON 15
   ud_6                -1.358484e-01 1 1  ON 16
   ud_7                -1.532517e-01 1 1  ON 17
   ud_8                -1.549572e-01 1 1  ON 18
   ud_9                -1.445782e-01 1 1  ON 19
   eO_0                -7.495035e-01 1 1  ON 20
   eO_1                -4.287312e-01 1 1  ON 21
   eO_2                -1.777872e-02 1 1  ON 22
   eO_3                 2.958571e-01 1 1  ON 23
   eO_4                 5.232753e-01 1 1  ON 24
   eO_5                 4.879340e-01 1 1  ON 25
   eO_6                 2.621677e-01 1 1  ON 26
   eO_7                -4.228209e-02 1 1  ON 27
   eO_8                -2.320174e-01 1 1  ON 28
   eO_9                -9.612120e-02 1 1  ON 29
  eH1_0                -2.635394e-01 1 1  ON 30
  eH1_1                -1.556448e-01 1 1  ON 31
  eH1_2                -1.052832e-01 1 1  ON 32
  eH1_3                -4.947945e-02 1 1  ON 33
  eH1_4                 9.300857e-04 1 1  ON 34
  eH1_5                 3.667524e-02 1 1  ON 35
  eH1_6                 9.875999e-02 1 1  ON 36
  eH1_7                 1.587935e-01 1 1  ON 37
  eH1_8                 1.924896e-01 1 1  ON 38
  eH1_9                 8.688994e-02 1 1  ON 39
  eH2_0                -2.625372e-01 1 1  ON 40
  eH2_1                -1.542476e-01 1 1  ON 41
  eH2_2                -1.039732e-01 1 1  ON 42
  eH2_3                -4.808982e-02 1 1  ON 43
  eH2_4                 2.480197e-03 1 1  ON 44
  eH2_5                 3.911439e-02 1 1  ON 45
  eH2_6                 1.008185e-01 1 1  ON 46
  eH2_7                 1.608213e-01 1 1  ON 47
  eH2_8                 1.969943e-01 1 1  ON 48
  eH2_9                 8.018289e-02 1 1  ON 49
ci_0001                 7.008777e-01 3 1  ON 50
ci_0002                 7.011622e-01 3 1  ON 51
ci_0003                -2.794058e-02 3 1  ON 52
ci_0004                -2.761817e-02 3 1  ON 53
ci_0005                -3.722013e-02 3 1  ON 54
ci_0006                -3.670362e-02 3 1  ON 55
ci_0007                -2.095975e-02 3 1  ON 56
ci_0008                -2.176093e-02 3 1  ON 57
ci_0009                -1.734774e-02 3 1  ON 58
ci_0010                -1.792437e-02 3 1  ON 59
ci_0011                -1.144534e-02 3 1  ON 60
ci_0012                -1.200036e-02 3 1  ON 61
ci_0013                 1.269897e-02 3 1  ON 62
ci_0014                 1.272488e-02 3 1  ON 63
ci_0015                 1.288715e-02 3 1  ON 64
ci_0016                 1.342807e-02 3 1  ON 65
ci_0017                 1.157498e-02 3 1  ON 66
ci_0018                 1.085792e-02 3 1  ON 67
ci_0019                 1.151055e-02 3 1  ON 68
ci_0020                 1.081963e-02 3 1  ON 69
ci_0021                -2.389432e-03 3 1  ON 70
ci_0022                -1.918988e-03 3 1  ON 71
ci_0023                -1.037364e-02 3 1  ON 72
ci_0024                -1.106468e-02 3 1  ON 73
ci_0025                -1.027924e-02 3 1  ON 74
ci_0026                -9.911224e-03 3 1  ON 75
ci_0027                -1.048727e-02 3 1  ON 76
ci_0028                -1.113367e-02 3 1  ON 77
ci_0029                -1.045089e-02 3 1  ON 78
ci_0030                -1.027409e-02 3 1  ON 79
ci_0031                 2.065784e-02 3 1  ON 80
ci_0032                 2.003704e-02 3 1  ON 81
ci_0033                 9.973713e-03 3 1  ON 82
ci_0034                 9.873984e-03 3 1  ON 83
ci_0035                 6.367446e-03 3 1  ON 84
ci_0036                 6.511216e-03 3 1  ON 85
ci_0037                -1.093902e-02 3 1  ON 86
ci_0038                -1.029366e-02 3 1  ON 87
ci_0039                -2.740534e-03 3 1  ON 88
ci_0040                -2.773672e-03 3 1  ON 89
ci_0041                 7.802892e-03 3 1  ON 90
ci_0042                 6.643413e-03 3 1  ON 91
ci_0043                -1.855177e-02 3 1  ON 92
ci_0044                -2.011408e-02 3 1  ON 93
ci_0045                 7.256895e-03 3 1  ON 94
ci_0046                 7.193985e-03 3 1  ON 95
ci_0047                -1.773307e-03 3 1  ON 96
ci_0048                -1.701061e-03 3 1  ON 97
ci_0049                -5.134293e-03 3 1  ON 98
ci_0050                -5.871548e-03 3 1  ON 99
ci_0051                -3.648824e-03 3 1  ON 100
ci_0052                -3.099500e-03 3 1  ON 101
ci_0053                -4.634500e-03 3 1  ON 102
ci_0054                -4.377253e-03 3 1  ON 103
ci_0055                 6.512634e-03 3 1  ON 104
ci_0056                 6.301697e-03 3 1  ON 105
ci_0057                 4.102533e-03 3 1  ON 106
ci_0058                 4.465855e-03 3 1  ON 107
ci_0059                -4.722169e-03 3 1  ON 108
ci_0060                -4.671086e-03 3 1  ON 109
ci_0061                -3.811497e-03 3 1  ON 110
ci_0062                -2.899075e-03 3 1  ON 111
ci_0063                -8.648218e-03 3 1  ON 112
ci_0064                -8.897622e-03 3 1  ON 113
ci_0065                -5.940343e-03 3 1  ON 114
ci_0066                -5.569163e-03 3 1  ON 115
ci_0067                -5.103325e-03 3 1  ON 116
ci_0068                -4.758950e-03 3 1  ON 117
ci_0069                 4.510090e-03 3 1  ON 118
ci_0070                 4.052534e-03 3 1  ON 119
ci_0071                 4.874220e-04 3 1  ON 120
ci_0072                 1.945221e-04 3 1  ON 121
ci_0073                 4.466191e-03 3 1  ON 122
ci_0074                 4.461363e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.9952
    reference variance = 0.326645
====================================================
  Execution time = 2.1333e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3925e-01
  Total weights = 1.9516e+06
  Execution time = 1.9140e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325720267475
                                         uncertainty =       0.002553159290

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325720267475
                                         uncertainty =       0.002553159290

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403549910
  error estimate for blocks of size 2^( 2) =       0.000416681228
  error estimate for blocks of size 2^( 3) =       0.000430461609
  error estimate for blocks of size 2^( 4) =       0.000442981021
  error estimate for blocks of size 2^( 5) =       0.000452973275
  error estimate for blocks of size 2^( 6) =       0.000461398188
  error estimate for blocks of size 2^( 7) =       0.000465092495

      target function =                  N/A
              le_mean =     -16.905599040950
             les_mean =     286.212538979353
             stat err =       0.000455611245
             autocorr =       1.274660006561
              std dev =       0.570705755607
             le_variance =       0.325705059483

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325734281460
                                         uncertainty =       0.002540613475

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325734281460
                                         uncertainty =       0.002540613475

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403559069
  error estimate for blocks of size 2^( 2) =       0.000416663531
  error estimate for blocks of size 2^( 3) =       0.000430425258
  error estimate for blocks of size 2^( 4) =       0.000442903039
  error estimate for blocks of size 2^( 5) =       0.000452914471
  error estimate for blocks of size 2^( 6) =       0.000461366567
  error estimate for blocks of size 2^( 7) =       0.000465107266

      target function =                  N/A
              le_mean =     -16.905607747817
             les_mean =     286.141398012731
             stat err =       0.000455572836
             autocorr =       1.274387251772
              std dev =       0.570718708773
             le_variance =       0.325719844543

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325678315897
                                         uncertainty =       0.002545067893

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325678315897
                                         uncertainty =       0.002545067893

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403524459
  error estimate for blocks of size 2^( 2) =       0.000416635611
  error estimate for blocks of size 2^( 3) =       0.000430403669
  error estimate for blocks of size 2^( 4) =       0.000442889124
  error estimate for blocks of size 2^( 5) =       0.000452899861
  error estimate for blocks of size 2^( 6) =       0.000461352126
  error estimate for blocks of size 2^( 7) =       0.000465087638

      target function =                  N/A
              le_mean =     -16.905602933411
             les_mean =     286.144441052109
             stat err =       0.000455557187
             autocorr =       1.274518305335
              std dev =       0.570669763006
             le_variance =       0.325663978410

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325667599789
                                         uncertainty =       0.002552411396

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325667599789
                                         uncertainty =       0.002552411396

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403517410
  error estimate for blocks of size 2^( 2) =       0.000416647786
  error estimate for blocks of size 2^( 3) =       0.000430430077
  error estimate for blocks of size 2^( 4) =       0.000442942689
  error estimate for blocks of size 2^( 5) =       0.000452944495
  error estimate for blocks of size 2^( 6) =       0.000461390671
  error estimate for blocks of size 2^( 7) =       0.000465090066

      target function =                  N/A
              le_mean =     -16.905596889421
             les_mean =     286.152529022915
             stat err =       0.000455591980
             autocorr =       1.274757531266
              std dev =       0.570659793904
             le_variance =       0.325652600378


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905599040950        initial
     2.3283e-01     2.3283e+00             9.2521e-04       -16.905607747817  <--
     9.3132e-01     9.3132e+00             3.6309e-04       -16.905602933411
     3.7253e+00     3.7253e+01             1.0555e-04       -16.905596889421

*****************************************************************************
Applying the update for shift_i =   2.3283e-01     and shift_s =   2.3283e+00
*****************************************************************************

  Execution time = 3.4827e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
   uu_0                 3.133036e-01 1 1  ON 0
   uu_1                 1.455894e-01 1 1  ON 1
   uu_2                 4.340928e-02 1 1  ON 2
   uu_3                -1.983685e-02 1 1  ON 3
   uu_4                -6.626255e-02 1 1  ON 4
   uu_5                -1.027155e-01 1 1  ON 5
   uu_6                -1.315233e-01 1 1  ON 6
   uu_7                -1.467830e-01 1 1  ON 7
   uu_8                -1.400063e-01 1 1  ON 8
   uu_9                -1.119211e-01 1 1  ON 9
   ud_0                 4.510822e-01 1 1  ON 10
   ud_1                 1.851321e-01 1 1  ON 11
   ud_2                 6.444193e-02 1 1  ON 12
   ud_3                -6.830722e-03 1 1  ON 13
   ud_4                -6.426576e-02 1 1  ON 14
   ud_5                -1.066879e-01 1 1  ON 15
   ud_6                -1.356313e-01 1 1  ON 16
   ud_7                -1.532860e-01 1 1  ON 17
   ud_8                -1.551311e-01 1 1  ON 18
   ud_9                -1.449580e-01 1 1  ON 19
   eO_0                -7.496303e-01 1 1  ON 20
   eO_1                -4.287080e-01 1 1  ON 21
   eO_2                -1.741766e-02 1 1  ON 22
   eO_3                 2.961845e-01 1 1  ON 23
   eO_4                 5.234151e-01 1 1  ON 24
   eO_5                 4.879409e-01 1 1  ON 25
   eO_6                 2.624141e-01 1 1  ON 26
   eO_7                -4.230819e-02 1 1  ON 27
   eO_8                -2.324095e-01 1 1  ON 28
   eO_9                -9.659831e-02 1 1  ON 29
  eH1_0                -2.635796e-01 1 1  ON 30
  eH1_1                -1.557336e-01 1 1  ON 31
  eH1_2                -1.055141e-01 1 1  ON 32
  eH1_3                -4.980205e-02 1 1  ON 33
  eH1_4                 7.555865e-04 1 1  ON 34
  eH1_5                 3.672356e-02 1 1  ON 35
  eH1_6                 9.861772e-02 1 1  ON 36
  eH1_7                 1.588647e-01 1 1  ON 37
  eH1_8                 1.928075e-01 1 1  ON 38
  eH1_9                 8.739469e-02 1 1  ON 39
  eH2_0                -2.625846e-01 1 1  ON 40
  eH2_1                -1.541931e-01 1 1  ON 41
  eH2_2                -1.042007e-01 1 1  ON 42
  eH2_3                -4.830392e-02 1 1  ON 43
  eH2_4                 2.308053e-03 1 1  ON 44
  eH2_5                 3.884492e-02 1 1  ON 45
  eH2_6                 1.008047e-01 1 1  ON 46
  eH2_7                 1.608085e-01 1 1  ON 47
  eH2_8                 1.972914e-01 1 1  ON 48
  eH2_9                 8.079649e-02 1 1  ON 49
ci_0001                 7.009125e-01 3 1  ON 50
ci_0002                 7.011507e-01 3 1  ON 51
ci_0003                -2.738484e-02 3 1  ON 52
ci_0004                -2.748392e-02 3 1  ON 53
ci_0005                -3.695910e-02 3 1  ON 54
ci_0006                -3.627054e-02 3 1  ON 55
ci_0007                -2.147438e-02 3 1  ON 56
ci_0008                -2.178569e-02 3 1  ON 57
ci_0009                -1.752308e-02 3 1  ON 58
ci_0010                -1.800197e-02 3 1  ON 59
ci_0011                -1.137590e-02 3 1  ON 60
ci_0012                -1.217156e-02 3 1  ON 61
ci_0013                 1.300205e-02 3 1  ON 62
ci_0014                 1.271526e-02 3 1  ON 63
ci_0015                 1.304669e-02 3 1  ON 64
ci_0016                 1.332333e-02 3 1  ON 65
ci_0017                 1.151833e-02 3 1  ON 66
ci_0018                 1.085161e-02 3 1  ON 67
ci_0019                 1.112949e-02 3 1  ON 68
ci_0020                 1.063464e-02 3 1  ON 69
ci_0021                -2.351848e-03 3 1  ON 70
ci_0022                -1.530764e-03 3 1  ON 71
ci_0023                -1.086038e-02 3 1  ON 72
ci_0024                -1.096675e-02 3 1  ON 73
ci_0025                -9.967760e-03 3 1  ON 74
ci_0026                -9.505968e-03 3 1  ON 75
ci_0027                -1.104938e-02 3 1  ON 76
ci_0028                -1.141824e-02 3 1  ON 77
ci_0029                -1.042963e-02 3 1  ON 78
ci_0030                -1.029806e-02 3 1  ON 79
ci_0031                 2.062645e-02 3 1  ON 80
ci_0032                 1.997809e-02 3 1  ON 81
ci_0033                 1.000237e-02 3 1  ON 82
ci_0034                 1.030094e-02 3 1  ON 83
ci_0035                 6.508649e-03 3 1  ON 84
ci_0036                 6.753822e-03 3 1  ON 85
ci_0037                -1.095183e-02 3 1  ON 86
ci_0038                -1.066231e-02 3 1  ON 87
ci_0039                -2.604478e-03 3 1  ON 88
ci_0040                -2.592785e-03 3 1  ON 89
ci_0041                 8.095802e-03 3 1  ON 90
ci_0042                 6.686507e-03 3 1  ON 91
ci_0043                -1.840629e-02 3 1  ON 92
ci_0044                -1.984144e-02 3 1  ON 93
ci_0045                 7.475519e-03 3 1  ON 94
ci_0046                 7.227086e-03 3 1  ON 95
ci_0047                -1.702421e-03 3 1  ON 96
ci_0048                -1.764578e-03 3 1  ON 97
ci_0049                -5.241731e-03 3 1  ON 98
ci_0050                -6.274975e-03 3 1  ON 99
ci_0051                -3.785013e-03 3 1  ON 100
ci_0052                -3.094086e-03 3 1  ON 101
ci_0053                -4.963638e-03 3 1  ON 102
ci_0054                -4.271860e-03 3 1  ON 103
ci_0055                 6.936618e-03 3 1  ON 104
ci_0056                 6.248598e-03 3 1  ON 105
ci_0057                 4.301625e-03 3 1  ON 106
ci_0058                 4.610395e-03 3 1  ON 107
ci_0059                -4.561185e-03 3 1  ON 108
ci_0060                -4.684994e-03 3 1  ON 109
ci_0061                -3.736876e-03 3 1  ON 110
ci_0062                -3.343762e-03 3 1  ON 111
ci_0063                -8.723933e-03 3 1  ON 112
ci_0064                -8.941564e-03 3 1  ON 113
ci_0065                -5.663984e-03 3 1  ON 114
ci_0066                -5.566670e-03 3 1  ON 115
ci_0067                -5.097835e-03 3 1  ON 116
ci_0068                -4.905133e-03 3 1  ON 117
ci_0069                 4.246058e-03 3 1  ON 118
ci_0070                 3.989138e-03 3 1  ON 119
ci_0071                 4.836195e-04 3 1  ON 120
ci_0072                 1.757768e-04 3 1  ON 121
ci_0073                 4.524964e-03 3 1  ON 122
ci_0074                 4.393104e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.2052e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.9127
    reference variance = 0.352849
====================================================
  Execution time = 2.1064e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5263e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4239e-01
  Total weights = 1.951535720e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0409e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325559900282
                                         uncertainty =       0.003920078646

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325559900282
                                         uncertainty =       0.003920078646

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403429052
  error estimate for blocks of size 2^( 2) =       0.000416451555
  error estimate for blocks of size 2^( 3) =       0.000430132334
  error estimate for blocks of size 2^( 4) =       0.000442399217
  error estimate for blocks of size 2^( 5) =       0.000453922407
  error estimate for blocks of size 2^( 6) =       0.000462740898
  error estimate for blocks of size 2^( 7) =       0.000468379753

      target function =                  N/A
              le_mean =     -16.905972914074
             les_mean =     286.154305652115
             stat err =       0.000456860569
             autocorr =       1.282428059749
              std dev =       0.570534837219
             le_variance =       0.325510000481


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690597291407e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e-02, overlap shift 5.8208e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905972914083       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906027617536       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906026026765       residual = 4.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906027797550       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906023799057       residual = 9.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906024713655       residual = 6.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906024641682       residual = 8.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906025532336       residual = 5.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906025413726       residual = 3.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906026076064       residual = 3.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906026268989       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906026467704       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906026442500       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906026845592       residual = 4.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906026824750       residual = 1.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.906026978408       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.906026907159       residual = 7.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.8208e-02 is 3.515749e-03

solving harmonic davidson linear method for identity shift 2.3283e-01, overlap shift 2.3283e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905972914083       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906006375161       residual = 8.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906005139252       residual = 4.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906006659099       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906004854057       residual = 5.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906004980185       residual = 5.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906004820097       residual = 2.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906005194298       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906005150204       residual = 7.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906005323421       residual = 2.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906005371136       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906005439710       residual = 9.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.3283e-01 is 1.227547e-03

solving harmonic davidson linear method for identity shift 9.3132e-01, overlap shift 9.3132e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905972914083       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905986019178       residual = 7.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905985635494       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905986312118       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905985823129       residual = 4.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905985767789       residual = 3.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905985704094       residual = 9.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905985795656       residual = 4.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905985768132       residual = 1.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905985800308       residual = 7.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.3132e-01 is 4.803371e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.373808 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7115e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
   uu_0                 3.133303e-01 1 1  ON 0
   uu_1                 1.456227e-01 1 1  ON 1
   uu_2                 4.344867e-02 1 1  ON 2
   uu_3                -1.963665e-02 1 1  ON 3
   uu_4                -6.613181e-02 1 1  ON 4
   uu_5                -1.025026e-01 1 1  ON 5
   uu_6                -1.317178e-01 1 1  ON 6
   uu_7                -1.471098e-01 1 1  ON 7
   uu_8                -1.403757e-01 1 1  ON 8
   uu_9                -1.120568e-01 1 1  ON 9
   ud_0                 4.510738e-01 1 1  ON 10
   ud_1                 1.851900e-01 1 1  ON 11
   ud_2                 6.451422e-02 1 1  ON 12
   ud_3                -6.914089e-03 1 1  ON 13
   ud_4                -6.410014e-02 1 1  ON 14
   ud_5                -1.066539e-01 1 1  ON 15
   ud_6                -1.354880e-01 1 1  ON 16
   ud_7                -1.530400e-01 1 1  ON 17
   ud_8                -1.552877e-01 1 1  ON 18
   ud_9                -1.449887e-01 1 1  ON 19
   eO_0                -7.494167e-01 1 1  ON 20
   eO_1                -4.286641e-01 1 1  ON 21
   eO_2                -1.727726e-02 1 1  ON 22
   eO_3                 2.961512e-01 1 1  ON 23
   eO_4                 5.236966e-01 1 1  ON 24
   eO_5                 4.881064e-01 1 1  ON 25
   eO_6                 2.624221e-01 1 1  ON 26
   eO_7                -4.225198e-02 1 1  ON 27
   eO_8                -2.326961e-01 1 1  ON 28
   eO_9                -9.710001e-02 1 1  ON 29
  eH1_0                -2.639478e-01 1 1  ON 30
  eH1_1                -1.558528e-01 1 1  ON 31
  eH1_2                -1.060897e-01 1 1  ON 32
  eH1_3                -4.992828e-02 1 1  ON 33
  eH1_4                 5.716119e-04 1 1  ON 34
  eH1_5                 3.651884e-02 1 1  ON 35
  eH1_6                 9.883190e-02 1 1  ON 36
  eH1_7                 1.591513e-01 1 1  ON 37
  eH1_8                 1.930548e-01 1 1  ON 38
  eH1_9                 8.811750e-02 1 1  ON 39
  eH2_0                -2.621328e-01 1 1  ON 40
  eH2_1                -1.542722e-01 1 1  ON 41
  eH2_2                -1.045080e-01 1 1  ON 42
  eH2_3                -4.849471e-02 1 1  ON 43
  eH2_4                 1.974294e-03 1 1  ON 44
  eH2_5                 3.836806e-02 1 1  ON 45
  eH2_6                 1.006259e-01 1 1  ON 46
  eH2_7                 1.606241e-01 1 1  ON 47
  eH2_8                 1.976501e-01 1 1  ON 48
  eH2_9                 8.166542e-02 1 1  ON 49
ci_0001                 7.010795e-01 3 1  ON 50
ci_0002                 7.009748e-01 3 1  ON 51
ci_0003                -2.753504e-02 3 1  ON 52
ci_0004                -2.742640e-02 3 1  ON 53
ci_0005                -3.671289e-02 3 1  ON 54
ci_0006                -3.672544e-02 3 1  ON 55
ci_0007                -2.126567e-02 3 1  ON 56
ci_0008                -2.105084e-02 3 1  ON 57
ci_0009                -1.673650e-02 3 1  ON 58
ci_0010                -1.723258e-02 3 1  ON 59
ci_0011                -1.163943e-02 3 1  ON 60
ci_0012                -1.213817e-02 3 1  ON 61
ci_0013                 1.305924e-02 3 1  ON 62
ci_0014                 1.302187e-02 3 1  ON 63
ci_0015                 1.309913e-02 3 1  ON 64
ci_0016                 1.303591e-02 3 1  ON 65
ci_0017                 1.115859e-02 3 1  ON 66
ci_0018                 1.162803e-02 3 1  ON 67
ci_0019                 1.172842e-02 3 1  ON 68
ci_0020                 1.087245e-02 3 1  ON 69
ci_0021                -2.283928e-03 3 1  ON 70
ci_0022                -1.362757e-03 3 1  ON 71
ci_0023                -1.122245e-02 3 1  ON 72
ci_0024                -1.086912e-02 3 1  ON 73
ci_0025                -1.069177e-02 3 1  ON 74
ci_0026                -1.073351e-02 3 1  ON 75
ci_0027                -1.136176e-02 3 1  ON 76
ci_0028                -1.151668e-02 3 1  ON 77
ci_0029                -1.022195e-02 3 1  ON 78
ci_0030                -1.072663e-02 3 1  ON 79
ci_0031                 2.056182e-02 3 1  ON 80
ci_0032                 2.062353e-02 3 1  ON 81
ci_0033                 9.585184e-03 3 1  ON 82
ci_0034                 1.085351e-02 3 1  ON 83
ci_0035                 6.026832e-03 3 1  ON 84
ci_0036                 6.339287e-03 3 1  ON 85
ci_0037                -1.080329e-02 3 1  ON 86
ci_0038                -1.064084e-02 3 1  ON 87
ci_0039                -2.412036e-03 3 1  ON 88
ci_0040                -2.642789e-03 3 1  ON 89
ci_0041                 7.786116e-03 3 1  ON 90
ci_0042                 6.807965e-03 3 1  ON 91
ci_0043                -1.847926e-02 3 1  ON 92
ci_0044                -1.938771e-02 3 1  ON 93
ci_0045                 7.200201e-03 3 1  ON 94
ci_0046                 7.388673e-03 3 1  ON 95
ci_0047                -1.832085e-03 3 1  ON 96
ci_0048                -1.910030e-03 3 1  ON 97
ci_0049                -5.123298e-03 3 1  ON 98
ci_0050                -6.137005e-03 3 1  ON 99
ci_0051                -3.738747e-03 3 1  ON 100
ci_0052                -3.352394e-03 3 1  ON 101
ci_0053                -4.677314e-03 3 1  ON 102
ci_0054                -4.268842e-03 3 1  ON 103
ci_0055                 7.120947e-03 3 1  ON 104
ci_0056                 6.966970e-03 3 1  ON 105
ci_0057                 4.167777e-03 3 1  ON 106
ci_0058                 4.501515e-03 3 1  ON 107
ci_0059                -4.520141e-03 3 1  ON 108
ci_0060                -4.527308e-03 3 1  ON 109
ci_0061                -3.859000e-03 3 1  ON 110
ci_0062                -3.394533e-03 3 1  ON 111
ci_0063                -8.910879e-03 3 1  ON 112
ci_0064                -8.773343e-03 3 1  ON 113
ci_0065                -5.170902e-03 3 1  ON 114
ci_0066                -5.703502e-03 3 1  ON 115
ci_0067                -4.928542e-03 3 1  ON 116
ci_0068                -4.858186e-03 3 1  ON 117
ci_0069                 4.437957e-03 3 1  ON 118
ci_0070                 4.309219e-03 3 1  ON 119
ci_0071                 7.297033e-04 3 1  ON 120
ci_0072                 3.238827e-04 3 1  ON 121
ci_0073                 4.792523e-03 3 1  ON 122
ci_0074                 4.634736e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.9181
    reference variance = 0.177584
====================================================
  Execution time = 2.1024e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3333e-01
  Total weights = 1.9517e+06
  Execution time = 1.9041e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320949408772
                                         uncertainty =       0.002065335457

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320949408772
                                         uncertainty =       0.002065335457

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400559128
  error estimate for blocks of size 2^( 2) =       0.000413542358
  error estimate for blocks of size 2^( 3) =       0.000426966274
  error estimate for blocks of size 2^( 4) =       0.000440023248
  error estimate for blocks of size 2^( 5) =       0.000452507111
  error estimate for blocks of size 2^( 6) =       0.000461248596
  error estimate for blocks of size 2^( 7) =       0.000466470517

      target function =                  N/A
              le_mean =     -16.905846118681
             les_mean =     286.143774251971
             stat err =       0.000455062368
             autocorr =       1.290650273931
              std dev =       0.566476151834
             le_variance =       0.320895230597

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321754097896
                                         uncertainty =       0.002080094677

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321754097896
                                         uncertainty =       0.002080094677

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401060358
  error estimate for blocks of size 2^( 2) =       0.000414044565
  error estimate for blocks of size 2^( 3) =       0.000427471538
  error estimate for blocks of size 2^( 4) =       0.000440510682
  error estimate for blocks of size 2^( 5) =       0.000453006301
  error estimate for blocks of size 2^( 6) =       0.000461762705
  error estimate for blocks of size 2^( 7) =       0.000467002113

      target function =                  N/A
              le_mean =     -16.905841899002
             les_mean =     286.170705648989
             stat err =       0.000455570450
             autocorr =       1.290302738562
              std dev =       0.567184997728
             le_variance =       0.321698821647

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322015927715
                                         uncertainty =       0.002087948833

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322015927715
                                         uncertainty =       0.002087948833

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401223594
  error estimate for blocks of size 2^( 2) =       0.000414208581
  error estimate for blocks of size 2^( 3) =       0.000427634474
  error estimate for blocks of size 2^( 4) =       0.000440666038
  error estimate for blocks of size 2^( 5) =       0.000453167377
  error estimate for blocks of size 2^( 6) =       0.000461914868
  error estimate for blocks of size 2^( 7) =       0.000467175396

      target function =                  N/A
              le_mean =     -16.905852916546
             les_mean =     286.145718455309
             stat err =       0.000455730920
             autocorr =       1.290161450631
              std dev =       0.567415848615
             le_variance =       0.321960745260

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321067960322
                                         uncertainty =       0.002068683454

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321067960322
                                         uncertainty =       0.002068683454

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400633048
  error estimate for blocks of size 2^( 2) =       0.000413613132
  error estimate for blocks of size 2^( 3) =       0.000427039407
  error estimate for blocks of size 2^( 4) =       0.000440091871
  error estimate for blocks of size 2^( 5) =       0.000452580355
  error estimate for blocks of size 2^( 6) =       0.000461341936
  error estimate for blocks of size 2^( 7) =       0.000466581868

      target function =                  N/A
              le_mean =     -16.905834208130
             les_mean =     286.148160119549
             stat err =       0.000455149007
             autocorr =       1.290665368806
              std dev =       0.566580690006
             le_variance =       0.321013678287


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905846118681        initial
     5.8208e-02     5.8208e-01             3.5157e-03       -16.905841899002
     2.3283e-01     2.3283e+00             1.2275e-03       -16.905852916546  <--
     9.3132e-01     9.3132e+00             4.8034e-04       -16.905834208130

*****************************************************************************
Applying the update for shift_i =   2.3283e-01     and shift_s =   2.3283e+00
*****************************************************************************

  Execution time = 3.0644e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
   uu_0                 3.133303e-01 1 1  ON 0
   uu_1                 1.456227e-01 1 1  ON 1
   uu_2                 4.344867e-02 1 1  ON 2
   uu_3                -1.963665e-02 1 1  ON 3
   uu_4                -6.613181e-02 1 1  ON 4
   uu_5                -1.025026e-01 1 1  ON 5
   uu_6                -1.317178e-01 1 1  ON 6
   uu_7                -1.471098e-01 1 1  ON 7
   uu_8                -1.403757e-01 1 1  ON 8
   uu_9                -1.120568e-01 1 1  ON 9
   ud_0                 4.510738e-01 1 1  ON 10
   ud_1                 1.851900e-01 1 1  ON 11
   ud_2                 6.451422e-02 1 1  ON 12
   ud_3                -6.914089e-03 1 1  ON 13
   ud_4                -6.410014e-02 1 1  ON 14
   ud_5                -1.066539e-01 1 1  ON 15
   ud_6                -1.354880e-01 1 1  ON 16
   ud_7                -1.530400e-01 1 1  ON 17
   ud_8                -1.552877e-01 1 1  ON 18
   ud_9                -1.449887e-01 1 1  ON 19
   eO_0                -7.494167e-01 1 1  ON 20
   eO_1                -4.286641e-01 1 1  ON 21
   eO_2                -1.727726e-02 1 1  ON 22
   eO_3                 2.961512e-01 1 1  ON 23
   eO_4                 5.236966e-01 1 1  ON 24
   eO_5                 4.881064e-01 1 1  ON 25
   eO_6                 2.624221e-01 1 1  ON 26
   eO_7                -4.225198e-02 1 1  ON 27
   eO_8                -2.326961e-01 1 1  ON 28
   eO_9                -9.710001e-02 1 1  ON 29
  eH1_0                -2.639478e-01 1 1  ON 30
  eH1_1                -1.558528e-01 1 1  ON 31
  eH1_2                -1.060897e-01 1 1  ON 32
  eH1_3                -4.992828e-02 1 1  ON 33
  eH1_4                 5.716119e-04 1 1  ON 34
  eH1_5                 3.651884e-02 1 1  ON 35
  eH1_6                 9.883190e-02 1 1  ON 36
  eH1_7                 1.591513e-01 1 1  ON 37
  eH1_8                 1.930548e-01 1 1  ON 38
  eH1_9                 8.811750e-02 1 1  ON 39
  eH2_0                -2.621328e-01 1 1  ON 40
  eH2_1                -1.542722e-01 1 1  ON 41
  eH2_2                -1.045080e-01 1 1  ON 42
  eH2_3                -4.849471e-02 1 1  ON 43
  eH2_4                 1.974294e-03 1 1  ON 44
  eH2_5                 3.836806e-02 1 1  ON 45
  eH2_6                 1.006259e-01 1 1  ON 46
  eH2_7                 1.606241e-01 1 1  ON 47
  eH2_8                 1.976501e-01 1 1  ON 48
  eH2_9                 8.166542e-02 1 1  ON 49
ci_0001                 7.010795e-01 3 1  ON 50
ci_0002                 7.009748e-01 3 1  ON 51
ci_0003                -2.753504e-02 3 1  ON 52
ci_0004                -2.742640e-02 3 1  ON 53
ci_0005                -3.671289e-02 3 1  ON 54
ci_0006                -3.672544e-02 3 1  ON 55
ci_0007                -2.126567e-02 3 1  ON 56
ci_0008                -2.105084e-02 3 1  ON 57
ci_0009                -1.673650e-02 3 1  ON 58
ci_0010                -1.723258e-02 3 1  ON 59
ci_0011                -1.163943e-02 3 1  ON 60
ci_0012                -1.213817e-02 3 1  ON 61
ci_0013                 1.305924e-02 3 1  ON 62
ci_0014                 1.302187e-02 3 1  ON 63
ci_0015                 1.309913e-02 3 1  ON 64
ci_0016                 1.303591e-02 3 1  ON 65
ci_0017                 1.115859e-02 3 1  ON 66
ci_0018                 1.162803e-02 3 1  ON 67
ci_0019                 1.172842e-02 3 1  ON 68
ci_0020                 1.087245e-02 3 1  ON 69
ci_0021                -2.283928e-03 3 1  ON 70
ci_0022                -1.362757e-03 3 1  ON 71
ci_0023                -1.122245e-02 3 1  ON 72
ci_0024                -1.086912e-02 3 1  ON 73
ci_0025                -1.069177e-02 3 1  ON 74
ci_0026                -1.073351e-02 3 1  ON 75
ci_0027                -1.136176e-02 3 1  ON 76
ci_0028                -1.151668e-02 3 1  ON 77
ci_0029                -1.022195e-02 3 1  ON 78
ci_0030                -1.072663e-02 3 1  ON 79
ci_0031                 2.056182e-02 3 1  ON 80
ci_0032                 2.062353e-02 3 1  ON 81
ci_0033                 9.585184e-03 3 1  ON 82
ci_0034                 1.085351e-02 3 1  ON 83
ci_0035                 6.026832e-03 3 1  ON 84
ci_0036                 6.339287e-03 3 1  ON 85
ci_0037                -1.080329e-02 3 1  ON 86
ci_0038                -1.064084e-02 3 1  ON 87
ci_0039                -2.412036e-03 3 1  ON 88
ci_0040                -2.642789e-03 3 1  ON 89
ci_0041                 7.786116e-03 3 1  ON 90
ci_0042                 6.807965e-03 3 1  ON 91
ci_0043                -1.847926e-02 3 1  ON 92
ci_0044                -1.938771e-02 3 1  ON 93
ci_0045                 7.200201e-03 3 1  ON 94
ci_0046                 7.388673e-03 3 1  ON 95
ci_0047                -1.832085e-03 3 1  ON 96
ci_0048                -1.910030e-03 3 1  ON 97
ci_0049                -5.123298e-03 3 1  ON 98
ci_0050                -6.137005e-03 3 1  ON 99
ci_0051                -3.738747e-03 3 1  ON 100
ci_0052                -3.352394e-03 3 1  ON 101
ci_0053                -4.677314e-03 3 1  ON 102
ci_0054                -4.268842e-03 3 1  ON 103
ci_0055                 7.120947e-03 3 1  ON 104
ci_0056                 6.966970e-03 3 1  ON 105
ci_0057                 4.167777e-03 3 1  ON 106
ci_0058                 4.501515e-03 3 1  ON 107
ci_0059                -4.520141e-03 3 1  ON 108
ci_0060                -4.527308e-03 3 1  ON 109
ci_0061                -3.859000e-03 3 1  ON 110
ci_0062                -3.394533e-03 3 1  ON 111
ci_0063                -8.910879e-03 3 1  ON 112
ci_0064                -8.773343e-03 3 1  ON 113
ci_0065                -5.170902e-03 3 1  ON 114
ci_0066                -5.703502e-03 3 1  ON 115
ci_0067                -4.928542e-03 3 1  ON 116
ci_0068                -4.858186e-03 3 1  ON 117
ci_0069                 4.437957e-03 3 1  ON 118
ci_0070                 4.309219e-03 3 1  ON 119
ci_0071                 7.297033e-04 3 1  ON 120
ci_0072                 3.238827e-04 3 1  ON 121
ci_0073                 4.792523e-03 3 1  ON 122
ci_0074                 4.634736e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7767e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.8942
    reference variance = 0.659738
====================================================
  Execution time = 2.1368e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5228e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3927e-01
  Total weights = 1.951844096e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1749e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325865803565
                                         uncertainty =       0.002368155803

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325865803565
                                         uncertainty =       0.002368155803

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403638038
  error estimate for blocks of size 2^( 2) =       0.000416169998
  error estimate for blocks of size 2^( 3) =       0.000429385371
  error estimate for blocks of size 2^( 4) =       0.000442561094
  error estimate for blocks of size 2^( 5) =       0.000452653736
  error estimate for blocks of size 2^( 6) =       0.000459458799
  error estimate for blocks of size 2^( 7) =       0.000461828072

      target function =                  N/A
              le_mean =     -16.905731391776
             les_mean =     286.143024175635
             stat err =       0.000454125425
             autocorr =       1.265806906160
              std dev =       0.570830388297
             le_variance =       0.325847332204


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690573139178e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e-02, overlap shift 5.8208e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905731391777       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905750019436       residual = 2.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905751973466       residual = 6.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905754654967       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905755700588       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905756091256       residual = 9.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905756883782       residual = 8.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905759428641       residual = 5.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905760811349       residual = 6.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905761367670       residual = 4.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905761590046       residual = 1.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905761215882       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905760733253       residual = 7.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905761106622       residual = 7.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.905760739641       residual = 2.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.905760506594       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.905760287865       residual = 5.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.8208e-02 is 4.692781e-03

solving harmonic davidson linear method for identity shift 2.3283e-01, overlap shift 2.3283e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905731391777       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905743055344       residual = 1.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905743894418       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905745276861       residual = 7.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905745808278       residual = 9.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905746330536       residual = 5.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905746623222       residual = 2.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905747387084       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905747112995       residual = 9.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905747068611       residual = 3.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905747202516       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905747126478       residual = 5.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.3283e-01 is 1.166894e-03

solving harmonic davidson linear method for identity shift 9.3132e-01, overlap shift 9.3132e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905731391777       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905736065739       residual = 2.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905736345237       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905736837444       residual = 5.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905737408051       residual = 8.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905737508287       residual = 3.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905737436247       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905737562396       residual = 6.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905737420466       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905737394892       residual = 7.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.3132e-01 is 3.038676e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.380469 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7553e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
   uu_0                 3.131047e-01 1 1  ON 0
   uu_1                 1.454060e-01 1 1  ON 1
   uu_2                 4.323981e-02 1 1  ON 2
   uu_3                -1.983646e-02 1 1  ON 3
   uu_4                -6.611103e-02 1 1  ON 4
   uu_5                -1.023787e-01 1 1  ON 5
   uu_6                -1.316136e-01 1 1  ON 6
   uu_7                -1.472516e-01 1 1  ON 7
   uu_8                -1.401755e-01 1 1  ON 8
   uu_9                -1.119196e-01 1 1  ON 9
   ud_0                 4.510369e-01 1 1  ON 10
   ud_1                 1.853040e-01 1 1  ON 11
   ud_2                 6.450037e-02 1 1  ON 12
   ud_3                -6.803430e-03 1 1  ON 13
   ud_4                -6.433393e-02 1 1  ON 14
   ud_5                -1.067815e-01 1 1  ON 15
   ud_6                -1.356489e-01 1 1  ON 16
   ud_7                -1.529121e-01 1 1  ON 17
   ud_8                -1.549124e-01 1 1  ON 18
   ud_9                -1.449651e-01 1 1  ON 19
   eO_0                -7.493790e-01 1 1  ON 20
   eO_1                -4.283547e-01 1 1  ON 21
   eO_2                -1.720114e-02 1 1  ON 22
   eO_3                 2.961322e-01 1 1  ON 23
   eO_4                 5.236108e-01 1 1  ON 24
   eO_5                 4.883958e-01 1 1  ON 25
   eO_6                 2.625311e-01 1 1  ON 26
   eO_7                -4.213400e-02 1 1  ON 27
   eO_8                -2.328573e-01 1 1  ON 28
   eO_9                -9.766984e-02 1 1  ON 29
  eH1_0                -2.639203e-01 1 1  ON 30
  eH1_1                -1.561021e-01 1 1  ON 31
  eH1_2                -1.062105e-01 1 1  ON 32
  eH1_3                -5.017159e-02 1 1  ON 33
  eH1_4                 3.309700e-04 1 1  ON 34
  eH1_5                 3.598594e-02 1 1  ON 35
  eH1_6                 9.865907e-02 1 1  ON 36
  eH1_7                 1.595217e-01 1 1  ON 37
  eH1_8                 1.935417e-01 1 1  ON 38
  eH1_9                 8.878695e-02 1 1  ON 39
  eH2_0                -2.625222e-01 1 1  ON 40
  eH2_1                -1.547288e-01 1 1  ON 41
  eH2_2                -1.047492e-01 1 1  ON 42
  eH2_3                -4.876401e-02 1 1  ON 43
  eH2_4                 1.689188e-03 1 1  ON 44
  eH2_5                 3.821134e-02 1 1  ON 45
  eH2_6                 1.003984e-01 1 1  ON 46
  eH2_7                 1.607124e-01 1 1  ON 47
  eH2_8                 1.982015e-01 1 1  ON 48
  eH2_9                 8.283231e-02 1 1  ON 49
ci_0001                 7.010058e-01 3 1  ON 50
ci_0002                 7.010875e-01 3 1  ON 51
ci_0003                -2.713975e-02 3 1  ON 52
ci_0004                -2.787015e-02 3 1  ON 53
ci_0005                -3.660519e-02 3 1  ON 54
ci_0006                -3.669586e-02 3 1  ON 55
ci_0007                -2.115944e-02 3 1  ON 56
ci_0008                -2.087752e-02 3 1  ON 57
ci_0009                -1.654508e-02 3 1  ON 58
ci_0010                -1.700135e-02 3 1  ON 59
ci_0011                -1.178778e-02 3 1  ON 60
ci_0012                -1.188407e-02 3 1  ON 61
ci_0013                 1.318784e-02 3 1  ON 62
ci_0014                 1.321589e-02 3 1  ON 63
ci_0015                 1.282305e-02 3 1  ON 64
ci_0016                 1.315851e-02 3 1  ON 65
ci_0017                 1.080500e-02 3 1  ON 66
ci_0018                 1.146922e-02 3 1  ON 67
ci_0019                 1.150950e-02 3 1  ON 68
ci_0020                 1.124890e-02 3 1  ON 69
ci_0021                -2.182079e-03 3 1  ON 70
ci_0022                -1.540233e-03 3 1  ON 71
ci_0023                -1.095075e-02 3 1  ON 72
ci_0024                -1.136153e-02 3 1  ON 73
ci_0025                -1.076080e-02 3 1  ON 74
ci_0026                -1.109736e-02 3 1  ON 75
ci_0027                -1.130195e-02 3 1  ON 76
ci_0028                -1.135426e-02 3 1  ON 77
ci_0029                -1.031834e-02 3 1  ON 78
ci_0030                -1.034033e-02 3 1  ON 79
ci_0031                 2.034629e-02 3 1  ON 80
ci_0032                 2.057787e-02 3 1  ON 81
ci_0033                 9.688821e-03 3 1  ON 82
ci_0034                 1.015190e-02 3 1  ON 83
ci_0035                 6.830845e-03 3 1  ON 84
ci_0036                 6.462045e-03 3 1  ON 85
ci_0037                -1.091791e-02 3 1  ON 86
ci_0038                -1.085938e-02 3 1  ON 87
ci_0039                -2.603373e-03 3 1  ON 88
ci_0040                -2.625243e-03 3 1  ON 89
ci_0041                 7.952694e-03 3 1  ON 90
ci_0042                 6.642019e-03 3 1  ON 91
ci_0043                -1.831677e-02 3 1  ON 92
ci_0044                -1.961064e-02 3 1  ON 93
ci_0045                 7.063889e-03 3 1  ON 94
ci_0046                 7.474776e-03 3 1  ON 95
ci_0047                -2.288014e-03 3 1  ON 96
ci_0048                -1.519373e-03 3 1  ON 97
ci_0049                -5.462981e-03 3 1  ON 98
ci_0050                -6.127415e-03 3 1  ON 99
ci_0051                -3.449167e-03 3 1  ON 100
ci_0052                -3.714832e-03 3 1  ON 101
ci_0053                -4.618848e-03 3 1  ON 102
ci_0054                -4.169546e-03 3 1  ON 103
ci_0055                 6.628182e-03 3 1  ON 104
ci_0056                 6.877126e-03 3 1  ON 105
ci_0057                 4.573497e-03 3 1  ON 106
ci_0058                 4.633039e-03 3 1  ON 107
ci_0059                -4.593055e-03 3 1  ON 108
ci_0060                -4.544425e-03 3 1  ON 109
ci_0061                -4.075316e-03 3 1  ON 110
ci_0062                -2.945992e-03 3 1  ON 111
ci_0063                -8.519029e-03 3 1  ON 112
ci_0064                -8.391684e-03 3 1  ON 113
ci_0065                -5.276875e-03 3 1  ON 114
ci_0066                -6.104188e-03 3 1  ON 115
ci_0067                -5.169567e-03 3 1  ON 116
ci_0068                -4.310858e-03 3 1  ON 117
ci_0069                 4.419006e-03 3 1  ON 118
ci_0070                 4.176457e-03 3 1  ON 119
ci_0071                 5.670537e-04 3 1  ON 120
ci_0072                 4.704170e-04 3 1  ON 121
ci_0073                 4.717506e-03 3 1  ON 122
ci_0074                 4.724959e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.7979
    reference variance = 0.161687
====================================================
  Execution time = 2.1201e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4491e-01
  Total weights = 1.9516e+06
  Execution time = 1.9216e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328426938562
                                         uncertainty =       0.003929106155

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328426938562
                                         uncertainty =       0.003929106155

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405214277
  error estimate for blocks of size 2^( 2) =       0.000418267538
  error estimate for blocks of size 2^( 3) =       0.000431929119
  error estimate for blocks of size 2^( 4) =       0.000445113213
  error estimate for blocks of size 2^( 5) =       0.000456744203
  error estimate for blocks of size 2^( 6) =       0.000466644875
  error estimate for blocks of size 2^( 7) =       0.000474536005

      target function =                  N/A
              le_mean =     -16.905355459752
             les_mean =     286.148898877775
             stat err =       0.000460759574
             autocorr =       1.292942640128
              std dev =       0.573059526834
             le_variance =       0.328397221295

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329220858467
                                         uncertainty =       0.004377999129

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329220858467
                                         uncertainty =       0.004377999129

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405702015
  error estimate for blocks of size 2^( 2) =       0.000418785730
  error estimate for blocks of size 2^( 3) =       0.000432455942
  error estimate for blocks of size 2^( 4) =       0.000445644879
  error estimate for blocks of size 2^( 5) =       0.000457265521
  error estimate for blocks of size 2^( 6) =       0.000467225998
  error estimate for blocks of size 2^( 7) =       0.000475044564

      target function =                  N/A
              le_mean =     -16.905347443165
             les_mean =     286.137666645793
             stat err =       0.000461295241
             autocorr =       1.292836537896
              std dev =       0.573749292287
             le_variance =       0.329188250399

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329456727007
                                         uncertainty =       0.004438350167

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329456727007
                                         uncertainty =       0.004438350167

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405847039
  error estimate for blocks of size 2^( 2) =       0.000418940720
  error estimate for blocks of size 2^( 3) =       0.000432605728
  error estimate for blocks of size 2^( 4) =       0.000445792996
  error estimate for blocks of size 2^( 5) =       0.000457418027
  error estimate for blocks of size 2^( 6) =       0.000467398241
  error estimate for blocks of size 2^( 7) =       0.000475210392

      target function =                  N/A
              le_mean =     -16.905352429485
             les_mean =     286.463222481687
             stat err =       0.000461454914
             autocorr =       1.292807271822
              std dev =       0.573954386872
             le_variance =       0.329423638210

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328535602037
                                         uncertainty =       0.004012423843

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328535602037
                                         uncertainty =       0.004012423843

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405280982
  error estimate for blocks of size 2^( 2) =       0.000418342531
  error estimate for blocks of size 2^( 3) =       0.000432006029
  error estimate for blocks of size 2^( 4) =       0.000445191632
  error estimate for blocks of size 2^( 5) =       0.000456822849
  error estimate for blocks of size 2^( 6) =       0.000466735842
  error estimate for blocks of size 2^( 7) =       0.000474610833

      target function =                  N/A
              le_mean =     -16.905346746584
             les_mean =     286.135693531845
             stat err =       0.000460840289
             autocorr =       1.292969946461
              std dev =       0.573153861812
             le_variance =       0.328505349310


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905355459752        initial  <--
     5.8208e-02     5.8208e-01             4.6928e-03       -16.905347443165
     2.3283e-01     2.3283e+00             1.1669e-03       -16.905352429485
     9.3132e-01     9.3132e+00             3.0387e-04       -16.905346746584

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.0659
  </log>
  <optVariables href="H2O.s037.opt.xml">
   uu_0                 3.133303e-01 1 1  ON 0
   uu_1                 1.456227e-01 1 1  ON 1
   uu_2                 4.344867e-02 1 1  ON 2
   uu_3                -1.963665e-02 1 1  ON 3
   uu_4                -6.613181e-02 1 1  ON 4
   uu_5                -1.025026e-01 1 1  ON 5
   uu_6                -1.317178e-01 1 1  ON 6
   uu_7                -1.471098e-01 1 1  ON 7
   uu_8                -1.403757e-01 1 1  ON 8
   uu_9                -1.120568e-01 1 1  ON 9
   ud_0                 4.510738e-01 1 1  ON 10
   ud_1                 1.851900e-01 1 1  ON 11
   ud_2                 6.451422e-02 1 1  ON 12
   ud_3                -6.914089e-03 1 1  ON 13
   ud_4                -6.410014e-02 1 1  ON 14
   ud_5                -1.066539e-01 1 1  ON 15
   ud_6                -1.354880e-01 1 1  ON 16
   ud_7                -1.530400e-01 1 1  ON 17
   ud_8                -1.552877e-01 1 1  ON 18
   ud_9                -1.449887e-01 1 1  ON 19
   eO_0                -7.494167e-01 1 1  ON 20
   eO_1                -4.286641e-01 1 1  ON 21
   eO_2                -1.727726e-02 1 1  ON 22
   eO_3                 2.961512e-01 1 1  ON 23
   eO_4                 5.236966e-01 1 1  ON 24
   eO_5                 4.881064e-01 1 1  ON 25
   eO_6                 2.624221e-01 1 1  ON 26
   eO_7                -4.225198e-02 1 1  ON 27
   eO_8                -2.326961e-01 1 1  ON 28
   eO_9                -9.710001e-02 1 1  ON 29
  eH1_0                -2.639478e-01 1 1  ON 30
  eH1_1                -1.558528e-01 1 1  ON 31
  eH1_2                -1.060897e-01 1 1  ON 32
  eH1_3                -4.992828e-02 1 1  ON 33
  eH1_4                 5.716119e-04 1 1  ON 34
  eH1_5                 3.651884e-02 1 1  ON 35
  eH1_6                 9.883190e-02 1 1  ON 36
  eH1_7                 1.591513e-01 1 1  ON 37
  eH1_8                 1.930548e-01 1 1  ON 38
  eH1_9                 8.811750e-02 1 1  ON 39
  eH2_0                -2.621328e-01 1 1  ON 40
  eH2_1                -1.542722e-01 1 1  ON 41
  eH2_2                -1.045080e-01 1 1  ON 42
  eH2_3                -4.849471e-02 1 1  ON 43
  eH2_4                 1.974294e-03 1 1  ON 44
  eH2_5                 3.836806e-02 1 1  ON 45
  eH2_6                 1.006259e-01 1 1  ON 46
  eH2_7                 1.606241e-01 1 1  ON 47
  eH2_8                 1.976501e-01 1 1  ON 48
  eH2_9                 8.166542e-02 1 1  ON 49
ci_0001                 7.010795e-01 3 1  ON 50
ci_0002                 7.009748e-01 3 1  ON 51
ci_0003                -2.753504e-02 3 1  ON 52
ci_0004                -2.742640e-02 3 1  ON 53
ci_0005                -3.671289e-02 3 1  ON 54
ci_0006                -3.672544e-02 3 1  ON 55
ci_0007                -2.126567e-02 3 1  ON 56
ci_0008                -2.105084e-02 3 1  ON 57
ci_0009                -1.673650e-02 3 1  ON 58
ci_0010                -1.723258e-02 3 1  ON 59
ci_0011                -1.163943e-02 3 1  ON 60
ci_0012                -1.213817e-02 3 1  ON 61
ci_0013                 1.305924e-02 3 1  ON 62
ci_0014                 1.302187e-02 3 1  ON 63
ci_0015                 1.309913e-02 3 1  ON 64
ci_0016                 1.303591e-02 3 1  ON 65
ci_0017                 1.115859e-02 3 1  ON 66
ci_0018                 1.162803e-02 3 1  ON 67
ci_0019                 1.172842e-02 3 1  ON 68
ci_0020                 1.087245e-02 3 1  ON 69
ci_0021                -2.283928e-03 3 1  ON 70
ci_0022                -1.362757e-03 3 1  ON 71
ci_0023                -1.122245e-02 3 1  ON 72
ci_0024                -1.086912e-02 3 1  ON 73
ci_0025                -1.069177e-02 3 1  ON 74
ci_0026                -1.073351e-02 3 1  ON 75
ci_0027                -1.136176e-02 3 1  ON 76
ci_0028                -1.151668e-02 3 1  ON 77
ci_0029                -1.022195e-02 3 1  ON 78
ci_0030                -1.072663e-02 3 1  ON 79
ci_0031                 2.056182e-02 3 1  ON 80
ci_0032                 2.062353e-02 3 1  ON 81
ci_0033                 9.585184e-03 3 1  ON 82
ci_0034                 1.085351e-02 3 1  ON 83
ci_0035                 6.026832e-03 3 1  ON 84
ci_0036                 6.339287e-03 3 1  ON 85
ci_0037                -1.080329e-02 3 1  ON 86
ci_0038                -1.064084e-02 3 1  ON 87
ci_0039                -2.412036e-03 3 1  ON 88
ci_0040                -2.642789e-03 3 1  ON 89
ci_0041                 7.786116e-03 3 1  ON 90
ci_0042                 6.807965e-03 3 1  ON 91
ci_0043                -1.847926e-02 3 1  ON 92
ci_0044                -1.938771e-02 3 1  ON 93
ci_0045                 7.200201e-03 3 1  ON 94
ci_0046                 7.388673e-03 3 1  ON 95
ci_0047                -1.832085e-03 3 1  ON 96
ci_0048                -1.910030e-03 3 1  ON 97
ci_0049                -5.123298e-03 3 1  ON 98
ci_0050                -6.137005e-03 3 1  ON 99
ci_0051                -3.738747e-03 3 1  ON 100
ci_0052                -3.352394e-03 3 1  ON 101
ci_0053                -4.677314e-03 3 1  ON 102
ci_0054                -4.268842e-03 3 1  ON 103
ci_0055                 7.120947e-03 3 1  ON 104
ci_0056                 6.966970e-03 3 1  ON 105
ci_0057                 4.167777e-03 3 1  ON 106
ci_0058                 4.501515e-03 3 1  ON 107
ci_0059                -4.520141e-03 3 1  ON 108
ci_0060                -4.527308e-03 3 1  ON 109
ci_0061                -3.859000e-03 3 1  ON 110
ci_0062                -3.394533e-03 3 1  ON 111
ci_0063                -8.910879e-03 3 1  ON 112
ci_0064                -8.773343e-03 3 1  ON 113
ci_0065                -5.170902e-03 3 1  ON 114
ci_0066                -5.703502e-03 3 1  ON 115
ci_0067                -4.928542e-03 3 1  ON 116
ci_0068                -4.858186e-03 3 1  ON 117
ci_0069                 4.437957e-03 3 1  ON 118
ci_0070                 4.309219e-03 3 1  ON 119
ci_0071                 7.297033e-04 3 1  ON 120
ci_0072                 3.238827e-04 3 1  ON 121
ci_0073                 4.792523e-03 3 1  ON 122
ci_0074                 4.634736e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8626e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.848
    reference variance = 0.203777
====================================================
  Execution time = 2.1267e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5253e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3379e-01
  Total weights = 1.951697031e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1397e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320622383268
                                         uncertainty =       0.001975389655

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320622383268
                                         uncertainty =       0.001975389655

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400401660
  error estimate for blocks of size 2^( 2) =       0.000413238507
  error estimate for blocks of size 2^( 3) =       0.000426850551
  error estimate for blocks of size 2^( 4) =       0.000439120742
  error estimate for blocks of size 2^( 5) =       0.000449584992
  error estimate for blocks of size 2^( 6) =       0.000458154983
  error estimate for blocks of size 2^( 7) =       0.000463802449

      target function =                  N/A
              le_mean =     -16.906490006399
             les_mean =     286.163192111807
             stat err =       0.000452665792
             autocorr =       1.278096402670
              std dev =       0.566253458248
             le_variance =       0.320642978978


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690649000640e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e-01, overlap shift 5.8208e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906490006401       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906495739485       residual = 4.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906494398709       residual = 3.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906494669740       residual = 6.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906495434884       residual = 6.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906495609125       residual = 3.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906495823787       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906496083251       residual = 9.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906496032375       residual = 2.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906495930619       residual = 7.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.8208e-01 is 3.620561e-04

solving harmonic davidson linear method for identity shift 2.3283e+00, overlap shift 2.3283e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906490006401       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906491796913       residual = 3.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906491425425       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906491464784       residual = 7.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906491660524       residual = 6.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906491711617       residual = 2.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906491757718       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906491862371       residual = 4.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906491853747       residual = 1.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906491819859       residual = 4.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.3283e+00 is 1.247879e-04

solving harmonic davidson linear method for identity shift 9.3132e+00, overlap shift 9.3132e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906490006401       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906490483775       residual = 3.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906490385787       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906490400147       residual = 7.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906490447074       residual = 6.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906490455758       residual = 2.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906490466226       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906490496960       residual = 3.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906490496237       residual = 1.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906490488014       residual = 3.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.3132e+00 is 3.439728e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.384442 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7414e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
   uu_0                 3.133317e-01 1 1  ON 0
   uu_1                 1.455326e-01 1 1  ON 1
   uu_2                 4.346688e-02 1 1  ON 2
   uu_3                -1.960428e-02 1 1  ON 3
   uu_4                -6.614059e-02 1 1  ON 4
   uu_5                -1.025031e-01 1 1  ON 5
   uu_6                -1.317026e-01 1 1  ON 6
   uu_7                -1.471178e-01 1 1  ON 7
   uu_8                -1.403981e-01 1 1  ON 8
   uu_9                -1.120842e-01 1 1  ON 9
   ud_0                 4.510755e-01 1 1  ON 10
   ud_1                 1.852177e-01 1 1  ON 11
   ud_2                 6.449943e-02 1 1  ON 12
   ud_3                -6.906128e-03 1 1  ON 13
   ud_4                -6.413141e-02 1 1  ON 14
   ud_5                -1.066368e-01 1 1  ON 15
   ud_6                -1.354919e-01 1 1  ON 16
   ud_7                -1.530505e-01 1 1  ON 17
   ud_8                -1.552382e-01 1 1  ON 18
   ud_9                -1.449880e-01 1 1  ON 19
   eO_0                -7.493967e-01 1 1  ON 20
   eO_1                -4.286355e-01 1 1  ON 21
   eO_2                -1.731065e-02 1 1  ON 22
   eO_3                 2.961696e-01 1 1  ON 23
   eO_4                 5.237322e-01 1 1  ON 24
   eO_5                 4.881180e-01 1 1  ON 25
   eO_6                 2.624200e-01 1 1  ON 26
   eO_7                -4.224303e-02 1 1  ON 27
   eO_8                -2.327242e-01 1 1  ON 28
   eO_9                -9.714981e-02 1 1  ON 29
  eH1_0                -2.639715e-01 1 1  ON 30
  eH1_1                -1.558587e-01 1 1  ON 31
  eH1_2                -1.060768e-01 1 1  ON 32
  eH1_3                -4.998202e-02 1 1  ON 33
  eH1_4                 5.422671e-04 1 1  ON 34
  eH1_5                 3.651417e-02 1 1  ON 35
  eH1_6                 9.877703e-02 1 1  ON 36
  eH1_7                 1.591314e-01 1 1  ON 37
  eH1_8                 1.931347e-01 1 1  ON 38
  eH1_9                 8.820783e-02 1 1  ON 39
  eH2_0                -2.621648e-01 1 1  ON 40
  eH2_1                -1.542815e-01 1 1  ON 41
  eH2_2                -1.045328e-01 1 1  ON 42
  eH2_3                -4.849617e-02 1 1  ON 43
  eH2_4                 1.919695e-03 1 1  ON 44
  eH2_5                 3.833348e-02 1 1  ON 45
  eH2_6                 1.006105e-01 1 1  ON 46
  eH2_7                 1.606633e-01 1 1  ON 47
  eH2_8                 1.976812e-01 1 1  ON 48
  eH2_9                 8.174844e-02 1 1  ON 49
ci_0001                 7.011346e-01 3 1  ON 50
ci_0002                 7.009269e-01 3 1  ON 51
ci_0003                -2.753309e-02 3 1  ON 52
ci_0004                -2.736790e-02 3 1  ON 53
ci_0005                -3.664265e-02 3 1  ON 54
ci_0006                -3.670836e-02 3 1  ON 55
ci_0007                -2.124784e-02 3 1  ON 56
ci_0008                -2.110112e-02 3 1  ON 57
ci_0009                -1.681978e-02 3 1  ON 58
ci_0010                -1.720298e-02 3 1  ON 59
ci_0011                -1.165163e-02 3 1  ON 60
ci_0012                -1.215093e-02 3 1  ON 61
ci_0013                 1.300260e-02 3 1  ON 62
ci_0014                 1.305824e-02 3 1  ON 63
ci_0015                 1.304962e-02 3 1  ON 64
ci_0016                 1.313267e-02 3 1  ON 65
ci_0017                 1.118060e-02 3 1  ON 66
ci_0018                 1.161179e-02 3 1  ON 67
ci_0019                 1.169857e-02 3 1  ON 68
ci_0020                 1.091292e-02 3 1  ON 69
ci_0021                -2.299745e-03 3 1  ON 70
ci_0022                -1.417024e-03 3 1  ON 71
ci_0023                -1.126063e-02 3 1  ON 72
ci_0024                -1.092489e-02 3 1  ON 73
ci_0025                -1.063732e-02 3 1  ON 74
ci_0026                -1.066297e-02 3 1  ON 75
ci_0027                -1.137249e-02 3 1  ON 76
ci_0028                -1.148340e-02 3 1  ON 77
ci_0029                -1.029630e-02 3 1  ON 78
ci_0030                -1.077384e-02 3 1  ON 79
ci_0031                 2.052680e-02 3 1  ON 80
ci_0032                 2.071820e-02 3 1  ON 81
ci_0033                 9.612280e-03 3 1  ON 82
ci_0034                 1.077740e-02 3 1  ON 83
ci_0035                 6.036448e-03 3 1  ON 84
ci_0036                 6.336150e-03 3 1  ON 85
ci_0037                -1.072882e-02 3 1  ON 86
ci_0038                -1.062107e-02 3 1  ON 87
ci_0039                -2.395681e-03 3 1  ON 88
ci_0040                -2.605956e-03 3 1  ON 89
ci_0041                 7.703455e-03 3 1  ON 90
ci_0042                 6.805806e-03 3 1  ON 91
ci_0043                -1.845727e-02 3 1  ON 92
ci_0044                -1.932831e-02 3 1  ON 93
ci_0045                 7.236078e-03 3 1  ON 94
ci_0046                 7.450875e-03 3 1  ON 95
ci_0047                -1.805709e-03 3 1  ON 96
ci_0048                -1.889032e-03 3 1  ON 97
ci_0049                -5.232170e-03 3 1  ON 98
ci_0050                -6.145393e-03 3 1  ON 99
ci_0051                -3.685108e-03 3 1  ON 100
ci_0052                -3.361975e-03 3 1  ON 101
ci_0053                -4.724536e-03 3 1  ON 102
ci_0054                -4.308013e-03 3 1  ON 103
ci_0055                 7.058761e-03 3 1  ON 104
ci_0056                 6.908145e-03 3 1  ON 105
ci_0057                 4.235627e-03 3 1  ON 106
ci_0058                 4.439008e-03 3 1  ON 107
ci_0059                -4.562094e-03 3 1  ON 108
ci_0060                -4.547045e-03 3 1  ON 109
ci_0061                -3.829644e-03 3 1  ON 110
ci_0062                -3.457436e-03 3 1  ON 111
ci_0063                -8.834231e-03 3 1  ON 112
ci_0064                -8.764048e-03 3 1  ON 113
ci_0065                -5.179793e-03 3 1  ON 114
ci_0066                -5.689079e-03 3 1  ON 115
ci_0067                -4.866657e-03 3 1  ON 116
ci_0068                -4.890119e-03 3 1  ON 117
ci_0069                 4.313169e-03 3 1  ON 118
ci_0070                 4.378149e-03 3 1  ON 119
ci_0071                 6.749176e-04 3 1  ON 120
ci_0072                 2.910292e-04 3 1  ON 121
ci_0073                 4.727690e-03 3 1  ON 122
ci_0074                 4.601952e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.9971
    reference variance = 0.433272
====================================================
  Execution time = 2.1159e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3508e-01
  Total weights = 1.9518e+06
  Execution time = 1.9123e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323368508131
                                         uncertainty =       0.002148190978

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323368508131
                                         uncertainty =       0.002148190978

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402083389
  error estimate for blocks of size 2^( 2) =       0.000415406010
  error estimate for blocks of size 2^( 3) =       0.000428572121
  error estimate for blocks of size 2^( 4) =       0.000440721004
  error estimate for blocks of size 2^( 5) =       0.000451099892
  error estimate for blocks of size 2^( 6) =       0.000459990538
  error estimate for blocks of size 2^( 7) =       0.000466196050

      target function =                  N/A
              le_mean =     -16.906150923039
             les_mean =     286.159768969618
             stat err =       0.000454501871
             autocorr =       1.277729986366
              std dev =       0.568631781879
             le_variance =       0.323342103363

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323555669218
                                         uncertainty =       0.002358127413

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323555669218
                                         uncertainty =       0.002358127413

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402200243
  error estimate for blocks of size 2^( 2) =       0.000415520165
  error estimate for blocks of size 2^( 3) =       0.000428667641
  error estimate for blocks of size 2^( 4) =       0.000440810130
  error estimate for blocks of size 2^( 5) =       0.000451194032
  error estimate for blocks of size 2^( 6) =       0.000460055634
  error estimate for blocks of size 2^( 7) =       0.000466247301

      target function =                  N/A
              le_mean =     -16.906163540769
             les_mean =     286.156136109604
             stat err =       0.000454576775
             autocorr =       1.277408579429
              std dev =       0.568797038183
             le_variance =       0.323530070646

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323400473806
                                         uncertainty =       0.002237693468

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323400473806
                                         uncertainty =       0.002237693468

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402103653
  error estimate for blocks of size 2^( 2) =       0.000415425185
  error estimate for blocks of size 2^( 3) =       0.000428582398
  error estimate for blocks of size 2^( 4) =       0.000440728685
  error estimate for blocks of size 2^( 5) =       0.000451108716
  error estimate for blocks of size 2^( 6) =       0.000459981780
  error estimate for blocks of size 2^( 7) =       0.000466176857

      target function =                  N/A
              le_mean =     -16.906157538694
             les_mean =     286.153602722003
             stat err =       0.000454499010
             autocorr =       1.277585121749
              std dev =       0.568660439294
             le_variance =       0.323374695218

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323364139767
                                         uncertainty =       0.002156363101

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323364139767
                                         uncertainty =       0.002156363101

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402080731
  error estimate for blocks of size 2^( 2) =       0.000415403246
  error estimate for blocks of size 2^( 3) =       0.000428568444
  error estimate for blocks of size 2^( 4) =       0.000440717139
  error estimate for blocks of size 2^( 5) =       0.000451095983
  error estimate for blocks of size 2^( 6) =       0.000459984160
  error estimate for blocks of size 2^( 7) =       0.000466188199

      target function =                  N/A
              le_mean =     -16.906151603902
             les_mean =     286.152990600216
             stat err =       0.000454496370
             autocorr =       1.277715950574
              std dev =       0.568628022969
             le_variance =       0.323337828506


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906150923039        initial
     5.8208e-01     5.8208e+00             3.6206e-04       -16.906163540769  <--
     2.3283e+00     2.3283e+01             1.2479e-04       -16.906157538694
     9.3132e+00     9.3132e+01             3.4397e-05       -16.906151603902

*****************************************************************************
Applying the update for shift_i =   5.8208e-01     and shift_s =   5.8208e+00
*****************************************************************************

  Execution time = 3.0827e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
   uu_0                 3.132940e-01 1 1  ON 0
   uu_1                 1.453677e-01 1 1  ON 1
   uu_2                 4.348740e-02 1 1  ON 2
   uu_3                -1.953922e-02 1 1  ON 3
   uu_4                -6.615039e-02 1 1  ON 4
   uu_5                -1.025050e-01 1 1  ON 5
   uu_6                -1.316648e-01 1 1  ON 6
   uu_7                -1.471438e-01 1 1  ON 7
   uu_8                -1.404657e-01 1 1  ON 8
   uu_9                -1.121653e-01 1 1  ON 9
   ud_0                 4.510930e-01 1 1  ON 10
   ud_1                 1.852602e-01 1 1  ON 11
   ud_2                 6.448288e-02 1 1  ON 12
   ud_3                -6.901959e-03 1 1  ON 13
   ud_4                -6.418637e-02 1 1  ON 14
   ud_5                -1.066175e-01 1 1  ON 15
   ud_6                -1.354946e-01 1 1  ON 16
   ud_7                -1.530754e-01 1 1  ON 17
   ud_8                -1.550966e-01 1 1  ON 18
   ud_9                -1.449838e-01 1 1  ON 19
   eO_0                -7.493460e-01 1 1  ON 20
   eO_1                -4.285753e-01 1 1  ON 21
   eO_2                -1.736396e-02 1 1  ON 22
   eO_3                 2.962206e-01 1 1  ON 23
   eO_4                 5.238257e-01 1 1  ON 24
   eO_5                 4.881549e-01 1 1  ON 25
   eO_6                 2.624153e-01 1 1  ON 26
   eO_7                -4.221821e-02 1 1  ON 27
   eO_8                -2.328073e-01 1 1  ON 28
   eO_9                -9.729677e-02 1 1  ON 29
  eH1_0                -2.640355e-01 1 1  ON 30
  eH1_1                -1.558737e-01 1 1  ON 31
  eH1_2                -1.060706e-01 1 1  ON 32
  eH1_3                -5.010592e-02 1 1  ON 33
  eH1_4                 4.491583e-04 1 1  ON 34
  eH1_5                 3.649106e-02 1 1  ON 35
  eH1_6                 9.861882e-02 1 1  ON 36
  eH1_7                 1.590733e-01 1 1  ON 37
  eH1_8                 1.933700e-01 1 1  ON 38
  eH1_9                 8.847497e-02 1 1  ON 39
  eH2_0                -2.622537e-01 1 1  ON 40
  eH2_1                -1.543106e-01 1 1  ON 41
  eH2_2                -1.046025e-01 1 1  ON 42
  eH2_3                -4.851888e-02 1 1  ON 43
  eH2_4                 1.776525e-03 1 1  ON 44
  eH2_5                 3.822199e-02 1 1  ON 45
  eH2_6                 1.005649e-01 1 1  ON 46
  eH2_7                 1.607805e-01 1 1  ON 47
  eH2_8                 1.977739e-01 1 1  ON 48
  eH2_9                 8.199408e-02 1 1  ON 49
ci_0001                 7.012930e-01 3 1  ON 50
ci_0002                 7.007860e-01 3 1  ON 51
ci_0003                -2.753667e-02 3 1  ON 52
ci_0004                -2.723196e-02 3 1  ON 53
ci_0005                -3.647012e-02 3 1  ON 54
ci_0006                -3.666613e-02 3 1  ON 55
ci_0007                -2.120030e-02 3 1  ON 56
ci_0008                -2.123256e-02 3 1  ON 57
ci_0009                -1.699689e-02 3 1  ON 58
ci_0010                -1.713804e-02 3 1  ON 59
ci_0011                -1.167908e-02 3 1  ON 60
ci_0012                -1.217501e-02 3 1  ON 61
ci_0013                 1.287455e-02 3 1  ON 62
ci_0014                 1.313860e-02 3 1  ON 63
ci_0015                 1.293826e-02 3 1  ON 64
ci_0016                 1.334686e-02 3 1  ON 65
ci_0017                 1.122800e-02 3 1  ON 66
ci_0018                 1.157281e-02 3 1  ON 67
ci_0019                 1.163152e-02 3 1  ON 68
ci_0020                 1.099899e-02 3 1  ON 69
ci_0021                -2.344405e-03 3 1  ON 70
ci_0022                -1.558062e-03 3 1  ON 71
ci_0023                -1.134274e-02 3 1  ON 72
ci_0024                -1.104025e-02 3 1  ON 73
ci_0025                -1.051994e-02 3 1  ON 74
ci_0026                -1.051042e-02 3 1  ON 75
ci_0027                -1.139763e-02 3 1  ON 76
ci_0028                -1.140215e-02 3 1  ON 77
ci_0029                -1.046172e-02 3 1  ON 78
ci_0030                -1.087441e-02 3 1  ON 79
ci_0031                 2.043601e-02 3 1  ON 80
ci_0032                 2.095656e-02 3 1  ON 81
ci_0033                 9.683094e-03 3 1  ON 82
ci_0034                 1.058124e-02 3 1  ON 83
ci_0035                 6.054492e-03 3 1  ON 84
ci_0036                 6.327205e-03 3 1  ON 85
ci_0037                -1.056017e-02 3 1  ON 86
ci_0038                -1.057732e-02 3 1  ON 87
ci_0039                -2.366025e-03 3 1  ON 88
ci_0040                -2.538117e-03 3 1  ON 89
ci_0041                 7.519049e-03 3 1  ON 90
ci_0042                 6.802909e-03 3 1  ON 91
ci_0043                -1.840666e-02 3 1  ON 92
ci_0044                -1.917590e-02 3 1  ON 93
ci_0045                 7.320926e-03 3 1  ON 94
ci_0046                 7.597803e-03 3 1  ON 95
ci_0047                -1.756973e-03 3 1  ON 96
ci_0048                -1.849944e-03 3 1  ON 97
ci_0049                -5.469136e-03 3 1  ON 98
ci_0050                -6.160576e-03 3 1  ON 99
ci_0051                -3.583104e-03 3 1  ON 100
ci_0052                -3.381077e-03 3 1  ON 101
ci_0053                -4.818607e-03 3 1  ON 102
ci_0054                -4.383205e-03 3 1  ON 103
ci_0055                 6.910988e-03 3 1  ON 104
ci_0056                 6.767634e-03 3 1  ON 105
ci_0057                 4.391412e-03 3 1  ON 106
ci_0058                 4.292788e-03 3 1  ON 107
ci_0059                -4.642782e-03 3 1  ON 108
ci_0060                -4.585582e-03 3 1  ON 109
ci_0061                -3.764542e-03 3 1  ON 110
ci_0062                -3.598737e-03 3 1  ON 111
ci_0063                -8.679081e-03 3 1  ON 112
ci_0064                -8.748134e-03 3 1  ON 113
ci_0065                -5.197593e-03 3 1  ON 114
ci_0066                -5.658951e-03 3 1  ON 115
ci_0067                -4.748671e-03 3 1  ON 116
ci_0068                -4.949694e-03 3 1  ON 117
ci_0069                 4.075901e-03 3 1  ON 118
ci_0070                 4.508046e-03 3 1  ON 119
ci_0071                 5.538552e-04 3 1  ON 120
ci_0072                 2.249963e-04 3 1  ON 121
ci_0073                 4.604248e-03 3 1  ON 122
ci_0074                 4.538258e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8248e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.8992
    reference variance = 0.258008
====================================================
  Execution time = 2.1205e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5245e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5558e-01
  Total weights = 1.951833528e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1100e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327117374213
                                         uncertainty =       0.002831966528

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327117374213
                                         uncertainty =       0.002831966528

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404411686
  error estimate for blocks of size 2^( 2) =       0.000416884944
  error estimate for blocks of size 2^( 3) =       0.000429864105
  error estimate for blocks of size 2^( 4) =       0.000441686994
  error estimate for blocks of size 2^( 5) =       0.000451684507
  error estimate for blocks of size 2^( 6) =       0.000460844398
  error estimate for blocks of size 2^( 7) =       0.000462723153

      target function =                  N/A
              le_mean =     -16.905959193394
             les_mean =     286.167038173304
             stat err =       0.000454234763
             autocorr =       1.261575779639
              std dev =       0.571924491517
             le_variance =       0.327097623997


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690595919339e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e-01, overlap shift 1.4552e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905959193400       residual = 6.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905963760127       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905965539568       residual = 8.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905966273137       residual = 8.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905968022340       residual = 3.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905966997762       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905968937985       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905968936877       residual = 5.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905970613357       residual = 3.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905969749738       residual = 2.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905969716621       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905969371747       residual = 5.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905970068377       residual = 4.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905969871150       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.905970036694       residual = 7.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         14 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4552e-01 is 7.071209e-03

solving harmonic davidson linear method for identity shift 5.8208e-01, overlap shift 5.8208e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905959193400       residual = 6.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905961306751       residual = 8.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905961063000       residual = 4.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905960892204       residual = 5.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905961570852       residual = 3.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905961192546       residual = 9.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905961829125       residual = 5.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905961971147       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905962451684       residual = 8.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905962327744       residual = 5.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905962221708       residual = 2.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905962117248       residual = 5.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.8208e-01 is 3.309695e-03

solving harmonic davidson linear method for identity shift 2.3283e+00, overlap shift 2.3283e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905959193400       residual = 6.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905959864536       residual = 8.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905959686616       residual = 3.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905959454178       residual = 4.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905959684895       residual = 3.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905959651344       residual = 8.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905959704059       residual = 4.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905959829360       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905959931048       residual = 3.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905959941232       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905959881596       residual = 6.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.3283e+00 is 1.059663e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.390620 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7325e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
   uu_0                 3.131310e-01 1 1  ON 0
   uu_1                 1.455112e-01 1 1  ON 1
   uu_2                 4.363221e-02 1 1  ON 2
   uu_3                -1.943652e-02 1 1  ON 3
   uu_4                -6.630883e-02 1 1  ON 4
   uu_5                -1.025947e-01 1 1  ON 5
   uu_6                -1.317570e-01 1 1  ON 6
   uu_7                -1.470429e-01 1 1  ON 7
   uu_8                -1.404856e-01 1 1  ON 8
   uu_9                -1.122924e-01 1 1  ON 9
   ud_0                 4.506627e-01 1 1  ON 10
   ud_1                 1.849852e-01 1 1  ON 11
   ud_2                 6.451221e-02 1 1  ON 12
   ud_3                -6.675444e-03 1 1  ON 13
   ud_4                -6.383912e-02 1 1  ON 14
   ud_5                -1.064541e-01 1 1  ON 15
   ud_6                -1.351716e-01 1 1  ON 16
   ud_7                -1.529348e-01 1 1  ON 17
   ud_8                -1.552505e-01 1 1  ON 18
   ud_9                -1.452540e-01 1 1  ON 19
   eO_0                -7.494271e-01 1 1  ON 20
   eO_1                -4.286366e-01 1 1  ON 21
   eO_2                -1.772498e-02 1 1  ON 22
   eO_3                 2.964966e-01 1 1  ON 23
   eO_4                 5.240324e-01 1 1  ON 24
   eO_5                 4.884535e-01 1 1  ON 25
   eO_6                 2.626025e-01 1 1  ON 26
   eO_7                -4.221480e-02 1 1  ON 27
   eO_8                -2.329831e-01 1 1  ON 28
   eO_9                -9.754949e-02 1 1  ON 29
  eH1_0                -2.637381e-01 1 1  ON 30
  eH1_1                -1.558881e-01 1 1  ON 31
  eH1_2                -1.059375e-01 1 1  ON 32
  eH1_3                -5.045828e-02 1 1  ON 33
  eH1_4                 8.203897e-06 1 1  ON 34
  eH1_5                 3.640027e-02 1 1  ON 35
  eH1_6                 9.851967e-02 1 1  ON 36
  eH1_7                 1.591263e-01 1 1  ON 37
  eH1_8                 1.935511e-01 1 1  ON 38
  eH1_9                 8.878337e-02 1 1  ON 39
  eH2_0                -2.622148e-01 1 1  ON 40
  eH2_1                -1.544387e-01 1 1  ON 41
  eH2_2                -1.042933e-01 1 1  ON 42
  eH2_3                -4.873732e-02 1 1  ON 43
  eH2_4                 1.640334e-03 1 1  ON 44
  eH2_5                 3.806755e-02 1 1  ON 45
  eH2_6                 1.003579e-01 1 1  ON 46
  eH2_7                 1.608662e-01 1 1  ON 47
  eH2_8                 1.979023e-01 1 1  ON 48
  eH2_9                 8.224706e-02 1 1  ON 49
ci_0001                 7.013893e-01 3 1  ON 50
ci_0002                 7.006179e-01 3 1  ON 51
ci_0003                -2.734484e-02 3 1  ON 52
ci_0004                -2.861472e-02 3 1  ON 53
ci_0005                -3.639026e-02 3 1  ON 54
ci_0006                -3.643257e-02 3 1  ON 55
ci_0007                -2.113576e-02 3 1  ON 56
ci_0008                -2.052328e-02 3 1  ON 57
ci_0009                -1.705953e-02 3 1  ON 58
ci_0010                -1.724953e-02 3 1  ON 59
ci_0011                -1.199008e-02 3 1  ON 60
ci_0012                -1.055134e-02 3 1  ON 61
ci_0013                 1.303090e-02 3 1  ON 62
ci_0014                 1.365108e-02 3 1  ON 63
ci_0015                 1.283416e-02 3 1  ON 64
ci_0016                 1.300663e-02 3 1  ON 65
ci_0017                 1.142107e-02 3 1  ON 66
ci_0018                 1.206350e-02 3 1  ON 67
ci_0019                 1.158329e-02 3 1  ON 68
ci_0020                 1.106730e-02 3 1  ON 69
ci_0021                -2.257033e-03 3 1  ON 70
ci_0022                 7.295943e-04 3 1  ON 71
ci_0023                -1.131519e-02 3 1  ON 72
ci_0024                -1.104763e-02 3 1  ON 73
ci_0025                -1.053707e-02 3 1  ON 74
ci_0026                -1.382011e-02 3 1  ON 75
ci_0027                -1.158087e-02 3 1  ON 76
ci_0028                -1.181685e-02 3 1  ON 77
ci_0029                -1.071104e-02 3 1  ON 78
ci_0030                -1.170091e-02 3 1  ON 79
ci_0031                 2.041697e-02 3 1  ON 80
ci_0032                 2.083460e-02 3 1  ON 81
ci_0033                 9.854424e-03 3 1  ON 82
ci_0034                 9.681095e-03 3 1  ON 83
ci_0035                 6.563608e-03 3 1  ON 84
ci_0036                 5.735983e-03 3 1  ON 85
ci_0037                -1.057259e-02 3 1  ON 86
ci_0038                -1.271647e-02 3 1  ON 87
ci_0039                -2.501274e-03 3 1  ON 88
ci_0040                -2.446160e-03 3 1  ON 89
ci_0041                 7.563618e-03 3 1  ON 90
ci_0042                 6.809006e-03 3 1  ON 91
ci_0043                -1.838037e-02 3 1  ON 92
ci_0044                -1.904879e-02 3 1  ON 93
ci_0045                 7.424701e-03 3 1  ON 94
ci_0046                 7.684615e-03 3 1  ON 95
ci_0047                -1.895991e-03 3 1  ON 96
ci_0048                -2.526880e-03 3 1  ON 97
ci_0049                -6.266408e-03 3 1  ON 98
ci_0050                -6.772367e-03 3 1  ON 99
ci_0051                -3.463419e-03 3 1  ON 100
ci_0052                -3.318938e-03 3 1  ON 101
ci_0053                -4.978978e-03 3 1  ON 102
ci_0054                -3.593791e-03 3 1  ON 103
ci_0055                 6.879863e-03 3 1  ON 104
ci_0056                 3.928984e-03 3 1  ON 105
ci_0057                 4.635641e-03 3 1  ON 106
ci_0058                 4.413352e-03 3 1  ON 107
ci_0059                -4.773620e-03 3 1  ON 108
ci_0060                -3.505460e-03 3 1  ON 109
ci_0061                -3.089793e-03 3 1  ON 110
ci_0062                -2.587045e-03 3 1  ON 111
ci_0063                -8.199892e-03 3 1  ON 112
ci_0064                -9.798683e-03 3 1  ON 113
ci_0065                -5.275974e-03 3 1  ON 114
ci_0066                -5.529094e-03 3 1  ON 115
ci_0067                -4.726696e-03 3 1  ON 116
ci_0068                -6.780880e-03 3 1  ON 117
ci_0069                 4.133290e-03 3 1  ON 118
ci_0070                 3.857928e-03 3 1  ON 119
ci_0071                 5.023166e-04 3 1  ON 120
ci_0072                -1.780919e-03 3 1  ON 121
ci_0073                 4.641683e-03 3 1  ON 122
ci_0074                 4.507171e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.9336
    reference variance = 0.36761
====================================================
  Execution time = 2.0821e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4571e-01
  Total weights = 1.9518e+06
  Execution time = 1.9206e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324050332812
                                         uncertainty =       0.003373916706

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324050332812
                                         uncertainty =       0.003373916706

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402528453
  error estimate for blocks of size 2^( 2) =       0.000415272005
  error estimate for blocks of size 2^( 3) =       0.000428378823
  error estimate for blocks of size 2^( 4) =       0.000440832711
  error estimate for blocks of size 2^( 5) =       0.000450618134
  error estimate for blocks of size 2^( 6) =       0.000459014448
  error estimate for blocks of size 2^( 7) =       0.000466619459

      target function =                  N/A
              le_mean =     -16.906098205219
             les_mean =     286.179932039017
             stat err =       0.000454271188
             autocorr =       1.273612216882
              std dev =       0.569261198151
             le_variance =       0.324058311721

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328492441941
                                         uncertainty =       0.003457221950

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328492441941
                                         uncertainty =       0.003457221950

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405275586
  error estimate for blocks of size 2^( 2) =       0.000417957186
  error estimate for blocks of size 2^( 3) =       0.000430993567
  error estimate for blocks of size 2^( 4) =       0.000443395966
  error estimate for blocks of size 2^( 5) =       0.000453096145
  error estimate for blocks of size 2^( 6) =       0.000461597882
  error estimate for blocks of size 2^( 7) =       0.000469441529

      target function =                  N/A
              le_mean =     -16.906151728432
             les_mean =     286.189779379721
             stat err =       0.000456882880
             autocorr =       1.270892699117
              std dev =       0.573146230717
             le_variance =       0.328496601785

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.381786925314
                                         uncertainty =       0.054195787137

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.381786925314
                                         uncertainty =       0.054195787137

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000436832167
  error estimate for blocks of size 2^( 2) =       0.000448583935
  error estimate for blocks of size 2^( 3) =       0.000460698692
  error estimate for blocks of size 2^( 4) =       0.000472400054
  error estimate for blocks of size 2^( 5) =       0.000481252003
  error estimate for blocks of size 2^( 6) =       0.000488740828
  error estimate for blocks of size 2^( 7) =       0.000495523851

      target function =                  N/A
              le_mean =     -16.906281651439
             les_mean =     286.773941882570
             stat err =       0.000484479184
             autocorr =       1.230045062324
              std dev =       0.617773974918
             le_variance =       0.381644684086

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323818738427
                                         uncertainty =       0.003366486252

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323818738427
                                         uncertainty =       0.003366486252

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402384954
  error estimate for blocks of size 2^( 2) =       0.000415135576
  error estimate for blocks of size 2^( 3) =       0.000428243916
  error estimate for blocks of size 2^( 4) =       0.000440688218
  error estimate for blocks of size 2^( 5) =       0.000450441336
  error estimate for blocks of size 2^( 6) =       0.000458847057
  error estimate for blocks of size 2^( 7) =       0.000466451019

      target function =                  N/A
              le_mean =     -16.906056633954
             les_mean =     286.171855281572
             stat err =       0.000454106907
             autocorr =       1.273599114420
              std dev =       0.569058259864
             le_variance =       0.323827303119


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906098205219        initial
     1.4552e-01     1.4552e+00             7.0712e-03       -16.906151728432
     5.8208e-01     5.8208e+00             3.3097e-03       -16.906281651439  <--
     2.3283e+00     2.3283e+01             1.0597e-03       -16.906056633954

*****************************************************************************
Applying the update for shift_i =   5.8208e-01     and shift_s =   5.8208e+00
*****************************************************************************

  Execution time = 3.0530e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
   uu_0                 3.131310e-01 1 1  ON 0
   uu_1                 1.455112e-01 1 1  ON 1
   uu_2                 4.363221e-02 1 1  ON 2
   uu_3                -1.943652e-02 1 1  ON 3
   uu_4                -6.630883e-02 1 1  ON 4
   uu_5                -1.025947e-01 1 1  ON 5
   uu_6                -1.317570e-01 1 1  ON 6
   uu_7                -1.470429e-01 1 1  ON 7
   uu_8                -1.404856e-01 1 1  ON 8
   uu_9                -1.122924e-01 1 1  ON 9
   ud_0                 4.506627e-01 1 1  ON 10
   ud_1                 1.849852e-01 1 1  ON 11
   ud_2                 6.451221e-02 1 1  ON 12
   ud_3                -6.675444e-03 1 1  ON 13
   ud_4                -6.383912e-02 1 1  ON 14
   ud_5                -1.064541e-01 1 1  ON 15
   ud_6                -1.351716e-01 1 1  ON 16
   ud_7                -1.529348e-01 1 1  ON 17
   ud_8                -1.552505e-01 1 1  ON 18
   ud_9                -1.452540e-01 1 1  ON 19
   eO_0                -7.494271e-01 1 1  ON 20
   eO_1                -4.286366e-01 1 1  ON 21
   eO_2                -1.772498e-02 1 1  ON 22
   eO_3                 2.964966e-01 1 1  ON 23
   eO_4                 5.240324e-01 1 1  ON 24
   eO_5                 4.884535e-01 1 1  ON 25
   eO_6                 2.626025e-01 1 1  ON 26
   eO_7                -4.221480e-02 1 1  ON 27
   eO_8                -2.329831e-01 1 1  ON 28
   eO_9                -9.754949e-02 1 1  ON 29
  eH1_0                -2.637381e-01 1 1  ON 30
  eH1_1                -1.558881e-01 1 1  ON 31
  eH1_2                -1.059375e-01 1 1  ON 32
  eH1_3                -5.045828e-02 1 1  ON 33
  eH1_4                 8.203897e-06 1 1  ON 34
  eH1_5                 3.640027e-02 1 1  ON 35
  eH1_6                 9.851967e-02 1 1  ON 36
  eH1_7                 1.591263e-01 1 1  ON 37
  eH1_8                 1.935511e-01 1 1  ON 38
  eH1_9                 8.878337e-02 1 1  ON 39
  eH2_0                -2.622148e-01 1 1  ON 40
  eH2_1                -1.544387e-01 1 1  ON 41
  eH2_2                -1.042933e-01 1 1  ON 42
  eH2_3                -4.873732e-02 1 1  ON 43
  eH2_4                 1.640334e-03 1 1  ON 44
  eH2_5                 3.806755e-02 1 1  ON 45
  eH2_6                 1.003579e-01 1 1  ON 46
  eH2_7                 1.608662e-01 1 1  ON 47
  eH2_8                 1.979023e-01 1 1  ON 48
  eH2_9                 8.224706e-02 1 1  ON 49
ci_0001                 7.013893e-01 3 1  ON 50
ci_0002                 7.006179e-01 3 1  ON 51
ci_0003                -2.734484e-02 3 1  ON 52
ci_0004                -2.861472e-02 3 1  ON 53
ci_0005                -3.639026e-02 3 1  ON 54
ci_0006                -3.643257e-02 3 1  ON 55
ci_0007                -2.113576e-02 3 1  ON 56
ci_0008                -2.052328e-02 3 1  ON 57
ci_0009                -1.705953e-02 3 1  ON 58
ci_0010                -1.724953e-02 3 1  ON 59
ci_0011                -1.199008e-02 3 1  ON 60
ci_0012                -1.055134e-02 3 1  ON 61
ci_0013                 1.303090e-02 3 1  ON 62
ci_0014                 1.365108e-02 3 1  ON 63
ci_0015                 1.283416e-02 3 1  ON 64
ci_0016                 1.300663e-02 3 1  ON 65
ci_0017                 1.142107e-02 3 1  ON 66
ci_0018                 1.206350e-02 3 1  ON 67
ci_0019                 1.158329e-02 3 1  ON 68
ci_0020                 1.106730e-02 3 1  ON 69
ci_0021                -2.257033e-03 3 1  ON 70
ci_0022                 7.295943e-04 3 1  ON 71
ci_0023                -1.131519e-02 3 1  ON 72
ci_0024                -1.104763e-02 3 1  ON 73
ci_0025                -1.053707e-02 3 1  ON 74
ci_0026                -1.382011e-02 3 1  ON 75
ci_0027                -1.158087e-02 3 1  ON 76
ci_0028                -1.181685e-02 3 1  ON 77
ci_0029                -1.071104e-02 3 1  ON 78
ci_0030                -1.170091e-02 3 1  ON 79
ci_0031                 2.041697e-02 3 1  ON 80
ci_0032                 2.083460e-02 3 1  ON 81
ci_0033                 9.854424e-03 3 1  ON 82
ci_0034                 9.681095e-03 3 1  ON 83
ci_0035                 6.563608e-03 3 1  ON 84
ci_0036                 5.735983e-03 3 1  ON 85
ci_0037                -1.057259e-02 3 1  ON 86
ci_0038                -1.271647e-02 3 1  ON 87
ci_0039                -2.501274e-03 3 1  ON 88
ci_0040                -2.446160e-03 3 1  ON 89
ci_0041                 7.563618e-03 3 1  ON 90
ci_0042                 6.809006e-03 3 1  ON 91
ci_0043                -1.838037e-02 3 1  ON 92
ci_0044                -1.904879e-02 3 1  ON 93
ci_0045                 7.424701e-03 3 1  ON 94
ci_0046                 7.684615e-03 3 1  ON 95
ci_0047                -1.895991e-03 3 1  ON 96
ci_0048                -2.526880e-03 3 1  ON 97
ci_0049                -6.266408e-03 3 1  ON 98
ci_0050                -6.772367e-03 3 1  ON 99
ci_0051                -3.463419e-03 3 1  ON 100
ci_0052                -3.318938e-03 3 1  ON 101
ci_0053                -4.978978e-03 3 1  ON 102
ci_0054                -3.593791e-03 3 1  ON 103
ci_0055                 6.879863e-03 3 1  ON 104
ci_0056                 3.928984e-03 3 1  ON 105
ci_0057                 4.635641e-03 3 1  ON 106
ci_0058                 4.413352e-03 3 1  ON 107
ci_0059                -4.773620e-03 3 1  ON 108
ci_0060                -3.505460e-03 3 1  ON 109
ci_0061                -3.089793e-03 3 1  ON 110
ci_0062                -2.587045e-03 3 1  ON 111
ci_0063                -8.199892e-03 3 1  ON 112
ci_0064                -9.798683e-03 3 1  ON 113
ci_0065                -5.275974e-03 3 1  ON 114
ci_0066                -5.529094e-03 3 1  ON 115
ci_0067                -4.726696e-03 3 1  ON 116
ci_0068                -6.780880e-03 3 1  ON 117
ci_0069                 4.133290e-03 3 1  ON 118
ci_0070                 3.857928e-03 3 1  ON 119
ci_0071                 5.023166e-04 3 1  ON 120
ci_0072                -1.780919e-03 3 1  ON 121
ci_0073                 4.641683e-03 3 1  ON 122
ci_0074                 4.507171e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7862e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s040 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s040 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=40  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -16.9405
    reference variance = 0.175938
====================================================
  Execution time = 2.1370e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s040
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5255e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3869e-01
  Total weights = 1.951943591e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.2253e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326425450239
                                         uncertainty =       0.006229921419

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326425450239
                                         uncertainty =       0.006229921419

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403969862
  error estimate for blocks of size 2^( 2) =       0.000416353519
  error estimate for blocks of size 2^( 3) =       0.000430100070
  error estimate for blocks of size 2^( 4) =       0.000442563822
  error estimate for blocks of size 2^( 5) =       0.000453993447
  error estimate for blocks of size 2^( 6) =       0.000461889923
  error estimate for blocks of size 2^( 7) =       0.000464510272

      target function =                  N/A
              le_mean =     -16.905382152817
             les_mean =     286.130638448678
             stat err =       0.000455739366
             autocorr =       1.272726699122
              std dev =       0.571299657768
             le_variance =       0.326383298966


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690538215282e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e-01, overlap shift 1.4552e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905382152807       residual = 3.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905440263499       residual = 1.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905448612594       residual = 8.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905449058104       residual = 7.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905447895742       residual = 4.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905447156654       residual = 5.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905446793453       residual = 4.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905446128817       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905446681155       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905447257278       residual = 6.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905447335486       residual = 3.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905447902491       residual = 1.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905447922173       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905447678635       residual = 5.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4552e-01 is 1.492062e-03

solving harmonic davidson linear method for identity shift 5.8208e-01, overlap shift 5.8208e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905382152807       residual = 3.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905408472024       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905412431663       residual = 5.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905413125156       residual = 5.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905412319563       residual = 7.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905411882865       residual = 3.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905411748314       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905411764349       residual = 6.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905411850299       residual = 3.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905411992226       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905412000000       residual = 3.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.8208e-01 is 6.724015e-04

solving harmonic davidson linear method for identity shift 2.3283e+00, overlap shift 2.3283e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905382152807       residual = 3.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905390407610       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905391725127       residual = 5.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905392070703       residual = 6.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905391876121       residual = 7.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905391622500       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905391540607       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905391576833       residual = 4.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905391594877       residual = 1.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905391613460       residual = 6.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.3283e+00 is 2.097270e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.395922 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7604e+01
  </log>
  <optVariables href="H2O.s040.opt.xml">
   uu_0                 3.133111e-01 1 1  ON 0
   uu_1                 1.455709e-01 1 1  ON 1
   uu_2                 4.354276e-02 1 1  ON 2
   uu_3                -1.959338e-02 1 1  ON 3
   uu_4                -6.635974e-02 1 1  ON 4
   uu_5                -1.025613e-01 1 1  ON 5
   uu_6                -1.318512e-01 1 1  ON 6
   uu_7                -1.471790e-01 1 1  ON 7
   uu_8                -1.404954e-01 1 1  ON 8
   uu_9                -1.123132e-01 1 1  ON 9
   ud_0                 4.508264e-01 1 1  ON 10
   ud_1                 1.850375e-01 1 1  ON 11
   ud_2                 6.457974e-02 1 1  ON 12
   ud_3                -6.646757e-03 1 1  ON 13
   ud_4                -6.398346e-02 1 1  ON 14
   ud_5                -1.065100e-01 1 1  ON 15
   ud_6                -1.352397e-01 1 1  ON 16
   ud_7                -1.530122e-01 1 1  ON 17
   ud_8                -1.551276e-01 1 1  ON 18
   ud_9                -1.452041e-01 1 1  ON 19
   eO_0                -7.493059e-01 1 1  ON 20
   eO_1                -4.286751e-01 1 1  ON 21
   eO_2                -1.757172e-02 1 1  ON 22
   eO_3                 2.964640e-01 1 1  ON 23
   eO_4                 5.240899e-01 1 1  ON 24
   eO_5                 4.885769e-01 1 1  ON 25
   eO_6                 2.624568e-01 1 1  ON 26
   eO_7                -4.216991e-02 1 1  ON 27
   eO_8                -2.330312e-01 1 1  ON 28
   eO_9                -9.775122e-02 1 1  ON 29
  eH1_0                -2.637516e-01 1 1  ON 30
  eH1_1                -1.560402e-01 1 1  ON 31
  eH1_2                -1.060798e-01 1 1  ON 32
  eH1_3                -5.059953e-02 1 1  ON 33
  eH1_4                -9.596466e-05 1 1  ON 34
  eH1_5                 3.636461e-02 1 1  ON 35
  eH1_6                 9.854044e-02 1 1  ON 36
  eH1_7                 1.592384e-01 1 1  ON 37
  eH1_8                 1.936425e-01 1 1  ON 38
  eH1_9                 8.905670e-02 1 1  ON 39
  eH2_0                -2.624186e-01 1 1  ON 40
  eH2_1                -1.544217e-01 1 1  ON 41
  eH2_2                -1.043354e-01 1 1  ON 42
  eH2_3                -4.880171e-02 1 1  ON 43
  eH2_4                 1.684463e-03 1 1  ON 44
  eH2_5                 3.817083e-02 1 1  ON 45
  eH2_6                 1.002454e-01 1 1  ON 46
  eH2_7                 1.607881e-01 1 1  ON 47
  eH2_8                 1.979079e-01 1 1  ON 48
  eH2_9                 8.254045e-02 1 1  ON 49
ci_0001                 7.014400e-01 3 1  ON 50
ci_0002                 7.006071e-01 3 1  ON 51
ci_0003                -2.748951e-02 3 1  ON 52
ci_0004                -2.850235e-02 3 1  ON 53
ci_0005                -3.626364e-02 3 1  ON 54
ci_0006                -3.645219e-02 3 1  ON 55
ci_0007                -2.137181e-02 3 1  ON 56
ci_0008                -2.044878e-02 3 1  ON 57
ci_0009                -1.695862e-02 3 1  ON 58
ci_0010                -1.736780e-02 3 1  ON 59
ci_0011                -1.226395e-02 3 1  ON 60
ci_0012                -1.090368e-02 3 1  ON 61
ci_0013                 1.277912e-02 3 1  ON 62
ci_0014                 1.360673e-02 3 1  ON 63
ci_0015                 1.269714e-02 3 1  ON 64
ci_0016                 1.332514e-02 3 1  ON 65
ci_0017                 1.168016e-02 3 1  ON 66
ci_0018                 1.165043e-02 3 1  ON 67
ci_0019                 1.133388e-02 3 1  ON 68
ci_0020                 1.133739e-02 3 1  ON 69
ci_0021                -2.021211e-03 3 1  ON 70
ci_0022                 3.987698e-04 3 1  ON 71
ci_0023                -1.106058e-02 3 1  ON 72
ci_0024                -1.122752e-02 3 1  ON 73
ci_0025                -1.042339e-02 3 1  ON 74
ci_0026                -1.314771e-02 3 1  ON 75
ci_0027                -1.141235e-02 3 1  ON 76
ci_0028                -1.155154e-02 3 1  ON 77
ci_0029                -1.046699e-02 3 1  ON 78
ci_0030                -1.154418e-02 3 1  ON 79
ci_0031                 2.018083e-02 3 1  ON 80
ci_0032                 2.096732e-02 3 1  ON 81
ci_0033                 9.734925e-03 3 1  ON 82
ci_0034                 9.483526e-03 3 1  ON 83
ci_0035                 6.556943e-03 3 1  ON 84
ci_0036                 5.956471e-03 3 1  ON 85
ci_0037                -1.068206e-02 3 1  ON 86
ci_0038                -1.244571e-02 3 1  ON 87
ci_0039                -2.482236e-03 3 1  ON 88
ci_0040                -2.418045e-03 3 1  ON 89
ci_0041                 7.136729e-03 3 1  ON 90
ci_0042                 7.064048e-03 3 1  ON 91
ci_0043                -1.871806e-02 3 1  ON 92
ci_0044                -1.912153e-02 3 1  ON 93
ci_0045                 7.669400e-03 3 1  ON 94
ci_0046                 7.395859e-03 3 1  ON 95
ci_0047                -2.000957e-03 3 1  ON 96
ci_0048                -2.202236e-03 3 1  ON 97
ci_0049                -6.006769e-03 3 1  ON 98
ci_0050                -6.279764e-03 3 1  ON 99
ci_0051                -3.435836e-03 3 1  ON 100
ci_0052                -3.341615e-03 3 1  ON 101
ci_0053                -4.797633e-03 3 1  ON 102
ci_0054                -3.904689e-03 3 1  ON 103
ci_0055                 6.509847e-03 3 1  ON 104
ci_0056                 4.113393e-03 3 1  ON 105
ci_0057                 4.658484e-03 3 1  ON 106
ci_0058                 4.807085e-03 3 1  ON 107
ci_0059                -4.685526e-03 3 1  ON 108
ci_0060                -3.868479e-03 3 1  ON 109
ci_0061                -2.974787e-03 3 1  ON 110
ci_0062                -2.457685e-03 3 1  ON 111
ci_0063                -8.486998e-03 3 1  ON 112
ci_0064                -9.348993e-03 3 1  ON 113
ci_0065                -5.494579e-03 3 1  ON 114
ci_0066                -5.340677e-03 3 1  ON 115
ci_0067                -4.898706e-03 3 1  ON 116
ci_0068                -6.218446e-03 3 1  ON 117
ci_0069                 4.145435e-03 3 1  ON 118
ci_0070                 4.123722e-03 3 1  ON 119
ci_0071                 3.171581e-04 3 1  ON 120
ci_0072                -1.252320e-03 3 1  ON 121
ci_0073                 4.712246e-03 3 1  ON 122
ci_0074                 4.480710e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -16.9147
    reference variance = 0.413637
====================================================
  Execution time = 2.1652e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s040
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3697e-01
  Total weights = 1.9515e+06
  Execution time = 1.9089e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323471223199
                                         uncertainty =       0.002017600240

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323471223199
                                         uncertainty =       0.002017600240

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402202641
  error estimate for blocks of size 2^( 2) =       0.000415264374
  error estimate for blocks of size 2^( 3) =       0.000428744583
  error estimate for blocks of size 2^( 4) =       0.000440891700
  error estimate for blocks of size 2^( 5) =       0.000451691882
  error estimate for blocks of size 2^( 6) =       0.000460268982
  error estimate for blocks of size 2^( 7) =       0.000464532036

      target function =                  N/A
              le_mean =     -16.906219113879
             les_mean =     286.159476610480
             stat err =       0.000454346150
             autocorr =       1.276097531741
              std dev =       0.568800429593
             le_variance =       0.323533928706

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322788225214
                                         uncertainty =       0.002003478986

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322788225214
                                         uncertainty =       0.002003478986

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401776516
  error estimate for blocks of size 2^( 2) =       0.000414827609
  error estimate for blocks of size 2^( 3) =       0.000428290013
  error estimate for blocks of size 2^( 4) =       0.000440437175
  error estimate for blocks of size 2^( 5) =       0.000451230863
  error estimate for blocks of size 2^( 6) =       0.000459849566
  error estimate for blocks of size 2^( 7) =       0.000464146302

      target function =                  N/A
              le_mean =     -16.906194610364
             les_mean =     286.160817001740
             stat err =       0.000453915976
             autocorr =       1.276385435764
              std dev =       0.568197798457
             le_variance =       0.322848738172

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322808213980
                                         uncertainty =       0.001998154146

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322808213980
                                         uncertainty =       0.001998154146

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401788769
  error estimate for blocks of size 2^( 2) =       0.000414839838
  error estimate for blocks of size 2^( 3) =       0.000428308020
  error estimate for blocks of size 2^( 4) =       0.000440458030
  error estimate for blocks of size 2^( 5) =       0.000451264375
  error estimate for blocks of size 2^( 6) =       0.000459871799
  error estimate for blocks of size 2^( 7) =       0.000464192232

      target function =                  N/A
              le_mean =     -16.906201167753
             les_mean =     286.186542314467
             stat err =       0.000453946609
             autocorr =       1.276479855962
              std dev =       0.568215126835
             le_variance =       0.322868430364

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323317440927
                                         uncertainty =       0.002013663129

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323317440927
                                         uncertainty =       0.002013663129

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402106782
  error estimate for blocks of size 2^( 2) =       0.000415167546
  error estimate for blocks of size 2^( 3) =       0.000428643366
  error estimate for blocks of size 2^( 4) =       0.000440792057
  error estimate for blocks of size 2^( 5) =       0.000451594461
  error estimate for blocks of size 2^( 6) =       0.000460181141
  error estimate for blocks of size 2^( 7) =       0.000464455196

      target function =                  N/A
              le_mean =     -16.906212479435
             les_mean =     286.160301238427
             stat err =       0.000454255714
             autocorr =       1.276197829680
              std dev =       0.568664864639
             le_variance =       0.323379728275


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906219113879        initial  <--
     1.4552e-01     1.4552e+00             1.4921e-03       -16.906194610364
     5.8208e-01     5.8208e+00             6.7240e-04       -16.906201167753
     2.3283e+00     2.3283e+01             2.0973e-04       -16.906212479435

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.2926
  </log>
  <optVariables href="H2O.s040.opt.xml">
   uu_0                 3.131310e-01 1 1  ON 0
   uu_1                 1.455112e-01 1 1  ON 1
   uu_2                 4.363221e-02 1 1  ON 2
   uu_3                -1.943652e-02 1 1  ON 3
   uu_4                -6.630883e-02 1 1  ON 4
   uu_5                -1.025947e-01 1 1  ON 5
   uu_6                -1.317570e-01 1 1  ON 6
   uu_7                -1.470429e-01 1 1  ON 7
   uu_8                -1.404856e-01 1 1  ON 8
   uu_9                -1.122924e-01 1 1  ON 9
   ud_0                 4.506627e-01 1 1  ON 10
   ud_1                 1.849852e-01 1 1  ON 11
   ud_2                 6.451221e-02 1 1  ON 12
   ud_3                -6.675444e-03 1 1  ON 13
   ud_4                -6.383912e-02 1 1  ON 14
   ud_5                -1.064541e-01 1 1  ON 15
   ud_6                -1.351716e-01 1 1  ON 16
   ud_7                -1.529348e-01 1 1  ON 17
   ud_8                -1.552505e-01 1 1  ON 18
   ud_9                -1.452540e-01 1 1  ON 19
   eO_0                -7.494271e-01 1 1  ON 20
   eO_1                -4.286366e-01 1 1  ON 21
   eO_2                -1.772498e-02 1 1  ON 22
   eO_3                 2.964966e-01 1 1  ON 23
   eO_4                 5.240324e-01 1 1  ON 24
   eO_5                 4.884535e-01 1 1  ON 25
   eO_6                 2.626025e-01 1 1  ON 26
   eO_7                -4.221480e-02 1 1  ON 27
   eO_8                -2.329831e-01 1 1  ON 28
   eO_9                -9.754949e-02 1 1  ON 29
  eH1_0                -2.637381e-01 1 1  ON 30
  eH1_1                -1.558881e-01 1 1  ON 31
  eH1_2                -1.059375e-01 1 1  ON 32
  eH1_3                -5.045828e-02 1 1  ON 33
  eH1_4                 8.203897e-06 1 1  ON 34
  eH1_5                 3.640027e-02 1 1  ON 35
  eH1_6                 9.851967e-02 1 1  ON 36
  eH1_7                 1.591263e-01 1 1  ON 37
  eH1_8                 1.935511e-01 1 1  ON 38
  eH1_9                 8.878337e-02 1 1  ON 39
  eH2_0                -2.622148e-01 1 1  ON 40
  eH2_1                -1.544387e-01 1 1  ON 41
  eH2_2                -1.042933e-01 1 1  ON 42
  eH2_3                -4.873732e-02 1 1  ON 43
  eH2_4                 1.640334e-03 1 1  ON 44
  eH2_5                 3.806755e-02 1 1  ON 45
  eH2_6                 1.003579e-01 1 1  ON 46
  eH2_7                 1.608662e-01 1 1  ON 47
  eH2_8                 1.979023e-01 1 1  ON 48
  eH2_9                 8.224706e-02 1 1  ON 49
ci_0001                 7.013893e-01 3 1  ON 50
ci_0002                 7.006179e-01 3 1  ON 51
ci_0003                -2.734484e-02 3 1  ON 52
ci_0004                -2.861472e-02 3 1  ON 53
ci_0005                -3.639026e-02 3 1  ON 54
ci_0006                -3.643257e-02 3 1  ON 55
ci_0007                -2.113576e-02 3 1  ON 56
ci_0008                -2.052328e-02 3 1  ON 57
ci_0009                -1.705953e-02 3 1  ON 58
ci_0010                -1.724953e-02 3 1  ON 59
ci_0011                -1.199008e-02 3 1  ON 60
ci_0012                -1.055134e-02 3 1  ON 61
ci_0013                 1.303090e-02 3 1  ON 62
ci_0014                 1.365108e-02 3 1  ON 63
ci_0015                 1.283416e-02 3 1  ON 64
ci_0016                 1.300663e-02 3 1  ON 65
ci_0017                 1.142107e-02 3 1  ON 66
ci_0018                 1.206350e-02 3 1  ON 67
ci_0019                 1.158329e-02 3 1  ON 68
ci_0020                 1.106730e-02 3 1  ON 69
ci_0021                -2.257033e-03 3 1  ON 70
ci_0022                 7.295943e-04 3 1  ON 71
ci_0023                -1.131519e-02 3 1  ON 72
ci_0024                -1.104763e-02 3 1  ON 73
ci_0025                -1.053707e-02 3 1  ON 74
ci_0026                -1.382011e-02 3 1  ON 75
ci_0027                -1.158087e-02 3 1  ON 76
ci_0028                -1.181685e-02 3 1  ON 77
ci_0029                -1.071104e-02 3 1  ON 78
ci_0030                -1.170091e-02 3 1  ON 79
ci_0031                 2.041697e-02 3 1  ON 80
ci_0032                 2.083460e-02 3 1  ON 81
ci_0033                 9.854424e-03 3 1  ON 82
ci_0034                 9.681095e-03 3 1  ON 83
ci_0035                 6.563608e-03 3 1  ON 84
ci_0036                 5.735983e-03 3 1  ON 85
ci_0037                -1.057259e-02 3 1  ON 86
ci_0038                -1.271647e-02 3 1  ON 87
ci_0039                -2.501274e-03 3 1  ON 88
ci_0040                -2.446160e-03 3 1  ON 89
ci_0041                 7.563618e-03 3 1  ON 90
ci_0042                 6.809006e-03 3 1  ON 91
ci_0043                -1.838037e-02 3 1  ON 92
ci_0044                -1.904879e-02 3 1  ON 93
ci_0045                 7.424701e-03 3 1  ON 94
ci_0046                 7.684615e-03 3 1  ON 95
ci_0047                -1.895991e-03 3 1  ON 96
ci_0048                -2.526880e-03 3 1  ON 97
ci_0049                -6.266408e-03 3 1  ON 98
ci_0050                -6.772367e-03 3 1  ON 99
ci_0051                -3.463419e-03 3 1  ON 100
ci_0052                -3.318938e-03 3 1  ON 101
ci_0053                -4.978978e-03 3 1  ON 102
ci_0054                -3.593791e-03 3 1  ON 103
ci_0055                 6.879863e-03 3 1  ON 104
ci_0056                 3.928984e-03 3 1  ON 105
ci_0057                 4.635641e-03 3 1  ON 106
ci_0058                 4.413352e-03 3 1  ON 107
ci_0059                -4.773620e-03 3 1  ON 108
ci_0060                -3.505460e-03 3 1  ON 109
ci_0061                -3.089793e-03 3 1  ON 110
ci_0062                -2.587045e-03 3 1  ON 111
ci_0063                -8.199892e-03 3 1  ON 112
ci_0064                -9.798683e-03 3 1  ON 113
ci_0065                -5.275974e-03 3 1  ON 114
ci_0066                -5.529094e-03 3 1  ON 115
ci_0067                -4.726696e-03 3 1  ON 116
ci_0068                -6.780880e-03 3 1  ON 117
ci_0069                 4.133290e-03 3 1  ON 118
ci_0070                 3.857928e-03 3 1  ON 119
ci_0071                 5.023166e-04 3 1  ON 120
ci_0072                -1.780919e-03 3 1  ON 121
ci_0073                 4.641683e-03 3 1  ON 122
ci_0074                 4.507171e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8904e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s041 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s041 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=41  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -16.8913
    reference variance = 0.64907
====================================================
  Execution time = 2.3219e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s041
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5256e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4011e-01
  Total weights = 1.951585115e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1829e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324663584114
                                         uncertainty =       0.002271551877

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324663584114
                                         uncertainty =       0.002271551877

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402912608
  error estimate for blocks of size 2^( 2) =       0.000415491384
  error estimate for blocks of size 2^( 3) =       0.000428148396
  error estimate for blocks of size 2^( 4) =       0.000439728419
  error estimate for blocks of size 2^( 5) =       0.000448914617
  error estimate for blocks of size 2^( 6) =       0.000456230514
  error estimate for blocks of size 2^( 7) =       0.000459201142

      target function =                  N/A
              le_mean =     -16.906222265585
             les_mean =     286.160463385126
             stat err =       0.000451018673
             autocorr =       1.253046914467
              std dev =       0.569804474067
             le_variance =       0.324677138667


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690622226559e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+00, overlap shift 1.4552e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906222265585       residual = 3.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906238725159       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906239050727       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906239311748       residual = 7.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906238990280       residual = 6.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906238944036       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906239156479       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906239033728       residual = 5.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906239036210       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906239025312       residual = 6.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4552e+00 is 4.191125e-04

solving harmonic davidson linear method for identity shift 5.8208e+00, overlap shift 5.8208e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906222265585       residual = 3.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906226838635       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906226943401       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906227080502       residual = 8.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906226998060       residual = 6.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906226947238       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906227001898       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906226974853       residual = 4.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906226971801       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906226972523       residual = 3.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.8208e+00 is 1.203150e-04

solving harmonic davidson linear method for identity shift 2.3283e+01, overlap shift 2.3283e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906222265585       residual = 3.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906223441581       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906223469699       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906223509556       residual = 8.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906223489118       residual = 6.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906223473893       residual = 2.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906223486811       residual = 9.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906223480191       residual = 4.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906223479501       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906223479802       residual = 2.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.3283e+01 is 3.123963e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.399850 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9410e+01
  </log>
  <optVariables href="H2O.s041.opt.xml">
   uu_0                 3.131458e-01 1 1  ON 0
   uu_1                 1.455111e-01 1 1  ON 1
   uu_2                 4.361780e-02 1 1  ON 2
   uu_3                -1.943779e-02 1 1  ON 3
   uu_4                -6.628295e-02 1 1  ON 4
   uu_5                -1.025906e-01 1 1  ON 5
   uu_6                -1.317545e-01 1 1  ON 6
   uu_7                -1.470542e-01 1 1  ON 7
   uu_8                -1.405033e-01 1 1  ON 8
   uu_9                -1.123146e-01 1 1  ON 9
   ud_0                 4.506831e-01 1 1  ON 10
   ud_1                 1.850042e-01 1 1  ON 11
   ud_2                 6.451999e-02 1 1  ON 12
   ud_3                -6.662202e-03 1 1  ON 13
   ud_4                -6.386448e-02 1 1  ON 14
   ud_5                -1.064410e-01 1 1  ON 15
   ud_6                -1.351744e-01 1 1  ON 16
   ud_7                -1.529333e-01 1 1  ON 17
   ud_8                -1.552628e-01 1 1  ON 18
   ud_9                -1.452721e-01 1 1  ON 19
   eO_0                -7.494147e-01 1 1  ON 20
   eO_1                -4.286303e-01 1 1  ON 21
   eO_2                -1.771431e-02 1 1  ON 22
   eO_3                 2.964983e-01 1 1  ON 23
   eO_4                 5.240439e-01 1 1  ON 24
   eO_5                 4.884670e-01 1 1  ON 25
   eO_6                 2.625926e-01 1 1  ON 26
   eO_7                -4.221204e-02 1 1  ON 27
   eO_8                -2.330028e-01 1 1  ON 28
   eO_9                -9.757472e-02 1 1  ON 29
  eH1_0                -2.637356e-01 1 1  ON 30
  eH1_1                -1.558986e-01 1 1  ON 31
  eH1_2                -1.059507e-01 1 1  ON 32
  eH1_3                -5.045377e-02 1 1  ON 33
  eH1_4                -2.830833e-06 1 1  ON 34
  eH1_5                 3.638517e-02 1 1  ON 35
  eH1_6                 9.852825e-02 1 1  ON 36
  eH1_7                 1.591322e-01 1 1  ON 37
  eH1_8                 1.935565e-01 1 1  ON 38
  eH1_9                 8.880437e-02 1 1  ON 39
  eH2_0                -2.622189e-01 1 1  ON 40
  eH2_1                -1.544443e-01 1 1  ON 41
  eH2_2                -1.043002e-01 1 1  ON 42
  eH2_3                -4.874616e-02 1 1  ON 43
  eH2_4                 1.606989e-03 1 1  ON 44
  eH2_5                 3.808208e-02 1 1  ON 45
  eH2_6                 1.003558e-01 1 1  ON 46
  eH2_7                 1.608604e-01 1 1  ON 47
  eH2_8                 1.979178e-01 1 1  ON 48
  eH2_9                 8.227933e-02 1 1  ON 49
ci_0001                 7.013700e-01 3 1  ON 50
ci_0002                 7.006432e-01 3 1  ON 51
ci_0003                -2.736025e-02 3 1  ON 52
ci_0004                -2.858629e-02 3 1  ON 53
ci_0005                -3.639490e-02 3 1  ON 54
ci_0006                -3.645333e-02 3 1  ON 55
ci_0007                -2.114616e-02 3 1  ON 56
ci_0008                -2.057301e-02 3 1  ON 57
ci_0009                -1.707144e-02 3 1  ON 58
ci_0010                -1.724961e-02 3 1  ON 59
ci_0011                -1.202015e-02 3 1  ON 60
ci_0012                -1.062310e-02 3 1  ON 61
ci_0013                 1.301397e-02 3 1  ON 62
ci_0014                 1.360340e-02 3 1  ON 63
ci_0015                 1.285852e-02 3 1  ON 64
ci_0016                 1.298117e-02 3 1  ON 65
ci_0017                 1.137962e-02 3 1  ON 66
ci_0018                 1.203869e-02 3 1  ON 67
ci_0019                 1.157547e-02 3 1  ON 68
ci_0020                 1.109918e-02 3 1  ON 69
ci_0021                -2.243798e-03 3 1  ON 70
ci_0022                 6.850159e-04 3 1  ON 71
ci_0023                -1.131051e-02 3 1  ON 72
ci_0024                -1.106368e-02 3 1  ON 73
ci_0025                -1.053246e-02 3 1  ON 74
ci_0026                -1.370591e-02 3 1  ON 75
ci_0027                -1.158410e-02 3 1  ON 76
ci_0028                -1.175322e-02 3 1  ON 77
ci_0029                -1.068771e-02 3 1  ON 78
ci_0030                -1.167794e-02 3 1  ON 79
ci_0031                 2.036672e-02 3 1  ON 80
ci_0032                 2.082725e-02 3 1  ON 81
ci_0033                 9.817730e-03 3 1  ON 82
ci_0034                 9.690377e-03 3 1  ON 83
ci_0035                 6.516812e-03 3 1  ON 84
ci_0036                 5.755054e-03 3 1  ON 85
ci_0037                -1.057402e-02 3 1  ON 86
ci_0038                -1.266766e-02 3 1  ON 87
ci_0039                -2.485448e-03 3 1  ON 88
ci_0040                -2.476416e-03 3 1  ON 89
ci_0041                 7.523916e-03 3 1  ON 90
ci_0042                 6.838094e-03 3 1  ON 91
ci_0043                -1.835443e-02 3 1  ON 92
ci_0044                -1.904119e-02 3 1  ON 93
ci_0045                 7.431581e-03 3 1  ON 94
ci_0046                 7.652359e-03 3 1  ON 95
ci_0047                -1.913410e-03 3 1  ON 96
ci_0048                -2.487378e-03 3 1  ON 97
ci_0049                -6.196874e-03 3 1  ON 98
ci_0050                -6.729570e-03 3 1  ON 99
ci_0051                -3.486510e-03 3 1  ON 100
ci_0052                -3.317960e-03 3 1  ON 101
ci_0053                -4.956939e-03 3 1  ON 102
ci_0054                -3.651249e-03 3 1  ON 103
ci_0055                 6.910150e-03 3 1  ON 104
ci_0056                 3.986341e-03 3 1  ON 105
ci_0057                 4.674720e-03 3 1  ON 106
ci_0058                 4.393680e-03 3 1  ON 107
ci_0059                -4.752851e-03 3 1  ON 108
ci_0060                -3.625775e-03 3 1  ON 109
ci_0061                -3.108564e-03 3 1  ON 110
ci_0062                -2.643777e-03 3 1  ON 111
ci_0063                -8.269246e-03 3 1  ON 112
ci_0064                -9.766300e-03 3 1  ON 113
ci_0065                -5.274026e-03 3 1  ON 114
ci_0066                -5.537387e-03 3 1  ON 115
ci_0067                -4.745907e-03 3 1  ON 116
ci_0068                -6.704116e-03 3 1  ON 117
ci_0069                 4.148411e-03 3 1  ON 118
ci_0070                 3.887924e-03 3 1  ON 119
ci_0071                 5.057027e-04 3 1  ON 120
ci_0072                -1.715243e-03 3 1  ON 121
ci_0073                 4.610368e-03 3 1  ON 122
ci_0074                 4.480043e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -16.9039
    reference variance = 0.2275
====================================================
  Execution time = 2.1129e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s041
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4224e-01
  Total weights = 1.9518e+06
  Execution time = 1.9173e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0979898
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327304195767
                                         uncertainty =       0.002350900903

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327304195767
                                         uncertainty =       0.002350900903

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404491315
  error estimate for blocks of size 2^( 2) =       0.000417397022
  error estimate for blocks of size 2^( 3) =       0.000430686192
  error estimate for blocks of size 2^( 4) =       0.000443691990
  error estimate for blocks of size 2^( 5) =       0.000454027674
  error estimate for blocks of size 2^( 6) =       0.000462079172
  error estimate for blocks of size 2^( 7) =       0.000470218290

      target function =                  N/A
              le_mean =     -16.906199517118
             les_mean =     286.185766083971
             stat err =       0.000457504281
             autocorr =       1.279298591195
              std dev =       0.572037104229
             le_variance =       0.327226448615

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00257819
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327112986250
                                         uncertainty =       0.002349740014

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327112986250
                                         uncertainty =       0.002349740014

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404373163
  error estimate for blocks of size 2^( 2) =       0.000417278401
  error estimate for blocks of size 2^( 3) =       0.000430568662
  error estimate for blocks of size 2^( 4) =       0.000443570523
  error estimate for blocks of size 2^( 5) =       0.000453907156
  error estimate for blocks of size 2^( 6) =       0.000461946383
  error estimate for blocks of size 2^( 7) =       0.000470089584

      target function =                  N/A
              le_mean =     -16.906203888311
             les_mean =     286.162202491004
             stat err =       0.000457378411
             autocorr =       1.279342044097
              std dev =       0.571870011733
             le_variance =       0.327035310319

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0947363
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327189825232
                                         uncertainty =       0.002350153901

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327189825232
                                         uncertainty =       0.002350153901

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404420646
  error estimate for blocks of size 2^( 2) =       0.000417326374
  error estimate for blocks of size 2^( 3) =       0.000430615846
  error estimate for blocks of size 2^( 4) =       0.000443619459
  error estimate for blocks of size 2^( 5) =       0.000453955947
  error estimate for blocks of size 2^( 6) =       0.000461999317
  error estimate for blocks of size 2^( 7) =       0.000470141701

      target function =                  N/A
              le_mean =     -16.906200736023
             les_mean =     286.165118597384
             stat err =       0.000457429106
             autocorr =       1.279325198625
              std dev =       0.571937161924
             le_variance =       0.327112117189

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327287188651
                                         uncertainty =       0.002350608892

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327287188651
                                         uncertainty =       0.002350608892

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404480806
  error estimate for blocks of size 2^( 2) =       0.000417386674
  error estimate for blocks of size 2^( 3) =       0.000430675108
  error estimate for blocks of size 2^( 4) =       0.000443680758
  error estimate for blocks of size 2^( 5) =       0.000454015952
  error estimate for blocks of size 2^( 6) =       0.000462064957
  error estimate for blocks of size 2^( 7) =       0.000470208965

      target function =                  N/A
              le_mean =     -16.906198816234
             les_mean =     286.162291534780
             stat err =       0.000457492658
             autocorr =       1.279300063477
              std dev =       0.572022242033
             le_variance =       0.327209445381


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906199517118        initial
     1.4552e+00     1.4552e+01             4.1911e-04       -16.906203888311  <--
     5.8208e+00     5.8208e+01             1.2031e-04       -16.906200736023
     2.3283e+01     2.3283e+02             3.1240e-05       -16.906198816234

*****************************************************************************
Applying the update for shift_i =   1.4552e+00     and shift_s =   1.4552e+01
*****************************************************************************

  Execution time = 3.0827e+01
  </log>
  <optVariables href="H2O.s041.opt.xml">
   uu_0                 3.131840e-01 1 1  ON 0
   uu_1                 1.455068e-01 1 1  ON 1
   uu_2                 4.358610e-02 1 1  ON 2
   uu_3                -1.943904e-02 1 1  ON 3
   uu_4                -6.621602e-02 1 1  ON 4
   uu_5                -1.025748e-01 1 1  ON 5
   uu_6                -1.317453e-01 1 1  ON 6
   uu_7                -1.470863e-01 1 1  ON 7
   uu_8                -1.405557e-01 1 1  ON 8
   uu_9                -1.123807e-01 1 1  ON 9
   ud_0                 4.507417e-01 1 1  ON 10
   ud_1                 1.850529e-01 1 1  ON 11
   ud_2                 6.454645e-02 1 1  ON 12
   ud_3                -6.632677e-03 1 1  ON 13
   ud_4                -6.392028e-02 1 1  ON 14
   ud_5                -1.064134e-01 1 1  ON 15
   ud_6                -1.351777e-01 1 1  ON 16
   ud_7                -1.529267e-01 1 1  ON 17
   ud_8                -1.552992e-01 1 1  ON 18
   ud_9                -1.453258e-01 1 1  ON 19
   eO_0                -7.493790e-01 1 1  ON 20
   eO_1                -4.286123e-01 1 1  ON 21
   eO_2                -1.768382e-02 1 1  ON 22
   eO_3                 2.965048e-01 1 1  ON 23
   eO_4                 5.240762e-01 1 1  ON 24
   eO_5                 4.885072e-01 1 1  ON 25
   eO_6                 2.625655e-01 1 1  ON 26
   eO_7                -4.220385e-02 1 1  ON 27
   eO_8                -2.330610e-01 1 1  ON 28
   eO_9                -9.764919e-02 1 1  ON 29
  eH1_0                -2.637296e-01 1 1  ON 30
  eH1_1                -1.559285e-01 1 1  ON 31
  eH1_2                -1.059873e-01 1 1  ON 32
  eH1_3                -5.044528e-02 1 1  ON 33
  eH1_4                -3.233464e-05 1 1  ON 34
  eH1_5                 3.634094e-02 1 1  ON 35
  eH1_6                 9.855254e-02 1 1  ON 36
  eH1_7                 1.591499e-01 1 1  ON 37
  eH1_8                 1.935726e-01 1 1  ON 38
  eH1_9                 8.886622e-02 1 1  ON 39
  eH2_0                -2.622311e-01 1 1  ON 40
  eH2_1                -1.544614e-01 1 1  ON 41
  eH2_2                -1.043234e-01 1 1  ON 42
  eH2_3                -4.877238e-02 1 1  ON 43
  eH2_4                 1.513108e-03 1 1  ON 44
  eH2_5                 3.812216e-02 1 1  ON 45
  eH2_6                 1.003503e-01 1 1  ON 46
  eH2_7                 1.608442e-01 1 1  ON 47
  eH2_8                 1.979639e-01 1 1  ON 48
  eH2_9                 8.237439e-02 1 1  ON 49
ci_0001                 7.013119e-01 3 1  ON 50
ci_0002                 7.007168e-01 3 1  ON 51
ci_0003                -2.740015e-02 3 1  ON 52
ci_0004                -2.851165e-02 3 1  ON 53
ci_0005                -3.640692e-02 3 1  ON 54
ci_0006                -3.650899e-02 3 1  ON 55
ci_0007                -2.117535e-02 3 1  ON 56
ci_0008                -2.071146e-02 3 1  ON 57
ci_0009                -1.710208e-02 3 1  ON 58
ci_0010                -1.725156e-02 3 1  ON 59
ci_0011                -1.210079e-02 3 1  ON 60
ci_0012                -1.081146e-02 3 1  ON 61
ci_0013                 1.296947e-02 3 1  ON 62
ci_0014                 1.347870e-02 3 1  ON 63
ci_0015                 1.292295e-02 3 1  ON 64
ci_0016                 1.291573e-02 3 1  ON 65
ci_0017                 1.127277e-02 3 1  ON 66
ci_0018                 1.197492e-02 3 1  ON 67
ci_0019                 1.155503e-02 3 1  ON 68
ci_0020                 1.118401e-02 3 1  ON 69
ci_0021                -2.204513e-03 3 1  ON 70
ci_0022                 5.605863e-04 3 1  ON 71
ci_0023                -1.129888e-02 3 1  ON 72
ci_0024                -1.110620e-02 3 1  ON 73
ci_0025                -1.051965e-02 3 1  ON 74
ci_0026                -1.340834e-02 3 1  ON 75
ci_0027                -1.159239e-02 3 1  ON 76
ci_0028                -1.158743e-02 3 1  ON 77
ci_0029                -1.062675e-02 3 1  ON 78
ci_0030                -1.161756e-02 3 1  ON 79
ci_0031                 2.022697e-02 3 1  ON 80
ci_0032                 2.080856e-02 3 1  ON 81
ci_0033                 9.716282e-03 3 1  ON 82
ci_0034                 9.715769e-03 3 1  ON 83
ci_0035                 6.392676e-03 3 1  ON 84
ci_0036                 5.805218e-03 3 1  ON 85
ci_0037                -1.057694e-02 3 1  ON 86
ci_0038                -1.253707e-02 3 1  ON 87
ci_0039                -2.447608e-03 3 1  ON 88
ci_0040                -2.549244e-03 3 1  ON 89
ci_0041                 7.420289e-03 3 1  ON 90
ci_0042                 6.914036e-03 3 1  ON 91
ci_0043                -1.827955e-02 3 1  ON 92
ci_0044                -1.901877e-02 3 1  ON 93
ci_0045                 7.449736e-03 3 1  ON 94
ci_0046                 7.563461e-03 3 1  ON 95
ci_0047                -1.955573e-03 3 1  ON 96
ci_0048                -2.391353e-03 3 1  ON 97
ci_0049                -6.016395e-03 3 1  ON 98
ci_0050                -6.617279e-03 3 1  ON 99
ci_0051                -3.542717e-03 3 1  ON 100
ci_0052                -3.316249e-03 3 1  ON 101
ci_0053                -4.902087e-03 3 1  ON 102
ci_0054                -3.796007e-03 3 1  ON 103
ci_0055                 6.993030e-03 3 1  ON 104
ci_0056                 4.142381e-03 3 1  ON 105
ci_0057                 4.780270e-03 3 1  ON 106
ci_0058                 4.341525e-03 3 1  ON 107
ci_0059                -4.701592e-03 3 1  ON 108
ci_0060                -3.924573e-03 3 1  ON 109
ci_0061                -3.157428e-03 3 1  ON 110
ci_0062                -2.794426e-03 3 1  ON 111
ci_0063                -8.442574e-03 3 1  ON 112
ci_0064                -9.685752e-03 3 1  ON 113
ci_0065                -5.268984e-03 3 1  ON 114
ci_0066                -5.559102e-03 3 1  ON 115
ci_0067                -4.792905e-03 3 1  ON 116
ci_0068                -6.517667e-03 3 1  ON 117
ci_0069                 4.185431e-03 3 1  ON 118
ci_0070                 3.961951e-03 3 1  ON 119
ci_0071                 5.151477e-04 3 1  ON 120
ci_0072                -1.543176e-03 3 1  ON 121
ci_0073                 4.534197e-03 3 1  ON 122
ci_0074                 4.413435e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.0251e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s042 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s042 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=42  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -16.8779
    reference variance = 0.222284
====================================================
  Execution time = 2.1059e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s042
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5252e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3609e-01
  Total weights = 1.952034495e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0468e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323511075224
                                         uncertainty =       0.002826813765

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323511075224
                                         uncertainty =       0.002826813765

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402230675
  error estimate for blocks of size 2^( 2) =       0.000414978110
  error estimate for blocks of size 2^( 3) =       0.000428404691
  error estimate for blocks of size 2^( 4) =       0.000442032913
  error estimate for blocks of size 2^( 5) =       0.000453393930
  error estimate for blocks of size 2^( 6) =       0.000464054119
  error estimate for blocks of size 2^( 7) =       0.000468348465

      target function =                  N/A
              le_mean =     -16.905343693416
             les_mean =     286.126733249050
             stat err =       0.000456957357
             autocorr =       1.290627666460
              std dev =       0.568840076293
             le_variance =       0.323579032397


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690534369342e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e-01, overlap shift 3.6380e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905343693389       residual = 2.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905378440124       residual = 6.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905379316052       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905378440760       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905377605558       residual = 5.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905377542966       residual = 3.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905377787010       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905377978243       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905378056461       residual = 3.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905377948474       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905378041707       residual = 5.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.6380e-01 is 7.988219e-04

solving harmonic davidson linear method for identity shift 1.4552e+00, overlap shift 1.4552e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905343693389       residual = 2.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905355777751       residual = 5.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905356307014       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905356264037       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905356217896       residual = 4.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905355989859       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905356142156       residual = 9.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905356142336       residual = 3.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905356178391       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905356140191       residual = 5.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4552e+00 is 2.946472e-04

solving harmonic davidson linear method for identity shift 5.8208e+00, overlap shift 5.8208e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905343693389       residual = 2.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905347041908       residual = 5.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905347218301       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905347259466       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905347266527       residual = 5.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905347176913       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905347216863       residual = 7.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905347218038       residual = 2.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905347227010       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905347217257       residual = 3.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.8208e+00 is 8.594367e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.409024 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7122e+01
  </log>
  <optVariables href="H2O.s042.opt.xml">
   uu_0                 3.132304e-01 1 1  ON 0
   uu_1                 1.455303e-01 1 1  ON 1
   uu_2                 4.361106e-02 1 1  ON 2
   uu_3                -1.951007e-02 1 1  ON 3
   uu_4                -6.618699e-02 1 1  ON 4
   uu_5                -1.026186e-01 1 1  ON 5
   uu_6                -1.317852e-01 1 1  ON 6
   uu_7                -1.471076e-01 1 1  ON 7
   uu_8                -1.405595e-01 1 1  ON 8
   uu_9                -1.123778e-01 1 1  ON 9
   ud_0                 4.507109e-01 1 1  ON 10
   ud_1                 1.850388e-01 1 1  ON 11
   ud_2                 6.451314e-02 1 1  ON 12
   ud_3                -6.661880e-03 1 1  ON 13
   ud_4                -6.395847e-02 1 1  ON 14
   ud_5                -1.064187e-01 1 1  ON 15
   ud_6                -1.351978e-01 1 1  ON 16
   ud_7                -1.529516e-01 1 1  ON 17
   ud_8                -1.551690e-01 1 1  ON 18
   ud_9                -1.452232e-01 1 1  ON 19
   eO_0                -7.493630e-01 1 1  ON 20
   eO_1                -4.286572e-01 1 1  ON 21
   eO_2                -1.762819e-02 1 1  ON 22
   eO_3                 2.965159e-01 1 1  ON 23
   eO_4                 5.240737e-01 1 1  ON 24
   eO_5                 4.885585e-01 1 1  ON 25
   eO_6                 2.625632e-01 1 1  ON 26
   eO_7                -4.219712e-02 1 1  ON 27
   eO_8                -2.330732e-01 1 1  ON 28
   eO_9                -9.771085e-02 1 1  ON 29
  eH1_0                -2.637758e-01 1 1  ON 30
  eH1_1                -1.560240e-01 1 1  ON 31
  eH1_2                -1.059659e-01 1 1  ON 32
  eH1_3                -5.043717e-02 1 1  ON 33
  eH1_4                -5.634244e-05 1 1  ON 34
  eH1_5                 3.633764e-02 1 1  ON 35
  eH1_6                 9.853137e-02 1 1  ON 36
  eH1_7                 1.591065e-01 1 1  ON 37
  eH1_8                 1.936341e-01 1 1  ON 38
  eH1_9                 8.899338e-02 1 1  ON 39
  eH2_0                -2.622672e-01 1 1  ON 40
  eH2_1                -1.545268e-01 1 1  ON 41
  eH2_2                -1.043911e-01 1 1  ON 42
  eH2_3                -4.871598e-02 1 1  ON 43
  eH2_4                 1.494804e-03 1 1  ON 44
  eH2_5                 3.809307e-02 1 1  ON 45
  eH2_6                 1.003572e-01 1 1  ON 46
  eH2_7                 1.607997e-01 1 1  ON 47
  eH2_8                 1.979758e-01 1 1  ON 48
  eH2_9                 8.253225e-02 1 1  ON 49
ci_0001                 7.012681e-01 3 1  ON 50
ci_0002                 7.007570e-01 3 1  ON 51
ci_0003                -2.750890e-02 3 1  ON 52
ci_0004                -2.841470e-02 3 1  ON 53
ci_0005                -3.647002e-02 3 1  ON 54
ci_0006                -3.649910e-02 3 1  ON 55
ci_0007                -2.130245e-02 3 1  ON 56
ci_0008                -2.081329e-02 3 1  ON 57
ci_0009                -1.717847e-02 3 1  ON 58
ci_0010                -1.725730e-02 3 1  ON 59
ci_0011                -1.195491e-02 3 1  ON 60
ci_0012                -1.108550e-02 3 1  ON 61
ci_0013                 1.292140e-02 3 1  ON 62
ci_0014                 1.349054e-02 3 1  ON 63
ci_0015                 1.297867e-02 3 1  ON 64
ci_0016                 1.299927e-02 3 1  ON 65
ci_0017                 1.130480e-02 3 1  ON 66
ci_0018                 1.183306e-02 3 1  ON 67
ci_0019                 1.159624e-02 3 1  ON 68
ci_0020                 1.120395e-02 3 1  ON 69
ci_0021                -2.227092e-03 3 1  ON 70
ci_0022                 5.429737e-04 3 1  ON 71
ci_0023                -1.126942e-02 3 1  ON 72
ci_0024                -1.114303e-02 3 1  ON 73
ci_0025                -1.050852e-02 3 1  ON 74
ci_0026                -1.314896e-02 3 1  ON 75
ci_0027                -1.142133e-02 3 1  ON 76
ci_0028                -1.134526e-02 3 1  ON 77
ci_0029                -1.076231e-02 3 1  ON 78
ci_0030                -1.155969e-02 3 1  ON 79
ci_0031                 2.029596e-02 3 1  ON 80
ci_0032                 2.093046e-02 3 1  ON 81
ci_0033                 9.813249e-03 3 1  ON 82
ci_0034                 9.623192e-03 3 1  ON 83
ci_0035                 6.483898e-03 3 1  ON 84
ci_0036                 5.971045e-03 3 1  ON 85
ci_0037                -1.056648e-02 3 1  ON 86
ci_0038                -1.236464e-02 3 1  ON 87
ci_0039                -2.418600e-03 3 1  ON 88
ci_0040                -2.652157e-03 3 1  ON 89
ci_0041                 7.222776e-03 3 1  ON 90
ci_0042                 6.862588e-03 3 1  ON 91
ci_0043                -1.824639e-02 3 1  ON 92
ci_0044                -1.899411e-02 3 1  ON 93
ci_0045                 7.577472e-03 3 1  ON 94
ci_0046                 7.526122e-03 3 1  ON 95
ci_0047                -2.004205e-03 3 1  ON 96
ci_0048                -2.346492e-03 3 1  ON 97
ci_0049                -6.066487e-03 3 1  ON 98
ci_0050                -6.472959e-03 3 1  ON 99
ci_0051                -3.537844e-03 3 1  ON 100
ci_0052                -3.234429e-03 3 1  ON 101
ci_0053                -4.818569e-03 3 1  ON 102
ci_0054                -3.851070e-03 3 1  ON 103
ci_0055                 6.944402e-03 3 1  ON 104
ci_0056                 4.339946e-03 3 1  ON 105
ci_0057                 4.692516e-03 3 1  ON 106
ci_0058                 4.387109e-03 3 1  ON 107
ci_0059                -4.714456e-03 3 1  ON 108
ci_0060                -3.924398e-03 3 1  ON 109
ci_0061                -3.206388e-03 3 1  ON 110
ci_0062                -2.727106e-03 3 1  ON 111
ci_0063                -8.543721e-03 3 1  ON 112
ci_0064                -9.679522e-03 3 1  ON 113
ci_0065                -5.358650e-03 3 1  ON 114
ci_0066                -5.559290e-03 3 1  ON 115
ci_0067                -4.825091e-03 3 1  ON 116
ci_0068                -6.223020e-03 3 1  ON 117
ci_0069                 4.314322e-03 3 1  ON 118
ci_0070                 4.033307e-03 3 1  ON 119
ci_0071                 4.421327e-04 3 1  ON 120
ci_0072                -1.301920e-03 3 1  ON 121
ci_0073                 4.514971e-03 3 1  ON 122
ci_0074                 4.330566e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -16.8929
    reference variance = 0.352627
====================================================
  Execution time = 2.1008e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s042
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3540e-01
  Total weights = 1.9520e+06
  Execution time = 1.9116e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324696186410
                                         uncertainty =       0.002949664361

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324696186410
                                         uncertainty =       0.002949664361

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402872412
  error estimate for blocks of size 2^( 2) =       0.000415932791
  error estimate for blocks of size 2^( 3) =       0.000429202997
  error estimate for blocks of size 2^( 4) =       0.000441607907
  error estimate for blocks of size 2^( 5) =       0.000451677349
  error estimate for blocks of size 2^( 6) =       0.000460252527
  error estimate for blocks of size 2^( 7) =       0.000465623947

      target function =                  N/A
              le_mean =     -16.905919793905
             les_mean =     286.629865277394
             stat err =       0.000454790433
             autocorr =       1.274346653776
              std dev =       0.569747628715
             le_variance =       0.324612360427

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324204007240
                                         uncertainty =       0.002995996446

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324204007240
                                         uncertainty =       0.002995996446

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402566502
  error estimate for blocks of size 2^( 2) =       0.000415633717
  error estimate for blocks of size 2^( 3) =       0.000428918937
  error estimate for blocks of size 2^( 4) =       0.000441341699
  error estimate for blocks of size 2^( 5) =       0.000451431159
  error estimate for blocks of size 2^( 6) =       0.000459961623
  error estimate for blocks of size 2^( 7) =       0.000465404392

      target function =                  N/A
              le_mean =     -16.905933740760
             les_mean =     286.149562232169
             stat err =       0.000454534718
             autocorr =       1.274849313417
              std dev =       0.569315006920
             le_variance =       0.324119577104

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324243455456
                                         uncertainty =       0.002983337017

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324243455456
                                         uncertainty =       0.002983337017

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402591251
  error estimate for blocks of size 2^( 2) =       0.000415658834
  error estimate for blocks of size 2^( 3) =       0.000428943407
  error estimate for blocks of size 2^( 4) =       0.000441366375
  error estimate for blocks of size 2^( 5) =       0.000451460474
  error estimate for blocks of size 2^( 6) =       0.000460000400
  error estimate for blocks of size 2^( 7) =       0.000465432975

      target function =                  N/A
              le_mean =     -16.905930115145
             les_mean =     286.146528736387
             stat err =       0.000454565056
             autocorr =       1.274862742366
              std dev =       0.569350006805
             le_variance =       0.324159430249

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324515947712
                                         uncertainty =       0.002950007089

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324515947712
                                         uncertainty =       0.002950007089

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402760909
  error estimate for blocks of size 2^( 2) =       0.000415829222
  error estimate for blocks of size 2^( 3) =       0.000429105857
  error estimate for blocks of size 2^( 4) =       0.000441522829
  error estimate for blocks of size 2^( 5) =       0.000451623180
  error estimate for blocks of size 2^( 6) =       0.000460195616
  error estimate for blocks of size 2^( 7) =       0.000465616680

      target function =                  N/A
              le_mean =     -16.905935720839
             les_mean =     286.725651335741
             stat err =       0.000454739576
             autocorr =       1.274767202151
              std dev =       0.569589939757
             le_variance =       0.324432699472


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905919793905        initial
     3.6380e-01     3.6380e+00             7.9882e-04       -16.905933740760
     1.4552e+00     1.4552e+01             2.9465e-04       -16.905930115145
     5.8208e+00     5.8208e+01             8.5944e-05       -16.905935720839  <--

*****************************************************************************
Applying the update for shift_i =   5.8208e+00     and shift_s =   5.8208e+01
*****************************************************************************

  Execution time = 3.0656e+01
  </log>
  <optVariables href="H2O.s042.opt.xml">
   uu_0                 3.131957e-01 1 1  ON 0
   uu_1                 1.455126e-01 1 1  ON 1
   uu_2                 4.359427e-02 1 1  ON 2
   uu_3                -1.946102e-02 1 1  ON 3
   uu_4                -6.620572e-02 1 1  ON 4
   uu_5                -1.025873e-01 1 1  ON 5
   uu_6                -1.317553e-01 1 1  ON 6
   uu_7                -1.470911e-01 1 1  ON 7
   uu_8                -1.405565e-01 1 1  ON 8
   uu_9                -1.123800e-01 1 1  ON 9
   ud_0                 4.507337e-01 1 1  ON 10
   ud_1                 1.850503e-01 1 1  ON 11
   ud_2                 6.453760e-02 1 1  ON 12
   ud_3                -6.639632e-03 1 1  ON 13
   ud_4                -6.393058e-02 1 1  ON 14
   ud_5                -1.064141e-01 1 1  ON 15
   ud_6                -1.351835e-01 1 1  ON 16
   ud_7                -1.529332e-01 1 1  ON 17
   ud_8                -1.552659e-01 1 1  ON 18
   ud_9                -1.453000e-01 1 1  ON 19
   eO_0                -7.493741e-01 1 1  ON 20
   eO_1                -4.286258e-01 1 1  ON 21
   eO_2                -1.766823e-02 1 1  ON 22
   eO_3                 2.965081e-01 1 1  ON 23
   eO_4                 5.240753e-01 1 1  ON 24
   eO_5                 4.885198e-01 1 1  ON 25
   eO_6                 2.625647e-01 1 1  ON 26
   eO_7                -4.220211e-02 1 1  ON 27
   eO_8                -2.330641e-01 1 1  ON 28
   eO_9                -9.766473e-02 1 1  ON 29
  eH1_0                -2.637409e-01 1 1  ON 30
  eH1_1                -1.559552e-01 1 1  ON 31
  eH1_2                -1.059801e-01 1 1  ON 32
  eH1_3                -5.044271e-02 1 1  ON 33
  eH1_4                -3.844418e-05 1 1  ON 34
  eH1_5                 3.634031e-02 1 1  ON 35
  eH1_6                 9.854727e-02 1 1  ON 36
  eH1_7                 1.591389e-01 1 1  ON 37
  eH1_8                 1.935881e-01 1 1  ON 38
  eH1_9                 8.889819e-02 1 1  ON 39
  eH2_0                -2.622398e-01 1 1  ON 40
  eH2_1                -1.544787e-01 1 1  ON 41
  eH2_2                -1.043420e-01 1 1  ON 42
  eH2_3                -4.875563e-02 1 1  ON 43
  eH2_4                 1.507965e-03 1 1  ON 44
  eH2_5                 3.811480e-02 1 1  ON 45
  eH2_6                 1.003522e-01 1 1  ON 46
  eH2_7                 1.608330e-01 1 1  ON 47
  eH2_8                 1.979669e-01 1 1  ON 48
  eH2_9                 8.241409e-02 1 1  ON 49
ci_0001                 7.013005e-01 3 1  ON 50
ci_0002                 7.007274e-01 3 1  ON 51
ci_0003                -2.742991e-02 3 1  ON 52
ci_0004                -2.848505e-02 3 1  ON 53
ci_0005                -3.642381e-02 3 1  ON 54
ci_0006                -3.650638e-02 3 1  ON 55
ci_0007                -2.120843e-02 3 1  ON 56
ci_0008                -2.073825e-02 3 1  ON 57
ci_0009                -1.712341e-02 3 1  ON 58
ci_0010                -1.725275e-02 3 1  ON 59
ci_0011                -1.206094e-02 3 1  ON 60
ci_0012                -1.088704e-02 3 1  ON 61
ci_0013                 1.295615e-02 3 1  ON 62
ci_0014                 1.348192e-02 3 1  ON 63
ci_0015                 1.293853e-02 3 1  ON 64
ci_0016                 1.293833e-02 3 1  ON 65
ci_0017                 1.128180e-02 3 1  ON 66
ci_0018                 1.193534e-02 3 1  ON 67
ci_0019                 1.156631e-02 3 1  ON 68
ci_0020                 1.118948e-02 3 1  ON 69
ci_0021                -2.210444e-03 3 1  ON 70
ci_0022                 5.556988e-04 3 1  ON 71
ci_0023                -1.129053e-02 3 1  ON 72
ci_0024                -1.111614e-02 3 1  ON 73
ci_0025                -1.051642e-02 3 1  ON 74
ci_0026                -1.333658e-02 3 1  ON 75
ci_0027                -1.154535e-02 3 1  ON 76
ci_0028                -1.152051e-02 3 1  ON 77
ci_0029                -1.066421e-02 3 1  ON 78
ci_0030                -1.160174e-02 3 1  ON 79
ci_0031                 2.024537e-02 3 1  ON 80
ci_0032                 2.084082e-02 3 1  ON 81
ci_0033                 9.741714e-03 3 1  ON 82
ci_0034                 9.691499e-03 3 1  ON 83
ci_0035                 6.417930e-03 3 1  ON 84
ci_0036                 5.850600e-03 3 1  ON 85
ci_0037                -1.057434e-02 3 1  ON 86
ci_0038                -1.249046e-02 3 1  ON 87
ci_0039                -2.439165e-03 3 1  ON 88
ci_0040                -2.579285e-03 3 1  ON 89
ci_0041                 7.365844e-03 3 1  ON 90
ci_0042                 6.899968e-03 3 1  ON 91
ci_0043                -1.827138e-02 3 1  ON 92
ci_0044                -1.901239e-02 3 1  ON 93
ci_0045                 7.484094e-03 3 1  ON 94
ci_0046                 7.553506e-03 3 1  ON 95
ci_0047                -1.969773e-03 3 1  ON 96
ci_0048                -2.378373e-03 3 1  ON 97
ci_0049                -6.030523e-03 3 1  ON 98
ci_0050                -6.577356e-03 3 1  ON 99
ci_0051                -3.541170e-03 3 1  ON 100
ci_0052                -3.292324e-03 3 1  ON 101
ci_0053                -4.878234e-03 3 1  ON 102
ci_0054                -3.811220e-03 3 1  ON 103
ci_0055                 6.979851e-03 3 1  ON 104
ci_0056                 4.195565e-03 3 1  ON 105
ci_0057                 4.756301e-03 3 1  ON 106
ci_0058                 4.353976e-03 3 1  ON 107
ci_0059                -4.705527e-03 3 1  ON 108
ci_0060                -3.924605e-03 3 1  ON 109
ci_0061                -3.170905e-03 3 1  ON 110
ci_0062                -2.776058e-03 3 1  ON 111
ci_0063                -8.471575e-03 3 1  ON 112
ci_0064                -9.683668e-03 3 1  ON 113
ci_0065                -5.294182e-03 3 1  ON 114
ci_0066                -5.559181e-03 3 1  ON 115
ci_0067                -4.802363e-03 3 1  ON 116
ci_0068                -6.431723e-03 3 1  ON 117
ci_0069                 4.222670e-03 3 1  ON 118
ci_0070                 3.982222e-03 3 1  ON 119
ci_0071                 4.946174e-04 3 1  ON 120
ci_0072                -1.476103e-03 3 1  ON 121
ci_0073                 4.528654e-03 3 1  ON 122
ci_0074                 4.389461e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7802e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s043 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s043 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=43  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -16.9315
    reference variance = 0.187093
====================================================
  Execution time = 2.1279e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s043
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5232e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4297e-01
  Total weights = 1.952020229e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1878e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325381465905
                                         uncertainty =       0.003356518846

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325381465905
                                         uncertainty =       0.003356518846

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403364658
  error estimate for blocks of size 2^( 2) =       0.000416184930
  error estimate for blocks of size 2^( 3) =       0.000429456658
  error estimate for blocks of size 2^( 4) =       0.000442160908
  error estimate for blocks of size 2^( 5) =       0.000453143735
  error estimate for blocks of size 2^( 6) =       0.000459211591
  error estimate for blocks of size 2^( 7) =       0.000463813931

      target function =                  N/A
              le_mean =     -16.904796833042
             les_mean =     286.115124987563
             stat err =       0.000454582541
             autocorr =       1.270076312861
              std dev =       0.570443770517
             le_variance =       0.325406095321


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690479683304e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+00, overlap shift 1.4552e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904796833022       residual = 2.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904809445348       residual = 2.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904809952661       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904809711387       residual = 8.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904809405827       residual = 6.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904809220389       residual = 2.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904809216370       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904809097946       residual = 4.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.904809115284       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.904809113538       residual = 6.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4552e+00 is 3.156909e-04

solving harmonic davidson linear method for identity shift 5.8208e+00, overlap shift 5.8208e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904796833022       residual = 2.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904800321625       residual = 2.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904800468668       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904800440838       residual = 9.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904800355727       residual = 6.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904800273969       residual = 2.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904800281877       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904800244236       residual = 3.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.904800242073       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.904800243313       residual = 3.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.8208e+00 is 8.565196e-05

solving harmonic davidson linear method for identity shift 2.3283e+01, overlap shift 2.3283e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904796833022       residual = 2.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904797729008       residual = 2.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904797767434       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904797763184       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904797741358       residual = 6.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904797718250       residual = 2.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904797720203       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904797710514       residual = 3.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.904797709586       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.904797709838       residual = 3.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.3283e+01 is 2.188188e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.417790 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7483e+01
  </log>
  <optVariables href="H2O.s043.opt.xml">
   uu_0                 3.131972e-01 1 1  ON 0
   uu_1                 1.455351e-01 1 1  ON 1
   uu_2                 4.358226e-02 1 1  ON 2
   uu_3                -1.947282e-02 1 1  ON 3
   uu_4                -6.621659e-02 1 1  ON 4
   uu_5                -1.025805e-01 1 1  ON 5
   uu_6                -1.317476e-01 1 1  ON 6
   uu_7                -1.471074e-01 1 1  ON 7
   uu_8                -1.405803e-01 1 1  ON 8
   uu_9                -1.123841e-01 1 1  ON 9
   ud_0                 4.507786e-01 1 1  ON 10
   ud_1                 1.850554e-01 1 1  ON 11
   ud_2                 6.454505e-02 1 1  ON 12
   ud_3                -6.642205e-03 1 1  ON 13
   ud_4                -6.394220e-02 1 1  ON 14
   ud_5                -1.064265e-01 1 1  ON 15
   ud_6                -1.351741e-01 1 1  ON 16
   ud_7                -1.529503e-01 1 1  ON 17
   ud_8                -1.552708e-01 1 1  ON 18
   ud_9                -1.453018e-01 1 1  ON 19
   eO_0                -7.493696e-01 1 1  ON 20
   eO_1                -4.286396e-01 1 1  ON 21
   eO_2                -1.765409e-02 1 1  ON 22
   eO_3                 2.965157e-01 1 1  ON 23
   eO_4                 5.240874e-01 1 1  ON 24
   eO_5                 4.885320e-01 1 1  ON 25
   eO_6                 2.625644e-01 1 1  ON 26
   eO_7                -4.220084e-02 1 1  ON 27
   eO_8                -2.330789e-01 1 1  ON 28
   eO_9                -9.768488e-02 1 1  ON 29
  eH1_0                -2.637343e-01 1 1  ON 30
  eH1_1                -1.559690e-01 1 1  ON 31
  eH1_2                -1.059745e-01 1 1  ON 32
  eH1_3                -5.045537e-02 1 1  ON 33
  eH1_4                -4.264409e-05 1 1  ON 34
  eH1_5                 3.632086e-02 1 1  ON 35
  eH1_6                 9.853504e-02 1 1  ON 36
  eH1_7                 1.591386e-01 1 1  ON 37
  eH1_8                 1.936062e-01 1 1  ON 38
  eH1_9                 8.892640e-02 1 1  ON 39
  eH2_0                -2.622461e-01 1 1  ON 40
  eH2_1                -1.544907e-01 1 1  ON 41
  eH2_2                -1.043580e-01 1 1  ON 42
  eH2_3                -4.875701e-02 1 1  ON 43
  eH2_4                 1.501305e-03 1 1  ON 44
  eH2_5                 3.812452e-02 1 1  ON 45
  eH2_6                 1.003520e-01 1 1  ON 46
  eH2_7                 1.608252e-01 1 1  ON 47
  eH2_8                 1.979793e-01 1 1  ON 48
  eH2_9                 8.244076e-02 1 1  ON 49
ci_0001                 7.013058e-01 3 1  ON 50
ci_0002                 7.007294e-01 3 1  ON 51
ci_0003                -2.742261e-02 3 1  ON 52
ci_0004                -2.843058e-02 3 1  ON 53
ci_0005                -3.644505e-02 3 1  ON 54
ci_0006                -3.652656e-02 3 1  ON 55
ci_0007                -2.123144e-02 3 1  ON 56
ci_0008                -2.073380e-02 3 1  ON 57
ci_0009                -1.713099e-02 3 1  ON 58
ci_0010                -1.723346e-02 3 1  ON 59
ci_0011                -1.206726e-02 3 1  ON 60
ci_0012                -1.094012e-02 3 1  ON 61
ci_0013                 1.297986e-02 3 1  ON 62
ci_0014                 1.346408e-02 3 1  ON 63
ci_0015                 1.294676e-02 3 1  ON 64
ci_0016                 1.290538e-02 3 1  ON 65
ci_0017                 1.124338e-02 3 1  ON 66
ci_0018                 1.191724e-02 3 1  ON 67
ci_0019                 1.156039e-02 3 1  ON 68
ci_0020                 1.116354e-02 3 1  ON 69
ci_0021                -2.177547e-03 3 1  ON 70
ci_0022                 5.164177e-04 3 1  ON 71
ci_0023                -1.129871e-02 3 1  ON 72
ci_0024                -1.108812e-02 3 1  ON 73
ci_0025                -1.049237e-02 3 1  ON 74
ci_0026                -1.325194e-02 3 1  ON 75
ci_0027                -1.154680e-02 3 1  ON 76
ci_0028                -1.147923e-02 3 1  ON 77
ci_0029                -1.067039e-02 3 1  ON 78
ci_0030                -1.157782e-02 3 1  ON 79
ci_0031                 2.024638e-02 3 1  ON 80
ci_0032                 2.084217e-02 3 1  ON 81
ci_0033                 9.705181e-03 3 1  ON 82
ci_0034                 9.676289e-03 3 1  ON 83
ci_0035                 6.432347e-03 3 1  ON 84
ci_0036                 5.866184e-03 3 1  ON 85
ci_0037                -1.056906e-02 3 1  ON 86
ci_0038                -1.240481e-02 3 1  ON 87
ci_0039                -2.455768e-03 3 1  ON 88
ci_0040                -2.554535e-03 3 1  ON 89
ci_0041                 7.350774e-03 3 1  ON 90
ci_0042                 6.916451e-03 3 1  ON 91
ci_0043                -1.827604e-02 3 1  ON 92
ci_0044                -1.904550e-02 3 1  ON 93
ci_0045                 7.466950e-03 3 1  ON 94
ci_0046                 7.557269e-03 3 1  ON 95
ci_0047                -1.958218e-03 3 1  ON 96
ci_0048                -2.332467e-03 3 1  ON 97
ci_0049                -5.980175e-03 3 1  ON 98
ci_0050                -6.534075e-03 3 1  ON 99
ci_0051                -3.532216e-03 3 1  ON 100
ci_0052                -3.292583e-03 3 1  ON 101
ci_0053                -4.889285e-03 3 1  ON 102
ci_0054                -3.846707e-03 3 1  ON 103
ci_0055                 6.916237e-03 3 1  ON 104
ci_0056                 4.234499e-03 3 1  ON 105
ci_0057                 4.736109e-03 3 1  ON 106
ci_0058                 4.398366e-03 3 1  ON 107
ci_0059                -4.717141e-03 3 1  ON 108
ci_0060                -3.974537e-03 3 1  ON 109
ci_0061                -3.177758e-03 3 1  ON 110
ci_0062                -2.811023e-03 3 1  ON 111
ci_0063                -8.463884e-03 3 1  ON 112
ci_0064                -9.661734e-03 3 1  ON 113
ci_0065                -5.288125e-03 3 1  ON 114
ci_0066                -5.544740e-03 3 1  ON 115
ci_0067                -4.779977e-03 3 1  ON 116
ci_0068                -6.376709e-03 3 1  ON 117
ci_0069                 4.244925e-03 3 1  ON 118
ci_0070                 3.998883e-03 3 1  ON 119
ci_0071                 4.612132e-04 3 1  ON 120
ci_0072                -1.414487e-03 3 1  ON 121
ci_0073                 4.507249e-03 3 1  ON 122
ci_0074                 4.374215e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -16.8379
    reference variance = 0.207058
====================================================
  Execution time = 2.1267e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s043
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3888e-01
  Total weights = 1.9516e+06
  Execution time = 1.9140e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325365704064
                                         uncertainty =       0.003351307108

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325365704064
                                         uncertainty =       0.003351307108

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403336607
  error estimate for blocks of size 2^( 2) =       0.000416484728
  error estimate for blocks of size 2^( 3) =       0.000430360823
  error estimate for blocks of size 2^( 4) =       0.000443518888
  error estimate for blocks of size 2^( 5) =       0.000455738697
  error estimate for blocks of size 2^( 6) =       0.000465503895
  error estimate for blocks of size 2^( 7) =       0.000470910454

      target function =                  N/A
              le_mean =     -16.905887933607
             les_mean =     286.148409843149
             stat err =       0.000458917984
             autocorr =       1.294597819379
              std dev =       0.570404100473
             le_variance =       0.325360837836

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325256488510
                                         uncertainty =       0.003349190761

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325256488510
                                         uncertainty =       0.003349190761

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403268867
  error estimate for blocks of size 2^( 2) =       0.000416420319
  error estimate for blocks of size 2^( 3) =       0.000430300131
  error estimate for blocks of size 2^( 4) =       0.000443458747
  error estimate for blocks of size 2^( 5) =       0.000455673572
  error estimate for blocks of size 2^( 6) =       0.000465441747
  error estimate for blocks of size 2^( 7) =       0.000470855824

      target function =                  N/A
              le_mean =     -16.905889375643
             les_mean =     286.151541837153
             stat err =       0.000458857473
             autocorr =       1.294691293807
              std dev =       0.570308300757
             le_variance =       0.325251557912

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325304824621
                                         uncertainty =       0.003350562164

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325304824621
                                         uncertainty =       0.003350562164

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403298846
  error estimate for blocks of size 2^( 2) =       0.000416448724
  error estimate for blocks of size 2^( 3) =       0.000430326896
  error estimate for blocks of size 2^( 4) =       0.000443485405
  error estimate for blocks of size 2^( 5) =       0.000455701863
  error estimate for blocks of size 2^( 6) =       0.000465468539
  error estimate for blocks of size 2^( 7) =       0.000470880469

      target function =                  N/A
              le_mean =     -16.905888485083
             les_mean =     286.147835158090
             stat err =       0.000458884069
             autocorr =       1.294648886254
              std dev =       0.570350698295
             le_variance =       0.325299919046

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325357426553
                                         uncertainty =       0.003351217616

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325357426553
                                         uncertainty =       0.003351217616

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403331474
  error estimate for blocks of size 2^( 2) =       0.000416479815
  error estimate for blocks of size 2^( 3) =       0.000430356182
  error estimate for blocks of size 2^( 4) =       0.000443514326
  error estimate for blocks of size 2^( 5) =       0.000455733722
  error estimate for blocks of size 2^( 6) =       0.000465499133
  error estimate for blocks of size 2^( 7) =       0.000470906412

      target function =                  N/A
              le_mean =     -16.905887924992
             les_mean =     286.148179911950
             stat err =       0.000458913398
             autocorr =       1.294604905102
              std dev =       0.570396840404
             le_variance =       0.325352555542


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905887933607        initial
     1.4552e+00     1.4552e+01             3.1569e-04       -16.905889375643  <--
     5.8208e+00     5.8208e+01             8.5652e-05       -16.905888485083
     2.3283e+01     2.3283e+02             2.1882e-05       -16.905887924992

*****************************************************************************
Applying the update for shift_i =   1.4552e+00     and shift_s =   1.4552e+01
*****************************************************************************

  Execution time = 3.0958e+01
  </log>
  <optVariables href="H2O.s043.opt.xml">
   uu_0                 3.132049e-01 1 1  ON 0
   uu_1                 1.455849e-01 1 1  ON 1
   uu_2                 4.355480e-02 1 1  ON 2
   uu_3                -1.950612e-02 1 1  ON 3
   uu_4                -6.624305e-02 1 1  ON 4
   uu_5                -1.025663e-01 1 1  ON 5
   uu_6                -1.317259e-01 1 1  ON 6
   uu_7                -1.471515e-01 1 1  ON 7
   uu_8                -1.406501e-01 1 1  ON 8
   uu_9                -1.123968e-01 1 1  ON 9
   ud_0                 4.508919e-01 1 1  ON 10
   ud_1                 1.850756e-01 1 1  ON 11
   ud_2                 6.456570e-02 1 1  ON 12
   ud_3                -6.649566e-03 1 1  ON 13
   ud_4                -6.397033e-02 1 1  ON 14
   ud_5                -1.064597e-01 1 1  ON 15
   ud_6                -1.351480e-01 1 1  ON 16
   ud_7                -1.529948e-01 1 1  ON 17
   ud_8                -1.552837e-01 1 1  ON 18
   ud_9                -1.453070e-01 1 1  ON 19
   eO_0                -7.493650e-01 1 1  ON 20
   eO_1                -4.286696e-01 1 1  ON 21
   eO_2                -1.761778e-02 1 1  ON 22
   eO_3                 2.965401e-01 1 1  ON 23
   eO_4                 5.241224e-01 1 1  ON 24
   eO_5                 4.885684e-01 1 1  ON 25
   eO_6                 2.625656e-01 1 1  ON 26
   eO_7                -4.219595e-02 1 1  ON 27
   eO_8                -2.331232e-01 1 1  ON 28
   eO_9                -9.774510e-02 1 1  ON 29
  eH1_0                -2.637176e-01 1 1  ON 30
  eH1_1                -1.560060e-01 1 1  ON 31
  eH1_2                -1.059635e-01 1 1  ON 32
  eH1_3                -5.048943e-02 1 1  ON 33
  eH1_4                -5.664216e-05 1 1  ON 34
  eH1_5                 3.626411e-02 1 1  ON 35
  eH1_6                 9.849852e-02 1 1  ON 36
  eH1_7                 1.591381e-01 1 1  ON 37
  eH1_8                 1.936606e-01 1 1  ON 38
  eH1_9                 8.901069e-02 1 1  ON 39
  eH2_0                -2.622673e-01 1 1  ON 40
  eH2_1                -1.545268e-01 1 1  ON 41
  eH2_2                -1.044024e-01 1 1  ON 42
  eH2_3                -4.876416e-02 1 1  ON 43
  eH2_4                 1.482591e-03 1 1  ON 44
  eH2_5                 3.815288e-02 1 1  ON 45
  eH2_6                 1.003516e-01 1 1  ON 46
  eH2_7                 1.608029e-01 1 1  ON 47
  eH2_8                 1.980168e-01 1 1  ON 48
  eH2_9                 8.252040e-02 1 1  ON 49
ci_0001                 7.013228e-01 3 1  ON 50
ci_0002                 7.007313e-01 3 1  ON 51
ci_0003                -2.740319e-02 3 1  ON 52
ci_0004                -2.828679e-02 3 1  ON 53
ci_0005                -3.650283e-02 3 1  ON 54
ci_0006                -3.658036e-02 3 1  ON 55
ci_0007                -2.129553e-02 3 1  ON 56
ci_0008                -2.072047e-02 3 1  ON 57
ci_0009                -1.714994e-02 3 1  ON 58
ci_0010                -1.718572e-02 3 1  ON 59
ci_0011                -1.208427e-02 3 1  ON 60
ci_0012                -1.107975e-02 3 1  ON 61
ci_0013                 1.304138e-02 3 1  ON 62
ci_0014                 1.341768e-02 3 1  ON 63
ci_0015                 1.296847e-02 3 1  ON 64
ci_0016                 1.281944e-02 3 1  ON 65
ci_0017                 1.114452e-02 3 1  ON 66
ci_0018                 1.187093e-02 3 1  ON 67
ci_0019                 1.154533e-02 3 1  ON 68
ci_0020                 1.109650e-02 3 1  ON 69
ci_0021                -2.083272e-03 3 1  ON 70
ci_0022                 4.069481e-04 3 1  ON 71
ci_0023                -1.131980e-02 3 1  ON 72
ci_0024                -1.101763e-02 3 1  ON 73
ci_0025                -1.043094e-02 3 1  ON 74
ci_0026                -1.303084e-02 3 1  ON 75
ci_0027                -1.155020e-02 3 1  ON 76
ci_0028                -1.137288e-02 3 1  ON 77
ci_0029                -1.068663e-02 3 1  ON 78
ci_0030                -1.151533e-02 3 1  ON 79
ci_0031                 2.024900e-02 3 1  ON 80
ci_0032                 2.084528e-02 3 1  ON 81
ci_0033                 9.603459e-03 3 1  ON 82
ci_0034                 9.633288e-03 3 1  ON 83
ci_0035                 6.470888e-03 3 1  ON 84
ci_0036                 5.907073e-03 3 1  ON 85
ci_0037                -1.055538e-02 3 1  ON 86
ci_0038                -1.217477e-02 3 1  ON 87
ci_0039                -2.495468e-03 3 1  ON 88
ci_0040                -2.494607e-03 3 1  ON 89
ci_0041                 7.311248e-03 3 1  ON 90
ci_0042                 6.959096e-03 3 1  ON 91
ci_0043                -1.828791e-02 3 1  ON 92
ci_0044                -1.913789e-02 3 1  ON 93
ci_0045                 7.420142e-03 3 1  ON 94
ci_0046                 7.567572e-03 3 1  ON 95
ci_0047                -1.929983e-03 3 1  ON 96
ci_0048                -2.221397e-03 3 1  ON 97
ci_0049                -5.847417e-03 3 1  ON 98
ci_0050                -6.420811e-03 3 1  ON 99
ci_0051                -3.510277e-03 3 1  ON 100
ci_0052                -3.292688e-03 3 1  ON 101
ci_0053                -4.915609e-03 3 1  ON 102
ci_0054                -3.936178e-03 3 1  ON 103
ci_0055                 6.744872e-03 3 1  ON 104
ci_0056                 4.340536e-03 3 1  ON 105
ci_0057                 4.682698e-03 3 1  ON 106
ci_0058                 4.516472e-03 3 1  ON 107
ci_0059                -4.745720e-03 3 1  ON 108
ci_0060                -4.098414e-03 3 1  ON 109
ci_0061                -3.196425e-03 3 1  ON 110
ci_0062                -2.903618e-03 3 1  ON 111
ci_0063                -8.445007e-03 3 1  ON 112
ci_0064                -9.608112e-03 3 1  ON 113
ci_0065                -5.272428e-03 3 1  ON 114
ci_0066                -5.507530e-03 3 1  ON 115
ci_0067                -4.725543e-03 3 1  ON 116
ci_0068                -6.242869e-03 3 1  ON 117
ci_0069                 4.297964e-03 3 1  ON 118
ci_0070                 4.040719e-03 3 1  ON 119
ci_0071                 3.746278e-04 3 1  ON 120
ci_0072                -1.253102e-03 3 1  ON 121
ci_0073                 4.454770e-03 3 1  ON 122
ci_0074                 4.336760e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8463e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s044 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s044 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=44  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -16.9708
    reference variance = 0.234483
====================================================
  Execution time = 2.1045e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s044
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5234e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3565e-01
  Total weights = 1.951551358e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.2007e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323531146200
                                         uncertainty =       0.001963749330

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323531146200
                                         uncertainty =       0.001963749330

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402202063
  error estimate for blocks of size 2^( 2) =       0.000415041401
  error estimate for blocks of size 2^( 3) =       0.000428771466
  error estimate for blocks of size 2^( 4) =       0.000441337327
  error estimate for blocks of size 2^( 5) =       0.000452599192
  error estimate for blocks of size 2^( 6) =       0.000463907518
  error estimate for blocks of size 2^( 7) =       0.000470391076

      target function =                  N/A
              le_mean =     -16.905719329388
             les_mean =     286.138997721056
             stat err =       0.000457058778
             autocorr =       1.291384356469
              std dev =       0.568799612249
             le_variance =       0.323532998894


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690571932939e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e-01, overlap shift 3.6380e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905719329409       residual = 2.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905742740086       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905742951216       residual = 7.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905744734482       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905745452941       residual = 8.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905744946855       residual = 3.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905744587841       residual = 2.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905744586805       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905744406164       residual = 5.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905744477432       residual = 2.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905744691788       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905744823663       residual = 3.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.6380e-01 is 1.299450e-03

solving harmonic davidson linear method for identity shift 1.4552e+00, overlap shift 1.4552e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905719329409       residual = 2.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905727456804       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905727516205       residual = 5.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905728113965       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905728310092       residual = 7.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905728081182       residual = 2.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905727992372       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905728025031       residual = 5.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905727987520       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905727969458       residual = 8.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4552e+00 is 4.520178e-04

solving harmonic davidson linear method for identity shift 5.8208e+00, overlap shift 5.8208e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905719329409       residual = 2.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905721579931       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905721600015       residual = 5.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905721765636       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905721813293       residual = 6.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905721746711       residual = 2.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905721719756       residual = 9.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905721729658       residual = 4.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905721724897       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905721719243       residual = 5.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.8208e+00 is 1.253295e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.427230 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7263e+01
  </log>
  <optVariables href="H2O.s044.opt.xml">
   uu_0                 3.132263e-01 1 1  ON 0
   uu_1                 1.456087e-01 1 1  ON 1
   uu_2                 4.352243e-02 1 1  ON 2
   uu_3                -1.956147e-02 1 1  ON 3
   uu_4                -6.629541e-02 1 1  ON 4
   uu_5                -1.025245e-01 1 1  ON 5
   uu_6                -1.317756e-01 1 1  ON 6
   uu_7                -1.472290e-01 1 1  ON 7
   uu_8                -1.405992e-01 1 1  ON 8
   uu_9                -1.123520e-01 1 1  ON 9
   ud_0                 4.509266e-01 1 1  ON 10
   ud_1                 1.850851e-01 1 1  ON 11
   ud_2                 6.459682e-02 1 1  ON 12
   ud_3                -6.625387e-03 1 1  ON 13
   ud_4                -6.403571e-02 1 1  ON 14
   ud_5                -1.064666e-01 1 1  ON 15
   ud_6                -1.352347e-01 1 1  ON 16
   ud_7                -1.530214e-01 1 1  ON 17
   ud_8                -1.552106e-01 1 1  ON 18
   ud_9                -1.452623e-01 1 1  ON 19
   eO_0                -7.492967e-01 1 1  ON 20
   eO_1                -4.286126e-01 1 1  ON 21
   eO_2                -1.759318e-02 1 1  ON 22
   eO_3                 2.965191e-01 1 1  ON 23
   eO_4                 5.241060e-01 1 1  ON 24
   eO_5                 4.885793e-01 1 1  ON 25
   eO_6                 2.625365e-01 1 1  ON 26
   eO_7                -4.218031e-02 1 1  ON 27
   eO_8                -2.331566e-01 1 1  ON 28
   eO_9                -9.780849e-02 1 1  ON 29
  eH1_0                -2.637802e-01 1 1  ON 30
  eH1_1                -1.560636e-01 1 1  ON 31
  eH1_2                -1.060199e-01 1 1  ON 32
  eH1_3                -5.046629e-02 1 1  ON 33
  eH1_4                -9.227529e-05 1 1  ON 34
  eH1_5                 3.623467e-02 1 1  ON 35
  eH1_6                 9.848301e-02 1 1  ON 36
  eH1_7                 1.591729e-01 1 1  ON 37
  eH1_8                 1.937197e-01 1 1  ON 38
  eH1_9                 8.913168e-02 1 1  ON 39
  eH2_0                -2.623211e-01 1 1  ON 40
  eH2_1                -1.545883e-01 1 1  ON 41
  eH2_2                -1.044123e-01 1 1  ON 42
  eH2_3                -4.877356e-02 1 1  ON 43
  eH2_4                 1.554317e-03 1 1  ON 44
  eH2_5                 3.810487e-02 1 1  ON 45
  eH2_6                 1.002998e-01 1 1  ON 46
  eH2_7                 1.607796e-01 1 1  ON 47
  eH2_8                 1.980551e-01 1 1  ON 48
  eH2_9                 8.264919e-02 1 1  ON 49
ci_0001                 7.012645e-01 3 1  ON 50
ci_0002                 7.007924e-01 3 1  ON 51
ci_0003                -2.742729e-02 3 1  ON 52
ci_0004                -2.814267e-02 3 1  ON 53
ci_0005                -3.655525e-02 3 1  ON 54
ci_0006                -3.672229e-02 3 1  ON 55
ci_0007                -2.125692e-02 3 1  ON 56
ci_0008                -2.078064e-02 3 1  ON 57
ci_0009                -1.715874e-02 3 1  ON 58
ci_0010                -1.734274e-02 3 1  ON 59
ci_0011                -1.210494e-02 3 1  ON 60
ci_0012                -1.105722e-02 3 1  ON 61
ci_0013                 1.302001e-02 3 1  ON 62
ci_0014                 1.342480e-02 3 1  ON 63
ci_0015                 1.302904e-02 3 1  ON 64
ci_0016                 1.286867e-02 3 1  ON 65
ci_0017                 1.112214e-02 3 1  ON 66
ci_0018                 1.170902e-02 3 1  ON 67
ci_0019                 1.149912e-02 3 1  ON 68
ci_0020                 1.122563e-02 3 1  ON 69
ci_0021                -2.079715e-03 3 1  ON 70
ci_0022                 1.629097e-04 3 1  ON 71
ci_0023                -1.139143e-02 3 1  ON 72
ci_0024                -1.094609e-02 3 1  ON 73
ci_0025                -1.037870e-02 3 1  ON 74
ci_0026                -1.257883e-02 3 1  ON 75
ci_0027                -1.144754e-02 3 1  ON 76
ci_0028                -1.127334e-02 3 1  ON 77
ci_0029                -1.063029e-02 3 1  ON 78
ci_0030                -1.149550e-02 3 1  ON 79
ci_0031                 2.025923e-02 3 1  ON 80
ci_0032                 2.076048e-02 3 1  ON 81
ci_0033                 9.627405e-03 3 1  ON 82
ci_0034                 9.714319e-03 3 1  ON 83
ci_0035                 6.595050e-03 3 1  ON 84
ci_0036                 6.075826e-03 3 1  ON 85
ci_0037                -1.043209e-02 3 1  ON 86
ci_0038                -1.204422e-02 3 1  ON 87
ci_0039                -2.504827e-03 3 1  ON 88
ci_0040                -2.649940e-03 3 1  ON 89
ci_0041                 7.310773e-03 3 1  ON 90
ci_0042                 7.042529e-03 3 1  ON 91
ci_0043                -1.841862e-02 3 1  ON 92
ci_0044                -1.915839e-02 3 1  ON 93
ci_0045                 7.574046e-03 3 1  ON 94
ci_0046                 7.455655e-03 3 1  ON 95
ci_0047                -1.895400e-03 3 1  ON 96
ci_0048                -2.176158e-03 3 1  ON 97
ci_0049                -5.774367e-03 3 1  ON 98
ci_0050                -6.340972e-03 3 1  ON 99
ci_0051                -3.588843e-03 3 1  ON 100
ci_0052                -3.319017e-03 3 1  ON 101
ci_0053                -4.833499e-03 3 1  ON 102
ci_0054                -4.084372e-03 3 1  ON 103
ci_0055                 6.729971e-03 3 1  ON 104
ci_0056                 4.575639e-03 3 1  ON 105
ci_0057                 4.704822e-03 3 1  ON 106
ci_0058                 4.631452e-03 3 1  ON 107
ci_0059                -4.753982e-03 3 1  ON 108
ci_0060                -4.144504e-03 3 1  ON 109
ci_0061                -3.225739e-03 3 1  ON 110
ci_0062                -2.928139e-03 3 1  ON 111
ci_0063                -8.433078e-03 3 1  ON 112
ci_0064                -9.454835e-03 3 1  ON 113
ci_0065                -5.207953e-03 3 1  ON 114
ci_0066                -5.444721e-03 3 1  ON 115
ci_0067                -4.832243e-03 3 1  ON 116
ci_0068                -5.989604e-03 3 1  ON 117
ci_0069                 4.351911e-03 3 1  ON 118
ci_0070                 4.272431e-03 3 1  ON 119
ci_0071                 3.602634e-04 3 1  ON 120
ci_0072                -9.967480e-04 3 1  ON 121
ci_0073                 4.407690e-03 3 1  ON 122
ci_0074                 4.269648e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -16.9061
    reference variance = 0.211078
====================================================
  Execution time = 2.1320e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s044
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3752e-01
  Total weights = 1.9519e+06
  Execution time = 1.9277e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323559419790
                                         uncertainty =       0.002380763556

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323559419790
                                         uncertainty =       0.002380763556

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402139292
  error estimate for blocks of size 2^( 2) =       0.000415660033
  error estimate for blocks of size 2^( 3) =       0.000429676590
  error estimate for blocks of size 2^( 4) =       0.000442273128
  error estimate for blocks of size 2^( 5) =       0.000454623811
  error estimate for blocks of size 2^( 6) =       0.000464943651
  error estimate for blocks of size 2^( 7) =       0.000471632528

      target function =                  N/A
              le_mean =     -16.905553320675
             les_mean =     286.135421847883
             stat err =       0.000458368279
             autocorr =       1.299200239483
              std dev =       0.568710841374
             le_variance =       0.323432021096

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323300575427
                                         uncertainty =       0.002413974911

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323300575427
                                         uncertainty =       0.002413974911

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401978139
  error estimate for blocks of size 2^( 2) =       0.000415501642
  error estimate for blocks of size 2^( 3) =       0.000429523096
  error estimate for blocks of size 2^( 4) =       0.000442107237
  error estimate for blocks of size 2^( 5) =       0.000454427908
  error estimate for blocks of size 2^( 6) =       0.000464752865
  error estimate for blocks of size 2^( 7) =       0.000471501972

      target function =                  N/A
              le_mean =     -16.905542260846
             les_mean =     286.143926761906
             stat err =       0.000458197495
             autocorr =       1.299273414817
              std dev =       0.568482935386
             le_variance =       0.323172847825

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323349484856
                                         uncertainty =       0.002399716368

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323349484856
                                         uncertainty =       0.002399716368

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402008652
  error estimate for blocks of size 2^( 2) =       0.000415530268
  error estimate for blocks of size 2^( 3) =       0.000429548732
  error estimate for blocks of size 2^( 4) =       0.000442138641
  error estimate for blocks of size 2^( 5) =       0.000454470177
  error estimate for blocks of size 2^( 6) =       0.000464795649
  error estimate for blocks of size 2^( 7) =       0.000471526299

      target function =                  N/A
              le_mean =     -16.905540354559
             les_mean =     286.135285067527
             stat err =       0.000458232691
             autocorr =       1.299275768787
              std dev =       0.568526087972
             le_variance =       0.323221912705

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323520357189
                                         uncertainty =       0.002382306913

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323520357189
                                         uncertainty =       0.002382306913

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402115001
  error estimate for blocks of size 2^( 2) =       0.000415636062
  error estimate for blocks of size 2^( 3) =       0.000429652759
  error estimate for blocks of size 2^( 4) =       0.000442248187
  error estimate for blocks of size 2^( 5) =       0.000454596640
  error estimate for blocks of size 2^( 6) =       0.000464917646
  error estimate for blocks of size 2^( 7) =       0.000471612770

      target function =                  N/A
              le_mean =     -16.905550661581
             les_mean =     286.135390217780
             stat err =       0.000458343811
             autocorr =       1.299218486936
              std dev =       0.568676488524
             le_variance =       0.323392948600


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905553320675        initial  <--
     3.6380e-01     3.6380e+00             1.2995e-03       -16.905542260846
     1.4552e+00     1.4552e+01             4.5202e-04       -16.905540354559
     5.8208e+00     5.8208e+01             1.2533e-04       -16.905550661581

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.0491
  </log>
  <optVariables href="H2O.s044.opt.xml">
   uu_0                 3.132049e-01 1 1  ON 0
   uu_1                 1.455849e-01 1 1  ON 1
   uu_2                 4.355480e-02 1 1  ON 2
   uu_3                -1.950612e-02 1 1  ON 3
   uu_4                -6.624305e-02 1 1  ON 4
   uu_5                -1.025663e-01 1 1  ON 5
   uu_6                -1.317259e-01 1 1  ON 6
   uu_7                -1.471515e-01 1 1  ON 7
   uu_8                -1.406501e-01 1 1  ON 8
   uu_9                -1.123968e-01 1 1  ON 9
   ud_0                 4.508919e-01 1 1  ON 10
   ud_1                 1.850756e-01 1 1  ON 11
   ud_2                 6.456570e-02 1 1  ON 12
   ud_3                -6.649566e-03 1 1  ON 13
   ud_4                -6.397033e-02 1 1  ON 14
   ud_5                -1.064597e-01 1 1  ON 15
   ud_6                -1.351480e-01 1 1  ON 16
   ud_7                -1.529948e-01 1 1  ON 17
   ud_8                -1.552837e-01 1 1  ON 18
   ud_9                -1.453070e-01 1 1  ON 19
   eO_0                -7.493650e-01 1 1  ON 20
   eO_1                -4.286696e-01 1 1  ON 21
   eO_2                -1.761778e-02 1 1  ON 22
   eO_3                 2.965401e-01 1 1  ON 23
   eO_4                 5.241224e-01 1 1  ON 24
   eO_5                 4.885684e-01 1 1  ON 25
   eO_6                 2.625656e-01 1 1  ON 26
   eO_7                -4.219595e-02 1 1  ON 27
   eO_8                -2.331232e-01 1 1  ON 28
   eO_9                -9.774510e-02 1 1  ON 29
  eH1_0                -2.637176e-01 1 1  ON 30
  eH1_1                -1.560060e-01 1 1  ON 31
  eH1_2                -1.059635e-01 1 1  ON 32
  eH1_3                -5.048943e-02 1 1  ON 33
  eH1_4                -5.664216e-05 1 1  ON 34
  eH1_5                 3.626411e-02 1 1  ON 35
  eH1_6                 9.849852e-02 1 1  ON 36
  eH1_7                 1.591381e-01 1 1  ON 37
  eH1_8                 1.936606e-01 1 1  ON 38
  eH1_9                 8.901069e-02 1 1  ON 39
  eH2_0                -2.622673e-01 1 1  ON 40
  eH2_1                -1.545268e-01 1 1  ON 41
  eH2_2                -1.044024e-01 1 1  ON 42
  eH2_3                -4.876416e-02 1 1  ON 43
  eH2_4                 1.482591e-03 1 1  ON 44
  eH2_5                 3.815288e-02 1 1  ON 45
  eH2_6                 1.003516e-01 1 1  ON 46
  eH2_7                 1.608029e-01 1 1  ON 47
  eH2_8                 1.980168e-01 1 1  ON 48
  eH2_9                 8.252040e-02 1 1  ON 49
ci_0001                 7.013228e-01 3 1  ON 50
ci_0002                 7.007313e-01 3 1  ON 51
ci_0003                -2.740319e-02 3 1  ON 52
ci_0004                -2.828679e-02 3 1  ON 53
ci_0005                -3.650283e-02 3 1  ON 54
ci_0006                -3.658036e-02 3 1  ON 55
ci_0007                -2.129553e-02 3 1  ON 56
ci_0008                -2.072047e-02 3 1  ON 57
ci_0009                -1.714994e-02 3 1  ON 58
ci_0010                -1.718572e-02 3 1  ON 59
ci_0011                -1.208427e-02 3 1  ON 60
ci_0012                -1.107975e-02 3 1  ON 61
ci_0013                 1.304138e-02 3 1  ON 62
ci_0014                 1.341768e-02 3 1  ON 63
ci_0015                 1.296847e-02 3 1  ON 64
ci_0016                 1.281944e-02 3 1  ON 65
ci_0017                 1.114452e-02 3 1  ON 66
ci_0018                 1.187093e-02 3 1  ON 67
ci_0019                 1.154533e-02 3 1  ON 68
ci_0020                 1.109650e-02 3 1  ON 69
ci_0021                -2.083272e-03 3 1  ON 70
ci_0022                 4.069481e-04 3 1  ON 71
ci_0023                -1.131980e-02 3 1  ON 72
ci_0024                -1.101763e-02 3 1  ON 73
ci_0025                -1.043094e-02 3 1  ON 74
ci_0026                -1.303084e-02 3 1  ON 75
ci_0027                -1.155020e-02 3 1  ON 76
ci_0028                -1.137288e-02 3 1  ON 77
ci_0029                -1.068663e-02 3 1  ON 78
ci_0030                -1.151533e-02 3 1  ON 79
ci_0031                 2.024900e-02 3 1  ON 80
ci_0032                 2.084528e-02 3 1  ON 81
ci_0033                 9.603459e-03 3 1  ON 82
ci_0034                 9.633288e-03 3 1  ON 83
ci_0035                 6.470888e-03 3 1  ON 84
ci_0036                 5.907073e-03 3 1  ON 85
ci_0037                -1.055538e-02 3 1  ON 86
ci_0038                -1.217477e-02 3 1  ON 87
ci_0039                -2.495468e-03 3 1  ON 88
ci_0040                -2.494607e-03 3 1  ON 89
ci_0041                 7.311248e-03 3 1  ON 90
ci_0042                 6.959096e-03 3 1  ON 91
ci_0043                -1.828791e-02 3 1  ON 92
ci_0044                -1.913789e-02 3 1  ON 93
ci_0045                 7.420142e-03 3 1  ON 94
ci_0046                 7.567572e-03 3 1  ON 95
ci_0047                -1.929983e-03 3 1  ON 96
ci_0048                -2.221397e-03 3 1  ON 97
ci_0049                -5.847417e-03 3 1  ON 98
ci_0050                -6.420811e-03 3 1  ON 99
ci_0051                -3.510277e-03 3 1  ON 100
ci_0052                -3.292688e-03 3 1  ON 101
ci_0053                -4.915609e-03 3 1  ON 102
ci_0054                -3.936178e-03 3 1  ON 103
ci_0055                 6.744872e-03 3 1  ON 104
ci_0056                 4.340536e-03 3 1  ON 105
ci_0057                 4.682698e-03 3 1  ON 106
ci_0058                 4.516472e-03 3 1  ON 107
ci_0059                -4.745720e-03 3 1  ON 108
ci_0060                -4.098414e-03 3 1  ON 109
ci_0061                -3.196425e-03 3 1  ON 110
ci_0062                -2.903618e-03 3 1  ON 111
ci_0063                -8.445007e-03 3 1  ON 112
ci_0064                -9.608112e-03 3 1  ON 113
ci_0065                -5.272428e-03 3 1  ON 114
ci_0066                -5.507530e-03 3 1  ON 115
ci_0067                -4.725543e-03 3 1  ON 116
ci_0068                -6.242869e-03 3 1  ON 117
ci_0069                 4.297964e-03 3 1  ON 118
ci_0070                 4.040719e-03 3 1  ON 119
ci_0071                 3.746278e-04 3 1  ON 120
ci_0072                -1.253102e-03 3 1  ON 121
ci_0073                 4.454770e-03 3 1  ON 122
ci_0074                 4.336760e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8336e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s045 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s045 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=45  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -16.8986
    reference variance = 0.417119
====================================================
  Execution time = 2.1057e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s045
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5268e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3245e-01
  Total weights = 1.951875798e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0797e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321288899707
                                         uncertainty =       0.001824845602

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321288899707
                                         uncertainty =       0.001824845602

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400758286
  error estimate for blocks of size 2^( 2) =       0.000413623383
  error estimate for blocks of size 2^( 3) =       0.000426930015
  error estimate for blocks of size 2^( 4) =       0.000439578854
  error estimate for blocks of size 2^( 5) =       0.000449097471
  error estimate for blocks of size 2^( 6) =       0.000456154318
  error estimate for blocks of size 2^( 7) =       0.000461180464

      target function =                  N/A
              le_mean =     -16.906329082684
             les_mean =     286.156417248012
             stat err =       0.000451502777
             autocorr =       1.269275304822
              std dev =       0.566757802872
             le_variance =       0.321214407116


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690632908268e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+00, overlap shift 3.6380e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906329082664       residual = 2.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906332885615       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906333358709       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906333421638       residual = 9.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906333461160       residual = 6.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906333394798       residual = 3.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906333534490       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906333531300       residual = 4.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906333532249       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906333527303       residual = 6.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.6380e+00 is 1.598346e-04

solving harmonic davidson linear method for identity shift 1.4552e+01, overlap shift 1.4552e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906329082664       residual = 2.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906330079303       residual = 2.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906330202559       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906330222498       residual = 9.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906330243448       residual = 8.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906330218945       residual = 3.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906330253087       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906330251672       residual = 4.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906330253722       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906330252233       residual = 5.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4552e+01 is 4.170205e-05

solving harmonic davidson linear method for identity shift 5.8208e+01, overlap shift 5.8208e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906329082664       residual = 2.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906329334868       residual = 2.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906329366037       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906329371287       residual = 9.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906329377258       residual = 8.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906329370731       residual = 3.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906329379170       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906329378745       residual = 4.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906329379391       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906329378993       residual = 5.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.8208e+01 is 1.054046e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.435943 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7153e+01
  </log>
  <optVariables href="H2O.s045.opt.xml">
   uu_0                 3.132001e-01 1 1  ON 0
   uu_1                 1.455813e-01 1 1  ON 1
   uu_2                 4.355453e-02 1 1  ON 2
   uu_3                -1.950782e-02 1 1  ON 3
   uu_4                -6.623341e-02 1 1  ON 4
   uu_5                -1.025678e-01 1 1  ON 5
   uu_6                -1.317188e-01 1 1  ON 6
   uu_7                -1.471474e-01 1 1  ON 7
   uu_8                -1.406576e-01 1 1  ON 8
   uu_9                -1.124034e-01 1 1  ON 9
   ud_0                 4.509094e-01 1 1  ON 10
   ud_1                 1.850849e-01 1 1  ON 11
   ud_2                 6.456672e-02 1 1  ON 12
   ud_3                -6.644451e-03 1 1  ON 13
   ud_4                -6.397027e-02 1 1  ON 14
   ud_5                -1.064679e-01 1 1  ON 15
   ud_6                -1.351486e-01 1 1  ON 16
   ud_7                -1.530008e-01 1 1  ON 17
   ud_8                -1.552885e-01 1 1  ON 18
   ud_9                -1.453124e-01 1 1  ON 19
   eO_0                -7.493665e-01 1 1  ON 20
   eO_1                -4.286715e-01 1 1  ON 21
   eO_2                -1.761118e-02 1 1  ON 22
   eO_3                 2.965396e-01 1 1  ON 23
   eO_4                 5.241348e-01 1 1  ON 24
   eO_5                 4.885729e-01 1 1  ON 25
   eO_6                 2.625670e-01 1 1  ON 26
   eO_7                -4.219779e-02 1 1  ON 27
   eO_8                -2.331317e-01 1 1  ON 28
   eO_9                -9.775383e-02 1 1  ON 29
  eH1_0                -2.637213e-01 1 1  ON 30
  eH1_1                -1.560044e-01 1 1  ON 31
  eH1_2                -1.059761e-01 1 1  ON 32
  eH1_3                -5.049079e-02 1 1  ON 33
  eH1_4                -6.219856e-05 1 1  ON 34
  eH1_5                 3.626671e-02 1 1  ON 35
  eH1_6                 9.850013e-02 1 1  ON 36
  eH1_7                 1.591388e-01 1 1  ON 37
  eH1_8                 1.936662e-01 1 1  ON 38
  eH1_9                 8.902077e-02 1 1  ON 39
  eH2_0                -2.622601e-01 1 1  ON 40
  eH2_1                -1.545217e-01 1 1  ON 41
  eH2_2                -1.044086e-01 1 1  ON 42
  eH2_3                -4.877142e-02 1 1  ON 43
  eH2_4                 1.473374e-03 1 1  ON 44
  eH2_5                 3.815028e-02 1 1  ON 45
  eH2_6                 1.003475e-01 1 1  ON 46
  eH2_7                 1.607988e-01 1 1  ON 47
  eH2_8                 1.980215e-01 1 1  ON 48
  eH2_9                 8.253552e-02 1 1  ON 49
ci_0001                 7.013230e-01 3 1  ON 50
ci_0002                 7.007335e-01 3 1  ON 51
ci_0003                -2.739193e-02 3 1  ON 52
ci_0004                -2.827575e-02 3 1  ON 53
ci_0005                -3.649838e-02 3 1  ON 54
ci_0006                -3.658346e-02 3 1  ON 55
ci_0007                -2.127268e-02 3 1  ON 56
ci_0008                -2.071970e-02 3 1  ON 57
ci_0009                -1.714821e-02 3 1  ON 58
ci_0010                -1.719792e-02 3 1  ON 59
ci_0011                -1.209367e-02 3 1  ON 60
ci_0012                -1.109497e-02 3 1  ON 61
ci_0013                 1.305294e-02 3 1  ON 62
ci_0014                 1.342253e-02 3 1  ON 63
ci_0015                 1.298160e-02 3 1  ON 64
ci_0016                 1.281650e-02 3 1  ON 65
ci_0017                 1.114477e-02 3 1  ON 66
ci_0018                 1.187370e-02 3 1  ON 67
ci_0019                 1.154133e-02 3 1  ON 68
ci_0020                 1.109636e-02 3 1  ON 69
ci_0021                -2.084776e-03 3 1  ON 70
ci_0022                 3.949083e-04 3 1  ON 71
ci_0023                -1.131756e-02 3 1  ON 72
ci_0024                -1.103536e-02 3 1  ON 73
ci_0025                -1.043821e-02 3 1  ON 74
ci_0026                -1.298914e-02 3 1  ON 75
ci_0027                -1.153821e-02 3 1  ON 76
ci_0028                -1.136032e-02 3 1  ON 77
ci_0029                -1.069719e-02 3 1  ON 78
ci_0030                -1.150779e-02 3 1  ON 79
ci_0031                 2.025372e-02 3 1  ON 80
ci_0032                 2.084574e-02 3 1  ON 81
ci_0033                 9.607035e-03 3 1  ON 82
ci_0034                 9.634329e-03 3 1  ON 83
ci_0035                 6.481926e-03 3 1  ON 84
ci_0036                 5.922473e-03 3 1  ON 85
ci_0037                -1.055367e-02 3 1  ON 86
ci_0038                -1.214800e-02 3 1  ON 87
ci_0039                -2.500119e-03 3 1  ON 88
ci_0040                -2.488368e-03 3 1  ON 89
ci_0041                 7.306241e-03 3 1  ON 90
ci_0042                 6.960003e-03 3 1  ON 91
ci_0043                -1.827730e-02 3 1  ON 92
ci_0044                -1.912210e-02 3 1  ON 93
ci_0045                 7.418185e-03 3 1  ON 94
ci_0046                 7.568822e-03 3 1  ON 95
ci_0047                -1.923869e-03 3 1  ON 96
ci_0048                -2.202562e-03 3 1  ON 97
ci_0049                -5.840647e-03 3 1  ON 98
ci_0050                -6.414443e-03 3 1  ON 99
ci_0051                -3.499155e-03 3 1  ON 100
ci_0052                -3.297141e-03 3 1  ON 101
ci_0053                -4.906526e-03 3 1  ON 102
ci_0054                -3.956256e-03 3 1  ON 103
ci_0055                 6.743358e-03 3 1  ON 104
ci_0056                 4.354857e-03 3 1  ON 105
ci_0057                 4.675692e-03 3 1  ON 106
ci_0058                 4.528709e-03 3 1  ON 107
ci_0059                -4.743938e-03 3 1  ON 108
ci_0060                -4.121969e-03 3 1  ON 109
ci_0061                -3.214350e-03 3 1  ON 110
ci_0062                -2.911711e-03 3 1  ON 111
ci_0063                -8.443987e-03 3 1  ON 112
ci_0064                -9.582461e-03 3 1  ON 113
ci_0065                -5.280657e-03 3 1  ON 114
ci_0066                -5.509909e-03 3 1  ON 115
ci_0067                -4.753806e-03 3 1  ON 116
ci_0068                -6.205082e-03 3 1  ON 117
ci_0069                 4.290551e-03 3 1  ON 118
ci_0070                 4.059255e-03 3 1  ON 119
ci_0071                 3.770382e-04 3 1  ON 120
ci_0072                -1.227417e-03 3 1  ON 121
ci_0073                 4.457895e-03 3 1  ON 122
ci_0074                 4.322110e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -16.8574
    reference variance = 0.160717
====================================================
  Execution time = 2.1608e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s045
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4046e-01
  Total weights = 1.9513e+06
  Execution time = 1.9148e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327879018150
                                         uncertainty =       0.004409562171

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327879018150
                                         uncertainty =       0.004409562171

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404906802
  error estimate for blocks of size 2^( 2) =       0.000417658572
  error estimate for blocks of size 2^( 3) =       0.000431109112
  error estimate for blocks of size 2^( 4) =       0.000443350334
  error estimate for blocks of size 2^( 5) =       0.000454161773
  error estimate for blocks of size 2^( 6) =       0.000463106532
  error estimate for blocks of size 2^( 7) =       0.000465313124

      target function =                  N/A
              le_mean =     -16.905002732670
             les_mean =     286.119577278390
             stat err =       0.000456482940
             autocorr =       1.270980709425
              std dev =       0.572624690647
             le_variance =       0.327899036339

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327854669892
                                         uncertainty =       0.004408246511

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327854669892
                                         uncertainty =       0.004408246511

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404891640
  error estimate for blocks of size 2^( 2) =       0.000417642571
  error estimate for blocks of size 2^( 3) =       0.000431092241
  error estimate for blocks of size 2^( 4) =       0.000443331704
  error estimate for blocks of size 2^( 5) =       0.000454141837
  error estimate for blocks of size 2^( 6) =       0.000463093388
  error estimate for blocks of size 2^( 7) =       0.000465301455

      target function =                  N/A
              le_mean =     -16.905001483754
             les_mean =     286.119571075047
             stat err =       0.000456467096
             autocorr =       1.270987660921
              std dev =       0.572603249154
             le_variance =       0.327874480942

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327865790326
                                         uncertainty =       0.004408887552

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327865790326
                                         uncertainty =       0.004408887552

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404898568
  error estimate for blocks of size 2^( 2) =       0.000417649866
  error estimate for blocks of size 2^( 3) =       0.000431099912
  error estimate for blocks of size 2^( 4) =       0.000443340198
  error estimate for blocks of size 2^( 5) =       0.000454150933
  error estimate for blocks of size 2^( 6) =       0.000463099288
  error estimate for blocks of size 2^( 7) =       0.000465306622

      target function =                  N/A
              le_mean =     -16.905001967083
             les_mean =     286.119559021961
             stat err =       0.000456474260
             autocorr =       1.270984067049
              std dev =       0.572613045616
             le_variance =       0.327885700010

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327877244927
                                         uncertainty =       0.004409476617

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327877244927
                                         uncertainty =       0.004409476617

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404905699
  error estimate for blocks of size 2^( 2) =       0.000417657408
  error estimate for blocks of size 2^( 3) =       0.000431107885
  error estimate for blocks of size 2^( 4) =       0.000443348988
  error estimate for blocks of size 2^( 5) =       0.000454160338
  error estimate for blocks of size 2^( 6) =       0.000463105551
  error estimate for blocks of size 2^( 7) =       0.000465312233

      target function =                  N/A
              le_mean =     -16.905002621687
             les_mean =     286.119572683353
             stat err =       0.000456481778
             autocorr =       1.270981160763
              std dev =       0.572623130373
             le_variance =       0.327897249439


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905002732670        initial  <--
     3.6380e+00     3.6380e+01             1.5983e-04       -16.905001483754
     1.4552e+01     1.4552e+02             4.1702e-05       -16.905001967083
     5.8208e+01     5.8208e+02             1.0540e-05       -16.905002621687

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.2745
  </log>
  <optVariables href="H2O.s045.opt.xml">
   uu_0                 3.132049e-01 1 1  ON 0
   uu_1                 1.455849e-01 1 1  ON 1
   uu_2                 4.355480e-02 1 1  ON 2
   uu_3                -1.950612e-02 1 1  ON 3
   uu_4                -6.624305e-02 1 1  ON 4
   uu_5                -1.025663e-01 1 1  ON 5
   uu_6                -1.317259e-01 1 1  ON 6
   uu_7                -1.471515e-01 1 1  ON 7
   uu_8                -1.406501e-01 1 1  ON 8
   uu_9                -1.123968e-01 1 1  ON 9
   ud_0                 4.508919e-01 1 1  ON 10
   ud_1                 1.850756e-01 1 1  ON 11
   ud_2                 6.456570e-02 1 1  ON 12
   ud_3                -6.649566e-03 1 1  ON 13
   ud_4                -6.397033e-02 1 1  ON 14
   ud_5                -1.064597e-01 1 1  ON 15
   ud_6                -1.351480e-01 1 1  ON 16
   ud_7                -1.529948e-01 1 1  ON 17
   ud_8                -1.552837e-01 1 1  ON 18
   ud_9                -1.453070e-01 1 1  ON 19
   eO_0                -7.493650e-01 1 1  ON 20
   eO_1                -4.286696e-01 1 1  ON 21
   eO_2                -1.761778e-02 1 1  ON 22
   eO_3                 2.965401e-01 1 1  ON 23
   eO_4                 5.241224e-01 1 1  ON 24
   eO_5                 4.885684e-01 1 1  ON 25
   eO_6                 2.625656e-01 1 1  ON 26
   eO_7                -4.219595e-02 1 1  ON 27
   eO_8                -2.331232e-01 1 1  ON 28
   eO_9                -9.774510e-02 1 1  ON 29
  eH1_0                -2.637176e-01 1 1  ON 30
  eH1_1                -1.560060e-01 1 1  ON 31
  eH1_2                -1.059635e-01 1 1  ON 32
  eH1_3                -5.048943e-02 1 1  ON 33
  eH1_4                -5.664216e-05 1 1  ON 34
  eH1_5                 3.626411e-02 1 1  ON 35
  eH1_6                 9.849852e-02 1 1  ON 36
  eH1_7                 1.591381e-01 1 1  ON 37
  eH1_8                 1.936606e-01 1 1  ON 38
  eH1_9                 8.901069e-02 1 1  ON 39
  eH2_0                -2.622673e-01 1 1  ON 40
  eH2_1                -1.545268e-01 1 1  ON 41
  eH2_2                -1.044024e-01 1 1  ON 42
  eH2_3                -4.876416e-02 1 1  ON 43
  eH2_4                 1.482591e-03 1 1  ON 44
  eH2_5                 3.815288e-02 1 1  ON 45
  eH2_6                 1.003516e-01 1 1  ON 46
  eH2_7                 1.608029e-01 1 1  ON 47
  eH2_8                 1.980168e-01 1 1  ON 48
  eH2_9                 8.252040e-02 1 1  ON 49
ci_0001                 7.013228e-01 3 1  ON 50
ci_0002                 7.007313e-01 3 1  ON 51
ci_0003                -2.740319e-02 3 1  ON 52
ci_0004                -2.828679e-02 3 1  ON 53
ci_0005                -3.650283e-02 3 1  ON 54
ci_0006                -3.658036e-02 3 1  ON 55
ci_0007                -2.129553e-02 3 1  ON 56
ci_0008                -2.072047e-02 3 1  ON 57
ci_0009                -1.714994e-02 3 1  ON 58
ci_0010                -1.718572e-02 3 1  ON 59
ci_0011                -1.208427e-02 3 1  ON 60
ci_0012                -1.107975e-02 3 1  ON 61
ci_0013                 1.304138e-02 3 1  ON 62
ci_0014                 1.341768e-02 3 1  ON 63
ci_0015                 1.296847e-02 3 1  ON 64
ci_0016                 1.281944e-02 3 1  ON 65
ci_0017                 1.114452e-02 3 1  ON 66
ci_0018                 1.187093e-02 3 1  ON 67
ci_0019                 1.154533e-02 3 1  ON 68
ci_0020                 1.109650e-02 3 1  ON 69
ci_0021                -2.083272e-03 3 1  ON 70
ci_0022                 4.069481e-04 3 1  ON 71
ci_0023                -1.131980e-02 3 1  ON 72
ci_0024                -1.101763e-02 3 1  ON 73
ci_0025                -1.043094e-02 3 1  ON 74
ci_0026                -1.303084e-02 3 1  ON 75
ci_0027                -1.155020e-02 3 1  ON 76
ci_0028                -1.137288e-02 3 1  ON 77
ci_0029                -1.068663e-02 3 1  ON 78
ci_0030                -1.151533e-02 3 1  ON 79
ci_0031                 2.024900e-02 3 1  ON 80
ci_0032                 2.084528e-02 3 1  ON 81
ci_0033                 9.603459e-03 3 1  ON 82
ci_0034                 9.633288e-03 3 1  ON 83
ci_0035                 6.470888e-03 3 1  ON 84
ci_0036                 5.907073e-03 3 1  ON 85
ci_0037                -1.055538e-02 3 1  ON 86
ci_0038                -1.217477e-02 3 1  ON 87
ci_0039                -2.495468e-03 3 1  ON 88
ci_0040                -2.494607e-03 3 1  ON 89
ci_0041                 7.311248e-03 3 1  ON 90
ci_0042                 6.959096e-03 3 1  ON 91
ci_0043                -1.828791e-02 3 1  ON 92
ci_0044                -1.913789e-02 3 1  ON 93
ci_0045                 7.420142e-03 3 1  ON 94
ci_0046                 7.567572e-03 3 1  ON 95
ci_0047                -1.929983e-03 3 1  ON 96
ci_0048                -2.221397e-03 3 1  ON 97
ci_0049                -5.847417e-03 3 1  ON 98
ci_0050                -6.420811e-03 3 1  ON 99
ci_0051                -3.510277e-03 3 1  ON 100
ci_0052                -3.292688e-03 3 1  ON 101
ci_0053                -4.915609e-03 3 1  ON 102
ci_0054                -3.936178e-03 3 1  ON 103
ci_0055                 6.744872e-03 3 1  ON 104
ci_0056                 4.340536e-03 3 1  ON 105
ci_0057                 4.682698e-03 3 1  ON 106
ci_0058                 4.516472e-03 3 1  ON 107
ci_0059                -4.745720e-03 3 1  ON 108
ci_0060                -4.098414e-03 3 1  ON 109
ci_0061                -3.196425e-03 3 1  ON 110
ci_0062                -2.903618e-03 3 1  ON 111
ci_0063                -8.445007e-03 3 1  ON 112
ci_0064                -9.608112e-03 3 1  ON 113
ci_0065                -5.272428e-03 3 1  ON 114
ci_0066                -5.507530e-03 3 1  ON 115
ci_0067                -4.725543e-03 3 1  ON 116
ci_0068                -6.242869e-03 3 1  ON 117
ci_0069                 4.297964e-03 3 1  ON 118
ci_0070                 4.040719e-03 3 1  ON 119
ci_0071                 3.746278e-04 3 1  ON 120
ci_0072                -1.253102e-03 3 1  ON 121
ci_0073                 4.454770e-03 3 1  ON 122
ci_0074                 4.336760e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8450e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s046 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s046 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=46  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -16.9187
    reference variance = 0.229117
====================================================
  Execution time = 2.3131e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s046
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5266e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3886e-01
  Total weights = 1.951771104e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1188e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325211972127
                                         uncertainty =       0.002368291502

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325211972127
                                         uncertainty =       0.002368291502

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403198569
  error estimate for blocks of size 2^( 2) =       0.000415888212
  error estimate for blocks of size 2^( 3) =       0.000428558062
  error estimate for blocks of size 2^( 4) =       0.000440452884
  error estimate for blocks of size 2^( 5) =       0.000450100274
  error estimate for blocks of size 2^( 6) =       0.000458273421
  error estimate for blocks of size 2^( 7) =       0.000464388878

      target function =                  N/A
              le_mean =     -16.906910195823
             les_mean =     286.182476282047
             stat err =       0.000453303864
             autocorr =       1.263981967087
              std dev =       0.570208884735
             le_variance =       0.325138172231


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690691019582e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+01, overlap shift 3.6380e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906910195812       residual = 2.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906910548167       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906910541039       residual = 3.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906910530610       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906910553684       residual = 4.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906910550775       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906910553696       residual = 5.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906910555578       residual = 2.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906910558791       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906910560833       residual = 3.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.6380e+01 is 1.572757e-05

solving harmonic davidson linear method for identity shift 1.4552e+02, overlap shift 1.4552e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906910195812       residual = 2.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906910284302       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906910282531       residual = 3.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906910279930       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906910285710       residual = 4.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906910285001       residual = 2.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906910285713       residual = 5.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906910286165       residual = 2.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906910286963       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906910287491       residual = 3.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4552e+02 is 3.944062e-06

solving harmonic davidson linear method for identity shift 5.8208e+02, overlap shift 5.8208e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906910195812       residual = 2.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906910217959       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906910217517       residual = 3.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906910216867       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906910218313       residual = 4.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906910218137       residual = 2.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906910218315       residual = 5.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906910218427       residual = 2.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906910218623       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906910218760       residual = 3.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.8208e+02 is 9.867791e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.444763 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9266e+01
  </log>
  <optVariables href="H2O.s046.opt.xml">
   uu_0                 3.132044e-01 1 1  ON 0
   uu_1                 1.455850e-01 1 1  ON 1
   uu_2                 4.355531e-02 1 1  ON 2
   uu_3                -1.950643e-02 1 1  ON 3
   uu_4                -6.624229e-02 1 1  ON 4
   uu_5                -1.025669e-01 1 1  ON 5
   uu_6                -1.317256e-01 1 1  ON 6
   uu_7                -1.471508e-01 1 1  ON 7
   uu_8                -1.406503e-01 1 1  ON 8
   uu_9                -1.123979e-01 1 1  ON 9
   ud_0                 4.508926e-01 1 1  ON 10
   ud_1                 1.850764e-01 1 1  ON 11
   ud_2                 6.456671e-02 1 1  ON 12
   ud_3                -6.649372e-03 1 1  ON 13
   ud_4                -6.396969e-02 1 1  ON 14
   ud_5                -1.064592e-01 1 1  ON 15
   ud_6                -1.351477e-01 1 1  ON 16
   ud_7                -1.529953e-01 1 1  ON 17
   ud_8                -1.552850e-01 1 1  ON 18
   ud_9                -1.453082e-01 1 1  ON 19
   eO_0                -7.493655e-01 1 1  ON 20
   eO_1                -4.286687e-01 1 1  ON 21
   eO_2                -1.761652e-02 1 1  ON 22
   eO_3                 2.965398e-01 1 1  ON 23
   eO_4                 5.241228e-01 1 1  ON 24
   eO_5                 4.885686e-01 1 1  ON 25
   eO_6                 2.625660e-01 1 1  ON 26
   eO_7                -4.219603e-02 1 1  ON 27
   eO_8                -2.331241e-01 1 1  ON 28
   eO_9                -9.774619e-02 1 1  ON 29
  eH1_0                -2.637176e-01 1 1  ON 30
  eH1_1                -1.560064e-01 1 1  ON 31
  eH1_2                -1.059638e-01 1 1  ON 32
  eH1_3                -5.048976e-02 1 1  ON 33
  eH1_4                -5.669411e-05 1 1  ON 34
  eH1_5                 3.626424e-02 1 1  ON 35
  eH1_6                 9.849836e-02 1 1  ON 36
  eH1_7                 1.591375e-01 1 1  ON 37
  eH1_8                 1.936611e-01 1 1  ON 38
  eH1_9                 8.901184e-02 1 1  ON 39
  eH2_0                -2.622682e-01 1 1  ON 40
  eH2_1                -1.545268e-01 1 1  ON 41
  eH2_2                -1.044023e-01 1 1  ON 42
  eH2_3                -4.876397e-02 1 1  ON 43
  eH2_4                 1.482879e-03 1 1  ON 44
  eH2_5                 3.815266e-02 1 1  ON 45
  eH2_6                 1.003510e-01 1 1  ON 46
  eH2_7                 1.608029e-01 1 1  ON 47
  eH2_8                 1.980168e-01 1 1  ON 48
  eH2_9                 8.252145e-02 1 1  ON 49
ci_0001                 7.013226e-01 3 1  ON 50
ci_0002                 7.007315e-01 3 1  ON 51
ci_0003                -2.740385e-02 3 1  ON 52
ci_0004                -2.828640e-02 3 1  ON 53
ci_0005                -3.650196e-02 3 1  ON 54
ci_0006                -3.658137e-02 3 1  ON 55
ci_0007                -2.129547e-02 3 1  ON 56
ci_0008                -2.072006e-02 3 1  ON 57
ci_0009                -1.715019e-02 3 1  ON 58
ci_0010                -1.718704e-02 3 1  ON 59
ci_0011                -1.208576e-02 3 1  ON 60
ci_0012                -1.108055e-02 3 1  ON 61
ci_0013                 1.304216e-02 3 1  ON 62
ci_0014                 1.341773e-02 3 1  ON 63
ci_0015                 1.296891e-02 3 1  ON 64
ci_0016                 1.282094e-02 3 1  ON 65
ci_0017                 1.114476e-02 3 1  ON 66
ci_0018                 1.186861e-02 3 1  ON 67
ci_0019                 1.154459e-02 3 1  ON 68
ci_0020                 1.109774e-02 3 1  ON 69
ci_0021                -2.083269e-03 3 1  ON 70
ci_0022                 4.047362e-04 3 1  ON 71
ci_0023                -1.131861e-02 3 1  ON 72
ci_0024                -1.101810e-02 3 1  ON 73
ci_0025                -1.043124e-02 3 1  ON 74
ci_0026                -1.302691e-02 3 1  ON 75
ci_0027                -1.154978e-02 3 1  ON 76
ci_0028                -1.137349e-02 3 1  ON 77
ci_0029                -1.068724e-02 3 1  ON 78
ci_0030                -1.151411e-02 3 1  ON 79
ci_0031                 2.025016e-02 3 1  ON 80
ci_0032                 2.084557e-02 3 1  ON 81
ci_0033                 9.604997e-03 3 1  ON 82
ci_0034                 9.633367e-03 3 1  ON 83
ci_0035                 6.472274e-03 3 1  ON 84
ci_0036                 5.908124e-03 3 1  ON 85
ci_0037                -1.055514e-02 3 1  ON 86
ci_0038                -1.217203e-02 3 1  ON 87
ci_0039                -2.496876e-03 3 1  ON 88
ci_0040                -2.494076e-03 3 1  ON 89
ci_0041                 7.312787e-03 3 1  ON 90
ci_0042                 6.959764e-03 3 1  ON 91
ci_0043                -1.828713e-02 3 1  ON 92
ci_0044                -1.913730e-02 3 1  ON 93
ci_0045                 7.420431e-03 3 1  ON 94
ci_0046                 7.567706e-03 3 1  ON 95
ci_0047                -1.928308e-03 3 1  ON 96
ci_0048                -2.220029e-03 3 1  ON 97
ci_0049                -5.847591e-03 3 1  ON 98
ci_0050                -6.420160e-03 3 1  ON 99
ci_0051                -3.510805e-03 3 1  ON 100
ci_0052                -3.292675e-03 3 1  ON 101
ci_0053                -4.915065e-03 3 1  ON 102
ci_0054                -3.936759e-03 3 1  ON 103
ci_0055                 6.744923e-03 3 1  ON 104
ci_0056                 4.344480e-03 3 1  ON 105
ci_0057                 4.682221e-03 3 1  ON 106
ci_0058                 4.518912e-03 3 1  ON 107
ci_0059                -4.745631e-03 3 1  ON 108
ci_0060                -4.099935e-03 3 1  ON 109
ci_0061                -3.195407e-03 3 1  ON 110
ci_0062                -2.904562e-03 3 1  ON 111
ci_0063                -8.445736e-03 3 1  ON 112
ci_0064                -9.604923e-03 3 1  ON 113
ci_0065                -5.271670e-03 3 1  ON 114
ci_0066                -5.506458e-03 3 1  ON 115
ci_0067                -4.724199e-03 3 1  ON 116
ci_0068                -6.239426e-03 3 1  ON 117
ci_0069                 4.296397e-03 3 1  ON 118
ci_0070                 4.041359e-03 3 1  ON 119
ci_0071                 3.747621e-04 3 1  ON 120
ci_0072                -1.251228e-03 3 1  ON 121
ci_0073                 4.452551e-03 3 1  ON 122
ci_0074                 4.336258e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -16.9004
    reference variance = 0.264696
====================================================
  Execution time = 2.1321e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s046
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4633e-01
  Total weights = 1.9519e+06
  Execution time = 1.9191e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326651217106
                                         uncertainty =       0.003937132279

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326651217106
                                         uncertainty =       0.003937132279

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404153904
  error estimate for blocks of size 2^( 2) =       0.000416916364
  error estimate for blocks of size 2^( 3) =       0.000430370370
  error estimate for blocks of size 2^( 4) =       0.000442737448
  error estimate for blocks of size 2^( 5) =       0.000452667833
  error estimate for blocks of size 2^( 6) =       0.000461612172
  error estimate for blocks of size 2^( 7) =       0.000466054133

      target function =                  N/A
              le_mean =     -16.905740302056
             les_mean =     286.150380167017
             stat err =       0.000455767896
             autocorr =       1.271727040876
              std dev =       0.571559931896
             le_variance =       0.326680755749

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326651921374
                                         uncertainty =       0.003945815707

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326651921374
                                         uncertainty =       0.003945815707

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404154304
  error estimate for blocks of size 2^( 2) =       0.000416916582
  error estimate for blocks of size 2^( 3) =       0.000430370630
  error estimate for blocks of size 2^( 4) =       0.000442737774
  error estimate for blocks of size 2^( 5) =       0.000452668038
  error estimate for blocks of size 2^( 6) =       0.000461611820
  error estimate for blocks of size 2^( 7) =       0.000466054282

      target function =                  N/A
              le_mean =     -16.905740475273
             les_mean =     286.150407798757
             stat err =       0.000455767978
             autocorr =       1.271724977084
              std dev =       0.571560498588
             le_variance =       0.326681403546

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326651512915
                                         uncertainty =       0.003941468892

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326651512915
                                         uncertainty =       0.003941468892

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404154069
  error estimate for blocks of size 2^( 2) =       0.000416916439
  error estimate for blocks of size 2^( 3) =       0.000430370467
  error estimate for blocks of size 2^( 4) =       0.000442737579
  error estimate for blocks of size 2^( 5) =       0.000452667905
  error estimate for blocks of size 2^( 6) =       0.000461611965
  error estimate for blocks of size 2^( 7) =       0.000466054179

      target function =                  N/A
              le_mean =     -16.905740387690
             les_mean =     286.150393101799
             stat err =       0.000455767907
             autocorr =       1.271726059230
              std dev =       0.571560165868
             le_variance =       0.326681023208

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326651250699
                                         uncertainty =       0.003937673575

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326651250699
                                         uncertainty =       0.003937673575

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404153922
  error estimate for blocks of size 2^( 2) =       0.000416916372
  error estimate for blocks of size 2^( 3) =       0.000430370380
  error estimate for blocks of size 2^( 4) =       0.000442737462
  error estimate for blocks of size 2^( 5) =       0.000452667840
  error estimate for blocks of size 2^( 6) =       0.000461612144
  error estimate for blocks of size 2^( 7) =       0.000466054137

      target function =                  N/A
              le_mean =     -16.905740312624
             les_mean =     286.150381686098
             stat err =       0.000455767896
             autocorr =       1.271726921023
              std dev =       0.571559958181
             le_variance =       0.326680785795


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905740302056        initial
     3.6380e+01     3.6380e+02             1.5728e-05       -16.905740475273  <--
     1.4552e+02     1.4552e+03             3.9441e-06       -16.905740387690
     5.8208e+02     5.8208e+03             9.8678e-07       -16.905740312624

*****************************************************************************
Applying the update for shift_i =   3.6380e+01     and shift_s =   3.6380e+02
*****************************************************************************

  Execution time = 3.1022e+01
  </log>
  <optVariables href="H2O.s046.opt.xml">
   uu_0                 3.132030e-01 1 1  ON 0
   uu_1                 1.455855e-01 1 1  ON 1
   uu_2                 4.355680e-02 1 1  ON 2
   uu_3                -1.950734e-02 1 1  ON 3
   uu_4                -6.624002e-02 1 1  ON 4
   uu_5                -1.025686e-01 1 1  ON 5
   uu_6                -1.317248e-01 1 1  ON 6
   uu_7                -1.471488e-01 1 1  ON 7
   uu_8                -1.406510e-01 1 1  ON 8
   uu_9                -1.124013e-01 1 1  ON 9
   ud_0                 4.508946e-01 1 1  ON 10
   ud_1                 1.850786e-01 1 1  ON 11
   ud_2                 6.456972e-02 1 1  ON 12
   ud_3                -6.648773e-03 1 1  ON 13
   ud_4                -6.396776e-02 1 1  ON 14
   ud_5                -1.064577e-01 1 1  ON 15
   ud_6                -1.351467e-01 1 1  ON 16
   ud_7                -1.529969e-01 1 1  ON 17
   ud_8                -1.552888e-01 1 1  ON 18
   ud_9                -1.453119e-01 1 1  ON 19
   eO_0                -7.493668e-01 1 1  ON 20
   eO_1                -4.286661e-01 1 1  ON 21
   eO_2                -1.761277e-02 1 1  ON 22
   eO_3                 2.965389e-01 1 1  ON 23
   eO_4                 5.241241e-01 1 1  ON 24
   eO_5                 4.885690e-01 1 1  ON 25
   eO_6                 2.625671e-01 1 1  ON 26
   eO_7                -4.219625e-02 1 1  ON 27
   eO_8                -2.331267e-01 1 1  ON 28
   eO_9                -9.774946e-02 1 1  ON 29
  eH1_0                -2.637174e-01 1 1  ON 30
  eH1_1                -1.560075e-01 1 1  ON 31
  eH1_2                -1.059645e-01 1 1  ON 32
  eH1_3                -5.049076e-02 1 1  ON 33
  eH1_4                -5.685068e-05 1 1  ON 34
  eH1_5                 3.626464e-02 1 1  ON 35
  eH1_6                 9.849787e-02 1 1  ON 36
  eH1_7                 1.591356e-01 1 1  ON 37
  eH1_8                 1.936625e-01 1 1  ON 38
  eH1_9                 8.901527e-02 1 1  ON 39
  eH2_0                -2.622710e-01 1 1  ON 40
  eH2_1                -1.545269e-01 1 1  ON 41
  eH2_2                -1.044022e-01 1 1  ON 42
  eH2_3                -4.876340e-02 1 1  ON 43
  eH2_4                 1.483740e-03 1 1  ON 44
  eH2_5                 3.815200e-02 1 1  ON 45
  eH2_6                 1.003494e-01 1 1  ON 46
  eH2_7                 1.608029e-01 1 1  ON 47
  eH2_8                 1.980170e-01 1 1  ON 48
  eH2_9                 8.252462e-02 1 1  ON 49
ci_0001                 7.013220e-01 3 1  ON 50
ci_0002                 7.007323e-01 3 1  ON 51
ci_0003                -2.740579e-02 3 1  ON 52
ci_0004                -2.828522e-02 3 1  ON 53
ci_0005                -3.649936e-02 3 1  ON 54
ci_0006                -3.658439e-02 3 1  ON 55
ci_0007                -2.129528e-02 3 1  ON 56
ci_0008                -2.071881e-02 3 1  ON 57
ci_0009                -1.715093e-02 3 1  ON 58
ci_0010                -1.719097e-02 3 1  ON 59
ci_0011                -1.209021e-02 3 1  ON 60
ci_0012                -1.108294e-02 3 1  ON 61
ci_0013                 1.304446e-02 3 1  ON 62
ci_0014                 1.341788e-02 3 1  ON 63
ci_0015                 1.297021e-02 3 1  ON 64
ci_0016                 1.282538e-02 3 1  ON 65
ci_0017                 1.114548e-02 3 1  ON 66
ci_0018                 1.186171e-02 3 1  ON 67
ci_0019                 1.154239e-02 3 1  ON 68
ci_0020                 1.110143e-02 3 1  ON 69
ci_0021                -2.083256e-03 3 1  ON 70
ci_0022                 3.981192e-04 3 1  ON 71
ci_0023                -1.131510e-02 3 1  ON 72
ci_0024                -1.101951e-02 3 1  ON 73
ci_0025                -1.043215e-02 3 1  ON 74
ci_0026                -1.301519e-02 3 1  ON 75
ci_0027                -1.154854e-02 3 1  ON 76
ci_0028                -1.137532e-02 3 1  ON 77
ci_0029                -1.068905e-02 3 1  ON 78
ci_0030                -1.151047e-02 3 1  ON 79
ci_0031                 2.025365e-02 3 1  ON 80
ci_0032                 2.084644e-02 3 1  ON 81
ci_0033                 9.609601e-03 3 1  ON 82
ci_0034                 9.633602e-03 3 1  ON 83
ci_0035                 6.476411e-03 3 1  ON 84
ci_0036                 5.911257e-03 3 1  ON 85
ci_0037                -1.055443e-02 3 1  ON 86
ci_0038                -1.216384e-02 3 1  ON 87
ci_0039                -2.501058e-03 3 1  ON 88
ci_0040                -2.492499e-03 3 1  ON 89
ci_0041                 7.317375e-03 3 1  ON 90
ci_0042                 6.961757e-03 3 1  ON 91
ci_0043                -1.828480e-02 3 1  ON 92
ci_0044                -1.913550e-02 3 1  ON 93
ci_0045                 7.421294e-03 3 1  ON 94
ci_0046                 7.568106e-03 3 1  ON 95
ci_0047                -1.923331e-03 3 1  ON 96
ci_0048                -2.215964e-03 3 1  ON 97
ci_0049                -5.848107e-03 3 1  ON 98
ci_0050                -6.418217e-03 3 1  ON 99
ci_0051                -3.512373e-03 3 1  ON 100
ci_0052                -3.292635e-03 3 1  ON 101
ci_0053                -4.913450e-03 3 1  ON 102
ci_0054                -3.938489e-03 3 1  ON 103
ci_0055                 6.745076e-03 3 1  ON 104
ci_0056                 4.356263e-03 3 1  ON 105
ci_0057                 4.680796e-03 3 1  ON 106
ci_0058                 4.526195e-03 3 1  ON 107
ci_0059                -4.745369e-03 3 1  ON 108
ci_0060                -4.104457e-03 3 1  ON 109
ci_0061                -3.192369e-03 3 1  ON 110
ci_0062                -2.907377e-03 3 1  ON 111
ci_0063                -8.447904e-03 3 1  ON 112
ci_0064                -9.595433e-03 3 1  ON 113
ci_0065                -5.269410e-03 3 1  ON 114
ci_0066                -5.503263e-03 3 1  ON 115
ci_0067                -4.720205e-03 3 1  ON 116
ci_0068                -6.229192e-03 3 1  ON 117
ci_0069                 4.291741e-03 3 1  ON 118
ci_0070                 4.043263e-03 3 1  ON 119
ci_0071                 3.751585e-04 3 1  ON 120
ci_0072                -1.245644e-03 3 1  ON 121
ci_0073                 4.445952e-03 3 1  ON 122
ci_0074                 4.334766e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.0312e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s047 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s047 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=47  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -16.9342
    reference variance = 0.175544
====================================================
  Execution time = 2.1031e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s047
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5272e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3798e-01
  Total weights = 1.951989802e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0594e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324208218365
                                         uncertainty =       0.002245609161

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324208218365
                                         uncertainty =       0.002245609161

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402629448
  error estimate for blocks of size 2^( 2) =       0.000415394995
  error estimate for blocks of size 2^( 3) =       0.000428549925
  error estimate for blocks of size 2^( 4) =       0.000440920167
  error estimate for blocks of size 2^( 5) =       0.000452098656
  error estimate for blocks of size 2^( 6) =       0.000460873184
  error estimate for blocks of size 2^( 7) =       0.000464674901

      target function =                  N/A
              le_mean =     -16.906109033087
             les_mean =     286.154505706008
             stat err =       0.000454641727
             autocorr =       1.275050874870
              std dev =       0.569404026449
             le_variance =       0.324220945337


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690610903309e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+00, overlap shift 9.0949e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906109033068       residual = 2.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906110280841       residual = 5.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906110368129       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906110384952       residual = 6.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906110373736       residual = 6.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906110403580       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906110422901       residual = 7.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906110437248       residual = 3.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906110438697       residual = 8.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.0949e+00 is 6.062625e-05

solving harmonic davidson linear method for identity shift 3.6380e+01, overlap shift 3.6380e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906109033068       residual = 2.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906109350490       residual = 5.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906109373471       residual = 3.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906109377803       residual = 6.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906109375246       residual = 6.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906109382765       residual = 2.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906109387330       residual = 7.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906109390728       residual = 3.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906109391234       residual = 8.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.6380e+01 is 1.542831e-05

solving harmonic davidson linear method for identity shift 1.4552e+02, overlap shift 1.4552e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906109033068       residual = 2.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906109112774       residual = 5.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906109118596       residual = 3.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906109119686       residual = 6.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906109119064       residual = 6.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906109120950       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906109122074       residual = 7.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906109122910       residual = 3.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906109123044       residual = 9.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4552e+02 is 3.874485e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.452731 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7105e+01
  </log>
  <optVariables href="H2O.s047.opt.xml">
   uu_0                 3.132016e-01 1 1  ON 0
   uu_1                 1.455825e-01 1 1  ON 1
   uu_2                 4.355545e-02 1 1  ON 2
   uu_3                -1.950774e-02 1 1  ON 3
   uu_4                -6.623962e-02 1 1  ON 4
   uu_5                -1.025681e-01 1 1  ON 5
   uu_6                -1.317254e-01 1 1  ON 6
   uu_7                -1.471487e-01 1 1  ON 7
   uu_8                -1.406502e-01 1 1  ON 8
   uu_9                -1.124006e-01 1 1  ON 9
   ud_0                 4.508950e-01 1 1  ON 10
   ud_1                 1.850818e-01 1 1  ON 11
   ud_2                 6.457153e-02 1 1  ON 12
   ud_3                -6.647706e-03 1 1  ON 13
   ud_4                -6.397027e-02 1 1  ON 14
   ud_5                -1.064574e-01 1 1  ON 15
   ud_6                -1.351470e-01 1 1  ON 16
   ud_7                -1.529973e-01 1 1  ON 17
   ud_8                -1.552890e-01 1 1  ON 18
   ud_9                -1.453133e-01 1 1  ON 19
   eO_0                -7.493680e-01 1 1  ON 20
   eO_1                -4.286621e-01 1 1  ON 21
   eO_2                -1.760966e-02 1 1  ON 22
   eO_3                 2.965366e-01 1 1  ON 23
   eO_4                 5.241262e-01 1 1  ON 24
   eO_5                 4.885703e-01 1 1  ON 25
   eO_6                 2.625662e-01 1 1  ON 26
   eO_7                -4.219604e-02 1 1  ON 27
   eO_8                -2.331288e-01 1 1  ON 28
   eO_9                -9.775310e-02 1 1  ON 29
  eH1_0                -2.637186e-01 1 1  ON 30
  eH1_1                -1.560105e-01 1 1  ON 31
  eH1_2                -1.059658e-01 1 1  ON 32
  eH1_3                -5.049048e-02 1 1  ON 33
  eH1_4                -5.795947e-05 1 1  ON 34
  eH1_5                 3.626176e-02 1 1  ON 35
  eH1_6                 9.849734e-02 1 1  ON 36
  eH1_7                 1.591367e-01 1 1  ON 37
  eH1_8                 1.936658e-01 1 1  ON 38
  eH1_9                 8.902014e-02 1 1  ON 39
  eH2_0                -2.622741e-01 1 1  ON 40
  eH2_1                -1.545311e-01 1 1  ON 41
  eH2_2                -1.044031e-01 1 1  ON 42
  eH2_3                -4.876580e-02 1 1  ON 43
  eH2_4                 1.484585e-03 1 1  ON 44
  eH2_5                 3.815386e-02 1 1  ON 45
  eH2_6                 1.003497e-01 1 1  ON 46
  eH2_7                 1.608020e-01 1 1  ON 47
  eH2_8                 1.980194e-01 1 1  ON 48
  eH2_9                 8.253027e-02 1 1  ON 49
ci_0001                 7.013239e-01 3 1  ON 50
ci_0002                 7.007306e-01 3 1  ON 51
ci_0003                -2.740101e-02 3 1  ON 52
ci_0004                -2.828445e-02 3 1  ON 53
ci_0005                -3.649967e-02 3 1  ON 54
ci_0006                -3.658858e-02 3 1  ON 55
ci_0007                -2.129799e-02 3 1  ON 56
ci_0008                -2.072361e-02 3 1  ON 57
ci_0009                -1.714817e-02 3 1  ON 58
ci_0010                -1.718917e-02 3 1  ON 59
ci_0011                -1.209035e-02 3 1  ON 60
ci_0012                -1.109041e-02 3 1  ON 61
ci_0013                 1.305104e-02 3 1  ON 62
ci_0014                 1.342076e-02 3 1  ON 63
ci_0015                 1.297025e-02 3 1  ON 64
ci_0016                 1.283391e-02 3 1  ON 65
ci_0017                 1.114639e-02 3 1  ON 66
ci_0018                 1.185794e-02 3 1  ON 67
ci_0019                 1.154627e-02 3 1  ON 68
ci_0020                 1.110194e-02 3 1  ON 69
ci_0021                -2.083939e-03 3 1  ON 70
ci_0022                 3.865556e-04 3 1  ON 71
ci_0023                -1.131434e-02 3 1  ON 72
ci_0024                -1.102133e-02 3 1  ON 73
ci_0025                -1.043257e-02 3 1  ON 74
ci_0026                -1.299976e-02 3 1  ON 75
ci_0027                -1.154321e-02 3 1  ON 76
ci_0028                -1.137387e-02 3 1  ON 77
ci_0029                -1.068482e-02 3 1  ON 78
ci_0030                -1.151288e-02 3 1  ON 79
ci_0031                 2.025057e-02 3 1  ON 80
ci_0032                 2.085324e-02 3 1  ON 81
ci_0033                 9.612091e-03 3 1  ON 82
ci_0034                 9.632609e-03 3 1  ON 83
ci_0035                 6.481012e-03 3 1  ON 84
ci_0036                 5.919976e-03 3 1  ON 85
ci_0037                -1.054805e-02 3 1  ON 86
ci_0038                -1.215789e-02 3 1  ON 87
ci_0039                -2.505895e-03 3 1  ON 88
ci_0040                -2.491433e-03 3 1  ON 89
ci_0041                 7.320968e-03 3 1  ON 90
ci_0042                 6.965274e-03 3 1  ON 91
ci_0043                -1.828181e-02 3 1  ON 92
ci_0044                -1.913408e-02 3 1  ON 93
ci_0045                 7.418288e-03 3 1  ON 94
ci_0046                 7.559845e-03 3 1  ON 95
ci_0047                -1.919013e-03 3 1  ON 96
ci_0048                -2.211413e-03 3 1  ON 97
ci_0049                -5.839943e-03 3 1  ON 98
ci_0050                -6.419228e-03 3 1  ON 99
ci_0051                -3.514316e-03 3 1  ON 100
ci_0052                -3.289505e-03 3 1  ON 101
ci_0053                -4.908314e-03 3 1  ON 102
ci_0054                -3.938190e-03 3 1  ON 103
ci_0055                 6.744666e-03 3 1  ON 104
ci_0056                 4.362938e-03 3 1  ON 105
ci_0057                 4.681545e-03 3 1  ON 106
ci_0058                 4.528488e-03 3 1  ON 107
ci_0059                -4.744597e-03 3 1  ON 108
ci_0060                -4.115109e-03 3 1  ON 109
ci_0061                -3.192412e-03 3 1  ON 110
ci_0062                -2.913850e-03 3 1  ON 111
ci_0063                -8.452151e-03 3 1  ON 112
ci_0064                -9.581345e-03 3 1  ON 113
ci_0065                -5.268115e-03 3 1  ON 114
ci_0066                -5.500230e-03 3 1  ON 115
ci_0067                -4.719779e-03 3 1  ON 116
ci_0068                -6.215647e-03 3 1  ON 117
ci_0069                 4.290816e-03 3 1  ON 118
ci_0070                 4.044542e-03 3 1  ON 119
ci_0071                 3.778990e-04 3 1  ON 120
ci_0072                -1.232318e-03 3 1  ON 121
ci_0073                 4.445651e-03 3 1  ON 122
ci_0074                 4.328368e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -16.9167
    reference variance = 0.182076
====================================================
  Execution time = 2.1316e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s047
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3590e-01
  Total weights = 1.9519e+06
  Execution time = 1.9159e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324041579870
                                         uncertainty =       0.003066706653

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324041579870
                                         uncertainty =       0.003066706653

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402536660
  error estimate for blocks of size 2^( 2) =       0.000415623679
  error estimate for blocks of size 2^( 3) =       0.000429249535
  error estimate for blocks of size 2^( 4) =       0.000441779470
  error estimate for blocks of size 2^( 5) =       0.000452534206
  error estimate for blocks of size 2^( 6) =       0.000460868592
  error estimate for blocks of size 2^( 7) =       0.000463216178

      target function =                  N/A
              le_mean =     -16.905969950377
             les_mean =     286.147704198767
             stat err =       0.000454599611
             autocorr =       1.275402439122
              std dev =       0.569272803546
             le_variance =       0.324071524857

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324003550945
                                         uncertainty =       0.003064681717

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324003550945
                                         uncertainty =       0.003064681717

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402513063
  error estimate for blocks of size 2^( 2) =       0.000415600729
  error estimate for blocks of size 2^( 3) =       0.000429227644
  error estimate for blocks of size 2^( 4) =       0.000441758101
  error estimate for blocks of size 2^( 5) =       0.000452513250
  error estimate for blocks of size 2^( 6) =       0.000460849216
  error estimate for blocks of size 2^( 7) =       0.000463197081

      target function =                  N/A
              le_mean =     -16.905970571523
             les_mean =     286.147802350535
             stat err =       0.000454579412
             autocorr =       1.275438627686
              std dev =       0.569239432910
             le_variance =       0.324033531979

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324021864975
                                         uncertainty =       0.003065669396

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324021864975
                                         uncertainty =       0.003065669396

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402524427
  error estimate for blocks of size 2^( 2) =       0.000415611780
  error estimate for blocks of size 2^( 3) =       0.000429238179
  error estimate for blocks of size 2^( 4) =       0.000441768384
  error estimate for blocks of size 2^( 5) =       0.000452523333
  error estimate for blocks of size 2^( 6) =       0.000460858536
  error estimate for blocks of size 2^( 7) =       0.000463206256

      target function =                  N/A
              le_mean =     -16.905970253446
             les_mean =     286.147747571024
             stat err =       0.000454589127
             autocorr =       1.275421130643
              std dev =       0.569255503638
             le_variance =       0.324051828423

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324039081646
                                         uncertainty =       0.003066576016

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324039081646
                                         uncertainty =       0.003066576016

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402535110
  error estimate for blocks of size 2^( 2) =       0.000415622171
  error estimate for blocks of size 2^( 3) =       0.000429248095
  error estimate for blocks of size 2^( 4) =       0.000441778064
  error estimate for blocks of size 2^( 5) =       0.000452532827
  error estimate for blocks of size 2^( 6) =       0.000460867316
  error estimate for blocks of size 2^( 7) =       0.000463214919

      target function =                  N/A
              le_mean =     -16.905969986500
             les_mean =     286.147708807435
             stat err =       0.000454598281
             autocorr =       1.275404799743
              std dev =       0.569270611359
             le_variance =       0.324069028957


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905969950377        initial
     9.0949e+00     9.0949e+01             6.0626e-05       -16.905970571523  <--
     3.6380e+01     3.6380e+02             1.5428e-05       -16.905970253446
     1.4552e+02     1.4552e+03             3.8745e-06       -16.905969986500

*****************************************************************************
Applying the update for shift_i =   9.0949e+00     and shift_s =   9.0949e+01
*****************************************************************************

  Execution time = 3.0977e+01
  </log>
  <optVariables href="H2O.s047.opt.xml">
   uu_0                 3.131973e-01 1 1  ON 0
   uu_1                 1.455741e-01 1 1  ON 1
   uu_2                 4.355134e-02 1 1  ON 2
   uu_3                -1.950894e-02 1 1  ON 3
   uu_4                -6.623851e-02 1 1  ON 4
   uu_5                -1.025667e-01 1 1  ON 5
   uu_6                -1.317275e-01 1 1  ON 6
   uu_7                -1.471485e-01 1 1  ON 7
   uu_8                -1.406480e-01 1 1  ON 8
   uu_9                -1.123986e-01 1 1  ON 9
   ud_0                 4.508967e-01 1 1  ON 10
   ud_1                 1.850912e-01 1 1  ON 11
   ud_2                 6.457695e-02 1 1  ON 12
   ud_3                -6.644685e-03 1 1  ON 13
   ud_4                -6.397750e-02 1 1  ON 14
   ud_5                -1.064569e-01 1 1  ON 15
   ud_6                -1.351480e-01 1 1  ON 16
   ud_7                -1.529985e-01 1 1  ON 17
   ud_8                -1.552897e-01 1 1  ON 18
   ud_9                -1.453173e-01 1 1  ON 19
   eO_0                -7.493714e-01 1 1  ON 20
   eO_1                -4.286504e-01 1 1  ON 21
   eO_2                -1.760039e-02 1 1  ON 22
   eO_3                 2.965300e-01 1 1  ON 23
   eO_4                 5.241325e-01 1 1  ON 24
   eO_5                 4.885745e-01 1 1  ON 25
   eO_6                 2.625635e-01 1 1  ON 26
   eO_7                -4.219543e-02 1 1  ON 27
   eO_8                -2.331350e-01 1 1  ON 28
   eO_9                -9.776402e-02 1 1  ON 29
  eH1_0                -2.637220e-01 1 1  ON 30
  eH1_1                -1.560195e-01 1 1  ON 31
  eH1_2                -1.059695e-01 1 1  ON 32
  eH1_3                -5.048983e-02 1 1  ON 33
  eH1_4                -6.118628e-05 1 1  ON 34
  eH1_5                 3.625308e-02 1 1  ON 35
  eH1_6                 9.849572e-02 1 1  ON 36
  eH1_7                 1.591398e-01 1 1  ON 37
  eH1_8                 1.936757e-01 1 1  ON 38
  eH1_9                 8.903473e-02 1 1  ON 39
  eH2_0                -2.622835e-01 1 1  ON 40
  eH2_1                -1.545438e-01 1 1  ON 41
  eH2_2                -1.044058e-01 1 1  ON 42
  eH2_3                -4.877298e-02 1 1  ON 43
  eH2_4                 1.487072e-03 1 1  ON 44
  eH2_5                 3.815936e-02 1 1  ON 45
  eH2_6                 1.003506e-01 1 1  ON 46
  eH2_7                 1.607994e-01 1 1  ON 47
  eH2_8                 1.980267e-01 1 1  ON 48
  eH2_9                 8.254721e-02 1 1  ON 49
ci_0001                 7.013296e-01 3 1  ON 50
ci_0002                 7.007256e-01 3 1  ON 51
ci_0003                -2.738692e-02 3 1  ON 52
ci_0004                -2.828217e-02 3 1  ON 53
ci_0005                -3.650057e-02 3 1  ON 54
ci_0006                -3.660096e-02 3 1  ON 55
ci_0007                -2.130609e-02 3 1  ON 56
ci_0008                -2.073788e-02 3 1  ON 57
ci_0009                -1.714012e-02 3 1  ON 58
ci_0010                -1.718387e-02 3 1  ON 59
ci_0011                -1.209074e-02 3 1  ON 60
ci_0012                -1.111223e-02 3 1  ON 61
ci_0013                 1.307037e-02 3 1  ON 62
ci_0014                 1.342917e-02 3 1  ON 63
ci_0015                 1.297038e-02 3 1  ON 64
ci_0016                 1.285886e-02 3 1  ON 65
ci_0017                 1.114902e-02 3 1  ON 66
ci_0018                 1.184687e-02 3 1  ON 67
ci_0019                 1.155773e-02 3 1  ON 68
ci_0020                 1.110345e-02 3 1  ON 69
ci_0021                -2.085983e-03 3 1  ON 70
ci_0022                 3.521788e-04 3 1  ON 71
ci_0023                -1.131215e-02 3 1  ON 72
ci_0024                -1.102670e-02 3 1  ON 73
ci_0025                -1.043377e-02 3 1  ON 74
ci_0026                -1.295457e-02 3 1  ON 75
ci_0027                -1.152761e-02 3 1  ON 76
ci_0028                -1.136959e-02 3 1  ON 77
ci_0029                -1.067243e-02 3 1  ON 78
ci_0030                -1.151994e-02 3 1  ON 79
ci_0031                 2.024142e-02 3 1  ON 80
ci_0032                 2.087338e-02 3 1  ON 81
ci_0033                 9.619508e-03 3 1  ON 82
ci_0034                 9.629651e-03 3 1  ON 83
ci_0035                 6.494527e-03 3 1  ON 84
ci_0036                 5.945587e-03 3 1  ON 85
ci_0037                -1.052925e-02 3 1  ON 86
ci_0038                -1.214041e-02 3 1  ON 87
ci_0039                -2.519827e-03 3 1  ON 88
ci_0040                -2.488369e-03 3 1  ON 89
ci_0041                 7.331472e-03 3 1  ON 90
ci_0042                 6.975531e-03 3 1  ON 91
ci_0043                -1.827288e-02 3 1  ON 92
ci_0044                -1.912983e-02 3 1  ON 93
ci_0045                 7.409421e-03 3 1  ON 94
ci_0046                 7.535404e-03 3 1  ON 95
ci_0047                -1.906535e-03 3 1  ON 96
ci_0048                -2.198282e-03 3 1  ON 97
ci_0049                -5.815988e-03 3 1  ON 98
ci_0050                -6.422206e-03 3 1  ON 99
ci_0051                -3.519938e-03 3 1  ON 100
ci_0052                -3.280425e-03 3 1  ON 101
ci_0053                -4.893390e-03 3 1  ON 102
ci_0054                -3.937373e-03 3 1  ON 103
ci_0055                 6.743473e-03 3 1  ON 104
ci_0056                 4.382656e-03 3 1  ON 105
ci_0057                 4.683767e-03 3 1  ON 106
ci_0058                 4.535243e-03 3 1  ON 107
ci_0059                -4.742374e-03 3 1  ON 108
ci_0060                -4.146005e-03 3 1  ON 109
ci_0061                -3.192555e-03 3 1  ON 110
ci_0062                -2.932887e-03 3 1  ON 111
ci_0063                -8.464532e-03 3 1  ON 112
ci_0064                -9.540390e-03 3 1  ON 113
ci_0065                -5.264314e-03 3 1  ON 114
ci_0066                -5.491350e-03 3 1  ON 115
ci_0067                -4.718562e-03 3 1  ON 116
ci_0068                -6.176483e-03 3 1  ON 117
ci_0069                 4.288153e-03 3 1  ON 118
ci_0070                 4.048271e-03 3 1  ON 119
ci_0071                 3.858574e-04 3 1  ON 120
ci_0072                -1.193309e-03 3 1  ON 121
ci_0073                 4.444804e-03 3 1  ON 122
ci_0074                 4.309855e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8105e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s048 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s048 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=48  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -16.9295
    reference variance = 0.200861
====================================================
  Execution time = 2.1005e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s048
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5230e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3448e-01
  Total weights = 1.951725077e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1179e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323903046065
                                         uncertainty =       0.001862595445

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323903046065
                                         uncertainty =       0.001862595445

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402410974
  error estimate for blocks of size 2^( 2) =       0.000415283741
  error estimate for blocks of size 2^( 3) =       0.000428145258
  error estimate for blocks of size 2^( 4) =       0.000440126353
  error estimate for blocks of size 2^( 5) =       0.000449619843
  error estimate for blocks of size 2^( 6) =       0.000456805766
  error estimate for blocks of size 2^( 7) =       0.000459318987

      target function =                  N/A
              le_mean =     -16.906903588623
             les_mean =     286.177864873225
             stat err =       0.000451467737
             autocorr =       1.258675587736
              std dev =       0.569095056786
             le_variance =       0.323869183658


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690690358862e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+00, overlap shift 2.2737e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906903588652       residual = 2.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906906871890       residual = 4.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906906687427       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906906600891       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906906616468       residual = 7.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906906703684       residual = 2.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906906757470       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906906837603       residual = 4.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906906850333       residual = 2.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906906825868       residual = 6.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.2737e+00 is 1.965799e-04

solving harmonic davidson linear method for identity shift 9.0949e+00, overlap shift 9.0949e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906903588652       residual = 2.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906904469978       residual = 4.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906904421855       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906904401637       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906904403839       residual = 7.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906904424001       residual = 2.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906904440273       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906904458069       residual = 4.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906904460915       residual = 1.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906904456340       residual = 5.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.0949e+00 is 5.443604e-05

solving harmonic davidson linear method for identity shift 3.6380e+01, overlap shift 3.6380e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906903588652       residual = 2.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906903813121       residual = 4.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906903800964       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906903796060       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906903796538       residual = 7.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906903801412       residual = 2.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906903805693       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906903810010       residual = 3.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906903810671       residual = 1.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906903809596       residual = 5.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.6380e+01 is 1.398580e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.461513 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7139e+01
  </log>
  <optVariables href="H2O.s048.opt.xml">
   uu_0                 3.131998e-01 1 1  ON 0
   uu_1                 1.455922e-01 1 1  ON 1
   uu_2                 4.355068e-02 1 1  ON 2
   uu_3                -1.951201e-02 1 1  ON 3
   uu_4                -6.623641e-02 1 1  ON 4
   uu_5                -1.025564e-01 1 1  ON 5
   uu_6                -1.317223e-01 1 1  ON 6
   uu_7                -1.471627e-01 1 1  ON 7
   uu_8                -1.406687e-01 1 1  ON 8
   uu_9                -1.124131e-01 1 1  ON 9
   ud_0                 4.508994e-01 1 1  ON 10
   ud_1                 1.851031e-01 1 1  ON 11
   ud_2                 6.458534e-02 1 1  ON 12
   ud_3                -6.636799e-03 1 1  ON 13
   ud_4                -6.397835e-02 1 1  ON 14
   ud_5                -1.064683e-01 1 1  ON 15
   ud_6                -1.351370e-01 1 1  ON 16
   ud_7                -1.529935e-01 1 1  ON 17
   ud_8                -1.552963e-01 1 1  ON 18
   ud_9                -1.453288e-01 1 1  ON 19
   eO_0                -7.493797e-01 1 1  ON 20
   eO_1                -4.286306e-01 1 1  ON 21
   eO_2                -1.759186e-02 1 1  ON 22
   eO_3                 2.965246e-01 1 1  ON 23
   eO_4                 5.241513e-01 1 1  ON 24
   eO_5                 4.885786e-01 1 1  ON 25
   eO_6                 2.625615e-01 1 1  ON 26
   eO_7                -4.220003e-02 1 1  ON 27
   eO_8                -2.331478e-01 1 1  ON 28
   eO_9                -9.777875e-02 1 1  ON 29
  eH1_0                -2.637313e-01 1 1  ON 30
  eH1_1                -1.560169e-01 1 1  ON 31
  eH1_2                -1.059829e-01 1 1  ON 32
  eH1_3                -5.048855e-02 1 1  ON 33
  eH1_4                -7.365759e-05 1 1  ON 34
  eH1_5                 3.625573e-02 1 1  ON 35
  eH1_6                 9.849483e-02 1 1  ON 36
  eH1_7                 1.591428e-01 1 1  ON 37
  eH1_8                 1.936874e-01 1 1  ON 38
  eH1_9                 8.904969e-02 1 1  ON 39
  eH2_0                -2.622932e-01 1 1  ON 40
  eH2_1                -1.545585e-01 1 1  ON 41
  eH2_2                -1.044084e-01 1 1  ON 42
  eH2_3                -4.877499e-02 1 1  ON 43
  eH2_4                 1.500868e-03 1 1  ON 44
  eH2_5                 3.816138e-02 1 1  ON 45
  eH2_6                 1.003402e-01 1 1  ON 46
  eH2_7                 1.607969e-01 1 1  ON 47
  eH2_8                 1.980324e-01 1 1  ON 48
  eH2_9                 8.256800e-02 1 1  ON 49
ci_0001                 7.013332e-01 3 1  ON 50
ci_0002                 7.007233e-01 3 1  ON 51
ci_0003                -2.738272e-02 3 1  ON 52
ci_0004                -2.825891e-02 3 1  ON 53
ci_0005                -3.651161e-02 3 1  ON 54
ci_0006                -3.661060e-02 3 1  ON 55
ci_0007                -2.130229e-02 3 1  ON 56
ci_0008                -2.076244e-02 3 1  ON 57
ci_0009                -1.714205e-02 3 1  ON 58
ci_0010                -1.718403e-02 3 1  ON 59
ci_0011                -1.209163e-02 3 1  ON 60
ci_0012                -1.114367e-02 3 1  ON 61
ci_0013                 1.307361e-02 3 1  ON 62
ci_0014                 1.342701e-02 3 1  ON 63
ci_0015                 1.296794e-02 3 1  ON 64
ci_0016                 1.285207e-02 3 1  ON 65
ci_0017                 1.114080e-02 3 1  ON 66
ci_0018                 1.183159e-02 3 1  ON 67
ci_0019                 1.153944e-02 3 1  ON 68
ci_0020                 1.110719e-02 3 1  ON 69
ci_0021                -2.093254e-03 3 1  ON 70
ci_0022                 3.268953e-04 3 1  ON 71
ci_0023                -1.130396e-02 3 1  ON 72
ci_0024                -1.103721e-02 3 1  ON 73
ci_0025                -1.044384e-02 3 1  ON 74
ci_0026                -1.290788e-02 3 1  ON 75
ci_0027                -1.151641e-02 3 1  ON 76
ci_0028                -1.137956e-02 3 1  ON 77
ci_0029                -1.064420e-02 3 1  ON 78
ci_0030                -1.149182e-02 3 1  ON 79
ci_0031                 2.022833e-02 3 1  ON 80
ci_0032                 2.086392e-02 3 1  ON 81
ci_0033                 9.619248e-03 3 1  ON 82
ci_0034                 9.650175e-03 3 1  ON 83
ci_0035                 6.513912e-03 3 1  ON 84
ci_0036                 5.966967e-03 3 1  ON 85
ci_0037                -1.051262e-02 3 1  ON 86
ci_0038                -1.211931e-02 3 1  ON 87
ci_0039                -2.529425e-03 3 1  ON 88
ci_0040                -2.490634e-03 3 1  ON 89
ci_0041                 7.324154e-03 3 1  ON 90
ci_0042                 6.975084e-03 3 1  ON 91
ci_0043                -1.828124e-02 3 1  ON 92
ci_0044                -1.914338e-02 3 1  ON 93
ci_0045                 7.426750e-03 3 1  ON 94
ci_0046                 7.514614e-03 3 1  ON 95
ci_0047                -1.901650e-03 3 1  ON 96
ci_0048                -2.199412e-03 3 1  ON 97
ci_0049                -5.806749e-03 3 1  ON 98
ci_0050                -6.402821e-03 3 1  ON 99
ci_0051                -3.528446e-03 3 1  ON 100
ci_0052                -3.308627e-03 3 1  ON 101
ci_0053                -4.880908e-03 3 1  ON 102
ci_0054                -3.962950e-03 3 1  ON 103
ci_0055                 6.734744e-03 3 1  ON 104
ci_0056                 4.423766e-03 3 1  ON 105
ci_0057                 4.683558e-03 3 1  ON 106
ci_0058                 4.543552e-03 3 1  ON 107
ci_0059                -4.750928e-03 3 1  ON 108
ci_0060                -4.181202e-03 3 1  ON 109
ci_0061                -3.211329e-03 3 1  ON 110
ci_0062                -2.952543e-03 3 1  ON 111
ci_0063                -8.481623e-03 3 1  ON 112
ci_0064                -9.498985e-03 3 1  ON 113
ci_0065                -5.282324e-03 3 1  ON 114
ci_0066                -5.505556e-03 3 1  ON 115
ci_0067                -4.741073e-03 3 1  ON 116
ci_0068                -6.122047e-03 3 1  ON 117
ci_0069                 4.288665e-03 3 1  ON 118
ci_0070                 4.044119e-03 3 1  ON 119
ci_0071                 3.865340e-04 3 1  ON 120
ci_0072                -1.162622e-03 3 1  ON 121
ci_0073                 4.431022e-03 3 1  ON 122
ci_0074                 4.307116e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -16.9618
    reference variance = 0.221706
====================================================
  Execution time = 2.1092e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s048
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3127e-01
  Total weights = 1.9515e+06
  Execution time = 1.9188e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321248263505
                                         uncertainty =       0.001840149615

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321248263505
                                         uncertainty =       0.001840149615

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400733858
  error estimate for blocks of size 2^( 2) =       0.000413450459
  error estimate for blocks of size 2^( 3) =       0.000427081826
  error estimate for blocks of size 2^( 4) =       0.000439500741
  error estimate for blocks of size 2^( 5) =       0.000451045772
  error estimate for blocks of size 2^( 6) =       0.000459924384
  error estimate for blocks of size 2^( 7) =       0.000467653903

      target function =                  N/A
              le_mean =     -16.906055833726
             les_mean =     286.145972613808
             stat err =       0.000454531200
             autocorr =       1.286516392976
              std dev =       0.566723256583
             le_variance =       0.321175249552

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321219579351
                                         uncertainty =       0.001840968675

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321219579351
                                         uncertainty =       0.001840968675

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400716026
  error estimate for blocks of size 2^( 2) =       0.000413433042
  error estimate for blocks of size 2^( 3) =       0.000427064457
  error estimate for blocks of size 2^( 4) =       0.000439476318
  error estimate for blocks of size 2^( 5) =       0.000451022625
  error estimate for blocks of size 2^( 6) =       0.000459904552
  error estimate for blocks of size 2^( 7) =       0.000467643882

      target function =                  N/A
              le_mean =     -16.906056504237
             les_mean =     286.148584021257
             stat err =       0.000454511844
             autocorr =       1.286521321450
              std dev =       0.566698037994
             le_variance =       0.321146666267

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321228849137
                                         uncertainty =       0.001840524072

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321228849137
                                         uncertainty =       0.001840524072

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400721780
  error estimate for blocks of size 2^( 2) =       0.000413438512
  error estimate for blocks of size 2^( 3) =       0.000427069809
  error estimate for blocks of size 2^( 4) =       0.000439485143
  error estimate for blocks of size 2^( 5) =       0.000451031119
  error estimate for blocks of size 2^( 6) =       0.000459912190
  error estimate for blocks of size 2^( 7) =       0.000467646191

      target function =                  N/A
              le_mean =     -16.906055840519
             les_mean =     286.146042019611
             stat err =       0.000454518660
             autocorr =       1.286522956409
              std dev =       0.566706176226
             le_variance =       0.321155890173

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321245499098
                                         uncertainty =       0.001840192585

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321245499098
                                         uncertainty =       0.001840192585

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400732138
  error estimate for blocks of size 2^( 2) =       0.000413448758
  error estimate for blocks of size 2^( 3) =       0.000427080119
  error estimate for blocks of size 2^( 4) =       0.000439498583
  error estimate for blocks of size 2^( 5) =       0.000451043731
  error estimate for blocks of size 2^( 6) =       0.000459922663
  error estimate for blocks of size 2^( 7) =       0.000467652749

      target function =                  N/A
              le_mean =     -16.906055808723
             les_mean =     286.145973739544
             stat err =       0.000454529432
             autocorr =       1.286517427005
              std dev =       0.566720823929
             le_variance =       0.321172492275


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906055833726        initial
     2.2737e+00     2.2737e+01             1.9658e-04       -16.906056504237  <--
     9.0949e+00     9.0949e+01             5.4436e-05       -16.906055840519
     3.6380e+01     3.6380e+02             1.3986e-05       -16.906055808723

*****************************************************************************
Applying the update for shift_i =   2.2737e+00     and shift_s =   2.2737e+01
*****************************************************************************

  Execution time = 3.0783e+01
  </log>
  <optVariables href="H2O.s048.opt.xml">
   uu_0                 3.132118e-01 1 1  ON 0
   uu_1                 1.456404e-01 1 1  ON 1
   uu_2                 4.355096e-02 1 1  ON 2
   uu_3                -1.951904e-02 1 1  ON 3
   uu_4                -6.623028e-02 1 1  ON 4
   uu_5                -1.025290e-01 1 1  ON 5
   uu_6                -1.317079e-01 1 1  ON 6
   uu_7                -1.472034e-01 1 1  ON 7
   uu_8                -1.407304e-01 1 1  ON 8
   uu_9                -1.124566e-01 1 1  ON 9
   ud_0                 4.509123e-01 1 1  ON 10
   ud_1                 1.851351e-01 1 1  ON 11
   ud_2                 6.460936e-02 1 1  ON 12
   ud_3                -6.615642e-03 1 1  ON 13
   ud_4                -6.398090e-02 1 1  ON 14
   ud_5                -1.064990e-01 1 1  ON 15
   ud_6                -1.351069e-01 1 1  ON 16
   ud_7                -1.529781e-01 1 1  ON 17
   ud_8                -1.553151e-01 1 1  ON 18
   ud_9                -1.453630e-01 1 1  ON 19
   eO_0                -7.493976e-01 1 1  ON 20
   eO_1                -4.285771e-01 1 1  ON 21
   eO_2                -1.756722e-02 1 1  ON 22
   eO_3                 2.965088e-01 1 1  ON 23
   eO_4                 5.242056e-01 1 1  ON 24
   eO_5                 4.885911e-01 1 1  ON 25
   eO_6                 2.625558e-01 1 1  ON 26
   eO_7                -4.221340e-02 1 1  ON 27
   eO_8                -2.331863e-01 1 1  ON 28
   eO_9                -9.782275e-02 1 1  ON 29
  eH1_0                -2.637590e-01 1 1  ON 30
  eH1_1                -1.560128e-01 1 1  ON 31
  eH1_2                -1.060188e-01 1 1  ON 32
  eH1_3                -5.048744e-02 1 1  ON 33
  eH1_4                -1.083386e-04 1 1  ON 34
  eH1_5                 3.626265e-02 1 1  ON 35
  eH1_6                 9.849217e-02 1 1  ON 36
  eH1_7                 1.591519e-01 1 1  ON 37
  eH1_8                 1.937226e-01 1 1  ON 38
  eH1_9                 8.909434e-02 1 1  ON 39
  eH2_0                -2.623230e-01 1 1  ON 40
  eH2_1                -1.546000e-01 1 1  ON 41
  eH2_2                -1.044159e-01 1 1  ON 42
  eH2_3                -4.878111e-02 1 1  ON 43
  eH2_4                 1.540696e-03 1 1  ON 44
  eH2_5                 3.816717e-02 1 1  ON 45
  eH2_6                 1.003092e-01 1 1  ON 46
  eH2_7                 1.607895e-01 1 1  ON 47
  eH2_8                 1.980496e-01 1 1  ON 48
  eH2_9                 8.262998e-02 1 1  ON 49
ci_0001                 7.013441e-01 3 1  ON 50
ci_0002                 7.007158e-01 3 1  ON 51
ci_0003                -2.737122e-02 3 1  ON 52
ci_0004                -2.819475e-02 3 1  ON 53
ci_0005                -3.654304e-02 3 1  ON 54
ci_0006                -3.663755e-02 3 1  ON 55
ci_0007                -2.129131e-02 3 1  ON 56
ci_0008                -2.083296e-02 3 1  ON 57
ci_0009                -1.714772e-02 3 1  ON 58
ci_0010                -1.718463e-02 3 1  ON 59
ci_0011                -1.209447e-02 3 1  ON 60
ci_0012                -1.122996e-02 3 1  ON 61
ci_0013                 1.308303e-02 3 1  ON 62
ci_0014                 1.342075e-02 3 1  ON 63
ci_0015                 1.296189e-02 3 1  ON 64
ci_0016                 1.283353e-02 3 1  ON 65
ci_0017                 1.111893e-02 3 1  ON 66
ci_0018                 1.178994e-02 3 1  ON 67
ci_0019                 1.148928e-02 3 1  ON 68
ci_0020                 1.111752e-02 3 1  ON 69
ci_0021                -2.113966e-03 3 1  ON 70
ci_0022                 2.542842e-04 3 1  ON 71
ci_0023                -1.128228e-02 3 1  ON 72
ci_0024                -1.106622e-02 3 1  ON 73
ci_0025                -1.047134e-02 3 1  ON 74
ci_0026                -1.278003e-02 3 1  ON 75
ci_0027                -1.148623e-02 3 1  ON 76
ci_0028                -1.140692e-02 3 1  ON 77
ci_0029                -1.056684e-02 3 1  ON 78
ci_0030                -1.141475e-02 3 1  ON 79
ci_0031                 2.019088e-02 3 1  ON 80
ci_0032                 2.083717e-02 3 1  ON 81
ci_0033                 9.618724e-03 3 1  ON 82
ci_0034                 9.708821e-03 3 1  ON 83
ci_0035                 6.567057e-03 3 1  ON 84
ci_0036                 6.025813e-03 3 1  ON 85
ci_0037                -1.046586e-02 3 1  ON 86
ci_0038                -1.206103e-02 3 1  ON 87
ci_0039                -2.554352e-03 3 1  ON 88
ci_0040                -2.496417e-03 3 1  ON 89
ci_0041                 7.304134e-03 3 1  ON 90
ci_0042                 6.973589e-03 3 1  ON 91
ci_0043                -1.830489e-02 3 1  ON 92
ci_0044                -1.918211e-02 3 1  ON 93
ci_0045                 7.475328e-03 3 1  ON 94
ci_0046                 7.455808e-03 3 1  ON 95
ci_0047                -1.888765e-03 3 1  ON 96
ci_0048                -2.202344e-03 3 1  ON 97
ci_0049                -5.781219e-03 3 1  ON 98
ci_0050                -6.349862e-03 3 1  ON 99
ci_0051                -3.550686e-03 3 1  ON 100
ci_0052                -3.382192e-03 3 1  ON 101
ci_0053                -4.847935e-03 3 1  ON 102
ci_0054                -4.031532e-03 3 1  ON 103
ci_0055                 6.710284e-03 3 1  ON 104
ci_0056                 4.539079e-03 3 1  ON 105
ci_0057                 4.682963e-03 3 1  ON 106
ci_0058                 4.566205e-03 3 1  ON 107
ci_0059                -4.773837e-03 3 1  ON 108
ci_0060                -4.274344e-03 3 1  ON 109
ci_0061                -3.262881e-03 3 1  ON 110
ci_0062                -3.006429e-03 3 1  ON 111
ci_0063                -8.527315e-03 3 1  ON 112
ci_0064                -9.389402e-03 3 1  ON 113
ci_0065                -5.331275e-03 3 1  ON 114
ci_0066                -5.544225e-03 3 1  ON 115
ci_0067                -4.800226e-03 3 1  ON 116
ci_0068                -5.979903e-03 3 1  ON 117
ci_0069                 4.290020e-03 3 1  ON 118
ci_0070                 4.033796e-03 3 1  ON 119
ci_0071                 3.882590e-04 3 1  ON 120
ci_0072                -1.079589e-03 3 1  ON 121
ci_0073                 4.395114e-03 3 1  ON 122
ci_0074                 4.299851e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7947e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s049 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s049 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=49  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -16.9248
    reference variance = 0.144366
====================================================
  Execution time = 2.1005e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s049
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5274e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3257e-01
  Total weights = 1.951855873e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.3232e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322086481701
                                         uncertainty =       0.002677460746

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322086481701
                                         uncertainty =       0.002677460746

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401286203
  error estimate for blocks of size 2^( 2) =       0.000414704135
  error estimate for blocks of size 2^( 3) =       0.000428628700
  error estimate for blocks of size 2^( 4) =       0.000442288934
  error estimate for blocks of size 2^( 5) =       0.000453641531
  error estimate for blocks of size 2^( 6) =       0.000462475233
  error estimate for blocks of size 2^( 7) =       0.000468188347

      target function =                  N/A
              le_mean =     -16.906352779359
             les_mean =     286.157339236972
             stat err =       0.000456648511
             autocorr =       1.294957860601
              std dev =       0.567504390311
             le_variance =       0.322061233023


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690635277936e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.6843e-01, overlap shift 5.6843e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906352779337       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906362221732       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906362085224       residual = 4.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906362227522       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906362481565       residual = 4.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906362493110       residual = 4.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906362350012       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906362687107       residual = 7.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906362684636       residual = 2.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906362561535       residual = 9.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.6843e-01 is 5.541434e-04

solving harmonic davidson linear method for identity shift 2.2737e+00, overlap shift 2.2737e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906352779337       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906355710626       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906355668695       residual = 3.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906355722009       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906355876042       residual = 4.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906355946462       residual = 2.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906355864757       residual = 8.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906355876193       residual = 4.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906355903382       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906355880657       residual = 4.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.2737e+00 is 1.750331e-04

solving harmonic davidson linear method for identity shift 9.0949e+00, overlap shift 9.0949e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906352779337       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906353559299       residual = 2.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906353548789       residual = 3.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906353564251       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906353612074       residual = 4.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906353637573       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906353615148       residual = 8.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906353611986       residual = 3.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906353619973       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906353615149       residual = 3.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.0949e+00 is 4.685362e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.470311 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7345e+01
  </log>
  <optVariables href="H2O.s049.opt.xml">
   uu_0                 3.131701e-01 1 1  ON 0
   uu_1                 1.456057e-01 1 1  ON 1
   uu_2                 4.357274e-02 1 1  ON 2
   uu_3                -1.955003e-02 1 1  ON 3
   uu_4                -6.620850e-02 1 1  ON 4
   uu_5                -1.024825e-01 1 1  ON 5
   uu_6                -1.316890e-01 1 1  ON 6
   uu_7                -1.472089e-01 1 1  ON 7
   uu_8                -1.407570e-01 1 1  ON 8
   uu_9                -1.124969e-01 1 1  ON 9
   ud_0                 4.509330e-01 1 1  ON 10
   ud_1                 1.850989e-01 1 1  ON 11
   ud_2                 6.460976e-02 1 1  ON 12
   ud_3                -6.615013e-03 1 1  ON 13
   ud_4                -6.399759e-02 1 1  ON 14
   ud_5                -1.064858e-01 1 1  ON 15
   ud_6                -1.351435e-01 1 1  ON 16
   ud_7                -1.529766e-01 1 1  ON 17
   ud_8                -1.552486e-01 1 1  ON 18
   ud_9                -1.453454e-01 1 1  ON 19
   eO_0                -7.493853e-01 1 1  ON 20
   eO_1                -4.285715e-01 1 1  ON 21
   eO_2                -1.755492e-02 1 1  ON 22
   eO_3                 2.964786e-01 1 1  ON 23
   eO_4                 5.242380e-01 1 1  ON 24
   eO_5                 4.886435e-01 1 1  ON 25
   eO_6                 2.625512e-01 1 1  ON 26
   eO_7                -4.221844e-02 1 1  ON 27
   eO_8                -2.332072e-01 1 1  ON 28
   eO_9                -9.786840e-02 1 1  ON 29
  eH1_0                -2.637709e-01 1 1  ON 30
  eH1_1                -1.560841e-01 1 1  ON 31
  eH1_2                -1.060481e-01 1 1  ON 32
  eH1_3                -5.051271e-02 1 1  ON 33
  eH1_4                -1.761182e-04 1 1  ON 34
  eH1_5                 3.626876e-02 1 1  ON 35
  eH1_6                 9.846190e-02 1 1  ON 36
  eH1_7                 1.592117e-01 1 1  ON 37
  eH1_8                 1.937921e-01 1 1  ON 38
  eH1_9                 8.917782e-02 1 1  ON 39
  eH2_0                -2.623188e-01 1 1  ON 40
  eH2_1                -1.546348e-01 1 1  ON 41
  eH2_2                -1.044134e-01 1 1  ON 42
  eH2_3                -4.879002e-02 1 1  ON 43
  eH2_4                 1.522973e-03 1 1  ON 44
  eH2_5                 3.815499e-02 1 1  ON 45
  eH2_6                 1.002808e-01 1 1  ON 46
  eH2_7                 1.607591e-01 1 1  ON 47
  eH2_8                 1.980801e-01 1 1  ON 48
  eH2_9                 8.271222e-02 1 1  ON 49
ci_0001                 7.013408e-01 3 1  ON 50
ci_0002                 7.007120e-01 3 1  ON 51
ci_0003                -2.741483e-02 3 1  ON 52
ci_0004                -2.825018e-02 3 1  ON 53
ci_0005                -3.652345e-02 3 1  ON 54
ci_0006                -3.662909e-02 3 1  ON 55
ci_0007                -2.127637e-02 3 1  ON 56
ci_0008                -2.082129e-02 3 1  ON 57
ci_0009                -1.726057e-02 3 1  ON 58
ci_0010                -1.714829e-02 3 1  ON 59
ci_0011                -1.210684e-02 3 1  ON 60
ci_0012                -1.129230e-02 3 1  ON 61
ci_0013                 1.313760e-02 3 1  ON 62
ci_0014                 1.343332e-02 3 1  ON 63
ci_0015                 1.295284e-02 3 1  ON 64
ci_0016                 1.287371e-02 3 1  ON 65
ci_0017                 1.114005e-02 3 1  ON 66
ci_0018                 1.173559e-02 3 1  ON 67
ci_0019                 1.147447e-02 3 1  ON 68
ci_0020                 1.116112e-02 3 1  ON 69
ci_0021                -2.102420e-03 3 1  ON 70
ci_0022                 2.609018e-04 3 1  ON 71
ci_0023                -1.128179e-02 3 1  ON 72
ci_0024                -1.106332e-02 3 1  ON 73
ci_0025                -1.048430e-02 3 1  ON 74
ci_0026                -1.260500e-02 3 1  ON 75
ci_0027                -1.153270e-02 3 1  ON 76
ci_0028                -1.144318e-02 3 1  ON 77
ci_0029                -1.054399e-02 3 1  ON 78
ci_0030                -1.132564e-02 3 1  ON 79
ci_0031                 2.027670e-02 3 1  ON 80
ci_0032                 2.091207e-02 3 1  ON 81
ci_0033                 9.750045e-03 3 1  ON 82
ci_0034                 9.771425e-03 3 1  ON 83
ci_0035                 6.593522e-03 3 1  ON 84
ci_0036                 6.136472e-03 3 1  ON 85
ci_0037                -1.048487e-02 3 1  ON 86
ci_0038                -1.201913e-02 3 1  ON 87
ci_0039                -2.539928e-03 3 1  ON 88
ci_0040                -2.528259e-03 3 1  ON 89
ci_0041                 7.292579e-03 3 1  ON 90
ci_0042                 6.970251e-03 3 1  ON 91
ci_0043                -1.823965e-02 3 1  ON 92
ci_0044                -1.915815e-02 3 1  ON 93
ci_0045                 7.481303e-03 3 1  ON 94
ci_0046                 7.422173e-03 3 1  ON 95
ci_0047                -1.924149e-03 3 1  ON 96
ci_0048                -2.152375e-03 3 1  ON 97
ci_0049                -5.712154e-03 3 1  ON 98
ci_0050                -6.224196e-03 3 1  ON 99
ci_0051                -3.587596e-03 3 1  ON 100
ci_0052                -3.412337e-03 3 1  ON 101
ci_0053                -4.829773e-03 3 1  ON 102
ci_0054                -4.088364e-03 3 1  ON 103
ci_0055                 6.684363e-03 3 1  ON 104
ci_0056                 4.692184e-03 3 1  ON 105
ci_0057                 4.686136e-03 3 1  ON 106
ci_0058                 4.619735e-03 3 1  ON 107
ci_0059                -4.747156e-03 3 1  ON 108
ci_0060                -4.243464e-03 3 1  ON 109
ci_0061                -3.391426e-03 3 1  ON 110
ci_0062                -3.039701e-03 3 1  ON 111
ci_0063                -8.577475e-03 3 1  ON 112
ci_0064                -9.280865e-03 3 1  ON 113
ci_0065                -5.364184e-03 3 1  ON 114
ci_0066                -5.565980e-03 3 1  ON 115
ci_0067                -4.756768e-03 3 1  ON 116
ci_0068                -5.873291e-03 3 1  ON 117
ci_0069                 4.256099e-03 3 1  ON 118
ci_0070                 4.049646e-03 3 1  ON 119
ci_0071                 2.954856e-04 3 1  ON 120
ci_0072                -1.002898e-03 3 1  ON 121
ci_0073                 4.432507e-03 3 1  ON 122
ci_0074                 4.342557e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -16.9323
    reference variance = 0.226635
====================================================
  Execution time = 2.0983e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s049
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4408e-01
  Total weights = 1.9518e+06
  Execution time = 1.9220e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326906471942
                                         uncertainty =       0.002429983034

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326906471942
                                         uncertainty =       0.002429983034

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404242406
  error estimate for blocks of size 2^( 2) =       0.000417303436
  error estimate for blocks of size 2^( 3) =       0.000430893333
  error estimate for blocks of size 2^( 4) =       0.000443976443
  error estimate for blocks of size 2^( 5) =       0.000455351572
  error estimate for blocks of size 2^( 6) =       0.000464102992
  error estimate for blocks of size 2^( 7) =       0.000467568361

      target function =                  N/A
              le_mean =     -16.906401132922
             les_mean =     286.170842355288
             stat err =       0.000457749842
             autocorr =       1.282249873803
              std dev =       0.571685093389
             le_variance =       0.326823846004

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326694357709
                                         uncertainty =       0.002387438308

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326694357709
                                         uncertainty =       0.002387438308

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404111503
  error estimate for blocks of size 2^( 2) =       0.000417164682
  error estimate for blocks of size 2^( 3) =       0.000430747596
  error estimate for blocks of size 2^( 4) =       0.000443823805
  error estimate for blocks of size 2^( 5) =       0.000455193816
  error estimate for blocks of size 2^( 6) =       0.000463945828
  error estimate for blocks of size 2^( 7) =       0.000467413236

      target function =                  N/A
              le_mean =     -16.906408172441
             les_mean =     286.177596420684
             stat err =       0.000457594171
             autocorr =       1.282208179008
              std dev =       0.571499968056
             le_variance =       0.326612213488

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326762422957
                                         uncertainty =       0.002402178560

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326762422957
                                         uncertainty =       0.002402178560

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404153510
  error estimate for blocks of size 2^( 2) =       0.000417208929
  error estimate for blocks of size 2^( 3) =       0.000430793995
  error estimate for blocks of size 2^( 4) =       0.000443872114
  error estimate for blocks of size 2^( 5) =       0.000455246032
  error estimate for blocks of size 2^( 6) =       0.000463999187
  error estimate for blocks of size 2^( 7) =       0.000467467018

      target function =                  N/A
              le_mean =     -16.906405005323
             les_mean =     286.170653402481
             stat err =       0.000457646088
             autocorr =       1.282232555255
              std dev =       0.571559374470
             le_variance =       0.326680118545

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326884483261
                                         uncertainty =       0.002425929214

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326884483261
                                         uncertainty =       0.002425929214

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404228836
  error estimate for blocks of size 2^( 2) =       0.000417289139
  error estimate for blocks of size 2^( 3) =       0.000430878378
  error estimate for blocks of size 2^( 4) =       0.000443960834
  error estimate for blocks of size 2^( 5) =       0.000455336005
  error estimate for blocks of size 2^( 6) =       0.000464087802
  error estimate for blocks of size 2^( 7) =       0.000467553590

      target function =                  N/A
              le_mean =     -16.906401458076
             les_mean =     286.170730750900
             stat err =       0.000457734557
             autocorr =       1.282250334384
              std dev =       0.571665902098
             le_variance =       0.326801903622


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906401132922        initial
     5.6843e-01     5.6843e+00             5.5414e-04       -16.906408172441  <--
     2.2737e+00     2.2737e+01             1.7503e-04       -16.906405005323
     9.0949e+00     9.0949e+01             4.6854e-05       -16.906401458076

*****************************************************************************
Applying the update for shift_i =   5.6843e-01     and shift_s =   5.6843e+00
*****************************************************************************

  Execution time = 3.0684e+01
  </log>
  <optVariables href="H2O.s049.opt.xml">
   uu_0                 3.130585e-01 1 1  ON 0
   uu_1                 1.455449e-01 1 1  ON 1
   uu_2                 4.358650e-02 1 1  ON 2
   uu_3                -1.958920e-02 1 1  ON 3
   uu_4                -6.616457e-02 1 1  ON 4
   uu_5                -1.023805e-01 1 1  ON 5
   uu_6                -1.316341e-01 1 1  ON 6
   uu_7                -1.472238e-01 1 1  ON 7
   uu_8                -1.408355e-01 1 1  ON 8
   uu_9                -1.126137e-01 1 1  ON 9
   ud_0                 4.509412e-01 1 1  ON 10
   ud_1                 1.850361e-01 1 1  ON 11
   ud_2                 6.460019e-02 1 1  ON 12
   ud_3                -6.616013e-03 1 1  ON 13
   ud_4                -6.402777e-02 1 1  ON 14
   ud_5                -1.064700e-01 1 1  ON 15
   ud_6                -1.352134e-01 1 1  ON 16
   ud_7                -1.529743e-01 1 1  ON 17
   ud_8                -1.550650e-01 1 1  ON 18
   ud_9                -1.452926e-01 1 1  ON 19
   eO_0                -7.493505e-01 1 1  ON 20
   eO_1                -4.285564e-01 1 1  ON 21
   eO_2                -1.752399e-02 1 1  ON 22
   eO_3                 2.963875e-01 1 1  ON 23
   eO_4                 5.243226e-01 1 1  ON 24
   eO_5                 4.888092e-01 1 1  ON 25
   eO_6                 2.625456e-01 1 1  ON 26
   eO_7                -4.223408e-02 1 1  ON 27
   eO_8                -2.332680e-01 1 1  ON 28
   eO_9                -9.800121e-02 1 1  ON 29
  eH1_0                -2.638139e-01 1 1  ON 30
  eH1_1                -1.562650e-01 1 1  ON 31
  eH1_2                -1.061475e-01 1 1  ON 32
  eH1_3                -5.060553e-02 1 1  ON 33
  eH1_4                -3.556572e-04 1 1  ON 34
  eH1_5                 3.627103e-02 1 1  ON 35
  eH1_6                 9.837828e-02 1 1  ON 36
  eH1_7                 1.593905e-01 1 1  ON 37
  eH1_8                 1.939967e-01 1 1  ON 38
  eH1_9                 8.942206e-02 1 1  ON 39
  eH2_0                -2.623078e-01 1 1  ON 40
  eH2_1                -1.547110e-01 1 1  ON 41
  eH2_2                -1.044183e-01 1 1  ON 42
  eH2_3                -4.882163e-02 1 1  ON 43
  eH2_4                 1.475156e-03 1 1  ON 44
  eH2_5                 3.811248e-02 1 1  ON 45
  eH2_6                 1.001959e-01 1 1  ON 46
  eH2_7                 1.606701e-01 1 1  ON 47
  eH2_8                 1.981681e-01 1 1  ON 48
  eH2_9                 8.295219e-02 1 1  ON 49
ci_0001                 7.013422e-01 3 1  ON 50
ci_0002                 7.006946e-01 3 1  ON 51
ci_0003                -2.751082e-02 3 1  ON 52
ci_0004                -2.837750e-02 3 1  ON 53
ci_0005                -3.647540e-02 3 1  ON 54
ci_0006                -3.660825e-02 3 1  ON 55
ci_0007                -2.123887e-02 3 1  ON 56
ci_0008                -2.078856e-02 3 1  ON 57
ci_0009                -1.749739e-02 3 1  ON 58
ci_0010                -1.707304e-02 3 1  ON 59
ci_0011                -1.213403e-02 3 1  ON 60
ci_0012                -1.143184e-02 3 1  ON 61
ci_0013                 1.325424e-02 3 1  ON 62
ci_0014                 1.346162e-02 3 1  ON 63
ci_0015                 1.292974e-02 3 1  ON 64
ci_0016                 1.296304e-02 3 1  ON 65
ci_0017                 1.118527e-02 3 1  ON 66
ci_0018                 1.162020e-02 3 1  ON 67
ci_0019                 1.144239e-02 3 1  ON 68
ci_0020                 1.125470e-02 3 1  ON 69
ci_0021                -2.073324e-03 3 1  ON 70
ci_0022                 2.782857e-04 3 1  ON 71
ci_0023                -1.127749e-02 3 1  ON 72
ci_0024                -1.105816e-02 3 1  ON 73
ci_0025                -1.051590e-02 3 1  ON 74
ci_0026                -1.222589e-02 3 1  ON 75
ci_0027                -1.163017e-02 3 1  ON 76
ci_0028                -1.152019e-02 3 1  ON 77
ci_0029                -1.048763e-02 3 1  ON 78
ci_0030                -1.112553e-02 3 1  ON 79
ci_0031                 2.048429e-02 3 1  ON 80
ci_0032                 2.108814e-02 3 1  ON 81
ci_0033                 1.008352e-02 3 1  ON 82
ci_0034                 9.925261e-03 3 1  ON 83
ci_0035                 6.651254e-03 3 1  ON 84
ci_0036                 6.387641e-03 3 1  ON 85
ci_0037                -1.052894e-02 3 1  ON 86
ci_0038                -1.192637e-02 3 1  ON 87
ci_0039                -2.513638e-03 3 1  ON 88
ci_0040                -2.586307e-03 3 1  ON 89
ci_0041                 7.264421e-03 3 1  ON 90
ci_0042                 6.958524e-03 3 1  ON 91
ci_0043                -1.806816e-02 3 1  ON 92
ci_0044                -1.909438e-02 3 1  ON 93
ci_0045                 7.494625e-03 3 1  ON 94
ci_0046                 7.343666e-03 3 1  ON 95
ci_0047                -1.988811e-03 3 1  ON 96
ci_0048                -2.058645e-03 3 1  ON 97
ci_0049                -5.559054e-03 3 1  ON 98
ci_0050                -5.949269e-03 3 1  ON 99
ci_0051                -3.657115e-03 3 1  ON 100
ci_0052                -3.468500e-03 3 1  ON 101
ci_0053                -4.792326e-03 3 1  ON 102
ci_0054                -4.203249e-03 3 1  ON 103
ci_0055                 6.625441e-03 3 1  ON 104
ci_0056                 5.054632e-03 3 1  ON 105
ci_0057                 4.692092e-03 3 1  ON 106
ci_0058                 4.740059e-03 3 1  ON 107
ci_0059                -4.695452e-03 3 1  ON 108
ci_0060                -4.181835e-03 3 1  ON 109
ci_0061                -3.677780e-03 3 1  ON 110
ci_0062                -3.112172e-03 3 1  ON 111
ci_0063                -8.679315e-03 3 1  ON 112
ci_0064                -9.063015e-03 3 1  ON 113
ci_0065                -5.430617e-03 3 1  ON 114
ci_0066                -5.612975e-03 3 1  ON 115
ci_0067                -4.672694e-03 3 1  ON 116
ci_0068                -5.671048e-03 3 1  ON 117
ci_0069                 4.192798e-03 3 1  ON 118
ci_0070                 4.082014e-03 3 1  ON 119
ci_0071                 9.011836e-05 3 1  ON 120
ci_0072                -8.347754e-04 3 1  ON 121
ci_0073                 4.504787e-03 3 1  ON 122
ci_0074                 4.424150e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8052e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s050 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s050 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=50  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -17.022
    reference variance = 0.834999
====================================================
  Execution time = 2.1143e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s050
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5262e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4082e-01
  Total weights = 1.951660392e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0402e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324035023867
                                         uncertainty =       0.002955860967

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324035023867
                                         uncertainty =       0.002955860967

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402509405
  error estimate for blocks of size 2^( 2) =       0.000415667453
  error estimate for blocks of size 2^( 3) =       0.000428520888
  error estimate for blocks of size 2^( 4) =       0.000440838425
  error estimate for blocks of size 2^( 5) =       0.000451084007
  error estimate for blocks of size 2^( 6) =       0.000461122857
  error estimate for blocks of size 2^( 7) =       0.000465878866

      target function =                  N/A
              le_mean =     -16.906631375640
             les_mean =     286.175005450288
             stat err =       0.000454731039
             autocorr =       1.276312825743
              std dev =       0.569234259387
             le_variance =       0.324027642060


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690663137564e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4211e-01, overlap shift 1.4211e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906631375653       residual = 2.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906662546777       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906661616141       residual = 8.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906659442844       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906660469463       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906660007022       residual = 8.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906662647124       residual = 5.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906662202329       residual = 2.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906661616730       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906662416397       residual = 9.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906662518174       residual = 6.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906662649893       residual = 2.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906662516285       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906662397493       residual = 6.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4211e-01 is 1.560477e-03

solving harmonic davidson linear method for identity shift 5.6843e-01, overlap shift 5.6843e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906631375653       residual = 2.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906645118976       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906645069084       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906644355086       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906645019835       residual = 9.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906645436887       residual = 3.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906645828184       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906645593617       residual = 8.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906645453216       residual = 2.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906645586218       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906645603615       residual = 4.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.6843e-01 is 6.586870e-04

solving harmonic davidson linear method for identity shift 2.2737e+00, overlap shift 2.2737e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906631375653       residual = 2.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906635622124       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906635666353       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906635590565       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906635777672       residual = 8.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906635888020       residual = 2.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906636003421       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906635943423       residual = 4.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906635919411       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906635921967       residual = 5.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.2737e+00 is 1.985025e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.480817 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7200e+01
  </log>
  <optVariables href="H2O.s050.opt.xml">
   uu_0                 3.132779e-01 1 1  ON 0
   uu_1                 1.456471e-01 1 1  ON 1
   uu_2                 4.356321e-02 1 1  ON 2
   uu_3                -1.956349e-02 1 1  ON 3
   uu_4                -6.610332e-02 1 1  ON 4
   uu_5                -1.025271e-01 1 1  ON 5
   uu_6                -1.316506e-01 1 1  ON 6
   uu_7                -1.474901e-01 1 1  ON 7
   uu_8                -1.409697e-01 1 1  ON 8
   uu_9                -1.126357e-01 1 1  ON 9
   ud_0                 4.508942e-01 1 1  ON 10
   ud_1                 1.850704e-01 1 1  ON 11
   ud_2                 6.464373e-02 1 1  ON 12
   ud_3                -6.599536e-03 1 1  ON 13
   ud_4                -6.406971e-02 1 1  ON 14
   ud_5                -1.064937e-01 1 1  ON 15
   ud_6                -1.351619e-01 1 1  ON 16
   ud_7                -1.530577e-01 1 1  ON 17
   ud_8                -1.551281e-01 1 1  ON 18
   ud_9                -1.452757e-01 1 1  ON 19
   eO_0                -7.492044e-01 1 1  ON 20
   eO_1                -4.284405e-01 1 1  ON 21
   eO_2                -1.741901e-02 1 1  ON 22
   eO_3                 2.961781e-01 1 1  ON 23
   eO_4                 5.243869e-01 1 1  ON 24
   eO_5                 4.889847e-01 1 1  ON 25
   eO_6                 2.625821e-01 1 1  ON 26
   eO_7                -4.223530e-02 1 1  ON 27
   eO_8                -2.334502e-01 1 1  ON 28
   eO_9                -9.822100e-02 1 1  ON 29
  eH1_0                -2.640492e-01 1 1  ON 30
  eH1_1                -1.563217e-01 1 1  ON 31
  eH1_2                -1.061663e-01 1 1  ON 32
  eH1_3                -5.061950e-02 1 1  ON 33
  eH1_4                -1.311280e-04 1 1  ON 34
  eH1_5                 3.623470e-02 1 1  ON 35
  eH1_6                 9.831336e-02 1 1  ON 36
  eH1_7                 1.592693e-01 1 1  ON 37
  eH1_8                 1.940103e-01 1 1  ON 38
  eH1_9                 8.969636e-02 1 1  ON 39
  eH2_0                -2.624060e-01 1 1  ON 40
  eH2_1                -1.548195e-01 1 1  ON 41
  eH2_2                -1.046970e-01 1 1  ON 42
  eH2_3                -4.878454e-02 1 1  ON 43
  eH2_4                 1.411218e-03 1 1  ON 44
  eH2_5                 3.780607e-02 1 1  ON 45
  eH2_6                 1.002739e-01 1 1  ON 46
  eH2_7                 1.608674e-01 1 1  ON 47
  eH2_8                 1.984097e-01 1 1  ON 48
  eH2_9                 8.327982e-02 1 1  ON 49
ci_0001                 7.014470e-01 3 1  ON 50
ci_0002                 7.006025e-01 3 1  ON 51
ci_0003                -2.740996e-02 3 1  ON 52
ci_0004                -2.801119e-02 3 1  ON 53
ci_0005                -3.664601e-02 3 1  ON 54
ci_0006                -3.656100e-02 3 1  ON 55
ci_0007                -2.100444e-02 3 1  ON 56
ci_0008                -2.083813e-02 3 1  ON 57
ci_0009                -1.746135e-02 3 1  ON 58
ci_0010                -1.699945e-02 3 1  ON 59
ci_0011                -1.217718e-02 3 1  ON 60
ci_0012                -1.195880e-02 3 1  ON 61
ci_0013                 1.328920e-02 3 1  ON 62
ci_0014                 1.334696e-02 3 1  ON 63
ci_0015                 1.321175e-02 3 1  ON 64
ci_0016                 1.292216e-02 3 1  ON 65
ci_0017                 1.117474e-02 3 1  ON 66
ci_0018                 1.126862e-02 3 1  ON 67
ci_0019                 1.121643e-02 3 1  ON 68
ci_0020                 1.136497e-02 3 1  ON 69
ci_0021                -2.182890e-03 3 1  ON 70
ci_0022                -6.739671e-05 3 1  ON 71
ci_0023                -1.141645e-02 3 1  ON 72
ci_0024                -1.117075e-02 3 1  ON 73
ci_0025                -1.084673e-02 3 1  ON 74
ci_0026                -1.175740e-02 3 1  ON 75
ci_0027                -1.159019e-02 3 1  ON 76
ci_0028                -1.147099e-02 3 1  ON 77
ci_0029                -1.027994e-02 3 1  ON 78
ci_0030                -1.112762e-02 3 1  ON 79
ci_0031                 2.079884e-02 3 1  ON 80
ci_0032                 2.107121e-02 3 1  ON 81
ci_0033                 1.064947e-02 3 1  ON 82
ci_0034                 1.023154e-02 3 1  ON 83
ci_0035                 6.352046e-03 3 1  ON 84
ci_0036                 6.294839e-03 3 1  ON 85
ci_0037                -1.063022e-02 3 1  ON 86
ci_0038                -1.126768e-02 3 1  ON 87
ci_0039                -2.438016e-03 3 1  ON 88
ci_0040                -2.596803e-03 3 1  ON 89
ci_0041                 7.344391e-03 3 1  ON 90
ci_0042                 6.859539e-03 3 1  ON 91
ci_0043                -1.809352e-02 3 1  ON 92
ci_0044                -1.915750e-02 3 1  ON 93
ci_0045                 7.551264e-03 3 1  ON 94
ci_0046                 7.586359e-03 3 1  ON 95
ci_0047                -2.016873e-03 3 1  ON 96
ci_0048                -2.121145e-03 3 1  ON 97
ci_0049                -5.167069e-03 3 1  ON 98
ci_0050                -5.871068e-03 3 1  ON 99
ci_0051                -3.696642e-03 3 1  ON 100
ci_0052                -3.349939e-03 3 1  ON 101
ci_0053                -4.648122e-03 3 1  ON 102
ci_0054                -4.166707e-03 3 1  ON 103
ci_0055                 6.808756e-03 3 1  ON 104
ci_0056                 5.689111e-03 3 1  ON 105
ci_0057                 4.871683e-03 3 1  ON 106
ci_0058                 4.662379e-03 3 1  ON 107
ci_0059                -4.564047e-03 3 1  ON 108
ci_0060                -4.563734e-03 3 1  ON 109
ci_0061                -3.544732e-03 3 1  ON 110
ci_0062                -2.789081e-03 3 1  ON 111
ci_0063                -8.608140e-03 3 1  ON 112
ci_0064                -8.891520e-03 3 1  ON 113
ci_0065                -5.613825e-03 3 1  ON 114
ci_0066                -5.295548e-03 3 1  ON 115
ci_0067                -4.645915e-03 3 1  ON 116
ci_0068                -5.424026e-03 3 1  ON 117
ci_0069                 4.335475e-03 3 1  ON 118
ci_0070                 4.135323e-03 3 1  ON 119
ci_0071                 7.571632e-05 3 1  ON 120
ci_0072                -6.196227e-04 3 1  ON 121
ci_0073                 4.406767e-03 3 1  ON 122
ci_0074                 4.290985e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -16.8644
    reference variance = 0.215137
====================================================
  Execution time = 2.0956e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s050
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3536e-01
  Total weights = 1.9518e+06
  Execution time = 1.9177e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323024037048
                                         uncertainty =       0.002087692563

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323024037048
                                         uncertainty =       0.002087692563

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401895779
  error estimate for blocks of size 2^( 2) =       0.000414637152
  error estimate for blocks of size 2^( 3) =       0.000427714256
  error estimate for blocks of size 2^( 4) =       0.000439016726
  error estimate for blocks of size 2^( 5) =       0.000449332954
  error estimate for blocks of size 2^( 6) =       0.000456101018
  error estimate for blocks of size 2^( 7) =       0.000460267535

      target function =                  N/A
              le_mean =     -16.905526986222
             les_mean =     286.134449960389
             stat err =       0.000451179558
             autocorr =       1.260294207023
              std dev =       0.568366460984
             le_variance =       0.323040433971

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323195607156
                                         uncertainty =       0.002105439558

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323195607156
                                         uncertainty =       0.002105439558

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401999695
  error estimate for blocks of size 2^( 2) =       0.000414746393
  error estimate for blocks of size 2^( 3) =       0.000427821670
  error estimate for blocks of size 2^( 4) =       0.000439089655
  error estimate for blocks of size 2^( 5) =       0.000449401786
  error estimate for blocks of size 2^( 6) =       0.000456163432
  error estimate for blocks of size 2^( 7) =       0.000460320599

      target function =                  N/A
              le_mean =     -16.905513268336
             les_mean =     286.139393423774
             stat err =       0.000451243868
             autocorr =       1.260001839691
              std dev =       0.568513420697
             le_variance =       0.323207509513

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323051995770
                                         uncertainty =       0.002095565378

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323051995770
                                         uncertainty =       0.002095565378

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401910671
  error estimate for blocks of size 2^( 2) =       0.000414660991
  error estimate for blocks of size 2^( 3) =       0.000427742042
  error estimate for blocks of size 2^( 4) =       0.000439018790
  error estimate for blocks of size 2^( 5) =       0.000449338690
  error estimate for blocks of size 2^( 6) =       0.000456095533
  error estimate for blocks of size 2^( 7) =       0.000460264128

      target function =                  N/A
              le_mean =     -16.905509391451
             les_mean =     286.133207818236
             stat err =       0.000451179285
             autocorr =       1.260199288693
              std dev =       0.568387521501
             le_variance =       0.323064374598

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322983262560
                                         uncertainty =       0.002087978772

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322983262560
                                         uncertainty =       0.002087978772

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401870018
  error estimate for blocks of size 2^( 2) =       0.000414613384
  error estimate for blocks of size 2^( 3) =       0.000427693020
  error estimate for blocks of size 2^( 4) =       0.000438991289
  error estimate for blocks of size 2^( 5) =       0.000449310815
  error estimate for blocks of size 2^( 6) =       0.000456078967
  error estimate for blocks of size 2^( 7) =       0.000460248572

      target function =                  N/A
              le_mean =     -16.905518959753
             les_mean =     286.132119230691
             stat err =       0.000451157411
             autocorr =       1.260332046302
              std dev =       0.568330029068
             le_variance =       0.322999021940


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905526986222        initial  <--
     1.4211e-01     1.4211e+00             1.5605e-03       -16.905513268336
     5.6843e-01     5.6843e+00             6.5869e-04       -16.905509391451
     2.2737e+00     2.2737e+01             1.9850e-04       -16.905518959753

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.6379
  </log>
  <optVariables href="H2O.s050.opt.xml">
   uu_0                 3.130585e-01 1 1  ON 0
   uu_1                 1.455449e-01 1 1  ON 1
   uu_2                 4.358650e-02 1 1  ON 2
   uu_3                -1.958920e-02 1 1  ON 3
   uu_4                -6.616457e-02 1 1  ON 4
   uu_5                -1.023805e-01 1 1  ON 5
   uu_6                -1.316341e-01 1 1  ON 6
   uu_7                -1.472238e-01 1 1  ON 7
   uu_8                -1.408355e-01 1 1  ON 8
   uu_9                -1.126137e-01 1 1  ON 9
   ud_0                 4.509412e-01 1 1  ON 10
   ud_1                 1.850361e-01 1 1  ON 11
   ud_2                 6.460019e-02 1 1  ON 12
   ud_3                -6.616013e-03 1 1  ON 13
   ud_4                -6.402777e-02 1 1  ON 14
   ud_5                -1.064700e-01 1 1  ON 15
   ud_6                -1.352134e-01 1 1  ON 16
   ud_7                -1.529743e-01 1 1  ON 17
   ud_8                -1.550650e-01 1 1  ON 18
   ud_9                -1.452926e-01 1 1  ON 19
   eO_0                -7.493505e-01 1 1  ON 20
   eO_1                -4.285564e-01 1 1  ON 21
   eO_2                -1.752399e-02 1 1  ON 22
   eO_3                 2.963875e-01 1 1  ON 23
   eO_4                 5.243226e-01 1 1  ON 24
   eO_5                 4.888092e-01 1 1  ON 25
   eO_6                 2.625456e-01 1 1  ON 26
   eO_7                -4.223408e-02 1 1  ON 27
   eO_8                -2.332680e-01 1 1  ON 28
   eO_9                -9.800121e-02 1 1  ON 29
  eH1_0                -2.638139e-01 1 1  ON 30
  eH1_1                -1.562650e-01 1 1  ON 31
  eH1_2                -1.061475e-01 1 1  ON 32
  eH1_3                -5.060553e-02 1 1  ON 33
  eH1_4                -3.556572e-04 1 1  ON 34
  eH1_5                 3.627103e-02 1 1  ON 35
  eH1_6                 9.837828e-02 1 1  ON 36
  eH1_7                 1.593905e-01 1 1  ON 37
  eH1_8                 1.939967e-01 1 1  ON 38
  eH1_9                 8.942206e-02 1 1  ON 39
  eH2_0                -2.623078e-01 1 1  ON 40
  eH2_1                -1.547110e-01 1 1  ON 41
  eH2_2                -1.044183e-01 1 1  ON 42
  eH2_3                -4.882163e-02 1 1  ON 43
  eH2_4                 1.475156e-03 1 1  ON 44
  eH2_5                 3.811248e-02 1 1  ON 45
  eH2_6                 1.001959e-01 1 1  ON 46
  eH2_7                 1.606701e-01 1 1  ON 47
  eH2_8                 1.981681e-01 1 1  ON 48
  eH2_9                 8.295219e-02 1 1  ON 49
ci_0001                 7.013422e-01 3 1  ON 50
ci_0002                 7.006946e-01 3 1  ON 51
ci_0003                -2.751082e-02 3 1  ON 52
ci_0004                -2.837750e-02 3 1  ON 53
ci_0005                -3.647540e-02 3 1  ON 54
ci_0006                -3.660825e-02 3 1  ON 55
ci_0007                -2.123887e-02 3 1  ON 56
ci_0008                -2.078856e-02 3 1  ON 57
ci_0009                -1.749739e-02 3 1  ON 58
ci_0010                -1.707304e-02 3 1  ON 59
ci_0011                -1.213403e-02 3 1  ON 60
ci_0012                -1.143184e-02 3 1  ON 61
ci_0013                 1.325424e-02 3 1  ON 62
ci_0014                 1.346162e-02 3 1  ON 63
ci_0015                 1.292974e-02 3 1  ON 64
ci_0016                 1.296304e-02 3 1  ON 65
ci_0017                 1.118527e-02 3 1  ON 66
ci_0018                 1.162020e-02 3 1  ON 67
ci_0019                 1.144239e-02 3 1  ON 68
ci_0020                 1.125470e-02 3 1  ON 69
ci_0021                -2.073324e-03 3 1  ON 70
ci_0022                 2.782857e-04 3 1  ON 71
ci_0023                -1.127749e-02 3 1  ON 72
ci_0024                -1.105816e-02 3 1  ON 73
ci_0025                -1.051590e-02 3 1  ON 74
ci_0026                -1.222589e-02 3 1  ON 75
ci_0027                -1.163017e-02 3 1  ON 76
ci_0028                -1.152019e-02 3 1  ON 77
ci_0029                -1.048763e-02 3 1  ON 78
ci_0030                -1.112553e-02 3 1  ON 79
ci_0031                 2.048429e-02 3 1  ON 80
ci_0032                 2.108814e-02 3 1  ON 81
ci_0033                 1.008352e-02 3 1  ON 82
ci_0034                 9.925261e-03 3 1  ON 83
ci_0035                 6.651254e-03 3 1  ON 84
ci_0036                 6.387641e-03 3 1  ON 85
ci_0037                -1.052894e-02 3 1  ON 86
ci_0038                -1.192637e-02 3 1  ON 87
ci_0039                -2.513638e-03 3 1  ON 88
ci_0040                -2.586307e-03 3 1  ON 89
ci_0041                 7.264421e-03 3 1  ON 90
ci_0042                 6.958524e-03 3 1  ON 91
ci_0043                -1.806816e-02 3 1  ON 92
ci_0044                -1.909438e-02 3 1  ON 93
ci_0045                 7.494625e-03 3 1  ON 94
ci_0046                 7.343666e-03 3 1  ON 95
ci_0047                -1.988811e-03 3 1  ON 96
ci_0048                -2.058645e-03 3 1  ON 97
ci_0049                -5.559054e-03 3 1  ON 98
ci_0050                -5.949269e-03 3 1  ON 99
ci_0051                -3.657115e-03 3 1  ON 100
ci_0052                -3.468500e-03 3 1  ON 101
ci_0053                -4.792326e-03 3 1  ON 102
ci_0054                -4.203249e-03 3 1  ON 103
ci_0055                 6.625441e-03 3 1  ON 104
ci_0056                 5.054632e-03 3 1  ON 105
ci_0057                 4.692092e-03 3 1  ON 106
ci_0058                 4.740059e-03 3 1  ON 107
ci_0059                -4.695452e-03 3 1  ON 108
ci_0060                -4.181835e-03 3 1  ON 109
ci_0061                -3.677780e-03 3 1  ON 110
ci_0062                -3.112172e-03 3 1  ON 111
ci_0063                -8.679315e-03 3 1  ON 112
ci_0064                -9.063015e-03 3 1  ON 113
ci_0065                -5.430617e-03 3 1  ON 114
ci_0066                -5.612975e-03 3 1  ON 115
ci_0067                -4.672694e-03 3 1  ON 116
ci_0068                -5.671048e-03 3 1  ON 117
ci_0069                 4.192798e-03 3 1  ON 118
ci_0070                 4.082014e-03 3 1  ON 119
ci_0071                 9.011836e-05 3 1  ON 120
ci_0072                -8.347754e-04 3 1  ON 121
ci_0073                 4.504787e-03 3 1  ON 122
ci_0074                 4.424150e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7863e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s051 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s051 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=51  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -16.9451
    reference variance = 0.243333
====================================================
  Execution time = 2.3071e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s051
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5247e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3196e-01
  Total weights = 1.951853674e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0348e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320770928487
                                         uncertainty =       0.001992108741

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320770928487
                                         uncertainty =       0.001992108741

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400512938
  error estimate for blocks of size 2^( 2) =       0.000413837817
  error estimate for blocks of size 2^( 3) =       0.000426859453
  error estimate for blocks of size 2^( 4) =       0.000438875933
  error estimate for blocks of size 2^( 5) =       0.000449255923
  error estimate for blocks of size 2^( 6) =       0.000457316660
  error estimate for blocks of size 2^( 7) =       0.000462073119

      target function =                  N/A
              le_mean =     -16.906527353631
             les_mean =     286.162630533440
             stat err =       0.000451880409
             autocorr =       1.272957563212
              std dev =       0.566410829001
             le_variance =       0.320821227210


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690652735363e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4211e+00, overlap shift 1.4211e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906527353631       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906532070314       residual = 2.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906531688944       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906531611811       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906531656909       residual = 5.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906531720227       residual = 2.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906531769911       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906531805488       residual = 5.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906531720443       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906531718202       residual = 7.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4211e+00 is 2.280127e-04

solving harmonic davidson linear method for identity shift 5.6843e+00, overlap shift 5.6843e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906527353631       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906528666343       residual = 2.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906528558534       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906528529854       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906528532013       residual = 5.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906528529168       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906528550654       residual = 9.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906528566017       residual = 4.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906528547965       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906528542756       residual = 4.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.6843e+00 is 6.175088e-05

solving harmonic davidson linear method for identity shift 2.2737e+01, overlap shift 2.2737e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906527353631       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906527691371       residual = 2.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906527663509       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906527655730       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906527655660       residual = 5.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906527653153       residual = 2.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906527659059       residual = 8.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906527663332       residual = 3.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906527659209       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906527657723       residual = 3.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.2737e+01 is 1.605511e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.484769 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9113e+01
  </log>
  <optVariables href="H2O.s051.opt.xml">
   uu_0                 3.130710e-01 1 1  ON 0
   uu_1                 1.455526e-01 1 1  ON 1
   uu_2                 4.357155e-02 1 1  ON 2
   uu_3                -1.958132e-02 1 1  ON 3
   uu_4                -6.615228e-02 1 1  ON 4
   uu_5                -1.023784e-01 1 1  ON 5
   uu_6                -1.316291e-01 1 1  ON 6
   uu_7                -1.472243e-01 1 1  ON 7
   uu_8                -1.408647e-01 1 1  ON 8
   uu_9                -1.126399e-01 1 1  ON 9
   ud_0                 4.509521e-01 1 1  ON 10
   ud_1                 1.850557e-01 1 1  ON 11
   ud_2                 6.460440e-02 1 1  ON 12
   ud_3                -6.609178e-03 1 1  ON 13
   ud_4                -6.402144e-02 1 1  ON 14
   ud_5                -1.064560e-01 1 1  ON 15
   ud_6                -1.352053e-01 1 1  ON 16
   ud_7                -1.529692e-01 1 1  ON 17
   ud_8                -1.550778e-01 1 1  ON 18
   ud_9                -1.453210e-01 1 1  ON 19
   eO_0                -7.493530e-01 1 1  ON 20
   eO_1                -4.285554e-01 1 1  ON 21
   eO_2                -1.749761e-02 1 1  ON 22
   eO_3                 2.963823e-01 1 1  ON 23
   eO_4                 5.243266e-01 1 1  ON 24
   eO_5                 4.888335e-01 1 1  ON 25
   eO_6                 2.625627e-01 1 1  ON 26
   eO_7                -4.223124e-02 1 1  ON 27
   eO_8                -2.332984e-01 1 1  ON 28
   eO_9                -9.803351e-02 1 1  ON 29
  eH1_0                -2.638160e-01 1 1  ON 30
  eH1_1                -1.562576e-01 1 1  ON 31
  eH1_2                -1.061678e-01 1 1  ON 32
  eH1_3                -5.060842e-02 1 1  ON 33
  eH1_4                -3.762687e-04 1 1  ON 34
  eH1_5                 3.627271e-02 1 1  ON 35
  eH1_6                 9.838053e-02 1 1  ON 36
  eH1_7                 1.593884e-01 1 1  ON 37
  eH1_8                 1.940065e-01 1 1  ON 38
  eH1_9                 8.944456e-02 1 1  ON 39
  eH2_0                -2.623107e-01 1 1  ON 40
  eH2_1                -1.547199e-01 1 1  ON 41
  eH2_2                -1.044242e-01 1 1  ON 42
  eH2_3                -4.882697e-02 1 1  ON 43
  eH2_4                 1.476859e-03 1 1  ON 44
  eH2_5                 3.809859e-02 1 1  ON 45
  eH2_6                 1.001931e-01 1 1  ON 46
  eH2_7                 1.606690e-01 1 1  ON 47
  eH2_8                 1.981771e-01 1 1  ON 48
  eH2_9                 8.298088e-02 1 1  ON 49
ci_0001                 7.013210e-01 3 1  ON 50
ci_0002                 7.007177e-01 3 1  ON 51
ci_0003                -2.748801e-02 3 1  ON 52
ci_0004                -2.837140e-02 3 1  ON 53
ci_0005                -3.648500e-02 3 1  ON 54
ci_0006                -3.662490e-02 3 1  ON 55
ci_0007                -2.121874e-02 3 1  ON 56
ci_0008                -2.079755e-02 3 1  ON 57
ci_0009                -1.748353e-02 3 1  ON 58
ci_0010                -1.708660e-02 3 1  ON 59
ci_0011                -1.212147e-02 3 1  ON 60
ci_0012                -1.145558e-02 3 1  ON 61
ci_0013                 1.324150e-02 3 1  ON 62
ci_0014                 1.345999e-02 3 1  ON 63
ci_0015                 1.292428e-02 3 1  ON 64
ci_0016                 1.295785e-02 3 1  ON 65
ci_0017                 1.118776e-02 3 1  ON 66
ci_0018                 1.159367e-02 3 1  ON 67
ci_0019                 1.146048e-02 3 1  ON 68
ci_0020                 1.123585e-02 3 1  ON 69
ci_0021                -2.074569e-03 3 1  ON 70
ci_0022                 2.502197e-04 3 1  ON 71
ci_0023                -1.127727e-02 3 1  ON 72
ci_0024                -1.103988e-02 3 1  ON 73
ci_0025                -1.056056e-02 3 1  ON 74
ci_0026                -1.219192e-02 3 1  ON 75
ci_0027                -1.161323e-02 3 1  ON 76
ci_0028                -1.148991e-02 3 1  ON 77
ci_0029                -1.051911e-02 3 1  ON 78
ci_0030                -1.109941e-02 3 1  ON 79
ci_0031                 2.047979e-02 3 1  ON 80
ci_0032                 2.106211e-02 3 1  ON 81
ci_0033                 1.009993e-02 3 1  ON 82
ci_0034                 9.917171e-03 3 1  ON 83
ci_0035                 6.664301e-03 3 1  ON 84
ci_0036                 6.389170e-03 3 1  ON 85
ci_0037                -1.056455e-02 3 1  ON 86
ci_0038                -1.186466e-02 3 1  ON 87
ci_0039                -2.524478e-03 3 1  ON 88
ci_0040                -2.555483e-03 3 1  ON 89
ci_0041                 7.269876e-03 3 1  ON 90
ci_0042                 6.949900e-03 3 1  ON 91
ci_0043                -1.806783e-02 3 1  ON 92
ci_0044                -1.908569e-02 3 1  ON 93
ci_0045                 7.501854e-03 3 1  ON 94
ci_0046                 7.341984e-03 3 1  ON 95
ci_0047                -1.953626e-03 3 1  ON 96
ci_0048                -2.051215e-03 3 1  ON 97
ci_0049                -5.559277e-03 3 1  ON 98
ci_0050                -5.956972e-03 3 1  ON 99
ci_0051                -3.653905e-03 3 1  ON 100
ci_0052                -3.444893e-03 3 1  ON 101
ci_0053                -4.854077e-03 3 1  ON 102
ci_0054                -4.209442e-03 3 1  ON 103
ci_0055                 6.618290e-03 3 1  ON 104
ci_0056                 5.100231e-03 3 1  ON 105
ci_0057                 4.707578e-03 3 1  ON 106
ci_0058                 4.721159e-03 3 1  ON 107
ci_0059                -4.716483e-03 3 1  ON 108
ci_0060                -4.218033e-03 3 1  ON 109
ci_0061                -3.656677e-03 3 1  ON 110
ci_0062                -3.149647e-03 3 1  ON 111
ci_0063                -8.674061e-03 3 1  ON 112
ci_0064                -9.082297e-03 3 1  ON 113
ci_0065                -5.482761e-03 3 1  ON 114
ci_0066                -5.608464e-03 3 1  ON 115
ci_0067                -4.683884e-03 3 1  ON 116
ci_0068                -5.622753e-03 3 1  ON 117
ci_0069                 4.207693e-03 3 1  ON 118
ci_0070                 4.084303e-03 3 1  ON 119
ci_0071                 9.478238e-05 3 1  ON 120
ci_0072                -7.867862e-04 3 1  ON 121
ci_0073                 4.545751e-03 3 1  ON 122
ci_0074                 4.403087e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -16.8997
    reference variance = 0.267687
====================================================
  Execution time = 2.1204e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s051
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4024e-01
  Total weights = 1.9514e+06
  Execution time = 1.9216e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325435379347
                                         uncertainty =       0.002243633631

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325435379347
                                         uncertainty =       0.002243633631

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403348409
  error estimate for blocks of size 2^( 2) =       0.000416366135
  error estimate for blocks of size 2^( 3) =       0.000429914678
  error estimate for blocks of size 2^( 4) =       0.000442630802
  error estimate for blocks of size 2^( 5) =       0.000453879257
  error estimate for blocks of size 2^( 6) =       0.000460842687
  error estimate for blocks of size 2^( 7) =       0.000467567408

      target function =                  N/A
              le_mean =     -16.906355478837
             les_mean =     286.165020121805
             stat err =       0.000456230038
             autocorr =       1.279402092392
              std dev =       0.570420789817
             le_variance =       0.325379877455

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325511184992
                                         uncertainty =       0.002246675617

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325511184992
                                         uncertainty =       0.002246675617

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403395262
  error estimate for blocks of size 2^( 2) =       0.000416414556
  error estimate for blocks of size 2^( 3) =       0.000429956100
  error estimate for blocks of size 2^( 4) =       0.000442672130
  error estimate for blocks of size 2^( 5) =       0.000453917707
  error estimate for blocks of size 2^( 6) =       0.000460877815
  error estimate for blocks of size 2^( 7) =       0.000467613733

      target function =                  N/A
              le_mean =     -16.906356439219
             les_mean =     286.165774749538
             stat err =       0.000456270346
             autocorr =       1.279330940103
              std dev =       0.570487050010
             le_variance =       0.325455474229

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325474395675
                                         uncertainty =       0.002245255699

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325474395675
                                         uncertainty =       0.002245255699

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403372515
  error estimate for blocks of size 2^( 2) =       0.000416391074
  error estimate for blocks of size 2^( 3) =       0.000429935644
  error estimate for blocks of size 2^( 4) =       0.000442651694
  error estimate for blocks of size 2^( 5) =       0.000453898576
  error estimate for blocks of size 2^( 6) =       0.000460860132
  error estimate for blocks of size 2^( 7) =       0.000467591151

      target function =                  N/A
              le_mean =     -16.906355736033
             les_mean =     286.165226387287
             stat err =       0.000456250388
             autocorr =       1.279363302630
              std dev =       0.570454880768
             le_variance =       0.325418770992

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325440002333
                                         uncertainty =       0.002243837429

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325440002333
                                         uncertainty =       0.002243837429

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403351264
  error estimate for blocks of size 2^( 2) =       0.000416369097
  error estimate for blocks of size 2^( 3) =       0.000429917160
  error estimate for blocks of size 2^( 4) =       0.000442633240
  error estimate for blocks of size 2^( 5) =       0.000453881508
  error estimate for blocks of size 2^( 6) =       0.000460844716
  error estimate for blocks of size 2^( 7) =       0.000467570204

      target function =                  N/A
              le_mean =     -16.906355478550
             les_mean =     286.165083037168
             stat err =       0.000456232417
             autocorr =       1.279397318410
              std dev =       0.570424828134
             le_variance =       0.325384484551


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906355478837        initial
     1.4211e+00     1.4211e+01             2.2801e-04       -16.906356439219  <--
     5.6843e+00     5.6843e+01             6.1751e-05       -16.906355736033
     2.2737e+01     2.2737e+02             1.6055e-05       -16.906355478550

*****************************************************************************
Applying the update for shift_i =   1.4211e+00     and shift_s =   1.4211e+01
*****************************************************************************

  Execution time = 3.0903e+01
  </log>
  <optVariables href="H2O.s051.opt.xml">
   uu_0                 3.131054e-01 1 1  ON 0
   uu_1                 1.455684e-01 1 1  ON 1
   uu_2                 4.354161e-02 1 1  ON 2
   uu_3                -1.956278e-02 1 1  ON 3
   uu_4                -6.611680e-02 1 1  ON 4
   uu_5                -1.023706e-01 1 1  ON 5
   uu_6                -1.316156e-01 1 1  ON 6
   uu_7                -1.472255e-01 1 1  ON 7
   uu_8                -1.409501e-01 1 1  ON 8
   uu_9                -1.127179e-01 1 1  ON 9
   ud_0                 4.509895e-01 1 1  ON 10
   ud_1                 1.851043e-01 1 1  ON 11
   ud_2                 6.462136e-02 1 1  ON 12
   ud_3                -6.591661e-03 1 1  ON 13
   ud_4                -6.400047e-02 1 1  ON 14
   ud_5                -1.064180e-01 1 1  ON 15
   ud_6                -1.351805e-01 1 1  ON 16
   ud_7                -1.529522e-01 1 1  ON 17
   ud_8                -1.551145e-01 1 1  ON 18
   ud_9                -1.454051e-01 1 1  ON 19
   eO_0                -7.493550e-01 1 1  ON 20
   eO_1                -4.285520e-01 1 1  ON 21
   eO_2                -1.743144e-02 1 1  ON 22
   eO_3                 2.963719e-01 1 1  ON 23
   eO_4                 5.243394e-01 1 1  ON 24
   eO_5                 4.889052e-01 1 1  ON 25
   eO_6                 2.626143e-01 1 1  ON 26
   eO_7                -4.222264e-02 1 1  ON 27
   eO_8                -2.333884e-01 1 1  ON 28
   eO_9                -9.812939e-02 1 1  ON 29
  eH1_0                -2.638219e-01 1 1  ON 30
  eH1_1                -1.562427e-01 1 1  ON 31
  eH1_2                -1.062216e-01 1 1  ON 32
  eH1_3                -5.062059e-02 1 1  ON 33
  eH1_4                -4.339983e-04 1 1  ON 34
  eH1_5                 3.627764e-02 1 1  ON 35
  eH1_6                 9.838748e-02 1 1  ON 36
  eH1_7                 1.593829e-01 1 1  ON 37
  eH1_8                 1.940355e-01 1 1  ON 38
  eH1_9                 8.951119e-02 1 1  ON 39
  eH2_0                -2.623203e-01 1 1  ON 40
  eH2_1                -1.547451e-01 1 1  ON 41
  eH2_2                -1.044417e-01 1 1  ON 42
  eH2_3                -4.884251e-02 1 1  ON 43
  eH2_4                 1.480482e-03 1 1  ON 44
  eH2_5                 3.805901e-02 1 1  ON 45
  eH2_6                 1.001845e-01 1 1  ON 46
  eH2_7                 1.606656e-01 1 1  ON 47
  eH2_8                 1.982037e-01 1 1  ON 48
  eH2_9                 8.306580e-02 1 1  ON 49
ci_0001                 7.012601e-01 3 1  ON 50
ci_0002                 7.007835e-01 3 1  ON 51
ci_0003                -2.742715e-02 3 1  ON 52
ci_0004                -2.835647e-02 3 1  ON 53
ci_0005                -3.651165e-02 3 1  ON 54
ci_0006                -3.667142e-02 3 1  ON 55
ci_0007                -2.116241e-02 3 1  ON 56
ci_0008                -2.082232e-02 3 1  ON 57
ci_0009                -1.744761e-02 3 1  ON 58
ci_0010                -1.712267e-02 3 1  ON 59
ci_0011                -1.208780e-02 3 1  ON 60
ci_0012                -1.151809e-02 3 1  ON 61
ci_0013                 1.320859e-02 3 1  ON 62
ci_0014                 1.345699e-02 3 1  ON 63
ci_0015                 1.291013e-02 3 1  ON 64
ci_0016                 1.294571e-02 3 1  ON 65
ci_0017                 1.119370e-02 3 1  ON 66
ci_0018                 1.152591e-02 3 1  ON 67
ci_0019                 1.150724e-02 3 1  ON 68
ci_0020                 1.118750e-02 3 1  ON 69
ci_0021                -2.078314e-03 3 1  ON 70
ci_0022                 1.716679e-04 3 1  ON 71
ci_0023                -1.127679e-02 3 1  ON 72
ci_0024                -1.099400e-02 3 1  ON 73
ci_0025                -1.067638e-02 3 1  ON 74
ci_0026                -1.210382e-02 3 1  ON 75
ci_0027                -1.156925e-02 3 1  ON 76
ci_0028                -1.141161e-02 3 1  ON 77
ci_0029                -1.060149e-02 3 1  ON 78
ci_0030                -1.103100e-02 3 1  ON 79
ci_0031                 2.046883e-02 3 1  ON 80
ci_0032                 2.098994e-02 3 1  ON 81
ci_0033                 1.014567e-02 3 1  ON 82
ci_0034                 9.894203e-03 3 1  ON 83
ci_0035                 6.698304e-03 3 1  ON 84
ci_0036                 6.393297e-03 3 1  ON 85
ci_0037                -1.066052e-02 3 1  ON 86
ci_0038                -1.169835e-02 3 1  ON 87
ci_0039                -2.550619e-03 3 1  ON 88
ci_0040                -2.481700e-03 3 1  ON 89
ci_0041                 7.283593e-03 3 1  ON 90
ci_0042                 6.927955e-03 3 1  ON 91
ci_0043                -1.806703e-02 3 1  ON 92
ci_0044                -1.906227e-02 3 1  ON 93
ci_0045                 7.520807e-03 3 1  ON 94
ci_0046                 7.337314e-03 3 1  ON 95
ci_0047                -1.868188e-03 3 1  ON 96
ci_0048                -2.033376e-03 3 1  ON 97
ci_0049                -5.559339e-03 3 1  ON 98
ci_0050                -5.976942e-03 3 1  ON 99
ci_0051                -3.646320e-03 3 1  ON 100
ci_0052                -3.387432e-03 3 1  ON 101
ci_0053                -5.006305e-03 3 1  ON 102
ci_0054                -4.226792e-03 3 1  ON 103
ci_0055                 6.598618e-03 3 1  ON 104
ci_0056                 5.223963e-03 3 1  ON 105
ci_0057                 4.748783e-03 3 1  ON 106
ci_0058                 4.670976e-03 3 1  ON 107
ci_0059                -4.767724e-03 3 1  ON 108
ci_0060                -4.308086e-03 3 1  ON 109
ci_0061                -3.601508e-03 3 1  ON 110
ci_0062                -3.248064e-03 3 1  ON 111
ci_0063                -8.661125e-03 3 1  ON 112
ci_0064                -9.131800e-03 3 1  ON 113
ci_0065                -5.615818e-03 3 1  ON 114
ci_0066                -5.597446e-03 3 1  ON 115
ci_0067                -4.710442e-03 3 1  ON 116
ci_0068                -5.505856e-03 3 1  ON 117
ci_0069                 4.243779e-03 3 1  ON 118
ci_0070                 4.091385e-03 3 1  ON 119
ci_0071                 1.087950e-04 3 1  ON 120
ci_0072                -6.629186e-04 3 1  ON 121
ci_0073                 4.645195e-03 3 1  ON 122
ci_0074                 4.351355e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.0023e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s052 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s052 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=52  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -16.9346
    reference variance = 0.454851
====================================================
  Execution time = 2.1216e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s052
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5250e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4264e-01
  Total weights = 1.952041233e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0179e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327535698114
                                         uncertainty =       0.002791100702

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327535698114
                                         uncertainty =       0.002791100702

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404684258
  error estimate for blocks of size 2^( 2) =       0.000417673675
  error estimate for blocks of size 2^( 3) =       0.000430625311
  error estimate for blocks of size 2^( 4) =       0.000442455821
  error estimate for blocks of size 2^( 5) =       0.000452432312
  error estimate for blocks of size 2^( 6) =       0.000460621461
  error estimate for blocks of size 2^( 7) =       0.000463234420

      target function =                  N/A
              le_mean =     -16.905132041378
             les_mean =     286.126124752697
             stat err =       0.000454686003
             autocorr =       1.262381293398
              std dev =       0.572309965532
             le_variance =       0.327538696648


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690513204138e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.5527e-01, overlap shift 3.5527e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905132041314       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905140663361       residual = 3.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905139637612       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905139726899       residual = 4.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905139777763       residual = 5.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905138676285       residual = 4.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905138951688       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905139013700       residual = 7.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905139274644       residual = 3.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905139371993       residual = 9.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.5527e-01 is 6.010218e-04

solving harmonic davidson linear method for identity shift 1.4211e+00, overlap shift 1.4211e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905132041314       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905135037158       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905134944072       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905135065559       residual = 5.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905135168754       residual = 5.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905134724833       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905134813587       residual = 7.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905134821704       residual = 3.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905134845249       residual = 9.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4211e+00 is 2.099286e-04

solving harmonic davidson linear method for identity shift 5.6843e+00, overlap shift 5.6843e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905132041314       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905132871153       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905132865372       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905132922716       residual = 6.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905132959364       residual = 5.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905132831016       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905132853024       residual = 6.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905132854826       residual = 3.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905132851935       residual = 6.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.6843e+00 is 5.803251e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.488321 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7242e+01
  </log>
  <optVariables href="H2O.s052.opt.xml">
   uu_0                 3.131005e-01 1 1  ON 0
   uu_1                 1.455767e-01 1 1  ON 1
   uu_2                 4.357784e-02 1 1  ON 2
   uu_3                -1.954625e-02 1 1  ON 3
   uu_4                -6.611400e-02 1 1  ON 4
   uu_5                -1.023869e-01 1 1  ON 5
   uu_6                -1.316122e-01 1 1  ON 6
   uu_7                -1.472650e-01 1 1  ON 7
   uu_8                -1.409813e-01 1 1  ON 8
   uu_9                -1.127734e-01 1 1  ON 9
   ud_0                 4.510219e-01 1 1  ON 10
   ud_1                 1.851111e-01 1 1  ON 11
   ud_2                 6.463499e-02 1 1  ON 12
   ud_3                -6.579426e-03 1 1  ON 13
   ud_4                -6.396882e-02 1 1  ON 14
   ud_5                -1.064566e-01 1 1  ON 15
   ud_6                -1.351229e-01 1 1  ON 16
   ud_7                -1.529234e-01 1 1  ON 17
   ud_8                -1.551728e-01 1 1  ON 18
   ud_9                -1.454586e-01 1 1  ON 19
   eO_0                -7.493023e-01 1 1  ON 20
   eO_1                -4.285822e-01 1 1  ON 21
   eO_2                -1.737766e-02 1 1  ON 22
   eO_3                 2.963572e-01 1 1  ON 23
   eO_4                 5.244560e-01 1 1  ON 24
   eO_5                 4.889307e-01 1 1  ON 25
   eO_6                 2.626231e-01 1 1  ON 26
   eO_7                -4.224318e-02 1 1  ON 27
   eO_8                -2.334785e-01 1 1  ON 28
   eO_9                -9.821658e-02 1 1  ON 29
  eH1_0                -2.639022e-01 1 1  ON 30
  eH1_1                -1.562075e-01 1 1  ON 31
  eH1_2                -1.062874e-01 1 1  ON 32
  eH1_3                -5.065952e-02 1 1  ON 33
  eH1_4                -4.574180e-04 1 1  ON 34
  eH1_5                 3.624195e-02 1 1  ON 35
  eH1_6                 9.836898e-02 1 1  ON 36
  eH1_7                 1.593930e-01 1 1  ON 37
  eH1_8                 1.940695e-01 1 1  ON 38
  eH1_9                 8.964636e-02 1 1  ON 39
  eH2_0                -2.623734e-01 1 1  ON 40
  eH2_1                -1.547100e-01 1 1  ON 41
  eH2_2                -1.044350e-01 1 1  ON 42
  eH2_3                -4.895052e-02 1 1  ON 43
  eH2_4                 1.497732e-03 1 1  ON 44
  eH2_5                 3.805498e-02 1 1  ON 45
  eH2_6                 1.001545e-01 1 1  ON 46
  eH2_7                 1.606538e-01 1 1  ON 47
  eH2_8                 1.982622e-01 1 1  ON 48
  eH2_9                 8.315803e-02 1 1  ON 49
ci_0001                 7.011808e-01 3 1  ON 50
ci_0002                 7.008722e-01 3 1  ON 51
ci_0003                -2.749652e-02 3 1  ON 52
ci_0004                -2.822513e-02 3 1  ON 53
ci_0005                -3.651582e-02 3 1  ON 54
ci_0006                -3.664354e-02 3 1  ON 55
ci_0007                -2.106307e-02 3 1  ON 56
ci_0008                -2.084537e-02 3 1  ON 57
ci_0009                -1.749550e-02 3 1  ON 58
ci_0010                -1.724447e-02 3 1  ON 59
ci_0011                -1.216053e-02 3 1  ON 60
ci_0012                -1.151352e-02 3 1  ON 61
ci_0013                 1.314813e-02 3 1  ON 62
ci_0014                 1.340638e-02 3 1  ON 63
ci_0015                 1.281577e-02 3 1  ON 64
ci_0016                 1.285631e-02 3 1  ON 65
ci_0017                 1.113314e-02 3 1  ON 66
ci_0018                 1.145317e-02 3 1  ON 67
ci_0019                 1.147679e-02 3 1  ON 68
ci_0020                 1.109429e-02 3 1  ON 69
ci_0021                -2.023703e-03 3 1  ON 70
ci_0022                 5.460478e-05 3 1  ON 71
ci_0023                -1.125910e-02 3 1  ON 72
ci_0024                -1.100914e-02 3 1  ON 73
ci_0025                -1.075070e-02 3 1  ON 74
ci_0026                -1.193510e-02 3 1  ON 75
ci_0027                -1.157067e-02 3 1  ON 76
ci_0028                -1.145987e-02 3 1  ON 77
ci_0029                -1.059414e-02 3 1  ON 78
ci_0030                -1.108186e-02 3 1  ON 79
ci_0031                 2.046071e-02 3 1  ON 80
ci_0032                 2.092340e-02 3 1  ON 81
ci_0033                 1.016218e-02 3 1  ON 82
ci_0034                 9.867899e-03 3 1  ON 83
ci_0035                 6.810614e-03 3 1  ON 84
ci_0036                 6.382565e-03 3 1  ON 85
ci_0037                -1.069648e-02 3 1  ON 86
ci_0038                -1.167891e-02 3 1  ON 87
ci_0039                -2.666899e-03 3 1  ON 88
ci_0040                -2.521208e-03 3 1  ON 89
ci_0041                 7.283472e-03 3 1  ON 90
ci_0042                 6.970046e-03 3 1  ON 91
ci_0043                -1.822629e-02 3 1  ON 92
ci_0044                -1.897919e-02 3 1  ON 93
ci_0045                 7.615462e-03 3 1  ON 94
ci_0046                 7.372616e-03 3 1  ON 95
ci_0047                -1.838411e-03 3 1  ON 96
ci_0048                -1.982955e-03 3 1  ON 97
ci_0049                -5.422106e-03 3 1  ON 98
ci_0050                -5.814444e-03 3 1  ON 99
ci_0051                -3.646969e-03 3 1  ON 100
ci_0052                -3.436770e-03 3 1  ON 101
ci_0053                -4.941783e-03 3 1  ON 102
ci_0054                -4.402764e-03 3 1  ON 103
ci_0055                 6.616329e-03 3 1  ON 104
ci_0056                 5.346826e-03 3 1  ON 105
ci_0057                 4.788474e-03 3 1  ON 106
ci_0058                 4.736059e-03 3 1  ON 107
ci_0059                -4.725752e-03 3 1  ON 108
ci_0060                -4.462338e-03 3 1  ON 109
ci_0061                -3.557982e-03 3 1  ON 110
ci_0062                -3.199816e-03 3 1  ON 111
ci_0063                -8.676525e-03 3 1  ON 112
ci_0064                -9.165908e-03 3 1  ON 113
ci_0065                -5.609501e-03 3 1  ON 114
ci_0066                -5.579189e-03 3 1  ON 115
ci_0067                -4.682495e-03 3 1  ON 116
ci_0068                -5.377025e-03 3 1  ON 117
ci_0069                 4.221089e-03 3 1  ON 118
ci_0070                 4.139465e-03 3 1  ON 119
ci_0071                 1.507621e-04 3 1  ON 120
ci_0072                -4.529900e-04 3 1  ON 121
ci_0073                 4.588839e-03 3 1  ON 122
ci_0074                 4.309593e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -16.9064
    reference variance = 0.314545
====================================================
  Execution time = 2.1089e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s052
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3827e-01
  Total weights = 1.9518e+06
  Execution time = 1.9160e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324561928478
                                         uncertainty =       0.002636348396

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324561928478
                                         uncertainty =       0.002636348396

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402851860
  error estimate for blocks of size 2^( 2) =       0.000415656708
  error estimate for blocks of size 2^( 3) =       0.000428018156
  error estimate for blocks of size 2^( 4) =       0.000439898205
  error estimate for blocks of size 2^( 5) =       0.000449990465
  error estimate for blocks of size 2^( 6) =       0.000457093936
  error estimate for blocks of size 2^( 7) =       0.000461684737

      target function =                  N/A
              le_mean =     -16.905807944216
             les_mean =     286.145135368144
             stat err =       0.000452166836
             autocorr =       1.259814683376
              std dev =       0.569718563738
             le_variance =       0.324579241867

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324322921259
                                         uncertainty =       0.002632783155

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324322921259
                                         uncertainty =       0.002632783155

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402703554
  error estimate for blocks of size 2^( 2) =       0.000415504937
  error estimate for blocks of size 2^( 3) =       0.000427866845
  error estimate for blocks of size 2^( 4) =       0.000439762539
  error estimate for blocks of size 2^( 5) =       0.000449869781
  error estimate for blocks of size 2^( 6) =       0.000456962583
  error estimate for blocks of size 2^( 7) =       0.000461558047

      target function =                  N/A
              le_mean =     -16.905809590775
             les_mean =     286.151190528918
             stat err =       0.000452038238
             autocorr =       1.260025755039
              std dev =       0.569508827104
             le_variance =       0.324340304150

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324380732338
                                         uncertainty =       0.002633733126

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324380732338
                                         uncertainty =       0.002633733126

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402739436
  error estimate for blocks of size 2^( 2) =       0.000415543006
  error estimate for blocks of size 2^( 3) =       0.000427904871
  error estimate for blocks of size 2^( 4) =       0.000439798160
  error estimate for blocks of size 2^( 5) =       0.000449901500
  error estimate for blocks of size 2^( 6) =       0.000456996565
  error estimate for blocks of size 2^( 7) =       0.000461587576

      target function =                  N/A
              le_mean =     -16.905808380414
             les_mean =     286.145085940958
             stat err =       0.000452070950
             autocorr =       1.259983578916
              std dev =       0.569559572975
             le_variance =       0.324398107168

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324531862606
                                         uncertainty =       0.002635889071

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324531862606
                                         uncertainty =       0.002635889071

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402833208
  error estimate for blocks of size 2^( 2) =       0.000415637955
  error estimate for blocks of size 2^( 3) =       0.000427999646
  error estimate for blocks of size 2^( 4) =       0.000439881583
  error estimate for blocks of size 2^( 5) =       0.000449975631
  error estimate for blocks of size 2^( 6) =       0.000457078155
  error estimate for blocks of size 2^( 7) =       0.000461668633

      target function =                  N/A
              le_mean =     -16.905807480760
             les_mean =     286.144749785577
             stat err =       0.000452151001
             autocorr =       1.259843101896
              std dev =       0.569692186653
             le_variance =       0.324549187534


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905807944216        initial
     3.5527e-01     3.5527e+00             6.0102e-04       -16.905809590775  <--
     1.4211e+00     1.4211e+01             2.0993e-04       -16.905808380414
     5.6843e+00     5.6843e+01             5.8033e-05       -16.905807480760

*****************************************************************************
Applying the update for shift_i =   3.5527e-01     and shift_s =   3.5527e+00
*****************************************************************************

  Execution time = 3.0753e+01
  </log>
  <optVariables href="H2O.s052.opt.xml">
   uu_0                 3.131006e-01 1 1  ON 0
   uu_1                 1.456161e-01 1 1  ON 1
   uu_2                 4.364257e-02 1 1  ON 2
   uu_3                -1.950530e-02 1 1  ON 3
   uu_4                -6.611615e-02 1 1  ON 4
   uu_5                -1.024325e-01 1 1  ON 5
   uu_6                -1.316137e-01 1 1  ON 6
   uu_7                -1.473598e-01 1 1  ON 7
   uu_8                -1.410616e-01 1 1  ON 8
   uu_9                -1.129359e-01 1 1  ON 9
   ud_0                 4.510834e-01 1 1  ON 10
   ud_1                 1.851455e-01 1 1  ON 11
   ud_2                 6.467749e-02 1 1  ON 12
   ud_3                -6.531291e-03 1 1  ON 13
   ud_4                -6.391515e-02 1 1  ON 14
   ud_5                -1.064916e-01 1 1  ON 15
   ud_6                -1.350162e-01 1 1  ON 16
   ud_7                -1.528343e-01 1 1  ON 17
   ud_8                -1.553172e-01 1 1  ON 18
   ud_9                -1.456149e-01 1 1  ON 19
   eO_0                -7.491838e-01 1 1  ON 20
   eO_1                -4.286140e-01 1 1  ON 21
   eO_2                -1.725968e-02 1 1  ON 22
   eO_3                 2.963614e-01 1 1  ON 23
   eO_4                 5.247805e-01 1 1  ON 24
   eO_5                 4.890015e-01 1 1  ON 25
   eO_6                 2.626503e-01 1 1  ON 26
   eO_7                -4.229843e-02 1 1  ON 27
   eO_8                -2.337467e-01 1 1  ON 28
   eO_9                -9.847963e-02 1 1  ON 29
  eH1_0                -2.641201e-01 1 1  ON 30
  eH1_1                -1.561863e-01 1 1  ON 31
  eH1_2                -1.064431e-01 1 1  ON 32
  eH1_3                -5.075955e-02 1 1  ON 33
  eH1_4                -5.357134e-04 1 1  ON 34
  eH1_5                 3.614652e-02 1 1  ON 35
  eH1_6                 9.830622e-02 1 1  ON 36
  eH1_7                 1.594226e-01 1 1  ON 37
  eH1_8                 1.941747e-01 1 1  ON 38
  eH1_9                 9.005513e-02 1 1  ON 39
  eH2_0                -2.625096e-01 1 1  ON 40
  eH2_1                -1.546533e-01 1 1  ON 41
  eH2_2                -1.044682e-01 1 1  ON 42
  eH2_3                -4.914703e-02 1 1  ON 43
  eH2_4                 1.476420e-03 1 1  ON 44
  eH2_5                 3.804770e-02 1 1  ON 45
  eH2_6                 1.000736e-01 1 1  ON 46
  eH2_7                 1.606235e-01 1 1  ON 47
  eH2_8                 1.984402e-01 1 1  ON 48
  eH2_9                 8.343715e-02 1 1  ON 49
ci_0001                 7.009511e-01 3 1  ON 50
ci_0002                 7.011206e-01 3 1  ON 51
ci_0003                -2.762595e-02 3 1  ON 52
ci_0004                -2.796381e-02 3 1  ON 53
ci_0005                -3.652464e-02 3 1  ON 54
ci_0006                -3.658928e-02 3 1  ON 55
ci_0007                -2.081901e-02 3 1  ON 56
ci_0008                -2.088928e-02 3 1  ON 57
ci_0009                -1.757828e-02 3 1  ON 58
ci_0010                -1.746049e-02 3 1  ON 59
ci_0011                -1.230245e-02 3 1  ON 60
ci_0012                -1.150986e-02 3 1  ON 61
ci_0013                 1.302921e-02 3 1  ON 62
ci_0014                 1.330415e-02 3 1  ON 63
ci_0015                 1.263387e-02 3 1  ON 64
ci_0016                 1.268848e-02 3 1  ON 65
ci_0017                 1.102478e-02 3 1  ON 66
ci_0018                 1.132007e-02 3 1  ON 67
ci_0019                 1.141607e-02 3 1  ON 68
ci_0020                 1.093242e-02 3 1  ON 69
ci_0021                -1.888914e-03 3 1  ON 70
ci_0022                -2.416908e-04 3 1  ON 71
ci_0023                -1.123083e-02 3 1  ON 72
ci_0024                -1.104257e-02 3 1  ON 73
ci_0025                -1.088178e-02 3 1  ON 74
ci_0026                -1.161533e-02 3 1  ON 75
ci_0027                -1.157721e-02 3 1  ON 76
ci_0028                -1.155558e-02 3 1  ON 77
ci_0029                -1.058237e-02 3 1  ON 78
ci_0030                -1.118806e-02 3 1  ON 79
ci_0031                 2.044465e-02 3 1  ON 80
ci_0032                 2.077734e-02 3 1  ON 81
ci_0033                 1.020121e-02 3 1  ON 82
ci_0034                 9.807886e-03 3 1  ON 83
ci_0035                 7.021358e-03 3 1  ON 84
ci_0036                 6.359885e-03 3 1  ON 85
ci_0037                -1.076607e-02 3 1  ON 86
ci_0038                -1.164372e-02 3 1  ON 87
ci_0039                -2.835296e-03 3 1  ON 88
ci_0040                -2.577758e-03 3 1  ON 89
ci_0041                 7.278020e-03 3 1  ON 90
ci_0042                 7.049757e-03 3 1  ON 91
ci_0043                -1.861432e-02 3 1  ON 92
ci_0044                -1.879557e-02 3 1  ON 93
ci_0045                 7.807991e-03 3 1  ON 94
ci_0046                 7.444916e-03 3 1  ON 95
ci_0047                -1.794336e-03 3 1  ON 96
ci_0048                -1.907046e-03 3 1  ON 97
ci_0049                -5.166342e-03 3 1  ON 98
ci_0050                -5.516227e-03 3 1  ON 99
ci_0051                -3.643240e-03 3 1  ON 100
ci_0052                -3.511946e-03 3 1  ON 101
ci_0053                -4.838481e-03 3 1  ON 102
ci_0054                -4.697377e-03 3 1  ON 103
ci_0055                 6.655222e-03 3 1  ON 104
ci_0056                 5.603623e-03 3 1  ON 105
ci_0057                 4.859273e-03 3 1  ON 106
ci_0058                 4.865231e-03 3 1  ON 107
ci_0059                -4.656947e-03 3 1  ON 108
ci_0060                -4.712876e-03 3 1  ON 109
ci_0061                -3.475138e-03 3 1  ON 110
ci_0062                -3.106185e-03 3 1  ON 111
ci_0063                -8.694971e-03 3 1  ON 112
ci_0064                -9.227896e-03 3 1  ON 113
ci_0065                -5.598476e-03 3 1  ON 114
ci_0066                -5.540507e-03 3 1  ON 115
ci_0067                -4.641580e-03 3 1  ON 116
ci_0068                -5.184881e-03 3 1  ON 117
ci_0069                 4.186106e-03 3 1  ON 118
ci_0070                 4.218204e-03 3 1  ON 119
ci_0071                 2.232894e-04 3 1  ON 120
ci_0072                -6.189689e-05 3 1  ON 121
ci_0073                 4.498591e-03 3 1  ON 122
ci_0074                 4.241431e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8002e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s053 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s053 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=53  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -16.864
    reference variance = 0.282957
====================================================
  Execution time = 2.1142e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s053
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5227e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3499e-01
  Total weights = 1.952093940e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9840e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323424901374
                                         uncertainty =       0.002209658485

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323424901374
                                         uncertainty =       0.002209658485

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402115409
  error estimate for blocks of size 2^( 2) =       0.000415409498
  error estimate for blocks of size 2^( 3) =       0.000428181603
  error estimate for blocks of size 2^( 4) =       0.000441093332
  error estimate for blocks of size 2^( 5) =       0.000451181722
  error estimate for blocks of size 2^( 6) =       0.000458758716
  error estimate for blocks of size 2^( 7) =       0.000464608080

      target function =                  N/A
              le_mean =     -16.905974492041
             les_mean =     286.146964650884
             stat err =       0.000453910462
             autocorr =       1.274203972972
              std dev =       0.568677065154
             le_variance =       0.323393604432


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690597449204e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.8818e-02, overlap shift 8.8818e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905974492040       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905989655799       residual = 2.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905990225047       residual = 9.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905986252897       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905987620802       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905987166144       residual = 7.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905984417034       residual = 8.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905983297662       residual = 4.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905983549203       residual = 3.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905985130064       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905986158069       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905986177126       residual = 9.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905986127895       residual = 4.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905986117960       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.905986217577       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.905986145078       residual = 6.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 8.8818e-02 is 2.004979e-03

solving harmonic davidson linear method for identity shift 3.5527e-01, overlap shift 3.5527e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905974492040       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905982399523       residual = 2.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905982774391       residual = 5.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905980676181       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905980854958       residual = 7.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905980285459       residual = 5.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905979423442       residual = 2.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905979227942       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905979432018       residual = 4.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905979564215       residual = 2.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905979817703       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905979874116       residual = 5.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.5527e-01 is 6.756749e-04

solving harmonic davidson linear method for identity shift 1.4211e+00, overlap shift 1.4211e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905974492040       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905977205551       residual = 2.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905977370880       residual = 3.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905976726738       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905976680625       residual = 6.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905976403302       residual = 3.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905976288652       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905976243815       residual = 4.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905976272557       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905976255929       residual = 5.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4211e+00 is 2.178803e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.494556 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7136e+01
  </log>
  <optVariables href="H2O.s053.opt.xml">
   uu_0                 3.135508e-01 1 1  ON 0
   uu_1                 1.457514e-01 1 1  ON 1
   uu_2                 4.361049e-02 1 1  ON 2
   uu_3                -1.954311e-02 1 1  ON 3
   uu_4                -6.613875e-02 1 1  ON 4
   uu_5                -1.025272e-01 1 1  ON 5
   uu_6                -1.315681e-01 1 1  ON 6
   uu_7                -1.474484e-01 1 1  ON 7
   uu_8                -1.412369e-01 1 1  ON 8
   uu_9                -1.133629e-01 1 1  ON 9
   ud_0                 4.513140e-01 1 1  ON 10
   ud_1                 1.853371e-01 1 1  ON 11
   ud_2                 6.496274e-02 1 1  ON 12
   ud_3                -6.391747e-03 1 1  ON 13
   ud_4                -6.383832e-02 1 1  ON 14
   ud_5                -1.064464e-01 1 1  ON 15
   ud_6                -1.349968e-01 1 1  ON 16
   ud_7                -1.527642e-01 1 1  ON 17
   ud_8                -1.555310e-01 1 1  ON 18
   ud_9                -1.460740e-01 1 1  ON 19
   eO_0                -7.492866e-01 1 1  ON 20
   eO_1                -4.284984e-01 1 1  ON 21
   eO_2                -1.686105e-02 1 1  ON 22
   eO_3                 2.966058e-01 1 1  ON 23
   eO_4                 5.249084e-01 1 1  ON 24
   eO_5                 4.889992e-01 1 1  ON 25
   eO_6                 2.627973e-01 1 1  ON 26
   eO_7                -4.219311e-02 1 1  ON 27
   eO_8                -2.341961e-01 1 1  ON 28
   eO_9                -9.898217e-02 1 1  ON 29
  eH1_0                -2.641568e-01 1 1  ON 30
  eH1_1                -1.562203e-01 1 1  ON 31
  eH1_2                -1.066239e-01 1 1  ON 32
  eH1_3                -5.094573e-02 1 1  ON 33
  eH1_4                -7.351118e-04 1 1  ON 34
  eH1_5                 3.604971e-02 1 1  ON 35
  eH1_6                 9.820826e-02 1 1  ON 36
  eH1_7                 1.595227e-01 1 1  ON 37
  eH1_8                 1.944893e-01 1 1  ON 38
  eH1_9                 9.047134e-02 1 1  ON 39
  eH2_0                -2.623698e-01 1 1  ON 40
  eH2_1                -1.548057e-01 1 1  ON 41
  eH2_2                -1.049559e-01 1 1  ON 42
  eH2_3                -4.911569e-02 1 1  ON 43
  eH2_4                 1.518892e-03 1 1  ON 44
  eH2_5                 3.810582e-02 1 1  ON 45
  eH2_6                 9.994451e-02 1 1  ON 46
  eH2_7                 1.607319e-01 1 1  ON 47
  eH2_8                 1.985466e-01 1 1  ON 48
  eH2_9                 8.375184e-02 1 1  ON 49
ci_0001                 7.009257e-01 3 1  ON 50
ci_0002                 7.011465e-01 3 1  ON 51
ci_0003                -2.753722e-02 3 1  ON 52
ci_0004                -2.764422e-02 3 1  ON 53
ci_0005                -3.628777e-02 3 1  ON 54
ci_0006                -3.644327e-02 3 1  ON 55
ci_0007                -2.094205e-02 3 1  ON 56
ci_0008                -2.139952e-02 3 1  ON 57
ci_0009                -1.726147e-02 3 1  ON 58
ci_0010                -1.757118e-02 3 1  ON 59
ci_0011                -1.229055e-02 3 1  ON 60
ci_0012                -1.206126e-02 3 1  ON 61
ci_0013                 1.337555e-02 3 1  ON 62
ci_0014                 1.323342e-02 3 1  ON 63
ci_0015                 1.293707e-02 3 1  ON 64
ci_0016                 1.283795e-02 3 1  ON 65
ci_0017                 1.099659e-02 3 1  ON 66
ci_0018                 1.101753e-02 3 1  ON 67
ci_0019                 1.155997e-02 3 1  ON 68
ci_0020                 1.128945e-02 3 1  ON 69
ci_0021                -1.673597e-03 3 1  ON 70
ci_0022                -3.669529e-04 3 1  ON 71
ci_0023                -1.130610e-02 3 1  ON 72
ci_0024                -1.099887e-02 3 1  ON 73
ci_0025                -1.073954e-02 3 1  ON 74
ci_0026                -1.153689e-02 3 1  ON 75
ci_0027                -1.105417e-02 3 1  ON 76
ci_0028                -1.148311e-02 3 1  ON 77
ci_0029                -1.057406e-02 3 1  ON 78
ci_0030                -1.073851e-02 3 1  ON 79
ci_0031                 2.071270e-02 3 1  ON 80
ci_0032                 2.087996e-02 3 1  ON 81
ci_0033                 1.076444e-02 3 1  ON 82
ci_0034                 9.846895e-03 3 1  ON 83
ci_0035                 6.939209e-03 3 1  ON 84
ci_0036                 6.730313e-03 3 1  ON 85
ci_0037                -1.089372e-02 3 1  ON 86
ci_0038                -1.110439e-02 3 1  ON 87
ci_0039                -2.528432e-03 3 1  ON 88
ci_0040                -2.701821e-03 3 1  ON 89
ci_0041                 6.727742e-03 3 1  ON 90
ci_0042                 7.218729e-03 3 1  ON 91
ci_0043                -1.854351e-02 3 1  ON 92
ci_0044                -1.877146e-02 3 1  ON 93
ci_0045                 7.831327e-03 3 1  ON 94
ci_0046                 7.308876e-03 3 1  ON 95
ci_0047                -1.914772e-03 3 1  ON 96
ci_0048                -1.973389e-03 3 1  ON 97
ci_0049                -5.324818e-03 3 1  ON 98
ci_0050                -5.297535e-03 3 1  ON 99
ci_0051                -3.708419e-03 3 1  ON 100
ci_0052                -3.543481e-03 3 1  ON 101
ci_0053                -4.677451e-03 3 1  ON 102
ci_0054                -4.725300e-03 3 1  ON 103
ci_0055                 7.039105e-03 3 1  ON 104
ci_0056                 6.279298e-03 3 1  ON 105
ci_0057                 5.094419e-03 3 1  ON 106
ci_0058                 5.351136e-03 3 1  ON 107
ci_0059                -4.393320e-03 3 1  ON 108
ci_0060                -4.959262e-03 3 1  ON 109
ci_0061                -3.222539e-03 3 1  ON 110
ci_0062                -3.419252e-03 3 1  ON 111
ci_0063                -8.390571e-03 3 1  ON 112
ci_0064                -9.068013e-03 3 1  ON 113
ci_0065                -5.664155e-03 3 1  ON 114
ci_0066                -5.292660e-03 3 1  ON 115
ci_0067                -4.771129e-03 3 1  ON 116
ci_0068                -5.130970e-03 3 1  ON 117
ci_0069                 4.586818e-03 3 1  ON 118
ci_0070                 4.463608e-03 3 1  ON 119
ci_0071                 2.063467e-04 3 1  ON 120
ci_0072                 3.174594e-04 3 1  ON 121
ci_0073                 4.567704e-03 3 1  ON 122
ci_0074                 4.294653e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -16.945
    reference variance = 0.391985
====================================================
  Execution time = 2.0886e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s053
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4176e-01
  Total weights = 1.9522e+06
  Execution time = 1.9400e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326529324348
                                         uncertainty =       0.003093810879

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326529324348
                                         uncertainty =       0.003093810879

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404096206
  error estimate for blocks of size 2^( 2) =       0.000417305091
  error estimate for blocks of size 2^( 3) =       0.000430434279
  error estimate for blocks of size 2^( 4) =       0.000442309040
  error estimate for blocks of size 2^( 5) =       0.000453256454
  error estimate for blocks of size 2^( 6) =       0.000461693171
  error estimate for blocks of size 2^( 7) =       0.000464489392

      target function =                  N/A
              le_mean =     -16.906529128008
             les_mean =     286.175085917835
             stat err =       0.000455437014
             autocorr =       1.270243851101
              std dev =       0.571478335395
             le_variance =       0.326587487826

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327469603294
                                         uncertainty =       0.003113103768

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327469603294
                                         uncertainty =       0.003113103768

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404676316
  error estimate for blocks of size 2^( 2) =       0.000417856620
  error estimate for blocks of size 2^( 3) =       0.000430938330
  error estimate for blocks of size 2^( 4) =       0.000442765102
  error estimate for blocks of size 2^( 5) =       0.000453690867
  error estimate for blocks of size 2^( 6) =       0.000462098937
  error estimate for blocks of size 2^( 7) =       0.000464840802

      target function =                  N/A
              le_mean =     -16.906526645135
             les_mean =     286.177439984398
             stat err =       0.000455848927
             autocorr =       1.268896789981
              std dev =       0.572298734324
             le_variance =       0.327525841309

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327470705094
                                         uncertainty =       0.003116049785

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327470705094
                                         uncertainty =       0.003116049785

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404676871
  error estimate for blocks of size 2^( 2) =       0.000417863234
  error estimate for blocks of size 2^( 3) =       0.000430954067
  error estimate for blocks of size 2^( 4) =       0.000442789472
  error estimate for blocks of size 2^( 5) =       0.000453718364
  error estimate for blocks of size 2^( 6) =       0.000462117277
  error estimate for blocks of size 2^( 7) =       0.000464874611

      target function =                  N/A
              le_mean =     -16.906526098575
             les_mean =     286.181902119540
             stat err =       0.000455874931
             autocorr =       1.269038079047
              std dev =       0.572299520009
             le_variance =       0.327526740603

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326643071785
                                         uncertainty =       0.003096822699

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326643071785
                                         uncertainty =       0.003096822699

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404166352
  error estimate for blocks of size 2^( 2) =       0.000417370858
  error estimate for blocks of size 2^( 3) =       0.000430493998
  error estimate for blocks of size 2^( 4) =       0.000442361208
  error estimate for blocks of size 2^( 5) =       0.000453308634
  error estimate for blocks of size 2^( 6) =       0.000461736685
  error estimate for blocks of size 2^( 7) =       0.000464527195

      target function =                  N/A
              le_mean =     -16.906524766284
             les_mean =     286.193907740926
             stat err =       0.000455483431
             autocorr =       1.270061807977
              std dev =       0.571577536959
             le_variance =       0.326700880756


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906529128008        initial  <--
     8.8818e-02     8.8818e-01             2.0050e-03       -16.906526645135
     3.5527e-01     3.5527e+00             6.7567e-04       -16.906526098575
     1.4211e+00     1.4211e+01             2.1788e-04       -16.906524766284

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.5993
  </log>
  <optVariables href="H2O.s053.opt.xml">
   uu_0                 3.131006e-01 1 1  ON 0
   uu_1                 1.456161e-01 1 1  ON 1
   uu_2                 4.364257e-02 1 1  ON 2
   uu_3                -1.950530e-02 1 1  ON 3
   uu_4                -6.611615e-02 1 1  ON 4
   uu_5                -1.024325e-01 1 1  ON 5
   uu_6                -1.316137e-01 1 1  ON 6
   uu_7                -1.473598e-01 1 1  ON 7
   uu_8                -1.410616e-01 1 1  ON 8
   uu_9                -1.129359e-01 1 1  ON 9
   ud_0                 4.510834e-01 1 1  ON 10
   ud_1                 1.851455e-01 1 1  ON 11
   ud_2                 6.467749e-02 1 1  ON 12
   ud_3                -6.531291e-03 1 1  ON 13
   ud_4                -6.391515e-02 1 1  ON 14
   ud_5                -1.064916e-01 1 1  ON 15
   ud_6                -1.350162e-01 1 1  ON 16
   ud_7                -1.528343e-01 1 1  ON 17
   ud_8                -1.553172e-01 1 1  ON 18
   ud_9                -1.456149e-01 1 1  ON 19
   eO_0                -7.491838e-01 1 1  ON 20
   eO_1                -4.286140e-01 1 1  ON 21
   eO_2                -1.725968e-02 1 1  ON 22
   eO_3                 2.963614e-01 1 1  ON 23
   eO_4                 5.247805e-01 1 1  ON 24
   eO_5                 4.890015e-01 1 1  ON 25
   eO_6                 2.626503e-01 1 1  ON 26
   eO_7                -4.229843e-02 1 1  ON 27
   eO_8                -2.337467e-01 1 1  ON 28
   eO_9                -9.847963e-02 1 1  ON 29
  eH1_0                -2.641201e-01 1 1  ON 30
  eH1_1                -1.561863e-01 1 1  ON 31
  eH1_2                -1.064431e-01 1 1  ON 32
  eH1_3                -5.075955e-02 1 1  ON 33
  eH1_4                -5.357134e-04 1 1  ON 34
  eH1_5                 3.614652e-02 1 1  ON 35
  eH1_6                 9.830622e-02 1 1  ON 36
  eH1_7                 1.594226e-01 1 1  ON 37
  eH1_8                 1.941747e-01 1 1  ON 38
  eH1_9                 9.005513e-02 1 1  ON 39
  eH2_0                -2.625096e-01 1 1  ON 40
  eH2_1                -1.546533e-01 1 1  ON 41
  eH2_2                -1.044682e-01 1 1  ON 42
  eH2_3                -4.914703e-02 1 1  ON 43
  eH2_4                 1.476420e-03 1 1  ON 44
  eH2_5                 3.804770e-02 1 1  ON 45
  eH2_6                 1.000736e-01 1 1  ON 46
  eH2_7                 1.606235e-01 1 1  ON 47
  eH2_8                 1.984402e-01 1 1  ON 48
  eH2_9                 8.343715e-02 1 1  ON 49
ci_0001                 7.009511e-01 3 1  ON 50
ci_0002                 7.011206e-01 3 1  ON 51
ci_0003                -2.762595e-02 3 1  ON 52
ci_0004                -2.796381e-02 3 1  ON 53
ci_0005                -3.652464e-02 3 1  ON 54
ci_0006                -3.658928e-02 3 1  ON 55
ci_0007                -2.081901e-02 3 1  ON 56
ci_0008                -2.088928e-02 3 1  ON 57
ci_0009                -1.757828e-02 3 1  ON 58
ci_0010                -1.746049e-02 3 1  ON 59
ci_0011                -1.230245e-02 3 1  ON 60
ci_0012                -1.150986e-02 3 1  ON 61
ci_0013                 1.302921e-02 3 1  ON 62
ci_0014                 1.330415e-02 3 1  ON 63
ci_0015                 1.263387e-02 3 1  ON 64
ci_0016                 1.268848e-02 3 1  ON 65
ci_0017                 1.102478e-02 3 1  ON 66
ci_0018                 1.132007e-02 3 1  ON 67
ci_0019                 1.141607e-02 3 1  ON 68
ci_0020                 1.093242e-02 3 1  ON 69
ci_0021                -1.888914e-03 3 1  ON 70
ci_0022                -2.416908e-04 3 1  ON 71
ci_0023                -1.123083e-02 3 1  ON 72
ci_0024                -1.104257e-02 3 1  ON 73
ci_0025                -1.088178e-02 3 1  ON 74
ci_0026                -1.161533e-02 3 1  ON 75
ci_0027                -1.157721e-02 3 1  ON 76
ci_0028                -1.155558e-02 3 1  ON 77
ci_0029                -1.058237e-02 3 1  ON 78
ci_0030                -1.118806e-02 3 1  ON 79
ci_0031                 2.044465e-02 3 1  ON 80
ci_0032                 2.077734e-02 3 1  ON 81
ci_0033                 1.020121e-02 3 1  ON 82
ci_0034                 9.807886e-03 3 1  ON 83
ci_0035                 7.021358e-03 3 1  ON 84
ci_0036                 6.359885e-03 3 1  ON 85
ci_0037                -1.076607e-02 3 1  ON 86
ci_0038                -1.164372e-02 3 1  ON 87
ci_0039                -2.835296e-03 3 1  ON 88
ci_0040                -2.577758e-03 3 1  ON 89
ci_0041                 7.278020e-03 3 1  ON 90
ci_0042                 7.049757e-03 3 1  ON 91
ci_0043                -1.861432e-02 3 1  ON 92
ci_0044                -1.879557e-02 3 1  ON 93
ci_0045                 7.807991e-03 3 1  ON 94
ci_0046                 7.444916e-03 3 1  ON 95
ci_0047                -1.794336e-03 3 1  ON 96
ci_0048                -1.907046e-03 3 1  ON 97
ci_0049                -5.166342e-03 3 1  ON 98
ci_0050                -5.516227e-03 3 1  ON 99
ci_0051                -3.643240e-03 3 1  ON 100
ci_0052                -3.511946e-03 3 1  ON 101
ci_0053                -4.838481e-03 3 1  ON 102
ci_0054                -4.697377e-03 3 1  ON 103
ci_0055                 6.655222e-03 3 1  ON 104
ci_0056                 5.603623e-03 3 1  ON 105
ci_0057                 4.859273e-03 3 1  ON 106
ci_0058                 4.865231e-03 3 1  ON 107
ci_0059                -4.656947e-03 3 1  ON 108
ci_0060                -4.712876e-03 3 1  ON 109
ci_0061                -3.475138e-03 3 1  ON 110
ci_0062                -3.106185e-03 3 1  ON 111
ci_0063                -8.694971e-03 3 1  ON 112
ci_0064                -9.227896e-03 3 1  ON 113
ci_0065                -5.598476e-03 3 1  ON 114
ci_0066                -5.540507e-03 3 1  ON 115
ci_0067                -4.641580e-03 3 1  ON 116
ci_0068                -5.184881e-03 3 1  ON 117
ci_0069                 4.186106e-03 3 1  ON 118
ci_0070                 4.218204e-03 3 1  ON 119
ci_0071                 2.232894e-04 3 1  ON 120
ci_0072                -6.189689e-05 3 1  ON 121
ci_0073                 4.498591e-03 3 1  ON 122
ci_0074                 4.241431e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7742e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s054 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s054 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=54  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -16.9007
    reference variance = 0.23952
====================================================
  Execution time = 2.1138e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s054
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5266e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4594e-01
  Total weights = 1.951954271e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0199e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331380492375
                                         uncertainty =       0.003414001250

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331380492375
                                         uncertainty =       0.003414001250

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407024928
  error estimate for blocks of size 2^( 2) =       0.000419722693
  error estimate for blocks of size 2^( 3) =       0.000432196728
  error estimate for blocks of size 2^( 4) =       0.000443725835
  error estimate for blocks of size 2^( 5) =       0.000454538285
  error estimate for blocks of size 2^( 6) =       0.000462793237
  error estimate for blocks of size 2^( 7) =       0.000468400978

      target function =                  N/A
              le_mean =     -16.906315234288
             les_mean =     286.169434626257
             stat err =       0.000457364584
             autocorr =       1.262650185094
              std dev =       0.575620173752
             le_variance =       0.331338584430


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690631523429e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.8818e-01, overlap shift 8.8818e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906315234271       residual = 2.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906323302288       residual = 2.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906320958412       residual = 3.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906320490197       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906320676716       residual = 4.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906320092250       residual = 1.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906320326274       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906320184720       residual = 4.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906320272095       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906320298910       residual = 7.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 8.8818e-01 is 6.622426e-04

solving harmonic davidson linear method for identity shift 3.5527e+00, overlap shift 3.5527e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906315234271       residual = 2.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906317602342       residual = 2.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906316959621       residual = 3.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906316855913       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906316889328       residual = 4.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906316688216       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906316745862       residual = 9.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906316724040       residual = 2.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906316747332       residual = 7.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.5527e+00 is 1.925886e-04

solving harmonic davidson linear method for identity shift 1.4211e+01, overlap shift 1.4211e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906315234271       residual = 2.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906315853221       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906315688250       residual = 3.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906315664772       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906315673560       residual = 4.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906315617894       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906315629300       residual = 8.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906315626626       residual = 2.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906315632126       residual = 5.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4211e+01 is 5.013641e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.498139 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7166e+01
  </log>
  <optVariables href="H2O.s054.opt.xml">
   uu_0                 3.130609e-01 1 1  ON 0
   uu_1                 1.456546e-01 1 1  ON 1
   uu_2                 4.363014e-02 1 1  ON 2
   uu_3                -1.949592e-02 1 1  ON 3
   uu_4                -6.612196e-02 1 1  ON 4
   uu_5                -1.024246e-01 1 1  ON 5
   uu_6                -1.316308e-01 1 1  ON 6
   uu_7                -1.473748e-01 1 1  ON 7
   uu_8                -1.410557e-01 1 1  ON 8
   uu_9                -1.129274e-01 1 1  ON 9
   ud_0                 4.510714e-01 1 1  ON 10
   ud_1                 1.851899e-01 1 1  ON 11
   ud_2                 6.468805e-02 1 1  ON 12
   ud_3                -6.529877e-03 1 1  ON 13
   ud_4                -6.392332e-02 1 1  ON 14
   ud_5                -1.064876e-01 1 1  ON 15
   ud_6                -1.350230e-01 1 1  ON 16
   ud_7                -1.528430e-01 1 1  ON 17
   ud_8                -1.553088e-01 1 1  ON 18
   ud_9                -1.456168e-01 1 1  ON 19
   eO_0                -7.492190e-01 1 1  ON 20
   eO_1                -4.285965e-01 1 1  ON 21
   eO_2                -1.720857e-02 1 1  ON 22
   eO_3                 2.963992e-01 1 1  ON 23
   eO_4                 5.247742e-01 1 1  ON 24
   eO_5                 4.890025e-01 1 1  ON 25
   eO_6                 2.626381e-01 1 1  ON 26
   eO_7                -4.229555e-02 1 1  ON 27
   eO_8                -2.337621e-01 1 1  ON 28
   eO_9                -9.851231e-02 1 1  ON 29
  eH1_0                -2.641161e-01 1 1  ON 30
  eH1_1                -1.562200e-01 1 1  ON 31
  eH1_2                -1.064949e-01 1 1  ON 32
  eH1_3                -5.076012e-02 1 1  ON 33
  eH1_4                -5.316586e-04 1 1  ON 34
  eH1_5                 3.614186e-02 1 1  ON 35
  eH1_6                 9.829743e-02 1 1  ON 36
  eH1_7                 1.594376e-01 1 1  ON 37
  eH1_8                 1.942055e-01 1 1  ON 38
  eH1_9                 9.009876e-02 1 1  ON 39
  eH2_0                -2.625093e-01 1 1  ON 40
  eH2_1                -1.546806e-01 1 1  ON 41
  eH2_2                -1.044889e-01 1 1  ON 42
  eH2_3                -4.914048e-02 1 1  ON 43
  eH2_4                 1.480943e-03 1 1  ON 44
  eH2_5                 3.804413e-02 1 1  ON 45
  eH2_6                 1.000757e-01 1 1  ON 46
  eH2_7                 1.606151e-01 1 1  ON 47
  eH2_8                 1.984419e-01 1 1  ON 48
  eH2_9                 8.347818e-02 1 1  ON 49
ci_0001                 7.009406e-01 3 1  ON 50
ci_0002                 7.011302e-01 3 1  ON 51
ci_0003                -2.761193e-02 3 1  ON 52
ci_0004                -2.796595e-02 3 1  ON 53
ci_0005                -3.651127e-02 3 1  ON 54
ci_0006                -3.663356e-02 3 1  ON 55
ci_0007                -2.086144e-02 3 1  ON 56
ci_0008                -2.082142e-02 3 1  ON 57
ci_0009                -1.752746e-02 3 1  ON 58
ci_0010                -1.749610e-02 3 1  ON 59
ci_0011                -1.232019e-02 3 1  ON 60
ci_0012                -1.145190e-02 3 1  ON 61
ci_0013                 1.302237e-02 3 1  ON 62
ci_0014                 1.330960e-02 3 1  ON 63
ci_0015                 1.261819e-02 3 1  ON 64
ci_0016                 1.265391e-02 3 1  ON 65
ci_0017                 1.103391e-02 3 1  ON 66
ci_0018                 1.126465e-02 3 1  ON 67
ci_0019                 1.140896e-02 3 1  ON 68
ci_0020                 1.093711e-02 3 1  ON 69
ci_0021                -1.876682e-03 3 1  ON 70
ci_0022                -2.508682e-04 3 1  ON 71
ci_0023                -1.123120e-02 3 1  ON 72
ci_0024                -1.100938e-02 3 1  ON 73
ci_0025                -1.085756e-02 3 1  ON 74
ci_0026                -1.165035e-02 3 1  ON 75
ci_0027                -1.157633e-02 3 1  ON 76
ci_0028                -1.160732e-02 3 1  ON 77
ci_0029                -1.055501e-02 3 1  ON 78
ci_0030                -1.111608e-02 3 1  ON 79
ci_0031                 2.044196e-02 3 1  ON 80
ci_0032                 2.080090e-02 3 1  ON 81
ci_0033                 1.020427e-02 3 1  ON 82
ci_0034                 9.785578e-03 3 1  ON 83
ci_0035                 7.060027e-03 3 1  ON 84
ci_0036                 6.356736e-03 3 1  ON 85
ci_0037                -1.081248e-02 3 1  ON 86
ci_0038                -1.164432e-02 3 1  ON 87
ci_0039                -2.806377e-03 3 1  ON 88
ci_0040                -2.519169e-03 3 1  ON 89
ci_0041                 7.231017e-03 3 1  ON 90
ci_0042                 7.046455e-03 3 1  ON 91
ci_0043                -1.862279e-02 3 1  ON 92
ci_0044                -1.881054e-02 3 1  ON 93
ci_0045                 7.834174e-03 3 1  ON 94
ci_0046                 7.465280e-03 3 1  ON 95
ci_0047                -1.718743e-03 3 1  ON 96
ci_0048                -1.892087e-03 3 1  ON 97
ci_0049                -5.163268e-03 3 1  ON 98
ci_0050                -5.394508e-03 3 1  ON 99
ci_0051                -3.628287e-03 3 1  ON 100
ci_0052                -3.481168e-03 3 1  ON 101
ci_0053                -4.809468e-03 3 1  ON 102
ci_0054                -4.703464e-03 3 1  ON 103
ci_0055                 6.674957e-03 3 1  ON 104
ci_0056                 5.704290e-03 3 1  ON 105
ci_0057                 4.978844e-03 3 1  ON 106
ci_0058                 4.857256e-03 3 1  ON 107
ci_0059                -4.641735e-03 3 1  ON 108
ci_0060                -4.722344e-03 3 1  ON 109
ci_0061                -3.667727e-03 3 1  ON 110
ci_0062                -3.110659e-03 3 1  ON 111
ci_0063                -8.750769e-03 3 1  ON 112
ci_0064                -9.270694e-03 3 1  ON 113
ci_0065                -5.632961e-03 3 1  ON 114
ci_0066                -5.534092e-03 3 1  ON 115
ci_0067                -4.686883e-03 3 1  ON 116
ci_0068                -5.149936e-03 3 1  ON 117
ci_0069                 4.235212e-03 3 1  ON 118
ci_0070                 4.201205e-03 3 1  ON 119
ci_0071                 2.015650e-04 3 1  ON 120
ci_0072                 2.027054e-06 3 1  ON 121
ci_0073                 4.464001e-03 3 1  ON 122
ci_0074                 4.248192e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -16.9562
    reference variance = 0.347794
====================================================
  Execution time = 2.1103e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s054
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4356e-01
  Total weights = 1.9519e+06
  Execution time = 1.9216e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325527430088
                                         uncertainty =       0.002629908718

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325527430088
                                         uncertainty =       0.002629908718

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403398175
  error estimate for blocks of size 2^( 2) =       0.000416306600
  error estimate for blocks of size 2^( 3) =       0.000429932020
  error estimate for blocks of size 2^( 4) =       0.000441595630
  error estimate for blocks of size 2^( 5) =       0.000452851509
  error estimate for blocks of size 2^( 6) =       0.000459964521
  error estimate for blocks of size 2^( 7) =       0.000464539465

      target function =                  N/A
              le_mean =     -16.906035419620
             les_mean =     286.160305093322
             stat err =       0.000454737781
             autocorr =       1.270732737620
              std dev =       0.570491169864
             le_variance =       0.325460174892

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325482889739
                                         uncertainty =       0.002627585097

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325482889739
                                         uncertainty =       0.002627585097

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403370862
  error estimate for blocks of size 2^( 2) =       0.000416286610
  error estimate for blocks of size 2^( 3) =       0.000429906336
  error estimate for blocks of size 2^( 4) =       0.000441563749
  error estimate for blocks of size 2^( 5) =       0.000452821278
  error estimate for blocks of size 2^( 6) =       0.000459933563
  error estimate for blocks of size 2^( 7) =       0.000464475647

      target function =                  N/A
              le_mean =     -16.906039550626
             les_mean =     286.157614274156
             stat err =       0.000454698560
             autocorr =       1.270685607349
              std dev =       0.570452543389
             le_variance =       0.325416104259

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325470376954
                                         uncertainty =       0.002627743774

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325470376954
                                         uncertainty =       0.002627743774

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403362998
  error estimate for blocks of size 2^( 2) =       0.000416276094
  error estimate for blocks of size 2^( 3) =       0.000429898628
  error estimate for blocks of size 2^( 4) =       0.000441559322
  error estimate for blocks of size 2^( 5) =       0.000452816778
  error estimate for blocks of size 2^( 6) =       0.000459928877
  error estimate for blocks of size 2^( 7) =       0.000464483777

      target function =                  N/A
              le_mean =     -16.906036715200
             les_mean =     286.157549580642
             stat err =       0.000454697189
             autocorr =       1.270727489578
              std dev =       0.570441422471
             le_variance =       0.325403416470

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325517169840
                                         uncertainty =       0.002629510785

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325517169840
                                         uncertainty =       0.002629510785

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403391843
  error estimate for blocks of size 2^( 2) =       0.000416300809
  error estimate for blocks of size 2^( 3) =       0.000429925742
  error estimate for blocks of size 2^( 4) =       0.000441589219
  error estimate for blocks of size 2^( 5) =       0.000452845055
  error estimate for blocks of size 2^( 6) =       0.000459956988
  error estimate for blocks of size 2^( 7) =       0.000464529708

      target function =                  N/A
              le_mean =     -16.906035154499
             les_mean =     286.158009376660
             stat err =       0.000454730242
             autocorr =       1.270730496856
              std dev =       0.570482215108
             le_variance =       0.325449957755


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906035419620        initial
     8.8818e-01     8.8818e+00             6.6224e-04       -16.906039550626  <--
     3.5527e+00     3.5527e+01             1.9259e-04       -16.906036715200
     1.4211e+01     1.4211e+02             5.0136e-05       -16.906035154499

*****************************************************************************
Applying the update for shift_i =   8.8818e-01     and shift_s =   8.8818e+00
*****************************************************************************

  Execution time = 3.0798e+01
  </log>
  <optVariables href="H2O.s054.opt.xml">
   uu_0                 3.129782e-01 1 1  ON 0
   uu_1                 1.457398e-01 1 1  ON 1
   uu_2                 4.361105e-02 1 1  ON 2
   uu_3                -1.947917e-02 1 1  ON 3
   uu_4                -6.613009e-02 1 1  ON 4
   uu_5                -1.024141e-01 1 1  ON 5
   uu_6                -1.316811e-01 1 1  ON 6
   uu_7                -1.474228e-01 1 1  ON 7
   uu_8                -1.410442e-01 1 1  ON 8
   uu_9                -1.129038e-01 1 1  ON 9
   ud_0                 4.510843e-01 1 1  ON 10
   ud_1                 1.852871e-01 1 1  ON 11
   ud_2                 6.471740e-02 1 1  ON 12
   ud_3                -6.532748e-03 1 1  ON 13
   ud_4                -6.394106e-02 1 1  ON 14
   ud_5                -1.064806e-01 1 1  ON 15
   ud_6                -1.350388e-01 1 1  ON 16
   ud_7                -1.528687e-01 1 1  ON 17
   ud_8                -1.552886e-01 1 1  ON 18
   ud_9                -1.456246e-01 1 1  ON 19
   eO_0                -7.492863e-01 1 1  ON 20
   eO_1                -4.285553e-01 1 1  ON 21
   eO_2                -1.707747e-02 1 1  ON 22
   eO_3                 2.965083e-01 1 1  ON 23
   eO_4                 5.247588e-01 1 1  ON 24
   eO_5                 4.890062e-01 1 1  ON 25
   eO_6                 2.626035e-01 1 1  ON 26
   eO_7                -4.228733e-02 1 1  ON 27
   eO_8                -2.338104e-01 1 1  ON 28
   eO_9                -9.861320e-02 1 1  ON 29
  eH1_0                -2.641120e-01 1 1  ON 30
  eH1_1                -1.563228e-01 1 1  ON 31
  eH1_2                -1.066217e-01 1 1  ON 32
  eH1_3                -5.078007e-02 1 1  ON 33
  eH1_4                -5.232416e-04 1 1  ON 34
  eH1_5                 3.612737e-02 1 1  ON 35
  eH1_6                 9.827012e-02 1 1  ON 36
  eH1_7                 1.594820e-01 1 1  ON 37
  eH1_8                 1.942992e-01 1 1  ON 38
  eH1_9                 9.023271e-02 1 1  ON 39
  eH2_0                -2.625110e-01 1 1  ON 40
  eH2_1                -1.547552e-01 1 1  ON 41
  eH2_2                -1.045364e-01 1 1  ON 42
  eH2_3                -4.913320e-02 1 1  ON 43
  eH2_4                 1.490034e-03 1 1  ON 44
  eH2_5                 3.802892e-02 1 1  ON 45
  eH2_6                 1.000810e-01 1 1  ON 46
  eH2_7                 1.605900e-01 1 1  ON 47
  eH2_8                 1.984471e-01 1 1  ON 48
  eH2_9                 8.360408e-02 1 1  ON 49
ci_0001                 7.009103e-01 3 1  ON 50
ci_0002                 7.011574e-01 3 1  ON 51
ci_0003                -2.757400e-02 3 1  ON 52
ci_0004                -2.796986e-02 3 1  ON 53
ci_0005                -3.647523e-02 3 1  ON 54
ci_0006                -3.675405e-02 3 1  ON 55
ci_0007                -2.097661e-02 3 1  ON 56
ci_0008                -2.063644e-02 3 1  ON 57
ci_0009                -1.740781e-02 3 1  ON 58
ci_0010                -1.758047e-02 3 1  ON 59
ci_0011                -1.236285e-02 3 1  ON 60
ci_0012                -1.131240e-02 3 1  ON 61
ci_0013                 1.300629e-02 3 1  ON 62
ci_0014                 1.332271e-02 3 1  ON 63
ci_0015                 1.258140e-02 3 1  ON 64
ci_0016                 1.256832e-02 3 1  ON 65
ci_0017                 1.105587e-02 3 1  ON 66
ci_0018                 1.113411e-02 3 1  ON 67
ci_0019                 1.139261e-02 3 1  ON 68
ci_0020                 1.095213e-02 3 1  ON 69
ci_0021                -1.844814e-03 3 1  ON 70
ci_0022                -2.774526e-04 3 1  ON 71
ci_0023                -1.123247e-02 3 1  ON 72
ci_0024                -1.093503e-02 3 1  ON 73
ci_0025                -1.079834e-02 3 1  ON 74
ci_0026                -1.173246e-02 3 1  ON 75
ci_0027                -1.157738e-02 3 1  ON 76
ci_0028                -1.173396e-02 3 1  ON 77
ci_0029                -1.049232e-02 3 1  ON 78
ci_0030                -1.094364e-02 3 1  ON 79
ci_0031                 2.043610e-02 3 1  ON 80
ci_0032                 2.086414e-02 3 1  ON 81
ci_0033                 1.021300e-02 3 1  ON 82
ci_0034                 9.726921e-03 3 1  ON 83
ci_0035                 7.153951e-03 3 1  ON 84
ci_0036                 6.349837e-03 3 1  ON 85
ci_0037                -1.092885e-02 3 1  ON 86
ci_0038                -1.164356e-02 3 1  ON 87
ci_0039                -2.743508e-03 3 1  ON 88
ci_0040                -2.393212e-03 3 1  ON 89
ci_0041                 7.115800e-03 3 1  ON 90
ci_0042                 7.038819e-03 3 1  ON 91
ci_0043                -1.864476e-02 3 1  ON 92
ci_0044                -1.885075e-02 3 1  ON 93
ci_0045                 7.901308e-03 3 1  ON 94
ci_0046                 7.518133e-03 3 1  ON 95
ci_0047                -1.554815e-03 3 1  ON 96
ci_0048                -1.858288e-03 3 1  ON 97
ci_0049                -5.155785e-03 3 1  ON 98
ci_0050                -5.101823e-03 3 1  ON 99
ci_0051                -3.595284e-03 3 1  ON 100
ci_0052                -3.415689e-03 3 1  ON 101
ci_0053                -4.742255e-03 3 1  ON 102
ci_0054                -4.719054e-03 3 1  ON 103
ci_0055                 6.726242e-03 3 1  ON 104
ci_0056                 5.957592e-03 3 1  ON 105
ci_0057                 5.275175e-03 3 1  ON 106
ci_0058                 4.838158e-03 3 1  ON 107
ci_0059                -4.608465e-03 3 1  ON 108
ci_0060                -4.745578e-03 3 1  ON 109
ci_0061                -4.137381e-03 3 1  ON 110
ci_0062                -3.121048e-03 3 1  ON 111
ci_0063                -8.874942e-03 3 1  ON 112
ci_0064                -9.366794e-03 3 1  ON 113
ci_0065                -5.713822e-03 3 1  ON 114
ci_0066                -5.519121e-03 3 1  ON 115
ci_0067                -4.784548e-03 3 1  ON 116
ci_0068                -5.074333e-03 3 1  ON 117
ci_0069                 4.340590e-03 3 1  ON 118
ci_0070                 4.163287e-03 3 1  ON 119
ci_0071                 1.491334e-04 3 1  ON 120
ci_0072                 1.529494e-04 3 1  ON 121
ci_0073                 4.388398e-03 3 1  ON 122
ci_0074                 4.263458e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7971e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s055 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s055 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=55  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -16.8446
    reference variance = 0.365909
====================================================
  Execution time = 2.1159e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s055
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5258e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4240e-01
  Total weights = 1.951645872e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1904e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324882039630
                                         uncertainty =       0.002781797796

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324882039630
                                         uncertainty =       0.002781797796

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403091787
  error estimate for blocks of size 2^( 2) =       0.000416020394
  error estimate for blocks of size 2^( 3) =       0.000428971355
  error estimate for blocks of size 2^( 4) =       0.000441571288
  error estimate for blocks of size 2^( 5) =       0.000453580614
  error estimate for blocks of size 2^( 6) =       0.000462622731
  error estimate for blocks of size 2^( 7) =       0.000469833941

      target function =                  N/A
              le_mean =     -16.905252390330
             les_mean =     286.129960415663
             stat err =       0.000456902144
             autocorr =       1.284808772365
              std dev =       0.570057871443
             le_variance =       0.324965976794


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690525239033e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e-01, overlap shift 2.2204e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905252390315       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905268974365       residual = 7.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905270394027       residual = 5.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905269600872       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905271157719       residual = 6.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905269789030       residual = 4.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905269314961       residual = 2.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905270059241       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905270021429       residual = 8.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905269784629       residual = 4.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905270006537       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905269986837       residual = 6.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.2204e-01 is 1.084227e-03

solving harmonic davidson linear method for identity shift 8.8818e-01, overlap shift 8.8818e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905252390315       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905258791612       residual = 7.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905259020425       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905258604430       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905259053316       residual = 4.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905258501263       residual = 2.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905258516843       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905258604506       residual = 5.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905258616387       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905258583478       residual = 6.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 8.8818e-01 is 3.708315e-04

solving harmonic davidson linear method for identity shift 3.5527e+00, overlap shift 3.5527e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905252390315       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905254242521       residual = 8.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905254276026       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905254154063       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905254263408       residual = 4.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905254106516       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905254105380       residual = 8.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905254122516       residual = 3.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905254120080       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905254127677       residual = 3.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.5527e+00 is 1.033838e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.502573 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7358e+01
  </log>
  <optVariables href="H2O.s055.opt.xml">
   uu_0                 3.131341e-01 1 1  ON 0
   uu_1                 1.458022e-01 1 1  ON 1
   uu_2                 4.357281e-02 1 1  ON 2
   uu_3                -1.949446e-02 1 1  ON 3
   uu_4                -6.620769e-02 1 1  ON 4
   uu_5                -1.024831e-01 1 1  ON 5
   uu_6                -1.317546e-01 1 1  ON 6
   uu_7                -1.474274e-01 1 1  ON 7
   uu_8                -1.410574e-01 1 1  ON 8
   uu_9                -1.129612e-01 1 1  ON 9
   ud_0                 4.511779e-01 1 1  ON 10
   ud_1                 1.853790e-01 1 1  ON 11
   ud_2                 6.482869e-02 1 1  ON 12
   ud_3                -6.454113e-03 1 1  ON 13
   ud_4                -6.393397e-02 1 1  ON 14
   ud_5                -1.064424e-01 1 1  ON 15
   ud_6                -1.349998e-01 1 1  ON 16
   ud_7                -1.529229e-01 1 1  ON 17
   ud_8                -1.554520e-01 1 1  ON 18
   ud_9                -1.457457e-01 1 1  ON 19
   eO_0                -7.491989e-01 1 1  ON 20
   eO_1                -4.285630e-01 1 1  ON 21
   eO_2                -1.705904e-02 1 1  ON 22
   eO_3                 2.966274e-01 1 1  ON 23
   eO_4                 5.248170e-01 1 1  ON 24
   eO_5                 4.890945e-01 1 1  ON 25
   eO_6                 2.626061e-01 1 1  ON 26
   eO_7                -4.234461e-02 1 1  ON 27
   eO_8                -2.339435e-01 1 1  ON 28
   eO_9                -9.876372e-02 1 1  ON 29
  eH1_0                -2.640673e-01 1 1  ON 30
  eH1_1                -1.564004e-01 1 1  ON 31
  eH1_2                -1.067937e-01 1 1  ON 32
  eH1_3                -5.085707e-02 1 1  ON 33
  eH1_4                -5.066011e-04 1 1  ON 34
  eH1_5                 3.613432e-02 1 1  ON 35
  eH1_6                 9.826966e-02 1 1  ON 36
  eH1_7                 1.594403e-01 1 1  ON 37
  eH1_8                 1.943863e-01 1 1  ON 38
  eH1_9                 9.041876e-02 1 1  ON 39
  eH2_0                -2.625684e-01 1 1  ON 40
  eH2_1                -1.547646e-01 1 1  ON 41
  eH2_2                -1.045736e-01 1 1  ON 42
  eH2_3                -4.911530e-02 1 1  ON 43
  eH2_4                 1.460159e-03 1 1  ON 44
  eH2_5                 3.792039e-02 1 1  ON 45
  eH2_6                 1.000451e-01 1 1  ON 46
  eH2_7                 1.606091e-01 1 1  ON 47
  eH2_8                 1.984852e-01 1 1  ON 48
  eH2_9                 8.378079e-02 1 1  ON 49
ci_0001                 7.009806e-01 3 1  ON 50
ci_0002                 7.011007e-01 3 1  ON 51
ci_0003                -2.765399e-02 3 1  ON 52
ci_0004                -2.765390e-02 3 1  ON 53
ci_0005                -3.649151e-02 3 1  ON 54
ci_0006                -3.676590e-02 3 1  ON 55
ci_0007                -2.113127e-02 3 1  ON 56
ci_0008                -2.086280e-02 3 1  ON 57
ci_0009                -1.731435e-02 3 1  ON 58
ci_0010                -1.773930e-02 3 1  ON 59
ci_0011                -1.234866e-02 3 1  ON 60
ci_0012                -1.149593e-02 3 1  ON 61
ci_0013                 1.299833e-02 3 1  ON 62
ci_0014                 1.312391e-02 3 1  ON 63
ci_0015                 1.283411e-02 3 1  ON 64
ci_0016                 1.265767e-02 3 1  ON 65
ci_0017                 1.108924e-02 3 1  ON 66
ci_0018                 1.123834e-02 3 1  ON 67
ci_0019                 1.150085e-02 3 1  ON 68
ci_0020                 1.106963e-02 3 1  ON 69
ci_0021                -1.954103e-03 3 1  ON 70
ci_0022                -3.680600e-04 3 1  ON 71
ci_0023                -1.124026e-02 3 1  ON 72
ci_0024                -1.113400e-02 3 1  ON 73
ci_0025                -1.083651e-02 3 1  ON 74
ci_0026                -1.140695e-02 3 1  ON 75
ci_0027                -1.160254e-02 3 1  ON 76
ci_0028                -1.139852e-02 3 1  ON 77
ci_0029                -1.039673e-02 3 1  ON 78
ci_0030                -1.085228e-02 3 1  ON 79
ci_0031                 2.053236e-02 3 1  ON 80
ci_0032                 2.078736e-02 3 1  ON 81
ci_0033                 9.966446e-03 3 1  ON 82
ci_0034                 1.009475e-02 3 1  ON 83
ci_0035                 6.850541e-03 3 1  ON 84
ci_0036                 6.181698e-03 3 1  ON 85
ci_0037                -1.081111e-02 3 1  ON 86
ci_0038                -1.162258e-02 3 1  ON 87
ci_0039                -2.662501e-03 3 1  ON 88
ci_0040                -2.404715e-03 3 1  ON 89
ci_0041                 7.089566e-03 3 1  ON 90
ci_0042                 6.903620e-03 3 1  ON 91
ci_0043                -1.851795e-02 3 1  ON 92
ci_0044                -1.885084e-02 3 1  ON 93
ci_0045                 7.530476e-03 3 1  ON 94
ci_0046                 7.320998e-03 3 1  ON 95
ci_0047                -1.683592e-03 3 1  ON 96
ci_0048                -1.901853e-03 3 1  ON 97
ci_0049                -5.067183e-03 3 1  ON 98
ci_0050                -5.182144e-03 3 1  ON 99
ci_0051                -3.571571e-03 3 1  ON 100
ci_0052                -3.491507e-03 3 1  ON 101
ci_0053                -4.680323e-03 3 1  ON 102
ci_0054                -4.697108e-03 3 1  ON 103
ci_0055                 6.560084e-03 3 1  ON 104
ci_0056                 5.882780e-03 3 1  ON 105
ci_0057                 5.326095e-03 3 1  ON 106
ci_0058                 4.794713e-03 3 1  ON 107
ci_0059                -4.834210e-03 3 1  ON 108
ci_0060                -4.922929e-03 3 1  ON 109
ci_0061                -4.057966e-03 3 1  ON 110
ci_0062                -3.316343e-03 3 1  ON 111
ci_0063                -8.667293e-03 3 1  ON 112
ci_0064                -9.212191e-03 3 1  ON 113
ci_0065                -5.666383e-03 3 1  ON 114
ci_0066                -5.520266e-03 3 1  ON 115
ci_0067                -4.836259e-03 3 1  ON 116
ci_0068                -5.046333e-03 3 1  ON 117
ci_0069                 4.275648e-03 3 1  ON 118
ci_0070                 4.202484e-03 3 1  ON 119
ci_0071                 3.058342e-04 3 1  ON 120
ci_0072                 2.310471e-04 3 1  ON 121
ci_0073                 4.633587e-03 3 1  ON 122
ci_0074                 4.075329e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -16.9405
    reference variance = 0.310796
====================================================
  Execution time = 2.1170e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s055
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4428e-01
  Total weights = 1.9516e+06
  Execution time = 1.9246e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330135379210
                                         uncertainty =       0.003033415861

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330135379210
                                         uncertainty =       0.003033415861

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406244900
  error estimate for blocks of size 2^( 2) =       0.000419394486
  error estimate for blocks of size 2^( 3) =       0.000433542403
  error estimate for blocks of size 2^( 4) =       0.000446716289
  error estimate for blocks of size 2^( 5) =       0.000458091257
  error estimate for blocks of size 2^( 6) =       0.000468877518
  error estimate for blocks of size 2^( 7) =       0.000474763593

      target function =                  N/A
              le_mean =     -16.906690437048
             les_mean =     286.180712184496
             stat err =       0.000462112164
             autocorr =       1.293954357702
              std dev =       0.574517047407
             le_variance =       0.330069837761

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330125479709
                                         uncertainty =       0.003068894708

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330125479709
                                         uncertainty =       0.003068894708

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406237923
  error estimate for blocks of size 2^( 2) =       0.000419394604
  error estimate for blocks of size 2^( 3) =       0.000433559028
  error estimate for blocks of size 2^( 4) =       0.000446718065
  error estimate for blocks of size 2^( 5) =       0.000458103588
  error estimate for blocks of size 2^( 6) =       0.000468891183
  error estimate for blocks of size 2^( 7) =       0.000474803796

      target function =                  N/A
              le_mean =     -16.906704322096
             les_mean =     286.202139857817
             stat err =       0.000462129158
             autocorr =       1.294093977434
              std dev =       0.574507180399
             le_variance =       0.330058500330

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330081203301
                                         uncertainty =       0.003057582594

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330081203301
                                         uncertainty =       0.003057582594

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406210842
  error estimate for blocks of size 2^( 2) =       0.000419368812
  error estimate for blocks of size 2^( 3) =       0.000433529054
  error estimate for blocks of size 2^( 4) =       0.000446690336
  error estimate for blocks of size 2^( 5) =       0.000458070745
  error estimate for blocks of size 2^( 6) =       0.000468856333
  error estimate for blocks of size 2^( 7) =       0.000474757384

      target function =                  N/A
              le_mean =     -16.906695345188
             les_mean =     286.181272251960
             stat err =       0.000462093699
             autocorr =       1.294067925430
              std dev =       0.574468881506
             le_variance =       0.330014495819

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330114728205
                                         uncertainty =       0.003036529578

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330114728205
                                         uncertainty =       0.003036529578

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406232093
  error estimate for blocks of size 2^( 2) =       0.000419382768
  error estimate for blocks of size 2^( 3) =       0.000433532422
  error estimate for blocks of size 2^( 4) =       0.000446704770
  error estimate for blocks of size 2^( 5) =       0.000458080602
  error estimate for blocks of size 2^( 6) =       0.000468866972
  error estimate for blocks of size 2^( 7) =       0.000474755211

      target function =                  N/A
              le_mean =     -16.906689419686
             les_mean =     286.180564329228
             stat err =       0.000462101889
             autocorr =       1.293978401477
              std dev =       0.574498934881
             le_variance =       0.330049026179


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906690437048        initial
     2.2204e-01     2.2204e+00             1.0842e-03       -16.906704322096  <--
     8.8818e-01     8.8818e+00             3.7083e-04       -16.906695345188
     3.5527e+00     3.5527e+01             1.0338e-04       -16.906689419686

*****************************************************************************
Applying the update for shift_i =   2.2204e-01     and shift_s =   2.2204e+00
*****************************************************************************

  Execution time = 3.0876e+01
  </log>
  <optVariables href="H2O.s055.opt.xml">
   uu_0                 3.133670e-01 1 1  ON 0
   uu_1                 1.458687e-01 1 1  ON 1
   uu_2                 4.354886e-02 1 1  ON 2
   uu_3                -1.955270e-02 1 1  ON 3
   uu_4                -6.634677e-02 1 1  ON 4
   uu_5                -1.026206e-01 1 1  ON 5
   uu_6                -1.318992e-01 1 1  ON 6
   uu_7                -1.474321e-01 1 1  ON 7
   uu_8                -1.410795e-01 1 1  ON 8
   uu_9                -1.131227e-01 1 1  ON 9
   ud_0                 4.514395e-01 1 1  ON 10
   ud_1                 1.856457e-01 1 1  ON 11
   ud_2                 6.508407e-02 1 1  ON 12
   ud_3                -6.248523e-03 1 1  ON 13
   ud_4                -6.385037e-02 1 1  ON 14
   ud_5                -1.063459e-01 1 1  ON 15
   ud_6                -1.349456e-01 1 1  ON 16
   ud_7                -1.530026e-01 1 1  ON 17
   ud_8                -1.558656e-01 1 1  ON 18
   ud_9                -1.461045e-01 1 1  ON 19
   eO_0                -7.490859e-01 1 1  ON 20
   eO_1                -4.284775e-01 1 1  ON 21
   eO_2                -1.693348e-02 1 1  ON 22
   eO_3                 2.969268e-01 1 1  ON 23
   eO_4                 5.250137e-01 1 1  ON 24
   eO_5                 4.893364e-01 1 1  ON 25
   eO_6                 2.626235e-01 1 1  ON 26
   eO_7                -4.249947e-02 1 1  ON 27
   eO_8                -2.343391e-01 1 1  ON 28
   eO_9                -9.921639e-02 1 1  ON 29
  eH1_0                -2.640649e-01 1 1  ON 30
  eH1_1                -1.566541e-01 1 1  ON 31
  eH1_2                -1.071493e-01 1 1  ON 32
  eH1_3                -5.105366e-02 1 1  ON 33
  eH1_4                -5.298604e-04 1 1  ON 34
  eH1_5                 3.615243e-02 1 1  ON 35
  eH1_6                 9.827778e-02 1 1  ON 36
  eH1_7                 1.593323e-01 1 1  ON 37
  eH1_8                 1.946534e-01 1 1  ON 38
  eH1_9                 9.097825e-02 1 1  ON 39
  eH2_0                -2.627198e-01 1 1  ON 40
  eH2_1                -1.548263e-01 1 1  ON 41
  eH2_2                -1.046603e-01 1 1  ON 42
  eH2_3                -4.912642e-02 1 1  ON 43
  eH2_4                 1.389121e-03 1 1  ON 44
  eH2_5                 3.764259e-02 1 1  ON 45
  eH2_6                 9.992625e-02 1 1  ON 46
  eH2_7                 1.606577e-01 1 1  ON 47
  eH2_8                 1.986026e-01 1 1  ON 48
  eH2_9                 8.431312e-02 1 1  ON 49
ci_0001                 7.012009e-01 3 1  ON 50
ci_0002                 7.008993e-01 3 1  ON 51
ci_0003                -2.779824e-02 3 1  ON 52
ci_0004                -2.713751e-02 3 1  ON 53
ci_0005                -3.652783e-02 3 1  ON 54
ci_0006                -3.676791e-02 3 1  ON 55
ci_0007                -2.147445e-02 3 1  ON 56
ci_0008                -2.135468e-02 3 1  ON 57
ci_0009                -1.718653e-02 3 1  ON 58
ci_0010                -1.796345e-02 3 1  ON 59
ci_0011                -1.232735e-02 3 1  ON 60
ci_0012                -1.177604e-02 3 1  ON 61
ci_0013                 1.298255e-02 3 1  ON 62
ci_0014                 1.282015e-02 3 1  ON 63
ci_0015                 1.322267e-02 3 1  ON 64
ci_0016                 1.280447e-02 3 1  ON 65
ci_0017                 1.113903e-02 3 1  ON 66
ci_0018                 1.137709e-02 3 1  ON 67
ci_0019                 1.166440e-02 3 1  ON 68
ci_0020                 1.124504e-02 3 1  ON 69
ci_0021                -2.207507e-03 3 1  ON 70
ci_0022                -5.757454e-04 3 1  ON 71
ci_0023                -1.124990e-02 3 1  ON 72
ci_0024                -1.141363e-02 3 1  ON 73
ci_0025                -1.089462e-02 3 1  ON 74
ci_0026                -1.091147e-02 3 1  ON 75
ci_0027                -1.162539e-02 3 1  ON 76
ci_0028                -1.089052e-02 3 1  ON 77
ci_0029                -1.024139e-02 3 1  ON 78
ci_0030                -1.071239e-02 3 1  ON 79
ci_0031                 2.073527e-02 3 1  ON 80
ci_0032                 2.064913e-02 3 1  ON 81
ci_0033                 9.472889e-03 3 1  ON 82
ci_0034                 1.081115e-02 3 1  ON 83
ci_0035                 6.355041e-03 3 1  ON 84
ci_0036                 5.895563e-03 3 1  ON 85
ci_0037                -1.061449e-02 3 1  ON 86
ci_0038                -1.158540e-02 3 1  ON 87
ci_0039                -2.570202e-03 3 1  ON 88
ci_0040                -2.417603e-03 3 1  ON 89
ci_0041                 7.051036e-03 3 1  ON 90
ci_0042                 6.696983e-03 3 1  ON 91
ci_0043                -1.823096e-02 3 1  ON 92
ci_0044                -1.884530e-02 3 1  ON 93
ci_0045                 6.850212e-03 3 1  ON 94
ci_0046                 6.967451e-03 3 1  ON 95
ci_0047                -1.835150e-03 3 1  ON 96
ci_0048                -1.949392e-03 3 1  ON 97
ci_0049                -4.936330e-03 3 1  ON 98
ci_0050                -5.310680e-03 3 1  ON 99
ci_0051                -3.544835e-03 3 1  ON 100
ci_0052                -3.583761e-03 3 1  ON 101
ci_0053                -4.605358e-03 3 1  ON 102
ci_0054                -4.670892e-03 3 1  ON 103
ci_0055                 6.270608e-03 3 1  ON 104
ci_0056                 5.759179e-03 3 1  ON 105
ci_0057                 5.427229e-03 3 1  ON 106
ci_0058                 4.723595e-03 3 1  ON 107
ci_0059                -5.115241e-03 3 1  ON 108
ci_0060                -5.141245e-03 3 1  ON 109
ci_0061                -3.932055e-03 3 1  ON 110
ci_0062                -3.624960e-03 3 1  ON 111
ci_0063                -8.400078e-03 3 1  ON 112
ci_0064                -9.018657e-03 3 1  ON 113
ci_0065                -5.599930e-03 3 1  ON 114
ci_0066                -5.519783e-03 3 1  ON 115
ci_0067                -4.907492e-03 3 1  ON 116
ci_0068                -5.009098e-03 3 1  ON 117
ci_0069                 4.205889e-03 3 1  ON 118
ci_0070                 4.255101e-03 3 1  ON 119
ci_0071                 5.342856e-04 3 1  ON 120
ci_0072                 3.450115e-04 3 1  ON 121
ci_0073                 4.926027e-03 3 1  ON 122
ci_0074                 3.844794e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8242e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s056 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s056 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=56  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -16.9451
    reference variance = 0.207431
====================================================
  Execution time = 2.1022e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s056
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5260e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3673e-01
  Total weights = 1.951604001e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.4615e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322886822229
                                         uncertainty =       0.001852340909

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322886822229
                                         uncertainty =       0.001852340909

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401917018
  error estimate for blocks of size 2^( 2) =       0.000414924738
  error estimate for blocks of size 2^( 3) =       0.000428234883
  error estimate for blocks of size 2^( 4) =       0.000440494153
  error estimate for blocks of size 2^( 5) =       0.000451958905
  error estimate for blocks of size 2^( 6) =       0.000459977614
  error estimate for blocks of size 2^( 7) =       0.000463528924

      target function =                  N/A
              le_mean =     -16.906109188847
             les_mean =     286.153254639991
             stat err =       0.000453989899
             autocorr =       1.275908670428
              std dev =       0.568396498174
             le_variance =       0.323074579136


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690610918885e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.5511e-02, overlap shift 5.5511e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906109188852       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906124276812       residual = 2.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906118443181       residual = 8.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906124446419       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906125804206       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906127494041       residual = 8.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906128455946       residual = 8.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906128632289       residual = 7.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906129295370       residual = 6.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906128592799       residual = 3.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906128637003       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906127883841       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906129170944       residual = 7.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906128801400       residual = 4.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906129044240       residual = 3.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.906129118398       residual = 1.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.906129351631       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.906129618915       residual = 6.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.5511e-02 is 3.564077e-03

solving harmonic davidson linear method for identity shift 2.2204e-01, overlap shift 2.2204e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906109188852       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906118637149       residual = 2.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906115282314       residual = 3.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906117821113       residual = 8.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906118459310       residual = 7.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906120084299       residual = 5.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906120132767       residual = 3.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906119667697       residual = 2.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906119522342       residual = 7.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906119388272       residual = 3.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906119564555       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906119463801       residual = 6.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.2204e-01 is 8.875380e-04

solving harmonic davidson linear method for identity shift 8.8818e-01, overlap shift 8.8818e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906109188852       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906112975523       residual = 2.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906111670433       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906112484805       residual = 8.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906112726289       residual = 6.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906113305277       residual = 2.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906113198825       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906113056038       residual = 5.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906113036384       residual = 1.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906112969841       residual = 5.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 8.8818e-01 is 3.904451e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.515558 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7503e+01
  </log>
  <optVariables href="H2O.s056.opt.xml">
   uu_0                 3.135544e-01 1 1  ON 0
   uu_1                 1.458515e-01 1 1  ON 1
   uu_2                 4.360171e-02 1 1  ON 2
   uu_3                -1.930052e-02 1 1  ON 3
   uu_4                -6.611945e-02 1 1  ON 4
   uu_5                -1.024449e-01 1 1  ON 5
   uu_6                -1.318753e-01 1 1  ON 6
   uu_7                -1.474585e-01 1 1  ON 7
   uu_8                -1.417647e-01 1 1  ON 8
   uu_9                -1.137801e-01 1 1  ON 9
   ud_0                 4.517915e-01 1 1  ON 10
   ud_1                 1.859383e-01 1 1  ON 11
   ud_2                 6.517598e-02 1 1  ON 12
   ud_3                -6.280385e-03 1 1  ON 13
   ud_4                -6.386331e-02 1 1  ON 14
   ud_5                -1.062274e-01 1 1  ON 15
   ud_6                -1.348628e-01 1 1  ON 16
   ud_7                -1.529691e-01 1 1  ON 17
   ud_8                -1.558932e-01 1 1  ON 18
   ud_9                -1.463053e-01 1 1  ON 19
   eO_0                -7.491284e-01 1 1  ON 20
   eO_1                -4.282109e-01 1 1  ON 21
   eO_2                -1.685524e-02 1 1  ON 22
   eO_3                 2.971522e-01 1 1  ON 23
   eO_4                 5.252275e-01 1 1  ON 24
   eO_5                 4.896135e-01 1 1  ON 25
   eO_6                 2.627396e-01 1 1  ON 26
   eO_7                -4.236142e-02 1 1  ON 27
   eO_8                -2.348189e-01 1 1  ON 28
   eO_9                -9.986514e-02 1 1  ON 29
  eH1_0                -2.642926e-01 1 1  ON 30
  eH1_1                -1.569585e-01 1 1  ON 31
  eH1_2                -1.070946e-01 1 1  ON 32
  eH1_3                -5.109443e-02 1 1  ON 33
  eH1_4                -7.210680e-04 1 1  ON 34
  eH1_5                 3.616659e-02 1 1  ON 35
  eH1_6                 9.820728e-02 1 1  ON 36
  eH1_7                 1.588993e-01 1 1  ON 37
  eH1_8                 1.947370e-01 1 1  ON 38
  eH1_9                 9.186579e-02 1 1  ON 39
  eH2_0                -2.631116e-01 1 1  ON 40
  eH2_1                -1.551065e-01 1 1  ON 41
  eH2_2                -1.049615e-01 1 1  ON 42
  eH2_3                -4.930434e-02 1 1  ON 43
  eH2_4                 1.279256e-03 1 1  ON 44
  eH2_5                 3.747420e-02 1 1  ON 45
  eH2_6                 9.980974e-02 1 1  ON 46
  eH2_7                 1.610436e-01 1 1  ON 47
  eH2_8                 1.990252e-01 1 1  ON 48
  eH2_9                 8.498838e-02 1 1  ON 49
ci_0001                 7.013247e-01 3 1  ON 50
ci_0002                 7.008258e-01 3 1  ON 51
ci_0003                -2.782845e-02 3 1  ON 52
ci_0004                -2.684812e-02 3 1  ON 53
ci_0005                -3.653047e-02 3 1  ON 54
ci_0006                -3.650482e-02 3 1  ON 55
ci_0007                -2.116154e-02 3 1  ON 56
ci_0008                -2.096332e-02 3 1  ON 57
ci_0009                -1.784699e-02 3 1  ON 58
ci_0010                -1.762816e-02 3 1  ON 59
ci_0011                -1.216412e-02 3 1  ON 60
ci_0012                -1.196609e-02 3 1  ON 61
ci_0013                 1.287946e-02 3 1  ON 62
ci_0014                 1.282880e-02 3 1  ON 63
ci_0015                 1.285808e-02 3 1  ON 64
ci_0016                 1.244279e-02 3 1  ON 65
ci_0017                 1.139978e-02 3 1  ON 66
ci_0018                 1.125811e-02 3 1  ON 67
ci_0019                 1.111945e-02 3 1  ON 68
ci_0020                 1.181263e-02 3 1  ON 69
ci_0021                -2.569929e-03 3 1  ON 70
ci_0022                -6.802582e-04 3 1  ON 71
ci_0023                -1.103426e-02 3 1  ON 72
ci_0024                -1.151377e-02 3 1  ON 73
ci_0025                -1.134677e-02 3 1  ON 74
ci_0026                -1.092936e-02 3 1  ON 75
ci_0027                -1.105348e-02 3 1  ON 76
ci_0028                -1.099700e-02 3 1  ON 77
ci_0029                -1.085551e-02 3 1  ON 78
ci_0030                -1.067366e-02 3 1  ON 79
ci_0031                 2.135822e-02 3 1  ON 80
ci_0032                 2.012088e-02 3 1  ON 81
ci_0033                 1.002417e-02 3 1  ON 82
ci_0034                 1.061427e-02 3 1  ON 83
ci_0035                 6.431104e-03 3 1  ON 84
ci_0036                 6.291761e-03 3 1  ON 85
ci_0037                -1.070922e-02 3 1  ON 86
ci_0038                -1.117803e-02 3 1  ON 87
ci_0039                -2.390832e-03 3 1  ON 88
ci_0040                -2.447394e-03 3 1  ON 89
ci_0041                 7.131833e-03 3 1  ON 90
ci_0042                 6.539405e-03 3 1  ON 91
ci_0043                -1.833276e-02 3 1  ON 92
ci_0044                -1.926973e-02 3 1  ON 93
ci_0045                 6.684486e-03 3 1  ON 94
ci_0046                 6.811410e-03 3 1  ON 95
ci_0047                -1.679391e-03 3 1  ON 96
ci_0048                -2.079374e-03 3 1  ON 97
ci_0049                -4.852431e-03 3 1  ON 98
ci_0050                -4.838895e-03 3 1  ON 99
ci_0051                -3.206693e-03 3 1  ON 100
ci_0052                -3.465958e-03 3 1  ON 101
ci_0053                -4.217703e-03 3 1  ON 102
ci_0054                -4.419663e-03 3 1  ON 103
ci_0055                 6.733777e-03 3 1  ON 104
ci_0056                 6.088191e-03 3 1  ON 105
ci_0057                 5.029876e-03 3 1  ON 106
ci_0058                 4.560629e-03 3 1  ON 107
ci_0059                -4.977775e-03 3 1  ON 108
ci_0060                -5.035301e-03 3 1  ON 109
ci_0061                -4.220754e-03 3 1  ON 110
ci_0062                -3.332365e-03 3 1  ON 111
ci_0063                -8.541277e-03 3 1  ON 112
ci_0064                -8.697314e-03 3 1  ON 113
ci_0065                -4.905598e-03 3 1  ON 114
ci_0066                -5.224709e-03 3 1  ON 115
ci_0067                -5.330574e-03 3 1  ON 116
ci_0068                -4.940734e-03 3 1  ON 117
ci_0069                 4.333349e-03 3 1  ON 118
ci_0070                 4.275402e-03 3 1  ON 119
ci_0071                 3.508503e-04 3 1  ON 120
ci_0072                 2.736466e-04 3 1  ON 121
ci_0073                 4.060281e-03 3 1  ON 122
ci_0074                 3.839137e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -16.8497
    reference variance = 0.292396
====================================================
  Execution time = 2.0976e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s056
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3698e-01
  Total weights = 1.9517e+06
  Execution time = 1.9482e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322486815939
                                         uncertainty =       0.002291249358

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322486815939
                                         uncertainty =       0.002291249358

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401524170
  error estimate for blocks of size 2^( 2) =       0.000414401850
  error estimate for blocks of size 2^( 3) =       0.000427894970
  error estimate for blocks of size 2^( 4) =       0.000440686781
  error estimate for blocks of size 2^( 5) =       0.000451308749
  error estimate for blocks of size 2^( 6) =       0.000457738287
  error estimate for blocks of size 2^( 7) =       0.000463014755

      target function =                  N/A
              le_mean =     -16.906550552213
             les_mean =     286.274698358213
             stat err =       0.000453187143
             autocorr =       1.273889552503
              std dev =       0.567840926396
             le_variance =       0.322443317690

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322577290391
                                         uncertainty =       0.002288179560

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322577290391
                                         uncertainty =       0.002288179560

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401579190
  error estimate for blocks of size 2^( 2) =       0.000414457437
  error estimate for blocks of size 2^( 3) =       0.000427962939
  error estimate for blocks of size 2^( 4) =       0.000440776839
  error estimate for blocks of size 2^( 5) =       0.000451355214
  error estimate for blocks of size 2^( 6) =       0.000457811472
  error estimate for blocks of size 2^( 7) =       0.000463082995

      target function =                  N/A
              le_mean =     -16.906544560974
             les_mean =     286.169546256713
             stat err =       0.000453256630
             autocorr =       1.273931078097
              std dev =       0.567918736837
             le_variance =       0.322531691650

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322741549395
                                         uncertainty =       0.002294901360

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322741549395
                                         uncertainty =       0.002294901360

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401681048
  error estimate for blocks of size 2^( 2) =       0.000414567896
  error estimate for blocks of size 2^( 3) =       0.000428077172
  error estimate for blocks of size 2^( 4) =       0.000440897030
  error estimate for blocks of size 2^( 5) =       0.000451479663
  error estimate for blocks of size 2^( 6) =       0.000457943487
  error estimate for blocks of size 2^( 7) =       0.000463194694

      target function =                  N/A
              le_mean =     -16.906550890642
             les_mean =     286.178639321795
             stat err =       0.000453378719
             autocorr =       1.273971108757
              std dev =       0.568062785431
             le_variance =       0.322695328191

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322256727860
                                         uncertainty =       0.002292295910

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322256727860
                                         uncertainty =       0.002292295910

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401380960
  error estimate for blocks of size 2^( 2) =       0.000414247756
  error estimate for blocks of size 2^( 3) =       0.000427750813
  error estimate for blocks of size 2^( 4) =       0.000440564409
  error estimate for blocks of size 2^( 5) =       0.000451120965
  error estimate for blocks of size 2^( 6) =       0.000457551693
  error estimate for blocks of size 2^( 7) =       0.000462828792

      target function =                  N/A
              le_mean =     -16.906537132222
             les_mean =     286.220576016986
             stat err =       0.000453016465
             autocorr =       1.273838696367
              std dev =       0.567638397915
             le_variance =       0.322213350787


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906550552213        initial
     5.5511e-02     5.5511e-01             3.5641e-03       -16.906544560974
     2.2204e-01     2.2204e+00             8.8754e-04       -16.906550890642  <--
     8.8818e-01     8.8818e+00             3.9045e-04       -16.906537132222

*****************************************************************************
Applying the update for shift_i =   2.2204e-01     and shift_s =   2.2204e+00
*****************************************************************************

  Execution time = 3.0722e+01
  </log>
  <optVariables href="H2O.s056.opt.xml">
   uu_0                 3.135544e-01 1 1  ON 0
   uu_1                 1.458515e-01 1 1  ON 1
   uu_2                 4.360171e-02 1 1  ON 2
   uu_3                -1.930052e-02 1 1  ON 3
   uu_4                -6.611945e-02 1 1  ON 4
   uu_5                -1.024449e-01 1 1  ON 5
   uu_6                -1.318753e-01 1 1  ON 6
   uu_7                -1.474585e-01 1 1  ON 7
   uu_8                -1.417647e-01 1 1  ON 8
   uu_9                -1.137801e-01 1 1  ON 9
   ud_0                 4.517915e-01 1 1  ON 10
   ud_1                 1.859383e-01 1 1  ON 11
   ud_2                 6.517598e-02 1 1  ON 12
   ud_3                -6.280385e-03 1 1  ON 13
   ud_4                -6.386331e-02 1 1  ON 14
   ud_5                -1.062274e-01 1 1  ON 15
   ud_6                -1.348628e-01 1 1  ON 16
   ud_7                -1.529691e-01 1 1  ON 17
   ud_8                -1.558932e-01 1 1  ON 18
   ud_9                -1.463053e-01 1 1  ON 19
   eO_0                -7.491284e-01 1 1  ON 20
   eO_1                -4.282109e-01 1 1  ON 21
   eO_2                -1.685524e-02 1 1  ON 22
   eO_3                 2.971522e-01 1 1  ON 23
   eO_4                 5.252275e-01 1 1  ON 24
   eO_5                 4.896135e-01 1 1  ON 25
   eO_6                 2.627396e-01 1 1  ON 26
   eO_7                -4.236142e-02 1 1  ON 27
   eO_8                -2.348189e-01 1 1  ON 28
   eO_9                -9.986514e-02 1 1  ON 29
  eH1_0                -2.642926e-01 1 1  ON 30
  eH1_1                -1.569585e-01 1 1  ON 31
  eH1_2                -1.070946e-01 1 1  ON 32
  eH1_3                -5.109443e-02 1 1  ON 33
  eH1_4                -7.210680e-04 1 1  ON 34
  eH1_5                 3.616659e-02 1 1  ON 35
  eH1_6                 9.820728e-02 1 1  ON 36
  eH1_7                 1.588993e-01 1 1  ON 37
  eH1_8                 1.947370e-01 1 1  ON 38
  eH1_9                 9.186579e-02 1 1  ON 39
  eH2_0                -2.631116e-01 1 1  ON 40
  eH2_1                -1.551065e-01 1 1  ON 41
  eH2_2                -1.049615e-01 1 1  ON 42
  eH2_3                -4.930434e-02 1 1  ON 43
  eH2_4                 1.279256e-03 1 1  ON 44
  eH2_5                 3.747420e-02 1 1  ON 45
  eH2_6                 9.980974e-02 1 1  ON 46
  eH2_7                 1.610436e-01 1 1  ON 47
  eH2_8                 1.990252e-01 1 1  ON 48
  eH2_9                 8.498838e-02 1 1  ON 49
ci_0001                 7.013247e-01 3 1  ON 50
ci_0002                 7.008258e-01 3 1  ON 51
ci_0003                -2.782845e-02 3 1  ON 52
ci_0004                -2.684812e-02 3 1  ON 53
ci_0005                -3.653047e-02 3 1  ON 54
ci_0006                -3.650482e-02 3 1  ON 55
ci_0007                -2.116154e-02 3 1  ON 56
ci_0008                -2.096332e-02 3 1  ON 57
ci_0009                -1.784699e-02 3 1  ON 58
ci_0010                -1.762816e-02 3 1  ON 59
ci_0011                -1.216412e-02 3 1  ON 60
ci_0012                -1.196609e-02 3 1  ON 61
ci_0013                 1.287946e-02 3 1  ON 62
ci_0014                 1.282880e-02 3 1  ON 63
ci_0015                 1.285808e-02 3 1  ON 64
ci_0016                 1.244279e-02 3 1  ON 65
ci_0017                 1.139978e-02 3 1  ON 66
ci_0018                 1.125811e-02 3 1  ON 67
ci_0019                 1.111945e-02 3 1  ON 68
ci_0020                 1.181263e-02 3 1  ON 69
ci_0021                -2.569929e-03 3 1  ON 70
ci_0022                -6.802582e-04 3 1  ON 71
ci_0023                -1.103426e-02 3 1  ON 72
ci_0024                -1.151377e-02 3 1  ON 73
ci_0025                -1.134677e-02 3 1  ON 74
ci_0026                -1.092936e-02 3 1  ON 75
ci_0027                -1.105348e-02 3 1  ON 76
ci_0028                -1.099700e-02 3 1  ON 77
ci_0029                -1.085551e-02 3 1  ON 78
ci_0030                -1.067366e-02 3 1  ON 79
ci_0031                 2.135822e-02 3 1  ON 80
ci_0032                 2.012088e-02 3 1  ON 81
ci_0033                 1.002417e-02 3 1  ON 82
ci_0034                 1.061427e-02 3 1  ON 83
ci_0035                 6.431104e-03 3 1  ON 84
ci_0036                 6.291761e-03 3 1  ON 85
ci_0037                -1.070922e-02 3 1  ON 86
ci_0038                -1.117803e-02 3 1  ON 87
ci_0039                -2.390832e-03 3 1  ON 88
ci_0040                -2.447394e-03 3 1  ON 89
ci_0041                 7.131833e-03 3 1  ON 90
ci_0042                 6.539405e-03 3 1  ON 91
ci_0043                -1.833276e-02 3 1  ON 92
ci_0044                -1.926973e-02 3 1  ON 93
ci_0045                 6.684486e-03 3 1  ON 94
ci_0046                 6.811410e-03 3 1  ON 95
ci_0047                -1.679391e-03 3 1  ON 96
ci_0048                -2.079374e-03 3 1  ON 97
ci_0049                -4.852431e-03 3 1  ON 98
ci_0050                -4.838895e-03 3 1  ON 99
ci_0051                -3.206693e-03 3 1  ON 100
ci_0052                -3.465958e-03 3 1  ON 101
ci_0053                -4.217703e-03 3 1  ON 102
ci_0054                -4.419663e-03 3 1  ON 103
ci_0055                 6.733777e-03 3 1  ON 104
ci_0056                 6.088191e-03 3 1  ON 105
ci_0057                 5.029876e-03 3 1  ON 106
ci_0058                 4.560629e-03 3 1  ON 107
ci_0059                -4.977775e-03 3 1  ON 108
ci_0060                -5.035301e-03 3 1  ON 109
ci_0061                -4.220754e-03 3 1  ON 110
ci_0062                -3.332365e-03 3 1  ON 111
ci_0063                -8.541277e-03 3 1  ON 112
ci_0064                -8.697314e-03 3 1  ON 113
ci_0065                -4.905598e-03 3 1  ON 114
ci_0066                -5.224709e-03 3 1  ON 115
ci_0067                -5.330574e-03 3 1  ON 116
ci_0068                -4.940734e-03 3 1  ON 117
ci_0069                 4.333349e-03 3 1  ON 118
ci_0070                 4.275402e-03 3 1  ON 119
ci_0071                 3.508503e-04 3 1  ON 120
ci_0072                 2.736466e-04 3 1  ON 121
ci_0073                 4.060281e-03 3 1  ON 122
ci_0074                 3.839137e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8247e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s057 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s057 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=57  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -16.9355
    reference variance = 0.157636
====================================================
  Execution time = 2.1062e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s057
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5244e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3424e-01
  Total weights = 1.951303278e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1877e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323076970764
                                         uncertainty =       0.002344999145

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323076970764
                                         uncertainty =       0.002344999145

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401896449
  error estimate for blocks of size 2^( 2) =       0.000415354480
  error estimate for blocks of size 2^( 3) =       0.000429041591
  error estimate for blocks of size 2^( 4) =       0.000441774800
  error estimate for blocks of size 2^( 5) =       0.000453349846
  error estimate for blocks of size 2^( 6) =       0.000461737436
  error estimate for blocks of size 2^( 7) =       0.000471372203

      target function =                  N/A
              le_mean =     -16.905667526231
             les_mean =     286.135830174671
             stat err =       0.000457058571
             autocorr =       1.293347945385
              std dev =       0.568367408731
             le_variance =       0.323041511308


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690566752623e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.5511e-02, overlap shift 5.5511e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905667526198       residual = 1.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905691786661       residual = 2.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905687407223       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905691504569       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905691900147       residual = 8.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905691582630       residual = 4.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905692734573       residual = 9.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905693995255       residual = 6.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905695595378       residual = 3.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905695557277       residual = 3.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905694715351       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905694171453       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905694437915       residual = 7.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905694758803       residual = 5.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.905695273901       residual = 2.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.905695299042       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.905695189825       residual = 6.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.5511e-02 is 3.377496e-03

solving harmonic davidson linear method for identity shift 2.2204e-01, overlap shift 2.2204e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905667526198       residual = 1.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905682611281       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905680391243       residual = 5.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905681989498       residual = 5.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905682364819       residual = 4.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905682640382       residual = 5.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905683169039       residual = 2.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905683458553       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905683860736       residual = 6.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905683641963       residual = 2.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905683306080       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905683141235       residual = 5.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.2204e-01 is 1.239054e-03

solving harmonic davidson linear method for identity shift 8.8818e-01, overlap shift 8.8818e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905667526198       residual = 1.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905673529452       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905672789357       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905673301486       residual = 3.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905673598222       residual = 5.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905673752187       residual = 3.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905673735610       residual = 8.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905673726288       residual = 4.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905673777930       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905673779449       residual = 6.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 8.8818e-01 is 3.911735e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.527948 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7270e+01
  </log>
  <optVariables href="H2O.s057.opt.xml">
   uu_0                 3.134409e-01 1 1  ON 0
   uu_1                 1.458341e-01 1 1  ON 1
   uu_2                 4.363976e-02 1 1  ON 2
   uu_3                -1.950407e-02 1 1  ON 3
   uu_4                -6.616511e-02 1 1  ON 4
   uu_5                -1.025615e-01 1 1  ON 5
   uu_6                -1.320218e-01 1 1  ON 6
   uu_7                -1.475494e-01 1 1  ON 7
   uu_8                -1.416672e-01 1 1  ON 8
   uu_9                -1.137480e-01 1 1  ON 9
   ud_0                 4.519592e-01 1 1  ON 10
   ud_1                 1.859121e-01 1 1  ON 11
   ud_2                 6.497918e-02 1 1  ON 12
   ud_3                -6.494959e-03 1 1  ON 13
   ud_4                -6.390524e-02 1 1  ON 14
   ud_5                -1.063586e-01 1 1  ON 15
   ud_6                -1.346895e-01 1 1  ON 16
   ud_7                -1.529377e-01 1 1  ON 17
   ud_8                -1.557320e-01 1 1  ON 18
   ud_9                -1.460624e-01 1 1  ON 19
   eO_0                -7.494151e-01 1 1  ON 20
   eO_1                -4.281421e-01 1 1  ON 21
   eO_2                -1.663433e-02 1 1  ON 22
   eO_3                 2.974571e-01 1 1  ON 23
   eO_4                 5.252576e-01 1 1  ON 24
   eO_5                 4.901024e-01 1 1  ON 25
   eO_6                 2.628509e-01 1 1  ON 26
   eO_7                -4.239907e-02 1 1  ON 27
   eO_8                -2.351892e-01 1 1  ON 28
   eO_9                -1.003140e-01 1 1  ON 29
  eH1_0                -2.647074e-01 1 1  ON 30
  eH1_1                -1.571103e-01 1 1  ON 31
  eH1_2                -1.071097e-01 1 1  ON 32
  eH1_3                -5.140770e-02 1 1  ON 33
  eH1_4                -1.050124e-03 1 1  ON 34
  eH1_5                 3.579489e-02 1 1  ON 35
  eH1_6                 9.847451e-02 1 1  ON 36
  eH1_7                 1.590750e-01 1 1  ON 37
  eH1_8                 1.950176e-01 1 1  ON 38
  eH1_9                 9.261700e-02 1 1  ON 39
  eH2_0                -2.632614e-01 1 1  ON 40
  eH2_1                -1.552011e-01 1 1  ON 41
  eH2_2                -1.051809e-01 1 1  ON 42
  eH2_3                -4.939099e-02 1 1  ON 43
  eH2_4                 1.088312e-03 1 1  ON 44
  eH2_5                 3.731080e-02 1 1  ON 45
  eH2_6                 9.927895e-02 1 1  ON 46
  eH2_7                 1.610569e-01 1 1  ON 47
  eH2_8                 1.995131e-01 1 1  ON 48
  eH2_9                 8.583235e-02 1 1  ON 49
ci_0001                 7.012488e-01 3 1  ON 50
ci_0002                 7.008507e-01 3 1  ON 51
ci_0003                -2.779325e-02 3 1  ON 52
ci_0004                -2.734309e-02 3 1  ON 53
ci_0005                -3.637124e-02 3 1  ON 54
ci_0006                -3.674366e-02 3 1  ON 55
ci_0007                -2.086727e-02 3 1  ON 56
ci_0008                -2.220238e-02 3 1  ON 57
ci_0009                -1.798010e-02 3 1  ON 58
ci_0010                -1.720530e-02 3 1  ON 59
ci_0011                -1.241263e-02 3 1  ON 60
ci_0012                -1.139094e-02 3 1  ON 61
ci_0013                 1.259222e-02 3 1  ON 62
ci_0014                 1.297464e-02 3 1  ON 63
ci_0015                 1.263027e-02 3 1  ON 64
ci_0016                 1.305879e-02 3 1  ON 65
ci_0017                 1.119987e-02 3 1  ON 66
ci_0018                 1.184442e-02 3 1  ON 67
ci_0019                 1.115202e-02 3 1  ON 68
ci_0020                 1.190496e-02 3 1  ON 69
ci_0021                -2.239173e-03 3 1  ON 70
ci_0022                -9.870531e-04 3 1  ON 71
ci_0023                -1.142212e-02 3 1  ON 72
ci_0024                -1.156396e-02 3 1  ON 73
ci_0025                -1.093423e-02 3 1  ON 74
ci_0026                -1.048335e-02 3 1  ON 75
ci_0027                -1.147275e-02 3 1  ON 76
ci_0028                -1.047863e-02 3 1  ON 77
ci_0029                -1.083112e-02 3 1  ON 78
ci_0030                -1.082766e-02 3 1  ON 79
ci_0031                 2.134127e-02 3 1  ON 80
ci_0032                 1.998115e-02 3 1  ON 81
ci_0033                 9.907890e-03 3 1  ON 82
ci_0034                 1.012300e-02 3 1  ON 83
ci_0035                 6.473219e-03 3 1  ON 84
ci_0036                 7.008521e-03 3 1  ON 85
ci_0037                -1.067009e-02 3 1  ON 86
ci_0038                -1.118751e-02 3 1  ON 87
ci_0039                -2.101045e-03 3 1  ON 88
ci_0040                -2.216101e-03 3 1  ON 89
ci_0041                 7.751957e-03 3 1  ON 90
ci_0042                 6.391693e-03 3 1  ON 91
ci_0043                -1.864352e-02 3 1  ON 92
ci_0044                -1.895881e-02 3 1  ON 93
ci_0045                 6.955096e-03 3 1  ON 94
ci_0046                 7.273673e-03 3 1  ON 95
ci_0047                -1.490056e-03 3 1  ON 96
ci_0048                -1.831661e-03 3 1  ON 97
ci_0049                -5.563212e-03 3 1  ON 98
ci_0050                -5.198330e-03 3 1  ON 99
ci_0051                -3.610442e-03 3 1  ON 100
ci_0052                -3.417310e-03 3 1  ON 101
ci_0053                -4.363915e-03 3 1  ON 102
ci_0054                -4.407307e-03 3 1  ON 103
ci_0055                 6.781011e-03 3 1  ON 104
ci_0056                 6.519970e-03 3 1  ON 105
ci_0057                 5.262637e-03 3 1  ON 106
ci_0058                 4.512171e-03 3 1  ON 107
ci_0059                -4.629565e-03 3 1  ON 108
ci_0060                -4.638132e-03 3 1  ON 109
ci_0061                -3.813193e-03 3 1  ON 110
ci_0062                -3.739785e-03 3 1  ON 111
ci_0063                -8.103220e-03 3 1  ON 112
ci_0064                -9.127228e-03 3 1  ON 113
ci_0065                -5.098342e-03 3 1  ON 114
ci_0066                -5.134981e-03 3 1  ON 115
ci_0067                -4.720204e-03 3 1  ON 116
ci_0068                -4.951295e-03 3 1  ON 117
ci_0069                 4.334940e-03 3 1  ON 118
ci_0070                 4.141167e-03 3 1  ON 119
ci_0071                -2.750858e-04 3 1  ON 120
ci_0072                 2.301984e-04 3 1  ON 121
ci_0073                 4.424983e-03 3 1  ON 122
ci_0074                 3.959144e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -16.8898
    reference variance = 0.127021
====================================================
  Execution time = 2.0925e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s057
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6908e+01
  VMC Evar = 3.3780e-01
  Total weights = 1.9513e+06
  Execution time = 1.9171e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324027052906
                                         uncertainty =       0.002247960476

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324027052906
                                         uncertainty =       0.002247960476

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402507255
  error estimate for blocks of size 2^( 2) =       0.000414912605
  error estimate for blocks of size 2^( 3) =       0.000427845831
  error estimate for blocks of size 2^( 4) =       0.000439819875
  error estimate for blocks of size 2^( 5) =       0.000449528653
  error estimate for blocks of size 2^( 6) =       0.000456473069
  error estimate for blocks of size 2^( 7) =       0.000460991482

      target function =                  N/A
              le_mean =     -16.907804817204
             les_mean =     286.237200670738
             stat err =       0.000451703270
             autocorr =       1.259386529756
              std dev =       0.569231218443
             le_variance =       0.324024180050

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324582293339
                                         uncertainty =       0.002247862512

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324582293339
                                         uncertainty =       0.002247862512

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402850922
  error estimate for blocks of size 2^( 2) =       0.000415213674
  error estimate for blocks of size 2^( 3) =       0.000428067936
  error estimate for blocks of size 2^( 4) =       0.000440086425
  error estimate for blocks of size 2^( 5) =       0.000449753689
  error estimate for blocks of size 2^( 6) =       0.000456715790
  error estimate for blocks of size 2^( 7) =       0.000461150841

      target function =                  N/A
              le_mean =     -16.907784471683
             les_mean =     286.961053871610
             stat err =       0.000451926686
             autocorr =       1.258482699177
              std dev =       0.569717237981
             le_variance =       0.324577731253

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324364389159
                                         uncertainty =       0.002259125380

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324364389159
                                         uncertainty =       0.002259125380

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402715399
  error estimate for blocks of size 2^( 2) =       0.000415067466
  error estimate for blocks of size 2^( 3) =       0.000427925005
  error estimate for blocks of size 2^( 4) =       0.000439891792
  error estimate for blocks of size 2^( 5) =       0.000449535083
  error estimate for blocks of size 2^( 6) =       0.000456524793
  error estimate for blocks of size 2^( 7) =       0.000460960880

      target function =                  N/A
              le_mean =     -16.907800358370
             les_mean =     286.215205926927
             stat err =       0.000451728137
             autocorr =       1.258223554753
              std dev =       0.569525579672
             le_variance =       0.324359385901

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324218901086
                                         uncertainty =       0.002279452529

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324218901086
                                         uncertainty =       0.002279452529

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402625677
  error estimate for blocks of size 2^( 2) =       0.000415018312
  error estimate for blocks of size 2^( 3) =       0.000427927483
  error estimate for blocks of size 2^( 4) =       0.000439885208
  error estimate for blocks of size 2^( 5) =       0.000449585390
  error estimate for blocks of size 2^( 6) =       0.000456552420
  error estimate for blocks of size 2^( 7) =       0.000460996469

      target function =                  N/A
              le_mean =     -16.907780056614
             les_mean =     286.578564143769
             stat err =       0.000451754872
             autocorr =       1.258933395904
              std dev =       0.569398692539
             le_variance =       0.324214871065


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.907804817204        initial  <--
     5.5511e-02     5.5511e-01             3.3775e-03       -16.907784471683
     2.2204e-01     2.2204e+00             1.2391e-03       -16.907800358370
     8.8818e-01     8.8818e+00             3.9117e-04       -16.907780056614

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.5765
  </log>
  <optVariables href="H2O.s057.opt.xml">
   uu_0                 3.135544e-01 1 1  ON 0
   uu_1                 1.458515e-01 1 1  ON 1
   uu_2                 4.360171e-02 1 1  ON 2
   uu_3                -1.930052e-02 1 1  ON 3
   uu_4                -6.611945e-02 1 1  ON 4
   uu_5                -1.024449e-01 1 1  ON 5
   uu_6                -1.318753e-01 1 1  ON 6
   uu_7                -1.474585e-01 1 1  ON 7
   uu_8                -1.417647e-01 1 1  ON 8
   uu_9                -1.137801e-01 1 1  ON 9
   ud_0                 4.517915e-01 1 1  ON 10
   ud_1                 1.859383e-01 1 1  ON 11
   ud_2                 6.517598e-02 1 1  ON 12
   ud_3                -6.280385e-03 1 1  ON 13
   ud_4                -6.386331e-02 1 1  ON 14
   ud_5                -1.062274e-01 1 1  ON 15
   ud_6                -1.348628e-01 1 1  ON 16
   ud_7                -1.529691e-01 1 1  ON 17
   ud_8                -1.558932e-01 1 1  ON 18
   ud_9                -1.463053e-01 1 1  ON 19
   eO_0                -7.491284e-01 1 1  ON 20
   eO_1                -4.282109e-01 1 1  ON 21
   eO_2                -1.685524e-02 1 1  ON 22
   eO_3                 2.971522e-01 1 1  ON 23
   eO_4                 5.252275e-01 1 1  ON 24
   eO_5                 4.896135e-01 1 1  ON 25
   eO_6                 2.627396e-01 1 1  ON 26
   eO_7                -4.236142e-02 1 1  ON 27
   eO_8                -2.348189e-01 1 1  ON 28
   eO_9                -9.986514e-02 1 1  ON 29
  eH1_0                -2.642926e-01 1 1  ON 30
  eH1_1                -1.569585e-01 1 1  ON 31
  eH1_2                -1.070946e-01 1 1  ON 32
  eH1_3                -5.109443e-02 1 1  ON 33
  eH1_4                -7.210680e-04 1 1  ON 34
  eH1_5                 3.616659e-02 1 1  ON 35
  eH1_6                 9.820728e-02 1 1  ON 36
  eH1_7                 1.588993e-01 1 1  ON 37
  eH1_8                 1.947370e-01 1 1  ON 38
  eH1_9                 9.186579e-02 1 1  ON 39
  eH2_0                -2.631116e-01 1 1  ON 40
  eH2_1                -1.551065e-01 1 1  ON 41
  eH2_2                -1.049615e-01 1 1  ON 42
  eH2_3                -4.930434e-02 1 1  ON 43
  eH2_4                 1.279256e-03 1 1  ON 44
  eH2_5                 3.747420e-02 1 1  ON 45
  eH2_6                 9.980974e-02 1 1  ON 46
  eH2_7                 1.610436e-01 1 1  ON 47
  eH2_8                 1.990252e-01 1 1  ON 48
  eH2_9                 8.498838e-02 1 1  ON 49
ci_0001                 7.013247e-01 3 1  ON 50
ci_0002                 7.008258e-01 3 1  ON 51
ci_0003                -2.782845e-02 3 1  ON 52
ci_0004                -2.684812e-02 3 1  ON 53
ci_0005                -3.653047e-02 3 1  ON 54
ci_0006                -3.650482e-02 3 1  ON 55
ci_0007                -2.116154e-02 3 1  ON 56
ci_0008                -2.096332e-02 3 1  ON 57
ci_0009                -1.784699e-02 3 1  ON 58
ci_0010                -1.762816e-02 3 1  ON 59
ci_0011                -1.216412e-02 3 1  ON 60
ci_0012                -1.196609e-02 3 1  ON 61
ci_0013                 1.287946e-02 3 1  ON 62
ci_0014                 1.282880e-02 3 1  ON 63
ci_0015                 1.285808e-02 3 1  ON 64
ci_0016                 1.244279e-02 3 1  ON 65
ci_0017                 1.139978e-02 3 1  ON 66
ci_0018                 1.125811e-02 3 1  ON 67
ci_0019                 1.111945e-02 3 1  ON 68
ci_0020                 1.181263e-02 3 1  ON 69
ci_0021                -2.569929e-03 3 1  ON 70
ci_0022                -6.802582e-04 3 1  ON 71
ci_0023                -1.103426e-02 3 1  ON 72
ci_0024                -1.151377e-02 3 1  ON 73
ci_0025                -1.134677e-02 3 1  ON 74
ci_0026                -1.092936e-02 3 1  ON 75
ci_0027                -1.105348e-02 3 1  ON 76
ci_0028                -1.099700e-02 3 1  ON 77
ci_0029                -1.085551e-02 3 1  ON 78
ci_0030                -1.067366e-02 3 1  ON 79
ci_0031                 2.135822e-02 3 1  ON 80
ci_0032                 2.012088e-02 3 1  ON 81
ci_0033                 1.002417e-02 3 1  ON 82
ci_0034                 1.061427e-02 3 1  ON 83
ci_0035                 6.431104e-03 3 1  ON 84
ci_0036                 6.291761e-03 3 1  ON 85
ci_0037                -1.070922e-02 3 1  ON 86
ci_0038                -1.117803e-02 3 1  ON 87
ci_0039                -2.390832e-03 3 1  ON 88
ci_0040                -2.447394e-03 3 1  ON 89
ci_0041                 7.131833e-03 3 1  ON 90
ci_0042                 6.539405e-03 3 1  ON 91
ci_0043                -1.833276e-02 3 1  ON 92
ci_0044                -1.926973e-02 3 1  ON 93
ci_0045                 6.684486e-03 3 1  ON 94
ci_0046                 6.811410e-03 3 1  ON 95
ci_0047                -1.679391e-03 3 1  ON 96
ci_0048                -2.079374e-03 3 1  ON 97
ci_0049                -4.852431e-03 3 1  ON 98
ci_0050                -4.838895e-03 3 1  ON 99
ci_0051                -3.206693e-03 3 1  ON 100
ci_0052                -3.465958e-03 3 1  ON 101
ci_0053                -4.217703e-03 3 1  ON 102
ci_0054                -4.419663e-03 3 1  ON 103
ci_0055                 6.733777e-03 3 1  ON 104
ci_0056                 6.088191e-03 3 1  ON 105
ci_0057                 5.029876e-03 3 1  ON 106
ci_0058                 4.560629e-03 3 1  ON 107
ci_0059                -4.977775e-03 3 1  ON 108
ci_0060                -5.035301e-03 3 1  ON 109
ci_0061                -4.220754e-03 3 1  ON 110
ci_0062                -3.332365e-03 3 1  ON 111
ci_0063                -8.541277e-03 3 1  ON 112
ci_0064                -8.697314e-03 3 1  ON 113
ci_0065                -4.905598e-03 3 1  ON 114
ci_0066                -5.224709e-03 3 1  ON 115
ci_0067                -5.330574e-03 3 1  ON 116
ci_0068                -4.940734e-03 3 1  ON 117
ci_0069                 4.333349e-03 3 1  ON 118
ci_0070                 4.275402e-03 3 1  ON 119
ci_0071                 3.508503e-04 3 1  ON 120
ci_0072                 2.736466e-04 3 1  ON 121
ci_0073                 4.060281e-03 3 1  ON 122
ci_0074                 3.839137e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7871e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s058 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s058 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=58  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -16.9481
    reference variance = 0.351008
====================================================
  Execution time = 2.1464e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s058
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5262e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3474e-01
  Total weights = 1.951600796e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1113e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323901255162
                                         uncertainty =       0.002258751333

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323901255162
                                         uncertainty =       0.002258751333

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402464446
  error estimate for blocks of size 2^( 2) =       0.000415497034
  error estimate for blocks of size 2^( 3) =       0.000428664857
  error estimate for blocks of size 2^( 4) =       0.000440509174
  error estimate for blocks of size 2^( 5) =       0.000451246321
  error estimate for blocks of size 2^( 6) =       0.000459284183
  error estimate for blocks of size 2^( 7) =       0.000465010859

      target function =                  N/A
              le_mean =     -16.906238071052
             les_mean =     286.155627634500
             stat err =       0.000454012634
             autocorr =       1.272567520706
              std dev =       0.569170678595
             le_variance =       0.323955261372


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690623807105e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.5511e-01, overlap shift 5.5511e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906238071040       residual = 2.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906244811369       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906244617738       residual = 6.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906244258702       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906244158836       residual = 6.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906244000927       residual = 4.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906244106861       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906244072599       residual = 6.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906244241883       residual = 2.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906244403247       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906244418048       residual = 4.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.5511e-01 is 8.956057e-04

solving harmonic davidson linear method for identity shift 2.2204e+00, overlap shift 2.2204e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906238071040       residual = 2.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906240239742       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906240177864       residual = 7.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906240095656       residual = 8.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906240104298       residual = 6.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906240074315       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906240046829       residual = 9.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906240013286       residual = 2.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906240051328       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906240087437       residual = 4.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.2204e+00 is 2.759226e-04

solving harmonic davidson linear method for identity shift 8.8818e+00, overlap shift 8.8818e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906238071040       residual = 2.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906238655124       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906238640228       residual = 8.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906238619838       residual = 8.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906238628469       residual = 6.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906238623296       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906238610660       residual = 8.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906238600125       residual = 2.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906238609425       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906238616059       residual = 3.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 8.8818e+00 is 7.319103e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.537092 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7591e+01
  </log>
  <optVariables href="H2O.s058.opt.xml">
   uu_0                 3.135808e-01 1 1  ON 0
   uu_1                 1.458668e-01 1 1  ON 1
   uu_2                 4.360357e-02 1 1  ON 2
   uu_3                -1.935662e-02 1 1  ON 3
   uu_4                -6.611356e-02 1 1  ON 4
   uu_5                -1.024144e-01 1 1  ON 5
   uu_6                -1.318964e-01 1 1  ON 6
   uu_7                -1.474718e-01 1 1  ON 7
   uu_8                -1.417640e-01 1 1  ON 8
   uu_9                -1.138132e-01 1 1  ON 9
   ud_0                 4.518081e-01 1 1  ON 10
   ud_1                 1.859534e-01 1 1  ON 11
   ud_2                 6.518198e-02 1 1  ON 12
   ud_3                -6.260094e-03 1 1  ON 13
   ud_4                -6.383890e-02 1 1  ON 14
   ud_5                -1.062223e-01 1 1  ON 15
   ud_6                -1.349074e-01 1 1  ON 16
   ud_7                -1.529762e-01 1 1  ON 17
   ud_8                -1.558866e-01 1 1  ON 18
   ud_9                -1.463169e-01 1 1  ON 19
   eO_0                -7.490935e-01 1 1  ON 20
   eO_1                -4.281956e-01 1 1  ON 21
   eO_2                -1.679642e-02 1 1  ON 22
   eO_3                 2.971468e-01 1 1  ON 23
   eO_4                 5.252075e-01 1 1  ON 24
   eO_5                 4.896534e-01 1 1  ON 25
   eO_6                 2.627531e-01 1 1  ON 26
   eO_7                -4.237019e-02 1 1  ON 27
   eO_8                -2.348778e-01 1 1  ON 28
   eO_9                -9.992635e-02 1 1  ON 29
  eH1_0                -2.642839e-01 1 1  ON 30
  eH1_1                -1.569946e-01 1 1  ON 31
  eH1_2                -1.071110e-01 1 1  ON 32
  eH1_3                -5.112468e-02 1 1  ON 33
  eH1_4                -7.333879e-04 1 1  ON 34
  eH1_5                 3.613161e-02 1 1  ON 35
  eH1_6                 9.814618e-02 1 1  ON 36
  eH1_7                 1.589154e-01 1 1  ON 37
  eH1_8                 1.948053e-01 1 1  ON 38
  eH1_9                 9.194811e-02 1 1  ON 39
  eH2_0                -2.630766e-01 1 1  ON 40
  eH2_1                -1.551572e-01 1 1  ON 41
  eH2_2                -1.050307e-01 1 1  ON 42
  eH2_3                -4.930407e-02 1 1  ON 43
  eH2_4                 1.245197e-03 1 1  ON 44
  eH2_5                 3.752533e-02 1 1  ON 45
  eH2_6                 9.979627e-02 1 1  ON 46
  eH2_7                 1.610400e-01 1 1  ON 47
  eH2_8                 1.990414e-01 1 1  ON 48
  eH2_9                 8.505665e-02 1 1  ON 49
ci_0001                 7.013521e-01 3 1  ON 50
ci_0002                 7.007985e-01 3 1  ON 51
ci_0003                -2.782357e-02 3 1  ON 52
ci_0004                -2.695916e-02 3 1  ON 53
ci_0005                -3.656661e-02 3 1  ON 54
ci_0006                -3.655364e-02 3 1  ON 55
ci_0007                -2.124070e-02 3 1  ON 56
ci_0008                -2.090363e-02 3 1  ON 57
ci_0009                -1.775362e-02 3 1  ON 58
ci_0010                -1.759665e-02 3 1  ON 59
ci_0011                -1.213973e-02 3 1  ON 60
ci_0012                -1.193764e-02 3 1  ON 61
ci_0013                 1.286922e-02 3 1  ON 62
ci_0014                 1.286665e-02 3 1  ON 63
ci_0015                 1.289009e-02 3 1  ON 64
ci_0016                 1.246075e-02 3 1  ON 65
ci_0017                 1.137353e-02 3 1  ON 66
ci_0018                 1.115987e-02 3 1  ON 67
ci_0019                 1.107543e-02 3 1  ON 68
ci_0020                 1.182685e-02 3 1  ON 69
ci_0021                -2.542385e-03 3 1  ON 70
ci_0022                -6.439809e-04 3 1  ON 71
ci_0023                -1.101834e-02 3 1  ON 72
ci_0024                -1.142615e-02 3 1  ON 73
ci_0025                -1.115944e-02 3 1  ON 74
ci_0026                -1.086072e-02 3 1  ON 75
ci_0027                -1.105217e-02 3 1  ON 76
ci_0028                -1.090055e-02 3 1  ON 77
ci_0029                -1.083708e-02 3 1  ON 78
ci_0030                -1.072853e-02 3 1  ON 79
ci_0031                 2.130770e-02 3 1  ON 80
ci_0032                 2.015107e-02 3 1  ON 81
ci_0033                 1.007388e-02 3 1  ON 82
ci_0034                 1.055665e-02 3 1  ON 83
ci_0035                 6.581256e-03 3 1  ON 84
ci_0036                 6.401005e-03 3 1  ON 85
ci_0037                -1.065674e-02 3 1  ON 86
ci_0038                -1.124083e-02 3 1  ON 87
ci_0039                -2.424293e-03 3 1  ON 88
ci_0040                -2.460685e-03 3 1  ON 89
ci_0041                 7.082580e-03 3 1  ON 90
ci_0042                 6.599147e-03 3 1  ON 91
ci_0043                -1.830297e-02 3 1  ON 92
ci_0044                -1.929423e-02 3 1  ON 93
ci_0045                 6.794001e-03 3 1  ON 94
ci_0046                 6.789881e-03 3 1  ON 95
ci_0047                -1.736244e-03 3 1  ON 96
ci_0048                -2.083719e-03 3 1  ON 97
ci_0049                -4.780792e-03 3 1  ON 98
ci_0050                -4.775960e-03 3 1  ON 99
ci_0051                -3.192660e-03 3 1  ON 100
ci_0052                -3.450053e-03 3 1  ON 101
ci_0053                -4.273821e-03 3 1  ON 102
ci_0054                -4.407005e-03 3 1  ON 103
ci_0055                 6.769908e-03 3 1  ON 104
ci_0056                 6.005352e-03 3 1  ON 105
ci_0057                 4.907161e-03 3 1  ON 106
ci_0058                 4.836552e-03 3 1  ON 107
ci_0059                -4.847476e-03 3 1  ON 108
ci_0060                -5.038712e-03 3 1  ON 109
ci_0061                -4.190460e-03 3 1  ON 110
ci_0062                -3.317186e-03 3 1  ON 111
ci_0063                -8.685780e-03 3 1  ON 112
ci_0064                -8.605806e-03 3 1  ON 113
ci_0065                -4.980796e-03 3 1  ON 114
ci_0066                -5.171929e-03 3 1  ON 115
ci_0067                -5.269860e-03 3 1  ON 116
ci_0068                -4.912049e-03 3 1  ON 117
ci_0069                 4.303040e-03 3 1  ON 118
ci_0070                 4.316766e-03 3 1  ON 119
ci_0071                 4.127494e-04 3 1  ON 120
ci_0072                 2.529501e-04 3 1  ON 121
ci_0073                 4.024497e-03 3 1  ON 122
ci_0074                 4.086750e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -16.9621
    reference variance = 0.174657
====================================================
  Execution time = 2.0922e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s058
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4428e-01
  Total weights = 1.9517e+06
  Execution time = 1.9196e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331215893699
                                         uncertainty =       0.009673595816

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331215893699
                                         uncertainty =       0.009673595816

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406960428
  error estimate for blocks of size 2^( 2) =       0.000419634741
  error estimate for blocks of size 2^( 3) =       0.000432549122
  error estimate for blocks of size 2^( 4) =       0.000442281830
  error estimate for blocks of size 2^( 5) =       0.000454290064
  error estimate for blocks of size 2^( 6) =       0.000465327183
  error estimate for blocks of size 2^( 7) =       0.000475117659

      target function =                  N/A
              le_mean =     -16.906453013418
             les_mean =     286.645085634008
             stat err =       0.000459254184
             autocorr =       1.273508593922
              std dev =       0.575528956668
             le_variance =       0.331233579964

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331231075963
                                         uncertainty =       0.009806960061

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331231075963
                                         uncertainty =       0.009806960061

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406970037
  error estimate for blocks of size 2^( 2) =       0.000419658509
  error estimate for blocks of size 2^( 3) =       0.000432561218
  error estimate for blocks of size 2^( 4) =       0.000442244542
  error estimate for blocks of size 2^( 5) =       0.000454267028
  error estimate for blocks of size 2^( 6) =       0.000465305665
  error estimate for blocks of size 2^( 7) =       0.000475174140

      target function =                  N/A
              le_mean =     -16.906457390173
             les_mean =     286.172739184262
             stat err =       0.000459247844
             autocorr =       1.273413299299
              std dev =       0.575542545364
             le_variance =       0.331249221524

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331194247784
                                         uncertainty =       0.009758670886

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331194247784
                                         uncertainty =       0.009758670886

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406947352
  error estimate for blocks of size 2^( 2) =       0.000419637420
  error estimate for blocks of size 2^( 3) =       0.000432544954
  error estimate for blocks of size 2^( 4) =       0.000442246693
  error estimate for blocks of size 2^( 5) =       0.000454260565
  error estimate for blocks of size 2^( 6) =       0.000465289507
  error estimate for blocks of size 2^( 7) =       0.000475134633

      target function =                  N/A
              le_mean =     -16.906455227137
             les_mean =     286.172576588226
             stat err =       0.000459232850
             autocorr =       1.273472111459
              std dev =       0.575510464391
             le_variance =       0.331212294623

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331176063531
                                         uncertainty =       0.009684953889

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331176063531
                                         uncertainty =       0.009684953889

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406936087
  error estimate for blocks of size 2^( 2) =       0.000419627671
  error estimate for blocks of size 2^( 3) =       0.000432540190
  error estimate for blocks of size 2^( 4) =       0.000442270216
  error estimate for blocks of size 2^( 5) =       0.000454269547
  error estimate for blocks of size 2^( 6) =       0.000465283952
  error estimate for blocks of size 2^( 7) =       0.000475091850

      target function =                  N/A
              le_mean =     -16.906456474206
             les_mean =     286.173185479812
             stat err =       0.000459228891
             autocorr =       1.273520663469
              std dev =       0.575494533502
             le_variance =       0.331193958091


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906453013418        initial
     5.5511e-01     5.5511e+00             8.9561e-04       -16.906457390173  <--
     2.2204e+00     2.2204e+01             2.7592e-04       -16.906455227137
     8.8818e+00     8.8818e+01             7.3191e-05       -16.906456474206

*****************************************************************************
Applying the update for shift_i =   5.5511e-01     and shift_s =   5.5511e+00
*****************************************************************************

  Execution time = 3.0606e+01
  </log>
  <optVariables href="H2O.s058.opt.xml">
   uu_0                 3.136483e-01 1 1  ON 0
   uu_1                 1.458956e-01 1 1  ON 1
   uu_2                 4.359631e-02 1 1  ON 2
   uu_3                -1.945232e-02 1 1  ON 3
   uu_4                -6.610329e-02 1 1  ON 4
   uu_5                -1.023593e-01 1 1  ON 5
   uu_6                -1.319431e-01 1 1  ON 6
   uu_7                -1.475113e-01 1 1  ON 7
   uu_8                -1.417669e-01 1 1  ON 8
   uu_9                -1.139117e-01 1 1  ON 9
   ud_0                 4.518480e-01 1 1  ON 10
   ud_1                 1.859880e-01 1 1  ON 11
   ud_2                 6.520445e-02 1 1  ON 12
   ud_3                -6.208782e-03 1 1  ON 13
   ud_4                -6.377622e-02 1 1  ON 14
   ud_5                -1.062054e-01 1 1  ON 15
   ud_6                -1.349971e-01 1 1  ON 16
   ud_7                -1.530021e-01 1 1  ON 17
   ud_8                -1.558729e-01 1 1  ON 18
   ud_9                -1.463504e-01 1 1  ON 19
   eO_0                -7.489969e-01 1 1  ON 20
   eO_1                -4.281192e-01 1 1  ON 21
   eO_2                -1.666659e-02 1 1  ON 22
   eO_3                 2.971370e-01 1 1  ON 23
   eO_4                 5.251605e-01 1 1  ON 24
   eO_5                 4.897760e-01 1 1  ON 25
   eO_6                 2.627981e-01 1 1  ON 26
   eO_7                -4.239773e-02 1 1  ON 27
   eO_8                -2.350551e-01 1 1  ON 28
   eO_9                -1.001106e-01 1 1  ON 29
  eH1_0                -2.642676e-01 1 1  ON 30
  eH1_1                -1.570922e-01 1 1  ON 31
  eH1_2                -1.071711e-01 1 1  ON 32
  eH1_3                -5.120935e-02 1 1  ON 33
  eH1_4                -7.809736e-04 1 1  ON 34
  eH1_5                 3.603746e-02 1 1  ON 35
  eH1_6                 9.796928e-02 1 1  ON 36
  eH1_7                 1.589611e-01 1 1  ON 37
  eH1_8                 1.950085e-01 1 1  ON 38
  eH1_9                 9.219627e-02 1 1  ON 39
  eH2_0                -2.630002e-01 1 1  ON 40
  eH2_1                -1.552984e-01 1 1  ON 41
  eH2_2                -1.052009e-01 1 1  ON 42
  eH2_3                -4.933432e-02 1 1  ON 43
  eH2_4                 1.165814e-03 1 1  ON 44
  eH2_5                 3.765980e-02 1 1  ON 45
  eH2_6                 9.975917e-02 1 1  ON 46
  eH2_7                 1.610326e-01 1 1  ON 47
  eH2_8                 1.990901e-01 1 1  ON 48
  eH2_9                 8.526197e-02 1 1  ON 49
ci_0001                 7.014202e-01 3 1  ON 50
ci_0002                 7.007288e-01 3 1  ON 51
ci_0003                -2.781186e-02 3 1  ON 52
ci_0004                -2.721533e-02 3 1  ON 53
ci_0005                -3.665532e-02 3 1  ON 54
ci_0006                -3.666799e-02 3 1  ON 55
ci_0007                -2.143446e-02 3 1  ON 56
ci_0008                -2.074553e-02 3 1  ON 57
ci_0009                -1.755946e-02 3 1  ON 58
ci_0010                -1.753376e-02 3 1  ON 59
ci_0011                -1.209043e-02 3 1  ON 60
ci_0012                -1.187632e-02 3 1  ON 61
ci_0013                 1.285031e-02 3 1  ON 62
ci_0014                 1.295153e-02 3 1  ON 63
ci_0015                 1.296249e-02 3 1  ON 64
ci_0016                 1.250181e-02 3 1  ON 65
ci_0017                 1.132234e-02 3 1  ON 66
ci_0018                 1.095929e-02 3 1  ON 67
ci_0019                 1.098305e-02 3 1  ON 68
ci_0020                 1.185901e-02 3 1  ON 69
ci_0021                -2.470084e-03 3 1  ON 70
ci_0022                -5.483671e-04 3 1  ON 71
ci_0023                -1.099039e-02 3 1  ON 72
ci_0024                -1.124603e-02 3 1  ON 73
ci_0025                -1.075780e-02 3 1  ON 74
ci_0026                -1.071752e-02 3 1  ON 75
ci_0027                -1.105092e-02 3 1  ON 76
ci_0028                -1.068628e-02 3 1  ON 77
ci_0029                -1.079710e-02 3 1  ON 78
ci_0030                -1.084367e-02 3 1  ON 79
ci_0031                 2.118595e-02 3 1  ON 80
ci_0032                 2.022544e-02 3 1  ON 81
ci_0033                 1.020173e-02 3 1  ON 82
ci_0034                 1.041343e-02 3 1  ON 83
ci_0035                 6.922404e-03 3 1  ON 84
ci_0036                 6.637476e-03 3 1  ON 85
ci_0037                -1.053222e-02 3 1  ON 86
ci_0038                -1.138705e-02 3 1  ON 87
ci_0039                -2.485675e-03 3 1  ON 88
ci_0040                -2.484888e-03 3 1  ON 89
ci_0041                 6.972125e-03 3 1  ON 90
ci_0042                 6.728108e-03 3 1  ON 91
ci_0043                -1.822472e-02 3 1  ON 92
ci_0044                -1.934829e-02 3 1  ON 93
ci_0045                 7.056920e-03 3 1  ON 94
ci_0046                 6.737741e-03 3 1  ON 95
ci_0047                -1.841005e-03 3 1  ON 96
ci_0048                -2.090949e-03 3 1  ON 97
ci_0049                -4.623712e-03 3 1  ON 98
ci_0050                -4.640718e-03 3 1  ON 99
ci_0051                -3.163502e-03 3 1  ON 100
ci_0052                -3.417301e-03 3 1  ON 101
ci_0053                -4.386599e-03 3 1  ON 102
ci_0054                -4.383750e-03 3 1  ON 103
ci_0055                 6.856975e-03 3 1  ON 104
ci_0056                 5.809394e-03 3 1  ON 105
ci_0057                 4.623022e-03 3 1  ON 106
ci_0058                 5.456235e-03 3 1  ON 107
ci_0059                -4.594783e-03 3 1  ON 108
ci_0060                -5.043136e-03 3 1  ON 109
ci_0061                -4.120368e-03 3 1  ON 110
ci_0062                -3.280911e-03 3 1  ON 111
ci_0063                -8.973128e-03 3 1  ON 112
ci_0064                -8.418619e-03 3 1  ON 113
ci_0065                -5.136146e-03 3 1  ON 114
ci_0066                -5.061684e-03 3 1  ON 115
ci_0067                -5.160675e-03 3 1  ON 116
ci_0068                -4.858073e-03 3 1  ON 117
ci_0069                 4.247800e-03 3 1  ON 118
ci_0070                 4.397576e-03 3 1  ON 119
ci_0071                 5.520927e-04 3 1  ON 120
ci_0072                 2.112409e-04 3 1  ON 121
ci_0073                 3.961127e-03 3 1  ON 122
ci_0074                 4.543910e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8220e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s059 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s059 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=59  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -16.9043
    reference variance = 0.421479
====================================================
  Execution time = 2.1489e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s059
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5247e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3920e-01
  Total weights = 1.951770738e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1060e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324389131592
                                         uncertainty =       0.002899062865

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324389131592
                                         uncertainty =       0.002899062865

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402676158
  error estimate for blocks of size 2^( 2) =       0.000415132267
  error estimate for blocks of size 2^( 3) =       0.000427820080
  error estimate for blocks of size 2^( 4) =       0.000439892882
  error estimate for blocks of size 2^( 5) =       0.000451056438
  error estimate for blocks of size 2^( 6) =       0.000458812734
  error estimate for blocks of size 2^( 7) =       0.000463060026

      target function =                  N/A
              le_mean =     -16.905555060955
             les_mean =     286.136995387418
             stat err =       0.000453205520
             autocorr =       1.266713938777
              std dev =       0.569470083280
             le_variance =       0.324296175751


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690555506095e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3878e-01, overlap shift 1.3878e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905555060949       residual = 1.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905567992747       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905569062279       residual = 7.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905568874451       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905570442161       residual = 6.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905570117519       residual = 5.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905571761021       residual = 4.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905572461245       residual = 2.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905573881819       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905573321278       residual = 8.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905572680760       residual = 4.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905572208222       residual = 1.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905572117227       residual = 9.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.3878e-01 is 1.424587e-03

solving harmonic davidson linear method for identity shift 5.5511e-01, overlap shift 5.5511e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905555060949       residual = 1.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905561142352       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905561589617       residual = 3.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905561578921       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905562388011       residual = 4.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905562472673       residual = 3.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905562366116       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905562700753       residual = 8.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905562968083       residual = 2.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905562902870       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905562813204       residual = 3.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.5511e-01 is 6.061023e-04

solving harmonic davidson linear method for identity shift 2.2204e+00, overlap shift 2.2204e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905555060949       residual = 1.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905557010784       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905557162675       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905557181508       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905557462707       residual = 4.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905557567895       residual = 2.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905557409475       residual = 9.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905557455950       residual = 3.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905557495200       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905557520522       residual = 4.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.2204e+00 is 1.927667e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.547290 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7613e+01
  </log>
  <optVariables href="H2O.s059.opt.xml">
   uu_0                 3.136385e-01 1 1  ON 0
   uu_1                 1.458399e-01 1 1  ON 1
   uu_2                 4.365448e-02 1 1  ON 2
   uu_3                -1.944596e-02 1 1  ON 3
   uu_4                -6.618811e-02 1 1  ON 4
   uu_5                -1.025016e-01 1 1  ON 5
   uu_6                -1.318773e-01 1 1  ON 6
   uu_7                -1.474668e-01 1 1  ON 7
   uu_8                -1.417512e-01 1 1  ON 8
   uu_9                -1.140048e-01 1 1  ON 9
   ud_0                 4.519299e-01 1 1  ON 10
   ud_1                 1.859313e-01 1 1  ON 11
   ud_2                 6.514786e-02 1 1  ON 12
   ud_3                -6.176746e-03 1 1  ON 13
   ud_4                -6.367803e-02 1 1  ON 14
   ud_5                -1.062967e-01 1 1  ON 15
   ud_6                -1.349032e-01 1 1  ON 16
   ud_7                -1.531196e-01 1 1  ON 17
   ud_8                -1.558006e-01 1 1  ON 18
   ud_9                -1.462731e-01 1 1  ON 19
   eO_0                -7.490477e-01 1 1  ON 20
   eO_1                -4.279807e-01 1 1  ON 21
   eO_2                -1.655208e-02 1 1  ON 22
   eO_3                 2.971664e-01 1 1  ON 23
   eO_4                 5.251586e-01 1 1  ON 24
   eO_5                 4.898378e-01 1 1  ON 25
   eO_6                 2.629848e-01 1 1  ON 26
   eO_7                -4.240914e-02 1 1  ON 27
   eO_8                -2.352441e-01 1 1  ON 28
   eO_9                -1.003472e-01 1 1  ON 29
  eH1_0                -2.644887e-01 1 1  ON 30
  eH1_1                -1.571520e-01 1 1  ON 31
  eH1_2                -1.070923e-01 1 1  ON 32
  eH1_3                -5.130700e-02 1 1  ON 33
  eH1_4                -8.748075e-04 1 1  ON 34
  eH1_5                 3.580583e-02 1 1  ON 35
  eH1_6                 9.799335e-02 1 1  ON 36
  eH1_7                 1.589463e-01 1 1  ON 37
  eH1_8                 1.952107e-01 1 1  ON 38
  eH1_9                 9.254345e-02 1 1  ON 39
  eH2_0                -2.631040e-01 1 1  ON 40
  eH2_1                -1.555335e-01 1 1  ON 41
  eH2_2                -1.052426e-01 1 1  ON 42
  eH2_3                -4.945115e-02 1 1  ON 43
  eH2_4                 1.172120e-03 1 1  ON 44
  eH2_5                 3.749541e-02 1 1  ON 45
  eH2_6                 9.972769e-02 1 1  ON 46
  eH2_7                 1.611154e-01 1 1  ON 47
  eH2_8                 1.993347e-01 1 1  ON 48
  eH2_9                 8.561854e-02 1 1  ON 49
ci_0001                 7.013582e-01 3 1  ON 50
ci_0002                 7.008013e-01 3 1  ON 51
ci_0003                -2.771415e-02 3 1  ON 52
ci_0004                -2.740258e-02 3 1  ON 53
ci_0005                -3.659051e-02 3 1  ON 54
ci_0006                -3.645710e-02 3 1  ON 55
ci_0007                -2.105711e-02 3 1  ON 56
ci_0008                -2.107778e-02 3 1  ON 57
ci_0009                -1.717205e-02 3 1  ON 58
ci_0010                -1.751726e-02 3 1  ON 59
ci_0011                -1.195121e-02 3 1  ON 60
ci_0012                -1.197164e-02 3 1  ON 61
ci_0013                 1.330946e-02 3 1  ON 62
ci_0014                 1.309232e-02 3 1  ON 63
ci_0015                 1.282019e-02 3 1  ON 64
ci_0016                 1.231712e-02 3 1  ON 65
ci_0017                 1.128494e-02 3 1  ON 66
ci_0018                 1.098058e-02 3 1  ON 67
ci_0019                 1.100927e-02 3 1  ON 68
ci_0020                 1.180493e-02 3 1  ON 69
ci_0021                -2.380763e-03 3 1  ON 70
ci_0022                -6.442831e-04 3 1  ON 71
ci_0023                -1.118388e-02 3 1  ON 72
ci_0024                -1.125118e-02 3 1  ON 73
ci_0025                -1.092188e-02 3 1  ON 74
ci_0026                -1.035777e-02 3 1  ON 75
ci_0027                -1.137589e-02 3 1  ON 76
ci_0028                -1.094524e-02 3 1  ON 77
ci_0029                -1.065961e-02 3 1  ON 78
ci_0030                -1.089819e-02 3 1  ON 79
ci_0031                 2.097564e-02 3 1  ON 80
ci_0032                 2.037331e-02 3 1  ON 81
ci_0033                 9.987145e-03 3 1  ON 82
ci_0034                 1.022930e-02 3 1  ON 83
ci_0035                 6.785896e-03 3 1  ON 84
ci_0036                 6.426809e-03 3 1  ON 85
ci_0037                -1.068847e-02 3 1  ON 86
ci_0038                -1.127615e-02 3 1  ON 87
ci_0039                -2.497271e-03 3 1  ON 88
ci_0040                -2.358138e-03 3 1  ON 89
ci_0041                 6.873155e-03 3 1  ON 90
ci_0042                 6.742080e-03 3 1  ON 91
ci_0043                -1.842451e-02 3 1  ON 92
ci_0044                -1.943439e-02 3 1  ON 93
ci_0045                 7.089849e-03 3 1  ON 94
ci_0046                 6.808186e-03 3 1  ON 95
ci_0047                -1.612049e-03 3 1  ON 96
ci_0048                -2.364035e-03 3 1  ON 97
ci_0049                -4.761000e-03 3 1  ON 98
ci_0050                -5.246820e-03 3 1  ON 99
ci_0051                -3.122038e-03 3 1  ON 100
ci_0052                -3.530632e-03 3 1  ON 101
ci_0053                -4.669279e-03 3 1  ON 102
ci_0054                -4.246061e-03 3 1  ON 103
ci_0055                 6.667458e-03 3 1  ON 104
ci_0056                 5.856540e-03 3 1  ON 105
ci_0057                 4.722022e-03 3 1  ON 106
ci_0058                 5.450992e-03 3 1  ON 107
ci_0059                -4.764542e-03 3 1  ON 108
ci_0060                -4.748581e-03 3 1  ON 109
ci_0061                -4.231403e-03 3 1  ON 110
ci_0062                -3.259837e-03 3 1  ON 111
ci_0063                -8.789512e-03 3 1  ON 112
ci_0064                -8.326711e-03 3 1  ON 113
ci_0065                -5.471029e-03 3 1  ON 114
ci_0066                -5.178712e-03 3 1  ON 115
ci_0067                -5.115576e-03 3 1  ON 116
ci_0068                -4.882110e-03 3 1  ON 117
ci_0069                 4.186829e-03 3 1  ON 118
ci_0070                 4.258646e-03 3 1  ON 119
ci_0071                 2.519591e-04 3 1  ON 120
ci_0072                 1.475097e-04 3 1  ON 121
ci_0073                 4.351007e-03 3 1  ON 122
ci_0074                 4.425565e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -16.8731
    reference variance = 0.232922
====================================================
  Execution time = 2.0876e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s059
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3573e-01
  Total weights = 1.9517e+06
  Execution time = 1.9142e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324273473801
                                         uncertainty =       0.002385259319

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324273473801
                                         uncertainty =       0.002385259319

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402631237
  error estimate for blocks of size 2^( 2) =       0.000415555624
  error estimate for blocks of size 2^( 3) =       0.000428976882
  error estimate for blocks of size 2^( 4) =       0.000440800859
  error estimate for blocks of size 2^( 5) =       0.000452478582
  error estimate for blocks of size 2^( 6) =       0.000461481772
  error estimate for blocks of size 2^( 7) =       0.000464911559

      target function =                  N/A
              le_mean =     -16.906789151011
             les_mean =     286.921519160686
             stat err =       0.000454918193
             autocorr =       1.276590713640
              std dev =       0.569406555807
             le_variance =       0.324223825796

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324414720383
                                         uncertainty =       0.002467672132

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324414720383
                                         uncertainty =       0.002467672132

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402717936
  error estimate for blocks of size 2^( 2) =       0.000415632095
  error estimate for blocks of size 2^( 3) =       0.000429043760
  error estimate for blocks of size 2^( 4) =       0.000440862111
  error estimate for blocks of size 2^( 5) =       0.000452543860
  error estimate for blocks of size 2^( 6) =       0.000461524710
  error estimate for blocks of size 2^( 7) =       0.000465116582

      target function =                  N/A
              le_mean =     -16.906803447575
             les_mean =     286.217798979342
             stat err =       0.000455011816
             autocorr =       1.276566387813
              std dev =       0.569529166499
             le_variance =       0.324363471493

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324784438453
                                         uncertainty =       0.002476680824

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324784438453
                                         uncertainty =       0.002476680824

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402946954
  error estimate for blocks of size 2^( 2) =       0.000415866507
  error estimate for blocks of size 2^( 3) =       0.000429270975
  error estimate for blocks of size 2^( 4) =       0.000441078208
  error estimate for blocks of size 2^( 5) =       0.000452804666
  error estimate for blocks of size 2^( 6) =       0.000461742823
  error estimate for blocks of size 2^( 7) =       0.000465369946

      target function =                  N/A
              le_mean =     -16.906782311942
             les_mean =     287.145603956319
             stat err =       0.000455248911
             autocorr =       1.276444911769
              std dev =       0.569853047235
             le_variance =       0.324732495443

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323936477350
                                         uncertainty =       0.002414901690

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323936477350
                                         uncertainty =       0.002414901690

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402422341
  error estimate for blocks of size 2^( 2) =       0.000415351623
  error estimate for blocks of size 2^( 3) =       0.000428774261
  error estimate for blocks of size 2^( 4) =       0.000440595450
  error estimate for blocks of size 2^( 5) =       0.000452289476
  error estimate for blocks of size 2^( 6) =       0.000461322006
  error estimate for blocks of size 2^( 7) =       0.000464888141

      target function =                  N/A
              le_mean =     -16.906799808068
             les_mean =     286.177237339761
             stat err =       0.000454773768
             autocorr =       1.277105120298
              std dev =       0.569111132287
             le_variance =       0.323887480893


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906789151011        initial
     1.3878e-01     1.3878e+00             1.4246e-03       -16.906803447575  <--
     5.5511e-01     5.5511e+00             6.0610e-04       -16.906782311942
     2.2204e+00     2.2204e+01             1.9277e-04       -16.906799808068

*****************************************************************************
Applying the update for shift_i =   1.3878e-01     and shift_s =   1.3878e+00
*****************************************************************************

  Execution time = 3.0550e+01
  </log>
  <optVariables href="H2O.s059.opt.xml">
   uu_0                 3.136054e-01 1 1  ON 0
   uu_1                 1.457747e-01 1 1  ON 1
   uu_2                 4.365180e-02 1 1  ON 2
   uu_3                -1.950107e-02 1 1  ON 3
   uu_4                -6.632487e-02 1 1  ON 4
   uu_5                -1.026857e-01 1 1  ON 5
   uu_6                -1.318567e-01 1 1  ON 6
   uu_7                -1.474028e-01 1 1  ON 7
   uu_8                -1.416897e-01 1 1  ON 8
   uu_9                -1.142616e-01 1 1  ON 9
   ud_0                 4.520201e-01 1 1  ON 10
   ud_1                 1.859093e-01 1 1  ON 11
   ud_2                 6.514298e-02 1 1  ON 12
   ud_3                -6.114567e-03 1 1  ON 13
   ud_4                -6.355656e-02 1 1  ON 14
   ud_5                -1.063735e-01 1 1  ON 15
   ud_6                -1.348640e-01 1 1  ON 16
   ud_7                -1.533240e-01 1 1  ON 17
   ud_8                -1.556260e-01 1 1  ON 18
   ud_9                -1.460572e-01 1 1  ON 19
   eO_0                -7.490192e-01 1 1  ON 20
   eO_1                -4.277385e-01 1 1  ON 21
   eO_2                -1.632319e-02 1 1  ON 22
   eO_3                 2.973828e-01 1 1  ON 23
   eO_4                 5.252283e-01 1 1  ON 24
   eO_5                 4.899664e-01 1 1  ON 25
   eO_6                 2.634832e-01 1 1  ON 26
   eO_7                -4.242582e-02 1 1  ON 27
   eO_8                -2.358098e-01 1 1  ON 28
   eO_9                -1.010543e-01 1 1  ON 29
  eH1_0                -2.649661e-01 1 1  ON 30
  eH1_1                -1.573488e-01 1 1  ON 31
  eH1_2                -1.071400e-01 1 1  ON 32
  eH1_3                -5.154824e-02 1 1  ON 33
  eH1_4                -1.164334e-03 1 1  ON 34
  eH1_5                 3.523714e-02 1 1  ON 35
  eH1_6                 9.801426e-02 1 1  ON 36
  eH1_7                 1.588964e-01 1 1  ON 37
  eH1_8                 1.958218e-01 1 1  ON 38
  eH1_9                 9.358265e-02 1 1  ON 39
  eH2_0                -2.634830e-01 1 1  ON 40
  eH2_1                -1.559939e-01 1 1  ON 41
  eH2_2                -1.054852e-01 1 1  ON 42
  eH2_3                -4.975807e-02 1 1  ON 43
  eH2_4                 1.007494e-03 1 1  ON 44
  eH2_5                 3.710729e-02 1 1  ON 45
  eH2_6                 9.962841e-02 1 1  ON 46
  eH2_7                 1.613442e-01 1 1  ON 47
  eH2_8                 2.000692e-01 1 1  ON 48
  eH2_9                 8.668655e-02 1 1  ON 49
ci_0001                 7.011804e-01 3 1  ON 50
ci_0002                 7.009996e-01 3 1  ON 51
ci_0003                -2.758607e-02 3 1  ON 52
ci_0004                -2.765046e-02 3 1  ON 53
ci_0005                -3.647596e-02 3 1  ON 54
ci_0006                -3.612552e-02 3 1  ON 55
ci_0007                -2.035054e-02 3 1  ON 56
ci_0008                -2.167541e-02 3 1  ON 57
ci_0009                -1.674065e-02 3 1  ON 58
ci_0010                -1.750264e-02 3 1  ON 59
ci_0011                -1.178808e-02 3 1  ON 60
ci_0012                -1.207748e-02 3 1  ON 61
ci_0013                 1.384821e-02 3 1  ON 62
ci_0014                 1.324778e-02 3 1  ON 63
ci_0015                 1.266564e-02 3 1  ON 64
ci_0016                 1.208720e-02 3 1  ON 65
ci_0017                 1.124813e-02 3 1  ON 66
ci_0018                 1.100931e-02 3 1  ON 67
ci_0019                 1.102480e-02 3 1  ON 68
ci_0020                 1.173020e-02 3 1  ON 69
ci_0021                -2.215272e-03 3 1  ON 70
ci_0022                -8.273248e-04 3 1  ON 71
ci_0023                -1.139290e-02 3 1  ON 72
ci_0024                -1.124886e-02 3 1  ON 73
ci_0025                -1.110581e-02 3 1  ON 74
ci_0026                -9.955924e-03 3 1  ON 75
ci_0027                -1.173916e-02 3 1  ON 76
ci_0028                -1.125458e-02 3 1  ON 77
ci_0029                -1.048855e-02 3 1  ON 78
ci_0030                -1.095242e-02 3 1  ON 79
ci_0031                 2.060584e-02 3 1  ON 80
ci_0032                 2.062191e-02 3 1  ON 81
ci_0033                 9.630618e-03 3 1  ON 82
ci_0034                 9.919852e-03 3 1  ON 83
ci_0035                 6.607084e-03 3 1  ON 84
ci_0036                 6.141452e-03 3 1  ON 85
ci_0037                -1.092289e-02 3 1  ON 86
ci_0038                -1.111908e-02 3 1  ON 87
ci_0039                -2.513017e-03 3 1  ON 88
ci_0040                -2.245081e-03 3 1  ON 89
ci_0041                 6.745744e-03 3 1  ON 90
ci_0042                 6.751187e-03 3 1  ON 91
ci_0043                -1.877690e-02 3 1  ON 92
ci_0044                -1.960597e-02 3 1  ON 93
ci_0045                 7.143744e-03 3 1  ON 94
ci_0046                 6.906940e-03 3 1  ON 95
ci_0047                -1.418721e-03 3 1  ON 96
ci_0048                -2.600543e-03 3 1  ON 97
ci_0049                -4.917839e-03 3 1  ON 98
ci_0050                -5.954672e-03 3 1  ON 99
ci_0051                -3.090793e-03 3 1  ON 100
ci_0052                -3.633545e-03 3 1  ON 101
ci_0053                -4.923573e-03 3 1  ON 102
ci_0054                -4.109411e-03 3 1  ON 103
ci_0055                 6.384593e-03 3 1  ON 104
ci_0056                 5.922243e-03 3 1  ON 105
ci_0057                 4.859481e-03 3 1  ON 106
ci_0058                 5.442909e-03 3 1  ON 107
ci_0059                -4.922290e-03 3 1  ON 108
ci_0060                -4.470742e-03 3 1  ON 109
ci_0061                -4.375245e-03 3 1  ON 110
ci_0062                -3.217174e-03 3 1  ON 111
ci_0063                -8.604401e-03 3 1  ON 112
ci_0064                -8.229503e-03 3 1  ON 113
ci_0065                -5.834904e-03 3 1  ON 114
ci_0066                -5.316675e-03 3 1  ON 115
ci_0067                -5.063690e-03 3 1  ON 116
ci_0068                -4.906908e-03 3 1  ON 117
ci_0069                 4.130736e-03 3 1  ON 118
ci_0070                 4.141104e-03 3 1  ON 119
ci_0071                -9.569304e-05 3 1  ON 120
ci_0072                 5.391413e-05 3 1  ON 121
ci_0073                 4.701181e-03 3 1  ON 122
ci_0074                 4.327955e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8187e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s060 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s060 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=60  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 60
    time step          = 0.05
    reference energy   = -16.9438
    reference variance = 0.227861
====================================================
  Execution time = 2.1076e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s060
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5253e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3700e-01
  Total weights = 1.951546908e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.2147e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323743869118
                                         uncertainty =       0.002345074513

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323743869118
                                         uncertainty =       0.002345074513

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402283834
  error estimate for blocks of size 2^( 2) =       0.000415433148
  error estimate for blocks of size 2^( 3) =       0.000428335893
  error estimate for blocks of size 2^( 4) =       0.000440408878
  error estimate for blocks of size 2^( 5) =       0.000451923980
  error estimate for blocks of size 2^( 6) =       0.000461078717
  error estimate for blocks of size 2^( 7) =       0.000469461178

      target function =                  N/A
              le_mean =     -16.906506048226
             les_mean =     286.166946753728
             stat err =       0.000455718188
             autocorr =       1.283298137121
              std dev =       0.568915253572
             le_variance =       0.323664565747


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690650604823e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.4694e-02, overlap shift 3.4694e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906506048238       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906525733082       residual = 2.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906532732599       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906527547836       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906533988606       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906528900559       residual = 8.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906532454066       residual = 8.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906533011817       residual = 4.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906534756896       residual = 4.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906537422637       residual = 8.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906537599759       residual = 6.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906536495076       residual = 3.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906536699062       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906537712706       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906538398308       residual = 8.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.906537964811       residual = 5.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.906537389540       residual = 2.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.906537714165       residual = 2.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.906537633916       residual = 8.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.4694e-02 is 5.712667e-03

solving harmonic davidson linear method for identity shift 1.3878e-01, overlap shift 1.3878e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906506048238       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906519954591       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906523343450       residual = 7.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906520778876       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906524470181       residual = 8.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906522177752       residual = 5.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906524556650       residual = 3.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906524962162       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906525326075       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906524957359       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906524895835       residual = 5.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906525010761       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906525120044       residual = 9.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.3878e-01 is 1.426145e-03

solving harmonic davidson linear method for identity shift 5.5511e-01, overlap shift 5.5511e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906506048238       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906512444301       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906513529388       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906512657307       residual = 8.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906514039226       residual = 7.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906513569377       residual = 3.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906514044507       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906514201091       residual = 6.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906514180535       residual = 3.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906514045552       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906514102530       residual = 4.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.5511e-01 is 3.865875e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.561456 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7312e+01
  </log>
  <optVariables href="H2O.s060.opt.xml">
   uu_0                 3.135392e-01 1 1  ON 0
   uu_1                 1.457786e-01 1 1  ON 1
   uu_2                 4.352858e-02 1 1  ON 2
   uu_3                -1.968569e-02 1 1  ON 3
   uu_4                -6.648040e-02 1 1  ON 4
   uu_5                -1.027386e-01 1 1  ON 5
   uu_6                -1.323444e-01 1 1  ON 6
   uu_7                -1.475085e-01 1 1  ON 7
   uu_8                -1.418764e-01 1 1  ON 8
   uu_9                -1.143891e-01 1 1  ON 9
   ud_0                 4.516749e-01 1 1  ON 10
   ud_1                 1.856966e-01 1 1  ON 11
   ud_2                 6.515112e-02 1 1  ON 12
   ud_3                -6.009299e-03 1 1  ON 13
   ud_4                -6.347139e-02 1 1  ON 14
   ud_5                -1.061783e-01 1 1  ON 15
   ud_6                -1.349470e-01 1 1  ON 16
   ud_7                -1.527736e-01 1 1  ON 17
   ud_8                -1.550602e-01 1 1  ON 18
   ud_9                -1.462464e-01 1 1  ON 19
   eO_0                -7.485475e-01 1 1  ON 20
   eO_1                -4.275272e-01 1 1  ON 21
   eO_2                -1.608497e-02 1 1  ON 22
   eO_3                 2.978411e-01 1 1  ON 23
   eO_4                 5.250187e-01 1 1  ON 24
   eO_5                 4.903050e-01 1 1  ON 25
   eO_6                 2.632169e-01 1 1  ON 26
   eO_7                -4.227813e-02 1 1  ON 27
   eO_8                -2.362177e-01 1 1  ON 28
   eO_9                -1.018717e-01 1 1  ON 29
  eH1_0                -2.652980e-01 1 1  ON 30
  eH1_1                -1.579268e-01 1 1  ON 31
  eH1_2                -1.074026e-01 1 1  ON 32
  eH1_3                -5.171793e-02 1 1  ON 33
  eH1_4                -1.723847e-03 1 1  ON 34
  eH1_5                 3.478924e-02 1 1  ON 35
  eH1_6                 9.840093e-02 1 1  ON 36
  eH1_7                 1.592722e-01 1 1  ON 37
  eH1_8                 1.964987e-01 1 1  ON 38
  eH1_9                 9.448539e-02 1 1  ON 39
  eH2_0                -2.638645e-01 1 1  ON 40
  eH2_1                -1.562141e-01 1 1  ON 41
  eH2_2                -1.058843e-01 1 1  ON 42
  eH2_3                -5.001623e-02 1 1  ON 43
  eH2_4                -4.955465e-05 1 1  ON 44
  eH2_5                 3.707654e-02 1 1  ON 45
  eH2_6                 9.930042e-02 1 1  ON 46
  eH2_7                 1.614582e-01 1 1  ON 47
  eH2_8                 2.008008e-01 1 1  ON 48
  eH2_9                 8.811270e-02 1 1  ON 49
ci_0001                 7.008485e-01 3 1  ON 50
ci_0002                 7.013518e-01 3 1  ON 51
ci_0003                -2.791579e-02 3 1  ON 52
ci_0004                -2.734182e-02 3 1  ON 53
ci_0005                -3.644029e-02 3 1  ON 54
ci_0006                -3.660807e-02 3 1  ON 55
ci_0007                -2.062608e-02 3 1  ON 56
ci_0008                -2.062417e-02 3 1  ON 57
ci_0009                -1.747745e-02 3 1  ON 58
ci_0010                -1.743737e-02 3 1  ON 59
ci_0011                -1.222585e-02 3 1  ON 60
ci_0012                -1.232398e-02 3 1  ON 61
ci_0013                 1.304489e-02 3 1  ON 62
ci_0014                 1.322419e-02 3 1  ON 63
ci_0015                 1.241177e-02 3 1  ON 64
ci_0016                 1.275161e-02 3 1  ON 65
ci_0017                 1.129201e-02 3 1  ON 66
ci_0018                 1.165996e-02 3 1  ON 67
ci_0019                 1.114549e-02 3 1  ON 68
ci_0020                 1.151069e-02 3 1  ON 69
ci_0021                -1.097852e-03 3 1  ON 70
ci_0022                -8.900405e-04 3 1  ON 71
ci_0023                -1.162696e-02 3 1  ON 72
ci_0024                -1.122652e-02 3 1  ON 73
ci_0025                -1.036858e-02 3 1  ON 74
ci_0026                -1.007209e-02 3 1  ON 75
ci_0027                -1.164669e-02 3 1  ON 76
ci_0028                -1.092248e-02 3 1  ON 77
ci_0029                -1.121742e-02 3 1  ON 78
ci_0030                -1.027072e-02 3 1  ON 79
ci_0031                 2.046427e-02 3 1  ON 80
ci_0032                 1.965155e-02 3 1  ON 81
ci_0033                 1.002085e-02 3 1  ON 82
ci_0034                 9.130043e-03 3 1  ON 83
ci_0035                 7.106814e-03 3 1  ON 84
ci_0036                 5.820638e-03 3 1  ON 85
ci_0037                -1.046220e-02 3 1  ON 86
ci_0038                -1.130305e-02 3 1  ON 87
ci_0039                -2.423289e-03 3 1  ON 88
ci_0040                -2.778730e-03 3 1  ON 89
ci_0041                 7.537632e-03 3 1  ON 90
ci_0042                 7.209193e-03 3 1  ON 91
ci_0043                -1.930438e-02 3 1  ON 92
ci_0044                -1.938162e-02 3 1  ON 93
ci_0045                 7.028241e-03 3 1  ON 94
ci_0046                 6.886436e-03 3 1  ON 95
ci_0047                -1.645244e-03 3 1  ON 96
ci_0048                -2.078203e-03 3 1  ON 97
ci_0049                -5.317751e-03 3 1  ON 98
ci_0050                -6.046381e-03 3 1  ON 99
ci_0051                -3.431688e-03 3 1  ON 100
ci_0052                -3.869515e-03 3 1  ON 101
ci_0053                -4.723986e-03 3 1  ON 102
ci_0054                -4.295050e-03 3 1  ON 103
ci_0055                 5.840090e-03 3 1  ON 104
ci_0056                 5.857259e-03 3 1  ON 105
ci_0057                 4.691985e-03 3 1  ON 106
ci_0058                 4.806076e-03 3 1  ON 107
ci_0059                -5.065307e-03 3 1  ON 108
ci_0060                -4.629609e-03 3 1  ON 109
ci_0061                -4.023419e-03 3 1  ON 110
ci_0062                -2.985575e-03 3 1  ON 111
ci_0063                -8.235955e-03 3 1  ON 112
ci_0064                -8.467435e-03 3 1  ON 113
ci_0065                -5.960848e-03 3 1  ON 114
ci_0066                -5.749264e-03 3 1  ON 115
ci_0067                -4.754315e-03 3 1  ON 116
ci_0068                -4.617063e-03 3 1  ON 117
ci_0069                 4.644637e-03 3 1  ON 118
ci_0070                 4.612843e-03 3 1  ON 119
ci_0071                -1.342763e-04 3 1  ON 120
ci_0072                -2.330396e-04 3 1  ON 121
ci_0073                 4.326574e-03 3 1  ON 122
ci_0074                 3.923056e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 60
    time step          = 0.05
    reference energy   = -16.8803
    reference variance = 0.261179
====================================================
  Execution time = 2.0725e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s060
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4174e-01
  Total weights = 1.9517e+06
  Execution time = 1.9179e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327698061825
                                         uncertainty =       0.003392303871

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327698061825
                                         uncertainty =       0.003392303871

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404726451
  error estimate for blocks of size 2^( 2) =       0.000417663298
  error estimate for blocks of size 2^( 3) =       0.000430795573
  error estimate for blocks of size 2^( 4) =       0.000442604630
  error estimate for blocks of size 2^( 5) =       0.000453033771
  error estimate for blocks of size 2^( 6) =       0.000461511876
  error estimate for blocks of size 2^( 7) =       0.000465679619

      target function =                  N/A
              le_mean =     -16.905664374570
             les_mean =     286.160583013083
             stat err =       0.000455707474
             autocorr =       1.267795268225
              std dev =       0.572369635376
             le_variance =       0.327606999500

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327757681504
                                         uncertainty =       0.004671872954

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327757681504
                                         uncertainty =       0.004671872954

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404762866
  error estimate for blocks of size 2^( 2) =       0.000417676823
  error estimate for blocks of size 2^( 3) =       0.000430818233
  error estimate for blocks of size 2^( 4) =       0.000442611519
  error estimate for blocks of size 2^( 5) =       0.000453045997
  error estimate for blocks of size 2^( 6) =       0.000461437752
  error estimate for blocks of size 2^( 7) =       0.000465515129

      target function =                  N/A
              le_mean =     -16.905618101639
             les_mean =     286.144006628042
             stat err =       0.000455652599
             autocorr =       1.267261903650
              std dev =       0.572421134712
             le_variance =       0.327665955465

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328231775865
                                         uncertainty =       0.005158178480

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328231775865
                                         uncertainty =       0.005158178480

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405054644
  error estimate for blocks of size 2^( 2) =       0.000417953022
  error estimate for blocks of size 2^( 3) =       0.000431085708
  error estimate for blocks of size 2^( 4) =       0.000442856903
  error estimate for blocks of size 2^( 5) =       0.000453276774
  error estimate for blocks of size 2^( 6) =       0.000461656958
  error estimate for blocks of size 2^( 7) =       0.000465720893

      target function =                  N/A
              le_mean =     -16.905634916645
             les_mean =     286.147685457972
             stat err =       0.000455877882
             autocorr =       1.266688456132
              std dev =       0.572833770719
             le_variance =       0.328138528876

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327214821606
                                         uncertainty =       0.003525587206

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327214821606
                                         uncertainty =       0.003525587206

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404428303
  error estimate for blocks of size 2^( 2) =       0.000417358494
  error estimate for blocks of size 2^( 3) =       0.000430504028
  error estimate for blocks of size 2^( 4) =       0.000442311524
  error estimate for blocks of size 2^( 5) =       0.000452743967
  error estimate for blocks of size 2^( 6) =       0.000461194418
  error estimate for blocks of size 2^( 7) =       0.000465328963

      target function =                  N/A
              le_mean =     -16.905646390388
             les_mean =     286.165166874924
             stat err =       0.000455394718
             autocorr =       1.267923043453
              std dev =       0.571947991638
             le_variance =       0.327124505139


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905664374570        initial  <--
     3.4694e-02     3.4694e-01             5.7127e-03       -16.905618101639
     1.3878e-01     1.3878e+00             1.4261e-03       -16.905634916645
     5.5511e-01     5.5511e+00             3.8659e-04       -16.905646390388

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.4254
  </log>
  <optVariables href="H2O.s060.opt.xml">
   uu_0                 3.136054e-01 1 1  ON 0
   uu_1                 1.457747e-01 1 1  ON 1
   uu_2                 4.365180e-02 1 1  ON 2
   uu_3                -1.950107e-02 1 1  ON 3
   uu_4                -6.632487e-02 1 1  ON 4
   uu_5                -1.026857e-01 1 1  ON 5
   uu_6                -1.318567e-01 1 1  ON 6
   uu_7                -1.474028e-01 1 1  ON 7
   uu_8                -1.416897e-01 1 1  ON 8
   uu_9                -1.142616e-01 1 1  ON 9
   ud_0                 4.520201e-01 1 1  ON 10
   ud_1                 1.859093e-01 1 1  ON 11
   ud_2                 6.514298e-02 1 1  ON 12
   ud_3                -6.114567e-03 1 1  ON 13
   ud_4                -6.355656e-02 1 1  ON 14
   ud_5                -1.063735e-01 1 1  ON 15
   ud_6                -1.348640e-01 1 1  ON 16
   ud_7                -1.533240e-01 1 1  ON 17
   ud_8                -1.556260e-01 1 1  ON 18
   ud_9                -1.460572e-01 1 1  ON 19
   eO_0                -7.490192e-01 1 1  ON 20
   eO_1                -4.277385e-01 1 1  ON 21
   eO_2                -1.632319e-02 1 1  ON 22
   eO_3                 2.973828e-01 1 1  ON 23
   eO_4                 5.252283e-01 1 1  ON 24
   eO_5                 4.899664e-01 1 1  ON 25
   eO_6                 2.634832e-01 1 1  ON 26
   eO_7                -4.242582e-02 1 1  ON 27
   eO_8                -2.358098e-01 1 1  ON 28
   eO_9                -1.010543e-01 1 1  ON 29
  eH1_0                -2.649661e-01 1 1  ON 30
  eH1_1                -1.573488e-01 1 1  ON 31
  eH1_2                -1.071400e-01 1 1  ON 32
  eH1_3                -5.154824e-02 1 1  ON 33
  eH1_4                -1.164334e-03 1 1  ON 34
  eH1_5                 3.523714e-02 1 1  ON 35
  eH1_6                 9.801426e-02 1 1  ON 36
  eH1_7                 1.588964e-01 1 1  ON 37
  eH1_8                 1.958218e-01 1 1  ON 38
  eH1_9                 9.358265e-02 1 1  ON 39
  eH2_0                -2.634830e-01 1 1  ON 40
  eH2_1                -1.559939e-01 1 1  ON 41
  eH2_2                -1.054852e-01 1 1  ON 42
  eH2_3                -4.975807e-02 1 1  ON 43
  eH2_4                 1.007494e-03 1 1  ON 44
  eH2_5                 3.710729e-02 1 1  ON 45
  eH2_6                 9.962841e-02 1 1  ON 46
  eH2_7                 1.613442e-01 1 1  ON 47
  eH2_8                 2.000692e-01 1 1  ON 48
  eH2_9                 8.668655e-02 1 1  ON 49
ci_0001                 7.011804e-01 3 1  ON 50
ci_0002                 7.009996e-01 3 1  ON 51
ci_0003                -2.758607e-02 3 1  ON 52
ci_0004                -2.765046e-02 3 1  ON 53
ci_0005                -3.647596e-02 3 1  ON 54
ci_0006                -3.612552e-02 3 1  ON 55
ci_0007                -2.035054e-02 3 1  ON 56
ci_0008                -2.167541e-02 3 1  ON 57
ci_0009                -1.674065e-02 3 1  ON 58
ci_0010                -1.750264e-02 3 1  ON 59
ci_0011                -1.178808e-02 3 1  ON 60
ci_0012                -1.207748e-02 3 1  ON 61
ci_0013                 1.384821e-02 3 1  ON 62
ci_0014                 1.324778e-02 3 1  ON 63
ci_0015                 1.266564e-02 3 1  ON 64
ci_0016                 1.208720e-02 3 1  ON 65
ci_0017                 1.124813e-02 3 1  ON 66
ci_0018                 1.100931e-02 3 1  ON 67
ci_0019                 1.102480e-02 3 1  ON 68
ci_0020                 1.173020e-02 3 1  ON 69
ci_0021                -2.215272e-03 3 1  ON 70
ci_0022                -8.273248e-04 3 1  ON 71
ci_0023                -1.139290e-02 3 1  ON 72
ci_0024                -1.124886e-02 3 1  ON 73
ci_0025                -1.110581e-02 3 1  ON 74
ci_0026                -9.955924e-03 3 1  ON 75
ci_0027                -1.173916e-02 3 1  ON 76
ci_0028                -1.125458e-02 3 1  ON 77
ci_0029                -1.048855e-02 3 1  ON 78
ci_0030                -1.095242e-02 3 1  ON 79
ci_0031                 2.060584e-02 3 1  ON 80
ci_0032                 2.062191e-02 3 1  ON 81
ci_0033                 9.630618e-03 3 1  ON 82
ci_0034                 9.919852e-03 3 1  ON 83
ci_0035                 6.607084e-03 3 1  ON 84
ci_0036                 6.141452e-03 3 1  ON 85
ci_0037                -1.092289e-02 3 1  ON 86
ci_0038                -1.111908e-02 3 1  ON 87
ci_0039                -2.513017e-03 3 1  ON 88
ci_0040                -2.245081e-03 3 1  ON 89
ci_0041                 6.745744e-03 3 1  ON 90
ci_0042                 6.751187e-03 3 1  ON 91
ci_0043                -1.877690e-02 3 1  ON 92
ci_0044                -1.960597e-02 3 1  ON 93
ci_0045                 7.143744e-03 3 1  ON 94
ci_0046                 6.906940e-03 3 1  ON 95
ci_0047                -1.418721e-03 3 1  ON 96
ci_0048                -2.600543e-03 3 1  ON 97
ci_0049                -4.917839e-03 3 1  ON 98
ci_0050                -5.954672e-03 3 1  ON 99
ci_0051                -3.090793e-03 3 1  ON 100
ci_0052                -3.633545e-03 3 1  ON 101
ci_0053                -4.923573e-03 3 1  ON 102
ci_0054                -4.109411e-03 3 1  ON 103
ci_0055                 6.384593e-03 3 1  ON 104
ci_0056                 5.922243e-03 3 1  ON 105
ci_0057                 4.859481e-03 3 1  ON 106
ci_0058                 5.442909e-03 3 1  ON 107
ci_0059                -4.922290e-03 3 1  ON 108
ci_0060                -4.470742e-03 3 1  ON 109
ci_0061                -4.375245e-03 3 1  ON 110
ci_0062                -3.217174e-03 3 1  ON 111
ci_0063                -8.604401e-03 3 1  ON 112
ci_0064                -8.229503e-03 3 1  ON 113
ci_0065                -5.834904e-03 3 1  ON 114
ci_0066                -5.316675e-03 3 1  ON 115
ci_0067                -5.063690e-03 3 1  ON 116
ci_0068                -4.906908e-03 3 1  ON 117
ci_0069                 4.130736e-03 3 1  ON 118
ci_0070                 4.141104e-03 3 1  ON 119
ci_0071                -9.569304e-05 3 1  ON 120
ci_0072                 5.391413e-05 3 1  ON 121
ci_0073                 4.701181e-03 3 1  ON 122
ci_0074                 4.327955e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7762e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s061 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s061 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=61  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 61
    time step          = 0.05
    reference energy   = -16.8634
    reference variance = 0.157474
====================================================
  Execution time = 2.1174e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s061
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5219e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4280e-01
  Total weights = 1.951926054e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1180e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327835241908
                                         uncertainty =       0.003178268646

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327835241908
                                         uncertainty =       0.003178268646

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404842510
  error estimate for blocks of size 2^( 2) =       0.000417491828
  error estimate for blocks of size 2^( 3) =       0.000430915246
  error estimate for blocks of size 2^( 4) =       0.000443310205
  error estimate for blocks of size 2^( 5) =       0.000454666429
  error estimate for blocks of size 2^( 6) =       0.000462423796
  error estimate for blocks of size 2^( 7) =       0.000466153145

      target function =                  N/A
              le_mean =     -16.906304468966
             les_mean =     286.165926609339
             stat err =       0.000456638394
             autocorr =       1.272250497511
              std dev =       0.572533768838
             le_variance =       0.327794916459


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690630446897e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.4694e-01, overlap shift 3.4694e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906304468971       residual = 2.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906324502943       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906324588236       residual = 5.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906324660139       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906323959286       residual = 7.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906324588461       residual = 4.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906325287089       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906325410911       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906325304868       residual = 4.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906325301886       residual = 2.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906325437171       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906325514700       residual = 2.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.4694e-01 is 1.081467e-03

solving harmonic davidson linear method for identity shift 1.3878e+00, overlap shift 1.3878e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906304468971       residual = 2.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906311446368       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906311446289       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906311492559       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906311301598       residual = 6.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906311646206       residual = 2.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906311812926       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906311809671       residual = 4.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906311756217       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906311744837       residual = 5.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.3878e+00 is 3.177379e-04

solving harmonic davidson linear method for identity shift 5.5511e+00, overlap shift 5.5511e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906304468971       residual = 2.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906306403435       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906306403774       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906306424905       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906306377340       residual = 6.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906306466112       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906306518969       residual = 8.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906306527273       residual = 3.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906306505822       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906306502795       residual = 3.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.5511e+00 is 8.319686e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.570978 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7309e+01
  </log>
  <optVariables href="H2O.s061.opt.xml">
   uu_0                 3.135322e-01 1 1  ON 0
   uu_1                 1.457212e-01 1 1  ON 1
   uu_2                 4.364528e-02 1 1  ON 2
   uu_3                -1.950028e-02 1 1  ON 3
   uu_4                -6.629121e-02 1 1  ON 4
   uu_5                -1.026483e-01 1 1  ON 5
   uu_6                -1.319258e-01 1 1  ON 6
   uu_7                -1.474502e-01 1 1  ON 7
   uu_8                -1.416571e-01 1 1  ON 8
   uu_9                -1.142519e-01 1 1  ON 9
   ud_0                 4.519476e-01 1 1  ON 10
   ud_1                 1.859355e-01 1 1  ON 11
   ud_2                 6.519873e-02 1 1  ON 12
   ud_3                -6.097939e-03 1 1  ON 13
   ud_4                -6.362018e-02 1 1  ON 14
   ud_5                -1.063729e-01 1 1  ON 15
   ud_6                -1.348603e-01 1 1  ON 16
   ud_7                -1.532754e-01 1 1  ON 17
   ud_8                -1.556319e-01 1 1  ON 18
   ud_9                -1.460298e-01 1 1  ON 19
   eO_0                -7.489552e-01 1 1  ON 20
   eO_1                -4.277778e-01 1 1  ON 21
   eO_2                -1.634271e-02 1 1  ON 22
   eO_3                 2.974191e-01 1 1  ON 23
   eO_4                 5.252664e-01 1 1  ON 24
   eO_5                 4.900436e-01 1 1  ON 25
   eO_6                 2.634796e-01 1 1  ON 26
   eO_7                -4.244684e-02 1 1  ON 27
   eO_8                -2.358587e-01 1 1  ON 28
   eO_9                -1.011242e-01 1 1  ON 29
  eH1_0                -2.649869e-01 1 1  ON 30
  eH1_1                -1.573575e-01 1 1  ON 31
  eH1_2                -1.072177e-01 1 1  ON 32
  eH1_3                -5.164029e-02 1 1  ON 33
  eH1_4                -1.214389e-03 1 1  ON 34
  eH1_5                 3.520313e-02 1 1  ON 35
  eH1_6                 9.801275e-02 1 1  ON 36
  eH1_7                 1.589989e-01 1 1  ON 37
  eH1_8                 1.958936e-01 1 1  ON 38
  eH1_9                 9.368100e-02 1 1  ON 39
  eH2_0                -2.634675e-01 1 1  ON 40
  eH2_1                -1.559391e-01 1 1  ON 41
  eH2_2                -1.055796e-01 1 1  ON 42
  eH2_3                -4.987228e-02 1 1  ON 43
  eH2_4                 8.937801e-04 1 1  ON 44
  eH2_5                 3.712539e-02 1 1  ON 45
  eH2_6                 9.960592e-02 1 1  ON 46
  eH2_7                 1.613510e-01 1 1  ON 47
  eH2_8                 2.001280e-01 1 1  ON 48
  eH2_9                 8.683917e-02 1 1  ON 49
ci_0001                 7.011337e-01 3 1  ON 50
ci_0002                 7.010428e-01 3 1  ON 51
ci_0003                -2.754235e-02 3 1  ON 52
ci_0004                -2.744433e-02 3 1  ON 53
ci_0005                -3.641337e-02 3 1  ON 54
ci_0006                -3.609938e-02 3 1  ON 55
ci_0007                -2.034418e-02 3 1  ON 56
ci_0008                -2.199314e-02 3 1  ON 57
ci_0009                -1.674999e-02 3 1  ON 58
ci_0010                -1.745809e-02 3 1  ON 59
ci_0011                -1.178264e-02 3 1  ON 60
ci_0012                -1.215092e-02 3 1  ON 61
ci_0013                 1.378805e-02 3 1  ON 62
ci_0014                 1.328044e-02 3 1  ON 63
ci_0015                 1.258642e-02 3 1  ON 64
ci_0016                 1.221084e-02 3 1  ON 65
ci_0017                 1.143781e-02 3 1  ON 66
ci_0018                 1.109602e-02 3 1  ON 67
ci_0019                 1.104047e-02 3 1  ON 68
ci_0020                 1.173474e-02 3 1  ON 69
ci_0021                -2.168903e-03 3 1  ON 70
ci_0022                -8.635587e-04 3 1  ON 71
ci_0023                -1.140569e-02 3 1  ON 72
ci_0024                -1.132535e-02 3 1  ON 73
ci_0025                -1.116534e-02 3 1  ON 74
ci_0026                -9.961166e-03 3 1  ON 75
ci_0027                -1.166002e-02 3 1  ON 76
ci_0028                -1.137545e-02 3 1  ON 77
ci_0029                -1.057404e-02 3 1  ON 78
ci_0030                -1.088363e-02 3 1  ON 79
ci_0031                 2.071413e-02 3 1  ON 80
ci_0032                 2.063471e-02 3 1  ON 81
ci_0033                 9.650789e-03 3 1  ON 82
ci_0034                 9.656258e-03 3 1  ON 83
ci_0035                 6.718160e-03 3 1  ON 84
ci_0036                 6.101457e-03 3 1  ON 85
ci_0037                -1.093060e-02 3 1  ON 86
ci_0038                -1.091939e-02 3 1  ON 87
ci_0039                -2.631161e-03 3 1  ON 88
ci_0040                -2.353088e-03 3 1  ON 89
ci_0041                 6.789745e-03 3 1  ON 90
ci_0042                 6.722495e-03 3 1  ON 91
ci_0043                -1.877901e-02 3 1  ON 92
ci_0044                -1.955054e-02 3 1  ON 93
ci_0045                 7.286439e-03 3 1  ON 94
ci_0046                 6.887046e-03 3 1  ON 95
ci_0047                -1.515467e-03 3 1  ON 96
ci_0048                -2.398094e-03 3 1  ON 97
ci_0049                -4.925187e-03 3 1  ON 98
ci_0050                -5.740453e-03 3 1  ON 99
ci_0051                -3.128196e-03 3 1  ON 100
ci_0052                -3.485448e-03 3 1  ON 101
ci_0053                -4.889255e-03 3 1  ON 102
ci_0054                -4.186002e-03 3 1  ON 103
ci_0055                 6.578852e-03 3 1  ON 104
ci_0056                 6.056194e-03 3 1  ON 105
ci_0057                 4.801459e-03 3 1  ON 106
ci_0058                 5.370320e-03 3 1  ON 107
ci_0059                -4.845011e-03 3 1  ON 108
ci_0060                -4.565312e-03 3 1  ON 109
ci_0061                -4.260231e-03 3 1  ON 110
ci_0062                -3.308301e-03 3 1  ON 111
ci_0063                -8.631793e-03 3 1  ON 112
ci_0064                -8.350819e-03 3 1  ON 113
ci_0065                -5.732142e-03 3 1  ON 114
ci_0066                -5.351836e-03 3 1  ON 115
ci_0067                -5.004515e-03 3 1  ON 116
ci_0068                -4.911117e-03 3 1  ON 117
ci_0069                 4.241368e-03 3 1  ON 118
ci_0070                 4.235875e-03 3 1  ON 119
ci_0071                -4.786111e-06 3 1  ON 120
ci_0072                 1.682300e-04 3 1  ON 121
ci_0073                 4.668714e-03 3 1  ON 122
ci_0074                 4.460281e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 61
    time step          = 0.05
    reference energy   = -16.8436
    reference variance = 0.207667
====================================================
  Execution time = 2.3096e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s061
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3469e-01
  Total weights = 1.9519e+06
  Execution time = 1.9163e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322075895006
                                         uncertainty =       0.002350996721

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322075895006
                                         uncertainty =       0.002350996721

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401280094
  error estimate for blocks of size 2^( 2) =       0.000414544152
  error estimate for blocks of size 2^( 3) =       0.000427554141
  error estimate for blocks of size 2^( 4) =       0.000440607673
  error estimate for blocks of size 2^( 5) =       0.000451361016
  error estimate for blocks of size 2^( 6) =       0.000461931396
  error estimate for blocks of size 2^( 7) =       0.000467664753

      target function =                  N/A
              le_mean =     -16.906334964188
             les_mean =     286.159409835008
             stat err =       0.000455391209
             autocorr =       1.287876006744
              std dev =       0.567495751605
             le_variance =       0.322051428090

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321785340676
                                         uncertainty =       0.002328866778

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321785340676
                                         uncertainty =       0.002328866778

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401099004
  error estimate for blocks of size 2^( 2) =       0.000414367559
  error estimate for blocks of size 2^( 3) =       0.000427373920
  error estimate for blocks of size 2^( 4) =       0.000440421450
  error estimate for blocks of size 2^( 5) =       0.000451183158
  error estimate for blocks of size 2^( 6) =       0.000461750675
  error estimate for blocks of size 2^( 7) =       0.000467501037

      target function =                  N/A
              le_mean =     -16.906330587305
             les_mean =     286.165719596800
             stat err =       0.000455214080
             autocorr =       1.288036607943
              std dev =       0.567239651250
             le_variance =       0.321760821951

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321816306188
                                         uncertainty =       0.002334976025

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321816306188
                                         uncertainty =       0.002334976025

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401118343
  error estimate for blocks of size 2^( 2) =       0.000414386084
  error estimate for blocks of size 2^( 3) =       0.000427394587
  error estimate for blocks of size 2^( 4) =       0.000440443708
  error estimate for blocks of size 2^( 5) =       0.000451208216
  error estimate for blocks of size 2^( 6) =       0.000461778198
  error estimate for blocks of size 2^( 7) =       0.000467511608

      target function =                  N/A
              le_mean =     -16.906328487950
             les_mean =     286.158715751840
             stat err =       0.000455235433
             autocorr =       1.288033236754
              std dev =       0.567267000575
             le_variance =       0.321791849942

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322030276762
                                         uncertainty =       0.002348496259

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322030276762
                                         uncertainty =       0.002348496259

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401251679
  error estimate for blocks of size 2^( 2) =       0.000414516345
  error estimate for blocks of size 2^( 3) =       0.000427526224
  error estimate for blocks of size 2^( 4) =       0.000440579147
  error estimate for blocks of size 2^( 5) =       0.000451334232
  error estimate for blocks of size 2^( 6) =       0.000461905030
  error estimate for blocks of size 2^( 7) =       0.000467637831

      target function =                  N/A
              le_mean =     -16.906333045603
             les_mean =     286.159059012372
             stat err =       0.000455364060
             autocorr =       1.287904840855
              std dev =       0.567455566388
             le_variance =       0.322005819825


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906334964188        initial  <--
     3.4694e-01     3.4694e+00             1.0815e-03       -16.906330587305
     1.3878e+00     1.3878e+01             3.1774e-04       -16.906328487950
     5.5511e+00     5.5511e+01             8.3197e-05       -16.906333045603

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 32.7845
  </log>
  <optVariables href="H2O.s061.opt.xml">
   uu_0                 3.136054e-01 1 1  ON 0
   uu_1                 1.457747e-01 1 1  ON 1
   uu_2                 4.365180e-02 1 1  ON 2
   uu_3                -1.950107e-02 1 1  ON 3
   uu_4                -6.632487e-02 1 1  ON 4
   uu_5                -1.026857e-01 1 1  ON 5
   uu_6                -1.318567e-01 1 1  ON 6
   uu_7                -1.474028e-01 1 1  ON 7
   uu_8                -1.416897e-01 1 1  ON 8
   uu_9                -1.142616e-01 1 1  ON 9
   ud_0                 4.520201e-01 1 1  ON 10
   ud_1                 1.859093e-01 1 1  ON 11
   ud_2                 6.514298e-02 1 1  ON 12
   ud_3                -6.114567e-03 1 1  ON 13
   ud_4                -6.355656e-02 1 1  ON 14
   ud_5                -1.063735e-01 1 1  ON 15
   ud_6                -1.348640e-01 1 1  ON 16
   ud_7                -1.533240e-01 1 1  ON 17
   ud_8                -1.556260e-01 1 1  ON 18
   ud_9                -1.460572e-01 1 1  ON 19
   eO_0                -7.490192e-01 1 1  ON 20
   eO_1                -4.277385e-01 1 1  ON 21
   eO_2                -1.632319e-02 1 1  ON 22
   eO_3                 2.973828e-01 1 1  ON 23
   eO_4                 5.252283e-01 1 1  ON 24
   eO_5                 4.899664e-01 1 1  ON 25
   eO_6                 2.634832e-01 1 1  ON 26
   eO_7                -4.242582e-02 1 1  ON 27
   eO_8                -2.358098e-01 1 1  ON 28
   eO_9                -1.010543e-01 1 1  ON 29
  eH1_0                -2.649661e-01 1 1  ON 30
  eH1_1                -1.573488e-01 1 1  ON 31
  eH1_2                -1.071400e-01 1 1  ON 32
  eH1_3                -5.154824e-02 1 1  ON 33
  eH1_4                -1.164334e-03 1 1  ON 34
  eH1_5                 3.523714e-02 1 1  ON 35
  eH1_6                 9.801426e-02 1 1  ON 36
  eH1_7                 1.588964e-01 1 1  ON 37
  eH1_8                 1.958218e-01 1 1  ON 38
  eH1_9                 9.358265e-02 1 1  ON 39
  eH2_0                -2.634830e-01 1 1  ON 40
  eH2_1                -1.559939e-01 1 1  ON 41
  eH2_2                -1.054852e-01 1 1  ON 42
  eH2_3                -4.975807e-02 1 1  ON 43
  eH2_4                 1.007494e-03 1 1  ON 44
  eH2_5                 3.710729e-02 1 1  ON 45
  eH2_6                 9.962841e-02 1 1  ON 46
  eH2_7                 1.613442e-01 1 1  ON 47
  eH2_8                 2.000692e-01 1 1  ON 48
  eH2_9                 8.668655e-02 1 1  ON 49
ci_0001                 7.011804e-01 3 1  ON 50
ci_0002                 7.009996e-01 3 1  ON 51
ci_0003                -2.758607e-02 3 1  ON 52
ci_0004                -2.765046e-02 3 1  ON 53
ci_0005                -3.647596e-02 3 1  ON 54
ci_0006                -3.612552e-02 3 1  ON 55
ci_0007                -2.035054e-02 3 1  ON 56
ci_0008                -2.167541e-02 3 1  ON 57
ci_0009                -1.674065e-02 3 1  ON 58
ci_0010                -1.750264e-02 3 1  ON 59
ci_0011                -1.178808e-02 3 1  ON 60
ci_0012                -1.207748e-02 3 1  ON 61
ci_0013                 1.384821e-02 3 1  ON 62
ci_0014                 1.324778e-02 3 1  ON 63
ci_0015                 1.266564e-02 3 1  ON 64
ci_0016                 1.208720e-02 3 1  ON 65
ci_0017                 1.124813e-02 3 1  ON 66
ci_0018                 1.100931e-02 3 1  ON 67
ci_0019                 1.102480e-02 3 1  ON 68
ci_0020                 1.173020e-02 3 1  ON 69
ci_0021                -2.215272e-03 3 1  ON 70
ci_0022                -8.273248e-04 3 1  ON 71
ci_0023                -1.139290e-02 3 1  ON 72
ci_0024                -1.124886e-02 3 1  ON 73
ci_0025                -1.110581e-02 3 1  ON 74
ci_0026                -9.955924e-03 3 1  ON 75
ci_0027                -1.173916e-02 3 1  ON 76
ci_0028                -1.125458e-02 3 1  ON 77
ci_0029                -1.048855e-02 3 1  ON 78
ci_0030                -1.095242e-02 3 1  ON 79
ci_0031                 2.060584e-02 3 1  ON 80
ci_0032                 2.062191e-02 3 1  ON 81
ci_0033                 9.630618e-03 3 1  ON 82
ci_0034                 9.919852e-03 3 1  ON 83
ci_0035                 6.607084e-03 3 1  ON 84
ci_0036                 6.141452e-03 3 1  ON 85
ci_0037                -1.092289e-02 3 1  ON 86
ci_0038                -1.111908e-02 3 1  ON 87
ci_0039                -2.513017e-03 3 1  ON 88
ci_0040                -2.245081e-03 3 1  ON 89
ci_0041                 6.745744e-03 3 1  ON 90
ci_0042                 6.751187e-03 3 1  ON 91
ci_0043                -1.877690e-02 3 1  ON 92
ci_0044                -1.960597e-02 3 1  ON 93
ci_0045                 7.143744e-03 3 1  ON 94
ci_0046                 6.906940e-03 3 1  ON 95
ci_0047                -1.418721e-03 3 1  ON 96
ci_0048                -2.600543e-03 3 1  ON 97
ci_0049                -4.917839e-03 3 1  ON 98
ci_0050                -5.954672e-03 3 1  ON 99
ci_0051                -3.090793e-03 3 1  ON 100
ci_0052                -3.633545e-03 3 1  ON 101
ci_0053                -4.923573e-03 3 1  ON 102
ci_0054                -4.109411e-03 3 1  ON 103
ci_0055                 6.384593e-03 3 1  ON 104
ci_0056                 5.922243e-03 3 1  ON 105
ci_0057                 4.859481e-03 3 1  ON 106
ci_0058                 5.442909e-03 3 1  ON 107
ci_0059                -4.922290e-03 3 1  ON 108
ci_0060                -4.470742e-03 3 1  ON 109
ci_0061                -4.375245e-03 3 1  ON 110
ci_0062                -3.217174e-03 3 1  ON 111
ci_0063                -8.604401e-03 3 1  ON 112
ci_0064                -8.229503e-03 3 1  ON 113
ci_0065                -5.834904e-03 3 1  ON 114
ci_0066                -5.316675e-03 3 1  ON 115
ci_0067                -5.063690e-03 3 1  ON 116
ci_0068                -4.906908e-03 3 1  ON 117
ci_0069                 4.130736e-03 3 1  ON 118
ci_0070                 4.141104e-03 3 1  ON 119
ci_0071                -9.569304e-05 3 1  ON 120
ci_0072                 5.391413e-05 3 1  ON 121
ci_0073                 4.701181e-03 3 1  ON 122
ci_0074                 4.327955e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.0108e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s062 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s062 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=62  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 62
    time step          = 0.05
    reference energy   = -16.9451
    reference variance = 0.232932
====================================================
  Execution time = 2.1067e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s062
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5239e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3564e-01
  Total weights = 1.951551576e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1879e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323919747737
                                         uncertainty =       0.002292799968

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323919747737
                                         uncertainty =       0.002292799968

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402466372
  error estimate for blocks of size 2^( 2) =       0.000415542664
  error estimate for blocks of size 2^( 3) =       0.000428907406
  error estimate for blocks of size 2^( 4) =       0.000440855309
  error estimate for blocks of size 2^( 5) =       0.000452888906
  error estimate for blocks of size 2^( 6) =       0.000460220670
  error estimate for blocks of size 2^( 7) =       0.000467143159

      target function =                  N/A
              le_mean =     -16.905337475885
             les_mean =     286.126071025339
             stat err =       0.000455277011
             autocorr =       1.279653077647
              std dev =       0.569173401257
             le_variance =       0.323958360699


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690533747588e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.4694e+00, overlap shift 3.4694e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905337475853       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905339577336       residual = 9.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905339438559       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905339343171       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905339282126       residual = 5.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905339306938       residual = 3.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905339364013       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905339402779       residual = 3.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905339414357       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905339383529       residual = 4.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.4694e+00 is 1.300800e-04

solving harmonic davidson linear method for identity shift 1.3878e+01, overlap shift 1.3878e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905337475853       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905338026509       residual = 9.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905337993836       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905337976313       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905337958243       residual = 4.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905337960984       residual = 2.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905337974869       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905337985625       residual = 3.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905337989801       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905337982713       residual = 5.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.3878e+01 is 3.482976e-05

solving harmonic davidson linear method for identity shift 5.5511e+01, overlap shift 5.5511e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905337475853       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905337615194       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905337607164       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905337603213       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905337598566       residual = 4.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905337599010       residual = 2.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905337602425       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905337605185       residual = 3.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905337606322       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905337604618       residual = 5.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.5511e+01 is 8.864063e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.574908 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7263e+01
  </log>
  <optVariables href="H2O.s062.opt.xml">
   uu_0                 3.136046e-01 1 1  ON 0
   uu_1                 1.457755e-01 1 1  ON 1
   uu_2                 4.364974e-02 1 1  ON 2
   uu_3                -1.950871e-02 1 1  ON 3
   uu_4                -6.632594e-02 1 1  ON 4
   uu_5                -1.026862e-01 1 1  ON 5
   uu_6                -1.318607e-01 1 1  ON 6
   uu_7                -1.474037e-01 1 1  ON 7
   uu_8                -1.416854e-01 1 1  ON 8
   uu_9                -1.142603e-01 1 1  ON 9
   ud_0                 4.520231e-01 1 1  ON 10
   ud_1                 1.859016e-01 1 1  ON 11
   ud_2                 6.514380e-02 1 1  ON 12
   ud_3                -6.111246e-03 1 1  ON 13
   ud_4                -6.356464e-02 1 1  ON 14
   ud_5                -1.063625e-01 1 1  ON 15
   ud_6                -1.348670e-01 1 1  ON 16
   ud_7                -1.533214e-01 1 1  ON 17
   ud_8                -1.556168e-01 1 1  ON 18
   ud_9                -1.460571e-01 1 1  ON 19
   eO_0                -7.490113e-01 1 1  ON 20
   eO_1                -4.277326e-01 1 1  ON 21
   eO_2                -1.632320e-02 1 1  ON 22
   eO_3                 2.973799e-01 1 1  ON 23
   eO_4                 5.252272e-01 1 1  ON 24
   eO_5                 4.899680e-01 1 1  ON 25
   eO_6                 2.634817e-01 1 1  ON 26
   eO_7                -4.241985e-02 1 1  ON 27
   eO_8                -2.358129e-01 1 1  ON 28
   eO_9                -1.010649e-01 1 1  ON 29
  eH1_0                -2.649735e-01 1 1  ON 30
  eH1_1                -1.573483e-01 1 1  ON 31
  eH1_2                -1.071436e-01 1 1  ON 32
  eH1_3                -5.155523e-02 1 1  ON 33
  eH1_4                -1.160256e-03 1 1  ON 34
  eH1_5                 3.523554e-02 1 1  ON 35
  eH1_6                 9.800741e-02 1 1  ON 36
  eH1_7                 1.588910e-01 1 1  ON 37
  eH1_8                 1.958283e-01 1 1  ON 38
  eH1_9                 9.359906e-02 1 1  ON 39
  eH2_0                -2.634894e-01 1 1  ON 40
  eH2_1                -1.559985e-01 1 1  ON 41
  eH2_2                -1.054882e-01 1 1  ON 42
  eH2_3                -4.976258e-02 1 1  ON 43
  eH2_4                 1.000083e-03 1 1  ON 44
  eH2_5                 3.710732e-02 1 1  ON 45
  eH2_6                 9.962797e-02 1 1  ON 46
  eH2_7                 1.613477e-01 1 1  ON 47
  eH2_8                 2.000764e-01 1 1  ON 48
  eH2_9                 8.670100e-02 1 1  ON 49
ci_0001                 7.011725e-01 3 1  ON 50
ci_0002                 7.010057e-01 3 1  ON 51
ci_0003                -2.758540e-02 3 1  ON 52
ci_0004                -2.764663e-02 3 1  ON 53
ci_0005                -3.647859e-02 3 1  ON 54
ci_0006                -3.613039e-02 3 1  ON 55
ci_0007                -2.034504e-02 3 1  ON 56
ci_0008                -2.169630e-02 3 1  ON 57
ci_0009                -1.673964e-02 3 1  ON 58
ci_0010                -1.749278e-02 3 1  ON 59
ci_0011                -1.179248e-02 3 1  ON 60
ci_0012                -1.208222e-02 3 1  ON 61
ci_0013                 1.384665e-02 3 1  ON 62
ci_0014                 1.324690e-02 3 1  ON 63
ci_0015                 1.266927e-02 3 1  ON 64
ci_0016                 1.210962e-02 3 1  ON 65
ci_0017                 1.124772e-02 3 1  ON 66
ci_0018                 1.101939e-02 3 1  ON 67
ci_0019                 1.104304e-02 3 1  ON 68
ci_0020                 1.172525e-02 3 1  ON 69
ci_0021                -2.219140e-03 3 1  ON 70
ci_0022                -8.285529e-04 3 1  ON 71
ci_0023                -1.138390e-02 3 1  ON 72
ci_0024                -1.123673e-02 3 1  ON 73
ci_0025                -1.111415e-02 3 1  ON 74
ci_0026                -9.976951e-03 3 1  ON 75
ci_0027                -1.173762e-02 3 1  ON 76
ci_0028                -1.125029e-02 3 1  ON 77
ci_0029                -1.049282e-02 3 1  ON 78
ci_0030                -1.093423e-02 3 1  ON 79
ci_0031                 2.060422e-02 3 1  ON 80
ci_0032                 2.062395e-02 3 1  ON 81
ci_0033                 9.620287e-03 3 1  ON 82
ci_0034                 9.903015e-03 3 1  ON 83
ci_0035                 6.625005e-03 3 1  ON 84
ci_0036                 6.145390e-03 3 1  ON 85
ci_0037                -1.090993e-02 3 1  ON 86
ci_0038                -1.112666e-02 3 1  ON 87
ci_0039                -2.510925e-03 3 1  ON 88
ci_0040                -2.249285e-03 3 1  ON 89
ci_0041                 6.743008e-03 3 1  ON 90
ci_0042                 6.762585e-03 3 1  ON 91
ci_0043                -1.879686e-02 3 1  ON 92
ci_0044                -1.959930e-02 3 1  ON 93
ci_0045                 7.146176e-03 3 1  ON 94
ci_0046                 6.914392e-03 3 1  ON 95
ci_0047                -1.453550e-03 3 1  ON 96
ci_0048                -2.570702e-03 3 1  ON 97
ci_0049                -4.949086e-03 3 1  ON 98
ci_0050                -5.963710e-03 3 1  ON 99
ci_0051                -3.103964e-03 3 1  ON 100
ci_0052                -3.628389e-03 3 1  ON 101
ci_0053                -4.925184e-03 3 1  ON 102
ci_0054                -4.122323e-03 3 1  ON 103
ci_0055                 6.399553e-03 3 1  ON 104
ci_0056                 5.928010e-03 3 1  ON 105
ci_0057                 4.868198e-03 3 1  ON 106
ci_0058                 5.436562e-03 3 1  ON 107
ci_0059                -4.921624e-03 3 1  ON 108
ci_0060                -4.481191e-03 3 1  ON 109
ci_0061                -4.354480e-03 3 1  ON 110
ci_0062                -3.232784e-03 3 1  ON 111
ci_0063                -8.596000e-03 3 1  ON 112
ci_0064                -8.238146e-03 3 1  ON 113
ci_0065                -5.827125e-03 3 1  ON 114
ci_0066                -5.309276e-03 3 1  ON 115
ci_0067                -5.043936e-03 3 1  ON 116
ci_0068                -4.915079e-03 3 1  ON 117
ci_0069                 4.129970e-03 3 1  ON 118
ci_0070                 4.151626e-03 3 1  ON 119
ci_0071                -8.961994e-05 3 1  ON 120
ci_0072                 5.787875e-05 3 1  ON 121
ci_0073                 4.693775e-03 3 1  ON 122
ci_0074                 4.321176e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 62
    time step          = 0.05
    reference energy   = -16.9027
    reference variance = 0.326501
====================================================
  Execution time = 2.0986e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s062
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3494e-01
  Total weights = 1.9518e+06
  Execution time = 1.9028e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321623219195
                                         uncertainty =       0.002202533838

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321623219195
                                         uncertainty =       0.002202533838

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400961024
  error estimate for blocks of size 2^( 2) =       0.000414442955
  error estimate for blocks of size 2^( 3) =       0.000427840297
  error estimate for blocks of size 2^( 4) =       0.000440493677
  error estimate for blocks of size 2^( 5) =       0.000450971059
  error estimate for blocks of size 2^( 6) =       0.000457730425
  error estimate for blocks of size 2^( 7) =       0.000463808804

      target function =                  N/A
              le_mean =     -16.906360880382
             les_mean =     286.159923576837
             stat err =       0.000453250991
             autocorr =       1.277830375780
              std dev =       0.567044518780
             le_variance =       0.321539486279

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321702608714
                                         uncertainty =       0.002206366244

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321702608714
                                         uncertainty =       0.002206366244

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401010475
  error estimate for blocks of size 2^( 2) =       0.000414491735
  error estimate for blocks of size 2^( 3) =       0.000427885924
  error estimate for blocks of size 2^( 4) =       0.000440538456
  error estimate for blocks of size 2^( 5) =       0.000451016061
  error estimate for blocks of size 2^( 6) =       0.000457773159
  error estimate for blocks of size 2^( 7) =       0.000463852265

      target function =                  N/A
              le_mean =     -16.906359504354
             les_mean =     286.160084329107
             stat err =       0.000453294985
             autocorr =       1.277763257118
              std dev =       0.567114451692
             le_variance =       0.321618801318

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321665252157
                                         uncertainty =       0.002204522267

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321665252157
                                         uncertainty =       0.002204522267

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400987208
  error estimate for blocks of size 2^( 2) =       0.000414468760
  error estimate for blocks of size 2^( 3) =       0.000427864427
  error estimate for blocks of size 2^( 4) =       0.000440517390
  error estimate for blocks of size 2^( 5) =       0.000450994918
  error estimate for blocks of size 2^( 6) =       0.000457753090
  error estimate for blocks of size 2^( 7) =       0.000463831919

      target function =                  N/A
              le_mean =     -16.906360078644
             les_mean =     286.160032529073
             stat err =       0.000453274329
             autocorr =       1.277795075653
              std dev =       0.567081548523
             le_variance =       0.321581482675

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321628490033
                                         uncertainty =       0.002202782507

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321628490033
                                         uncertainty =       0.002202782507

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400964308
  error estimate for blocks of size 2^( 2) =       0.000414446191
  error estimate for blocks of size 2^( 3) =       0.000427843319
  error estimate for blocks of size 2^( 4) =       0.000440496647
  error estimate for blocks of size 2^( 5) =       0.000450974043
  error estimate for blocks of size 2^( 6) =       0.000457733265
  error estimate for blocks of size 2^( 7) =       0.000463811692

      target function =                  N/A
              le_mean =     -16.906360764101
             les_mean =     286.159966002415
             stat err =       0.000453253912
             autocorr =       1.277825912833
              std dev =       0.567049162460
             le_variance =       0.321544752646


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906360880382        initial  <--
     3.4694e+00     3.4694e+01             1.3008e-04       -16.906359504354
     1.3878e+01     1.3878e+02             3.4830e-05       -16.906360078644
     5.5511e+01     5.5511e+02             8.8641e-06       -16.906360764101

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.6103
  </log>
  <optVariables href="H2O.s062.opt.xml">
   uu_0                 3.136054e-01 1 1  ON 0
   uu_1                 1.457747e-01 1 1  ON 1
   uu_2                 4.365180e-02 1 1  ON 2
   uu_3                -1.950107e-02 1 1  ON 3
   uu_4                -6.632487e-02 1 1  ON 4
   uu_5                -1.026857e-01 1 1  ON 5
   uu_6                -1.318567e-01 1 1  ON 6
   uu_7                -1.474028e-01 1 1  ON 7
   uu_8                -1.416897e-01 1 1  ON 8
   uu_9                -1.142616e-01 1 1  ON 9
   ud_0                 4.520201e-01 1 1  ON 10
   ud_1                 1.859093e-01 1 1  ON 11
   ud_2                 6.514298e-02 1 1  ON 12
   ud_3                -6.114567e-03 1 1  ON 13
   ud_4                -6.355656e-02 1 1  ON 14
   ud_5                -1.063735e-01 1 1  ON 15
   ud_6                -1.348640e-01 1 1  ON 16
   ud_7                -1.533240e-01 1 1  ON 17
   ud_8                -1.556260e-01 1 1  ON 18
   ud_9                -1.460572e-01 1 1  ON 19
   eO_0                -7.490192e-01 1 1  ON 20
   eO_1                -4.277385e-01 1 1  ON 21
   eO_2                -1.632319e-02 1 1  ON 22
   eO_3                 2.973828e-01 1 1  ON 23
   eO_4                 5.252283e-01 1 1  ON 24
   eO_5                 4.899664e-01 1 1  ON 25
   eO_6                 2.634832e-01 1 1  ON 26
   eO_7                -4.242582e-02 1 1  ON 27
   eO_8                -2.358098e-01 1 1  ON 28
   eO_9                -1.010543e-01 1 1  ON 29
  eH1_0                -2.649661e-01 1 1  ON 30
  eH1_1                -1.573488e-01 1 1  ON 31
  eH1_2                -1.071400e-01 1 1  ON 32
  eH1_3                -5.154824e-02 1 1  ON 33
  eH1_4                -1.164334e-03 1 1  ON 34
  eH1_5                 3.523714e-02 1 1  ON 35
  eH1_6                 9.801426e-02 1 1  ON 36
  eH1_7                 1.588964e-01 1 1  ON 37
  eH1_8                 1.958218e-01 1 1  ON 38
  eH1_9                 9.358265e-02 1 1  ON 39
  eH2_0                -2.634830e-01 1 1  ON 40
  eH2_1                -1.559939e-01 1 1  ON 41
  eH2_2                -1.054852e-01 1 1  ON 42
  eH2_3                -4.975807e-02 1 1  ON 43
  eH2_4                 1.007494e-03 1 1  ON 44
  eH2_5                 3.710729e-02 1 1  ON 45
  eH2_6                 9.962841e-02 1 1  ON 46
  eH2_7                 1.613442e-01 1 1  ON 47
  eH2_8                 2.000692e-01 1 1  ON 48
  eH2_9                 8.668655e-02 1 1  ON 49
ci_0001                 7.011804e-01 3 1  ON 50
ci_0002                 7.009996e-01 3 1  ON 51
ci_0003                -2.758607e-02 3 1  ON 52
ci_0004                -2.765046e-02 3 1  ON 53
ci_0005                -3.647596e-02 3 1  ON 54
ci_0006                -3.612552e-02 3 1  ON 55
ci_0007                -2.035054e-02 3 1  ON 56
ci_0008                -2.167541e-02 3 1  ON 57
ci_0009                -1.674065e-02 3 1  ON 58
ci_0010                -1.750264e-02 3 1  ON 59
ci_0011                -1.178808e-02 3 1  ON 60
ci_0012                -1.207748e-02 3 1  ON 61
ci_0013                 1.384821e-02 3 1  ON 62
ci_0014                 1.324778e-02 3 1  ON 63
ci_0015                 1.266564e-02 3 1  ON 64
ci_0016                 1.208720e-02 3 1  ON 65
ci_0017                 1.124813e-02 3 1  ON 66
ci_0018                 1.100931e-02 3 1  ON 67
ci_0019                 1.102480e-02 3 1  ON 68
ci_0020                 1.173020e-02 3 1  ON 69
ci_0021                -2.215272e-03 3 1  ON 70
ci_0022                -8.273248e-04 3 1  ON 71
ci_0023                -1.139290e-02 3 1  ON 72
ci_0024                -1.124886e-02 3 1  ON 73
ci_0025                -1.110581e-02 3 1  ON 74
ci_0026                -9.955924e-03 3 1  ON 75
ci_0027                -1.173916e-02 3 1  ON 76
ci_0028                -1.125458e-02 3 1  ON 77
ci_0029                -1.048855e-02 3 1  ON 78
ci_0030                -1.095242e-02 3 1  ON 79
ci_0031                 2.060584e-02 3 1  ON 80
ci_0032                 2.062191e-02 3 1  ON 81
ci_0033                 9.630618e-03 3 1  ON 82
ci_0034                 9.919852e-03 3 1  ON 83
ci_0035                 6.607084e-03 3 1  ON 84
ci_0036                 6.141452e-03 3 1  ON 85
ci_0037                -1.092289e-02 3 1  ON 86
ci_0038                -1.111908e-02 3 1  ON 87
ci_0039                -2.513017e-03 3 1  ON 88
ci_0040                -2.245081e-03 3 1  ON 89
ci_0041                 6.745744e-03 3 1  ON 90
ci_0042                 6.751187e-03 3 1  ON 91
ci_0043                -1.877690e-02 3 1  ON 92
ci_0044                -1.960597e-02 3 1  ON 93
ci_0045                 7.143744e-03 3 1  ON 94
ci_0046                 6.906940e-03 3 1  ON 95
ci_0047                -1.418721e-03 3 1  ON 96
ci_0048                -2.600543e-03 3 1  ON 97
ci_0049                -4.917839e-03 3 1  ON 98
ci_0050                -5.954672e-03 3 1  ON 99
ci_0051                -3.090793e-03 3 1  ON 100
ci_0052                -3.633545e-03 3 1  ON 101
ci_0053                -4.923573e-03 3 1  ON 102
ci_0054                -4.109411e-03 3 1  ON 103
ci_0055                 6.384593e-03 3 1  ON 104
ci_0056                 5.922243e-03 3 1  ON 105
ci_0057                 4.859481e-03 3 1  ON 106
ci_0058                 5.442909e-03 3 1  ON 107
ci_0059                -4.922290e-03 3 1  ON 108
ci_0060                -4.470742e-03 3 1  ON 109
ci_0061                -4.375245e-03 3 1  ON 110
ci_0062                -3.217174e-03 3 1  ON 111
ci_0063                -8.604401e-03 3 1  ON 112
ci_0064                -8.229503e-03 3 1  ON 113
ci_0065                -5.834904e-03 3 1  ON 114
ci_0066                -5.316675e-03 3 1  ON 115
ci_0067                -5.063690e-03 3 1  ON 116
ci_0068                -4.906908e-03 3 1  ON 117
ci_0069                 4.130736e-03 3 1  ON 118
ci_0070                 4.141104e-03 3 1  ON 119
ci_0071                -9.569304e-05 3 1  ON 120
ci_0072                 5.391413e-05 3 1  ON 121
ci_0073                 4.701181e-03 3 1  ON 122
ci_0074                 4.327955e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7881e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s063 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s063 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=63  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 63
    time step          = 0.05
    reference energy   = -16.871
    reference variance = 0.251956
====================================================
  Execution time = 2.1240e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s063
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5218e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3392e-01
  Total weights = 1.951880756e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1560e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322011321627
                                         uncertainty =       0.002545701291

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322011321627
                                         uncertainty =       0.002545701291

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401257939
  error estimate for blocks of size 2^( 2) =       0.000413724901
  error estimate for blocks of size 2^( 3) =       0.000426539648
  error estimate for blocks of size 2^( 4) =       0.000438285418
  error estimate for blocks of size 2^( 5) =       0.000448655816
  error estimate for blocks of size 2^( 6) =       0.000455018653
  error estimate for blocks of size 2^( 7) =       0.000459007653

      target function =                  N/A
              le_mean =     -16.905862045564
             les_mean =     286.142087562902
             stat err =       0.000450241885
             autocorr =       1.259054449575
              std dev =       0.567464419122
             le_variance =       0.322015866969


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690586204556e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.4694e+01, overlap shift 3.4694e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905862045570       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905862169042       residual = 8.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905862153362       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905862152127       residual = 7.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905862136093       residual = 4.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905862127302       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905862127895       residual = 8.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905862132932       residual = 2.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905862134126       residual = 8.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.4694e+01 is 7.987157e-06

solving harmonic davidson linear method for identity shift 1.3878e+02, overlap shift 1.3878e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905862045570       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905862076586       residual = 8.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905862072649       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905862072342       residual = 7.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905862068314       residual = 4.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905862066093       residual = 2.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905862066253       residual = 8.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905862067497       residual = 2.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905862067785       residual = 8.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.3878e+02 is 2.007153e-06

solving harmonic davidson linear method for identity shift 5.5511e+02, overlap shift 5.5511e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905862045570       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905862053333       residual = 8.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905862052348       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905862052272       residual = 7.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905862051263       residual = 4.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905862050706       residual = 2.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905862050748       residual = 8.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905862051057       residual = 2.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905862051126       residual = 8.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.5511e+02 is 5.024403e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.578335 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7404e+01
  </log>
  <optVariables href="H2O.s063.opt.xml">
   uu_0                 3.136045e-01 1 1  ON 0
   uu_1                 1.457753e-01 1 1  ON 1
   uu_2                 4.365173e-02 1 1  ON 2
   uu_3                -1.950121e-02 1 1  ON 3
   uu_4                -6.632530e-02 1 1  ON 4
   uu_5                -1.026855e-01 1 1  ON 5
   uu_6                -1.318566e-01 1 1  ON 6
   uu_7                -1.474034e-01 1 1  ON 7
   uu_8                -1.416894e-01 1 1  ON 8
   uu_9                -1.142618e-01 1 1  ON 9
   ud_0                 4.520196e-01 1 1  ON 10
   ud_1                 1.859093e-01 1 1  ON 11
   ud_2                 6.514370e-02 1 1  ON 12
   ud_3                -6.114983e-03 1 1  ON 13
   ud_4                -6.355639e-02 1 1  ON 14
   ud_5                -1.063727e-01 1 1  ON 15
   ud_6                -1.348648e-01 1 1  ON 16
   ud_7                -1.533236e-01 1 1  ON 17
   ud_8                -1.556257e-01 1 1  ON 18
   ud_9                -1.460573e-01 1 1  ON 19
   eO_0                -7.490189e-01 1 1  ON 20
   eO_1                -4.277391e-01 1 1  ON 21
   eO_2                -1.632261e-02 1 1  ON 22
   eO_3                 2.973830e-01 1 1  ON 23
   eO_4                 5.252285e-01 1 1  ON 24
   eO_5                 4.899669e-01 1 1  ON 25
   eO_6                 2.634833e-01 1 1  ON 26
   eO_7                -4.242541e-02 1 1  ON 27
   eO_8                -2.358105e-01 1 1  ON 28
   eO_9                -1.010553e-01 1 1  ON 29
  eH1_0                -2.649667e-01 1 1  ON 30
  eH1_1                -1.573492e-01 1 1  ON 31
  eH1_2                -1.071406e-01 1 1  ON 32
  eH1_3                -5.154856e-02 1 1  ON 33
  eH1_4                -1.164917e-03 1 1  ON 34
  eH1_5                 3.523667e-02 1 1  ON 35
  eH1_6                 9.801418e-02 1 1  ON 36
  eH1_7                 1.588974e-01 1 1  ON 37
  eH1_8                 1.958228e-01 1 1  ON 38
  eH1_9                 9.358375e-02 1 1  ON 39
  eH2_0                -2.634834e-01 1 1  ON 40
  eH2_1                -1.559946e-01 1 1  ON 41
  eH2_2                -1.054855e-01 1 1  ON 42
  eH2_3                -4.975826e-02 1 1  ON 43
  eH2_4                 1.006820e-03 1 1  ON 44
  eH2_5                 3.710735e-02 1 1  ON 45
  eH2_6                 9.962846e-02 1 1  ON 46
  eH2_7                 1.613441e-01 1 1  ON 47
  eH2_8                 2.000698e-01 1 1  ON 48
  eH2_9                 8.668789e-02 1 1  ON 49
ci_0001                 7.011804e-01 3 1  ON 50
ci_0002                 7.009996e-01 3 1  ON 51
ci_0003                -2.758477e-02 3 1  ON 52
ci_0004                -2.765111e-02 3 1  ON 53
ci_0005                -3.647567e-02 3 1  ON 54
ci_0006                -3.612583e-02 3 1  ON 55
ci_0007                -2.035125e-02 3 1  ON 56
ci_0008                -2.167531e-02 3 1  ON 57
ci_0009                -1.674045e-02 3 1  ON 58
ci_0010                -1.750247e-02 3 1  ON 59
ci_0011                -1.178851e-02 3 1  ON 60
ci_0012                -1.207571e-02 3 1  ON 61
ci_0013                 1.384869e-02 3 1  ON 62
ci_0014                 1.324653e-02 3 1  ON 63
ci_0015                 1.266606e-02 3 1  ON 64
ci_0016                 1.208904e-02 3 1  ON 65
ci_0017                 1.124793e-02 3 1  ON 66
ci_0018                 1.100987e-02 3 1  ON 67
ci_0019                 1.102461e-02 3 1  ON 68
ci_0020                 1.172828e-02 3 1  ON 69
ci_0021                -2.214926e-03 3 1  ON 70
ci_0022                -8.276665e-04 3 1  ON 71
ci_0023                -1.139263e-02 3 1  ON 72
ci_0024                -1.124878e-02 3 1  ON 73
ci_0025                -1.110570e-02 3 1  ON 74
ci_0026                -9.955647e-03 3 1  ON 75
ci_0027                -1.173726e-02 3 1  ON 76
ci_0028                -1.125608e-02 3 1  ON 77
ci_0029                -1.048791e-02 3 1  ON 78
ci_0030                -1.095168e-02 3 1  ON 79
ci_0031                 2.060725e-02 3 1  ON 80
ci_0032                 2.062278e-02 3 1  ON 81
ci_0033                 9.632384e-03 3 1  ON 82
ci_0034                 9.919337e-03 3 1  ON 83
ci_0035                 6.607256e-03 3 1  ON 84
ci_0036                 6.142381e-03 3 1  ON 85
ci_0037                -1.092401e-02 3 1  ON 86
ci_0038                -1.111741e-02 3 1  ON 87
ci_0039                -2.513129e-03 3 1  ON 88
ci_0040                -2.246313e-03 3 1  ON 89
ci_0041                 6.745609e-03 3 1  ON 90
ci_0042                 6.752292e-03 3 1  ON 91
ci_0043                -1.877730e-02 3 1  ON 92
ci_0044                -1.960556e-02 3 1  ON 93
ci_0045                 7.143088e-03 3 1  ON 94
ci_0046                 6.906554e-03 3 1  ON 95
ci_0047                -1.419796e-03 3 1  ON 96
ci_0048                -2.599093e-03 3 1  ON 97
ci_0049                -4.918418e-03 3 1  ON 98
ci_0050                -5.954864e-03 3 1  ON 99
ci_0051                -3.092621e-03 3 1  ON 100
ci_0052                -3.632036e-03 3 1  ON 101
ci_0053                -4.924039e-03 3 1  ON 102
ci_0054                -4.110821e-03 3 1  ON 103
ci_0055                 6.384750e-03 3 1  ON 104
ci_0056                 5.923134e-03 3 1  ON 105
ci_0057                 4.859812e-03 3 1  ON 106
ci_0058                 5.441559e-03 3 1  ON 107
ci_0059                -4.921511e-03 3 1  ON 108
ci_0060                -4.470849e-03 3 1  ON 109
ci_0061                -4.374349e-03 3 1  ON 110
ci_0062                -3.216220e-03 3 1  ON 111
ci_0063                -8.606211e-03 3 1  ON 112
ci_0064                -8.230234e-03 3 1  ON 113
ci_0065                -5.834194e-03 3 1  ON 114
ci_0066                -5.314668e-03 3 1  ON 115
ci_0067                -5.064000e-03 3 1  ON 116
ci_0068                -4.907138e-03 3 1  ON 117
ci_0069                 4.130348e-03 3 1  ON 118
ci_0070                 4.141444e-03 3 1  ON 119
ci_0071                -9.484583e-05 3 1  ON 120
ci_0072                 5.274504e-05 3 1  ON 121
ci_0073                 4.700568e-03 3 1  ON 122
ci_0074                 4.327502e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 63
    time step          = 0.05
    reference energy   = -16.8423
    reference variance = 0.771854
====================================================
  Execution time = 2.1541e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s063
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3343e-01
  Total weights = 1.9516e+06
  Execution time = 1.9096e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322136320869
                                         uncertainty =       0.001905507596

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322136320869
                                         uncertainty =       0.001905507596

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401391449
  error estimate for blocks of size 2^( 2) =       0.000414121545
  error estimate for blocks of size 2^( 3) =       0.000427595101
  error estimate for blocks of size 2^( 4) =       0.000440692557
  error estimate for blocks of size 2^( 5) =       0.000451121040
  error estimate for blocks of size 2^( 6) =       0.000458607703
  error estimate for blocks of size 2^( 7) =       0.000466571554

      target function =                  N/A
              le_mean =     -16.906634685483
             les_mean =     286.167724974421
             stat err =       0.000454248213
             autocorr =       1.280708295843
              std dev =       0.567653231308
             le_variance =       0.322230191014

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322132847028
                                         uncertainty =       0.001905365355

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322132847028
                                         uncertainty =       0.001905365355

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401389277
  error estimate for blocks of size 2^( 2) =       0.000414119405
  error estimate for blocks of size 2^( 3) =       0.000427592850
  error estimate for blocks of size 2^( 4) =       0.000440690431
  error estimate for blocks of size 2^( 5) =       0.000451118695
  error estimate for blocks of size 2^( 6) =       0.000458605632
  error estimate for blocks of size 2^( 7) =       0.000466569513

      target function =                  N/A
              le_mean =     -16.906634703986
             les_mean =     286.167717765601
             stat err =       0.000454246068
             autocorr =       1.280710055927
              std dev =       0.567650159735
             le_variance =       0.322226703847

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322134564918
                                         uncertainty =       0.001905435953

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322134564918
                                         uncertainty =       0.001905435953

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401390351
  error estimate for blocks of size 2^( 2) =       0.000414120463
  error estimate for blocks of size 2^( 3) =       0.000427593964
  error estimate for blocks of size 2^( 4) =       0.000440691483
  error estimate for blocks of size 2^( 5) =       0.000451119856
  error estimate for blocks of size 2^( 6) =       0.000458606657
  error estimate for blocks of size 2^( 7) =       0.000466570523

      target function =                  N/A
              le_mean =     -16.906634694073
             les_mean =     286.167720861459
             stat err =       0.000454247130
             autocorr =       1.280709191093
              std dev =       0.567651678711
             le_variance =       0.322228428344

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322136100411
                                         uncertainty =       0.001905498618

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322136100411
                                         uncertainty =       0.001905498618

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401391311
  error estimate for blocks of size 2^( 2) =       0.000414121409
  error estimate for blocks of size 2^( 3) =       0.000427594958
  error estimate for blocks of size 2^( 4) =       0.000440692422
  error estimate for blocks of size 2^( 5) =       0.000451120891
  error estimate for blocks of size 2^( 6) =       0.000458607572
  error estimate for blocks of size 2^( 7) =       0.000466571425

      target function =                  N/A
              le_mean =     -16.906634686484
             les_mean =     286.167724396546
             stat err =       0.000454248077
             autocorr =       1.280708408341
              std dev =       0.567653036383
             le_variance =       0.322229969715


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906634685483        initial
     3.4694e+01     3.4694e+02             7.9872e-06       -16.906634703986  <--
     1.3878e+02     1.3878e+03             2.0072e-06       -16.906634694073
     5.5511e+02     5.5511e+03             5.0244e-07       -16.906634686484

*****************************************************************************
Applying the update for shift_i =   3.4694e+01     and shift_s =   3.4694e+02
*****************************************************************************

  Execution time = 3.1190e+01
  </log>
  <optVariables href="H2O.s063.opt.xml">
   uu_0                 3.136020e-01 1 1  ON 0
   uu_1                 1.457771e-01 1 1  ON 1
   uu_2                 4.365154e-02 1 1  ON 2
   uu_3                -1.950164e-02 1 1  ON 3
   uu_4                -6.632659e-02 1 1  ON 4
   uu_5                -1.026848e-01 1 1  ON 5
   uu_6                -1.318562e-01 1 1  ON 6
   uu_7                -1.474053e-01 1 1  ON 7
   uu_8                -1.416886e-01 1 1  ON 8
   uu_9                -1.142624e-01 1 1  ON 9
   ud_0                 4.520184e-01 1 1  ON 10
   ud_1                 1.859093e-01 1 1  ON 11
   ud_2                 6.514583e-02 1 1  ON 12
   ud_3                -6.116199e-03 1 1  ON 13
   ud_4                -6.355587e-02 1 1  ON 14
   ud_5                -1.063701e-01 1 1  ON 15
   ud_6                -1.348672e-01 1 1  ON 16
   ud_7                -1.533224e-01 1 1  ON 17
   ud_8                -1.556251e-01 1 1  ON 18
   ud_9                -1.460579e-01 1 1  ON 19
   eO_0                -7.490179e-01 1 1  ON 20
   eO_1                -4.277409e-01 1 1  ON 21
   eO_2                -1.632087e-02 1 1  ON 22
   eO_3                 2.973837e-01 1 1  ON 23
   eO_4                 5.252291e-01 1 1  ON 24
   eO_5                 4.899685e-01 1 1  ON 25
   eO_6                 2.634836e-01 1 1  ON 26
   eO_7                -4.242419e-02 1 1  ON 27
   eO_8                -2.358125e-01 1 1  ON 28
   eO_9                -1.010583e-01 1 1  ON 29
  eH1_0                -2.649683e-01 1 1  ON 30
  eH1_1                -1.573506e-01 1 1  ON 31
  eH1_2                -1.071423e-01 1 1  ON 32
  eH1_3                -5.154952e-02 1 1  ON 33
  eH1_4                -1.166667e-03 1 1  ON 34
  eH1_5                 3.523526e-02 1 1  ON 35
  eH1_6                 9.801397e-02 1 1  ON 36
  eH1_7                 1.589002e-01 1 1  ON 37
  eH1_8                 1.958259e-01 1 1  ON 38
  eH1_9                 9.358706e-02 1 1  ON 39
  eH2_0                -2.634846e-01 1 1  ON 40
  eH2_1                -1.559965e-01 1 1  ON 41
  eH2_2                -1.054865e-01 1 1  ON 42
  eH2_3                -4.975884e-02 1 1  ON 43
  eH2_4                 1.004800e-03 1 1  ON 44
  eH2_5                 3.710753e-02 1 1  ON 45
  eH2_6                 9.962861e-02 1 1  ON 46
  eH2_7                 1.613439e-01 1 1  ON 47
  eH2_8                 2.000715e-01 1 1  ON 48
  eH2_9                 8.669191e-02 1 1  ON 49
ci_0001                 7.011804e-01 3 1  ON 50
ci_0002                 7.009995e-01 3 1  ON 51
ci_0003                -2.758089e-02 3 1  ON 52
ci_0004                -2.765306e-02 3 1  ON 53
ci_0005                -3.647478e-02 3 1  ON 54
ci_0006                -3.612678e-02 3 1  ON 55
ci_0007                -2.035338e-02 3 1  ON 56
ci_0008                -2.167501e-02 3 1  ON 57
ci_0009                -1.673986e-02 3 1  ON 58
ci_0010                -1.750198e-02 3 1  ON 59
ci_0011                -1.178979e-02 3 1  ON 60
ci_0012                -1.207045e-02 3 1  ON 61
ci_0013                 1.385012e-02 3 1  ON 62
ci_0014                 1.324278e-02 3 1  ON 63
ci_0015                 1.266732e-02 3 1  ON 64
ci_0016                 1.209455e-02 3 1  ON 65
ci_0017                 1.124732e-02 3 1  ON 66
ci_0018                 1.101155e-02 3 1  ON 67
ci_0019                 1.102406e-02 3 1  ON 68
ci_0020                 1.172256e-02 3 1  ON 69
ci_0021                -2.213888e-03 3 1  ON 70
ci_0022                -8.286896e-04 3 1  ON 71
ci_0023                -1.139183e-02 3 1  ON 72
ci_0024                -1.124854e-02 3 1  ON 73
ci_0025                -1.110537e-02 3 1  ON 74
ci_0026                -9.954820e-03 3 1  ON 75
ci_0027                -1.173160e-02 3 1  ON 76
ci_0028                -1.126055e-02 3 1  ON 77
ci_0029                -1.048599e-02 3 1  ON 78
ci_0030                -1.094947e-02 3 1  ON 79
ci_0031                 2.061146e-02 3 1  ON 80
ci_0032                 2.062538e-02 3 1  ON 81
ci_0033                 9.637668e-03 3 1  ON 82
ci_0034                 9.917795e-03 3 1  ON 83
ci_0035                 6.607767e-03 3 1  ON 84
ci_0036                 6.145156e-03 3 1  ON 85
ci_0037                -1.092736e-02 3 1  ON 86
ci_0038                -1.111244e-02 3 1  ON 87
ci_0039                -2.513458e-03 3 1  ON 88
ci_0040                -2.249969e-03 3 1  ON 89
ci_0041                 6.745205e-03 3 1  ON 90
ci_0042                 6.755588e-03 3 1  ON 91
ci_0043                -1.877850e-02 3 1  ON 92
ci_0044                -1.960432e-02 3 1  ON 93
ci_0045                 7.141130e-03 3 1  ON 94
ci_0046                 6.905402e-03 3 1  ON 95
ci_0047                -1.422990e-03 3 1  ON 96
ci_0048                -2.594788e-03 3 1  ON 97
ci_0049                -4.920142e-03 3 1  ON 98
ci_0050                -5.955433e-03 3 1  ON 99
ci_0051                -3.098056e-03 3 1  ON 100
ci_0052                -3.627550e-03 3 1  ON 101
ci_0053                -4.925429e-03 3 1  ON 102
ci_0054                -4.115012e-03 3 1  ON 103
ci_0055                 6.385219e-03 3 1  ON 104
ci_0056                 5.925796e-03 3 1  ON 105
ci_0057                 4.860799e-03 3 1  ON 106
ci_0058                 5.437533e-03 3 1  ON 107
ci_0059                -4.919197e-03 3 1  ON 108
ci_0060                -4.471168e-03 3 1  ON 109
ci_0061                -4.371673e-03 3 1  ON 110
ci_0062                -3.213374e-03 3 1  ON 111
ci_0063                -8.611598e-03 3 1  ON 112
ci_0064                -8.232412e-03 3 1  ON 113
ci_0065                -5.832076e-03 3 1  ON 114
ci_0066                -5.308688e-03 3 1  ON 115
ci_0067                -5.064922e-03 3 1  ON 116
ci_0068                -4.907818e-03 3 1  ON 117
ci_0069                 4.129196e-03 3 1  ON 118
ci_0070                 4.142452e-03 3 1  ON 119
ci_0071                -9.231968e-05 3 1  ON 120
ci_0072                 4.926362e-05 3 1  ON 121
ci_0073                 4.698746e-03 3 1  ON 122
ci_0074                 4.326154e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8601e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s064 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s064 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=64  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 64
    time step          = 0.05
    reference energy   = -16.9389
    reference variance = 0.209193
====================================================
  Execution time = 2.1266e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s064
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5249e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3576e-01
  Total weights = 1.951748857e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0784e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323986129917
                                         uncertainty =       0.002212065764

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323986129917
                                         uncertainty =       0.002212065764

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402489431
  error estimate for blocks of size 2^( 2) =       0.000415416032
  error estimate for blocks of size 2^( 3) =       0.000428362590
  error estimate for blocks of size 2^( 4) =       0.000441182547
  error estimate for blocks of size 2^( 5) =       0.000452365684
  error estimate for blocks of size 2^( 6) =       0.000460439164
  error estimate for blocks of size 2^( 7) =       0.000465150440

      target function =                  N/A
              le_mean =     -16.906063804823
             les_mean =     286.150753052641
             stat err =       0.000454784459
             autocorr =       1.276739423388
              std dev =       0.569206011952
             le_variance =       0.323995484042


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690606380482e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.6736e+00, overlap shift 8.6736e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906063804808       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906064183755       residual = 2.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906064207442       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906064234253       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906064258569       residual = 6.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906064335699       residual = 2.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906064400603       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906064408112       residual = 3.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906064395770       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906064393701       residual = 3.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 8.6736e+00 is 3.738890e-05

solving harmonic davidson linear method for identity shift 3.4694e+01, overlap shift 3.4694e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906063804808       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906063901319       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906063907534       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906063914941       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906063921418       residual = 6.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906063940651       residual = 2.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906063957343       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906063959717       residual = 3.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906063957038       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906063956469       residual = 3.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.4694e+01 is 9.620923e-06

solving harmonic davidson linear method for identity shift 1.3878e+02, overlap shift 1.3878e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906063804808       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906063829049       residual = 2.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906063830622       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906063832519       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906063834164       residual = 6.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906063838971       residual = 2.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906063843171       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906063843798       residual = 3.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906063843156       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906063843010       residual = 3.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.3878e+02 is 2.422984e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.582232 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7352e+01
  </log>
  <optVariables href="H2O.s064.opt.xml">
   uu_0                 3.136009e-01 1 1  ON 0
   uu_1                 1.457800e-01 1 1  ON 1
   uu_2                 4.365194e-02 1 1  ON 2
   uu_3                -1.950308e-02 1 1  ON 3
   uu_4                -6.632704e-02 1 1  ON 4
   uu_5                -1.026873e-01 1 1  ON 5
   uu_6                -1.318570e-01 1 1  ON 6
   uu_7                -1.474059e-01 1 1  ON 7
   uu_8                -1.416883e-01 1 1  ON 8
   uu_9                -1.142632e-01 1 1  ON 9
   ud_0                 4.520116e-01 1 1  ON 10
   ud_1                 1.859084e-01 1 1  ON 11
   ud_2                 6.514708e-02 1 1  ON 12
   ud_3                -6.112985e-03 1 1  ON 13
   ud_4                -6.355680e-02 1 1  ON 14
   ud_5                -1.063678e-01 1 1  ON 15
   ud_6                -1.348669e-01 1 1  ON 16
   ud_7                -1.533216e-01 1 1  ON 17
   ud_8                -1.556235e-01 1 1  ON 18
   ud_9                -1.460552e-01 1 1  ON 19
   eO_0                -7.490147e-01 1 1  ON 20
   eO_1                -4.277369e-01 1 1  ON 21
   eO_2                -1.632490e-02 1 1  ON 22
   eO_3                 2.973809e-01 1 1  ON 23
   eO_4                 5.252320e-01 1 1  ON 24
   eO_5                 4.899691e-01 1 1  ON 25
   eO_6                 2.634846e-01 1 1  ON 26
   eO_7                -4.242254e-02 1 1  ON 27
   eO_8                -2.358144e-01 1 1  ON 28
   eO_9                -1.010619e-01 1 1  ON 29
  eH1_0                -2.649712e-01 1 1  ON 30
  eH1_1                -1.573514e-01 1 1  ON 31
  eH1_2                -1.071448e-01 1 1  ON 32
  eH1_3                -5.154944e-02 1 1  ON 33
  eH1_4                -1.170124e-03 1 1  ON 34
  eH1_5                 3.523364e-02 1 1  ON 35
  eH1_6                 9.801265e-02 1 1  ON 36
  eH1_7                 1.589015e-01 1 1  ON 37
  eH1_8                 1.958288e-01 1 1  ON 38
  eH1_9                 9.359356e-02 1 1  ON 39
  eH2_0                -2.634903e-01 1 1  ON 40
  eH2_1                -1.559984e-01 1 1  ON 41
  eH2_2                -1.054873e-01 1 1  ON 42
  eH2_3                -4.976120e-02 1 1  ON 43
  eH2_4                 1.004421e-03 1 1  ON 44
  eH2_5                 3.711097e-02 1 1  ON 45
  eH2_6                 9.963196e-02 1 1  ON 46
  eH2_7                 1.613439e-01 1 1  ON 47
  eH2_8                 2.000723e-01 1 1  ON 48
  eH2_9                 8.669612e-02 1 1  ON 49
ci_0001                 7.011808e-01 3 1  ON 50
ci_0002                 7.009983e-01 3 1  ON 51
ci_0003                -2.757920e-02 3 1  ON 52
ci_0004                -2.764548e-02 3 1  ON 53
ci_0005                -3.648003e-02 3 1  ON 54
ci_0006                -3.612992e-02 3 1  ON 55
ci_0007                -2.035720e-02 3 1  ON 56
ci_0008                -2.167727e-02 3 1  ON 57
ci_0009                -1.674645e-02 3 1  ON 58
ci_0010                -1.749907e-02 3 1  ON 59
ci_0011                -1.178968e-02 3 1  ON 60
ci_0012                -1.206656e-02 3 1  ON 61
ci_0013                 1.384597e-02 3 1  ON 62
ci_0014                 1.324832e-02 3 1  ON 63
ci_0015                 1.267531e-02 3 1  ON 64
ci_0016                 1.210318e-02 3 1  ON 65
ci_0017                 1.124448e-02 3 1  ON 66
ci_0018                 1.101512e-02 3 1  ON 67
ci_0019                 1.102626e-02 3 1  ON 68
ci_0020                 1.171650e-02 3 1  ON 69
ci_0021                -2.213882e-03 3 1  ON 70
ci_0022                -8.299179e-04 3 1  ON 71
ci_0023                -1.139361e-02 3 1  ON 72
ci_0024                -1.123956e-02 3 1  ON 73
ci_0025                -1.110152e-02 3 1  ON 74
ci_0026                -9.959545e-03 3 1  ON 75
ci_0027                -1.172897e-02 3 1  ON 76
ci_0028                -1.125369e-02 3 1  ON 77
ci_0029                -1.049295e-02 3 1  ON 78
ci_0030                -1.095417e-02 3 1  ON 79
ci_0031                 2.061658e-02 3 1  ON 80
ci_0032                 2.062965e-02 3 1  ON 81
ci_0033                 9.637599e-03 3 1  ON 82
ci_0034                 9.912259e-03 3 1  ON 83
ci_0035                 6.609210e-03 3 1  ON 84
ci_0036                 6.147975e-03 3 1  ON 85
ci_0037                -1.092903e-02 3 1  ON 86
ci_0038                -1.110673e-02 3 1  ON 87
ci_0039                -2.512946e-03 3 1  ON 88
ci_0040                -2.252160e-03 3 1  ON 89
ci_0041                 6.746834e-03 3 1  ON 90
ci_0042                 6.759382e-03 3 1  ON 91
ci_0043                -1.878355e-02 3 1  ON 92
ci_0044                -1.960400e-02 3 1  ON 93
ci_0045                 7.136103e-03 3 1  ON 94
ci_0046                 6.908427e-03 3 1  ON 95
ci_0047                -1.429231e-03 3 1  ON 96
ci_0048                -2.585167e-03 3 1  ON 97
ci_0049                -4.917903e-03 3 1  ON 98
ci_0050                -5.953680e-03 3 1  ON 99
ci_0051                -3.103619e-03 3 1  ON 100
ci_0052                -3.628548e-03 3 1  ON 101
ci_0053                -4.923540e-03 3 1  ON 102
ci_0054                -4.119044e-03 3 1  ON 103
ci_0055                 6.387213e-03 3 1  ON 104
ci_0056                 5.932846e-03 3 1  ON 105
ci_0057                 4.858232e-03 3 1  ON 106
ci_0058                 5.432623e-03 3 1  ON 107
ci_0059                -4.918960e-03 3 1  ON 108
ci_0060                -4.476099e-03 3 1  ON 109
ci_0061                -4.371778e-03 3 1  ON 110
ci_0062                -3.217310e-03 3 1  ON 111
ci_0063                -8.611339e-03 3 1  ON 112
ci_0064                -8.233217e-03 3 1  ON 113
ci_0065                -5.835245e-03 3 1  ON 114
ci_0066                -5.309895e-03 3 1  ON 115
ci_0067                -5.062124e-03 3 1  ON 116
ci_0068                -4.914405e-03 3 1  ON 117
ci_0069                 4.128516e-03 3 1  ON 118
ci_0070                 4.141513e-03 3 1  ON 119
ci_0071                -9.468155e-05 3 1  ON 120
ci_0072                 4.813930e-05 3 1  ON 121
ci_0073                 4.694536e-03 3 1  ON 122
ci_0074                 4.326881e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 64
    time step          = 0.05
    reference energy   = -16.955
    reference variance = 0.366854
====================================================
  Execution time = 2.1676e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s064
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3653e-01
  Total weights = 1.9518e+06
  Execution time = 1.9114e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325747408469
                                         uncertainty =       0.002266230631

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325747408469
                                         uncertainty =       0.002266230631

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403642767
  error estimate for blocks of size 2^( 2) =       0.000416398412
  error estimate for blocks of size 2^( 3) =       0.000429957052
  error estimate for blocks of size 2^( 4) =       0.000441778197
  error estimate for blocks of size 2^( 5) =       0.000452516717
  error estimate for blocks of size 2^( 6) =       0.000459381159
  error estimate for blocks of size 2^( 7) =       0.000462911589

      target function =                  N/A
              le_mean =     -16.906626709648
             les_mean =     286.170569282827
             stat err =       0.000454146915
             autocorr =       1.265897050892
              std dev =       0.570837075655
             le_variance =       0.325854966942

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325727141432
                                         uncertainty =       0.002266222698

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325727141432
                                         uncertainty =       0.002266222698

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403630521
  error estimate for blocks of size 2^( 2) =       0.000416386862
  error estimate for blocks of size 2^( 3) =       0.000429945474
  error estimate for blocks of size 2^( 4) =       0.000441766160
  error estimate for blocks of size 2^( 5) =       0.000452504117
  error estimate for blocks of size 2^( 6) =       0.000459371076
  error estimate for blocks of size 2^( 7) =       0.000462899949

      target function =                  N/A
              le_mean =     -16.906627029548
             les_mean =     286.170624688728
             stat err =       0.000454135326
             autocorr =       1.265909253728
              std dev =       0.570819756460
             le_variance =       0.325835194366

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325736909740
                                         uncertainty =       0.002266223499

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325736909740
                                         uncertainty =       0.002266223499

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403636419
  error estimate for blocks of size 2^( 2) =       0.000416392418
  error estimate for blocks of size 2^( 3) =       0.000429951044
  error estimate for blocks of size 2^( 4) =       0.000441771956
  error estimate for blocks of size 2^( 5) =       0.000452510193
  error estimate for blocks of size 2^( 6) =       0.000459375927
  error estimate for blocks of size 2^( 7) =       0.000462905559

      target function =                  N/A
              le_mean =     -16.906626861254
             les_mean =     286.170553155848
             stat err =       0.000454140909
             autocorr =       1.265903383017
              std dev =       0.570828097889
             le_variance =       0.325844717339

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325746077761
                                         uncertainty =       0.002266229529

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325746077761
                                         uncertainty =       0.002266229529

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403641962
  error estimate for blocks of size 2^( 2) =       0.000416397651
  error estimate for blocks of size 2^( 3) =       0.000429956290
  error estimate for blocks of size 2^( 4) =       0.000441777406
  error estimate for blocks of size 2^( 5) =       0.000452515890
  error estimate for blocks of size 2^( 6) =       0.000459380495
  error estimate for blocks of size 2^( 7) =       0.000462910825

      target function =                  N/A
              le_mean =     -16.906626727408
             les_mean =     286.170565707373
             stat err =       0.000454146154
             autocorr =       1.265897855541
              std dev =       0.570835937162
             le_variance =       0.325853667155


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906626709648        initial
     8.6736e+00     8.6736e+01             3.7389e-05       -16.906627029548  <--
     3.4694e+01     3.4694e+02             9.6209e-06       -16.906626861254
     1.3878e+02     1.3878e+03             2.4230e-06       -16.906626727408

*****************************************************************************
Applying the update for shift_i =   8.6736e+00     and shift_s =   8.6736e+01
*****************************************************************************

  Execution time = 3.1343e+01
  </log>
  <optVariables href="H2O.s064.opt.xml">
   uu_0                 3.135982e-01 1 1  ON 0
   uu_1                 1.457884e-01 1 1  ON 1
   uu_2                 4.365313e-02 1 1  ON 2
   uu_3                -1.950715e-02 1 1  ON 3
   uu_4                -6.632850e-02 1 1  ON 4
   uu_5                -1.026948e-01 1 1  ON 5
   uu_6                -1.318593e-01 1 1  ON 6
   uu_7                -1.474078e-01 1 1  ON 7
   uu_8                -1.416873e-01 1 1  ON 8
   uu_9                -1.142659e-01 1 1  ON 9
   ud_0                 4.519919e-01 1 1  ON 10
   ud_1                 1.859060e-01 1 1  ON 11
   ud_2                 6.515065e-02 1 1  ON 12
   ud_3                -6.103682e-03 1 1  ON 13
   ud_4                -6.355939e-02 1 1  ON 14
   ud_5                -1.063613e-01 1 1  ON 15
   ud_6                -1.348662e-01 1 1  ON 16
   ud_7                -1.533191e-01 1 1  ON 17
   ud_8                -1.556188e-01 1 1  ON 18
   ud_9                -1.460471e-01 1 1  ON 19
   eO_0                -7.490048e-01 1 1  ON 20
   eO_1                -4.277252e-01 1 1  ON 21
   eO_2                -1.633665e-02 1 1  ON 22
   eO_3                 2.973725e-01 1 1  ON 23
   eO_4                 5.252406e-01 1 1  ON 24
   eO_5                 4.899710e-01 1 1  ON 25
   eO_6                 2.634873e-01 1 1  ON 26
   eO_7                -4.241763e-02 1 1  ON 27
   eO_8                -2.358201e-01 1 1  ON 28
   eO_9                -1.010729e-01 1 1  ON 29
  eH1_0                -2.649797e-01 1 1  ON 30
  eH1_1                -1.573541e-01 1 1  ON 31
  eH1_2                -1.071521e-01 1 1  ON 32
  eH1_3                -5.154935e-02 1 1  ON 33
  eH1_4                -1.180295e-03 1 1  ON 34
  eH1_5                 3.522871e-02 1 1  ON 35
  eH1_6                 9.800866e-02 1 1  ON 36
  eH1_7                 1.589054e-01 1 1  ON 37
  eH1_8                 1.958376e-01 1 1  ON 38
  eH1_9                 9.361304e-02 1 1  ON 39
  eH2_0                -2.635075e-01 1 1  ON 40
  eH2_1                -1.560040e-01 1 1  ON 41
  eH2_2                -1.054900e-01 1 1  ON 42
  eH2_3                -4.976816e-02 1 1  ON 43
  eH2_4                 1.003272e-03 1 1  ON 44
  eH2_5                 3.712119e-02 1 1  ON 45
  eH2_6                 9.964198e-02 1 1  ON 46
  eH2_7                 1.613438e-01 1 1  ON 47
  eH2_8                 2.000746e-01 1 1  ON 48
  eH2_9                 8.670873e-02 1 1  ON 49
ci_0001                 7.011819e-01 3 1  ON 50
ci_0002                 7.009946e-01 3 1  ON 51
ci_0003                -2.757422e-02 3 1  ON 52
ci_0004                -2.762319e-02 3 1  ON 53
ci_0005                -3.649555e-02 3 1  ON 54
ci_0006                -3.613921e-02 3 1  ON 55
ci_0007                -2.036854e-02 3 1  ON 56
ci_0008                -2.168398e-02 3 1  ON 57
ci_0009                -1.676569e-02 3 1  ON 58
ci_0010                -1.749057e-02 3 1  ON 59
ci_0011                -1.178934e-02 3 1  ON 60
ci_0012                -1.205517e-02 3 1  ON 61
ci_0013                 1.383377e-02 3 1  ON 62
ci_0014                 1.326458e-02 3 1  ON 63
ci_0015                 1.269869e-02 3 1  ON 64
ci_0016                 1.212847e-02 3 1  ON 65
ci_0017                 1.123616e-02 3 1  ON 66
ci_0018                 1.102557e-02 3 1  ON 67
ci_0019                 1.103271e-02 3 1  ON 68
ci_0020                 1.169880e-02 3 1  ON 69
ci_0021                -2.213844e-03 3 1  ON 70
ci_0022                -8.335879e-04 3 1  ON 71
ci_0023                -1.139883e-02 3 1  ON 72
ci_0024                -1.121339e-02 3 1  ON 73
ci_0025                -1.109028e-02 3 1  ON 74
ci_0026                -9.973384e-03 3 1  ON 75
ci_0027                -1.172129e-02 3 1  ON 76
ci_0028                -1.123362e-02 3 1  ON 77
ci_0029                -1.051335e-02 3 1  ON 78
ci_0030                -1.096790e-02 3 1  ON 79
ci_0031                 2.063169e-02 3 1  ON 80
ci_0032                 2.064225e-02 3 1  ON 81
ci_0033                 9.637410e-03 3 1  ON 82
ci_0034                 9.895865e-03 3 1  ON 83
ci_0035                 6.613461e-03 3 1  ON 84
ci_0036                 6.156242e-03 3 1  ON 85
ci_0037                -1.093393e-02 3 1  ON 86
ci_0038                -1.108997e-02 3 1  ON 87
ci_0039                -2.511477e-03 3 1  ON 88
ci_0040                -2.258495e-03 3 1  ON 89
ci_0041                 6.751582e-03 3 1  ON 90
ci_0042                 6.770460e-03 3 1  ON 91
ci_0043                -1.879845e-02 3 1  ON 92
ci_0044                -1.960304e-02 3 1  ON 93
ci_0045                 7.121248e-03 3 1  ON 94
ci_0046                 6.917342e-03 3 1  ON 95
ci_0047                -1.447245e-03 3 1  ON 96
ci_0048                -2.557399e-03 3 1  ON 97
ci_0049                -4.911351e-03 3 1  ON 98
ci_0050                -5.948549e-03 3 1  ON 99
ci_0051                -3.119691e-03 3 1  ON 100
ci_0052                -3.631454e-03 3 1  ON 101
ci_0053                -4.918062e-03 3 1  ON 102
ci_0054                -4.130746e-03 3 1  ON 103
ci_0055                 6.393080e-03 3 1  ON 104
ci_0056                 5.953630e-03 3 1  ON 105
ci_0057                 4.850696e-03 3 1  ON 106
ci_0058                 5.418181e-03 3 1  ON 107
ci_0059                -4.918283e-03 3 1  ON 108
ci_0060                -4.490391e-03 3 1  ON 109
ci_0061                -4.372078e-03 3 1  ON 110
ci_0062                -3.228877e-03 3 1  ON 111
ci_0063                -8.610596e-03 3 1  ON 112
ci_0064                -8.235620e-03 3 1  ON 113
ci_0065                -5.844450e-03 3 1  ON 114
ci_0066                -5.313391e-03 3 1  ON 115
ci_0067                -5.054044e-03 3 1  ON 116
ci_0068                -4.933461e-03 3 1  ON 117
ci_0069                 4.126554e-03 3 1  ON 118
ci_0070                 4.138805e-03 3 1  ON 119
ci_0071                -1.016439e-04 3 1  ON 120
ci_0072                 4.486379e-05 3 1  ON 121
ci_0073                 4.682362e-03 3 1  ON 122
ci_0074                 4.328976e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8703e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s065 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s065 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=65  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 65
    time step          = 0.05
    reference energy   = -16.9225
    reference variance = 0.304284
====================================================
  Execution time = 2.1094e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s065
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5225e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4202e-01
  Total weights = 1.951833727e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0238e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325267248200
                                         uncertainty =       0.003348767519

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325267248200
                                         uncertainty =       0.003348767519

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403352034
  error estimate for blocks of size 2^( 2) =       0.000416661286
  error estimate for blocks of size 2^( 3) =       0.000429812158
  error estimate for blocks of size 2^( 4) =       0.000442523414
  error estimate for blocks of size 2^( 5) =       0.000452774388
  error estimate for blocks of size 2^( 6) =       0.000460678784
  error estimate for blocks of size 2^( 7) =       0.000464018040

      target function =                  N/A
              le_mean =     -16.906280513485
             les_mean =     286.164340495018
             stat err =       0.000454998656
             autocorr =       1.272482229757
              std dev =       0.570425916763
             le_variance =       0.325385726515


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690628051348e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.1684e+00, overlap shift 2.1684e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906280513521       residual = 1.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906283125003       residual = 6.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906283291445       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906283312975       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906283350475       residual = 6.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906283497486       residual = 2.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906283537853       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906283440213       residual = 5.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906283460829       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906283492501       residual = 3.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.1684e+00 is 1.533276e-04

solving harmonic davidson linear method for identity shift 8.6736e+00, overlap shift 8.6736e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906280513521       residual = 1.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906281214298       residual = 7.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906281261062       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906281269069       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906281281940       residual = 6.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906281310633       residual = 2.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906281327601       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906281304221       residual = 4.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906281303377       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906281317459       residual = 3.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 8.6736e+00 is 4.212608e-05

solving harmonic davidson linear method for identity shift 3.4694e+01, overlap shift 3.4694e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906280513521       residual = 1.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906280691989       residual = 7.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906280704092       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906280706275       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906280709738       residual = 6.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906280716400       residual = 2.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906280721070       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906280715256       residual = 4.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906280714688       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906280718516       residual = 3.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.4694e+01 is 1.079750e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.586176 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7126e+01
  </log>
  <optVariables href="H2O.s065.opt.xml">
   uu_0                 3.135941e-01 1 1  ON 0
   uu_1                 1.458033e-01 1 1  ON 1
   uu_2                 4.364668e-02 1 1  ON 2
   uu_3                -1.952385e-02 1 1  ON 3
   uu_4                -6.632618e-02 1 1  ON 4
   uu_5                -1.027080e-01 1 1  ON 5
   uu_6                -1.318499e-01 1 1  ON 6
   uu_7                -1.473967e-01 1 1  ON 7
   uu_8                -1.416882e-01 1 1  ON 8
   uu_9                -1.142747e-01 1 1  ON 9
   ud_0                 4.519791e-01 1 1  ON 10
   ud_1                 1.859103e-01 1 1  ON 11
   ud_2                 6.515844e-02 1 1  ON 12
   ud_3                -6.099185e-03 1 1  ON 13
   ud_4                -6.355113e-02 1 1  ON 14
   ud_5                -1.063576e-01 1 1  ON 15
   ud_6                -1.348717e-01 1 1  ON 16
   ud_7                -1.533054e-01 1 1  ON 17
   ud_8                -1.556092e-01 1 1  ON 18
   ud_9                -1.460616e-01 1 1  ON 19
   eO_0                -7.490141e-01 1 1  ON 20
   eO_1                -4.277174e-01 1 1  ON 21
   eO_2                -1.633138e-02 1 1  ON 22
   eO_3                 2.973740e-01 1 1  ON 23
   eO_4                 5.252496e-01 1 1  ON 24
   eO_5                 4.899761e-01 1 1  ON 25
   eO_6                 2.634896e-01 1 1  ON 26
   eO_7                -4.240514e-02 1 1  ON 27
   eO_8                -2.358288e-01 1 1  ON 28
   eO_9                -1.010938e-01 1 1  ON 29
  eH1_0                -2.649827e-01 1 1  ON 30
  eH1_1                -1.573728e-01 1 1  ON 31
  eH1_2                -1.071648e-01 1 1  ON 32
  eH1_3                -5.154197e-02 1 1  ON 33
  eH1_4                -1.189173e-03 1 1  ON 34
  eH1_5                 3.521621e-02 1 1  ON 35
  eH1_6                 9.801336e-02 1 1  ON 36
  eH1_7                 1.589143e-01 1 1  ON 37
  eH1_8                 1.958461e-01 1 1  ON 38
  eH1_9                 9.363598e-02 1 1  ON 39
  eH2_0                -2.635278e-01 1 1  ON 40
  eH2_1                -1.559982e-01 1 1  ON 41
  eH2_2                -1.054907e-01 1 1  ON 42
  eH2_3                -4.976983e-02 1 1  ON 43
  eH2_4                 9.858259e-04 1 1  ON 44
  eH2_5                 3.712139e-02 1 1  ON 45
  eH2_6                 9.964946e-02 1 1  ON 46
  eH2_7                 1.613444e-01 1 1  ON 47
  eH2_8                 2.000793e-01 1 1  ON 48
  eH2_9                 8.673012e-02 1 1  ON 49
ci_0001                 7.011855e-01 3 1  ON 50
ci_0002                 7.009893e-01 3 1  ON 51
ci_0003                -2.756409e-02 3 1  ON 52
ci_0004                -2.761563e-02 3 1  ON 53
ci_0005                -3.649948e-02 3 1  ON 54
ci_0006                -3.614707e-02 3 1  ON 55
ci_0007                -2.038486e-02 3 1  ON 56
ci_0008                -2.167777e-02 3 1  ON 57
ci_0009                -1.676165e-02 3 1  ON 58
ci_0010                -1.752607e-02 3 1  ON 59
ci_0011                -1.179248e-02 3 1  ON 60
ci_0012                -1.205644e-02 3 1  ON 61
ci_0013                 1.381559e-02 3 1  ON 62
ci_0014                 1.326658e-02 3 1  ON 63
ci_0015                 1.271006e-02 3 1  ON 64
ci_0016                 1.215203e-02 3 1  ON 65
ci_0017                 1.122534e-02 3 1  ON 66
ci_0018                 1.102192e-02 3 1  ON 67
ci_0019                 1.102903e-02 3 1  ON 68
ci_0020                 1.166783e-02 3 1  ON 69
ci_0021                -2.203332e-03 3 1  ON 70
ci_0022                -8.723595e-04 3 1  ON 71
ci_0023                -1.139801e-02 3 1  ON 72
ci_0024                -1.120401e-02 3 1  ON 73
ci_0025                -1.109163e-02 3 1  ON 74
ci_0026                -9.979223e-03 3 1  ON 75
ci_0027                -1.168108e-02 3 1  ON 76
ci_0028                -1.124874e-02 3 1  ON 77
ci_0029                -1.050872e-02 3 1  ON 78
ci_0030                -1.095490e-02 3 1  ON 79
ci_0031                 2.065819e-02 3 1  ON 80
ci_0032                 2.065521e-02 3 1  ON 81
ci_0033                 9.655046e-03 3 1  ON 82
ci_0034                 9.885122e-03 3 1  ON 83
ci_0035                 6.580089e-03 3 1  ON 84
ci_0036                 6.166376e-03 3 1  ON 85
ci_0037                -1.093541e-02 3 1  ON 86
ci_0038                -1.111638e-02 3 1  ON 87
ci_0039                -2.506765e-03 3 1  ON 88
ci_0040                -2.260762e-03 3 1  ON 89
ci_0041                 6.782249e-03 3 1  ON 90
ci_0042                 6.758043e-03 3 1  ON 91
ci_0043                -1.880155e-02 3 1  ON 92
ci_0044                -1.960317e-02 3 1  ON 93
ci_0045                 7.122413e-03 3 1  ON 94
ci_0046                 6.923620e-03 3 1  ON 95
ci_0047                -1.458420e-03 3 1  ON 96
ci_0048                -2.526829e-03 3 1  ON 97
ci_0049                -4.936299e-03 3 1  ON 98
ci_0050                -5.976211e-03 3 1  ON 99
ci_0051                -3.140076e-03 3 1  ON 100
ci_0052                -3.613482e-03 3 1  ON 101
ci_0053                -4.901673e-03 3 1  ON 102
ci_0054                -4.172872e-03 3 1  ON 103
ci_0055                 6.399150e-03 3 1  ON 104
ci_0056                 5.973820e-03 3 1  ON 105
ci_0057                 4.847161e-03 3 1  ON 106
ci_0058                 5.396897e-03 3 1  ON 107
ci_0059                -4.913690e-03 3 1  ON 108
ci_0060                -4.494086e-03 3 1  ON 109
ci_0061                -4.348027e-03 3 1  ON 110
ci_0062                -3.244784e-03 3 1  ON 111
ci_0063                -8.600425e-03 3 1  ON 112
ci_0064                -8.243854e-03 3 1  ON 113
ci_0065                -5.826043e-03 3 1  ON 114
ci_0066                -5.306144e-03 3 1  ON 115
ci_0067                -5.033522e-03 3 1  ON 116
ci_0068                -4.927287e-03 3 1  ON 117
ci_0069                 4.162540e-03 3 1  ON 118
ci_0070                 4.135299e-03 3 1  ON 119
ci_0071                -9.373932e-05 3 1  ON 120
ci_0072                 4.647347e-05 3 1  ON 121
ci_0073                 4.658629e-03 3 1  ON 122
ci_0074                 4.331056e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 65
    time step          = 0.05
    reference energy   = -16.9243
    reference variance = 0.132964
====================================================
  Execution time = 2.1101e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s065
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3569e-01
  Total weights = 1.9517e+06
  Execution time = 1.9153e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321228836488
                                         uncertainty =       0.001756608512

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321228836488
                                         uncertainty =       0.001756608512

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400728291
  error estimate for blocks of size 2^( 2) =       0.000414067609
  error estimate for blocks of size 2^( 3) =       0.000427814111
  error estimate for blocks of size 2^( 4) =       0.000441270130
  error estimate for blocks of size 2^( 5) =       0.000453731399
  error estimate for blocks of size 2^( 6) =       0.000463787187
  error estimate for blocks of size 2^( 7) =       0.000471751390

      target function =                  N/A
              le_mean =     -16.905239503114
             les_mean =     286.123221153330
             stat err =       0.000457635027
             autocorr =       1.304182910094
              std dev =       0.566715384473
             le_variance =       0.321166326999

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321193131943
                                         uncertainty =       0.001755314037

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321193131943
                                         uncertainty =       0.001755314037

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400706128
  error estimate for blocks of size 2^( 2) =       0.000414044296
  error estimate for blocks of size 2^( 3) =       0.000427786162
  error estimate for blocks of size 2^( 4) =       0.000441240575
  error estimate for blocks of size 2^( 5) =       0.000453699797
  error estimate for blocks of size 2^( 6) =       0.000463750366
  error estimate for blocks of size 2^( 7) =       0.000471714864

      target function =                  N/A
              le_mean =     -16.905242217922
             les_mean =     286.124010698513
             stat err =       0.000457601401
             autocorr =       1.304135513798
              std dev =       0.566684040771
             le_variance =       0.321130802065

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321205866456
                                         uncertainty =       0.001755839695

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321205866456
                                         uncertainty =       0.001755839695

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400714026
  error estimate for blocks of size 2^( 2) =       0.000414052725
  error estimate for blocks of size 2^( 3) =       0.000427796723
  error estimate for blocks of size 2^( 4) =       0.000441251792
  error estimate for blocks of size 2^( 5) =       0.000453711873
  error estimate for blocks of size 2^( 6) =       0.000463764947
  error estimate for blocks of size 2^( 7) =       0.000471729482

      target function =                  N/A
              le_mean =     -16.905240865679
             les_mean =     286.122811789473
             stat err =       0.000457614523
             autocorr =       1.304158902716
              std dev =       0.566695209982
             le_variance =       0.321143461016

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321225650236
                                         uncertainty =       0.001756504789

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321225650236
                                         uncertainty =       0.001756504789

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400726312
  error estimate for blocks of size 2^( 2) =       0.000414065555
  error estimate for blocks of size 2^( 3) =       0.000427811862
  error estimate for blocks of size 2^( 4) =       0.000441267824
  error estimate for blocks of size 2^( 5) =       0.000453728704
  error estimate for blocks of size 2^( 6) =       0.000463783719
  error estimate for blocks of size 2^( 7) =       0.000471747756

      target function =                  N/A
              le_mean =     -16.905239530949
             les_mean =     286.123776146754
             stat err =       0.000457632001
             autocorr =       1.304178549376
              std dev =       0.566712585330
             le_variance =       0.321163154371


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905239503114        initial
     2.1684e+00     2.1684e+01             1.5333e-04       -16.905242217922  <--
     8.6736e+00     8.6736e+01             4.2126e-05       -16.905240865679
     3.4694e+01     3.4694e+02             1.0798e-05       -16.905239530949

*****************************************************************************
Applying the update for shift_i =   2.1684e+00     and shift_s =   2.1684e+01
*****************************************************************************

  Execution time = 3.0774e+01
  </log>
  <optVariables href="H2O.s065.opt.xml">
   uu_0                 3.135870e-01 1 1  ON 0
   uu_1                 1.458399e-01 1 1  ON 1
   uu_2                 4.362864e-02 1 1  ON 2
   uu_3                -1.956844e-02 1 1  ON 3
   uu_4                -6.632429e-02 1 1  ON 4
   uu_5                -1.027420e-01 1 1  ON 5
   uu_6                -1.318251e-01 1 1  ON 6
   uu_7                -1.473652e-01 1 1  ON 7
   uu_8                -1.416905e-01 1 1  ON 8
   uu_9                -1.143008e-01 1 1  ON 9
   ud_0                 4.519485e-01 1 1  ON 10
   ud_1                 1.859230e-01 1 1  ON 11
   ud_2                 6.517887e-02 1 1  ON 12
   ud_3                -6.084545e-03 1 1  ON 13
   ud_4                -6.353012e-02 1 1  ON 14
   ud_5                -1.063463e-01 1 1  ON 15
   ud_6                -1.348871e-01 1 1  ON 16
   ud_7                -1.532674e-01 1 1  ON 17
   ud_8                -1.555810e-01 1 1  ON 18
   ud_9                -1.461046e-01 1 1  ON 19
   eO_0                -7.490367e-01 1 1  ON 20
   eO_1                -4.276976e-01 1 1  ON 21
   eO_2                -1.631644e-02 1 1  ON 22
   eO_3                 2.973778e-01 1 1  ON 23
   eO_4                 5.252768e-01 1 1  ON 24
   eO_5                 4.899916e-01 1 1  ON 25
   eO_6                 2.634958e-01 1 1  ON 26
   eO_7                -4.236814e-02 1 1  ON 27
   eO_8                -2.358549e-01 1 1  ON 28
   eO_9                -1.011561e-01 1 1  ON 29
  eH1_0                -2.649936e-01 1 1  ON 30
  eH1_1                -1.574260e-01 1 1  ON 31
  eH1_2                -1.071998e-01 1 1  ON 32
  eH1_3                -5.152504e-02 1 1  ON 33
  eH1_4                -1.213925e-03 1 1  ON 34
  eH1_5                 3.517852e-02 1 1  ON 35
  eH1_6                 9.802680e-02 1 1  ON 36
  eH1_7                 1.589407e-01 1 1  ON 37
  eH1_8                 1.958718e-01 1 1  ON 38
  eH1_9                 9.370469e-02 1 1  ON 39
  eH2_0                -2.635872e-01 1 1  ON 40
  eH2_1                -1.559824e-01 1 1  ON 41
  eH2_2                -1.054925e-01 1 1  ON 42
  eH2_3                -4.977577e-02 1 1  ON 43
  eH2_4                 9.355415e-04 1 1  ON 44
  eH2_5                 3.712085e-02 1 1  ON 45
  eH2_6                 9.967164e-02 1 1  ON 46
  eH2_7                 1.613464e-01 1 1  ON 47
  eH2_8                 2.000933e-01 1 1  ON 48
  eH2_9                 8.679416e-02 1 1  ON 49
ci_0001                 7.011959e-01 3 1  ON 50
ci_0002                 7.009743e-01 3 1  ON 51
ci_0003                -2.753710e-02 3 1  ON 52
ci_0004                -2.759410e-02 3 1  ON 53
ci_0005                -3.651080e-02 3 1  ON 54
ci_0006                -3.616931e-02 3 1  ON 55
ci_0007                -2.043240e-02 3 1  ON 56
ci_0008                -2.166003e-02 3 1  ON 57
ci_0009                -1.675116e-02 3 1  ON 58
ci_0010                -1.762178e-02 3 1  ON 59
ci_0011                -1.180145e-02 3 1  ON 60
ci_0012                -1.205987e-02 3 1  ON 61
ci_0013                 1.376648e-02 3 1  ON 62
ci_0014                 1.327183e-02 3 1  ON 63
ci_0015                 1.274177e-02 3 1  ON 64
ci_0016                 1.221657e-02 3 1  ON 65
ci_0017                 1.119630e-02 3 1  ON 66
ci_0018                 1.101201e-02 3 1  ON 67
ci_0019                 1.101953e-02 3 1  ON 68
ci_0020                 1.158288e-02 3 1  ON 69
ci_0021                -2.172883e-03 3 1  ON 70
ci_0022                -9.839823e-04 3 1  ON 71
ci_0023                -1.139640e-02 3 1  ON 72
ci_0024                -1.117844e-02 3 1  ON 73
ci_0025                -1.109565e-02 3 1  ON 74
ci_0026                -9.995201e-03 3 1  ON 75
ci_0027                -1.157187e-02 3 1  ON 76
ci_0028                -1.128967e-02 3 1  ON 77
ci_0029                -1.049653e-02 3 1  ON 78
ci_0030                -1.091924e-02 3 1  ON 79
ci_0031                 2.073329e-02 3 1  ON 80
ci_0032                 2.069153e-02 3 1  ON 81
ci_0033                 9.705670e-03 3 1  ON 82
ci_0034                 9.854374e-03 3 1  ON 83
ci_0035                 6.487891e-03 3 1  ON 84
ci_0036                 6.194073e-03 3 1  ON 85
ci_0037                -1.093966e-02 3 1  ON 86
ci_0038                -1.118988e-02 3 1  ON 87
ci_0039                -2.494763e-03 3 1  ON 88
ci_0040                -2.266770e-03 3 1  ON 89
ci_0041                 6.866069e-03 3 1  ON 90
ci_0042                 6.723923e-03 3 1  ON 91
ci_0043                -1.881017e-02 3 1  ON 92
ci_0044                -1.960229e-02 3 1  ON 93
ci_0045                 7.125909e-03 3 1  ON 94
ci_0046                 6.941217e-03 3 1  ON 95
ci_0047                -1.487490e-03 3 1  ON 96
ci_0048                -2.447464e-03 3 1  ON 97
ci_0049                -5.004718e-03 3 1  ON 98
ci_0050                -6.051441e-03 3 1  ON 99
ci_0051                -3.192988e-03 3 1  ON 100
ci_0052                -3.566703e-03 3 1  ON 101
ci_0053                -4.858764e-03 3 1  ON 102
ci_0054                -4.284074e-03 3 1  ON 103
ci_0055                 6.415932e-03 3 1  ON 104
ci_0056                 6.030622e-03 3 1  ON 105
ci_0057                 4.837359e-03 3 1  ON 106
ci_0058                 5.338090e-03 3 1  ON 107
ci_0059                -4.901660e-03 3 1  ON 108
ci_0060                -4.503711e-03 3 1  ON 109
ci_0061                -4.281731e-03 3 1  ON 110
ci_0062                -3.288587e-03 3 1  ON 111
ci_0063                -8.573633e-03 3 1  ON 112
ci_0064                -8.265284e-03 3 1  ON 113
ci_0065                -5.776039e-03 3 1  ON 114
ci_0066                -5.286749e-03 3 1  ON 115
ci_0067                -4.979778e-03 3 1  ON 116
ci_0068                -4.910986e-03 3 1  ON 117
ci_0069                 4.256668e-03 3 1  ON 118
ci_0070                 4.126150e-03 3 1  ON 119
ci_0071                -7.285338e-05 3 1  ON 120
ci_0072                 5.121625e-05 3 1  ON 121
ci_0073                 4.596979e-03 3 1  ON 122
ci_0074                 4.336654e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7906e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s066 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s066 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=66  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 66
    time step          = 0.05
    reference energy   = -16.9876
    reference variance = 0.293155
====================================================
  Execution time = 2.1218e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s066
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5271e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3584e-01
  Total weights = 1.951952723e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0604e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323087216111
                                         uncertainty =       0.002181454474

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323087216111
                                         uncertainty =       0.002181454474

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401942305
  error estimate for blocks of size 2^( 2) =       0.000414564915
  error estimate for blocks of size 2^( 3) =       0.000427622101
  error estimate for blocks of size 2^( 4) =       0.000439781933
  error estimate for blocks of size 2^( 5) =       0.000450734930
  error estimate for blocks of size 2^( 6) =       0.000458658972
  error estimate for blocks of size 2^( 7) =       0.000464137664

      target function =                  N/A
              le_mean =     -16.906136530215
             les_mean =     286.153295333444
             stat err =       0.000453328375
             autocorr =       1.272032972167
              std dev =       0.568432259338
             le_variance =       0.323115233456


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690613653021e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.4210e-01, overlap shift 5.4210e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906136530210       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906142841250       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906142864129       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906143177451       residual = 8.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906143133579       residual = 4.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906143504655       residual = 2.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906143849966       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906143839123       residual = 5.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906143895497       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906143836975       residual = 8.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.4210e-01 is 5.203318e-04

solving harmonic davidson linear method for identity shift 2.1684e+00, overlap shift 2.1684e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906136530210       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906138496795       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906138494540       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906138588501       residual = 8.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906138629044       residual = 3.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906138706018       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906138813696       residual = 6.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906138788275       residual = 2.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906138800267       residual = 8.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.1684e+00 is 1.462082e-04

solving harmonic davidson linear method for identity shift 8.6736e+00, overlap shift 8.6736e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906136530210       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906137054136       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906137053139       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906137078723       residual = 8.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906137092196       residual = 3.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906137112100       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906137138969       residual = 5.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906137131847       residual = 2.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906137136156       residual = 6.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 8.6736e+00 is 3.920548e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.589806 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7286e+01
  </log>
  <optVariables href="H2O.s066.opt.xml">
   uu_0                 3.135636e-01 1 1  ON 0
   uu_1                 1.458105e-01 1 1  ON 1
   uu_2                 4.363324e-02 1 1  ON 2
   uu_3                -1.957084e-02 1 1  ON 3
   uu_4                -6.633338e-02 1 1  ON 4
   uu_5                -1.027317e-01 1 1  ON 5
   uu_6                -1.318253e-01 1 1  ON 6
   uu_7                -1.474065e-01 1 1  ON 7
   uu_8                -1.416733e-01 1 1  ON 8
   uu_9                -1.142928e-01 1 1  ON 9
   ud_0                 4.519206e-01 1 1  ON 10
   ud_1                 1.859353e-01 1 1  ON 11
   ud_2                 6.517987e-02 1 1  ON 12
   ud_3                -6.105823e-03 1 1  ON 13
   ud_4                -6.355585e-02 1 1  ON 14
   ud_5                -1.063463e-01 1 1  ON 15
   ud_6                -1.349123e-01 1 1  ON 16
   ud_7                -1.532420e-01 1 1  ON 17
   ud_8                -1.555685e-01 1 1  ON 18
   ud_9                -1.460767e-01 1 1  ON 19
   eO_0                -7.489927e-01 1 1  ON 20
   eO_1                -4.277047e-01 1 1  ON 21
   eO_2                -1.635091e-02 1 1  ON 22
   eO_3                 2.973986e-01 1 1  ON 23
   eO_4                 5.253106e-01 1 1  ON 24
   eO_5                 4.900219e-01 1 1  ON 25
   eO_6                 2.634828e-01 1 1  ON 26
   eO_7                -4.236635e-02 1 1  ON 27
   eO_8                -2.358744e-01 1 1  ON 28
   eO_9                -1.012021e-01 1 1  ON 29
  eH1_0                -2.650648e-01 1 1  ON 30
  eH1_1                -1.574157e-01 1 1  ON 31
  eH1_2                -1.072499e-01 1 1  ON 32
  eH1_3                -5.156327e-02 1 1  ON 33
  eH1_4                -1.255959e-03 1 1  ON 34
  eH1_5                 3.516297e-02 1 1  ON 35
  eH1_6                 9.806321e-02 1 1  ON 36
  eH1_7                 1.589534e-01 1 1  ON 37
  eH1_8                 1.959088e-01 1 1  ON 38
  eH1_9                 9.379407e-02 1 1  ON 39
  eH2_0                -2.636473e-01 1 1  ON 40
  eH2_1                -1.559598e-01 1 1  ON 41
  eH2_2                -1.054943e-01 1 1  ON 42
  eH2_3                -4.981401e-02 1 1  ON 43
  eH2_4                 9.543378e-04 1 1  ON 44
  eH2_5                 3.709138e-02 1 1  ON 45
  eH2_6                 9.966544e-02 1 1  ON 46
  eH2_7                 1.613225e-01 1 1  ON 47
  eH2_8                 2.001162e-01 1 1  ON 48
  eH2_9                 8.687957e-02 1 1  ON 49
ci_0001                 7.011739e-01 3 1  ON 50
ci_0002                 7.009935e-01 3 1  ON 51
ci_0003                -2.751389e-02 3 1  ON 52
ci_0004                -2.755405e-02 3 1  ON 53
ci_0005                -3.651810e-02 3 1  ON 54
ci_0006                -3.625994e-02 3 1  ON 55
ci_0007                -2.048599e-02 3 1  ON 56
ci_0008                -2.162965e-02 3 1  ON 57
ci_0009                -1.671139e-02 3 1  ON 58
ci_0010                -1.762424e-02 3 1  ON 59
ci_0011                -1.180660e-02 3 1  ON 60
ci_0012                -1.199584e-02 3 1  ON 61
ci_0013                 1.375041e-02 3 1  ON 62
ci_0014                 1.328646e-02 3 1  ON 63
ci_0015                 1.281794e-02 3 1  ON 64
ci_0016                 1.232763e-02 3 1  ON 65
ci_0017                 1.119881e-02 3 1  ON 66
ci_0018                 1.109387e-02 3 1  ON 67
ci_0019                 1.103128e-02 3 1  ON 68
ci_0020                 1.161103e-02 3 1  ON 69
ci_0021                -2.117662e-03 3 1  ON 70
ci_0022                -1.029382e-03 3 1  ON 71
ci_0023                -1.139144e-02 3 1  ON 72
ci_0024                -1.114792e-02 3 1  ON 73
ci_0025                -1.107806e-02 3 1  ON 74
ci_0026                -9.992692e-03 3 1  ON 75
ci_0027                -1.154836e-02 3 1  ON 76
ci_0028                -1.130123e-02 3 1  ON 77
ci_0029                -1.048615e-02 3 1  ON 78
ci_0030                -1.094925e-02 3 1  ON 79
ci_0031                 2.079055e-02 3 1  ON 80
ci_0032                 2.070813e-02 3 1  ON 81
ci_0033                 9.716331e-03 3 1  ON 82
ci_0034                 9.792799e-03 3 1  ON 83
ci_0035                 6.537039e-03 3 1  ON 84
ci_0036                 6.185795e-03 3 1  ON 85
ci_0037                -1.090622e-02 3 1  ON 86
ci_0038                -1.114179e-02 3 1  ON 87
ci_0039                -2.506181e-03 3 1  ON 88
ci_0040                -2.308331e-03 3 1  ON 89
ci_0041                 6.858082e-03 3 1  ON 90
ci_0042                 6.751562e-03 3 1  ON 91
ci_0043                -1.883600e-02 3 1  ON 92
ci_0044                -1.945608e-02 3 1  ON 93
ci_0045                 7.143901e-03 3 1  ON 94
ci_0046                 6.969396e-03 3 1  ON 95
ci_0047                -1.549152e-03 3 1  ON 96
ci_0048                -2.402493e-03 3 1  ON 97
ci_0049                -5.013384e-03 3 1  ON 98
ci_0050                -6.022525e-03 3 1  ON 99
ci_0051                -3.232870e-03 3 1  ON 100
ci_0052                -3.584813e-03 3 1  ON 101
ci_0053                -4.873688e-03 3 1  ON 102
ci_0054                -4.220323e-03 3 1  ON 103
ci_0055                 6.343018e-03 3 1  ON 104
ci_0056                 6.092912e-03 3 1  ON 105
ci_0057                 4.858239e-03 3 1  ON 106
ci_0058                 5.224517e-03 3 1  ON 107
ci_0059                -4.879204e-03 3 1  ON 108
ci_0060                -4.598148e-03 3 1  ON 109
ci_0061                -4.310354e-03 3 1  ON 110
ci_0062                -3.345674e-03 3 1  ON 111
ci_0063                -8.631255e-03 3 1  ON 112
ci_0064                -8.285964e-03 3 1  ON 113
ci_0065                -5.681989e-03 3 1  ON 114
ci_0066                -5.141516e-03 3 1  ON 115
ci_0067                -4.974705e-03 3 1  ON 116
ci_0068                -4.938180e-03 3 1  ON 117
ci_0069                 4.308066e-03 3 1  ON 118
ci_0070                 4.105169e-03 3 1  ON 119
ci_0071                -4.834933e-05 3 1  ON 120
ci_0072                 9.983370e-07 3 1  ON 121
ci_0073                 4.584833e-03 3 1  ON 122
ci_0074                 4.346486e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 66
    time step          = 0.05
    reference energy   = -16.9368
    reference variance = 0.409545
====================================================
  Execution time = 2.2921e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s066
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3649e-01
  Total weights = 1.9516e+06
  Execution time = 1.9097e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323395690965
                                         uncertainty =       0.002564709585

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323395690965
                                         uncertainty =       0.002564709585

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402092661
  error estimate for blocks of size 2^( 2) =       0.000415138649
  error estimate for blocks of size 2^( 3) =       0.000428486437
  error estimate for blocks of size 2^( 4) =       0.000441153767
  error estimate for blocks of size 2^( 5) =       0.000452653439
  error estimate for blocks of size 2^( 6) =       0.000461656225
  error estimate for blocks of size 2^( 7) =       0.000467560679

      target function =                  N/A
              le_mean =     -16.906873364465
             les_mean =     286.178792798483
             stat err =       0.000455756028
             autocorr =       1.284732024236
              std dev =       0.568644894460
             le_variance =       0.323357015996

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323298457442
                                         uncertainty =       0.002558032619

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323298457442
                                         uncertainty =       0.002558032619

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402031985
  error estimate for blocks of size 2^( 2) =       0.000415080733
  error estimate for blocks of size 2^( 3) =       0.000428428994
  error estimate for blocks of size 2^( 4) =       0.000441092538
  error estimate for blocks of size 2^( 5) =       0.000452588406
  error estimate for blocks of size 2^( 6) =       0.000461590612
  error estimate for blocks of size 2^( 7) =       0.000467494851

      target function =                  N/A
              le_mean =     -16.906878757725
             les_mean =     286.180267371454
             stat err =       0.000455691602
             autocorr =       1.284756541400
              std dev =       0.568559085418
             le_variance =       0.323259433611

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323320671857
                                         uncertainty =       0.002560485233

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323320671857
                                         uncertainty =       0.002560485233

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402045876
  error estimate for blocks of size 2^( 2) =       0.000415093661
  error estimate for blocks of size 2^( 3) =       0.000428441427
  error estimate for blocks of size 2^( 4) =       0.000441106556
  error estimate for blocks of size 2^( 5) =       0.000452603850
  error estimate for blocks of size 2^( 6) =       0.000461606845
  error estimate for blocks of size 2^( 7) =       0.000467510775

      target function =                  N/A
              le_mean =     -16.906876151203
             les_mean =     286.179567663486
             stat err =       0.000455707007
             autocorr =       1.284754620557
              std dev =       0.568578730688
             le_variance =       0.323281772991

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323383705144
                                         uncertainty =       0.002564100140

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323383705144
                                         uncertainty =       0.002564100140

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402085190
  error estimate for blocks of size 2^( 2) =       0.000415131440
  error estimate for blocks of size 2^( 3) =       0.000428479261
  error estimate for blocks of size 2^( 4) =       0.000441146314
  error estimate for blocks of size 2^( 5) =       0.000452645688
  error estimate for blocks of size 2^( 6) =       0.000461648567
  error estimate for blocks of size 2^( 7) =       0.000467552921

      target function =                  N/A
              le_mean =     -16.906873589883
             les_mean =     286.178783613419
             stat err =       0.000455748373
             autocorr =       1.284736605648
              std dev =       0.568634329221
             le_variance =       0.323345000369


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906873364465        initial
     5.4210e-01     5.4210e+00             5.2033e-04       -16.906878757725  <--
     2.1684e+00     2.1684e+01             1.4621e-04       -16.906876151203
     8.6736e+00     8.6736e+01             3.9205e-05       -16.906873589883

*****************************************************************************
Applying the update for shift_i =   5.4210e-01     and shift_s =   5.4210e+00
*****************************************************************************

  Execution time = 3.2560e+01
  </log>
  <optVariables href="H2O.s066.opt.xml">
   uu_0                 3.134906e-01 1 1  ON 0
   uu_1                 1.457597e-01 1 1  ON 1
   uu_2                 4.363426e-02 1 1  ON 2
   uu_3                -1.957212e-02 1 1  ON 3
   uu_4                -6.635376e-02 1 1  ON 4
   uu_5                -1.027292e-01 1 1  ON 5
   uu_6                -1.318290e-01 1 1  ON 6
   uu_7                -1.475205e-01 1 1  ON 7
   uu_8                -1.416328e-01 1 1  ON 8
   uu_9                -1.142732e-01 1 1  ON 9
   ud_0                 4.518684e-01 1 1  ON 10
   ud_1                 1.859397e-01 1 1  ON 11
   ud_2                 6.517325e-02 1 1  ON 12
   ud_3                -6.161605e-03 1 1  ON 13
   ud_4                -6.362244e-02 1 1  ON 14
   ud_5                -1.063615e-01 1 1  ON 15
   ud_6                -1.349611e-01 1 1  ON 16
   ud_7                -1.531788e-01 1 1  ON 17
   ud_8                -1.555374e-01 1 1  ON 18
   ud_9                -1.459936e-01 1 1  ON 19
   eO_0                -7.488892e-01 1 1  ON 20
   eO_1                -4.277073e-01 1 1  ON 21
   eO_2                -1.640853e-02 1 1  ON 22
   eO_3                 2.974343e-01 1 1  ON 23
   eO_4                 5.254046e-01 1 1  ON 24
   eO_5                 4.901121e-01 1 1  ON 25
   eO_6                 2.634505e-01 1 1  ON 26
   eO_7                -4.236340e-02 1 1  ON 27
   eO_8                -2.359360e-01 1 1  ON 28
   eO_9                -1.013425e-01 1 1  ON 29
  eH1_0                -2.652614e-01 1 1  ON 30
  eH1_1                -1.574249e-01 1 1  ON 31
  eH1_2                -1.073854e-01 1 1  ON 32
  eH1_3                -5.167197e-02 1 1  ON 33
  eH1_4                -1.376414e-03 1 1  ON 34
  eH1_5                 3.511220e-02 1 1  ON 35
  eH1_6                 9.816459e-02 1 1  ON 36
  eH1_7                 1.589929e-01 1 1  ON 37
  eH1_8                 1.960220e-01 1 1  ON 38
  eH1_9                 9.406603e-02 1 1  ON 39
  eH2_0                -2.638031e-01 1 1  ON 40
  eH2_1                -1.559156e-01 1 1  ON 41
  eH2_2                -1.055160e-01 1 1  ON 42
  eH2_3                -4.989111e-02 1 1  ON 43
  eH2_4                 9.762057e-04 1 1  ON 44
  eH2_5                 3.701188e-02 1 1  ON 45
  eH2_6                 9.964760e-02 1 1  ON 46
  eH2_7                 1.612509e-01 1 1  ON 47
  eH2_8                 2.001843e-01 1 1  ON 48
  eH2_9                 8.713868e-02 1 1  ON 49
ci_0001                 7.011070e-01 3 1  ON 50
ci_0002                 7.010534e-01 3 1  ON 51
ci_0003                -2.745995e-02 3 1  ON 52
ci_0004                -2.746330e-02 3 1  ON 53
ci_0005                -3.653946e-02 3 1  ON 54
ci_0006                -3.648744e-02 3 1  ON 55
ci_0007                -2.062881e-02 3 1  ON 56
ci_0008                -2.154994e-02 3 1  ON 57
ci_0009                -1.662845e-02 3 1  ON 58
ci_0010                -1.762758e-02 3 1  ON 59
ci_0011                -1.181984e-02 3 1  ON 60
ci_0012                -1.185434e-02 3 1  ON 61
ci_0013                 1.371795e-02 3 1  ON 62
ci_0014                 1.332132e-02 3 1  ON 63
ci_0015                 1.298529e-02 3 1  ON 64
ci_0016                 1.256522e-02 3 1  ON 65
ci_0017                 1.120440e-02 3 1  ON 66
ci_0018                 1.126474e-02 3 1  ON 67
ci_0019                 1.105329e-02 3 1  ON 68
ci_0020                 1.167110e-02 3 1  ON 69
ci_0021                -1.975965e-03 3 1  ON 70
ci_0022                -1.153651e-03 3 1  ON 71
ci_0023                -1.137892e-02 3 1  ON 72
ci_0024                -1.107821e-02 3 1  ON 73
ci_0025                -1.104159e-02 3 1  ON 74
ci_0026                -9.986402e-03 3 1  ON 75
ci_0027                -1.149273e-02 3 1  ON 76
ci_0028                -1.132139e-02 3 1  ON 77
ci_0029                -1.046182e-02 3 1  ON 78
ci_0030                -1.100786e-02 3 1  ON 79
ci_0031                 2.093891e-02 3 1  ON 80
ci_0032                 2.075212e-02 3 1  ON 81
ci_0033                 9.744114e-03 3 1  ON 82
ci_0034                 9.638197e-03 3 1  ON 83
ci_0035                 6.644153e-03 3 1  ON 84
ci_0036                 6.167637e-03 3 1  ON 85
ci_0037                -1.082780e-02 3 1  ON 86
ci_0038                -1.103358e-02 3 1  ON 87
ci_0039                -2.527268e-03 3 1  ON 88
ci_0040                -2.383339e-03 3 1  ON 89
ci_0041                 6.844373e-03 3 1  ON 90
ci_0042                 6.813530e-03 3 1  ON 91
ci_0043                -1.890776e-02 3 1  ON 92
ci_0044                -1.908196e-02 3 1  ON 93
ci_0045                 7.187673e-03 3 1  ON 94
ci_0046                 7.038322e-03 3 1  ON 95
ci_0047                -1.662314e-03 3 1  ON 96
ci_0048                -2.321547e-03 3 1  ON 97
ci_0049                -5.030081e-03 3 1  ON 98
ci_0050                -5.957633e-03 3 1  ON 99
ci_0051                -3.304382e-03 3 1  ON 100
ci_0052                -3.617021e-03 3 1  ON 101
ci_0053                -4.903180e-03 3 1  ON 102
ci_0054                -4.094800e-03 3 1  ON 103
ci_0055                 6.171830e-03 3 1  ON 104
ci_0056                 6.238918e-03 3 1  ON 105
ci_0057                 4.902517e-03 3 1  ON 106
ci_0058                 4.974907e-03 3 1  ON 107
ci_0059                -4.837024e-03 3 1  ON 108
ci_0060                -4.781483e-03 3 1  ON 109
ci_0061                -4.370337e-03 3 1  ON 110
ci_0062                -3.470647e-03 3 1  ON 111
ci_0063                -8.746380e-03 3 1  ON 112
ci_0064                -8.332597e-03 3 1  ON 113
ci_0065                -5.486211e-03 3 1  ON 114
ci_0066                -4.837513e-03 3 1  ON 115
ci_0067                -4.964502e-03 3 1  ON 116
ci_0068                -4.990017e-03 3 1  ON 117
ci_0069                 4.404173e-03 3 1  ON 118
ci_0070                 4.066402e-03 3 1  ON 119
ci_0071                 5.818693e-06 3 1  ON 120
ci_0072                -1.105542e-04 3 1  ON 121
ci_0073                 4.562281e-03 3 1  ON 122
ci_0074                 4.363647e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9852e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s067 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s067 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=67  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 67
    time step          = 0.05
    reference energy   = -16.886
    reference variance = 0.272619
====================================================
  Execution time = 2.1106e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s067
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5241e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3404e-01
  Total weights = 1.951950378e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0313e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323121232202
                                         uncertainty =       0.001763194160

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323121232202
                                         uncertainty =       0.001763194160

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401908269
  error estimate for blocks of size 2^( 2) =       0.000414774522
  error estimate for blocks of size 2^( 3) =       0.000427602383
  error estimate for blocks of size 2^( 4) =       0.000439989440
  error estimate for blocks of size 2^( 5) =       0.000450305718
  error estimate for blocks of size 2^( 6) =       0.000459238402
  error estimate for blocks of size 2^( 7) =       0.000464363784

      target function =                  N/A
              le_mean =     -16.906148386663
             les_mean =     286.151894281516
             stat err =       0.000453474336
             autocorr =       1.273067829393
              std dev =       0.568384124888
             le_variance =       0.323060513425


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690614838666e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3553e-01, overlap shift 1.3553e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906148386693       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906163643550       residual = 3.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906166791600       residual = 7.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906165463223       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906163695327       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906164938183       residual = 9.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906164307940       residual = 5.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906164336016       residual = 3.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906163753771       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906164643928       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906164963562       residual = 6.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906165440290       residual = 2.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906165674712       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906165509606       residual = 9.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.3553e-01 is 1.494000e-03

solving harmonic davidson linear method for identity shift 5.4210e-01, overlap shift 5.4210e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906148386693       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906155402999       residual = 3.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906156569797       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906156114060       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906155314603       residual = 8.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906155696911       residual = 4.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906155623024       residual = 2.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906155595428       residual = 6.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906155444555       residual = 3.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906155526805       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906155653945       residual = 6.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.4210e-01 is 6.854347e-04

solving harmonic davidson linear method for identity shift 2.1684e+00, overlap shift 2.1684e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906148386693       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906150606700       residual = 3.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906150958460       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906150857687       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906150551574       residual = 5.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906150682948       residual = 3.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906150671587       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906150647273       residual = 3.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906150632754       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906150630423       residual = 4.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.1684e+00 is 2.177361e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.595238 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7146e+01
  </log>
  <optVariables href="H2O.s067.opt.xml">
   uu_0                 3.135414e-01 1 1  ON 0
   uu_1                 1.457018e-01 1 1  ON 1
   uu_2                 4.345986e-02 1 1  ON 2
   uu_3                -1.964724e-02 1 1  ON 3
   uu_4                -6.639347e-02 1 1  ON 4
   uu_5                -1.028475e-01 1 1  ON 5
   uu_6                -1.319474e-01 1 1  ON 6
   uu_7                -1.475070e-01 1 1  ON 7
   uu_8                -1.415299e-01 1 1  ON 8
   uu_9                -1.142210e-01 1 1  ON 9
   ud_0                 4.517745e-01 1 1  ON 10
   ud_1                 1.858479e-01 1 1  ON 11
   ud_2                 6.511103e-02 1 1  ON 12
   ud_3                -6.137565e-03 1 1  ON 13
   ud_4                -6.363780e-02 1 1  ON 14
   ud_5                -1.062362e-01 1 1  ON 15
   ud_6                -1.349272e-01 1 1  ON 16
   ud_7                -1.530819e-01 1 1  ON 17
   ud_8                -1.552947e-01 1 1  ON 18
   ud_9                -1.460626e-01 1 1  ON 19
   eO_0                -7.489231e-01 1 1  ON 20
   eO_1                -4.275772e-01 1 1  ON 21
   eO_2                -1.633222e-02 1 1  ON 22
   eO_3                 2.976886e-01 1 1  ON 23
   eO_4                 5.253221e-01 1 1  ON 24
   eO_5                 4.901234e-01 1 1  ON 25
   eO_6                 2.633943e-01 1 1  ON 26
   eO_7                -4.231604e-02 1 1  ON 27
   eO_8                -2.360167e-01 1 1  ON 28
   eO_9                -1.015611e-01 1 1  ON 29
  eH1_0                -2.653704e-01 1 1  ON 30
  eH1_1                -1.574121e-01 1 1  ON 31
  eH1_2                -1.075126e-01 1 1  ON 32
  eH1_3                -5.171335e-02 1 1  ON 33
  eH1_4                -1.600084e-03 1 1  ON 34
  eH1_5                 3.482186e-02 1 1  ON 35
  eH1_6                 9.829786e-02 1 1  ON 36
  eH1_7                 1.592515e-01 1 1  ON 37
  eH1_8                 1.961125e-01 1 1  ON 38
  eH1_9                 9.429103e-02 1 1  ON 39
  eH2_0                -2.636804e-01 1 1  ON 40
  eH2_1                -1.558850e-01 1 1  ON 41
  eH2_2                -1.057598e-01 1 1  ON 42
  eH2_3                -4.987357e-02 1 1  ON 43
  eH2_4                 7.628661e-04 1 1  ON 44
  eH2_5                 3.682047e-02 1 1  ON 45
  eH2_6                 9.944361e-02 1 1  ON 46
  eH2_7                 1.612531e-01 1 1  ON 47
  eH2_8                 2.004314e-01 1 1  ON 48
  eH2_9                 8.751087e-02 1 1  ON 49
ci_0001                 7.010306e-01 3 1  ON 50
ci_0002                 7.011598e-01 3 1  ON 51
ci_0003                -2.731162e-02 3 1  ON 52
ci_0004                -2.757848e-02 3 1  ON 53
ci_0005                -3.604737e-02 3 1  ON 54
ci_0006                -3.640182e-02 3 1  ON 55
ci_0007                -2.062037e-02 3 1  ON 56
ci_0008                -2.142902e-02 3 1  ON 57
ci_0009                -1.676276e-02 3 1  ON 58
ci_0010                -1.766419e-02 3 1  ON 59
ci_0011                -1.183328e-02 3 1  ON 60
ci_0012                -1.194261e-02 3 1  ON 61
ci_0013                 1.352194e-02 3 1  ON 62
ci_0014                 1.322076e-02 3 1  ON 63
ci_0015                 1.289319e-02 3 1  ON 64
ci_0016                 1.264525e-02 3 1  ON 65
ci_0017                 1.109270e-02 3 1  ON 66
ci_0018                 1.129765e-02 3 1  ON 67
ci_0019                 1.129784e-02 3 1  ON 68
ci_0020                 1.152940e-02 3 1  ON 69
ci_0021                -1.822626e-03 3 1  ON 70
ci_0022                -9.838380e-04 3 1  ON 71
ci_0023                -1.109938e-02 3 1  ON 72
ci_0024                -1.102740e-02 3 1  ON 73
ci_0025                -1.080756e-02 3 1  ON 74
ci_0026                -1.067184e-02 3 1  ON 75
ci_0027                -1.144054e-02 3 1  ON 76
ci_0028                -1.143000e-02 3 1  ON 77
ci_0029                -1.033191e-02 3 1  ON 78
ci_0030                -1.122472e-02 3 1  ON 79
ci_0031                 2.074210e-02 3 1  ON 80
ci_0032                 2.100503e-02 3 1  ON 81
ci_0033                 1.029673e-02 3 1  ON 82
ci_0034                 9.687664e-03 3 1  ON 83
ci_0035                 6.395656e-03 3 1  ON 84
ci_0036                 6.394076e-03 3 1  ON 85
ci_0037                -1.092230e-02 3 1  ON 86
ci_0038                -1.106777e-02 3 1  ON 87
ci_0039                -2.285878e-03 3 1  ON 88
ci_0040                -2.524784e-03 3 1  ON 89
ci_0041                 6.865071e-03 3 1  ON 90
ci_0042                 6.870976e-03 3 1  ON 91
ci_0043                -1.887509e-02 3 1  ON 92
ci_0044                -1.875013e-02 3 1  ON 93
ci_0045                 7.596908e-03 3 1  ON 94
ci_0046                 7.149442e-03 3 1  ON 95
ci_0047                -1.843756e-03 3 1  ON 96
ci_0048                -2.045357e-03 3 1  ON 97
ci_0049                -5.455803e-03 3 1  ON 98
ci_0050                -5.929420e-03 3 1  ON 99
ci_0051                -3.330679e-03 3 1  ON 100
ci_0052                -3.482449e-03 3 1  ON 101
ci_0053                -4.813220e-03 3 1  ON 102
ci_0054                -4.409641e-03 3 1  ON 103
ci_0055                 6.145797e-03 3 1  ON 104
ci_0056                 6.238987e-03 3 1  ON 105
ci_0057                 4.936319e-03 3 1  ON 106
ci_0058                 4.952411e-03 3 1  ON 107
ci_0059                -4.886569e-03 3 1  ON 108
ci_0060                -4.684796e-03 3 1  ON 109
ci_0061                -4.456852e-03 3 1  ON 110
ci_0062                -3.447833e-03 3 1  ON 111
ci_0063                -8.586653e-03 3 1  ON 112
ci_0064                -8.180472e-03 3 1  ON 113
ci_0065                -5.430663e-03 3 1  ON 114
ci_0066                -4.856119e-03 3 1  ON 115
ci_0067                -4.793971e-03 3 1  ON 116
ci_0068                -4.908805e-03 3 1  ON 117
ci_0069                 4.550112e-03 3 1  ON 118
ci_0070                 4.005123e-03 3 1  ON 119
ci_0071                 1.451242e-04 3 1  ON 120
ci_0072                 2.626337e-05 3 1  ON 121
ci_0073                 4.330558e-03 3 1  ON 122
ci_0074                 4.280338e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 67
    time step          = 0.05
    reference energy   = -16.9242
    reference variance = 0.26196
====================================================
  Execution time = 2.0881e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s067
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3411e-01
  Total weights = 1.9518e+06
  Execution time = 1.9194e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322748804024
                                         uncertainty =       0.002342446239

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322748804024
                                         uncertainty =       0.002342446239

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401664500
  error estimate for blocks of size 2^( 2) =       0.000414444196
  error estimate for blocks of size 2^( 3) =       0.000427831743
  error estimate for blocks of size 2^( 4) =       0.000440132620
  error estimate for blocks of size 2^( 5) =       0.000450171794
  error estimate for blocks of size 2^( 6) =       0.000459545443
  error estimate for blocks of size 2^( 7) =       0.000461149811

      target function =                  N/A
              le_mean =     -16.906370538601
             les_mean =     286.162578152583
             stat err =       0.000452749917
             autocorr =       1.270544438285
              std dev =       0.568039383554
             le_variance =       0.322668741269

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323139743772
                                         uncertainty =       0.002362221139

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323139743772
                                         uncertainty =       0.002362221139

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401907412
  error estimate for blocks of size 2^( 2) =       0.000414680281
  error estimate for blocks of size 2^( 3) =       0.000428040193
  error estimate for blocks of size 2^( 4) =       0.000440355098
  error estimate for blocks of size 2^( 5) =       0.000450419459
  error estimate for blocks of size 2^( 6) =       0.000459787430
  error estimate for blocks of size 2^( 7) =       0.000461442433

      target function =                  N/A
              le_mean =     -16.906358720751
             les_mean =     286.160568817007
             stat err =       0.000453001105
             autocorr =       1.270417571658
              std dev =       0.568382912614
             le_variance =       0.323059135351

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323128649360
                                         uncertainty =       0.002360346456

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323128649360
                                         uncertainty =       0.002360346456

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401900661
  error estimate for blocks of size 2^( 2) =       0.000414672028
  error estimate for blocks of size 2^( 3) =       0.000428036716
  error estimate for blocks of size 2^( 4) =       0.000440354833
  error estimate for blocks of size 2^( 5) =       0.000450421912
  error estimate for blocks of size 2^( 6) =       0.000459791614
  error estimate for blocks of size 2^( 7) =       0.000461435095

      target function =                  N/A
              le_mean =     -16.906360969396
             les_mean =     286.170547529909
             stat err =       0.000453000864
             autocorr =       1.270458899814
              std dev =       0.568373365105
             le_variance =       0.323048282161

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322779651507
                                         uncertainty =       0.002344849620

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322779651507
                                         uncertainty =       0.002344849620

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401683683
  error estimate for blocks of size 2^( 2) =       0.000414462365
  error estimate for blocks of size 2^( 3) =       0.000427848172
  error estimate for blocks of size 2^( 4) =       0.000440154274
  error estimate for blocks of size 2^( 5) =       0.000450199243
  error estimate for blocks of size 2^( 6) =       0.000459574228
  error estimate for blocks of size 2^( 7) =       0.000461188497

      target function =                  N/A
              le_mean =     -16.906364551505
             les_mean =     286.163305616598
             stat err =       0.000452779060
             autocorr =       1.270586644659
              std dev =       0.568066512952
             le_variance =       0.322699563138


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906370538601        initial  <--
     1.3553e-01     1.3553e+00             1.4940e-03       -16.906358720751
     5.4210e-01     5.4210e+00             6.8543e-04       -16.906360969396
     2.1684e+00     2.1684e+01             2.1774e-04       -16.906364551505

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.5719
  </log>
  <optVariables href="H2O.s067.opt.xml">
   uu_0                 3.134906e-01 1 1  ON 0
   uu_1                 1.457597e-01 1 1  ON 1
   uu_2                 4.363426e-02 1 1  ON 2
   uu_3                -1.957212e-02 1 1  ON 3
   uu_4                -6.635376e-02 1 1  ON 4
   uu_5                -1.027292e-01 1 1  ON 5
   uu_6                -1.318290e-01 1 1  ON 6
   uu_7                -1.475205e-01 1 1  ON 7
   uu_8                -1.416328e-01 1 1  ON 8
   uu_9                -1.142732e-01 1 1  ON 9
   ud_0                 4.518684e-01 1 1  ON 10
   ud_1                 1.859397e-01 1 1  ON 11
   ud_2                 6.517325e-02 1 1  ON 12
   ud_3                -6.161605e-03 1 1  ON 13
   ud_4                -6.362244e-02 1 1  ON 14
   ud_5                -1.063615e-01 1 1  ON 15
   ud_6                -1.349611e-01 1 1  ON 16
   ud_7                -1.531788e-01 1 1  ON 17
   ud_8                -1.555374e-01 1 1  ON 18
   ud_9                -1.459936e-01 1 1  ON 19
   eO_0                -7.488892e-01 1 1  ON 20
   eO_1                -4.277073e-01 1 1  ON 21
   eO_2                -1.640853e-02 1 1  ON 22
   eO_3                 2.974343e-01 1 1  ON 23
   eO_4                 5.254046e-01 1 1  ON 24
   eO_5                 4.901121e-01 1 1  ON 25
   eO_6                 2.634505e-01 1 1  ON 26
   eO_7                -4.236340e-02 1 1  ON 27
   eO_8                -2.359360e-01 1 1  ON 28
   eO_9                -1.013425e-01 1 1  ON 29
  eH1_0                -2.652614e-01 1 1  ON 30
  eH1_1                -1.574249e-01 1 1  ON 31
  eH1_2                -1.073854e-01 1 1  ON 32
  eH1_3                -5.167197e-02 1 1  ON 33
  eH1_4                -1.376414e-03 1 1  ON 34
  eH1_5                 3.511220e-02 1 1  ON 35
  eH1_6                 9.816459e-02 1 1  ON 36
  eH1_7                 1.589929e-01 1 1  ON 37
  eH1_8                 1.960220e-01 1 1  ON 38
  eH1_9                 9.406603e-02 1 1  ON 39
  eH2_0                -2.638031e-01 1 1  ON 40
  eH2_1                -1.559156e-01 1 1  ON 41
  eH2_2                -1.055160e-01 1 1  ON 42
  eH2_3                -4.989111e-02 1 1  ON 43
  eH2_4                 9.762057e-04 1 1  ON 44
  eH2_5                 3.701188e-02 1 1  ON 45
  eH2_6                 9.964760e-02 1 1  ON 46
  eH2_7                 1.612509e-01 1 1  ON 47
  eH2_8                 2.001843e-01 1 1  ON 48
  eH2_9                 8.713868e-02 1 1  ON 49
ci_0001                 7.011070e-01 3 1  ON 50
ci_0002                 7.010534e-01 3 1  ON 51
ci_0003                -2.745995e-02 3 1  ON 52
ci_0004                -2.746330e-02 3 1  ON 53
ci_0005                -3.653946e-02 3 1  ON 54
ci_0006                -3.648744e-02 3 1  ON 55
ci_0007                -2.062881e-02 3 1  ON 56
ci_0008                -2.154994e-02 3 1  ON 57
ci_0009                -1.662845e-02 3 1  ON 58
ci_0010                -1.762758e-02 3 1  ON 59
ci_0011                -1.181984e-02 3 1  ON 60
ci_0012                -1.185434e-02 3 1  ON 61
ci_0013                 1.371795e-02 3 1  ON 62
ci_0014                 1.332132e-02 3 1  ON 63
ci_0015                 1.298529e-02 3 1  ON 64
ci_0016                 1.256522e-02 3 1  ON 65
ci_0017                 1.120440e-02 3 1  ON 66
ci_0018                 1.126474e-02 3 1  ON 67
ci_0019                 1.105329e-02 3 1  ON 68
ci_0020                 1.167110e-02 3 1  ON 69
ci_0021                -1.975965e-03 3 1  ON 70
ci_0022                -1.153651e-03 3 1  ON 71
ci_0023                -1.137892e-02 3 1  ON 72
ci_0024                -1.107821e-02 3 1  ON 73
ci_0025                -1.104159e-02 3 1  ON 74
ci_0026                -9.986402e-03 3 1  ON 75
ci_0027                -1.149273e-02 3 1  ON 76
ci_0028                -1.132139e-02 3 1  ON 77
ci_0029                -1.046182e-02 3 1  ON 78
ci_0030                -1.100786e-02 3 1  ON 79
ci_0031                 2.093891e-02 3 1  ON 80
ci_0032                 2.075212e-02 3 1  ON 81
ci_0033                 9.744114e-03 3 1  ON 82
ci_0034                 9.638197e-03 3 1  ON 83
ci_0035                 6.644153e-03 3 1  ON 84
ci_0036                 6.167637e-03 3 1  ON 85
ci_0037                -1.082780e-02 3 1  ON 86
ci_0038                -1.103358e-02 3 1  ON 87
ci_0039                -2.527268e-03 3 1  ON 88
ci_0040                -2.383339e-03 3 1  ON 89
ci_0041                 6.844373e-03 3 1  ON 90
ci_0042                 6.813530e-03 3 1  ON 91
ci_0043                -1.890776e-02 3 1  ON 92
ci_0044                -1.908196e-02 3 1  ON 93
ci_0045                 7.187673e-03 3 1  ON 94
ci_0046                 7.038322e-03 3 1  ON 95
ci_0047                -1.662314e-03 3 1  ON 96
ci_0048                -2.321547e-03 3 1  ON 97
ci_0049                -5.030081e-03 3 1  ON 98
ci_0050                -5.957633e-03 3 1  ON 99
ci_0051                -3.304382e-03 3 1  ON 100
ci_0052                -3.617021e-03 3 1  ON 101
ci_0053                -4.903180e-03 3 1  ON 102
ci_0054                -4.094800e-03 3 1  ON 103
ci_0055                 6.171830e-03 3 1  ON 104
ci_0056                 6.238918e-03 3 1  ON 105
ci_0057                 4.902517e-03 3 1  ON 106
ci_0058                 4.974907e-03 3 1  ON 107
ci_0059                -4.837024e-03 3 1  ON 108
ci_0060                -4.781483e-03 3 1  ON 109
ci_0061                -4.370337e-03 3 1  ON 110
ci_0062                -3.470647e-03 3 1  ON 111
ci_0063                -8.746380e-03 3 1  ON 112
ci_0064                -8.332597e-03 3 1  ON 113
ci_0065                -5.486211e-03 3 1  ON 114
ci_0066                -4.837513e-03 3 1  ON 115
ci_0067                -4.964502e-03 3 1  ON 116
ci_0068                -4.990017e-03 3 1  ON 117
ci_0069                 4.404173e-03 3 1  ON 118
ci_0070                 4.066402e-03 3 1  ON 119
ci_0071                 5.818693e-06 3 1  ON 120
ci_0072                -1.105542e-04 3 1  ON 121
ci_0073                 4.562281e-03 3 1  ON 122
ci_0074                 4.363647e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7724e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s068 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s068 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=68  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 68
    time step          = 0.05
    reference energy   = -16.8609
    reference variance = 0.532535
====================================================
  Execution time = 2.1372e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s068
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5236e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3713e-01
  Total weights = 1.951746679e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1168e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325755245459
                                         uncertainty =       0.002658104111

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325755245459
                                         uncertainty =       0.002658104111

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403544178
  error estimate for blocks of size 2^( 2) =       0.000416589319
  error estimate for blocks of size 2^( 3) =       0.000430172773
  error estimate for blocks of size 2^( 4) =       0.000443069678
  error estimate for blocks of size 2^( 5) =       0.000455286271
  error estimate for blocks of size 2^( 6) =       0.000464528201
  error estimate for blocks of size 2^( 7) =       0.000470117187

      target function =                  N/A
              le_mean =     -16.905266535959
             les_mean =     286.125163064409
             stat err =       0.000458250334
             autocorr =       1.289506122905
              std dev =       0.570697649493
             le_variance =       0.325695807137


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690526653596e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3553e+00, overlap shift 1.3553e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905266535955       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905269106438       residual = 9.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905269265278       residual = 3.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905269241153       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905268868450       residual = 9.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905268850408       residual = 4.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905268958597       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905269000946       residual = 4.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905268950440       residual = 2.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905268970895       residual = 5.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.3553e+00 is 1.883208e-04

solving harmonic davidson linear method for identity shift 5.4210e+00, overlap shift 5.4210e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905266535955       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905267258635       residual = 9.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905267294282       residual = 3.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905267275291       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905267162516       residual = 9.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905267151427       residual = 3.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905267179506       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905267191290       residual = 3.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905267176026       residual = 2.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905267178592       residual = 4.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.4210e+00 is 5.254539e-05

solving harmonic davidson linear method for identity shift 2.1684e+01, overlap shift 2.1684e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905266535955       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905266722433       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905266731016       residual = 3.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905266725207       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905266695585       residual = 9.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905266692074       residual = 3.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905266699108       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905266702305       residual = 2.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905266698337       residual = 1.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905266698671       residual = 3.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.1684e+01 is 1.353137e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.599213 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7497e+01
  </log>
  <optVariables href="H2O.s068.opt.xml">
   uu_0                 3.134948e-01 1 1  ON 0
   uu_1                 1.457730e-01 1 1  ON 1
   uu_2                 4.361495e-02 1 1  ON 2
   uu_3                -1.958861e-02 1 1  ON 3
   uu_4                -6.635873e-02 1 1  ON 4
   uu_5                -1.027448e-01 1 1  ON 5
   uu_6                -1.318618e-01 1 1  ON 6
   uu_7                -1.475503e-01 1 1  ON 7
   uu_8                -1.415977e-01 1 1  ON 8
   uu_9                -1.142424e-01 1 1  ON 9
   ud_0                 4.518432e-01 1 1  ON 10
   ud_1                 1.859092e-01 1 1  ON 11
   ud_2                 6.516833e-02 1 1  ON 12
   ud_3                -6.153839e-03 1 1  ON 13
   ud_4                -6.364898e-02 1 1  ON 14
   ud_5                -1.063471e-01 1 1  ON 15
   ud_6                -1.349766e-01 1 1  ON 16
   ud_7                -1.531729e-01 1 1  ON 17
   ud_8                -1.554931e-01 1 1  ON 18
   ud_9                -1.459677e-01 1 1  ON 19
   eO_0                -7.488766e-01 1 1  ON 20
   eO_1                -4.277069e-01 1 1  ON 21
   eO_2                -1.641378e-02 1 1  ON 22
   eO_3                 2.974384e-01 1 1  ON 23
   eO_4                 5.253943e-01 1 1  ON 24
   eO_5                 4.901328e-01 1 1  ON 25
   eO_6                 2.634421e-01 1 1  ON 26
   eO_7                -4.236270e-02 1 1  ON 27
   eO_8                -2.359321e-01 1 1  ON 28
   eO_9                -1.013572e-01 1 1  ON 29
  eH1_0                -2.652749e-01 1 1  ON 30
  eH1_1                -1.574322e-01 1 1  ON 31
  eH1_2                -1.074077e-01 1 1  ON 32
  eH1_3                -5.168628e-02 1 1  ON 33
  eH1_4                -1.382107e-03 1 1  ON 34
  eH1_5                 3.510605e-02 1 1  ON 35
  eH1_6                 9.815569e-02 1 1  ON 36
  eH1_7                 1.589980e-01 1 1  ON 37
  eH1_8                 1.960441e-01 1 1  ON 38
  eH1_9                 9.410446e-02 1 1  ON 39
  eH2_0                -2.638199e-01 1 1  ON 40
  eH2_1                -1.559276e-01 1 1  ON 41
  eH2_2                -1.055341e-01 1 1  ON 42
  eH2_3                -4.989638e-02 1 1  ON 43
  eH2_4                 9.576850e-04 1 1  ON 44
  eH2_5                 3.699257e-02 1 1  ON 45
  eH2_6                 9.966028e-02 1 1  ON 46
  eH2_7                 1.612647e-01 1 1  ON 47
  eH2_8                 2.002054e-01 1 1  ON 48
  eH2_9                 8.717575e-02 1 1  ON 49
ci_0001                 7.010984e-01 3 1  ON 50
ci_0002                 7.010570e-01 3 1  ON 51
ci_0003                -2.747187e-02 3 1  ON 52
ci_0004                -2.745526e-02 3 1  ON 53
ci_0005                -3.654522e-02 3 1  ON 54
ci_0006                -3.648859e-02 3 1  ON 55
ci_0007                -2.064847e-02 3 1  ON 56
ci_0008                -2.157256e-02 3 1  ON 57
ci_0009                -1.666812e-02 3 1  ON 58
ci_0010                -1.763204e-02 3 1  ON 59
ci_0011                -1.185560e-02 3 1  ON 60
ci_0012                -1.186938e-02 3 1  ON 61
ci_0013                 1.370694e-02 3 1  ON 62
ci_0014                 1.332211e-02 3 1  ON 63
ci_0015                 1.298845e-02 3 1  ON 64
ci_0016                 1.257307e-02 3 1  ON 65
ci_0017                 1.125116e-02 3 1  ON 66
ci_0018                 1.127316e-02 3 1  ON 67
ci_0019                 1.106002e-02 3 1  ON 68
ci_0020                 1.166687e-02 3 1  ON 69
ci_0021                -1.977343e-03 3 1  ON 70
ci_0022                -1.143150e-03 3 1  ON 71
ci_0023                -1.142216e-02 3 1  ON 72
ci_0024                -1.107518e-02 3 1  ON 73
ci_0025                -1.098905e-02 3 1  ON 74
ci_0026                -1.002436e-02 3 1  ON 75
ci_0027                -1.145612e-02 3 1  ON 76
ci_0028                -1.129912e-02 3 1  ON 77
ci_0029                -1.046496e-02 3 1  ON 78
ci_0030                -1.099135e-02 3 1  ON 79
ci_0031                 2.094530e-02 3 1  ON 80
ci_0032                 2.075800e-02 3 1  ON 81
ci_0033                 9.759907e-03 3 1  ON 82
ci_0034                 9.643047e-03 3 1  ON 83
ci_0035                 6.627919e-03 3 1  ON 84
ci_0036                 6.178157e-03 3 1  ON 85
ci_0037                -1.081008e-02 3 1  ON 86
ci_0038                -1.101400e-02 3 1  ON 87
ci_0039                -2.534494e-03 3 1  ON 88
ci_0040                -2.417948e-03 3 1  ON 89
ci_0041                 6.830406e-03 3 1  ON 90
ci_0042                 6.836255e-03 3 1  ON 91
ci_0043                -1.892038e-02 3 1  ON 92
ci_0044                -1.907546e-02 3 1  ON 93
ci_0045                 7.198336e-03 3 1  ON 94
ci_0046                 7.047289e-03 3 1  ON 95
ci_0047                -1.669142e-03 3 1  ON 96
ci_0048                -2.291443e-03 3 1  ON 97
ci_0049                -5.014423e-03 3 1  ON 98
ci_0050                -5.952119e-03 3 1  ON 99
ci_0051                -3.314321e-03 3 1  ON 100
ci_0052                -3.605728e-03 3 1  ON 101
ci_0053                -4.871937e-03 3 1  ON 102
ci_0054                -4.128156e-03 3 1  ON 103
ci_0055                 6.169463e-03 3 1  ON 104
ci_0056                 6.250929e-03 3 1  ON 105
ci_0057                 4.910109e-03 3 1  ON 106
ci_0058                 4.965425e-03 3 1  ON 107
ci_0059                -4.833040e-03 3 1  ON 108
ci_0060                -4.812655e-03 3 1  ON 109
ci_0061                -4.326502e-03 3 1  ON 110
ci_0062                -3.486537e-03 3 1  ON 111
ci_0063                -8.733379e-03 3 1  ON 112
ci_0064                -8.340238e-03 3 1  ON 113
ci_0065                -5.522490e-03 3 1  ON 114
ci_0066                -4.859266e-03 3 1  ON 115
ci_0067                -4.949334e-03 3 1  ON 116
ci_0068                -5.005938e-03 3 1  ON 117
ci_0069                 4.427216e-03 3 1  ON 118
ci_0070                 4.099350e-03 3 1  ON 119
ci_0071                 1.939401e-05 3 1  ON 120
ci_0072                -8.556618e-05 3 1  ON 121
ci_0073                 4.594245e-03 3 1  ON 122
ci_0074                 4.354176e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 68
    time step          = 0.05
    reference energy   = -16.889
    reference variance = 0.292306
====================================================
  Execution time = 2.1059e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s068
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4454e-01
  Total weights = 1.9517e+06
  Execution time = 1.9176e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330494519394
                                         uncertainty =       0.002896818280

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330494519394
                                         uncertainty =       0.002896818280

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406512452
  error estimate for blocks of size 2^( 2) =       0.000419362619
  error estimate for blocks of size 2^( 3) =       0.000432956851
  error estimate for blocks of size 2^( 4) =       0.000445185911
  error estimate for blocks of size 2^( 5) =       0.000456547848
  error estimate for blocks of size 2^( 6) =       0.000464724744
  error estimate for blocks of size 2^( 7) =       0.000470500461

      target function =                  N/A
              le_mean =     -16.906004615505
             les_mean =     286.158124876997
             stat err =       0.000459239741
             autocorr =       1.276236673883
              std dev =       0.574895423143
             le_variance =       0.330504747551

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330512101054
                                         uncertainty =       0.002901376808

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330512101054
                                         uncertainty =       0.002901376808

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406523072
  error estimate for blocks of size 2^( 2) =       0.000419369893
  error estimate for blocks of size 2^( 3) =       0.000432960050
  error estimate for blocks of size 2^( 4) =       0.000445186910
  error estimate for blocks of size 2^( 5) =       0.000456550263
  error estimate for blocks of size 2^( 6) =       0.000464723328
  error estimate for blocks of size 2^( 7) =       0.000470489266

      target function =                  N/A
              le_mean =     -16.906007000626
             les_mean =     286.157595610576
             stat err =       0.000459237442
             autocorr =       1.276157216364
              std dev =       0.574910441883
             le_variance =       0.330522016186

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330508794470
                                         uncertainty =       0.002899298291

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330508794470
                                         uncertainty =       0.002899298291

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406521124
  error estimate for blocks of size 2^( 2) =       0.000419369159
  error estimate for blocks of size 2^( 3) =       0.000432960915
  error estimate for blocks of size 2^( 4) =       0.000445188564
  error estimate for blocks of size 2^( 5) =       0.000456550914
  error estimate for blocks of size 2^( 6) =       0.000464725836
  error estimate for blocks of size 2^( 7) =       0.000470495864

      target function =                  N/A
              le_mean =     -16.906005750802
             les_mean =     286.157493286993
             stat err =       0.000459240294
             autocorr =       1.276185300517
              std dev =       0.574907686947
             le_variance =       0.330518848510

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330496350085
                                         uncertainty =       0.002897127999

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330496350085
                                         uncertainty =       0.002897127999

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406513564
  error estimate for blocks of size 2^( 2) =       0.000419363451
  error estimate for blocks of size 2^( 3) =       0.000432957348
  error estimate for blocks of size 2^( 4) =       0.000445186219
  error estimate for blocks of size 2^( 5) =       0.000456548149
  error estimate for blocks of size 2^( 6) =       0.000464724849
  error estimate for blocks of size 2^( 7) =       0.000470499842

      target function =                  N/A
              le_mean =     -16.906004754004
             les_mean =     286.157718433202
             stat err =       0.000459239765
             autocorr =       1.276229821884
              std dev =       0.574896995949
             le_variance =       0.330506555951


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906004615505        initial
     1.3553e+00     1.3553e+01             1.8832e-04       -16.906007000626  <--
     5.4210e+00     5.4210e+01             5.2545e-05       -16.906005750802
     2.1684e+01     2.1684e+02             1.3531e-05       -16.906004754004

*****************************************************************************
Applying the update for shift_i =   1.3553e+00     and shift_s =   1.3553e+01
*****************************************************************************

  Execution time = 3.0738e+01
  </log>
  <optVariables href="H2O.s068.opt.xml">
   uu_0                 3.135062e-01 1 1  ON 0
   uu_1                 1.457964e-01 1 1  ON 1
   uu_2                 4.356939e-02 1 1  ON 2
   uu_3                -1.963400e-02 1 1  ON 3
   uu_4                -6.637692e-02 1 1  ON 4
   uu_5                -1.027883e-01 1 1  ON 5
   uu_6                -1.319525e-01 1 1  ON 6
   uu_7                -1.476383e-01 1 1  ON 7
   uu_8                -1.414981e-01 1 1  ON 8
   uu_9                -1.141515e-01 1 1  ON 9
   ud_0                 4.517653e-01 1 1  ON 10
   ud_1                 1.858320e-01 1 1  ON 11
   ud_2                 6.515098e-02 1 1  ON 12
   ud_3                -6.141477e-03 1 1  ON 13
   ud_4                -6.371252e-02 1 1  ON 14
   ud_5                -1.063188e-01 1 1  ON 15
   ud_6                -1.350121e-01 1 1  ON 16
   ud_7                -1.531584e-01 1 1  ON 17
   ud_8                -1.553672e-01 1 1  ON 18
   ud_9                -1.458912e-01 1 1  ON 19
   eO_0                -7.488405e-01 1 1  ON 20
   eO_1                -4.277057e-01 1 1  ON 21
   eO_2                -1.642779e-02 1 1  ON 22
   eO_3                 2.974486e-01 1 1  ON 23
   eO_4                 5.253657e-01 1 1  ON 24
   eO_5                 4.901935e-01 1 1  ON 25
   eO_6                 2.634183e-01 1 1  ON 26
   eO_7                -4.236180e-02 1 1  ON 27
   eO_8                -2.359208e-01 1 1  ON 28
   eO_9                -1.014003e-01 1 1  ON 29
  eH1_0                -2.653142e-01 1 1  ON 30
  eH1_1                -1.574567e-01 1 1  ON 31
  eH1_2                -1.074694e-01 1 1  ON 32
  eH1_3                -5.172750e-02 1 1  ON 33
  eH1_4                -1.401402e-03 1 1  ON 34
  eH1_5                 3.508794e-02 1 1  ON 35
  eH1_6                 9.812930e-02 1 1  ON 36
  eH1_7                 1.590131e-01 1 1  ON 37
  eH1_8                 1.961095e-01 1 1  ON 38
  eH1_9                 9.421799e-02 1 1  ON 39
  eH2_0                -2.638688e-01 1 1  ON 40
  eH2_1                -1.559632e-01 1 1  ON 41
  eH2_2                -1.055860e-01 1 1  ON 42
  eH2_3                -4.991520e-02 1 1  ON 43
  eH2_4                 9.052855e-04 1 1  ON 44
  eH2_5                 3.693547e-02 1 1  ON 45
  eH2_6                 9.969660e-02 1 1  ON 46
  eH2_7                 1.613059e-01 1 1  ON 47
  eH2_8                 2.002677e-01 1 1  ON 48
  eH2_9                 8.728529e-02 1 1  ON 49
ci_0001                 7.010732e-01 3 1  ON 50
ci_0002                 7.010691e-01 3 1  ON 51
ci_0003                -2.750274e-02 3 1  ON 52
ci_0004                -2.743423e-02 3 1  ON 53
ci_0005                -3.655972e-02 3 1  ON 54
ci_0006                -3.649262e-02 3 1  ON 55
ci_0007                -2.070335e-02 3 1  ON 56
ci_0008                -2.163718e-02 3 1  ON 57
ci_0009                -1.676829e-02 3 1  ON 58
ci_0010                -1.764379e-02 3 1  ON 59
ci_0011                -1.194714e-02 3 1  ON 60
ci_0012                -1.190864e-02 3 1  ON 61
ci_0013                 1.367731e-02 3 1  ON 62
ci_0014                 1.332457e-02 3 1  ON 63
ci_0015                 1.299593e-02 3 1  ON 64
ci_0016                 1.259351e-02 3 1  ON 65
ci_0017                 1.136874e-02 3 1  ON 66
ci_0018                 1.129417e-02 3 1  ON 67
ci_0019                 1.107686e-02 3 1  ON 68
ci_0020                 1.165599e-02 3 1  ON 69
ci_0021                -1.981678e-03 3 1  ON 70
ci_0022                -1.114538e-03 3 1  ON 71
ci_0023                -1.153165e-02 3 1  ON 72
ci_0024                -1.106753e-02 3 1  ON 73
ci_0025                -1.085327e-02 3 1  ON 74
ci_0026                -1.012248e-02 3 1  ON 75
ci_0027                -1.136040e-02 3 1  ON 76
ci_0028                -1.124141e-02 3 1  ON 77
ci_0029                -1.047154e-02 3 1  ON 78
ci_0030                -1.094847e-02 3 1  ON 79
ci_0031                 2.096237e-02 3 1  ON 80
ci_0032                 2.077469e-02 3 1  ON 81
ci_0033                 9.804325e-03 3 1  ON 82
ci_0034                 9.656582e-03 3 1  ON 83
ci_0035                 6.585177e-03 3 1  ON 84
ci_0036                 6.205312e-03 3 1  ON 85
ci_0037                -1.076282e-02 3 1  ON 86
ci_0038                -1.096190e-02 3 1  ON 87
ci_0039                -2.551999e-03 3 1  ON 88
ci_0040                -2.500707e-03 3 1  ON 89
ci_0041                 6.793733e-03 3 1  ON 90
ci_0042                 6.894706e-03 3 1  ON 91
ci_0043                -1.895504e-02 3 1  ON 92
ci_0044                -1.905735e-02 3 1  ON 93
ci_0045                 7.226896e-03 3 1  ON 94
ci_0046                 7.071398e-03 3 1  ON 95
ci_0047                -1.685653e-03 3 1  ON 96
ci_0048                -2.219159e-03 3 1  ON 97
ci_0049                -4.973698e-03 3 1  ON 98
ci_0050                -5.937924e-03 3 1  ON 99
ci_0051                -3.338757e-03 3 1  ON 100
ci_0052                -3.579299e-03 3 1  ON 101
ci_0053                -4.795489e-03 3 1  ON 102
ci_0054                -4.210236e-03 3 1  ON 103
ci_0055                 6.163407e-03 3 1  ON 104
ci_0056                 6.283512e-03 3 1  ON 105
ci_0057                 4.930366e-03 3 1  ON 106
ci_0058                 4.940508e-03 3 1  ON 107
ci_0059                -4.822336e-03 3 1  ON 108
ci_0060                -4.889674e-03 3 1  ON 109
ci_0061                -4.211635e-03 3 1  ON 110
ci_0062                -3.528523e-03 3 1  ON 111
ci_0063                -8.701062e-03 3 1  ON 112
ci_0064                -8.360487e-03 3 1  ON 113
ci_0065                -5.615390e-03 3 1  ON 114
ci_0066                -4.914629e-03 3 1  ON 115
ci_0067                -4.912648e-03 3 1  ON 116
ci_0068                -5.043950e-03 3 1  ON 117
ci_0069                 4.483102e-03 3 1  ON 118
ci_0070                 4.178667e-03 3 1  ON 119
ci_0071                 5.349360e-05 3 1  ON 120
ci_0072                -1.959242e-05 3 1  ON 121
ci_0073                 4.671433e-03 3 1  ON 122
ci_0074                 4.331325e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8242e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s069 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s069 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=69  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 69
    time step          = 0.05
    reference energy   = -16.9395
    reference variance = 0.287676
====================================================
  Execution time = 2.1048e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s069
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5261e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3645e-01
  Total weights = 1.952058565e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1796e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322704542463
                                         uncertainty =       0.001798025091

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322704542463
                                         uncertainty =       0.001798025091

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401677100
  error estimate for blocks of size 2^( 2) =       0.000414627029
  error estimate for blocks of size 2^( 3) =       0.000428695521
  error estimate for blocks of size 2^( 4) =       0.000441458392
  error estimate for blocks of size 2^( 5) =       0.000451630481
  error estimate for blocks of size 2^( 6) =       0.000458709027
  error estimate for blocks of size 2^( 7) =       0.000465123025

      target function =                  N/A
              le_mean =     -16.906118060666
             les_mean =     286.153282472093
             stat err =       0.000454230231
             autocorr =       1.278786151011
              std dev =       0.568057203127
             le_variance =       0.322688986025


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690611806067e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.3881e-01, overlap shift 3.3881e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906118060650       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906112302013       residual = 2.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906111364938       residual = 4.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906112019175       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906112716688       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906112860443       residual = 6.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906113166172       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906113539408       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906113870696       residual = 7.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906113914781       residual = 3.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906113931991       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906113805260       residual = 4.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.3881e-01 is 7.764771e-04

solving harmonic davidson linear method for identity shift 1.3553e+00, overlap shift 1.3553e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906118060650       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906116046131       residual = 2.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906115652738       residual = 3.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906115819181       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906116072232       residual = 9.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906115901403       residual = 4.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906116031601       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906116195193       residual = 6.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906116278148       residual = 3.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906116288051       residual = 8.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.3553e+00 is 2.826431e-04

solving harmonic davidson linear method for identity shift 5.4210e+00, overlap shift 5.4210e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906118060650       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906117501169       residual = 2.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906117383851       residual = 3.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906117427892       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906117501856       residual = 9.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906117439600       residual = 3.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906117463991       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906117502822       residual = 5.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906117540494       residual = 2.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906117537590       residual = 5.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.4210e+00 is 7.971514e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.603641 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7236e+01
  </log>
  <optVariables href="H2O.s069.opt.xml">
   uu_0                 3.134933e-01 1 1  ON 0
   uu_1                 1.458002e-01 1 1  ON 1
   uu_2                 4.351407e-02 1 1  ON 2
   uu_3                -1.961705e-02 1 1  ON 3
   uu_4                -6.639707e-02 1 1  ON 4
   uu_5                -1.027807e-01 1 1  ON 5
   uu_6                -1.320594e-01 1 1  ON 6
   uu_7                -1.477467e-01 1 1  ON 7
   uu_8                -1.414398e-01 1 1  ON 8
   uu_9                -1.141131e-01 1 1  ON 9
   ud_0                 4.517216e-01 1 1  ON 10
   ud_1                 1.857661e-01 1 1  ON 11
   ud_2                 6.516898e-02 1 1  ON 12
   ud_3                -6.142968e-03 1 1  ON 13
   ud_4                -6.373202e-02 1 1  ON 14
   ud_5                -1.062822e-01 1 1  ON 15
   ud_6                -1.350357e-01 1 1  ON 16
   ud_7                -1.531221e-01 1 1  ON 17
   ud_8                -1.552976e-01 1 1  ON 18
   ud_9                -1.458819e-01 1 1  ON 19
   eO_0                -7.488530e-01 1 1  ON 20
   eO_1                -4.276476e-01 1 1  ON 21
   eO_2                -1.641503e-02 1 1  ON 22
   eO_3                 2.974397e-01 1 1  ON 23
   eO_4                 5.254208e-01 1 1  ON 24
   eO_5                 4.901692e-01 1 1  ON 25
   eO_6                 2.634386e-01 1 1  ON 26
   eO_7                -4.230864e-02 1 1  ON 27
   eO_8                -2.359773e-01 1 1  ON 28
   eO_9                -1.014881e-01 1 1  ON 29
  eH1_0                -2.653636e-01 1 1  ON 30
  eH1_1                -1.575066e-01 1 1  ON 31
  eH1_2                -1.076014e-01 1 1  ON 32
  eH1_3                -5.182680e-02 1 1  ON 33
  eH1_4                -1.361727e-03 1 1  ON 34
  eH1_5                 3.507918e-02 1 1  ON 35
  eH1_6                 9.805202e-02 1 1  ON 36
  eH1_7                 1.590664e-01 1 1  ON 37
  eH1_8                 1.962476e-01 1 1  ON 38
  eH1_9                 9.437235e-02 1 1  ON 39
  eH2_0                -2.638143e-01 1 1  ON 40
  eH2_1                -1.559687e-01 1 1  ON 41
  eH2_2                -1.057314e-01 1 1  ON 42
  eH2_3                -4.998841e-02 1 1  ON 43
  eH2_4                 7.586326e-04 1 1  ON 44
  eH2_5                 3.703297e-02 1 1  ON 45
  eH2_6                 9.970650e-02 1 1  ON 46
  eH2_7                 1.612834e-01 1 1  ON 47
  eH2_8                 2.003295e-01 1 1  ON 48
  eH2_9                 8.743663e-02 1 1  ON 49
ci_0001                 7.010734e-01 3 1  ON 50
ci_0002                 7.010723e-01 3 1  ON 51
ci_0003                -2.755060e-02 3 1  ON 52
ci_0004                -2.748355e-02 3 1  ON 53
ci_0005                -3.641823e-02 3 1  ON 54
ci_0006                -3.637301e-02 3 1  ON 55
ci_0007                -2.066295e-02 3 1  ON 56
ci_0008                -2.171813e-02 3 1  ON 57
ci_0009                -1.687036e-02 3 1  ON 58
ci_0010                -1.736115e-02 3 1  ON 59
ci_0011                -1.197827e-02 3 1  ON 60
ci_0012                -1.191263e-02 3 1  ON 61
ci_0013                 1.362832e-02 3 1  ON 62
ci_0014                 1.333555e-02 3 1  ON 63
ci_0015                 1.317278e-02 3 1  ON 64
ci_0016                 1.258700e-02 3 1  ON 65
ci_0017                 1.148718e-02 3 1  ON 66
ci_0018                 1.123057e-02 3 1  ON 67
ci_0019                 1.115113e-02 3 1  ON 68
ci_0020                 1.164423e-02 3 1  ON 69
ci_0021                -2.032644e-03 3 1  ON 70
ci_0022                -1.100955e-03 3 1  ON 71
ci_0023                -1.136473e-02 3 1  ON 72
ci_0024                -1.114153e-02 3 1  ON 73
ci_0025                -1.083705e-02 3 1  ON 74
ci_0026                -1.031110e-02 3 1  ON 75
ci_0027                -1.128056e-02 3 1  ON 76
ci_0028                -1.123594e-02 3 1  ON 77
ci_0029                -1.021193e-02 3 1  ON 78
ci_0030                -1.087431e-02 3 1  ON 79
ci_0031                 2.103184e-02 3 1  ON 80
ci_0032                 2.073935e-02 3 1  ON 81
ci_0033                 9.890098e-03 3 1  ON 82
ci_0034                 9.740101e-03 3 1  ON 83
ci_0035                 6.739616e-03 3 1  ON 84
ci_0036                 6.288058e-03 3 1  ON 85
ci_0037                -1.073073e-02 3 1  ON 86
ci_0038                -1.094835e-02 3 1  ON 87
ci_0039                -2.480729e-03 3 1  ON 88
ci_0040                -2.507703e-03 3 1  ON 89
ci_0041                 6.949965e-03 3 1  ON 90
ci_0042                 6.854640e-03 3 1  ON 91
ci_0043                -1.897604e-02 3 1  ON 92
ci_0044                -1.908092e-02 3 1  ON 93
ci_0045                 7.257097e-03 3 1  ON 94
ci_0046                 7.062593e-03 3 1  ON 95
ci_0047                -1.734343e-03 3 1  ON 96
ci_0048                -2.182070e-03 3 1  ON 97
ci_0049                -5.081779e-03 3 1  ON 98
ci_0050                -6.012185e-03 3 1  ON 99
ci_0051                -3.251813e-03 3 1  ON 100
ci_0052                -3.628201e-03 3 1  ON 101
ci_0053                -4.788688e-03 3 1  ON 102
ci_0054                -4.285528e-03 3 1  ON 103
ci_0055                 6.099339e-03 3 1  ON 104
ci_0056                 6.276096e-03 3 1  ON 105
ci_0057                 4.976369e-03 3 1  ON 106
ci_0058                 4.999407e-03 3 1  ON 107
ci_0059                -4.775221e-03 3 1  ON 108
ci_0060                -5.014317e-03 3 1  ON 109
ci_0061                -4.209161e-03 3 1  ON 110
ci_0062                -3.434753e-03 3 1  ON 111
ci_0063                -8.654501e-03 3 1  ON 112
ci_0064                -8.469469e-03 3 1  ON 113
ci_0065                -5.570560e-03 3 1  ON 114
ci_0066                -4.915463e-03 3 1  ON 115
ci_0067                -4.979293e-03 3 1  ON 116
ci_0068                -5.065181e-03 3 1  ON 117
ci_0069                 4.589096e-03 3 1  ON 118
ci_0070                 4.144968e-03 3 1  ON 119
ci_0071                 9.792792e-05 3 1  ON 120
ci_0072                 2.004406e-04 3 1  ON 121
ci_0073                 4.639231e-03 3 1  ON 122
ci_0074                 4.338761e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 69
    time step          = 0.05
    reference energy   = -16.9709
    reference variance = 0.404773
====================================================
  Execution time = 2.0911e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s069
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3508e-01
  Total weights = 1.9520e+06
  Execution time = 1.9264e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322849363646
                                         uncertainty =       0.001933718638

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322849363646
                                         uncertainty =       0.001933718638

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401824806
  error estimate for blocks of size 2^( 2) =       0.000414431909
  error estimate for blocks of size 2^( 3) =       0.000427363163
  error estimate for blocks of size 2^( 4) =       0.000439267449
  error estimate for blocks of size 2^( 5) =       0.000450154043
  error estimate for blocks of size 2^( 6) =       0.000458021544
  error estimate for blocks of size 2^( 7) =       0.000462502381

      target function =                  N/A
              le_mean =     -16.906978077329
             les_mean =     286.182664669054
             stat err =       0.000452486354
             autocorr =       1.268053234206
              std dev =       0.568266090206
             le_variance =       0.322926349278

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323085317199
                                         uncertainty =       0.001928395037

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323085317199
                                         uncertainty =       0.001928395037

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401970896
  error estimate for blocks of size 2^( 2) =       0.000414572522
  error estimate for blocks of size 2^( 3) =       0.000427499025
  error estimate for blocks of size 2^( 4) =       0.000439395506
  error estimate for blocks of size 2^( 5) =       0.000450292714
  error estimate for blocks of size 2^( 6) =       0.000458194264
  error estimate for blocks of size 2^( 7) =       0.000462727749

      target function =                  N/A
              le_mean =     -16.906984642112
             les_mean =     286.181705563037
             stat err =       0.000452652558
             autocorr =       1.268062733004
              std dev =       0.568472692506
             le_variance =       0.323161202125

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323012536851
                                         uncertainty =       0.001929997894

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323012536851
                                         uncertainty =       0.001929997894

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401925727
  error estimate for blocks of size 2^( 2) =       0.000414528786
  error estimate for blocks of size 2^( 3) =       0.000427457491
  error estimate for blocks of size 2^( 4) =       0.000439357057
  error estimate for blocks of size 2^( 5) =       0.000450253475
  error estimate for blocks of size 2^( 6) =       0.000458148175
  error estimate for blocks of size 2^( 7) =       0.000462666764

      target function =                  N/A
              le_mean =     -16.906980674649
             les_mean =     286.181927233318
             stat err =       0.000452606368
             autocorr =       1.268088916680
              std dev =       0.568408814626
             le_variance =       0.323088580545

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322868537508
                                         uncertainty =       0.001933172317

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322868537508
                                         uncertainty =       0.001933172317

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401836639
  error estimate for blocks of size 2^( 2) =       0.000414442680
  error estimate for blocks of size 2^( 3) =       0.000427373264
  error estimate for blocks of size 2^( 4) =       0.000439277200
  error estimate for blocks of size 2^( 5) =       0.000450166682
  error estimate for blocks of size 2^( 6) =       0.000458042597
  error estimate for blocks of size 2^( 7) =       0.000462530263

      target function =                  N/A
              le_mean =     -16.906977897527
             les_mean =     286.181455343922
             stat err =       0.000452504185
             autocorr =       1.268078491756
              std dev =       0.568282824281
             le_variance =       0.322945368373


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906978077329        initial
     3.3881e-01     3.3881e+00             7.7648e-04       -16.906984642112  <--
     1.3553e+00     1.3553e+01             2.8264e-04       -16.906980674649
     5.4210e+00     5.4210e+01             7.9715e-05       -16.906977897527

*****************************************************************************
Applying the update for shift_i =   3.3881e-01     and shift_s =   3.3881e+00
*****************************************************************************

  Execution time = 3.0624e+01
  </log>
  <optVariables href="H2O.s069.opt.xml">
   uu_0                 3.134626e-01 1 1  ON 0
   uu_1                 1.457726e-01 1 1  ON 1
   uu_2                 4.342170e-02 1 1  ON 2
   uu_3                -1.962513e-02 1 1  ON 3
   uu_4                -6.642992e-02 1 1  ON 4
   uu_5                -1.028354e-01 1 1  ON 5
   uu_6                -1.322823e-01 1 1  ON 6
   uu_7                -1.480545e-01 1 1  ON 7
   uu_8                -1.413238e-01 1 1  ON 8
   uu_9                -1.140088e-01 1 1  ON 9
   ud_0                 4.516139e-01 1 1  ON 10
   ud_1                 1.856669e-01 1 1  ON 11
   ud_2                 6.516515e-02 1 1  ON 12
   ud_3                -6.153299e-03 1 1  ON 13
   ud_4                -6.374908e-02 1 1  ON 14
   ud_5                -1.062438e-01 1 1  ON 15
   ud_6                -1.350465e-01 1 1  ON 16
   ud_7                -1.530572e-01 1 1  ON 17
   ud_8                -1.551292e-01 1 1  ON 18
   ud_9                -1.458569e-01 1 1  ON 19
   eO_0                -7.488123e-01 1 1  ON 20
   eO_1                -4.275638e-01 1 1  ON 21
   eO_2                -1.635022e-02 1 1  ON 22
   eO_3                 2.974321e-01 1 1  ON 23
   eO_4                 5.255510e-01 1 1  ON 24
   eO_5                 4.901295e-01 1 1  ON 25
   eO_6                 2.635097e-01 1 1  ON 26
   eO_7                -4.216578e-02 1 1  ON 27
   eO_8                -2.361601e-01 1 1  ON 28
   eO_9                -1.017622e-01 1 1  ON 29
  eH1_0                -2.655187e-01 1 1  ON 30
  eH1_1                -1.576901e-01 1 1  ON 31
  eH1_2                -1.079405e-01 1 1  ON 32
  eH1_3                -5.209802e-02 1 1  ON 33
  eH1_4                -1.324906e-03 1 1  ON 34
  eH1_5                 3.506122e-02 1 1  ON 35
  eH1_6                 9.783939e-02 1 1  ON 36
  eH1_7                 1.592201e-01 1 1  ON 37
  eH1_8                 1.966597e-01 1 1  ON 38
  eH1_9                 9.485106e-02 1 1  ON 39
  eH2_0                -2.637120e-01 1 1  ON 40
  eH2_1                -1.560643e-01 1 1  ON 41
  eH2_2                -1.060639e-01 1 1  ON 42
  eH2_3                -5.022110e-02 1 1  ON 43
  eH2_4                 4.267783e-04 1 1  ON 44
  eH2_5                 3.722744e-02 1 1  ON 45
  eH2_6                 9.973751e-02 1 1  ON 46
  eH2_7                 1.612321e-01 1 1  ON 47
  eH2_8                 2.005193e-01 1 1  ON 48
  eH2_9                 8.790639e-02 1 1  ON 49
ci_0001                 7.010812e-01 3 1  ON 50
ci_0002                 7.010727e-01 3 1  ON 51
ci_0003                -2.764615e-02 3 1  ON 52
ci_0004                -2.757738e-02 3 1  ON 53
ci_0005                -3.609931e-02 3 1  ON 54
ci_0006                -3.611279e-02 3 1  ON 55
ci_0007                -2.056434e-02 3 1  ON 56
ci_0008                -2.191145e-02 3 1  ON 57
ci_0009                -1.705702e-02 3 1  ON 58
ci_0010                -1.686731e-02 3 1  ON 59
ci_0011                -1.204074e-02 3 1  ON 60
ci_0012                -1.191601e-02 3 1  ON 61
ci_0013                 1.354937e-02 3 1  ON 62
ci_0014                 1.335700e-02 3 1  ON 63
ci_0015                 1.350796e-02 3 1  ON 64
ci_0016                 1.257710e-02 3 1  ON 65
ci_0017                 1.170399e-02 3 1  ON 66
ci_0018                 1.112236e-02 3 1  ON 67
ci_0019                 1.128596e-02 3 1  ON 68
ci_0020                 1.162226e-02 3 1  ON 69
ci_0021                -2.166965e-03 3 1  ON 70
ci_0022                -1.070510e-03 3 1  ON 71
ci_0023                -1.106242e-02 3 1  ON 72
ci_0024                -1.127627e-02 3 1  ON 73
ci_0025                -1.080440e-02 3 1  ON 74
ci_0026                -1.065714e-02 3 1  ON 75
ci_0027                -1.112620e-02 3 1  ON 76
ci_0028                -1.123073e-02 3 1  ON 77
ci_0029                -9.713773e-03 3 1  ON 78
ci_0030                -1.073778e-02 3 1  ON 79
ci_0031                 2.118996e-02 3 1  ON 80
ci_0032                 2.065166e-02 3 1  ON 81
ci_0033                 1.007806e-02 3 1  ON 82
ci_0034                 9.923813e-03 3 1  ON 83
ci_0035                 7.036146e-03 3 1  ON 84
ci_0036                 6.447753e-03 3 1  ON 85
ci_0037                -1.066287e-02 3 1  ON 86
ci_0038                -1.091803e-02 3 1  ON 87
ci_0039                -2.378590e-03 3 1  ON 88
ci_0040                -2.517086e-03 3 1  ON 89
ci_0041                 7.242849e-03 3 1  ON 90
ci_0042                 6.780952e-03 3 1  ON 91
ci_0043                -1.902329e-02 3 1  ON 92
ci_0044                -1.913837e-02 3 1  ON 93
ci_0045                 7.319061e-03 3 1  ON 94
ci_0046                 7.042297e-03 3 1  ON 95
ci_0047                -1.806304e-03 3 1  ON 96
ci_0048                -2.128854e-03 3 1  ON 97
ci_0049                -5.279837e-03 3 1  ON 98
ci_0050                -6.147384e-03 3 1  ON 99
ci_0051                -3.117612e-03 3 1  ON 100
ci_0052                -3.700308e-03 3 1  ON 101
ci_0053                -4.772509e-03 3 1  ON 102
ci_0054                -4.414102e-03 3 1  ON 103
ci_0055                 5.966832e-03 3 1  ON 104
ci_0056                 6.258229e-03 3 1  ON 105
ci_0057                 5.061930e-03 3 1  ON 106
ci_0058                 5.110589e-03 3 1  ON 107
ci_0059                -4.703875e-03 3 1  ON 108
ci_0060                -5.213277e-03 3 1  ON 109
ci_0061                -4.197908e-03 3 1  ON 110
ci_0062                -3.247929e-03 3 1  ON 111
ci_0063                -8.577220e-03 3 1  ON 112
ci_0064                -8.650503e-03 3 1  ON 113
ci_0065                -5.496502e-03 3 1  ON 114
ci_0066                -4.916807e-03 3 1  ON 115
ci_0067                -5.080608e-03 3 1  ON 116
ci_0068                -5.103295e-03 3 1  ON 117
ci_0069                 4.751552e-03 3 1  ON 118
ci_0070                 4.095537e-03 3 1  ON 119
ci_0071                 1.905896e-04 3 1  ON 120
ci_0072                 6.169946e-04 3 1  ON 121
ci_0073                 4.591396e-03 3 1  ON 122
ci_0074                 4.350277e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7866e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s070 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s070 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=70  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 70
    time step          = 0.05
    reference energy   = -17.0055
    reference variance = 0.430327
====================================================
  Execution time = 2.1233e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s070
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5247e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3992e-01
  Total weights = 1.951789306e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1159e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324439458259
                                         uncertainty =       0.003066951560

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324439458259
                                         uncertainty =       0.003066951560

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402831767
  error estimate for blocks of size 2^( 2) =       0.000415721007
  error estimate for blocks of size 2^( 3) =       0.000429337724
  error estimate for blocks of size 2^( 4) =       0.000441627719
  error estimate for blocks of size 2^( 5) =       0.000452031224
  error estimate for blocks of size 2^( 6) =       0.000459681593
  error estimate for blocks of size 2^( 7) =       0.000463289027

      target function =                  N/A
              le_mean =     -16.905932204011
             les_mean =     286.150461955114
             stat err =       0.000454157391
             autocorr =       1.271057942591
              std dev =       0.569690148544
             le_variance =       0.324546865348


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690593220401e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.4703e-02, overlap shift 8.4703e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905932204006       residual = 2.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905968397402       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905971194618       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905969417591       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905970908225       residual = 7.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905969378430       residual = 4.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905971912320       residual = 5.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905971752257       residual = 4.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905972543770       residual = 3.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905972378335       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905972789280       residual = 5.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905973560500       residual = 4.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905973310804       residual = 2.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905973329503       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.905972888533       residual = 5.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         14 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 8.4703e-02 is 2.684615e-03

solving harmonic davidson linear method for identity shift 3.3881e-01, overlap shift 3.3881e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905932204006       residual = 2.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905952741353       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905953743395       residual = 5.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905953085903       residual = 6.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905954102526       residual = 5.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905953826218       residual = 3.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905954496696       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905954310637       residual = 9.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905954070686       residual = 5.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905954365161       residual = 1.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905954388550       residual = 4.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.3881e-01 is 7.057298e-04

solving harmonic davidson linear method for identity shift 1.3553e+00, overlap shift 1.3553e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905932204006       residual = 2.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905939726090       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905940046684       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905939896526       residual = 5.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905940293931       residual = 5.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905940365635       residual = 2.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905940314100       residual = 9.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905940353737       residual = 3.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905940254594       residual = 1.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905940309270       residual = 5.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.3553e+00 is 2.320676e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.609313 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7359e+01
  </log>
  <optVariables href="H2O.s070.opt.xml">
   uu_0                 3.134045e-01 1 1  ON 0
   uu_1                 1.457630e-01 1 1  ON 1
   uu_2                 4.350351e-02 1 1  ON 2
   uu_3                -1.972666e-02 1 1  ON 3
   uu_4                -6.653594e-02 1 1  ON 4
   uu_5                -1.030699e-01 1 1  ON 5
   uu_6                -1.322526e-01 1 1  ON 6
   uu_7                -1.480039e-01 1 1  ON 7
   uu_8                -1.413643e-01 1 1  ON 8
   uu_9                -1.140090e-01 1 1  ON 9
   ud_0                 4.515235e-01 1 1  ON 10
   ud_1                 1.856889e-01 1 1  ON 11
   ud_2                 6.517512e-02 1 1  ON 12
   ud_3                -5.993067e-03 1 1  ON 13
   ud_4                -6.359562e-02 1 1  ON 14
   ud_5                -1.061823e-01 1 1  ON 15
   ud_6                -1.348553e-01 1 1  ON 16
   ud_7                -1.529618e-01 1 1  ON 17
   ud_8                -1.553377e-01 1 1  ON 18
   ud_9                -1.460134e-01 1 1  ON 19
   eO_0                -7.486817e-01 1 1  ON 20
   eO_1                -4.274664e-01 1 1  ON 21
   eO_2                -1.621546e-02 1 1  ON 22
   eO_3                 2.974586e-01 1 1  ON 23
   eO_4                 5.256256e-01 1 1  ON 24
   eO_5                 4.902572e-01 1 1  ON 25
   eO_6                 2.635689e-01 1 1  ON 26
   eO_7                -4.206598e-02 1 1  ON 27
   eO_8                -2.364269e-01 1 1  ON 28
   eO_9                -1.021480e-01 1 1  ON 29
  eH1_0                -2.657503e-01 1 1  ON 30
  eH1_1                -1.579734e-01 1 1  ON 31
  eH1_2                -1.079983e-01 1 1  ON 32
  eH1_3                -5.208954e-02 1 1  ON 33
  eH1_4                -1.323264e-03 1 1  ON 34
  eH1_5                 3.492232e-02 1 1  ON 35
  eH1_6                 9.784306e-02 1 1  ON 36
  eH1_7                 1.595366e-01 1 1  ON 37
  eH1_8                 1.968209e-01 1 1  ON 38
  eH1_9                 9.508549e-02 1 1  ON 39
  eH2_0                -2.640458e-01 1 1  ON 40
  eH2_1                -1.563035e-01 1 1  ON 41
  eH2_2                -1.061468e-01 1 1  ON 42
  eH2_3                -5.044357e-02 1 1  ON 43
  eH2_4                 3.814682e-04 1 1  ON 44
  eH2_5                 3.736111e-02 1 1  ON 45
  eH2_6                 9.949025e-02 1 1  ON 46
  eH2_7                 1.612684e-01 1 1  ON 47
  eH2_8                 2.007670e-01 1 1  ON 48
  eH2_9                 8.857380e-02 1 1  ON 49
ci_0001                 7.011730e-01 3 1  ON 50
ci_0002                 7.009927e-01 3 1  ON 51
ci_0003                -2.755389e-02 3 1  ON 52
ci_0004                -2.745332e-02 3 1  ON 53
ci_0005                -3.574108e-02 3 1  ON 54
ci_0006                -3.580035e-02 3 1  ON 55
ci_0007                -2.127007e-02 3 1  ON 56
ci_0008                -2.206789e-02 3 1  ON 57
ci_0009                -1.709484e-02 3 1  ON 58
ci_0010                -1.708799e-02 3 1  ON 59
ci_0011                -1.210921e-02 3 1  ON 60
ci_0012                -1.198772e-02 3 1  ON 61
ci_0013                 1.417598e-02 3 1  ON 62
ci_0014                 1.350605e-02 3 1  ON 63
ci_0015                 1.346365e-02 3 1  ON 64
ci_0016                 1.298135e-02 3 1  ON 65
ci_0017                 1.122953e-02 3 1  ON 66
ci_0018                 1.115610e-02 3 1  ON 67
ci_0019                 1.100754e-02 3 1  ON 68
ci_0020                 1.135903e-02 3 1  ON 69
ci_0021                -1.797928e-03 3 1  ON 70
ci_0022                -1.087427e-03 3 1  ON 71
ci_0023                -1.152444e-02 3 1  ON 72
ci_0024                -1.089776e-02 3 1  ON 73
ci_0025                -1.049096e-02 3 1  ON 74
ci_0026                -1.112376e-02 3 1  ON 75
ci_0027                -1.105118e-02 3 1  ON 76
ci_0028                -1.119541e-02 3 1  ON 77
ci_0029                -9.997158e-03 3 1  ON 78
ci_0030                -1.088337e-02 3 1  ON 79
ci_0031                 2.120619e-02 3 1  ON 80
ci_0032                 2.077483e-02 3 1  ON 81
ci_0033                 1.019584e-02 3 1  ON 82
ci_0034                 9.790274e-03 3 1  ON 83
ci_0035                 7.129991e-03 3 1  ON 84
ci_0036                 6.280678e-03 3 1  ON 85
ci_0037                -1.031726e-02 3 1  ON 86
ci_0038                -1.089061e-02 3 1  ON 87
ci_0039                -2.713505e-03 3 1  ON 88
ci_0040                -2.696545e-03 3 1  ON 89
ci_0041                 7.490229e-03 3 1  ON 90
ci_0042                 6.985361e-03 3 1  ON 91
ci_0043                -1.889147e-02 3 1  ON 92
ci_0044                -1.916489e-02 3 1  ON 93
ci_0045                 7.349015e-03 3 1  ON 94
ci_0046                 7.343035e-03 3 1  ON 95
ci_0047                -1.967431e-03 3 1  ON 96
ci_0048                -2.129467e-03 3 1  ON 97
ci_0049                -5.509095e-03 3 1  ON 98
ci_0050                -6.107243e-03 3 1  ON 99
ci_0051                -3.491084e-03 3 1  ON 100
ci_0052                -3.394494e-03 3 1  ON 101
ci_0053                -4.459583e-03 3 1  ON 102
ci_0054                -4.623937e-03 3 1  ON 103
ci_0055                 5.936352e-03 3 1  ON 104
ci_0056                 6.617245e-03 3 1  ON 105
ci_0057                 4.530521e-03 3 1  ON 106
ci_0058                 5.045779e-03 3 1  ON 107
ci_0059                -4.975295e-03 3 1  ON 108
ci_0060                -4.802078e-03 3 1  ON 109
ci_0061                -3.591778e-03 3 1  ON 110
ci_0062                -3.116149e-03 3 1  ON 111
ci_0063                -8.802795e-03 3 1  ON 112
ci_0064                -8.081139e-03 3 1  ON 113
ci_0065                -5.664270e-03 3 1  ON 114
ci_0066                -5.444642e-03 3 1  ON 115
ci_0067                -4.523236e-03 3 1  ON 116
ci_0068                -4.887794e-03 3 1  ON 117
ci_0069                 4.167729e-03 3 1  ON 118
ci_0070                 4.252759e-03 3 1  ON 119
ci_0071                -3.438674e-04 3 1  ON 120
ci_0072                 5.590031e-04 3 1  ON 121
ci_0073                 4.121443e-03 3 1  ON 122
ci_0074                 3.986955e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 70
    time step          = 0.05
    reference energy   = -16.8723
    reference variance = 0.225167
====================================================
  Execution time = 2.1179e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s070
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3127e-01
  Total weights = 1.9519e+06
  Execution time = 1.9084e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321617200658
                                         uncertainty =       0.002019961212

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321617200658
                                         uncertainty =       0.002019961212

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400989077
  error estimate for blocks of size 2^( 2) =       0.000413300905
  error estimate for blocks of size 2^( 3) =       0.000426870006
  error estimate for blocks of size 2^( 4) =       0.000438926919
  error estimate for blocks of size 2^( 5) =       0.000450316002
  error estimate for blocks of size 2^( 6) =       0.000456710069
  error estimate for blocks of size 2^( 7) =       0.000461186056

      target function =                  N/A
              le_mean =     -16.905983581528
             les_mean =     286.153341780897
             stat err =       0.000451784761
             autocorr =       1.269398766525
              std dev =       0.567084190451
             le_variance =       0.321584479060

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321456957320
                                         uncertainty =       0.002015919241

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321456957320
                                         uncertainty =       0.002015919241

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400891448
  error estimate for blocks of size 2^( 2) =       0.000413196001
  error estimate for blocks of size 2^( 3) =       0.000426762448
  error estimate for blocks of size 2^( 4) =       0.000438763580
  error estimate for blocks of size 2^( 5) =       0.000450178517
  error estimate for blocks of size 2^( 6) =       0.000456593581
  error estimate for blocks of size 2^( 7) =       0.000461075847

      target function =                  N/A
              le_mean =     -16.905997988081
             les_mean =     286.145560085230
             stat err =       0.000451652881
             autocorr =       1.269275760140
              std dev =       0.566946123251
             le_variance =       0.321427906669

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321403911981
                                         uncertainty =       0.002012872613

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321403911981
                                         uncertainty =       0.002012872613

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400858529
  error estimate for blocks of size 2^( 2) =       0.000413171225
  error estimate for blocks of size 2^( 3) =       0.000426741516
  error estimate for blocks of size 2^( 4) =       0.000438740583
  error estimate for blocks of size 2^( 5) =       0.000450149964
  error estimate for blocks of size 2^( 6) =       0.000456574108
  error estimate for blocks of size 2^( 7) =       0.000461057935

      target function =                  N/A
              le_mean =     -16.906008723993
             les_mean =     286.146520312738
             stat err =       0.000451630648
             autocorr =       1.269359258091
              std dev =       0.566899567806
             le_variance =       0.321375119979

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321449924843
                                         uncertainty =       0.002023673284

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321449924843
                                         uncertainty =       0.002023673284

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400885254
  error estimate for blocks of size 2^( 2) =       0.000413221139
  error estimate for blocks of size 2^( 3) =       0.000426795641
  error estimate for blocks of size 2^( 4) =       0.000438845311
  error estimate for blocks of size 2^( 5) =       0.000450251588
  error estimate for blocks of size 2^( 6) =       0.000456644460
  error estimate for blocks of size 2^( 7) =       0.000461128727

      target function =                  N/A
              le_mean =     -16.905985128658
             les_mean =     286.175755804365
             stat err =       0.000451717521
             autocorr =       1.269678337680
              std dev =       0.566937362832
             le_variance =       0.321417973375


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905983581528        initial
     8.4703e-02     8.4703e-01             2.6846e-03       -16.905997988081
     3.3881e-01     3.3881e+00             7.0573e-04       -16.906008723993  <--
     1.3553e+00     1.3553e+01             2.3207e-04       -16.905985128658

*****************************************************************************
Applying the update for shift_i =   3.3881e-01     and shift_s =   3.3881e+00
*****************************************************************************

  Execution time = 3.0829e+01
  </log>
  <optVariables href="H2O.s070.opt.xml">
   uu_0                 3.134045e-01 1 1  ON 0
   uu_1                 1.457630e-01 1 1  ON 1
   uu_2                 4.350351e-02 1 1  ON 2
   uu_3                -1.972666e-02 1 1  ON 3
   uu_4                -6.653594e-02 1 1  ON 4
   uu_5                -1.030699e-01 1 1  ON 5
   uu_6                -1.322526e-01 1 1  ON 6
   uu_7                -1.480039e-01 1 1  ON 7
   uu_8                -1.413643e-01 1 1  ON 8
   uu_9                -1.140090e-01 1 1  ON 9
   ud_0                 4.515235e-01 1 1  ON 10
   ud_1                 1.856889e-01 1 1  ON 11
   ud_2                 6.517512e-02 1 1  ON 12
   ud_3                -5.993067e-03 1 1  ON 13
   ud_4                -6.359562e-02 1 1  ON 14
   ud_5                -1.061823e-01 1 1  ON 15
   ud_6                -1.348553e-01 1 1  ON 16
   ud_7                -1.529618e-01 1 1  ON 17
   ud_8                -1.553377e-01 1 1  ON 18
   ud_9                -1.460134e-01 1 1  ON 19
   eO_0                -7.486817e-01 1 1  ON 20
   eO_1                -4.274664e-01 1 1  ON 21
   eO_2                -1.621546e-02 1 1  ON 22
   eO_3                 2.974586e-01 1 1  ON 23
   eO_4                 5.256256e-01 1 1  ON 24
   eO_5                 4.902572e-01 1 1  ON 25
   eO_6                 2.635689e-01 1 1  ON 26
   eO_7                -4.206598e-02 1 1  ON 27
   eO_8                -2.364269e-01 1 1  ON 28
   eO_9                -1.021480e-01 1 1  ON 29
  eH1_0                -2.657503e-01 1 1  ON 30
  eH1_1                -1.579734e-01 1 1  ON 31
  eH1_2                -1.079983e-01 1 1  ON 32
  eH1_3                -5.208954e-02 1 1  ON 33
  eH1_4                -1.323264e-03 1 1  ON 34
  eH1_5                 3.492232e-02 1 1  ON 35
  eH1_6                 9.784306e-02 1 1  ON 36
  eH1_7                 1.595366e-01 1 1  ON 37
  eH1_8                 1.968209e-01 1 1  ON 38
  eH1_9                 9.508549e-02 1 1  ON 39
  eH2_0                -2.640458e-01 1 1  ON 40
  eH2_1                -1.563035e-01 1 1  ON 41
  eH2_2                -1.061468e-01 1 1  ON 42
  eH2_3                -5.044357e-02 1 1  ON 43
  eH2_4                 3.814682e-04 1 1  ON 44
  eH2_5                 3.736111e-02 1 1  ON 45
  eH2_6                 9.949025e-02 1 1  ON 46
  eH2_7                 1.612684e-01 1 1  ON 47
  eH2_8                 2.007670e-01 1 1  ON 48
  eH2_9                 8.857380e-02 1 1  ON 49
ci_0001                 7.011730e-01 3 1  ON 50
ci_0002                 7.009927e-01 3 1  ON 51
ci_0003                -2.755389e-02 3 1  ON 52
ci_0004                -2.745332e-02 3 1  ON 53
ci_0005                -3.574108e-02 3 1  ON 54
ci_0006                -3.580035e-02 3 1  ON 55
ci_0007                -2.127007e-02 3 1  ON 56
ci_0008                -2.206789e-02 3 1  ON 57
ci_0009                -1.709484e-02 3 1  ON 58
ci_0010                -1.708799e-02 3 1  ON 59
ci_0011                -1.210921e-02 3 1  ON 60
ci_0012                -1.198772e-02 3 1  ON 61
ci_0013                 1.417598e-02 3 1  ON 62
ci_0014                 1.350605e-02 3 1  ON 63
ci_0015                 1.346365e-02 3 1  ON 64
ci_0016                 1.298135e-02 3 1  ON 65
ci_0017                 1.122953e-02 3 1  ON 66
ci_0018                 1.115610e-02 3 1  ON 67
ci_0019                 1.100754e-02 3 1  ON 68
ci_0020                 1.135903e-02 3 1  ON 69
ci_0021                -1.797928e-03 3 1  ON 70
ci_0022                -1.087427e-03 3 1  ON 71
ci_0023                -1.152444e-02 3 1  ON 72
ci_0024                -1.089776e-02 3 1  ON 73
ci_0025                -1.049096e-02 3 1  ON 74
ci_0026                -1.112376e-02 3 1  ON 75
ci_0027                -1.105118e-02 3 1  ON 76
ci_0028                -1.119541e-02 3 1  ON 77
ci_0029                -9.997158e-03 3 1  ON 78
ci_0030                -1.088337e-02 3 1  ON 79
ci_0031                 2.120619e-02 3 1  ON 80
ci_0032                 2.077483e-02 3 1  ON 81
ci_0033                 1.019584e-02 3 1  ON 82
ci_0034                 9.790274e-03 3 1  ON 83
ci_0035                 7.129991e-03 3 1  ON 84
ci_0036                 6.280678e-03 3 1  ON 85
ci_0037                -1.031726e-02 3 1  ON 86
ci_0038                -1.089061e-02 3 1  ON 87
ci_0039                -2.713505e-03 3 1  ON 88
ci_0040                -2.696545e-03 3 1  ON 89
ci_0041                 7.490229e-03 3 1  ON 90
ci_0042                 6.985361e-03 3 1  ON 91
ci_0043                -1.889147e-02 3 1  ON 92
ci_0044                -1.916489e-02 3 1  ON 93
ci_0045                 7.349015e-03 3 1  ON 94
ci_0046                 7.343035e-03 3 1  ON 95
ci_0047                -1.967431e-03 3 1  ON 96
ci_0048                -2.129467e-03 3 1  ON 97
ci_0049                -5.509095e-03 3 1  ON 98
ci_0050                -6.107243e-03 3 1  ON 99
ci_0051                -3.491084e-03 3 1  ON 100
ci_0052                -3.394494e-03 3 1  ON 101
ci_0053                -4.459583e-03 3 1  ON 102
ci_0054                -4.623937e-03 3 1  ON 103
ci_0055                 5.936352e-03 3 1  ON 104
ci_0056                 6.617245e-03 3 1  ON 105
ci_0057                 4.530521e-03 3 1  ON 106
ci_0058                 5.045779e-03 3 1  ON 107
ci_0059                -4.975295e-03 3 1  ON 108
ci_0060                -4.802078e-03 3 1  ON 109
ci_0061                -3.591778e-03 3 1  ON 110
ci_0062                -3.116149e-03 3 1  ON 111
ci_0063                -8.802795e-03 3 1  ON 112
ci_0064                -8.081139e-03 3 1  ON 113
ci_0065                -5.664270e-03 3 1  ON 114
ci_0066                -5.444642e-03 3 1  ON 115
ci_0067                -4.523236e-03 3 1  ON 116
ci_0068                -4.887794e-03 3 1  ON 117
ci_0069                 4.167729e-03 3 1  ON 118
ci_0070                 4.252759e-03 3 1  ON 119
ci_0071                -3.438674e-04 3 1  ON 120
ci_0072                 5.590031e-04 3 1  ON 121
ci_0073                 4.121443e-03 3 1  ON 122
ci_0074                 3.986955e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8194e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s071 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s071 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=71  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 71
    time step          = 0.05
    reference energy   = -16.903
    reference variance = 0.280249
====================================================
  Execution time = 2.1241e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s071
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5275e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3576e-01
  Total weights = 1.952011007e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0087e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325179603983
                                         uncertainty =       0.002086766673

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325179603983
                                         uncertainty =       0.002086766673

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403183134
  error estimate for blocks of size 2^( 2) =       0.000415965932
  error estimate for blocks of size 2^( 3) =       0.000429562392
  error estimate for blocks of size 2^( 4) =       0.000442470425
  error estimate for blocks of size 2^( 5) =       0.000452718941
  error estimate for blocks of size 2^( 6) =       0.000460414728
  error estimate for blocks of size 2^( 7) =       0.000463218056

      target function =                  N/A
              le_mean =     -16.906730954296
             les_mean =     286.173314389566
             stat err =       0.000454705538
             autocorr =       1.271908220570
              std dev =       0.570187056079
             le_variance =       0.325113278920


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690673095430e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.4703e-02, overlap shift 8.4703e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906730954292       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906741587393       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906744243831       residual = 4.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906743121182       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906742124009       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906745321929       residual = 7.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906745572728       residual = 6.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906746858065       residual = 5.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906749267346       residual = 4.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906749641795       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906749331627       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906748063383       residual = 9.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906747733636       residual = 3.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906747721475       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906747640978       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.906747596999       residual = 5.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 8.4703e-02 is 3.390316e-03

solving harmonic davidson linear method for identity shift 3.3881e-01, overlap shift 3.3881e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906730954292       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906736575466       residual = 5.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906737850539       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906737608189       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906736755006       residual = 6.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906737962048       residual = 5.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906738318913       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906738718691       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906739422544       residual = 4.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906739334202       residual = 2.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906739087514       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906739042563       residual = 2.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.3881e-01 is 8.474312e-04

solving harmonic davidson linear method for identity shift 1.3553e+00, overlap shift 1.3553e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906730954292       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906732902430       residual = 4.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906733296645       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906733294178       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906733030089       residual = 5.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906733262036       residual = 3.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906733408506       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906733577990       residual = 5.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906733702808       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906733694692       residual = 3.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.3553e+00 is 2.210924e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.615597 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7260e+01
  </log>
  <optVariables href="H2O.s071.opt.xml">
   uu_0                 3.130531e-01 1 1  ON 0
   uu_1                 1.456659e-01 1 1  ON 1
   uu_2                 4.346862e-02 1 1  ON 2
   uu_3                -1.977893e-02 1 1  ON 3
   uu_4                -6.650054e-02 1 1  ON 4
   uu_5                -1.030503e-01 1 1  ON 5
   uu_6                -1.323348e-01 1 1  ON 6
   uu_7                -1.479649e-01 1 1  ON 7
   uu_8                -1.413736e-01 1 1  ON 8
   uu_9                -1.139166e-01 1 1  ON 9
   ud_0                 4.515991e-01 1 1  ON 10
   ud_1                 1.856712e-01 1 1  ON 11
   ud_2                 6.509442e-02 1 1  ON 12
   ud_3                -6.098247e-03 1 1  ON 13
   ud_4                -6.368011e-02 1 1  ON 14
   ud_5                -1.062822e-01 1 1  ON 15
   ud_6                -1.348972e-01 1 1  ON 16
   ud_7                -1.530088e-01 1 1  ON 17
   ud_8                -1.550359e-01 1 1  ON 18
   ud_9                -1.457993e-01 1 1  ON 19
   eO_0                -7.487186e-01 1 1  ON 20
   eO_1                -4.275746e-01 1 1  ON 21
   eO_2                -1.609903e-02 1 1  ON 22
   eO_3                 2.977447e-01 1 1  ON 23
   eO_4                 5.257786e-01 1 1  ON 24
   eO_5                 4.902624e-01 1 1  ON 25
   eO_6                 2.636747e-01 1 1  ON 26
   eO_7                -4.210425e-02 1 1  ON 27
   eO_8                -2.365387e-01 1 1  ON 28
   eO_9                -1.024621e-01 1 1  ON 29
  eH1_0                -2.659213e-01 1 1  ON 30
  eH1_1                -1.582291e-01 1 1  ON 31
  eH1_2                -1.081185e-01 1 1  ON 32
  eH1_3                -5.228725e-02 1 1  ON 33
  eH1_4                -1.467487e-03 1 1  ON 34
  eH1_5                 3.484082e-02 1 1  ON 35
  eH1_6                 9.785893e-02 1 1  ON 36
  eH1_7                 1.596985e-01 1 1  ON 37
  eH1_8                 1.970216e-01 1 1  ON 38
  eH1_9                 9.556802e-02 1 1  ON 39
  eH2_0                -2.641258e-01 1 1  ON 40
  eH2_1                -1.564469e-01 1 1  ON 41
  eH2_2                -1.064444e-01 1 1  ON 42
  eH2_3                -5.072207e-02 1 1  ON 43
  eH2_4                 5.252758e-05 1 1  ON 44
  eH2_5                 3.718218e-02 1 1  ON 45
  eH2_6                 9.945147e-02 1 1  ON 46
  eH2_7                 1.612295e-01 1 1  ON 47
  eH2_8                 2.012192e-01 1 1  ON 48
  eH2_9                 8.942123e-02 1 1  ON 49
ci_0001                 7.014402e-01 3 1  ON 50
ci_0002                 7.007908e-01 3 1  ON 51
ci_0003                -2.737749e-02 3 1  ON 52
ci_0004                -2.694815e-02 3 1  ON 53
ci_0005                -3.559278e-02 3 1  ON 54
ci_0006                -3.585420e-02 3 1  ON 55
ci_0007                -2.092842e-02 3 1  ON 56
ci_0008                -2.182048e-02 3 1  ON 57
ci_0009                -1.711761e-02 3 1  ON 58
ci_0010                -1.702729e-02 3 1  ON 59
ci_0011                -1.211479e-02 3 1  ON 60
ci_0012                -1.241608e-02 3 1  ON 61
ci_0013                 1.373685e-02 3 1  ON 62
ci_0014                 1.299168e-02 3 1  ON 63
ci_0015                 1.364114e-02 3 1  ON 64
ci_0016                 1.296839e-02 3 1  ON 65
ci_0017                 1.124218e-02 3 1  ON 66
ci_0018                 1.126746e-02 3 1  ON 67
ci_0019                 1.108771e-02 3 1  ON 68
ci_0020                 1.137265e-02 3 1  ON 69
ci_0021                -1.974552e-03 3 1  ON 70
ci_0022                -8.268780e-04 3 1  ON 71
ci_0023                -1.124179e-02 3 1  ON 72
ci_0024                -1.111127e-02 3 1  ON 73
ci_0025                -1.053001e-02 3 1  ON 74
ci_0026                -1.073296e-02 3 1  ON 75
ci_0027                -1.143046e-02 3 1  ON 76
ci_0028                -1.114806e-02 3 1  ON 77
ci_0029                -1.054451e-02 3 1  ON 78
ci_0030                -1.099183e-02 3 1  ON 79
ci_0031                 2.091225e-02 3 1  ON 80
ci_0032                 2.084229e-02 3 1  ON 81
ci_0033                 9.478500e-03 3 1  ON 82
ci_0034                 9.984272e-03 3 1  ON 83
ci_0035                 6.766672e-03 3 1  ON 84
ci_0036                 6.412570e-03 3 1  ON 85
ci_0037                -1.023017e-02 3 1  ON 86
ci_0038                -1.118421e-02 3 1  ON 87
ci_0039                -2.736787e-03 3 1  ON 88
ci_0040                -2.693613e-03 3 1  ON 89
ci_0041                 7.285714e-03 3 1  ON 90
ci_0042                 7.046666e-03 3 1  ON 91
ci_0043                -1.882354e-02 3 1  ON 92
ci_0044                -1.884604e-02 3 1  ON 93
ci_0045                 7.720974e-03 3 1  ON 94
ci_0046                 7.216639e-03 3 1  ON 95
ci_0047                -1.684794e-03 3 1  ON 96
ci_0048                -2.066453e-03 3 1  ON 97
ci_0049                -5.978403e-03 3 1  ON 98
ci_0050                -6.101778e-03 3 1  ON 99
ci_0051                -3.467106e-03 3 1  ON 100
ci_0052                -3.182119e-03 3 1  ON 101
ci_0053                -4.372550e-03 3 1  ON 102
ci_0054                -4.544845e-03 3 1  ON 103
ci_0055                 6.223382e-03 3 1  ON 104
ci_0056                 6.731638e-03 3 1  ON 105
ci_0057                 4.767668e-03 3 1  ON 106
ci_0058                 4.834819e-03 3 1  ON 107
ci_0059                -4.855143e-03 3 1  ON 108
ci_0060                -4.844168e-03 3 1  ON 109
ci_0061                -3.549143e-03 3 1  ON 110
ci_0062                -3.406486e-03 3 1  ON 111
ci_0063                -8.501880e-03 3 1  ON 112
ci_0064                -8.066715e-03 3 1  ON 113
ci_0065                -5.445493e-03 3 1  ON 114
ci_0066                -5.618757e-03 3 1  ON 115
ci_0067                -4.745673e-03 3 1  ON 116
ci_0068                -5.002600e-03 3 1  ON 117
ci_0069                 4.479999e-03 3 1  ON 118
ci_0070                 4.315035e-03 3 1  ON 119
ci_0071                -1.664369e-04 3 1  ON 120
ci_0072                 5.538868e-04 3 1  ON 121
ci_0073                 4.099350e-03 3 1  ON 122
ci_0074                 4.195103e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 71
    time step          = 0.05
    reference energy   = -16.9112
    reference variance = 0.262115
====================================================
  Execution time = 2.1426e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s071
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3302e-01
  Total weights = 1.9519e+06
  Execution time = 2.3562e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320666374325
                                         uncertainty =       0.001853320239

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320666374325
                                         uncertainty =       0.001853320239

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400396226
  error estimate for blocks of size 2^( 2) =       0.000413715129
  error estimate for blocks of size 2^( 3) =       0.000427337038
  error estimate for blocks of size 2^( 4) =       0.000440579415
  error estimate for blocks of size 2^( 5) =       0.000450490008
  error estimate for blocks of size 2^( 6) =       0.000458321942
  error estimate for blocks of size 2^( 7) =       0.000464938020

      target function =                  N/A
              le_mean =     -16.905249100803
             les_mean =     286.120901700196
             stat err =       0.000453582346
             autocorr =       1.283312239546
              std dev =       0.566245772823
             le_variance =       0.320634275239

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320788670945
                                         uncertainty =       0.001849995356

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320788670945
                                         uncertainty =       0.001849995356

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400473565
  error estimate for blocks of size 2^( 2) =       0.000413797597
  error estimate for blocks of size 2^( 3) =       0.000427434030
  error estimate for blocks of size 2^( 4) =       0.000440679665
  error estimate for blocks of size 2^( 5) =       0.000450562888
  error estimate for blocks of size 2^( 6) =       0.000458364462
  error estimate for blocks of size 2^( 7) =       0.000464870366

      target function =                  N/A
              le_mean =     -16.905244193918
             les_mean =     286.284718813727
             stat err =       0.000453619345
             autocorr =       1.283025908558
              std dev =       0.566355147524
             le_variance =       0.320758153127

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320662487415
                                         uncertainty =       0.001853604484

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320662487415
                                         uncertainty =       0.001853604484

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400394884
  error estimate for blocks of size 2^( 2) =       0.000413721148
  error estimate for blocks of size 2^( 3) =       0.000427346468
  error estimate for blocks of size 2^( 4) =       0.000440582299
  error estimate for blocks of size 2^( 5) =       0.000450479401
  error estimate for blocks of size 2^( 6) =       0.000458288484
  error estimate for blocks of size 2^( 7) =       0.000464800941

      target function =                  N/A
              le_mean =     -16.905249367200
             les_mean =     286.124241082862
             stat err =       0.000453537781
             autocorr =       1.283068679840
              std dev =       0.566243874681
             le_variance =       0.320632125614

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320641627785
                                         uncertainty =       0.001853065677

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320641627785
                                         uncertainty =       0.001853065677

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400380970
  error estimate for blocks of size 2^( 2) =       0.000413698845
  error estimate for blocks of size 2^( 3) =       0.000427320698
  error estimate for blocks of size 2^( 4) =       0.000440564432
  error estimate for blocks of size 2^( 5) =       0.000450471021
  error estimate for blocks of size 2^( 6) =       0.000458297355
  error estimate for blocks of size 2^( 7) =       0.000464902236

      target function =                  N/A
              le_mean =     -16.905245628028
             les_mean =     286.123284649898
             stat err =       0.000453558761
             autocorr =       1.283276570267
              std dev =       0.566224198323
             le_variance =       0.320609842767


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905249100803        initial
     8.4703e-02     8.4703e-01             3.3903e-03       -16.905244193918
     3.3881e-01     3.3881e+00             8.4743e-04       -16.905249367200  <--
     1.3553e+00     1.3553e+01             2.2109e-04       -16.905245628028

*****************************************************************************
Applying the update for shift_i =   3.3881e-01     and shift_s =   3.3881e+00
*****************************************************************************

  Execution time = 3.1682e+01
  </log>
  <optVariables href="H2O.s071.opt.xml">
   uu_0                 3.130531e-01 1 1  ON 0
   uu_1                 1.456659e-01 1 1  ON 1
   uu_2                 4.346862e-02 1 1  ON 2
   uu_3                -1.977893e-02 1 1  ON 3
   uu_4                -6.650054e-02 1 1  ON 4
   uu_5                -1.030503e-01 1 1  ON 5
   uu_6                -1.323348e-01 1 1  ON 6
   uu_7                -1.479649e-01 1 1  ON 7
   uu_8                -1.413736e-01 1 1  ON 8
   uu_9                -1.139166e-01 1 1  ON 9
   ud_0                 4.515991e-01 1 1  ON 10
   ud_1                 1.856712e-01 1 1  ON 11
   ud_2                 6.509442e-02 1 1  ON 12
   ud_3                -6.098247e-03 1 1  ON 13
   ud_4                -6.368011e-02 1 1  ON 14
   ud_5                -1.062822e-01 1 1  ON 15
   ud_6                -1.348972e-01 1 1  ON 16
   ud_7                -1.530088e-01 1 1  ON 17
   ud_8                -1.550359e-01 1 1  ON 18
   ud_9                -1.457993e-01 1 1  ON 19
   eO_0                -7.487186e-01 1 1  ON 20
   eO_1                -4.275746e-01 1 1  ON 21
   eO_2                -1.609903e-02 1 1  ON 22
   eO_3                 2.977447e-01 1 1  ON 23
   eO_4                 5.257786e-01 1 1  ON 24
   eO_5                 4.902624e-01 1 1  ON 25
   eO_6                 2.636747e-01 1 1  ON 26
   eO_7                -4.210425e-02 1 1  ON 27
   eO_8                -2.365387e-01 1 1  ON 28
   eO_9                -1.024621e-01 1 1  ON 29
  eH1_0                -2.659213e-01 1 1  ON 30
  eH1_1                -1.582291e-01 1 1  ON 31
  eH1_2                -1.081185e-01 1 1  ON 32
  eH1_3                -5.228725e-02 1 1  ON 33
  eH1_4                -1.467487e-03 1 1  ON 34
  eH1_5                 3.484082e-02 1 1  ON 35
  eH1_6                 9.785893e-02 1 1  ON 36
  eH1_7                 1.596985e-01 1 1  ON 37
  eH1_8                 1.970216e-01 1 1  ON 38
  eH1_9                 9.556802e-02 1 1  ON 39
  eH2_0                -2.641258e-01 1 1  ON 40
  eH2_1                -1.564469e-01 1 1  ON 41
  eH2_2                -1.064444e-01 1 1  ON 42
  eH2_3                -5.072207e-02 1 1  ON 43
  eH2_4                 5.252758e-05 1 1  ON 44
  eH2_5                 3.718218e-02 1 1  ON 45
  eH2_6                 9.945147e-02 1 1  ON 46
  eH2_7                 1.612295e-01 1 1  ON 47
  eH2_8                 2.012192e-01 1 1  ON 48
  eH2_9                 8.942123e-02 1 1  ON 49
ci_0001                 7.014402e-01 3 1  ON 50
ci_0002                 7.007908e-01 3 1  ON 51
ci_0003                -2.737749e-02 3 1  ON 52
ci_0004                -2.694815e-02 3 1  ON 53
ci_0005                -3.559278e-02 3 1  ON 54
ci_0006                -3.585420e-02 3 1  ON 55
ci_0007                -2.092842e-02 3 1  ON 56
ci_0008                -2.182048e-02 3 1  ON 57
ci_0009                -1.711761e-02 3 1  ON 58
ci_0010                -1.702729e-02 3 1  ON 59
ci_0011                -1.211479e-02 3 1  ON 60
ci_0012                -1.241608e-02 3 1  ON 61
ci_0013                 1.373685e-02 3 1  ON 62
ci_0014                 1.299168e-02 3 1  ON 63
ci_0015                 1.364114e-02 3 1  ON 64
ci_0016                 1.296839e-02 3 1  ON 65
ci_0017                 1.124218e-02 3 1  ON 66
ci_0018                 1.126746e-02 3 1  ON 67
ci_0019                 1.108771e-02 3 1  ON 68
ci_0020                 1.137265e-02 3 1  ON 69
ci_0021                -1.974552e-03 3 1  ON 70
ci_0022                -8.268780e-04 3 1  ON 71
ci_0023                -1.124179e-02 3 1  ON 72
ci_0024                -1.111127e-02 3 1  ON 73
ci_0025                -1.053001e-02 3 1  ON 74
ci_0026                -1.073296e-02 3 1  ON 75
ci_0027                -1.143046e-02 3 1  ON 76
ci_0028                -1.114806e-02 3 1  ON 77
ci_0029                -1.054451e-02 3 1  ON 78
ci_0030                -1.099183e-02 3 1  ON 79
ci_0031                 2.091225e-02 3 1  ON 80
ci_0032                 2.084229e-02 3 1  ON 81
ci_0033                 9.478500e-03 3 1  ON 82
ci_0034                 9.984272e-03 3 1  ON 83
ci_0035                 6.766672e-03 3 1  ON 84
ci_0036                 6.412570e-03 3 1  ON 85
ci_0037                -1.023017e-02 3 1  ON 86
ci_0038                -1.118421e-02 3 1  ON 87
ci_0039                -2.736787e-03 3 1  ON 88
ci_0040                -2.693613e-03 3 1  ON 89
ci_0041                 7.285714e-03 3 1  ON 90
ci_0042                 7.046666e-03 3 1  ON 91
ci_0043                -1.882354e-02 3 1  ON 92
ci_0044                -1.884604e-02 3 1  ON 93
ci_0045                 7.720974e-03 3 1  ON 94
ci_0046                 7.216639e-03 3 1  ON 95
ci_0047                -1.684794e-03 3 1  ON 96
ci_0048                -2.066453e-03 3 1  ON 97
ci_0049                -5.978403e-03 3 1  ON 98
ci_0050                -6.101778e-03 3 1  ON 99
ci_0051                -3.467106e-03 3 1  ON 100
ci_0052                -3.182119e-03 3 1  ON 101
ci_0053                -4.372550e-03 3 1  ON 102
ci_0054                -4.544845e-03 3 1  ON 103
ci_0055                 6.223382e-03 3 1  ON 104
ci_0056                 6.731638e-03 3 1  ON 105
ci_0057                 4.767668e-03 3 1  ON 106
ci_0058                 4.834819e-03 3 1  ON 107
ci_0059                -4.855143e-03 3 1  ON 108
ci_0060                -4.844168e-03 3 1  ON 109
ci_0061                -3.549143e-03 3 1  ON 110
ci_0062                -3.406486e-03 3 1  ON 111
ci_0063                -8.501880e-03 3 1  ON 112
ci_0064                -8.066715e-03 3 1  ON 113
ci_0065                -5.445493e-03 3 1  ON 114
ci_0066                -5.618757e-03 3 1  ON 115
ci_0067                -4.745673e-03 3 1  ON 116
ci_0068                -5.002600e-03 3 1  ON 117
ci_0069                 4.479999e-03 3 1  ON 118
ci_0070                 4.315035e-03 3 1  ON 119
ci_0071                -1.664369e-04 3 1  ON 120
ci_0072                 5.538868e-04 3 1  ON 121
ci_0073                 4.099350e-03 3 1  ON 122
ci_0074                 4.195103e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8947e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s072 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s072 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=72  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 72
    time step          = 0.05
    reference energy   = -16.8813
    reference variance = 0.200517
====================================================
  Execution time = 2.1169e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s072
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5276e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3908e-01
  Total weights = 1.951802875e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0544e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326102649034
                                         uncertainty =       0.002913215404

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326102649034
                                         uncertainty =       0.002913215404

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403793521
  error estimate for blocks of size 2^( 2) =       0.000416703400
  error estimate for blocks of size 2^( 3) =       0.000430025339
  error estimate for blocks of size 2^( 4) =       0.000442905491
  error estimate for blocks of size 2^( 5) =       0.000454223664
  error estimate for blocks of size 2^( 6) =       0.000464188860
  error estimate for blocks of size 2^( 7) =       0.000467382441

      target function =                  N/A
              le_mean =     -16.906145752993
             les_mean =     286.156843338398
             stat err =       0.000457175114
             autocorr =       1.281877344040
              std dev =       0.571050273369
             le_variance =       0.326098414715


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690614575299e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.4703e-02, overlap shift 8.4703e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906145753005       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906154378494       residual = 1.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906159659170       residual = 8.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906160803132       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906158197998       residual = 9.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906158788528       residual = 8.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906156469973       residual = 6.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906157194596       residual = 4.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906159075906       residual = 3.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906159393912       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906159090714       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906159379750       residual = 7.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906159725713       residual = 1.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906159586314       residual = 8.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 8.4703e-02 is 2.107550e-03

solving harmonic davidson linear method for identity shift 3.3881e-01, overlap shift 3.3881e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906145753005       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906150697399       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906152334359       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906153453472       residual = 8.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906152176209       residual = 7.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906151719240       residual = 4.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906151215140       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906151215422       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906151914869       residual = 5.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906152106237       residual = 2.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906152063830       residual = 7.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.3881e-01 is 7.398198e-04

solving harmonic davidson linear method for identity shift 1.3553e+00, overlap shift 1.3553e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906145753005       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906147579473       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906147960821       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906148398825       residual = 7.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906147943563       residual = 7.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906147662176       residual = 2.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906147557281       residual = 9.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906147582648       residual = 3.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906147578671       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906147674831       residual = 5.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.3553e+00 is 2.986982e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.620935 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7232e+01
  </log>
  <optVariables href="H2O.s072.opt.xml">
   uu_0                 3.131952e-01 1 1  ON 0
   uu_1                 1.455885e-01 1 1  ON 1
   uu_2                 4.344619e-02 1 1  ON 2
   uu_3                -1.969687e-02 1 1  ON 3
   uu_4                -6.652176e-02 1 1  ON 4
   uu_5                -1.031340e-01 1 1  ON 5
   uu_6                -1.323077e-01 1 1  ON 6
   uu_7                -1.480593e-01 1 1  ON 7
   uu_8                -1.416702e-01 1 1  ON 8
   uu_9                -1.140042e-01 1 1  ON 9
   ud_0                 4.516638e-01 1 1  ON 10
   ud_1                 1.857020e-01 1 1  ON 11
   ud_2                 6.508681e-02 1 1  ON 12
   ud_3                -6.043857e-03 1 1  ON 13
   ud_4                -6.356342e-02 1 1  ON 14
   ud_5                -1.063752e-01 1 1  ON 15
   ud_6                -1.350264e-01 1 1  ON 16
   ud_7                -1.529422e-01 1 1  ON 17
   ud_8                -1.549735e-01 1 1  ON 18
   ud_9                -1.457372e-01 1 1  ON 19
   eO_0                -7.484781e-01 1 1  ON 20
   eO_1                -4.275983e-01 1 1  ON 21
   eO_2                -1.607902e-02 1 1  ON 22
   eO_3                 2.977683e-01 1 1  ON 23
   eO_4                 5.258320e-01 1 1  ON 24
   eO_5                 4.904247e-01 1 1  ON 25
   eO_6                 2.638025e-01 1 1  ON 26
   eO_7                -4.210351e-02 1 1  ON 27
   eO_8                -2.367444e-01 1 1  ON 28
   eO_9                -1.027987e-01 1 1  ON 29
  eH1_0                -2.660733e-01 1 1  ON 30
  eH1_1                -1.584794e-01 1 1  ON 31
  eH1_2                -1.083000e-01 1 1  ON 32
  eH1_3                -5.248074e-02 1 1  ON 33
  eH1_4                -1.823938e-03 1 1  ON 34
  eH1_5                 3.493283e-02 1 1  ON 35
  eH1_6                 9.797405e-02 1 1  ON 36
  eH1_7                 1.598610e-01 1 1  ON 37
  eH1_8                 1.972530e-01 1 1  ON 38
  eH1_9                 9.603043e-02 1 1  ON 39
  eH2_0                -2.644562e-01 1 1  ON 40
  eH2_1                -1.564055e-01 1 1  ON 41
  eH2_2                -1.065197e-01 1 1  ON 42
  eH2_3                -5.082599e-02 1 1  ON 43
  eH2_4                -2.677893e-04 1 1  ON 44
  eH2_5                 3.673307e-02 1 1  ON 45
  eH2_6                 9.920112e-02 1 1  ON 46
  eH2_7                 1.616413e-01 1 1  ON 47
  eH2_8                 2.017574e-01 1 1  ON 48
  eH2_9                 8.994327e-02 1 1  ON 49
ci_0001                 7.012787e-01 3 1  ON 50
ci_0002                 7.009363e-01 3 1  ON 51
ci_0003                -2.742193e-02 3 1  ON 52
ci_0004                -2.677588e-02 3 1  ON 53
ci_0005                -3.569569e-02 3 1  ON 54
ci_0006                -3.575707e-02 3 1  ON 55
ci_0007                -2.084509e-02 3 1  ON 56
ci_0008                -2.174533e-02 3 1  ON 57
ci_0009                -1.708090e-02 3 1  ON 58
ci_0010                -1.690116e-02 3 1  ON 59
ci_0011                -1.232562e-02 3 1  ON 60
ci_0012                -1.255607e-02 3 1  ON 61
ci_0013                 1.376821e-02 3 1  ON 62
ci_0014                 1.282751e-02 3 1  ON 63
ci_0015                 1.358372e-02 3 1  ON 64
ci_0016                 1.263334e-02 3 1  ON 65
ci_0017                 1.132614e-02 3 1  ON 66
ci_0018                 1.126878e-02 3 1  ON 67
ci_0019                 1.110579e-02 3 1  ON 68
ci_0020                 1.147232e-02 3 1  ON 69
ci_0021                -1.684012e-03 3 1  ON 70
ci_0022                -9.435955e-04 3 1  ON 71
ci_0023                -1.150518e-02 3 1  ON 72
ci_0024                -1.136691e-02 3 1  ON 73
ci_0025                -1.077929e-02 3 1  ON 74
ci_0026                -1.097979e-02 3 1  ON 75
ci_0027                -1.135674e-02 3 1  ON 76
ci_0028                -1.152440e-02 3 1  ON 77
ci_0029                -1.053690e-02 3 1  ON 78
ci_0030                -1.115729e-02 3 1  ON 79
ci_0031                 2.053516e-02 3 1  ON 80
ci_0032                 2.133728e-02 3 1  ON 81
ci_0033                 9.495591e-03 3 1  ON 82
ci_0034                 9.952893e-03 3 1  ON 83
ci_0035                 7.087163e-03 3 1  ON 84
ci_0036                 6.235425e-03 3 1  ON 85
ci_0037                -1.043320e-02 3 1  ON 86
ci_0038                -1.126891e-02 3 1  ON 87
ci_0039                -2.595867e-03 3 1  ON 88
ci_0040                -2.636106e-03 3 1  ON 89
ci_0041                 7.012597e-03 3 1  ON 90
ci_0042                 7.127777e-03 3 1  ON 91
ci_0043                -1.837785e-02 3 1  ON 92
ci_0044                -1.913034e-02 3 1  ON 93
ci_0045                 7.733882e-03 3 1  ON 94
ci_0046                 7.189132e-03 3 1  ON 95
ci_0047                -2.424614e-03 3 1  ON 96
ci_0048                -2.245022e-03 3 1  ON 97
ci_0049                -5.650410e-03 3 1  ON 98
ci_0050                -6.004452e-03 3 1  ON 99
ci_0051                -3.259091e-03 3 1  ON 100
ci_0052                -3.407943e-03 3 1  ON 101
ci_0053                -4.643602e-03 3 1  ON 102
ci_0054                -4.545692e-03 3 1  ON 103
ci_0055                 6.491110e-03 3 1  ON 104
ci_0056                 6.742061e-03 3 1  ON 105
ci_0057                 4.989551e-03 3 1  ON 106
ci_0058                 4.937988e-03 3 1  ON 107
ci_0059                -4.614163e-03 3 1  ON 108
ci_0060                -4.696381e-03 3 1  ON 109
ci_0061                -3.507926e-03 3 1  ON 110
ci_0062                -3.379829e-03 3 1  ON 111
ci_0063                -8.680329e-03 3 1  ON 112
ci_0064                -8.359607e-03 3 1  ON 113
ci_0065                -5.067351e-03 3 1  ON 114
ci_0066                -5.260377e-03 3 1  ON 115
ci_0067                -4.778959e-03 3 1  ON 116
ci_0068                -4.799323e-03 3 1  ON 117
ci_0069                 4.469103e-03 3 1  ON 118
ci_0070                 4.731027e-03 3 1  ON 119
ci_0071                -1.163417e-04 3 1  ON 120
ci_0072                 3.214203e-04 3 1  ON 121
ci_0073                 4.552823e-03 3 1  ON 122
ci_0074                 4.240393e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 72
    time step          = 0.05
    reference energy   = -16.8584
    reference variance = 0.246994
====================================================
  Execution time = 2.0814e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s072
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3236e-01
  Total weights = 1.9519e+06
  Execution time = 1.9134e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320327617596
                                         uncertainty =       0.002132090236

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320327617596
                                         uncertainty =       0.002132090236

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400159099
  error estimate for blocks of size 2^( 2) =       0.000412558902
  error estimate for blocks of size 2^( 3) =       0.000425590705
  error estimate for blocks of size 2^( 4) =       0.000437523073
  error estimate for blocks of size 2^( 5) =       0.000447857233
  error estimate for blocks of size 2^( 6) =       0.000455145089
  error estimate for blocks of size 2^( 7) =       0.000462434271

      target function =                  N/A
              le_mean =     -16.906016642419
             les_mean =     286.147420124767
             stat err =       0.000450739917
             autocorr =       1.268780941761
              std dev =       0.565910425068
             le_variance =       0.320254609201

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320777611430
                                         uncertainty =       0.002168952474

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320777611430
                                         uncertainty =       0.002168952474

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400439568
  error estimate for blocks of size 2^( 2) =       0.000412824702
  error estimate for blocks of size 2^( 3) =       0.000425857574
  error estimate for blocks of size 2^( 4) =       0.000437766302
  error estimate for blocks of size 2^( 5) =       0.000448100329
  error estimate for blocks of size 2^( 6) =       0.000455367997
  error estimate for blocks of size 2^( 7) =       0.000462705331

      target function =                  N/A
              le_mean =     -16.906012957064
             les_mean =     286.145401187245
             stat err =       0.000450984990
             autocorr =       1.268382398099
              std dev =       0.566307067947
             le_variance =       0.320703695207

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320942799248
                                         uncertainty =       0.002177225125

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320942799248
                                         uncertainty =       0.002177225125

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400542640
  error estimate for blocks of size 2^( 2) =       0.000412922782
  error estimate for blocks of size 2^( 3) =       0.000425954847
  error estimate for blocks of size 2^( 4) =       0.000437856117
  error estimate for blocks of size 2^( 5) =       0.000448192896
  error estimate for blocks of size 2^( 6) =       0.000455454494
  error estimate for blocks of size 2^( 7) =       0.000462801822

      target function =                  N/A
              le_mean =     -16.906014223971
             les_mean =     286.145777557268
             stat err =       0.000451076332
             autocorr =       1.268243279135
              std dev =       0.566452833397
             le_variance =       0.320868812464

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320414673830
                                         uncertainty =       0.002139224817

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320414673830
                                         uncertainty =       0.002139224817

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400213390
  error estimate for blocks of size 2^( 2) =       0.000412609513
  error estimate for blocks of size 2^( 3) =       0.000425641363
  error estimate for blocks of size 2^( 4) =       0.000437568024
  error estimate for blocks of size 2^( 5) =       0.000447902652
  error estimate for blocks of size 2^( 6) =       0.000455178284
  error estimate for blocks of size 2^( 7) =       0.000462478528

      target function =                  N/A
              le_mean =     -16.906011127821
             les_mean =     286.170585640194
             stat err =       0.000450781872
             autocorr =       1.268672880706
              std dev =       0.565987203997
             le_variance =       0.320341515089


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906016642419        initial  <--
     8.4703e-02     8.4703e-01             2.1076e-03       -16.906012957064
     3.3881e-01     3.3881e+00             7.3982e-04       -16.906014223971
     1.3553e+00     1.3553e+01             2.9870e-04       -16.906011127821

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.4926
  </log>
  <optVariables href="H2O.s072.opt.xml">
   uu_0                 3.130531e-01 1 1  ON 0
   uu_1                 1.456659e-01 1 1  ON 1
   uu_2                 4.346862e-02 1 1  ON 2
   uu_3                -1.977893e-02 1 1  ON 3
   uu_4                -6.650054e-02 1 1  ON 4
   uu_5                -1.030503e-01 1 1  ON 5
   uu_6                -1.323348e-01 1 1  ON 6
   uu_7                -1.479649e-01 1 1  ON 7
   uu_8                -1.413736e-01 1 1  ON 8
   uu_9                -1.139166e-01 1 1  ON 9
   ud_0                 4.515991e-01 1 1  ON 10
   ud_1                 1.856712e-01 1 1  ON 11
   ud_2                 6.509442e-02 1 1  ON 12
   ud_3                -6.098247e-03 1 1  ON 13
   ud_4                -6.368011e-02 1 1  ON 14
   ud_5                -1.062822e-01 1 1  ON 15
   ud_6                -1.348972e-01 1 1  ON 16
   ud_7                -1.530088e-01 1 1  ON 17
   ud_8                -1.550359e-01 1 1  ON 18
   ud_9                -1.457993e-01 1 1  ON 19
   eO_0                -7.487186e-01 1 1  ON 20
   eO_1                -4.275746e-01 1 1  ON 21
   eO_2                -1.609903e-02 1 1  ON 22
   eO_3                 2.977447e-01 1 1  ON 23
   eO_4                 5.257786e-01 1 1  ON 24
   eO_5                 4.902624e-01 1 1  ON 25
   eO_6                 2.636747e-01 1 1  ON 26
   eO_7                -4.210425e-02 1 1  ON 27
   eO_8                -2.365387e-01 1 1  ON 28
   eO_9                -1.024621e-01 1 1  ON 29
  eH1_0                -2.659213e-01 1 1  ON 30
  eH1_1                -1.582291e-01 1 1  ON 31
  eH1_2                -1.081185e-01 1 1  ON 32
  eH1_3                -5.228725e-02 1 1  ON 33
  eH1_4                -1.467487e-03 1 1  ON 34
  eH1_5                 3.484082e-02 1 1  ON 35
  eH1_6                 9.785893e-02 1 1  ON 36
  eH1_7                 1.596985e-01 1 1  ON 37
  eH1_8                 1.970216e-01 1 1  ON 38
  eH1_9                 9.556802e-02 1 1  ON 39
  eH2_0                -2.641258e-01 1 1  ON 40
  eH2_1                -1.564469e-01 1 1  ON 41
  eH2_2                -1.064444e-01 1 1  ON 42
  eH2_3                -5.072207e-02 1 1  ON 43
  eH2_4                 5.252758e-05 1 1  ON 44
  eH2_5                 3.718218e-02 1 1  ON 45
  eH2_6                 9.945147e-02 1 1  ON 46
  eH2_7                 1.612295e-01 1 1  ON 47
  eH2_8                 2.012192e-01 1 1  ON 48
  eH2_9                 8.942123e-02 1 1  ON 49
ci_0001                 7.014402e-01 3 1  ON 50
ci_0002                 7.007908e-01 3 1  ON 51
ci_0003                -2.737749e-02 3 1  ON 52
ci_0004                -2.694815e-02 3 1  ON 53
ci_0005                -3.559278e-02 3 1  ON 54
ci_0006                -3.585420e-02 3 1  ON 55
ci_0007                -2.092842e-02 3 1  ON 56
ci_0008                -2.182048e-02 3 1  ON 57
ci_0009                -1.711761e-02 3 1  ON 58
ci_0010                -1.702729e-02 3 1  ON 59
ci_0011                -1.211479e-02 3 1  ON 60
ci_0012                -1.241608e-02 3 1  ON 61
ci_0013                 1.373685e-02 3 1  ON 62
ci_0014                 1.299168e-02 3 1  ON 63
ci_0015                 1.364114e-02 3 1  ON 64
ci_0016                 1.296839e-02 3 1  ON 65
ci_0017                 1.124218e-02 3 1  ON 66
ci_0018                 1.126746e-02 3 1  ON 67
ci_0019                 1.108771e-02 3 1  ON 68
ci_0020                 1.137265e-02 3 1  ON 69
ci_0021                -1.974552e-03 3 1  ON 70
ci_0022                -8.268780e-04 3 1  ON 71
ci_0023                -1.124179e-02 3 1  ON 72
ci_0024                -1.111127e-02 3 1  ON 73
ci_0025                -1.053001e-02 3 1  ON 74
ci_0026                -1.073296e-02 3 1  ON 75
ci_0027                -1.143046e-02 3 1  ON 76
ci_0028                -1.114806e-02 3 1  ON 77
ci_0029                -1.054451e-02 3 1  ON 78
ci_0030                -1.099183e-02 3 1  ON 79
ci_0031                 2.091225e-02 3 1  ON 80
ci_0032                 2.084229e-02 3 1  ON 81
ci_0033                 9.478500e-03 3 1  ON 82
ci_0034                 9.984272e-03 3 1  ON 83
ci_0035                 6.766672e-03 3 1  ON 84
ci_0036                 6.412570e-03 3 1  ON 85
ci_0037                -1.023017e-02 3 1  ON 86
ci_0038                -1.118421e-02 3 1  ON 87
ci_0039                -2.736787e-03 3 1  ON 88
ci_0040                -2.693613e-03 3 1  ON 89
ci_0041                 7.285714e-03 3 1  ON 90
ci_0042                 7.046666e-03 3 1  ON 91
ci_0043                -1.882354e-02 3 1  ON 92
ci_0044                -1.884604e-02 3 1  ON 93
ci_0045                 7.720974e-03 3 1  ON 94
ci_0046                 7.216639e-03 3 1  ON 95
ci_0047                -1.684794e-03 3 1  ON 96
ci_0048                -2.066453e-03 3 1  ON 97
ci_0049                -5.978403e-03 3 1  ON 98
ci_0050                -6.101778e-03 3 1  ON 99
ci_0051                -3.467106e-03 3 1  ON 100
ci_0052                -3.182119e-03 3 1  ON 101
ci_0053                -4.372550e-03 3 1  ON 102
ci_0054                -4.544845e-03 3 1  ON 103
ci_0055                 6.223382e-03 3 1  ON 104
ci_0056                 6.731638e-03 3 1  ON 105
ci_0057                 4.767668e-03 3 1  ON 106
ci_0058                 4.834819e-03 3 1  ON 107
ci_0059                -4.855143e-03 3 1  ON 108
ci_0060                -4.844168e-03 3 1  ON 109
ci_0061                -3.549143e-03 3 1  ON 110
ci_0062                -3.406486e-03 3 1  ON 111
ci_0063                -8.501880e-03 3 1  ON 112
ci_0064                -8.066715e-03 3 1  ON 113
ci_0065                -5.445493e-03 3 1  ON 114
ci_0066                -5.618757e-03 3 1  ON 115
ci_0067                -4.745673e-03 3 1  ON 116
ci_0068                -5.002600e-03 3 1  ON 117
ci_0069                 4.479999e-03 3 1  ON 118
ci_0070                 4.315035e-03 3 1  ON 119
ci_0071                -1.664369e-04 3 1  ON 120
ci_0072                 5.538868e-04 3 1  ON 121
ci_0073                 4.099350e-03 3 1  ON 122
ci_0074                 4.195103e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7731e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s073 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s073 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=73  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 73
    time step          = 0.05
    reference energy   = -16.9522
    reference variance = 0.248815
====================================================
  Execution time = 2.1196e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s073
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5288e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2952e-01
  Total weights = 1.952088032e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0893e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319588675290
                                         uncertainty =       0.001849747599

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319588675290
                                         uncertainty =       0.001849747599

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399688169
  error estimate for blocks of size 2^( 2) =       0.000412781299
  error estimate for blocks of size 2^( 3) =       0.000425737132
  error estimate for blocks of size 2^( 4) =       0.000438284590
  error estimate for blocks of size 2^( 5) =       0.000448934392
  error estimate for blocks of size 2^( 6) =       0.000457816234
  error estimate for blocks of size 2^( 7) =       0.000463437540

      target function =                  N/A
              le_mean =     -16.905315297969
             les_mean =     286.119209353206
             stat err =       0.000452118189
             autocorr =       1.279562113595
              std dev =       0.565244429315
             le_variance =       0.319501264872


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690531529797e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.4703e-01, overlap shift 8.4703e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905315297960       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905318934997       residual = 4.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905319197146       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905319531534       residual = 9.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905319389269       residual = 5.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905319578151       residual = 2.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905319325549       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905319504541       residual = 5.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905319349283       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905319339219       residual = 6.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 8.4703e-01 is 3.370774e-04

solving harmonic davidson linear method for identity shift 3.3881e+00, overlap shift 3.3881e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905315297960       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905316371298       residual = 4.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905316417588       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905316465566       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905316399559       residual = 5.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905316427941       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905316366172       residual = 8.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905316423597       residual = 3.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905316392987       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905316381493       residual = 3.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.3881e+00 is 9.691342e-05

solving harmonic davidson linear method for identity shift 1.3553e+01, overlap shift 1.3553e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905315297960       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905315578972       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905315588896       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905315596997       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905315576926       residual = 5.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905315581711       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905315566014       residual = 8.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905315580695       residual = 3.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905315575688       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905315571736       residual = 2.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.3553e+01 is 2.580448e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.624879 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7294e+01
  </log>
  <optVariables href="H2O.s073.opt.xml">
   uu_0                 3.130981e-01 1 1  ON 0
   uu_1                 1.456458e-01 1 1  ON 1
   uu_2                 4.343408e-02 1 1  ON 2
   uu_3                -1.978036e-02 1 1  ON 3
   uu_4                -6.653657e-02 1 1  ON 4
   uu_5                -1.030424e-01 1 1  ON 5
   uu_6                -1.323135e-01 1 1  ON 6
   uu_7                -1.479666e-01 1 1  ON 7
   uu_8                -1.413714e-01 1 1  ON 8
   uu_9                -1.139239e-01 1 1  ON 9
   ud_0                 4.516067e-01 1 1  ON 10
   ud_1                 1.856963e-01 1 1  ON 11
   ud_2                 6.512189e-02 1 1  ON 12
   ud_3                -6.090470e-03 1 1  ON 13
   ud_4                -6.369875e-02 1 1  ON 14
   ud_5                -1.062776e-01 1 1  ON 15
   ud_6                -1.349178e-01 1 1  ON 16
   ud_7                -1.530289e-01 1 1  ON 17
   ud_8                -1.550239e-01 1 1  ON 18
   ud_9                -1.457830e-01 1 1  ON 19
   eO_0                -7.486896e-01 1 1  ON 20
   eO_1                -4.276018e-01 1 1  ON 21
   eO_2                -1.610054e-02 1 1  ON 22
   eO_3                 2.977647e-01 1 1  ON 23
   eO_4                 5.258109e-01 1 1  ON 24
   eO_5                 4.902955e-01 1 1  ON 25
   eO_6                 2.636541e-01 1 1  ON 26
   eO_7                -4.210651e-02 1 1  ON 27
   eO_8                -2.365561e-01 1 1  ON 28
   eO_9                -1.024994e-01 1 1  ON 29
  eH1_0                -2.659327e-01 1 1  ON 30
  eH1_1                -1.582407e-01 1 1  ON 31
  eH1_2                -1.081169e-01 1 1  ON 32
  eH1_3                -5.230775e-02 1 1  ON 33
  eH1_4                -1.503491e-03 1 1  ON 34
  eH1_5                 3.482915e-02 1 1  ON 35
  eH1_6                 9.784459e-02 1 1  ON 36
  eH1_7                 1.596959e-01 1 1  ON 37
  eH1_8                 1.970462e-01 1 1  ON 38
  eH1_9                 9.563351e-02 1 1  ON 39
  eH2_0                -2.641736e-01 1 1  ON 40
  eH2_1                -1.564688e-01 1 1  ON 41
  eH2_2                -1.064631e-01 1 1  ON 42
  eH2_3                -5.073071e-02 1 1  ON 43
  eH2_4                 3.682178e-05 1 1  ON 44
  eH2_5                 3.717505e-02 1 1  ON 45
  eH2_6                 9.947065e-02 1 1  ON 46
  eH2_7                 1.612575e-01 1 1  ON 47
  eH2_8                 2.012435e-01 1 1  ON 48
  eH2_9                 8.946810e-02 1 1  ON 49
ci_0001                 7.014250e-01 3 1  ON 50
ci_0002                 7.008025e-01 3 1  ON 51
ci_0003                -2.735985e-02 3 1  ON 52
ci_0004                -2.693363e-02 3 1  ON 53
ci_0005                -3.559796e-02 3 1  ON 54
ci_0006                -3.588227e-02 3 1  ON 55
ci_0007                -2.090771e-02 3 1  ON 56
ci_0008                -2.179920e-02 3 1  ON 57
ci_0009                -1.715356e-02 3 1  ON 58
ci_0010                -1.704820e-02 3 1  ON 59
ci_0011                -1.218346e-02 3 1  ON 60
ci_0012                -1.240087e-02 3 1  ON 61
ci_0013                 1.368224e-02 3 1  ON 62
ci_0014                 1.302685e-02 3 1  ON 63
ci_0015                 1.361610e-02 3 1  ON 64
ci_0016                 1.297474e-02 3 1  ON 65
ci_0017                 1.129592e-02 3 1  ON 66
ci_0018                 1.123989e-02 3 1  ON 67
ci_0019                 1.109791e-02 3 1  ON 68
ci_0020                 1.135496e-02 3 1  ON 69
ci_0021                -1.994848e-03 3 1  ON 70
ci_0022                -8.060407e-04 3 1  ON 71
ci_0023                -1.121536e-02 3 1  ON 72
ci_0024                -1.115138e-02 3 1  ON 73
ci_0025                -1.056544e-02 3 1  ON 74
ci_0026                -1.068471e-02 3 1  ON 75
ci_0027                -1.144457e-02 3 1  ON 76
ci_0028                -1.114517e-02 3 1  ON 77
ci_0029                -1.052417e-02 3 1  ON 78
ci_0030                -1.098562e-02 3 1  ON 79
ci_0031                 2.090402e-02 3 1  ON 80
ci_0032                 2.086813e-02 3 1  ON 81
ci_0033                 9.528944e-03 3 1  ON 82
ci_0034                 9.985980e-03 3 1  ON 83
ci_0035                 6.794888e-03 3 1  ON 84
ci_0036                 6.410904e-03 3 1  ON 85
ci_0037                -1.020190e-02 3 1  ON 86
ci_0038                -1.113865e-02 3 1  ON 87
ci_0039                -2.715709e-03 3 1  ON 88
ci_0040                -2.713973e-03 3 1  ON 89
ci_0041                 7.335789e-03 3 1  ON 90
ci_0042                 7.016369e-03 3 1  ON 91
ci_0043                -1.882510e-02 3 1  ON 92
ci_0044                -1.890029e-02 3 1  ON 93
ci_0045                 7.689776e-03 3 1  ON 94
ci_0046                 7.311340e-03 3 1  ON 95
ci_0047                -1.702915e-03 3 1  ON 96
ci_0048                -2.073595e-03 3 1  ON 97
ci_0049                -5.978996e-03 3 1  ON 98
ci_0050                -6.040115e-03 3 1  ON 99
ci_0051                -3.460188e-03 3 1  ON 100
ci_0052                -3.190832e-03 3 1  ON 101
ci_0053                -4.469463e-03 3 1  ON 102
ci_0054                -4.543506e-03 3 1  ON 103
ci_0055                 6.242762e-03 3 1  ON 104
ci_0056                 6.740316e-03 3 1  ON 105
ci_0057                 4.796014e-03 3 1  ON 106
ci_0058                 4.774813e-03 3 1  ON 107
ci_0059                -4.822448e-03 3 1  ON 108
ci_0060                -4.825593e-03 3 1  ON 109
ci_0061                -3.557776e-03 3 1  ON 110
ci_0062                -3.393389e-03 3 1  ON 111
ci_0063                -8.480490e-03 3 1  ON 112
ci_0064                -8.103106e-03 3 1  ON 113
ci_0065                -5.444483e-03 3 1  ON 114
ci_0066                -5.602166e-03 3 1  ON 115
ci_0067                -4.737568e-03 3 1  ON 116
ci_0068                -5.048283e-03 3 1  ON 117
ci_0069                 4.437927e-03 3 1  ON 118
ci_0070                 4.293776e-03 3 1  ON 119
ci_0071                -1.479419e-04 3 1  ON 120
ci_0072                 5.167788e-04 3 1  ON 121
ci_0073                 4.134189e-03 3 1  ON 122
ci_0074                 4.214828e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 73
    time step          = 0.05
    reference energy   = -16.8496
    reference variance = 0.222128
====================================================
  Execution time = 2.1093e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s073
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3733e-01
  Total weights = 1.9517e+06
  Execution time = 1.9139e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326303802659
                                         uncertainty =       0.003961174485

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326303802659
                                         uncertainty =       0.003961174485

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403996525
  error estimate for blocks of size 2^( 2) =       0.000416779427
  error estimate for blocks of size 2^( 3) =       0.000430247863
  error estimate for blocks of size 2^( 4) =       0.000442685882
  error estimate for blocks of size 2^( 5) =       0.000452929186
  error estimate for blocks of size 2^( 6) =       0.000460954678
  error estimate for blocks of size 2^( 7) =       0.000466863265

      target function =                  N/A
              le_mean =     -16.906915453429
             les_mean =     286.181393582201
             stat err =       0.000455858253
             autocorr =       1.273222729628
              std dev =       0.571337365465
             le_variance =       0.326426385177

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326462248932
                                         uncertainty =       0.004065712973

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326462248932
                                         uncertainty =       0.004065712973

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404094450
  error estimate for blocks of size 2^( 2) =       0.000416876819
  error estimate for blocks of size 2^( 3) =       0.000430338172
  error estimate for blocks of size 2^( 4) =       0.000442771800
  error estimate for blocks of size 2^( 5) =       0.000453015693
  error estimate for blocks of size 2^( 6) =       0.000461046777
  error estimate for blocks of size 2^( 7) =       0.000466963162

      target function =                  N/A
              le_mean =     -16.906916557459
             les_mean =     286.181485496842
             stat err =       0.000455949358
             autocorr =       1.273114441238
              std dev =       0.571475852304
             le_variance =       0.326584649767

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326389347526
                                         uncertainty =       0.004019645926

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326389347526
                                         uncertainty =       0.004019645926

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404049379
  error estimate for blocks of size 2^( 2) =       0.000416832298
  error estimate for blocks of size 2^( 3) =       0.000430296718
  error estimate for blocks of size 2^( 4) =       0.000442731792
  error estimate for blocks of size 2^( 5) =       0.000452974486
  error estimate for blocks of size 2^( 6) =       0.000461003908
  error estimate for blocks of size 2^( 7) =       0.000466917133

      target function =                  N/A
              le_mean =     -16.906915296808
             les_mean =     286.185096064602
             stat err =       0.000455906830
             autocorr =       1.273160950525
              std dev =       0.571412111022
             le_variance =       0.326511800622

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326315041433
                                         uncertainty =       0.003968657359

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326315041433
                                         uncertainty =       0.003968657359

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404003468
  error estimate for blocks of size 2^( 2) =       0.000416786259
  error estimate for blocks of size 2^( 3) =       0.000430255035
  error estimate for blocks of size 2^( 4) =       0.000442693213
  error estimate for blocks of size 2^( 5) =       0.000452934861
  error estimate for blocks of size 2^( 6) =       0.000460963186
  error estimate for blocks of size 2^( 7) =       0.000466873340

      target function =                  N/A
              le_mean =     -16.906914715765
             les_mean =     286.268085282673
             stat err =       0.000455866150
             autocorr =       1.273223083732
              std dev =       0.571347183773
             le_variance =       0.326437604406


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906915453429        initial
     8.4703e-01     8.4703e+00             3.3708e-04       -16.906916557459  <--
     3.3881e+00     3.3881e+01             9.6913e-05       -16.906915296808
     1.3553e+01     1.3553e+02             2.5804e-05       -16.906914715765

*****************************************************************************
Applying the update for shift_i =   8.4703e-01     and shift_s =   8.4703e+00
*****************************************************************************

  Execution time = 3.0771e+01
  </log>
  <optVariables href="H2O.s073.opt.xml">
   uu_0                 3.131907e-01 1 1  ON 0
   uu_1                 1.455909e-01 1 1  ON 1
   uu_2                 4.336575e-02 1 1  ON 2
   uu_3                -1.980206e-02 1 1  ON 3
   uu_4                -6.660962e-02 1 1  ON 4
   uu_5                -1.030357e-01 1 1  ON 5
   uu_6                -1.322539e-01 1 1  ON 6
   uu_7                -1.479653e-01 1 1  ON 7
   uu_8                -1.413647e-01 1 1  ON 8
   uu_9                -1.139456e-01 1 1  ON 9
   ud_0                 4.516373e-01 1 1  ON 10
   ud_1                 1.857582e-01 1 1  ON 11
   ud_2                 6.518904e-02 1 1  ON 12
   ud_3                -6.068587e-03 1 1  ON 13
   ud_4                -6.373846e-02 1 1  ON 14
   ud_5                -1.062765e-01 1 1  ON 15
   ud_6                -1.349642e-01 1 1  ON 16
   ud_7                -1.530837e-01 1 1  ON 17
   ud_8                -1.549917e-01 1 1  ON 18
   ud_9                -1.457348e-01 1 1  ON 19
   eO_0                -7.486330e-01 1 1  ON 20
   eO_1                -4.276512e-01 1 1  ON 21
   eO_2                -1.610480e-02 1 1  ON 22
   eO_3                 2.978231e-01 1 1  ON 23
   eO_4                 5.259009e-01 1 1  ON 24
   eO_5                 4.903937e-01 1 1  ON 25
   eO_6                 2.635981e-01 1 1  ON 26
   eO_7                -4.211352e-02 1 1  ON 27
   eO_8                -2.366079e-01 1 1  ON 28
   eO_9                -1.026095e-01 1 1  ON 29
  eH1_0                -2.659696e-01 1 1  ON 30
  eH1_1                -1.582705e-01 1 1  ON 31
  eH1_2                -1.081257e-01 1 1  ON 32
  eH1_3                -5.235976e-02 1 1  ON 33
  eH1_4                -1.605802e-03 1 1  ON 34
  eH1_5                 3.479110e-02 1 1  ON 35
  eH1_6                 9.780215e-02 1 1  ON 36
  eH1_7                 1.596896e-01 1 1  ON 37
  eH1_8                 1.971192e-01 1 1  ON 38
  eH1_9                 9.582762e-02 1 1  ON 39
  eH2_0                -2.643150e-01 1 1  ON 40
  eH2_1                -1.565305e-01 1 1  ON 41
  eH2_2                -1.065217e-01 1 1  ON 42
  eH2_3                -5.075867e-02 1 1  ON 43
  eH2_4                -8.950824e-06 1 1  ON 44
  eH2_5                 3.715351e-02 1 1  ON 45
  eH2_6                 9.952694e-02 1 1  ON 46
  eH2_7                 1.613421e-01 1 1  ON 47
  eH2_8                 2.013160e-01 1 1  ON 48
  eH2_9                 8.960701e-02 1 1  ON 49
ci_0001                 7.013820e-01 3 1  ON 50
ci_0002                 7.008370e-01 3 1  ON 51
ci_0003                -2.731667e-02 3 1  ON 52
ci_0004                -2.689653e-02 3 1  ON 53
ci_0005                -3.561063e-02 3 1  ON 54
ci_0006                -3.595496e-02 3 1  ON 55
ci_0007                -2.085019e-02 3 1  ON 56
ci_0008                -2.173923e-02 3 1  ON 57
ci_0009                -1.723901e-02 3 1  ON 58
ci_0010                -1.709715e-02 3 1  ON 59
ci_0011                -1.234988e-02 3 1  ON 60
ci_0012                -1.236463e-02 3 1  ON 61
ci_0013                 1.354934e-02 3 1  ON 62
ci_0014                 1.311077e-02 3 1  ON 63
ci_0015                 1.355453e-02 3 1  ON 64
ci_0016                 1.299031e-02 3 1  ON 65
ci_0017                 1.142153e-02 3 1  ON 66
ci_0018                 1.117492e-02 3 1  ON 67
ci_0019                 1.111870e-02 3 1  ON 68
ci_0020                 1.131149e-02 3 1  ON 69
ci_0021                -2.048795e-03 3 1  ON 70
ci_0022                -7.465652e-04 3 1  ON 71
ci_0023                -1.115148e-02 3 1  ON 72
ci_0024                -1.124495e-02 3 1  ON 73
ci_0025                -1.064898e-02 3 1  ON 74
ci_0026                -1.056974e-02 3 1  ON 75
ci_0027                -1.147999e-02 3 1  ON 76
ci_0028                -1.113644e-02 3 1  ON 77
ci_0029                -1.047462e-02 3 1  ON 78
ci_0030                -1.097072e-02 3 1  ON 79
ci_0031                 2.088644e-02 3 1  ON 80
ci_0032                 2.093496e-02 3 1  ON 81
ci_0033                 9.663230e-03 3 1  ON 82
ci_0034                 9.991392e-03 3 1  ON 83
ci_0035                 6.862996e-03 3 1  ON 84
ci_0036                 6.408378e-03 3 1  ON 85
ci_0037                -1.013181e-02 3 1  ON 86
ci_0038                -1.102394e-02 3 1  ON 87
ci_0039                -2.672395e-03 3 1  ON 88
ci_0040                -2.757461e-03 3 1  ON 89
ci_0041                 7.453155e-03 3 1  ON 90
ci_0042                 6.946048e-03 3 1  ON 91
ci_0043                -1.883159e-02 3 1  ON 92
ci_0044                -1.904899e-02 3 1  ON 93
ci_0045                 7.611164e-03 3 1  ON 94
ci_0046                 7.553717e-03 3 1  ON 95
ci_0047                -1.741009e-03 3 1  ON 96
ci_0048                -2.089157e-03 3 1  ON 97
ci_0049                -5.979483e-03 3 1  ON 98
ci_0050                -5.892106e-03 3 1  ON 99
ci_0051                -3.446526e-03 3 1  ON 100
ci_0052                -3.209389e-03 3 1  ON 101
ci_0053                -4.683823e-03 3 1  ON 102
ci_0054                -4.540273e-03 3 1  ON 103
ci_0055                 6.290719e-03 3 1  ON 104
ci_0056                 6.762894e-03 3 1  ON 105
ci_0057                 4.866250e-03 3 1  ON 106
ci_0058                 4.626403e-03 3 1  ON 107
ci_0059                -4.750229e-03 3 1  ON 108
ci_0060                -4.783833e-03 3 1  ON 109
ci_0061                -3.577842e-03 3 1  ON 110
ci_0062                -3.362098e-03 3 1  ON 111
ci_0063                -8.434582e-03 3 1  ON 112
ci_0064                -8.186034e-03 3 1  ON 113
ci_0065                -5.441582e-03 3 1  ON 114
ci_0066                -5.564188e-03 3 1  ON 115
ci_0067                -4.720494e-03 3 1  ON 116
ci_0068                -5.147168e-03 3 1  ON 117
ci_0069                 4.347520e-03 3 1  ON 118
ci_0070                 4.246633e-03 3 1  ON 119
ci_0071                -1.018347e-04 3 1  ON 120
ci_0072                 4.291612e-04 3 1  ON 121
ci_0073                 4.209809e-03 3 1  ON 122
ci_0074                 4.257792e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8071e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s074 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s074 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=74  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 74
    time step          = 0.05
    reference energy   = -16.9375
    reference variance = 0.246785
====================================================
  Execution time = 2.1570e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s074
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5275e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3801e-01
  Total weights = 1.951692953e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1301e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323439445375
                                         uncertainty =       0.002699114253

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323439445375
                                         uncertainty =       0.002699114253

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402165292
  error estimate for blocks of size 2^( 2) =       0.000415183710
  error estimate for blocks of size 2^( 3) =       0.000428531629
  error estimate for blocks of size 2^( 4) =       0.000440634350
  error estimate for blocks of size 2^( 5) =       0.000450588324
  error estimate for blocks of size 2^( 6) =       0.000457430402
  error estimate for blocks of size 2^( 7) =       0.000458822906

      target function =                  N/A
              le_mean =     -16.905566045306
             les_mean =     286.136175170228
             stat err =       0.000451868995
             autocorr =       1.262455019767
              std dev =       0.568747609967
             le_variance =       0.323473843843


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690556604531e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.1176e-01, overlap shift 2.1176e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905566045307       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905570673230       residual = 5.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905573830360       residual = 3.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905573013074       residual = 6.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905572350028       residual = 7.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905573169019       residual = 6.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905573746477       residual = 3.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905573128408       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905573312063       residual = 7.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905573321255       residual = 3.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905573412035       residual = 1.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905573521707       residual = 5.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.1176e-01 is 9.082560e-04

solving harmonic davidson linear method for identity shift 8.4703e-01, overlap shift 8.4703e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905566045307       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905567922108       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905568730179       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905568678206       residual = 5.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905568434032       residual = 7.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905568574017       residual = 2.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905568650508       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905568435462       residual = 6.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905568455567       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905568575252       residual = 6.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 8.4703e-01 is 3.106599e-04

solving harmonic davidson linear method for identity shift 3.3881e+00, overlap shift 3.3881e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905566045307       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905566600928       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905566790083       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905566791329       residual = 5.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905566731106       residual = 7.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905566760534       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905566754020       residual = 9.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905566693653       residual = 3.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905566702784       residual = 5.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.3881e+00 is 8.484961e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.629178 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7708e+01
  </log>
  <optVariables href="H2O.s074.opt.xml">
   uu_0                 3.132529e-01 1 1  ON 0
   uu_1                 1.455789e-01 1 1  ON 1
   uu_2                 4.342920e-02 1 1  ON 2
   uu_3                -1.979706e-02 1 1  ON 3
   uu_4                -6.661559e-02 1 1  ON 4
   uu_5                -1.030876e-01 1 1  ON 5
   uu_6                -1.322180e-01 1 1  ON 6
   uu_7                -1.480400e-01 1 1  ON 7
   uu_8                -1.414129e-01 1 1  ON 8
   uu_9                -1.139961e-01 1 1  ON 9
   ud_0                 4.517761e-01 1 1  ON 10
   ud_1                 1.857645e-01 1 1  ON 11
   ud_2                 6.523348e-02 1 1  ON 12
   ud_3                -5.968503e-03 1 1  ON 13
   ud_4                -6.372317e-02 1 1  ON 14
   ud_5                -1.061556e-01 1 1  ON 15
   ud_6                -1.349891e-01 1 1  ON 16
   ud_7                -1.531429e-01 1 1  ON 17
   ud_8                -1.550462e-01 1 1  ON 18
   ud_9                -1.458163e-01 1 1  ON 19
   eO_0                -7.485395e-01 1 1  ON 20
   eO_1                -4.277303e-01 1 1  ON 21
   eO_2                -1.611963e-02 1 1  ON 22
   eO_3                 2.978718e-01 1 1  ON 23
   eO_4                 5.259725e-01 1 1  ON 24
   eO_5                 4.906382e-01 1 1  ON 25
   eO_6                 2.636447e-01 1 1  ON 26
   eO_7                -4.217320e-02 1 1  ON 27
   eO_8                -2.367345e-01 1 1  ON 28
   eO_9                -1.027843e-01 1 1  ON 29
  eH1_0                -2.661019e-01 1 1  ON 30
  eH1_1                -1.583081e-01 1 1  ON 31
  eH1_2                -1.082049e-01 1 1  ON 32
  eH1_3                -5.247016e-02 1 1  ON 33
  eH1_4                -1.696600e-03 1 1  ON 34
  eH1_5                 3.481326e-02 1 1  ON 35
  eH1_6                 9.786475e-02 1 1  ON 36
  eH1_7                 1.597197e-01 1 1  ON 37
  eH1_8                 1.972129e-01 1 1  ON 38
  eH1_9                 9.604972e-02 1 1  ON 39
  eH2_0                -2.643254e-01 1 1  ON 40
  eH2_1                -1.565531e-01 1 1  ON 41
  eH2_2                -1.066083e-01 1 1  ON 42
  eH2_3                -5.080711e-02 1 1  ON 43
  eH2_4                -6.970701e-05 1 1  ON 44
  eH2_5                 3.704568e-02 1 1  ON 45
  eH2_6                 9.961832e-02 1 1  ON 46
  eH2_7                 1.613527e-01 1 1  ON 47
  eH2_8                 2.013646e-01 1 1  ON 48
  eH2_9                 8.979212e-02 1 1  ON 49
ci_0001                 7.013252e-01 3 1  ON 50
ci_0002                 7.008952e-01 3 1  ON 51
ci_0003                -2.721045e-02 3 1  ON 52
ci_0004                -2.699474e-02 3 1  ON 53
ci_0005                -3.553403e-02 3 1  ON 54
ci_0006                -3.602774e-02 3 1  ON 55
ci_0007                -2.084390e-02 3 1  ON 56
ci_0008                -2.151092e-02 3 1  ON 57
ci_0009                -1.734219e-02 3 1  ON 58
ci_0010                -1.713137e-02 3 1  ON 59
ci_0011                -1.241568e-02 3 1  ON 60
ci_0012                -1.246538e-02 3 1  ON 61
ci_0013                 1.336865e-02 3 1  ON 62
ci_0014                 1.313639e-02 3 1  ON 63
ci_0015                 1.361276e-02 3 1  ON 64
ci_0016                 1.296319e-02 3 1  ON 65
ci_0017                 1.144347e-02 3 1  ON 66
ci_0018                 1.121359e-02 3 1  ON 67
ci_0019                 1.106919e-02 3 1  ON 68
ci_0020                 1.126588e-02 3 1  ON 69
ci_0021                -2.036805e-03 3 1  ON 70
ci_0022                -6.963693e-04 3 1  ON 71
ci_0023                -1.128880e-02 3 1  ON 72
ci_0024                -1.131375e-02 3 1  ON 73
ci_0025                -1.070553e-02 3 1  ON 74
ci_0026                -1.068147e-02 3 1  ON 75
ci_0027                -1.124469e-02 3 1  ON 76
ci_0028                -1.119486e-02 3 1  ON 77
ci_0029                -1.054554e-02 3 1  ON 78
ci_0030                -1.097140e-02 3 1  ON 79
ci_0031                 2.087418e-02 3 1  ON 80
ci_0032                 2.091127e-02 3 1  ON 81
ci_0033                 9.973890e-03 3 1  ON 82
ci_0034                 1.006457e-02 3 1  ON 83
ci_0035                 6.861021e-03 3 1  ON 84
ci_0036                 6.421559e-03 3 1  ON 85
ci_0037                -1.041156e-02 3 1  ON 86
ci_0038                -1.084972e-02 3 1  ON 87
ci_0039                -2.501347e-03 3 1  ON 88
ci_0040                -2.594019e-03 3 1  ON 89
ci_0041                 7.322783e-03 3 1  ON 90
ci_0042                 6.925190e-03 3 1  ON 91
ci_0043                -1.892083e-02 3 1  ON 92
ci_0044                -1.882037e-02 3 1  ON 93
ci_0045                 7.585180e-03 3 1  ON 94
ci_0046                 7.595893e-03 3 1  ON 95
ci_0047                -1.691206e-03 3 1  ON 96
ci_0048                -1.971526e-03 3 1  ON 97
ci_0049                -5.884400e-03 3 1  ON 98
ci_0050                -5.658742e-03 3 1  ON 99
ci_0051                -3.527316e-03 3 1  ON 100
ci_0052                -3.344975e-03 3 1  ON 101
ci_0053                -4.621645e-03 3 1  ON 102
ci_0054                -4.596096e-03 3 1  ON 103
ci_0055                 6.351281e-03 3 1  ON 104
ci_0056                 6.757518e-03 3 1  ON 105
ci_0057                 4.749076e-03 3 1  ON 106
ci_0058                 4.468109e-03 3 1  ON 107
ci_0059                -4.733979e-03 3 1  ON 108
ci_0060                -4.685796e-03 3 1  ON 109
ci_0061                -3.580703e-03 3 1  ON 110
ci_0062                -3.277229e-03 3 1  ON 111
ci_0063                -8.583090e-03 3 1  ON 112
ci_0064                -8.365778e-03 3 1  ON 113
ci_0065                -5.483374e-03 3 1  ON 114
ci_0066                -5.764886e-03 3 1  ON 115
ci_0067                -4.761355e-03 3 1  ON 116
ci_0068                -5.003041e-03 3 1  ON 117
ci_0069                 4.359714e-03 3 1  ON 118
ci_0070                 4.230438e-03 3 1  ON 119
ci_0071                -9.803006e-05 3 1  ON 120
ci_0072                 4.368134e-04 3 1  ON 121
ci_0073                 4.349539e-03 3 1  ON 122
ci_0074                 4.090658e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 74
    time step          = 0.05
    reference energy   = -16.9388
    reference variance = 0.495215
====================================================
  Execution time = 2.1041e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s074
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3434e-01
  Total weights = 1.9519e+06
  Execution time = 1.9238e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00011989
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321694781378
                                         uncertainty =       0.002000912289

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321694781378
                                         uncertainty =       0.002000912289

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401062836
  error estimate for blocks of size 2^( 2) =       0.000414014625
  error estimate for blocks of size 2^( 3) =       0.000425946393
  error estimate for blocks of size 2^( 4) =       0.000438402188
  error estimate for blocks of size 2^( 5) =       0.000447930933
  error estimate for blocks of size 2^( 6) =       0.000453369759
  error estimate for blocks of size 2^( 7) =       0.000455984602

      target function =                  N/A
              le_mean =     -16.907046166176
             les_mean =     286.182261866848
             stat err =       0.000448921870
             autocorr =       1.252900798874
              std dev =       0.567188502243
             le_variance =       0.321702797076

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 7.94017e-05
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321855895447
                                         uncertainty =       0.001999424462

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321855895447
                                         uncertainty =       0.001999424462

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401162860
  error estimate for blocks of size 2^( 2) =       0.000414099644
  error estimate for blocks of size 2^( 3) =       0.000426013036
  error estimate for blocks of size 2^( 4) =       0.000438466418
  error estimate for blocks of size 2^( 5) =       0.000447986889
  error estimate for blocks of size 2^( 6) =       0.000453445833
  error estimate for blocks of size 2^( 7) =       0.000456067713

      target function =                  N/A
              le_mean =     -16.907041520698
             les_mean =     286.188818315693
             stat err =       0.000448991713
             autocorr =       1.252665778028
              std dev =       0.567329957830
             le_variance =       0.321863281051

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.000119821
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321856629193
                                         uncertainty =       0.002001300622

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321856629193
                                         uncertainty =       0.002001300622

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401163458
  error estimate for blocks of size 2^( 2) =       0.000414100872
  error estimate for blocks of size 2^( 3) =       0.000426019597
  error estimate for blocks of size 2^( 4) =       0.000438473529
  error estimate for blocks of size 2^( 5) =       0.000447995134
  error estimate for blocks of size 2^( 6) =       0.000453446021
  error estimate for blocks of size 2^( 7) =       0.000456068917

      target function =                  N/A
              le_mean =     -16.907042677175
             les_mean =     286.181876315901
             stat err =       0.000448995900
             autocorr =       1.252685407031
              std dev =       0.567330803296
             le_variance =       0.321864240369

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.000187104
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321719015721
                                         uncertainty =       0.002000868745

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321719015721
                                         uncertainty =       0.002000868745

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401077910
  error estimate for blocks of size 2^( 2) =       0.000414027187
  error estimate for blocks of size 2^( 3) =       0.000425956955
  error estimate for blocks of size 2^( 4) =       0.000438412514
  error estimate for blocks of size 2^( 5) =       0.000447939922
  error estimate for blocks of size 2^( 6) =       0.000453380985
  error estimate for blocks of size 2^( 7) =       0.000455996360

      target function =                  N/A
              le_mean =     -16.907044745528
             les_mean =     286.181982435940
             stat err =       0.000448932445
             autocorr =       1.252865648765
              std dev =       0.567209819653
             le_variance =       0.321726979511


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.907046166176        initial  <--
     2.1176e-01     2.1176e+00             9.0826e-04       -16.907041520698
     8.4703e-01     8.4703e+00             3.1066e-04       -16.907042677175
     3.3881e+00     3.3881e+01             8.4850e-05       -16.907044745528

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.7844
  </log>
  <optVariables href="H2O.s074.opt.xml">
   uu_0                 3.131907e-01 1 1  ON 0
   uu_1                 1.455909e-01 1 1  ON 1
   uu_2                 4.336575e-02 1 1  ON 2
   uu_3                -1.980206e-02 1 1  ON 3
   uu_4                -6.660962e-02 1 1  ON 4
   uu_5                -1.030357e-01 1 1  ON 5
   uu_6                -1.322539e-01 1 1  ON 6
   uu_7                -1.479653e-01 1 1  ON 7
   uu_8                -1.413647e-01 1 1  ON 8
   uu_9                -1.139456e-01 1 1  ON 9
   ud_0                 4.516373e-01 1 1  ON 10
   ud_1                 1.857582e-01 1 1  ON 11
   ud_2                 6.518904e-02 1 1  ON 12
   ud_3                -6.068587e-03 1 1  ON 13
   ud_4                -6.373846e-02 1 1  ON 14
   ud_5                -1.062765e-01 1 1  ON 15
   ud_6                -1.349642e-01 1 1  ON 16
   ud_7                -1.530837e-01 1 1  ON 17
   ud_8                -1.549917e-01 1 1  ON 18
   ud_9                -1.457348e-01 1 1  ON 19
   eO_0                -7.486330e-01 1 1  ON 20
   eO_1                -4.276512e-01 1 1  ON 21
   eO_2                -1.610480e-02 1 1  ON 22
   eO_3                 2.978231e-01 1 1  ON 23
   eO_4                 5.259009e-01 1 1  ON 24
   eO_5                 4.903937e-01 1 1  ON 25
   eO_6                 2.635981e-01 1 1  ON 26
   eO_7                -4.211352e-02 1 1  ON 27
   eO_8                -2.366079e-01 1 1  ON 28
   eO_9                -1.026095e-01 1 1  ON 29
  eH1_0                -2.659696e-01 1 1  ON 30
  eH1_1                -1.582705e-01 1 1  ON 31
  eH1_2                -1.081257e-01 1 1  ON 32
  eH1_3                -5.235976e-02 1 1  ON 33
  eH1_4                -1.605802e-03 1 1  ON 34
  eH1_5                 3.479110e-02 1 1  ON 35
  eH1_6                 9.780215e-02 1 1  ON 36
  eH1_7                 1.596896e-01 1 1  ON 37
  eH1_8                 1.971192e-01 1 1  ON 38
  eH1_9                 9.582762e-02 1 1  ON 39
  eH2_0                -2.643150e-01 1 1  ON 40
  eH2_1                -1.565305e-01 1 1  ON 41
  eH2_2                -1.065217e-01 1 1  ON 42
  eH2_3                -5.075867e-02 1 1  ON 43
  eH2_4                -8.950824e-06 1 1  ON 44
  eH2_5                 3.715351e-02 1 1  ON 45
  eH2_6                 9.952694e-02 1 1  ON 46
  eH2_7                 1.613421e-01 1 1  ON 47
  eH2_8                 2.013160e-01 1 1  ON 48
  eH2_9                 8.960701e-02 1 1  ON 49
ci_0001                 7.013820e-01 3 1  ON 50
ci_0002                 7.008370e-01 3 1  ON 51
ci_0003                -2.731667e-02 3 1  ON 52
ci_0004                -2.689653e-02 3 1  ON 53
ci_0005                -3.561063e-02 3 1  ON 54
ci_0006                -3.595496e-02 3 1  ON 55
ci_0007                -2.085019e-02 3 1  ON 56
ci_0008                -2.173923e-02 3 1  ON 57
ci_0009                -1.723901e-02 3 1  ON 58
ci_0010                -1.709715e-02 3 1  ON 59
ci_0011                -1.234988e-02 3 1  ON 60
ci_0012                -1.236463e-02 3 1  ON 61
ci_0013                 1.354934e-02 3 1  ON 62
ci_0014                 1.311077e-02 3 1  ON 63
ci_0015                 1.355453e-02 3 1  ON 64
ci_0016                 1.299031e-02 3 1  ON 65
ci_0017                 1.142153e-02 3 1  ON 66
ci_0018                 1.117492e-02 3 1  ON 67
ci_0019                 1.111870e-02 3 1  ON 68
ci_0020                 1.131149e-02 3 1  ON 69
ci_0021                -2.048795e-03 3 1  ON 70
ci_0022                -7.465652e-04 3 1  ON 71
ci_0023                -1.115148e-02 3 1  ON 72
ci_0024                -1.124495e-02 3 1  ON 73
ci_0025                -1.064898e-02 3 1  ON 74
ci_0026                -1.056974e-02 3 1  ON 75
ci_0027                -1.147999e-02 3 1  ON 76
ci_0028                -1.113644e-02 3 1  ON 77
ci_0029                -1.047462e-02 3 1  ON 78
ci_0030                -1.097072e-02 3 1  ON 79
ci_0031                 2.088644e-02 3 1  ON 80
ci_0032                 2.093496e-02 3 1  ON 81
ci_0033                 9.663230e-03 3 1  ON 82
ci_0034                 9.991392e-03 3 1  ON 83
ci_0035                 6.862996e-03 3 1  ON 84
ci_0036                 6.408378e-03 3 1  ON 85
ci_0037                -1.013181e-02 3 1  ON 86
ci_0038                -1.102394e-02 3 1  ON 87
ci_0039                -2.672395e-03 3 1  ON 88
ci_0040                -2.757461e-03 3 1  ON 89
ci_0041                 7.453155e-03 3 1  ON 90
ci_0042                 6.946048e-03 3 1  ON 91
ci_0043                -1.883159e-02 3 1  ON 92
ci_0044                -1.904899e-02 3 1  ON 93
ci_0045                 7.611164e-03 3 1  ON 94
ci_0046                 7.553717e-03 3 1  ON 95
ci_0047                -1.741009e-03 3 1  ON 96
ci_0048                -2.089157e-03 3 1  ON 97
ci_0049                -5.979483e-03 3 1  ON 98
ci_0050                -5.892106e-03 3 1  ON 99
ci_0051                -3.446526e-03 3 1  ON 100
ci_0052                -3.209389e-03 3 1  ON 101
ci_0053                -4.683823e-03 3 1  ON 102
ci_0054                -4.540273e-03 3 1  ON 103
ci_0055                 6.290719e-03 3 1  ON 104
ci_0056                 6.762894e-03 3 1  ON 105
ci_0057                 4.866250e-03 3 1  ON 106
ci_0058                 4.626403e-03 3 1  ON 107
ci_0059                -4.750229e-03 3 1  ON 108
ci_0060                -4.783833e-03 3 1  ON 109
ci_0061                -3.577842e-03 3 1  ON 110
ci_0062                -3.362098e-03 3 1  ON 111
ci_0063                -8.434582e-03 3 1  ON 112
ci_0064                -8.186034e-03 3 1  ON 113
ci_0065                -5.441582e-03 3 1  ON 114
ci_0066                -5.564188e-03 3 1  ON 115
ci_0067                -4.720494e-03 3 1  ON 116
ci_0068                -5.147168e-03 3 1  ON 117
ci_0069                 4.347520e-03 3 1  ON 118
ci_0070                 4.246633e-03 3 1  ON 119
ci_0071                -1.018347e-04 3 1  ON 120
ci_0072                 4.291612e-04 3 1  ON 121
ci_0073                 4.209809e-03 3 1  ON 122
ci_0074                 4.257792e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8506e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s075 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s075 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=75  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 75
    time step          = 0.05
    reference energy   = -16.8349
    reference variance = 0.166706
====================================================
  Execution time = 2.1040e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s075
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5214e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4002e-01
  Total weights = 1.951426674e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1064e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327233821866
                                         uncertainty =       0.005076249279

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327233821866
                                         uncertainty =       0.005076249279

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404413693
  error estimate for blocks of size 2^( 2) =       0.000417509345
  error estimate for blocks of size 2^( 3) =       0.000430521621
  error estimate for blocks of size 2^( 4) =       0.000442531670
  error estimate for blocks of size 2^( 5) =       0.000453841412
  error estimate for blocks of size 2^( 6) =       0.000462398954
  error estimate for blocks of size 2^( 7) =       0.000467004525

      target function =                  N/A
              le_mean =     -16.906256901929
             les_mean =     286.161541985120
             stat err =       0.000456444140
             autocorr =       1.273865478201
              std dev =       0.571927329357
             le_variance =       0.327100870065


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690625690193e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.1176e+00, overlap shift 2.1176e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906256901900       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906257252367       residual = 5.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906257136192       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906257109240       residual = 8.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906257177209       residual = 3.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906257396328       residual = 2.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906257415794       residual = 5.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906257410924       residual = 2.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906257373306       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906257386132       residual = 3.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.1176e+00 is 1.560241e-04

solving harmonic davidson linear method for identity shift 8.4703e+00, overlap shift 8.4703e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906256901900       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906256995941       residual = 5.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906256966985       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906256960733       residual = 9.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906256978917       residual = 3.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906257040785       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906257044553       residual = 5.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906257043906       residual = 2.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906257035018       residual = 9.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 8.4703e+00 is 4.340573e-05

solving harmonic davidson linear method for identity shift 3.3881e+01, overlap shift 3.3881e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906256901900       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906256925849       residual = 5.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906256918598       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906256917107       residual = 9.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906256921761       residual = 3.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906256937741       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906256938656       residual = 5.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906256938491       residual = 1.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906256936319       residual = 8.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.3881e+01 is 1.116331e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.637423 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7162e+01
  </log>
  <optVariables href="H2O.s075.opt.xml">
   uu_0                 3.131855e-01 1 1  ON 0
   uu_1                 1.455866e-01 1 1  ON 1
   uu_2                 4.336536e-02 1 1  ON 2
   uu_3                -1.979499e-02 1 1  ON 3
   uu_4                -6.661176e-02 1 1  ON 4
   uu_5                -1.030384e-01 1 1  ON 5
   uu_6                -1.322550e-01 1 1  ON 6
   uu_7                -1.479693e-01 1 1  ON 7
   uu_8                -1.413632e-01 1 1  ON 8
   uu_9                -1.139426e-01 1 1  ON 9
   ud_0                 4.516227e-01 1 1  ON 10
   ud_1                 1.857661e-01 1 1  ON 11
   ud_2                 6.519585e-02 1 1  ON 12
   ud_3                -6.066787e-03 1 1  ON 13
   ud_4                -6.374181e-02 1 1  ON 14
   ud_5                -1.062591e-01 1 1  ON 15
   ud_6                -1.349768e-01 1 1  ON 16
   ud_7                -1.530896e-01 1 1  ON 17
   ud_8                -1.549848e-01 1 1  ON 18
   ud_9                -1.457349e-01 1 1  ON 19
   eO_0                -7.486256e-01 1 1  ON 20
   eO_1                -4.276407e-01 1 1  ON 21
   eO_2                -1.611619e-02 1 1  ON 22
   eO_3                 2.978283e-01 1 1  ON 23
   eO_4                 5.258994e-01 1 1  ON 24
   eO_5                 4.904094e-01 1 1  ON 25
   eO_6                 2.635942e-01 1 1  ON 26
   eO_7                -4.211506e-02 1 1  ON 27
   eO_8                -2.366118e-01 1 1  ON 28
   eO_9                -1.026230e-01 1 1  ON 29
  eH1_0                -2.659805e-01 1 1  ON 30
  eH1_1                -1.582763e-01 1 1  ON 31
  eH1_2                -1.081328e-01 1 1  ON 32
  eH1_3                -5.237033e-02 1 1  ON 33
  eH1_4                -1.606443e-03 1 1  ON 34
  eH1_5                 3.478451e-02 1 1  ON 35
  eH1_6                 9.780897e-02 1 1  ON 36
  eH1_7                 1.596951e-01 1 1  ON 37
  eH1_8                 1.971306e-01 1 1  ON 38
  eH1_9                 9.584696e-02 1 1  ON 39
  eH2_0                -2.643171e-01 1 1  ON 40
  eH2_1                -1.565338e-01 1 1  ON 41
  eH2_2                -1.065293e-01 1 1  ON 42
  eH2_3                -5.075774e-02 1 1  ON 43
  eH2_4                -1.748328e-05 1 1  ON 44
  eH2_5                 3.714149e-02 1 1  ON 45
  eH2_6                 9.952210e-02 1 1  ON 46
  eH2_7                 1.613399e-01 1 1  ON 47
  eH2_8                 2.013265e-01 1 1  ON 48
  eH2_9                 8.963098e-02 1 1  ON 49
ci_0001                 7.013821e-01 3 1  ON 50
ci_0002                 7.008350e-01 3 1  ON 51
ci_0003                -2.733298e-02 3 1  ON 52
ci_0004                -2.688893e-02 3 1  ON 53
ci_0005                -3.561947e-02 3 1  ON 54
ci_0006                -3.596432e-02 3 1  ON 55
ci_0007                -2.084810e-02 3 1  ON 56
ci_0008                -2.170535e-02 3 1  ON 57
ci_0009                -1.723233e-02 3 1  ON 58
ci_0010                -1.708697e-02 3 1  ON 59
ci_0011                -1.234129e-02 3 1  ON 60
ci_0012                -1.234747e-02 3 1  ON 61
ci_0013                 1.355652e-02 3 1  ON 62
ci_0014                 1.312408e-02 3 1  ON 63
ci_0015                 1.354809e-02 3 1  ON 64
ci_0016                 1.298584e-02 3 1  ON 65
ci_0017                 1.140035e-02 3 1  ON 66
ci_0018                 1.119773e-02 3 1  ON 67
ci_0019                 1.113244e-02 3 1  ON 68
ci_0020                 1.133798e-02 3 1  ON 69
ci_0021                -2.062078e-03 3 1  ON 70
ci_0022                -7.339659e-04 3 1  ON 71
ci_0023                -1.117350e-02 3 1  ON 72
ci_0024                -1.122520e-02 3 1  ON 73
ci_0025                -1.065698e-02 3 1  ON 74
ci_0026                -1.056067e-02 3 1  ON 75
ci_0027                -1.145688e-02 3 1  ON 76
ci_0028                -1.115302e-02 3 1  ON 77
ci_0029                -1.050317e-02 3 1  ON 78
ci_0030                -1.094094e-02 3 1  ON 79
ci_0031                 2.089132e-02 3 1  ON 80
ci_0032                 2.093615e-02 3 1  ON 81
ci_0033                 9.692411e-03 3 1  ON 82
ci_0034                 1.000200e-02 3 1  ON 83
ci_0035                 6.836054e-03 3 1  ON 84
ci_0036                 6.401492e-03 3 1  ON 85
ci_0037                -1.017070e-02 3 1  ON 86
ci_0038                -1.103177e-02 3 1  ON 87
ci_0039                -2.673605e-03 3 1  ON 88
ci_0040                -2.741585e-03 3 1  ON 89
ci_0041                 7.439469e-03 3 1  ON 90
ci_0042                 6.966108e-03 3 1  ON 91
ci_0043                -1.883125e-02 3 1  ON 92
ci_0044                -1.902787e-02 3 1  ON 93
ci_0045                 7.609472e-03 3 1  ON 94
ci_0046                 7.566154e-03 3 1  ON 95
ci_0047                -1.730155e-03 3 1  ON 96
ci_0048                -2.084833e-03 3 1  ON 97
ci_0049                -5.980649e-03 3 1  ON 98
ci_0050                -5.912289e-03 3 1  ON 99
ci_0051                -3.432422e-03 3 1  ON 100
ci_0052                -3.218390e-03 3 1  ON 101
ci_0053                -4.679569e-03 3 1  ON 102
ci_0054                -4.544602e-03 3 1  ON 103
ci_0055                 6.307217e-03 3 1  ON 104
ci_0056                 6.773157e-03 3 1  ON 105
ci_0057                 4.837224e-03 3 1  ON 106
ci_0058                 4.629283e-03 3 1  ON 107
ci_0059                -4.770620e-03 3 1  ON 108
ci_0060                -4.789476e-03 3 1  ON 109
ci_0061                -3.589292e-03 3 1  ON 110
ci_0062                -3.377785e-03 3 1  ON 111
ci_0063                -8.444518e-03 3 1  ON 112
ci_0064                -8.216861e-03 3 1  ON 113
ci_0065                -5.437733e-03 3 1  ON 114
ci_0066                -5.554581e-03 3 1  ON 115
ci_0067                -4.763900e-03 3 1  ON 116
ci_0068                -5.134975e-03 3 1  ON 117
ci_0069                 4.333795e-03 3 1  ON 118
ci_0070                 4.264023e-03 3 1  ON 119
ci_0071                -1.019577e-04 3 1  ON 120
ci_0072                 4.064387e-04 3 1  ON 121
ci_0073                 4.223466e-03 3 1  ON 122
ci_0074                 4.254983e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 75
    time step          = 0.05
    reference energy   = -16.9396
    reference variance = 0.250315
====================================================
  Execution time = 2.1118e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s075
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3606e-01
  Total weights = 1.9515e+06
  Execution time = 1.9174e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322661570312
                                         uncertainty =       0.002283331425

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322661570312
                                         uncertainty =       0.002283331425

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401813830
  error estimate for blocks of size 2^( 2) =       0.000414722534
  error estimate for blocks of size 2^( 3) =       0.000428468629
  error estimate for blocks of size 2^( 4) =       0.000441060592
  error estimate for blocks of size 2^( 5) =       0.000451536874
  error estimate for blocks of size 2^( 6) =       0.000459254542
  error estimate for blocks of size 2^( 7) =       0.000464119430

      target function =                  N/A
              le_mean =     -16.905791836703
             les_mean =     286.156657316739
             stat err =       0.000453992860
             autocorr =       1.276580727537
              std dev =       0.568250567863
             le_variance =       0.322908707876

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322567711803
                                         uncertainty =       0.002267613509

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322567711803
                                         uncertainty =       0.002267613509

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401755347
  error estimate for blocks of size 2^( 2) =       0.000414662848
  error estimate for blocks of size 2^( 3) =       0.000428407689
  error estimate for blocks of size 2^( 4) =       0.000440998122
  error estimate for blocks of size 2^( 5) =       0.000451475650
  error estimate for blocks of size 2^( 6) =       0.000459193199
  error estimate for blocks of size 2^( 7) =       0.000464058794

      target function =                  N/A
              le_mean =     -16.905790551246
             les_mean =     286.141754059438
             stat err =       0.000453931441
             autocorr =       1.276606932445
              std dev =       0.568167860667
             le_variance =       0.322814717895

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322608227800
                                         uncertainty =       0.002274931080

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322608227800
                                         uncertainty =       0.002274931080

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401780591
  error estimate for blocks of size 2^( 2) =       0.000414688719
  error estimate for blocks of size 2^( 3) =       0.000428434113
  error estimate for blocks of size 2^( 4) =       0.000441025364
  error estimate for blocks of size 2^( 5) =       0.000451502459
  error estimate for blocks of size 2^( 6) =       0.000459219990
  error estimate for blocks of size 2^( 7) =       0.000464085394

      target function =                  N/A
              le_mean =     -16.905790862460
             les_mean =     286.141790666337
             stat err =       0.000453958302
             autocorr =       1.276597586655
              std dev =       0.568203560583
             le_variance =       0.322855286259

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322654504734
                                         uncertainty =       0.002282253481

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322654504734
                                         uncertainty =       0.002282253481

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401809428
  error estimate for blocks of size 2^( 2) =       0.000414718156
  error estimate for blocks of size 2^( 3) =       0.000428464113
  error estimate for blocks of size 2^( 4) =       0.000441056118
  error estimate for blocks of size 2^( 5) =       0.000451532571
  error estimate for blocks of size 2^( 6) =       0.000459250065
  error estimate for blocks of size 2^( 7) =       0.000464115282

      target function =                  N/A
              le_mean =     -16.905791571750
             les_mean =     286.142052000672
             stat err =       0.000453988509
             autocorr =       1.276584233230
              std dev =       0.568244342054
             le_variance =       0.322901632276


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905791836703        initial  <--
     2.1176e+00     2.1176e+01             1.5602e-04       -16.905790551246
     8.4703e+00     8.4703e+01             4.3406e-05       -16.905790862460
     3.3881e+01     3.3881e+02             1.1163e-05       -16.905791571750

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.7999
  </log>
  <optVariables href="H2O.s075.opt.xml">
   uu_0                 3.131907e-01 1 1  ON 0
   uu_1                 1.455909e-01 1 1  ON 1
   uu_2                 4.336575e-02 1 1  ON 2
   uu_3                -1.980206e-02 1 1  ON 3
   uu_4                -6.660962e-02 1 1  ON 4
   uu_5                -1.030357e-01 1 1  ON 5
   uu_6                -1.322539e-01 1 1  ON 6
   uu_7                -1.479653e-01 1 1  ON 7
   uu_8                -1.413647e-01 1 1  ON 8
   uu_9                -1.139456e-01 1 1  ON 9
   ud_0                 4.516373e-01 1 1  ON 10
   ud_1                 1.857582e-01 1 1  ON 11
   ud_2                 6.518904e-02 1 1  ON 12
   ud_3                -6.068587e-03 1 1  ON 13
   ud_4                -6.373846e-02 1 1  ON 14
   ud_5                -1.062765e-01 1 1  ON 15
   ud_6                -1.349642e-01 1 1  ON 16
   ud_7                -1.530837e-01 1 1  ON 17
   ud_8                -1.549917e-01 1 1  ON 18
   ud_9                -1.457348e-01 1 1  ON 19
   eO_0                -7.486330e-01 1 1  ON 20
   eO_1                -4.276512e-01 1 1  ON 21
   eO_2                -1.610480e-02 1 1  ON 22
   eO_3                 2.978231e-01 1 1  ON 23
   eO_4                 5.259009e-01 1 1  ON 24
   eO_5                 4.903937e-01 1 1  ON 25
   eO_6                 2.635981e-01 1 1  ON 26
   eO_7                -4.211352e-02 1 1  ON 27
   eO_8                -2.366079e-01 1 1  ON 28
   eO_9                -1.026095e-01 1 1  ON 29
  eH1_0                -2.659696e-01 1 1  ON 30
  eH1_1                -1.582705e-01 1 1  ON 31
  eH1_2                -1.081257e-01 1 1  ON 32
  eH1_3                -5.235976e-02 1 1  ON 33
  eH1_4                -1.605802e-03 1 1  ON 34
  eH1_5                 3.479110e-02 1 1  ON 35
  eH1_6                 9.780215e-02 1 1  ON 36
  eH1_7                 1.596896e-01 1 1  ON 37
  eH1_8                 1.971192e-01 1 1  ON 38
  eH1_9                 9.582762e-02 1 1  ON 39
  eH2_0                -2.643150e-01 1 1  ON 40
  eH2_1                -1.565305e-01 1 1  ON 41
  eH2_2                -1.065217e-01 1 1  ON 42
  eH2_3                -5.075867e-02 1 1  ON 43
  eH2_4                -8.950824e-06 1 1  ON 44
  eH2_5                 3.715351e-02 1 1  ON 45
  eH2_6                 9.952694e-02 1 1  ON 46
  eH2_7                 1.613421e-01 1 1  ON 47
  eH2_8                 2.013160e-01 1 1  ON 48
  eH2_9                 8.960701e-02 1 1  ON 49
ci_0001                 7.013820e-01 3 1  ON 50
ci_0002                 7.008370e-01 3 1  ON 51
ci_0003                -2.731667e-02 3 1  ON 52
ci_0004                -2.689653e-02 3 1  ON 53
ci_0005                -3.561063e-02 3 1  ON 54
ci_0006                -3.595496e-02 3 1  ON 55
ci_0007                -2.085019e-02 3 1  ON 56
ci_0008                -2.173923e-02 3 1  ON 57
ci_0009                -1.723901e-02 3 1  ON 58
ci_0010                -1.709715e-02 3 1  ON 59
ci_0011                -1.234988e-02 3 1  ON 60
ci_0012                -1.236463e-02 3 1  ON 61
ci_0013                 1.354934e-02 3 1  ON 62
ci_0014                 1.311077e-02 3 1  ON 63
ci_0015                 1.355453e-02 3 1  ON 64
ci_0016                 1.299031e-02 3 1  ON 65
ci_0017                 1.142153e-02 3 1  ON 66
ci_0018                 1.117492e-02 3 1  ON 67
ci_0019                 1.111870e-02 3 1  ON 68
ci_0020                 1.131149e-02 3 1  ON 69
ci_0021                -2.048795e-03 3 1  ON 70
ci_0022                -7.465652e-04 3 1  ON 71
ci_0023                -1.115148e-02 3 1  ON 72
ci_0024                -1.124495e-02 3 1  ON 73
ci_0025                -1.064898e-02 3 1  ON 74
ci_0026                -1.056974e-02 3 1  ON 75
ci_0027                -1.147999e-02 3 1  ON 76
ci_0028                -1.113644e-02 3 1  ON 77
ci_0029                -1.047462e-02 3 1  ON 78
ci_0030                -1.097072e-02 3 1  ON 79
ci_0031                 2.088644e-02 3 1  ON 80
ci_0032                 2.093496e-02 3 1  ON 81
ci_0033                 9.663230e-03 3 1  ON 82
ci_0034                 9.991392e-03 3 1  ON 83
ci_0035                 6.862996e-03 3 1  ON 84
ci_0036                 6.408378e-03 3 1  ON 85
ci_0037                -1.013181e-02 3 1  ON 86
ci_0038                -1.102394e-02 3 1  ON 87
ci_0039                -2.672395e-03 3 1  ON 88
ci_0040                -2.757461e-03 3 1  ON 89
ci_0041                 7.453155e-03 3 1  ON 90
ci_0042                 6.946048e-03 3 1  ON 91
ci_0043                -1.883159e-02 3 1  ON 92
ci_0044                -1.904899e-02 3 1  ON 93
ci_0045                 7.611164e-03 3 1  ON 94
ci_0046                 7.553717e-03 3 1  ON 95
ci_0047                -1.741009e-03 3 1  ON 96
ci_0048                -2.089157e-03 3 1  ON 97
ci_0049                -5.979483e-03 3 1  ON 98
ci_0050                -5.892106e-03 3 1  ON 99
ci_0051                -3.446526e-03 3 1  ON 100
ci_0052                -3.209389e-03 3 1  ON 101
ci_0053                -4.683823e-03 3 1  ON 102
ci_0054                -4.540273e-03 3 1  ON 103
ci_0055                 6.290719e-03 3 1  ON 104
ci_0056                 6.762894e-03 3 1  ON 105
ci_0057                 4.866250e-03 3 1  ON 106
ci_0058                 4.626403e-03 3 1  ON 107
ci_0059                -4.750229e-03 3 1  ON 108
ci_0060                -4.783833e-03 3 1  ON 109
ci_0061                -3.577842e-03 3 1  ON 110
ci_0062                -3.362098e-03 3 1  ON 111
ci_0063                -8.434582e-03 3 1  ON 112
ci_0064                -8.186034e-03 3 1  ON 113
ci_0065                -5.441582e-03 3 1  ON 114
ci_0066                -5.564188e-03 3 1  ON 115
ci_0067                -4.720494e-03 3 1  ON 116
ci_0068                -5.147168e-03 3 1  ON 117
ci_0069                 4.347520e-03 3 1  ON 118
ci_0070                 4.246633e-03 3 1  ON 119
ci_0071                -1.018347e-04 3 1  ON 120
ci_0072                 4.291612e-04 3 1  ON 121
ci_0073                 4.209809e-03 3 1  ON 122
ci_0074                 4.257792e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7984e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s076 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s076 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=76  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 76
    time step          = 0.05
    reference energy   = -16.9055
    reference variance = 0.44228
====================================================
  Execution time = 2.1016e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s076
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5268e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3684e-01
  Total weights = 1.951301655e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1257e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322741854072
                                         uncertainty =       0.001964237655

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322741854072
                                         uncertainty =       0.001964237655

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401761090
  error estimate for blocks of size 2^( 2) =       0.000414868900
  error estimate for blocks of size 2^( 3) =       0.000428109281
  error estimate for blocks of size 2^( 4) =       0.000440575987
  error estimate for blocks of size 2^( 5) =       0.000452186129
  error estimate for blocks of size 2^( 6) =       0.000460926860
  error estimate for blocks of size 2^( 7) =       0.000469346608

      target function =                  N/A
              le_mean =     -16.905903093445
             les_mean =     286.146397212822
             stat err =       0.000455758896
             autocorr =       1.286869661497
              std dev =       0.568175981797
             le_variance =       0.322823946291


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690590309344e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.1176e+01, overlap shift 2.1176e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905903093419       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905903165344       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905903157355       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905903207981       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905903198319       residual = 5.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905903206058       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905903202131       residual = 7.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905903201849       residual = 2.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905903198747       residual = 8.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.1176e+01 is 1.644687e-05

solving harmonic davidson linear method for identity shift 8.4703e+01, overlap shift 8.4703e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905903093419       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905903111533       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905903109553       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905903122327       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905903119979       residual = 5.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905903121992       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905903121042       residual = 7.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905903120931       residual = 2.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905903120213       residual = 8.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 8.4703e+01 is 4.142343e-06

solving harmonic davidson linear method for identity shift 3.3881e+02, overlap shift 3.3881e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905903093419       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905903097956       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905903097462       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905903100663       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905903100080       residual = 5.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905903100589       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905903100353       residual = 7.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905903100324       residual = 2.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905903100147       residual = 8.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.3881e+02 is 1.037522e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.645367 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7157e+01
  </log>
  <optVariables href="H2O.s076.opt.xml">
   uu_0                 3.131908e-01 1 1  ON 0
   uu_1                 1.455897e-01 1 1  ON 1
   uu_2                 4.336529e-02 1 1  ON 2
   uu_3                -1.980278e-02 1 1  ON 3
   uu_4                -6.660862e-02 1 1  ON 4
   uu_5                -1.030361e-01 1 1  ON 5
   uu_6                -1.322550e-01 1 1  ON 6
   uu_7                -1.479660e-01 1 1  ON 7
   uu_8                -1.413635e-01 1 1  ON 8
   uu_9                -1.139449e-01 1 1  ON 9
   ud_0                 4.516380e-01 1 1  ON 10
   ud_1                 1.857578e-01 1 1  ON 11
   ud_2                 6.518720e-02 1 1  ON 12
   ud_3                -6.068986e-03 1 1  ON 13
   ud_4                -6.373913e-02 1 1  ON 14
   ud_5                -1.062765e-01 1 1  ON 15
   ud_6                -1.349653e-01 1 1  ON 16
   ud_7                -1.530826e-01 1 1  ON 17
   ud_8                -1.549903e-01 1 1  ON 18
   ud_9                -1.457340e-01 1 1  ON 19
   eO_0                -7.486341e-01 1 1  ON 20
   eO_1                -4.276485e-01 1 1  ON 21
   eO_2                -1.610429e-02 1 1  ON 22
   eO_3                 2.978226e-01 1 1  ON 23
   eO_4                 5.259002e-01 1 1  ON 24
   eO_5                 4.903943e-01 1 1  ON 25
   eO_6                 2.635976e-01 1 1  ON 26
   eO_7                -4.211301e-02 1 1  ON 27
   eO_8                -2.366080e-01 1 1  ON 28
   eO_9                -1.026107e-01 1 1  ON 29
  eH1_0                -2.659709e-01 1 1  ON 30
  eH1_1                -1.582711e-01 1 1  ON 31
  eH1_2                -1.081261e-01 1 1  ON 32
  eH1_3                -5.235969e-02 1 1  ON 33
  eH1_4                -1.606641e-03 1 1  ON 34
  eH1_5                 3.479089e-02 1 1  ON 35
  eH1_6                 9.780213e-02 1 1  ON 36
  eH1_7                 1.596901e-01 1 1  ON 37
  eH1_8                 1.971200e-01 1 1  ON 38
  eH1_9                 9.582942e-02 1 1  ON 39
  eH2_0                -2.643155e-01 1 1  ON 40
  eH2_1                -1.565306e-01 1 1  ON 41
  eH2_2                -1.065215e-01 1 1  ON 42
  eH2_3                -5.075837e-02 1 1  ON 43
  eH2_4                -9.955844e-06 1 1  ON 44
  eH2_5                 3.715169e-02 1 1  ON 45
  eH2_6                 9.952564e-02 1 1  ON 46
  eH2_7                 1.613419e-01 1 1  ON 47
  eH2_8                 2.013172e-01 1 1  ON 48
  eH2_9                 8.960966e-02 1 1  ON 49
ci_0001                 7.013815e-01 3 1  ON 50
ci_0002                 7.008374e-01 3 1  ON 51
ci_0003                -2.731668e-02 3 1  ON 52
ci_0004                -2.689637e-02 3 1  ON 53
ci_0005                -3.561133e-02 3 1  ON 54
ci_0006                -3.595469e-02 3 1  ON 55
ci_0007                -2.084980e-02 3 1  ON 56
ci_0008                -2.174223e-02 3 1  ON 57
ci_0009                -1.723558e-02 3 1  ON 58
ci_0010                -1.709775e-02 3 1  ON 59
ci_0011                -1.234877e-02 3 1  ON 60
ci_0012                -1.236292e-02 3 1  ON 61
ci_0013                 1.355128e-02 3 1  ON 62
ci_0014                 1.311147e-02 3 1  ON 63
ci_0015                 1.355039e-02 3 1  ON 64
ci_0016                 1.299072e-02 3 1  ON 65
ci_0017                 1.142400e-02 3 1  ON 66
ci_0018                 1.117348e-02 3 1  ON 67
ci_0019                 1.112155e-02 3 1  ON 68
ci_0020                 1.131203e-02 3 1  ON 69
ci_0021                -2.050734e-03 3 1  ON 70
ci_0022                -7.458912e-04 3 1  ON 71
ci_0023                -1.115000e-02 3 1  ON 72
ci_0024                -1.124374e-02 3 1  ON 73
ci_0025                -1.065059e-02 3 1  ON 74
ci_0026                -1.056953e-02 3 1  ON 75
ci_0027                -1.147893e-02 3 1  ON 76
ci_0028                -1.113554e-02 3 1  ON 77
ci_0029                -1.047523e-02 3 1  ON 78
ci_0030                -1.096831e-02 3 1  ON 79
ci_0031                 2.088303e-02 3 1  ON 80
ci_0032                 2.093589e-02 3 1  ON 81
ci_0033                 9.665969e-03 3 1  ON 82
ci_0034                 9.993825e-03 3 1  ON 83
ci_0035                 6.863052e-03 3 1  ON 84
ci_0036                 6.410667e-03 3 1  ON 85
ci_0037                -1.013504e-02 3 1  ON 86
ci_0038                -1.102237e-02 3 1  ON 87
ci_0039                -2.673405e-03 3 1  ON 88
ci_0040                -2.755703e-03 3 1  ON 89
ci_0041                 7.453083e-03 3 1  ON 90
ci_0042                 6.944927e-03 3 1  ON 91
ci_0043                -1.883225e-02 3 1  ON 92
ci_0044                -1.905011e-02 3 1  ON 93
ci_0045                 7.610626e-03 3 1  ON 94
ci_0046                 7.553112e-03 3 1  ON 95
ci_0047                -1.741113e-03 3 1  ON 96
ci_0048                -2.089291e-03 3 1  ON 97
ci_0049                -5.978378e-03 3 1  ON 98
ci_0050                -5.893759e-03 3 1  ON 99
ci_0051                -3.446208e-03 3 1  ON 100
ci_0052                -3.209043e-03 3 1  ON 101
ci_0053                -4.686532e-03 3 1  ON 102
ci_0054                -4.539271e-03 3 1  ON 103
ci_0055                 6.290590e-03 3 1  ON 104
ci_0056                 6.761431e-03 3 1  ON 105
ci_0057                 4.865843e-03 3 1  ON 106
ci_0058                 4.629757e-03 3 1  ON 107
ci_0059                -4.752487e-03 3 1  ON 108
ci_0060                -4.786676e-03 3 1  ON 109
ci_0061                -3.578316e-03 3 1  ON 110
ci_0062                -3.363932e-03 3 1  ON 111
ci_0063                -8.437685e-03 3 1  ON 112
ci_0064                -8.182968e-03 3 1  ON 113
ci_0065                -5.440785e-03 3 1  ON 114
ci_0066                -5.562889e-03 3 1  ON 115
ci_0067                -4.722376e-03 3 1  ON 116
ci_0068                -5.144450e-03 3 1  ON 117
ci_0069                 4.347546e-03 3 1  ON 118
ci_0070                 4.244639e-03 3 1  ON 119
ci_0071                -1.016382e-04 3 1  ON 120
ci_0072                 4.282409e-04 3 1  ON 121
ci_0073                 4.208810e-03 3 1  ON 122
ci_0074                 4.257854e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 76
    time step          = 0.05
    reference energy   = -16.8399
    reference variance = 0.211881
====================================================
  Execution time = 2.0930e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s076
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3352e-01
  Total weights = 1.9519e+06
  Execution time = 1.9302e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322302185562
                                         uncertainty =       0.002368050430

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322302185562
                                         uncertainty =       0.002368050430

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401499204
  error estimate for blocks of size 2^( 2) =       0.000414427037
  error estimate for blocks of size 2^( 3) =       0.000427137096
  error estimate for blocks of size 2^( 4) =       0.000438833166
  error estimate for blocks of size 2^( 5) =       0.000447759713
  error estimate for blocks of size 2^( 6) =       0.000454408555
  error estimate for blocks of size 2^( 7) =       0.000461548001

      target function =                  N/A
              le_mean =     -16.905756214853
             les_mean =     286.138105183490
             stat err =       0.000450637359
             autocorr =       1.259751860257
              std dev =       0.567805619564
             le_variance =       0.322403221608

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322308855786
                                         uncertainty =       0.002367826888

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322308855786
                                         uncertainty =       0.002367826888

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401503364
  error estimate for blocks of size 2^( 2) =       0.000414431011
  error estimate for blocks of size 2^( 3) =       0.000427141086
  error estimate for blocks of size 2^( 4) =       0.000438836841
  error estimate for blocks of size 2^( 5) =       0.000447763462
  error estimate for blocks of size 2^( 6) =       0.000454412256
  error estimate for blocks of size 2^( 7) =       0.000461551436

      target function =                  N/A
              le_mean =     -16.905756116229
             les_mean =     286.138128989771
             stat err =       0.000450640999
             autocorr =       1.259746105213
              std dev =       0.567811503267
             le_variance =       0.322409903243

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322305542008
                                         uncertainty =       0.002367938170

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322305542008
                                         uncertainty =       0.002367938170

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401501298
  error estimate for blocks of size 2^( 2) =       0.000414429036
  error estimate for blocks of size 2^( 3) =       0.000427139102
  error estimate for blocks of size 2^( 4) =       0.000438835013
  error estimate for blocks of size 2^( 5) =       0.000447761597
  error estimate for blocks of size 2^( 6) =       0.000454410416
  error estimate for blocks of size 2^( 7) =       0.000461549730

      target function =                  N/A
              le_mean =     -16.905756163587
             les_mean =     286.138114316434
             stat err =       0.000450639189
             autocorr =       1.259748957374
              std dev =       0.567808580270
             le_variance =       0.322406583829

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322302604580
                                         uncertainty =       0.002368036358

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322302604580
                                         uncertainty =       0.002368036358

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401499465
  error estimate for blocks of size 2^( 2) =       0.000414427286
  error estimate for blocks of size 2^( 3) =       0.000427137346
  error estimate for blocks of size 2^( 4) =       0.000438833396
  error estimate for blocks of size 2^( 5) =       0.000447759948
  error estimate for blocks of size 2^( 6) =       0.000454408787
  error estimate for blocks of size 2^( 7) =       0.000461548217

      target function =                  N/A
              le_mean =     -16.905756208198
             les_mean =     286.138105863477
             stat err =       0.000450637587
             autocorr =       1.259751497624
              std dev =       0.567805989182
             le_variance =       0.322403641351


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905756214853        initial  <--
     2.1176e+01     2.1176e+02             1.6447e-05       -16.905756116229
     8.4703e+01     8.4703e+02             4.1423e-06       -16.905756163587
     3.3881e+02     3.3881e+03             1.0375e-06       -16.905756208198

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 33.2472
  </log>
  <optVariables href="H2O.s076.opt.xml">
   uu_0                 3.131907e-01 1 1  ON 0
   uu_1                 1.455909e-01 1 1  ON 1
   uu_2                 4.336575e-02 1 1  ON 2
   uu_3                -1.980206e-02 1 1  ON 3
   uu_4                -6.660962e-02 1 1  ON 4
   uu_5                -1.030357e-01 1 1  ON 5
   uu_6                -1.322539e-01 1 1  ON 6
   uu_7                -1.479653e-01 1 1  ON 7
   uu_8                -1.413647e-01 1 1  ON 8
   uu_9                -1.139456e-01 1 1  ON 9
   ud_0                 4.516373e-01 1 1  ON 10
   ud_1                 1.857582e-01 1 1  ON 11
   ud_2                 6.518904e-02 1 1  ON 12
   ud_3                -6.068587e-03 1 1  ON 13
   ud_4                -6.373846e-02 1 1  ON 14
   ud_5                -1.062765e-01 1 1  ON 15
   ud_6                -1.349642e-01 1 1  ON 16
   ud_7                -1.530837e-01 1 1  ON 17
   ud_8                -1.549917e-01 1 1  ON 18
   ud_9                -1.457348e-01 1 1  ON 19
   eO_0                -7.486330e-01 1 1  ON 20
   eO_1                -4.276512e-01 1 1  ON 21
   eO_2                -1.610480e-02 1 1  ON 22
   eO_3                 2.978231e-01 1 1  ON 23
   eO_4                 5.259009e-01 1 1  ON 24
   eO_5                 4.903937e-01 1 1  ON 25
   eO_6                 2.635981e-01 1 1  ON 26
   eO_7                -4.211352e-02 1 1  ON 27
   eO_8                -2.366079e-01 1 1  ON 28
   eO_9                -1.026095e-01 1 1  ON 29
  eH1_0                -2.659696e-01 1 1  ON 30
  eH1_1                -1.582705e-01 1 1  ON 31
  eH1_2                -1.081257e-01 1 1  ON 32
  eH1_3                -5.235976e-02 1 1  ON 33
  eH1_4                -1.605802e-03 1 1  ON 34
  eH1_5                 3.479110e-02 1 1  ON 35
  eH1_6                 9.780215e-02 1 1  ON 36
  eH1_7                 1.596896e-01 1 1  ON 37
  eH1_8                 1.971192e-01 1 1  ON 38
  eH1_9                 9.582762e-02 1 1  ON 39
  eH2_0                -2.643150e-01 1 1  ON 40
  eH2_1                -1.565305e-01 1 1  ON 41
  eH2_2                -1.065217e-01 1 1  ON 42
  eH2_3                -5.075867e-02 1 1  ON 43
  eH2_4                -8.950824e-06 1 1  ON 44
  eH2_5                 3.715351e-02 1 1  ON 45
  eH2_6                 9.952694e-02 1 1  ON 46
  eH2_7                 1.613421e-01 1 1  ON 47
  eH2_8                 2.013160e-01 1 1  ON 48
  eH2_9                 8.960701e-02 1 1  ON 49
ci_0001                 7.013820e-01 3 1  ON 50
ci_0002                 7.008370e-01 3 1  ON 51
ci_0003                -2.731667e-02 3 1  ON 52
ci_0004                -2.689653e-02 3 1  ON 53
ci_0005                -3.561063e-02 3 1  ON 54
ci_0006                -3.595496e-02 3 1  ON 55
ci_0007                -2.085019e-02 3 1  ON 56
ci_0008                -2.173923e-02 3 1  ON 57
ci_0009                -1.723901e-02 3 1  ON 58
ci_0010                -1.709715e-02 3 1  ON 59
ci_0011                -1.234988e-02 3 1  ON 60
ci_0012                -1.236463e-02 3 1  ON 61
ci_0013                 1.354934e-02 3 1  ON 62
ci_0014                 1.311077e-02 3 1  ON 63
ci_0015                 1.355453e-02 3 1  ON 64
ci_0016                 1.299031e-02 3 1  ON 65
ci_0017                 1.142153e-02 3 1  ON 66
ci_0018                 1.117492e-02 3 1  ON 67
ci_0019                 1.111870e-02 3 1  ON 68
ci_0020                 1.131149e-02 3 1  ON 69
ci_0021                -2.048795e-03 3 1  ON 70
ci_0022                -7.465652e-04 3 1  ON 71
ci_0023                -1.115148e-02 3 1  ON 72
ci_0024                -1.124495e-02 3 1  ON 73
ci_0025                -1.064898e-02 3 1  ON 74
ci_0026                -1.056974e-02 3 1  ON 75
ci_0027                -1.147999e-02 3 1  ON 76
ci_0028                -1.113644e-02 3 1  ON 77
ci_0029                -1.047462e-02 3 1  ON 78
ci_0030                -1.097072e-02 3 1  ON 79
ci_0031                 2.088644e-02 3 1  ON 80
ci_0032                 2.093496e-02 3 1  ON 81
ci_0033                 9.663230e-03 3 1  ON 82
ci_0034                 9.991392e-03 3 1  ON 83
ci_0035                 6.862996e-03 3 1  ON 84
ci_0036                 6.408378e-03 3 1  ON 85
ci_0037                -1.013181e-02 3 1  ON 86
ci_0038                -1.102394e-02 3 1  ON 87
ci_0039                -2.672395e-03 3 1  ON 88
ci_0040                -2.757461e-03 3 1  ON 89
ci_0041                 7.453155e-03 3 1  ON 90
ci_0042                 6.946048e-03 3 1  ON 91
ci_0043                -1.883159e-02 3 1  ON 92
ci_0044                -1.904899e-02 3 1  ON 93
ci_0045                 7.611164e-03 3 1  ON 94
ci_0046                 7.553717e-03 3 1  ON 95
ci_0047                -1.741009e-03 3 1  ON 96
ci_0048                -2.089157e-03 3 1  ON 97
ci_0049                -5.979483e-03 3 1  ON 98
ci_0050                -5.892106e-03 3 1  ON 99
ci_0051                -3.446526e-03 3 1  ON 100
ci_0052                -3.209389e-03 3 1  ON 101
ci_0053                -4.683823e-03 3 1  ON 102
ci_0054                -4.540273e-03 3 1  ON 103
ci_0055                 6.290719e-03 3 1  ON 104
ci_0056                 6.762894e-03 3 1  ON 105
ci_0057                 4.866250e-03 3 1  ON 106
ci_0058                 4.626403e-03 3 1  ON 107
ci_0059                -4.750229e-03 3 1  ON 108
ci_0060                -4.783833e-03 3 1  ON 109
ci_0061                -3.577842e-03 3 1  ON 110
ci_0062                -3.362098e-03 3 1  ON 111
ci_0063                -8.434582e-03 3 1  ON 112
ci_0064                -8.186034e-03 3 1  ON 113
ci_0065                -5.441582e-03 3 1  ON 114
ci_0066                -5.564188e-03 3 1  ON 115
ci_0067                -4.720494e-03 3 1  ON 116
ci_0068                -5.147168e-03 3 1  ON 117
ci_0069                 4.347520e-03 3 1  ON 118
ci_0070                 4.246633e-03 3 1  ON 119
ci_0071                -1.018347e-04 3 1  ON 120
ci_0072                 4.291612e-04 3 1  ON 121
ci_0073                 4.209809e-03 3 1  ON 122
ci_0074                 4.257792e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.0425e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s077 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s077 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=77  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 77
    time step          = 0.05
    reference energy   = -17.0014
    reference variance = 0.221616
====================================================
  Execution time = 2.0996e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s077
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5255e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3119e-01
  Total weights = 1.951869937e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0592e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320473527122
                                         uncertainty =       0.002215616513

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320473527122
                                         uncertainty =       0.002215616513

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400267752
  error estimate for blocks of size 2^( 2) =       0.000413033713
  error estimate for blocks of size 2^( 3) =       0.000426483540
  error estimate for blocks of size 2^( 4) =       0.000439037100
  error estimate for blocks of size 2^( 5) =       0.000449539480
  error estimate for blocks of size 2^( 6) =       0.000458060914
  error estimate for blocks of size 2^( 7) =       0.000461594496

      target function =                  N/A
              le_mean =     -16.905701588714
             les_mean =     286.133939050893
             stat err =       0.000452057997
             autocorr =       1.275519520595
              std dev =       0.566064083306
             le_variance =       0.320428546410


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690570158871e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.1176e+02, overlap shift 2.1176e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905701588698       residual = 9.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905701600258       residual = 3.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905701604645       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905701603293       residual = 4.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905701604920       residual = 4.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905701606316       residual = 2.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905701605242       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905701605335       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905701605227       residual = 6.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.1176e+02 is 1.415058e-06

solving harmonic davidson linear method for identity shift 8.4703e+02, overlap shift 8.4703e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905701588698       residual = 9.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905701591590       residual = 3.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905701592688       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905701592349       residual = 4.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905701592755       residual = 4.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905701593105       residual = 2.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905701592837       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905701592859       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905701592832       residual = 6.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 8.4703e+02 is 3.541381e-07

solving harmonic davidson linear method for identity shift 3.3881e+03, overlap shift 3.3881e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905701588698       residual = 9.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905701589421       residual = 3.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905701589696       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905701589611       residual = 4.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905701589712       residual = 4.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905701589800       residual = 2.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905701589735       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905701589749       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905701589732       residual = 6.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.3881e+03 is 8.855792e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.653403 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7070e+01
  </log>
  <optVariables href="H2O.s077.opt.xml">
   uu_0                 3.131907e-01 1 1  ON 0
   uu_1                 1.455910e-01 1 1  ON 1
   uu_2                 4.336573e-02 1 1  ON 2
   uu_3                -1.980208e-02 1 1  ON 3
   uu_4                -6.660962e-02 1 1  ON 4
   uu_5                -1.030357e-01 1 1  ON 5
   uu_6                -1.322539e-01 1 1  ON 6
   uu_7                -1.479653e-01 1 1  ON 7
   uu_8                -1.413648e-01 1 1  ON 8
   uu_9                -1.139456e-01 1 1  ON 9
   ud_0                 4.516375e-01 1 1  ON 10
   ud_1                 1.857583e-01 1 1  ON 11
   ud_2                 6.518907e-02 1 1  ON 12
   ud_3                -6.068695e-03 1 1  ON 13
   ud_4                -6.373841e-02 1 1  ON 14
   ud_5                -1.062765e-01 1 1  ON 15
   ud_6                -1.349642e-01 1 1  ON 16
   ud_7                -1.530836e-01 1 1  ON 17
   ud_8                -1.549918e-01 1 1  ON 18
   ud_9                -1.457350e-01 1 1  ON 19
   eO_0                -7.486330e-01 1 1  ON 20
   eO_1                -4.276511e-01 1 1  ON 21
   eO_2                -1.610474e-02 1 1  ON 22
   eO_3                 2.978232e-01 1 1  ON 23
   eO_4                 5.259009e-01 1 1  ON 24
   eO_5                 4.903937e-01 1 1  ON 25
   eO_6                 2.635981e-01 1 1  ON 26
   eO_7                -4.211349e-02 1 1  ON 27
   eO_8                -2.366080e-01 1 1  ON 28
   eO_9                -1.026097e-01 1 1  ON 29
  eH1_0                -2.659698e-01 1 1  ON 30
  eH1_1                -1.582704e-01 1 1  ON 31
  eH1_2                -1.081257e-01 1 1  ON 32
  eH1_3                -5.235982e-02 1 1  ON 33
  eH1_4                -1.605914e-03 1 1  ON 34
  eH1_5                 3.479111e-02 1 1  ON 35
  eH1_6                 9.780216e-02 1 1  ON 36
  eH1_7                 1.596896e-01 1 1  ON 37
  eH1_8                 1.971193e-01 1 1  ON 38
  eH1_9                 9.582781e-02 1 1  ON 39
  eH2_0                -2.643150e-01 1 1  ON 40
  eH2_1                -1.565307e-01 1 1  ON 41
  eH2_2                -1.065216e-01 1 1  ON 42
  eH2_3                -5.075869e-02 1 1  ON 43
  eH2_4                -8.948625e-06 1 1  ON 44
  eH2_5                 3.715347e-02 1 1  ON 45
  eH2_6                 9.952691e-02 1 1  ON 46
  eH2_7                 1.613421e-01 1 1  ON 47
  eH2_8                 2.013161e-01 1 1  ON 48
  eH2_9                 8.960718e-02 1 1  ON 49
ci_0001                 7.013821e-01 3 1  ON 50
ci_0002                 7.008369e-01 3 1  ON 51
ci_0003                -2.731661e-02 3 1  ON 52
ci_0004                -2.689657e-02 3 1  ON 53
ci_0005                -3.561078e-02 3 1  ON 54
ci_0006                -3.595527e-02 3 1  ON 55
ci_0007                -2.085030e-02 3 1  ON 56
ci_0008                -2.173910e-02 3 1  ON 57
ci_0009                -1.723895e-02 3 1  ON 58
ci_0010                -1.709711e-02 3 1  ON 59
ci_0011                -1.234974e-02 3 1  ON 60
ci_0012                -1.236452e-02 3 1  ON 61
ci_0013                 1.354940e-02 3 1  ON 62
ci_0014                 1.311073e-02 3 1  ON 63
ci_0015                 1.355430e-02 3 1  ON 64
ci_0016                 1.299034e-02 3 1  ON 65
ci_0017                 1.142154e-02 3 1  ON 66
ci_0018                 1.117485e-02 3 1  ON 67
ci_0019                 1.111878e-02 3 1  ON 68
ci_0020                 1.131149e-02 3 1  ON 69
ci_0021                -2.048807e-03 3 1  ON 70
ci_0022                -7.467417e-04 3 1  ON 71
ci_0023                -1.115178e-02 3 1  ON 72
ci_0024                -1.124482e-02 3 1  ON 73
ci_0025                -1.064896e-02 3 1  ON 74
ci_0026                -1.056966e-02 3 1  ON 75
ci_0027                -1.147993e-02 3 1  ON 76
ci_0028                -1.113654e-02 3 1  ON 77
ci_0029                -1.047460e-02 3 1  ON 78
ci_0030                -1.097076e-02 3 1  ON 79
ci_0031                 2.088632e-02 3 1  ON 80
ci_0032                 2.093492e-02 3 1  ON 81
ci_0033                 9.663366e-03 3 1  ON 82
ci_0034                 9.991400e-03 3 1  ON 83
ci_0035                 6.863095e-03 3 1  ON 84
ci_0036                 6.408587e-03 3 1  ON 85
ci_0037                -1.013203e-02 3 1  ON 86
ci_0038                -1.102384e-02 3 1  ON 87
ci_0039                -2.672194e-03 3 1  ON 88
ci_0040                -2.757267e-03 3 1  ON 89
ci_0041                 7.452890e-03 3 1  ON 90
ci_0042                 6.946371e-03 3 1  ON 91
ci_0043                -1.883163e-02 3 1  ON 92
ci_0044                -1.904906e-02 3 1  ON 93
ci_0045                 7.611107e-03 3 1  ON 94
ci_0046                 7.553769e-03 3 1  ON 95
ci_0047                -1.740913e-03 3 1  ON 96
ci_0048                -2.089016e-03 3 1  ON 97
ci_0049                -5.979562e-03 3 1  ON 98
ci_0050                -5.892206e-03 3 1  ON 99
ci_0051                -3.446605e-03 3 1  ON 100
ci_0052                -3.209528e-03 3 1  ON 101
ci_0053                -4.683699e-03 3 1  ON 102
ci_0054                -4.540035e-03 3 1  ON 103
ci_0055                 6.290722e-03 3 1  ON 104
ci_0056                 6.762728e-03 3 1  ON 105
ci_0057                 4.866012e-03 3 1  ON 106
ci_0058                 4.626546e-03 3 1  ON 107
ci_0059                -4.750055e-03 3 1  ON 108
ci_0060                -4.783743e-03 3 1  ON 109
ci_0061                -3.577679e-03 3 1  ON 110
ci_0062                -3.362100e-03 3 1  ON 111
ci_0063                -8.434937e-03 3 1  ON 112
ci_0064                -8.185966e-03 3 1  ON 113
ci_0065                -5.441575e-03 3 1  ON 114
ci_0066                -5.564128e-03 3 1  ON 115
ci_0067                -4.720559e-03 3 1  ON 116
ci_0068                -5.146914e-03 3 1  ON 117
ci_0069                 4.347775e-03 3 1  ON 118
ci_0070                 4.246762e-03 3 1  ON 119
ci_0071                -1.019601e-04 3 1  ON 120
ci_0072                 4.291166e-04 3 1  ON 121
ci_0073                 4.209987e-03 3 1  ON 122
ci_0074                 4.257655e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 77
    time step          = 0.05
    reference energy   = -16.8661
    reference variance = 0.188016
====================================================
  Execution time = 2.0943e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s077
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3826e-01
  Total weights = 1.9512e+06
  Execution time = 1.9396e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319615784007
                                         uncertainty =       0.001893089045

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319615784007
                                         uncertainty =       0.001893089045

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399951138
  error estimate for blocks of size 2^( 2) =       0.000413075006
  error estimate for blocks of size 2^( 3) =       0.000426403838
  error estimate for blocks of size 2^( 4) =       0.000439192619
  error estimate for blocks of size 2^( 5) =       0.000451773155
  error estimate for blocks of size 2^( 6) =       0.000460456086
  error estimate for blocks of size 2^( 7) =       0.000469054594

      target function =                  N/A
              le_mean =     -16.906170631052
             les_mean =     286.156865738305
             stat err =       0.000455119114
             autocorr =       1.294900136880
              std dev =       0.565616323378
             le_variance =       0.319921825272

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319615935868
                                         uncertainty =       0.001893111027

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319615935868
                                         uncertainty =       0.001893111027

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399951245
  error estimate for blocks of size 2^( 2) =       0.000413075094
  error estimate for blocks of size 2^( 3) =       0.000426403899
  error estimate for blocks of size 2^( 4) =       0.000439192694
  error estimate for blocks of size 2^( 5) =       0.000451773259
  error estimate for blocks of size 2^( 6) =       0.000460456149
  error estimate for blocks of size 2^( 7) =       0.000469054674

      target function =                  N/A
              le_mean =     -16.906170641474
             les_mean =     286.156868143367
             stat err =       0.000455119194
             autocorr =       1.294899897298
              std dev =       0.565616475382
             le_variance =       0.319921997224

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319615859587
                                         uncertainty =       0.001893100045

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319615859587
                                         uncertainty =       0.001893100045

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399951191
  error estimate for blocks of size 2^( 2) =       0.000413075050
  error estimate for blocks of size 2^( 3) =       0.000426403868
  error estimate for blocks of size 2^( 4) =       0.000439192657
  error estimate for blocks of size 2^( 5) =       0.000451773207
  error estimate for blocks of size 2^( 6) =       0.000460456117
  error estimate for blocks of size 2^( 7) =       0.000469054634

      target function =                  N/A
              le_mean =     -16.906170636251
             les_mean =     286.156866925947
             stat err =       0.000455119154
             autocorr =       1.294900017415
              std dev =       0.565616399078
             le_variance =       0.319921910906

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319615793435
                                         uncertainty =       0.001893090421

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319615793435
                                         uncertainty =       0.001893090421

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399951144
  error estimate for blocks of size 2^( 2) =       0.000413075012
  error estimate for blocks of size 2^( 3) =       0.000426403842
  error estimate for blocks of size 2^( 4) =       0.000439192624
  error estimate for blocks of size 2^( 5) =       0.000451773161
  error estimate for blocks of size 2^( 6) =       0.000460456090
  error estimate for blocks of size 2^( 7) =       0.000469054599

      target function =                  N/A
              le_mean =     -16.906170631700
             les_mean =     286.156865885175
             stat err =       0.000455119119
             autocorr =       1.294900121960
              std dev =       0.565616332824
             le_variance =       0.319921835957


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906170631052        initial
     2.1176e+02     2.1176e+03             1.4151e-06       -16.906170641474  <--
     8.4703e+02     8.4703e+03             3.5414e-07       -16.906170636251
     3.3881e+03     3.3881e+04             8.8558e-08       -16.906170631700

*****************************************************************************
Applying the update for shift_i =   2.1176e+02     and shift_s =   2.1176e+03
*****************************************************************************

  Execution time = 3.0649e+01
  </log>
  <optVariables href="H2O.s077.opt.xml">
   uu_0                 3.131908e-01 1 1  ON 0
   uu_1                 1.455912e-01 1 1  ON 1
   uu_2                 4.336567e-02 1 1  ON 2
   uu_3                -1.980214e-02 1 1  ON 3
   uu_4                -6.660962e-02 1 1  ON 4
   uu_5                -1.030357e-01 1 1  ON 5
   uu_6                -1.322540e-01 1 1  ON 6
   uu_7                -1.479652e-01 1 1  ON 7
   uu_8                -1.413651e-01 1 1  ON 8
   uu_9                -1.139459e-01 1 1  ON 9
   ud_0                 4.516379e-01 1 1  ON 10
   ud_1                 1.857588e-01 1 1  ON 11
   ud_2                 6.518917e-02 1 1  ON 12
   ud_3                -6.069016e-03 1 1  ON 13
   ud_4                -6.373825e-02 1 1  ON 14
   ud_5                -1.062764e-01 1 1  ON 15
   ud_6                -1.349642e-01 1 1  ON 16
   ud_7                -1.530834e-01 1 1  ON 17
   ud_8                -1.549920e-01 1 1  ON 18
   ud_9                -1.457355e-01 1 1  ON 19
   eO_0                -7.486329e-01 1 1  ON 20
   eO_1                -4.276510e-01 1 1  ON 21
   eO_2                -1.610454e-02 1 1  ON 22
   eO_3                 2.978234e-01 1 1  ON 23
   eO_4                 5.259011e-01 1 1  ON 24
   eO_5                 4.903936e-01 1 1  ON 25
   eO_6                 2.635983e-01 1 1  ON 26
   eO_7                -4.211341e-02 1 1  ON 27
   eO_8                -2.366083e-01 1 1  ON 28
   eO_9                -1.026102e-01 1 1  ON 29
  eH1_0                -2.659704e-01 1 1  ON 30
  eH1_1                -1.582701e-01 1 1  ON 31
  eH1_2                -1.081257e-01 1 1  ON 32
  eH1_3                -5.236000e-02 1 1  ON 33
  eH1_4                -1.606251e-03 1 1  ON 34
  eH1_5                 3.479113e-02 1 1  ON 35
  eH1_6                 9.780220e-02 1 1  ON 36
  eH1_7                 1.596895e-01 1 1  ON 37
  eH1_8                 1.971195e-01 1 1  ON 38
  eH1_9                 9.582839e-02 1 1  ON 39
  eH2_0                -2.643148e-01 1 1  ON 40
  eH2_1                -1.565313e-01 1 1  ON 41
  eH2_2                -1.065215e-01 1 1  ON 42
  eH2_3                -5.075877e-02 1 1  ON 43
  eH2_4                -8.942041e-06 1 1  ON 44
  eH2_5                 3.715334e-02 1 1  ON 45
  eH2_6                 9.952682e-02 1 1  ON 46
  eH2_7                 1.613421e-01 1 1  ON 47
  eH2_8                 2.013162e-01 1 1  ON 48
  eH2_9                 8.960769e-02 1 1  ON 49
ci_0001                 7.013824e-01 3 1  ON 50
ci_0002                 7.008365e-01 3 1  ON 51
ci_0003                -2.731644e-02 3 1  ON 52
ci_0004                -2.689669e-02 3 1  ON 53
ci_0005                -3.561123e-02 3 1  ON 54
ci_0006                -3.595621e-02 3 1  ON 55
ci_0007                -2.085061e-02 3 1  ON 56
ci_0008                -2.173874e-02 3 1  ON 57
ci_0009                -1.723879e-02 3 1  ON 58
ci_0010                -1.709701e-02 3 1  ON 59
ci_0011                -1.234931e-02 3 1  ON 60
ci_0012                -1.236416e-02 3 1  ON 61
ci_0013                 1.354958e-02 3 1  ON 62
ci_0014                 1.311058e-02 3 1  ON 63
ci_0015                 1.355362e-02 3 1  ON 64
ci_0016                 1.299043e-02 3 1  ON 65
ci_0017                 1.142157e-02 3 1  ON 66
ci_0018                 1.117467e-02 3 1  ON 67
ci_0019                 1.111901e-02 3 1  ON 68
ci_0020                 1.131149e-02 3 1  ON 69
ci_0021                -2.048844e-03 3 1  ON 70
ci_0022                -7.472711e-04 3 1  ON 71
ci_0023                -1.115267e-02 3 1  ON 72
ci_0024                -1.124445e-02 3 1  ON 73
ci_0025                -1.064889e-02 3 1  ON 74
ci_0026                -1.056942e-02 3 1  ON 75
ci_0027                -1.147976e-02 3 1  ON 76
ci_0028                -1.113685e-02 3 1  ON 77
ci_0029                -1.047454e-02 3 1  ON 78
ci_0030                -1.097088e-02 3 1  ON 79
ci_0031                 2.088597e-02 3 1  ON 80
ci_0032                 2.093479e-02 3 1  ON 81
ci_0033                 9.663776e-03 3 1  ON 82
ci_0034                 9.991427e-03 3 1  ON 83
ci_0035                 6.863391e-03 3 1  ON 84
ci_0036                 6.409216e-03 3 1  ON 85
ci_0037                -1.013271e-02 3 1  ON 86
ci_0038                -1.102355e-02 3 1  ON 87
ci_0039                -2.671594e-03 3 1  ON 88
ci_0040                -2.756686e-03 3 1  ON 89
ci_0041                 7.452097e-03 3 1  ON 90
ci_0042                 6.947339e-03 3 1  ON 91
ci_0043                -1.883177e-02 3 1  ON 92
ci_0044                -1.904930e-02 3 1  ON 93
ci_0045                 7.610933e-03 3 1  ON 94
ci_0046                 7.553927e-03 3 1  ON 95
ci_0047                -1.740627e-03 3 1  ON 96
ci_0048                -2.088594e-03 3 1  ON 97
ci_0049                -5.979801e-03 3 1  ON 98
ci_0050                -5.892508e-03 3 1  ON 99
ci_0051                -3.446842e-03 3 1  ON 100
ci_0052                -3.209943e-03 3 1  ON 101
ci_0053                -4.683326e-03 3 1  ON 102
ci_0054                -4.539322e-03 3 1  ON 103
ci_0055                 6.290733e-03 3 1  ON 104
ci_0056                 6.762230e-03 3 1  ON 105
ci_0057                 4.865299e-03 3 1  ON 106
ci_0058                 4.626976e-03 3 1  ON 107
ci_0059                -4.749532e-03 3 1  ON 108
ci_0060                -4.783473e-03 3 1  ON 109
ci_0061                -3.577191e-03 3 1  ON 110
ci_0062                -3.362105e-03 3 1  ON 111
ci_0063                -8.435997e-03 3 1  ON 112
ci_0064                -8.185763e-03 3 1  ON 113
ci_0065                -5.441555e-03 3 1  ON 114
ci_0066                -5.563950e-03 3 1  ON 115
ci_0067                -4.720756e-03 3 1  ON 116
ci_0068                -5.146152e-03 3 1  ON 117
ci_0069                 4.348539e-03 3 1  ON 118
ci_0070                 4.247151e-03 3 1  ON 119
ci_0071                -1.023358e-04 3 1  ON 120
ci_0072                 4.289828e-04 3 1  ON 121
ci_0073                 4.210521e-03 3 1  ON 122
ci_0074                 4.257247e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7741e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s078 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s078 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=78  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 78
    time step          = 0.05
    reference energy   = -16.9534
    reference variance = 0.19048
====================================================
  Execution time = 2.1195e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s078
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5223e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3367e-01
  Total weights = 1.951593079e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1041e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322710470695
                                         uncertainty =       0.002247544235

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322710470695
                                         uncertainty =       0.002247544235

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401724867
  error estimate for blocks of size 2^( 2) =       0.000414344697
  error estimate for blocks of size 2^( 3) =       0.000427749758
  error estimate for blocks of size 2^( 4) =       0.000440253745
  error estimate for blocks of size 2^( 5) =       0.000451922270
  error estimate for blocks of size 2^( 6) =       0.000460612750
  error estimate for blocks of size 2^( 7) =       0.000464252061

      target function =                  N/A
              le_mean =     -16.906171612199
             les_mean =     286.152306672153
             stat err =       0.000454260207
             autocorr =       1.278650807565
              std dev =       0.568124755263
             le_variance =       0.322765737543


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690617161220e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.2940e+01, overlap shift 5.2940e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906171612163       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906171769493       residual = 4.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906171761978       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906171766934       residual = 6.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906171768012       residual = 6.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906171763249       residual = 2.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906171758326       residual = 7.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906171757273       residual = 3.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906171757391       residual = 7.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.2940e+01 is 9.043456e-06

solving harmonic davidson linear method for identity shift 2.1176e+02, overlap shift 2.1176e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906171612163       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906171651616       residual = 4.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906171649734       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906171650985       residual = 6.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906171651263       residual = 6.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906171650072       residual = 2.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906171648825       residual = 7.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906171648548       residual = 3.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906171648576       residual = 7.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.1176e+02 is 2.266295e-06

solving harmonic davidson linear method for identity shift 8.4703e+02, overlap shift 8.4703e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906171612163       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906171622034       residual = 4.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906171621563       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906171621876       residual = 6.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906171621946       residual = 6.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906171621650       residual = 2.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906171621337       residual = 7.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906171621267       residual = 3.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906171621272       residual = 7.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 8.4703e+02 is 5.669142e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.661454 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7315e+01
  </log>
  <optVariables href="H2O.s078.opt.xml">
   uu_0                 3.131909e-01 1 1  ON 0
   uu_1                 1.455909e-01 1 1  ON 1
   uu_2                 4.336597e-02 1 1  ON 2
   uu_3                -1.980208e-02 1 1  ON 3
   uu_4                -6.660943e-02 1 1  ON 4
   uu_5                -1.030359e-01 1 1  ON 5
   uu_6                -1.322544e-01 1 1  ON 6
   uu_7                -1.479647e-01 1 1  ON 7
   uu_8                -1.413653e-01 1 1  ON 8
   uu_9                -1.139462e-01 1 1  ON 9
   ud_0                 4.516383e-01 1 1  ON 10
   ud_1                 1.857586e-01 1 1  ON 11
   ud_2                 6.518956e-02 1 1  ON 12
   ud_3                -6.069014e-03 1 1  ON 13
   ud_4                -6.373806e-02 1 1  ON 14
   ud_5                -1.062764e-01 1 1  ON 15
   ud_6                -1.349644e-01 1 1  ON 16
   ud_7                -1.530835e-01 1 1  ON 17
   ud_8                -1.549919e-01 1 1  ON 18
   ud_9                -1.457354e-01 1 1  ON 19
   eO_0                -7.486321e-01 1 1  ON 20
   eO_1                -4.276511e-01 1 1  ON 21
   eO_2                -1.610484e-02 1 1  ON 22
   eO_3                 2.978235e-01 1 1  ON 23
   eO_4                 5.259015e-01 1 1  ON 24
   eO_5                 4.903941e-01 1 1  ON 25
   eO_6                 2.635982e-01 1 1  ON 26
   eO_7                -4.211355e-02 1 1  ON 27
   eO_8                -2.366088e-01 1 1  ON 28
   eO_9                -1.026108e-01 1 1  ON 29
  eH1_0                -2.659706e-01 1 1  ON 30
  eH1_1                -1.582702e-01 1 1  ON 31
  eH1_2                -1.081259e-01 1 1  ON 32
  eH1_3                -5.236025e-02 1 1  ON 33
  eH1_4                -1.606931e-03 1 1  ON 34
  eH1_5                 3.479086e-02 1 1  ON 35
  eH1_6                 9.780243e-02 1 1  ON 36
  eH1_7                 1.596901e-01 1 1  ON 37
  eH1_8                 1.971200e-01 1 1  ON 38
  eH1_9                 9.582885e-02 1 1  ON 39
  eH2_0                -2.643150e-01 1 1  ON 40
  eH2_1                -1.565315e-01 1 1  ON 41
  eH2_2                -1.065213e-01 1 1  ON 42
  eH2_3                -5.075908e-02 1 1  ON 43
  eH2_4                -9.767560e-06 1 1  ON 44
  eH2_5                 3.715370e-02 1 1  ON 45
  eH2_6                 9.952653e-02 1 1  ON 46
  eH2_7                 1.613419e-01 1 1  ON 47
  eH2_8                 2.013166e-01 1 1  ON 48
  eH2_9                 8.960854e-02 1 1  ON 49
ci_0001                 7.013821e-01 3 1  ON 50
ci_0002                 7.008366e-01 3 1  ON 51
ci_0003                -2.731657e-02 3 1  ON 52
ci_0004                -2.689733e-02 3 1  ON 53
ci_0005                -3.561141e-02 3 1  ON 54
ci_0006                -3.595640e-02 3 1  ON 55
ci_0007                -2.085092e-02 3 1  ON 56
ci_0008                -2.173915e-02 3 1  ON 57
ci_0009                -1.723945e-02 3 1  ON 58
ci_0010                -1.709748e-02 3 1  ON 59
ci_0011                -1.234886e-02 3 1  ON 60
ci_0012                -1.236462e-02 3 1  ON 61
ci_0013                 1.354883e-02 3 1  ON 62
ci_0014                 1.311057e-02 3 1  ON 63
ci_0015                 1.355250e-02 3 1  ON 64
ci_0016                 1.299001e-02 3 1  ON 65
ci_0017                 1.142081e-02 3 1  ON 66
ci_0018                 1.117510e-02 3 1  ON 67
ci_0019                 1.111910e-02 3 1  ON 68
ci_0020                 1.131205e-02 3 1  ON 69
ci_0021                -2.049133e-03 3 1  ON 70
ci_0022                -7.472509e-04 3 1  ON 71
ci_0023                -1.115284e-02 3 1  ON 72
ci_0024                -1.124523e-02 3 1  ON 73
ci_0025                -1.064844e-02 3 1  ON 74
ci_0026                -1.057059e-02 3 1  ON 75
ci_0027                -1.148012e-02 3 1  ON 76
ci_0028                -1.113767e-02 3 1  ON 77
ci_0029                -1.047496e-02 3 1  ON 78
ci_0030                -1.097048e-02 3 1  ON 79
ci_0031                 2.088594e-02 3 1  ON 80
ci_0032                 2.093491e-02 3 1  ON 81
ci_0033                 9.665909e-03 3 1  ON 82
ci_0034                 9.991982e-03 3 1  ON 83
ci_0035                 6.862896e-03 3 1  ON 84
ci_0036                 6.409563e-03 3 1  ON 85
ci_0037                -1.013498e-02 3 1  ON 86
ci_0038                -1.102300e-02 3 1  ON 87
ci_0039                -2.671439e-03 3 1  ON 88
ci_0040                -2.756093e-03 3 1  ON 89
ci_0041                 7.451908e-03 3 1  ON 90
ci_0042                 6.946760e-03 3 1  ON 91
ci_0043                -1.883170e-02 3 1  ON 92
ci_0044                -1.904867e-02 3 1  ON 93
ci_0045                 7.610704e-03 3 1  ON 94
ci_0046                 7.553580e-03 3 1  ON 95
ci_0047                -1.740251e-03 3 1  ON 96
ci_0048                -2.087754e-03 3 1  ON 97
ci_0049                -5.978953e-03 3 1  ON 98
ci_0050                -5.891441e-03 3 1  ON 99
ci_0051                -3.447844e-03 3 1  ON 100
ci_0052                -3.210361e-03 3 1  ON 101
ci_0053                -4.683358e-03 3 1  ON 102
ci_0054                -4.539361e-03 3 1  ON 103
ci_0055                 6.291025e-03 3 1  ON 104
ci_0056                 6.761882e-03 3 1  ON 105
ci_0057                 4.864131e-03 3 1  ON 106
ci_0058                 4.627116e-03 3 1  ON 107
ci_0059                -4.750327e-03 3 1  ON 108
ci_0060                -4.784366e-03 3 1  ON 109
ci_0061                -3.577312e-03 3 1  ON 110
ci_0062                -3.360613e-03 3 1  ON 111
ci_0063                -8.436856e-03 3 1  ON 112
ci_0064                -8.187571e-03 3 1  ON 113
ci_0065                -5.441349e-03 3 1  ON 114
ci_0066                -5.563706e-03 3 1  ON 115
ci_0067                -4.722448e-03 3 1  ON 116
ci_0068                -5.146970e-03 3 1  ON 117
ci_0069                 4.348404e-03 3 1  ON 118
ci_0070                 4.247275e-03 3 1  ON 119
ci_0071                -1.019327e-04 3 1  ON 120
ci_0072                 4.285706e-04 3 1  ON 121
ci_0073                 4.210906e-03 3 1  ON 122
ci_0074                 4.256374e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 78
    time step          = 0.05
    reference energy   = -16.8985
    reference variance = 0.344243
====================================================
  Execution time = 2.0769e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s078
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6908e+01
  VMC Evar = 3.3951e-01
  Total weights = 1.9519e+06
  Execution time = 1.9218e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323299805946
                                         uncertainty =       0.001975045583

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323299805946
                                         uncertainty =       0.001975045583

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402076857
  error estimate for blocks of size 2^( 2) =       0.000414513253
  error estimate for blocks of size 2^( 3) =       0.000427417705
  error estimate for blocks of size 2^( 4) =       0.000438885522
  error estimate for blocks of size 2^( 5) =       0.000448871547
  error estimate for blocks of size 2^( 6) =       0.000455155366
  error estimate for blocks of size 2^( 7) =       0.000459239239

      target function =                  N/A
              le_mean =     -16.907696722211
             les_mean =     286.209713178384
             stat err =       0.000450537919
             autocorr =       1.255580450776
              std dev =       0.568622543660
             le_variance =       0.323331597158

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323301868661
                                         uncertainty =       0.001975260667

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323301868661
                                         uncertainty =       0.001975260667

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402078149
  error estimate for blocks of size 2^( 2) =       0.000414514299
  error estimate for blocks of size 2^( 3) =       0.000427418628
  error estimate for blocks of size 2^( 4) =       0.000438886373
  error estimate for blocks of size 2^( 5) =       0.000448872303
  error estimate for blocks of size 2^( 6) =       0.000455156077
  error estimate for blocks of size 2^( 7) =       0.000459239941

      target function =                  N/A
              le_mean =     -16.907696734234
             les_mean =     286.209731670194
             stat err =       0.000450538674
             autocorr =       1.255576587279
              std dev =       0.568624371062
             le_variance =       0.323333675366

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323300839571
                                         uncertainty =       0.001975153313

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323300839571
                                         uncertainty =       0.001975153313

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402077504
  error estimate for blocks of size 2^( 2) =       0.000414513777
  error estimate for blocks of size 2^( 3) =       0.000427418167
  error estimate for blocks of size 2^( 4) =       0.000438885948
  error estimate for blocks of size 2^( 5) =       0.000448871926
  error estimate for blocks of size 2^( 6) =       0.000455155723
  error estimate for blocks of size 2^( 7) =       0.000459239592

      target function =                  N/A
              le_mean =     -16.907696727991
             les_mean =     286.209720760021
             stat err =       0.000450538297
             autocorr =       1.255578516466
              std dev =       0.568623459359
             le_variance =       0.323332638534

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323299934940
                                         uncertainty =       0.001975059046

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323299934940
                                         uncertainty =       0.001975059046

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402076937
  error estimate for blocks of size 2^( 2) =       0.000414513318
  error estimate for blocks of size 2^( 3) =       0.000427417763
  error estimate for blocks of size 2^( 4) =       0.000438885575
  error estimate for blocks of size 2^( 5) =       0.000448871594
  error estimate for blocks of size 2^( 6) =       0.000455155411
  error estimate for blocks of size 2^( 7) =       0.000459239283

      target function =                  N/A
              le_mean =     -16.907696722914
             les_mean =     286.209713837767
             stat err =       0.000450537966
             autocorr =       1.255580209364
              std dev =       0.568622657939
             le_variance =       0.323331727121


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.907696722211        initial
     5.2940e+01     5.2940e+02             9.0435e-06       -16.907696734234  <--
     2.1176e+02     2.1176e+03             2.2663e-06       -16.907696727991
     8.4703e+02     8.4703e+03             5.6691e-07       -16.907696722914

*****************************************************************************
Applying the update for shift_i =   5.2940e+01     and shift_s =   5.2940e+02
*****************************************************************************

  Execution time = 3.0478e+01
  </log>
  <optVariables href="H2O.s078.opt.xml">
   uu_0                 3.131910e-01 1 1  ON 0
   uu_1                 1.455901e-01 1 1  ON 1
   uu_2                 4.336689e-02 1 1  ON 2
   uu_3                -1.980190e-02 1 1  ON 3
   uu_4                -6.660886e-02 1 1  ON 4
   uu_5                -1.030365e-01 1 1  ON 5
   uu_6                -1.322557e-01 1 1  ON 6
   uu_7                -1.479632e-01 1 1  ON 7
   uu_8                -1.413660e-01 1 1  ON 8
   uu_9                -1.139472e-01 1 1  ON 9
   ud_0                 4.516395e-01 1 1  ON 10
   ud_1                 1.857581e-01 1 1  ON 11
   ud_2                 6.519072e-02 1 1  ON 12
   ud_3                -6.068997e-03 1 1  ON 13
   ud_4                -6.373747e-02 1 1  ON 14
   ud_5                -1.062762e-01 1 1  ON 15
   ud_6                -1.349650e-01 1 1  ON 16
   ud_7                -1.530837e-01 1 1  ON 17
   ud_8                -1.549915e-01 1 1  ON 18
   ud_9                -1.457352e-01 1 1  ON 19
   eO_0                -7.486297e-01 1 1  ON 20
   eO_1                -4.276515e-01 1 1  ON 21
   eO_2                -1.610574e-02 1 1  ON 22
   eO_3                 2.978237e-01 1 1  ON 23
   eO_4                 5.259029e-01 1 1  ON 24
   eO_5                 4.903957e-01 1 1  ON 25
   eO_6                 2.635979e-01 1 1  ON 26
   eO_7                -4.211395e-02 1 1  ON 27
   eO_8                -2.366102e-01 1 1  ON 28
   eO_9                -1.026126e-01 1 1  ON 29
  eH1_0                -2.659714e-01 1 1  ON 30
  eH1_1                -1.582705e-01 1 1  ON 31
  eH1_2                -1.081263e-01 1 1  ON 32
  eH1_3                -5.236101e-02 1 1  ON 33
  eH1_4                -1.608967e-03 1 1  ON 34
  eH1_5                 3.479004e-02 1 1  ON 35
  eH1_6                 9.780314e-02 1 1  ON 36
  eH1_7                 1.596919e-01 1 1  ON 37
  eH1_8                 1.971216e-01 1 1  ON 38
  eH1_9                 9.583022e-02 1 1  ON 39
  eH2_0                -2.643156e-01 1 1  ON 40
  eH2_1                -1.565319e-01 1 1  ON 41
  eH2_2                -1.065206e-01 1 1  ON 42
  eH2_3                -5.075998e-02 1 1  ON 43
  eH2_4                -1.224051e-05 1 1  ON 44
  eH2_5                 3.715478e-02 1 1  ON 45
  eH2_6                 9.952568e-02 1 1  ON 46
  eH2_7                 1.613414e-01 1 1  ON 47
  eH2_8                 2.013177e-01 1 1  ON 48
  eH2_9                 8.961107e-02 1 1  ON 49
ci_0001                 7.013812e-01 3 1  ON 50
ci_0002                 7.008370e-01 3 1  ON 51
ci_0003                -2.731695e-02 3 1  ON 52
ci_0004                -2.689927e-02 3 1  ON 53
ci_0005                -3.561198e-02 3 1  ON 54
ci_0006                -3.595698e-02 3 1  ON 55
ci_0007                -2.085183e-02 3 1  ON 56
ci_0008                -2.174039e-02 3 1  ON 57
ci_0009                -1.724144e-02 3 1  ON 58
ci_0010                -1.709886e-02 3 1  ON 59
ci_0011                -1.234751e-02 3 1  ON 60
ci_0012                -1.236601e-02 3 1  ON 61
ci_0013                 1.354660e-02 3 1  ON 62
ci_0014                 1.311053e-02 3 1  ON 63
ci_0015                 1.354915e-02 3 1  ON 64
ci_0016                 1.298878e-02 3 1  ON 65
ci_0017                 1.141855e-02 3 1  ON 66
ci_0018                 1.117638e-02 3 1  ON 67
ci_0019                 1.111937e-02 3 1  ON 68
ci_0020                 1.131373e-02 3 1  ON 69
ci_0021                -2.049998e-03 3 1  ON 70
ci_0022                -7.471903e-04 3 1  ON 71
ci_0023                -1.115337e-02 3 1  ON 72
ci_0024                -1.124757e-02 3 1  ON 73
ci_0025                -1.064711e-02 3 1  ON 74
ci_0026                -1.057406e-02 3 1  ON 75
ci_0027                -1.148117e-02 3 1  ON 76
ci_0028                -1.114012e-02 3 1  ON 77
ci_0029                -1.047622e-02 3 1  ON 78
ci_0030                -1.096930e-02 3 1  ON 79
ci_0031                 2.088583e-02 3 1  ON 80
ci_0032                 2.093528e-02 3 1  ON 81
ci_0033                 9.672298e-03 3 1  ON 82
ci_0034                 9.993643e-03 3 1  ON 83
ci_0035                 6.861418e-03 3 1  ON 84
ci_0036                 6.410602e-03 3 1  ON 85
ci_0037                -1.014176e-02 3 1  ON 86
ci_0038                -1.102135e-02 3 1  ON 87
ci_0039                -2.670977e-03 3 1  ON 88
ci_0040                -2.754325e-03 3 1  ON 89
ci_0041                 7.451345e-03 3 1  ON 90
ci_0042                 6.945030e-03 3 1  ON 91
ci_0043                -1.883150e-02 3 1  ON 92
ci_0044                -1.904680e-02 3 1  ON 93
ci_0045                 7.610016e-03 3 1  ON 94
ci_0046                 7.552542e-03 3 1  ON 95
ci_0047                -1.739129e-03 3 1  ON 96
ci_0048                -2.085254e-03 3 1  ON 97
ci_0049                -5.976421e-03 3 1  ON 98
ci_0050                -5.888253e-03 3 1  ON 99
ci_0051                -3.450831e-03 3 1  ON 100
ci_0052                -3.211606e-03 3 1  ON 101
ci_0053                -4.683454e-03 3 1  ON 102
ci_0054                -4.539477e-03 3 1  ON 103
ci_0055                 6.291899e-03 3 1  ON 104
ci_0056                 6.760840e-03 3 1  ON 105
ci_0057                 4.860637e-03 3 1  ON 106
ci_0058                 4.627534e-03 3 1  ON 107
ci_0059                -4.752697e-03 3 1  ON 108
ci_0060                -4.787030e-03 3 1  ON 109
ci_0061                -3.577671e-03 3 1  ON 110
ci_0062                -3.356155e-03 3 1  ON 111
ci_0063                -8.439415e-03 3 1  ON 112
ci_0064                -8.192967e-03 3 1  ON 113
ci_0065                -5.440731e-03 3 1  ON 114
ci_0066                -5.562978e-03 3 1  ON 115
ci_0067                -4.727496e-03 3 1  ON 116
ci_0068                -5.149408e-03 3 1  ON 117
ci_0069                 4.348000e-03 3 1  ON 118
ci_0070                 4.247644e-03 3 1  ON 119
ci_0071                -1.007269e-04 3 1  ON 120
ci_0072                 4.273393e-04 3 1  ON 121
ci_0073                 4.212055e-03 3 1  ON 122
ci_0074                 4.253772e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7815e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s079 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s079 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=79  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 79
    time step          = 0.05
    reference energy   = -16.9695
    reference variance = 0.271374
====================================================
  Execution time = 2.1238e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s079
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5238e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3489e-01
  Total weights = 1.951693088e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1962e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324229981482
                                         uncertainty =       0.001996287798

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324229981482
                                         uncertainty =       0.001996287798

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402630241
  error estimate for blocks of size 2^( 2) =       0.000415227033
  error estimate for blocks of size 2^( 3) =       0.000428021541
  error estimate for blocks of size 2^( 4) =       0.000439853436
  error estimate for blocks of size 2^( 5) =       0.000450379493
  error estimate for blocks of size 2^( 6) =       0.000458397480
  error estimate for blocks of size 2^( 7) =       0.000463469714

      target function =                  N/A
              le_mean =     -16.905918404679
             les_mean =     286.144968784619
             stat err =       0.000453025031
             autocorr =       1.265993907297
              std dev =       0.569405146993
             le_variance =       0.324222221422


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690591840468e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3235e+01, overlap shift 1.3235e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905918404691       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905918701546       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905918700927       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905918726416       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905918715649       residual = 4.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905918715654       residual = 2.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905918723656       residual = 8.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905918725846       residual = 2.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905918720481       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905918719899       residual = 3.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.3235e+01 is 2.729874e-05

solving harmonic davidson linear method for identity shift 5.2940e+01, overlap shift 5.2940e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905918404691       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905918479741       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905918479494       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905918485726       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905918482968       residual = 4.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905918483032       residual = 2.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905918485193       residual = 8.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905918485685       residual = 2.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905918484229       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905918484108       residual = 3.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.2940e+01 is 6.939387e-06

solving harmonic davidson linear method for identity shift 2.1176e+02, overlap shift 2.1176e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905918404691       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905918423507       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905918423439       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905918424988       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905918424294       residual = 4.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905918424313       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905918424864       residual = 8.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905918424984       residual = 2.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905918424612       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905918424584       residual = 3.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.1176e+02 is 1.742172e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.665393 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7442e+01
  </log>
  <optVariables href="H2O.s079.opt.xml">
   uu_0                 3.131910e-01 1 1  ON 0
   uu_1                 1.455902e-01 1 1  ON 1
   uu_2                 4.336721e-02 1 1  ON 2
   uu_3                -1.980275e-02 1 1  ON 3
   uu_4                -6.660805e-02 1 1  ON 4
   uu_5                -1.030363e-01 1 1  ON 5
   uu_6                -1.322582e-01 1 1  ON 6
   uu_7                -1.479651e-01 1 1  ON 7
   uu_8                -1.413659e-01 1 1  ON 8
   uu_9                -1.139467e-01 1 1  ON 9
   ud_0                 4.516399e-01 1 1  ON 10
   ud_1                 1.857598e-01 1 1  ON 11
   ud_2                 6.518941e-02 1 1  ON 12
   ud_3                -6.069766e-03 1 1  ON 13
   ud_4                -6.373638e-02 1 1  ON 14
   ud_5                -1.062766e-01 1 1  ON 15
   ud_6                -1.349659e-01 1 1  ON 16
   ud_7                -1.530829e-01 1 1  ON 17
   ud_8                -1.549898e-01 1 1  ON 18
   ud_9                -1.457357e-01 1 1  ON 19
   eO_0                -7.486297e-01 1 1  ON 20
   eO_1                -4.276507e-01 1 1  ON 21
   eO_2                -1.610355e-02 1 1  ON 22
   eO_3                 2.978223e-01 1 1  ON 23
   eO_4                 5.259040e-01 1 1  ON 24
   eO_5                 4.903976e-01 1 1  ON 25
   eO_6                 2.635972e-01 1 1  ON 26
   eO_7                -4.211412e-02 1 1  ON 27
   eO_8                -2.366112e-01 1 1  ON 28
   eO_9                -1.026148e-01 1 1  ON 29
  eH1_0                -2.659717e-01 1 1  ON 30
  eH1_1                -1.582697e-01 1 1  ON 31
  eH1_2                -1.081278e-01 1 1  ON 32
  eH1_3                -5.236415e-02 1 1  ON 33
  eH1_4                -1.609948e-03 1 1  ON 34
  eH1_5                 3.478931e-02 1 1  ON 35
  eH1_6                 9.780283e-02 1 1  ON 36
  eH1_7                 1.596927e-01 1 1  ON 37
  eH1_8                 1.971237e-01 1 1  ON 38
  eH1_9                 9.583295e-02 1 1  ON 39
  eH2_0                -2.643174e-01 1 1  ON 40
  eH2_1                -1.565310e-01 1 1  ON 41
  eH2_2                -1.065199e-01 1 1  ON 42
  eH2_3                -5.076256e-02 1 1  ON 43
  eH2_4                -1.489061e-05 1 1  ON 44
  eH2_5                 3.715244e-02 1 1  ON 45
  eH2_6                 9.952611e-02 1 1  ON 46
  eH2_7                 1.613425e-01 1 1  ON 47
  eH2_8                 2.013194e-01 1 1  ON 48
  eH2_9                 8.961499e-02 1 1  ON 49
ci_0001                 7.013818e-01 3 1  ON 50
ci_0002                 7.008358e-01 3 1  ON 51
ci_0003                -2.731779e-02 3 1  ON 52
ci_0004                -2.690191e-02 3 1  ON 53
ci_0005                -3.561809e-02 3 1  ON 54
ci_0006                -3.596067e-02 3 1  ON 55
ci_0007                -2.085369e-02 3 1  ON 56
ci_0008                -2.174281e-02 3 1  ON 57
ci_0009                -1.724511e-02 3 1  ON 58
ci_0010                -1.710163e-02 3 1  ON 59
ci_0011                -1.234706e-02 3 1  ON 60
ci_0012                -1.236517e-02 3 1  ON 61
ci_0013                 1.354428e-02 3 1  ON 62
ci_0014                 1.310659e-02 3 1  ON 63
ci_0015                 1.354845e-02 3 1  ON 64
ci_0016                 1.298939e-02 3 1  ON 65
ci_0017                 1.141390e-02 3 1  ON 66
ci_0018                 1.117400e-02 3 1  ON 67
ci_0019                 1.111665e-02 3 1  ON 68
ci_0020                 1.131375e-02 3 1  ON 69
ci_0021                -2.048392e-03 3 1  ON 70
ci_0022                -7.491664e-04 3 1  ON 71
ci_0023                -1.115247e-02 3 1  ON 72
ci_0024                -1.124949e-02 3 1  ON 73
ci_0025                -1.064543e-02 3 1  ON 74
ci_0026                -1.057647e-02 3 1  ON 75
ci_0027                -1.148046e-02 3 1  ON 76
ci_0028                -1.113959e-02 3 1  ON 77
ci_0029                -1.047838e-02 3 1  ON 78
ci_0030                -1.096745e-02 3 1  ON 79
ci_0031                 2.088769e-02 3 1  ON 80
ci_0032                 2.093890e-02 3 1  ON 81
ci_0033                 9.673708e-03 3 1  ON 82
ci_0034                 9.992981e-03 3 1  ON 83
ci_0035                 6.859062e-03 3 1  ON 84
ci_0036                 6.412280e-03 3 1  ON 85
ci_0037                -1.014566e-02 3 1  ON 86
ci_0038                -1.101849e-02 3 1  ON 87
ci_0039                -2.670491e-03 3 1  ON 88
ci_0040                -2.751950e-03 3 1  ON 89
ci_0041                 7.447404e-03 3 1  ON 90
ci_0042                 6.943646e-03 3 1  ON 91
ci_0043                -1.883244e-02 3 1  ON 92
ci_0044                -1.904599e-02 3 1  ON 93
ci_0045                 7.608084e-03 3 1  ON 94
ci_0046                 7.546789e-03 3 1  ON 95
ci_0047                -1.739431e-03 3 1  ON 96
ci_0048                -2.082888e-03 3 1  ON 97
ci_0049                -5.974627e-03 3 1  ON 98
ci_0050                -5.882829e-03 3 1  ON 99
ci_0051                -3.451046e-03 3 1  ON 100
ci_0052                -3.213589e-03 3 1  ON 101
ci_0053                -4.684108e-03 3 1  ON 102
ci_0054                -4.538873e-03 3 1  ON 103
ci_0055                 6.293754e-03 3 1  ON 104
ci_0056                 6.754469e-03 3 1  ON 105
ci_0057                 4.861025e-03 3 1  ON 106
ci_0058                 4.630099e-03 3 1  ON 107
ci_0059                -4.750329e-03 3 1  ON 108
ci_0060                -4.787101e-03 3 1  ON 109
ci_0061                -3.580184e-03 3 1  ON 110
ci_0062                -3.353078e-03 3 1  ON 111
ci_0063                -8.446355e-03 3 1  ON 112
ci_0064                -8.193507e-03 3 1  ON 113
ci_0065                -5.440107e-03 3 1  ON 114
ci_0066                -5.557552e-03 3 1  ON 115
ci_0067                -4.725304e-03 3 1  ON 116
ci_0068                -5.151683e-03 3 1  ON 117
ci_0069                 4.348036e-03 3 1  ON 118
ci_0070                 4.249034e-03 3 1  ON 119
ci_0071                -9.983267e-05 3 1  ON 120
ci_0072                 4.290766e-04 3 1  ON 121
ci_0073                 4.215563e-03 3 1  ON 122
ci_0074                 4.249647e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 79
    time step          = 0.05
    reference energy   = -16.9224
    reference variance = 0.195237
====================================================
  Execution time = 2.1311e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s079
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3593e-01
  Total weights = 1.9517e+06
  Execution time = 1.9090e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322691543331
                                         uncertainty =       0.002053595390

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322691543331
                                         uncertainty =       0.002053595390

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401675960
  error estimate for blocks of size 2^( 2) =       0.000414753257
  error estimate for blocks of size 2^( 3) =       0.000427859006
  error estimate for blocks of size 2^( 4) =       0.000439512115
  error estimate for blocks of size 2^( 5) =       0.000450079745
  error estimate for blocks of size 2^( 6) =       0.000457562203
  error estimate for blocks of size 2^( 7) =       0.000465664117

      target function =                  N/A
              le_mean =     -16.906091606814
             les_mean =     286.151829383612
             stat err =       0.000453204545
             autocorr =       1.273024709692
              std dev =       0.568055589680
             le_variance =       0.322687152966

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322688269644
                                         uncertainty =       0.002053389927

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322688269644
                                         uncertainty =       0.002053389927

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401673913
  error estimate for blocks of size 2^( 2) =       0.000414751489
  error estimate for blocks of size 2^( 3) =       0.000427858162
  error estimate for blocks of size 2^( 4) =       0.000439511628
  error estimate for blocks of size 2^( 5) =       0.000450079264
  error estimate for blocks of size 2^( 6) =       0.000457560875
  error estimate for blocks of size 2^( 7) =       0.000465662783

      target function =                  N/A
              le_mean =     -16.906091236588
             les_mean =     286.160921514833
             stat err =       0.000453203638
             autocorr =       1.273032585913
              std dev =       0.568052695032
             le_variance =       0.322683864333

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322689803809
                                         uncertainty =       0.002053492133

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322689803809
                                         uncertainty =       0.002053492133

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401674872
  error estimate for blocks of size 2^( 2) =       0.000414752308
  error estimate for blocks of size 2^( 3) =       0.000427858527
  error estimate for blocks of size 2^( 4) =       0.000439511872
  error estimate for blocks of size 2^( 5) =       0.000450079478
  error estimate for blocks of size 2^( 6) =       0.000457561563
  error estimate for blocks of size 2^( 7) =       0.000465663430

      target function =                  N/A
              le_mean =     -16.906091439178
             les_mean =     286.151926258076
             stat err =       0.000453204086
             autocorr =       1.273029021173
              std dev =       0.568054051997
             le_variance =       0.322685405990

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322691319821
                                         uncertainty =       0.002053582411

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322691319821
                                         uncertainty =       0.002053582411

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401675820
  error estimate for blocks of size 2^( 2) =       0.000414753135
  error estimate for blocks of size 2^( 3) =       0.000427858943
  error estimate for blocks of size 2^( 4) =       0.000439512081
  error estimate for blocks of size 2^( 5) =       0.000450079708
  error estimate for blocks of size 2^( 6) =       0.000457562120
  error estimate for blocks of size 2^( 7) =       0.000465664028

      target function =                  N/A
              le_mean =     -16.906091585326
             les_mean =     286.151836338722
             stat err =       0.000453204484
             autocorr =       1.273025254166
              std dev =       0.568055392130
             le_variance =       0.322686928528


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906091606814        initial  <--
     1.3235e+01     1.3235e+02             2.7299e-05       -16.906091236588
     5.2940e+01     5.2940e+02             6.9394e-06       -16.906091439178
     2.1176e+02     2.1176e+03             1.7422e-06       -16.906091585326

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.9526
  </log>
  <optVariables href="H2O.s079.opt.xml">
   uu_0                 3.131910e-01 1 1  ON 0
   uu_1                 1.455901e-01 1 1  ON 1
   uu_2                 4.336689e-02 1 1  ON 2
   uu_3                -1.980190e-02 1 1  ON 3
   uu_4                -6.660886e-02 1 1  ON 4
   uu_5                -1.030365e-01 1 1  ON 5
   uu_6                -1.322557e-01 1 1  ON 6
   uu_7                -1.479632e-01 1 1  ON 7
   uu_8                -1.413660e-01 1 1  ON 8
   uu_9                -1.139472e-01 1 1  ON 9
   ud_0                 4.516395e-01 1 1  ON 10
   ud_1                 1.857581e-01 1 1  ON 11
   ud_2                 6.519072e-02 1 1  ON 12
   ud_3                -6.068997e-03 1 1  ON 13
   ud_4                -6.373747e-02 1 1  ON 14
   ud_5                -1.062762e-01 1 1  ON 15
   ud_6                -1.349650e-01 1 1  ON 16
   ud_7                -1.530837e-01 1 1  ON 17
   ud_8                -1.549915e-01 1 1  ON 18
   ud_9                -1.457352e-01 1 1  ON 19
   eO_0                -7.486297e-01 1 1  ON 20
   eO_1                -4.276515e-01 1 1  ON 21
   eO_2                -1.610574e-02 1 1  ON 22
   eO_3                 2.978237e-01 1 1  ON 23
   eO_4                 5.259029e-01 1 1  ON 24
   eO_5                 4.903957e-01 1 1  ON 25
   eO_6                 2.635979e-01 1 1  ON 26
   eO_7                -4.211395e-02 1 1  ON 27
   eO_8                -2.366102e-01 1 1  ON 28
   eO_9                -1.026126e-01 1 1  ON 29
  eH1_0                -2.659714e-01 1 1  ON 30
  eH1_1                -1.582705e-01 1 1  ON 31
  eH1_2                -1.081263e-01 1 1  ON 32
  eH1_3                -5.236101e-02 1 1  ON 33
  eH1_4                -1.608967e-03 1 1  ON 34
  eH1_5                 3.479004e-02 1 1  ON 35
  eH1_6                 9.780314e-02 1 1  ON 36
  eH1_7                 1.596919e-01 1 1  ON 37
  eH1_8                 1.971216e-01 1 1  ON 38
  eH1_9                 9.583022e-02 1 1  ON 39
  eH2_0                -2.643156e-01 1 1  ON 40
  eH2_1                -1.565319e-01 1 1  ON 41
  eH2_2                -1.065206e-01 1 1  ON 42
  eH2_3                -5.075998e-02 1 1  ON 43
  eH2_4                -1.224051e-05 1 1  ON 44
  eH2_5                 3.715478e-02 1 1  ON 45
  eH2_6                 9.952568e-02 1 1  ON 46
  eH2_7                 1.613414e-01 1 1  ON 47
  eH2_8                 2.013177e-01 1 1  ON 48
  eH2_9                 8.961107e-02 1 1  ON 49
ci_0001                 7.013812e-01 3 1  ON 50
ci_0002                 7.008370e-01 3 1  ON 51
ci_0003                -2.731695e-02 3 1  ON 52
ci_0004                -2.689927e-02 3 1  ON 53
ci_0005                -3.561198e-02 3 1  ON 54
ci_0006                -3.595698e-02 3 1  ON 55
ci_0007                -2.085183e-02 3 1  ON 56
ci_0008                -2.174039e-02 3 1  ON 57
ci_0009                -1.724144e-02 3 1  ON 58
ci_0010                -1.709886e-02 3 1  ON 59
ci_0011                -1.234751e-02 3 1  ON 60
ci_0012                -1.236601e-02 3 1  ON 61
ci_0013                 1.354660e-02 3 1  ON 62
ci_0014                 1.311053e-02 3 1  ON 63
ci_0015                 1.354915e-02 3 1  ON 64
ci_0016                 1.298878e-02 3 1  ON 65
ci_0017                 1.141855e-02 3 1  ON 66
ci_0018                 1.117638e-02 3 1  ON 67
ci_0019                 1.111937e-02 3 1  ON 68
ci_0020                 1.131373e-02 3 1  ON 69
ci_0021                -2.049998e-03 3 1  ON 70
ci_0022                -7.471903e-04 3 1  ON 71
ci_0023                -1.115337e-02 3 1  ON 72
ci_0024                -1.124757e-02 3 1  ON 73
ci_0025                -1.064711e-02 3 1  ON 74
ci_0026                -1.057406e-02 3 1  ON 75
ci_0027                -1.148117e-02 3 1  ON 76
ci_0028                -1.114012e-02 3 1  ON 77
ci_0029                -1.047622e-02 3 1  ON 78
ci_0030                -1.096930e-02 3 1  ON 79
ci_0031                 2.088583e-02 3 1  ON 80
ci_0032                 2.093528e-02 3 1  ON 81
ci_0033                 9.672298e-03 3 1  ON 82
ci_0034                 9.993643e-03 3 1  ON 83
ci_0035                 6.861418e-03 3 1  ON 84
ci_0036                 6.410602e-03 3 1  ON 85
ci_0037                -1.014176e-02 3 1  ON 86
ci_0038                -1.102135e-02 3 1  ON 87
ci_0039                -2.670977e-03 3 1  ON 88
ci_0040                -2.754325e-03 3 1  ON 89
ci_0041                 7.451345e-03 3 1  ON 90
ci_0042                 6.945030e-03 3 1  ON 91
ci_0043                -1.883150e-02 3 1  ON 92
ci_0044                -1.904680e-02 3 1  ON 93
ci_0045                 7.610016e-03 3 1  ON 94
ci_0046                 7.552542e-03 3 1  ON 95
ci_0047                -1.739129e-03 3 1  ON 96
ci_0048                -2.085254e-03 3 1  ON 97
ci_0049                -5.976421e-03 3 1  ON 98
ci_0050                -5.888253e-03 3 1  ON 99
ci_0051                -3.450831e-03 3 1  ON 100
ci_0052                -3.211606e-03 3 1  ON 101
ci_0053                -4.683454e-03 3 1  ON 102
ci_0054                -4.539477e-03 3 1  ON 103
ci_0055                 6.291899e-03 3 1  ON 104
ci_0056                 6.760840e-03 3 1  ON 105
ci_0057                 4.860637e-03 3 1  ON 106
ci_0058                 4.627534e-03 3 1  ON 107
ci_0059                -4.752697e-03 3 1  ON 108
ci_0060                -4.787030e-03 3 1  ON 109
ci_0061                -3.577671e-03 3 1  ON 110
ci_0062                -3.356155e-03 3 1  ON 111
ci_0063                -8.439415e-03 3 1  ON 112
ci_0064                -8.192967e-03 3 1  ON 113
ci_0065                -5.440731e-03 3 1  ON 114
ci_0066                -5.562978e-03 3 1  ON 115
ci_0067                -4.727496e-03 3 1  ON 116
ci_0068                -5.149408e-03 3 1  ON 117
ci_0069                 4.348000e-03 3 1  ON 118
ci_0070                 4.247644e-03 3 1  ON 119
ci_0071                -1.007269e-04 3 1  ON 120
ci_0072                 4.273393e-04 3 1  ON 121
ci_0073                 4.212055e-03 3 1  ON 122
ci_0074                 4.253772e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8401e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s080 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s080 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=80  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 80
    time step          = 0.05
    reference energy   = -16.9234
    reference variance = 0.364805
====================================================
  Execution time = 2.1130e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s080
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5246e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3648e-01
  Total weights = 1.952096249e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1023e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326602748390
                                         uncertainty =       0.002885061424

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326602748390
                                         uncertainty =       0.002885061424

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404068824
  error estimate for blocks of size 2^( 2) =       0.000416833528
  error estimate for blocks of size 2^( 3) =       0.000429920127
  error estimate for blocks of size 2^( 4) =       0.000442097112
  error estimate for blocks of size 2^( 5) =       0.000452011642
  error estimate for blocks of size 2^( 6) =       0.000456957807
  error estimate for blocks of size 2^( 7) =       0.000462575173

      target function =                  N/A
              le_mean =     -16.907331048762
             les_mean =     286.194318308376
             stat err =       0.000453410434
             autocorr =       1.259135101140
              std dev =       0.571439611679
             le_variance =       0.326543229795


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690733104876e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3235e+02, overlap shift 1.3235e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907331048766       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907331069405       residual = 4.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907331071308       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907331072389       residual = 9.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907331080870       residual = 3.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907331080529       residual = 2.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907331080858       residual = 6.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907331081138       residual = 2.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.907331080978       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.907331081509       residual = 3.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.3235e+02 is 2.249772e-06

solving harmonic davidson linear method for identity shift 5.2940e+02, overlap shift 5.2940e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907331048766       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907331053932       residual = 4.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907331054408       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907331054680       residual = 9.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907331056803       residual = 3.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907331056721       residual = 2.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907331056804       residual = 6.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907331056872       residual = 2.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.907331056832       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.907331056966       residual = 3.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.2940e+02 is 5.631935e-07

solving harmonic davidson linear method for identity shift 2.1176e+03, overlap shift 2.1176e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907331048766       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907331050058       residual = 4.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907331050177       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907331050245       residual = 9.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907331050776       residual = 3.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907331050756       residual = 2.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907331050781       residual = 6.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907331050788       residual = 2.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.907331050775       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.907331050811       residual = 3.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.1176e+03 is 1.408454e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.669255 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7240e+01
  </log>
  <optVariables href="H2O.s080.opt.xml">
   uu_0                 3.131907e-01 1 1  ON 0
   uu_1                 1.455901e-01 1 1  ON 1
   uu_2                 4.336696e-02 1 1  ON 2
   uu_3                -1.980193e-02 1 1  ON 3
   uu_4                -6.660881e-02 1 1  ON 4
   uu_5                -1.030363e-01 1 1  ON 5
   uu_6                -1.322556e-01 1 1  ON 6
   uu_7                -1.479633e-01 1 1  ON 7
   uu_8                -1.413660e-01 1 1  ON 8
   uu_9                -1.139474e-01 1 1  ON 9
   ud_0                 4.516394e-01 1 1  ON 10
   ud_1                 1.857583e-01 1 1  ON 11
   ud_2                 6.519082e-02 1 1  ON 12
   ud_3                -6.068774e-03 1 1  ON 13
   ud_4                -6.373744e-02 1 1  ON 14
   ud_5                -1.062762e-01 1 1  ON 15
   ud_6                -1.349650e-01 1 1  ON 16
   ud_7                -1.530839e-01 1 1  ON 17
   ud_8                -1.549916e-01 1 1  ON 18
   ud_9                -1.457352e-01 1 1  ON 19
   eO_0                -7.486298e-01 1 1  ON 20
   eO_1                -4.276511e-01 1 1  ON 21
   eO_2                -1.610580e-02 1 1  ON 22
   eO_3                 2.978238e-01 1 1  ON 23
   eO_4                 5.259029e-01 1 1  ON 24
   eO_5                 4.903958e-01 1 1  ON 25
   eO_6                 2.635978e-01 1 1  ON 26
   eO_7                -4.211408e-02 1 1  ON 27
   eO_8                -2.366104e-01 1 1  ON 28
   eO_9                -1.026128e-01 1 1  ON 29
  eH1_0                -2.659715e-01 1 1  ON 30
  eH1_1                -1.582704e-01 1 1  ON 31
  eH1_2                -1.081262e-01 1 1  ON 32
  eH1_3                -5.236099e-02 1 1  ON 33
  eH1_4                -1.609091e-03 1 1  ON 34
  eH1_5                 3.478981e-02 1 1  ON 35
  eH1_6                 9.780301e-02 1 1  ON 36
  eH1_7                 1.596919e-01 1 1  ON 37
  eH1_8                 1.971217e-01 1 1  ON 38
  eH1_9                 9.583051e-02 1 1  ON 39
  eH2_0                -2.643156e-01 1 1  ON 40
  eH2_1                -1.565319e-01 1 1  ON 41
  eH2_2                -1.065209e-01 1 1  ON 42
  eH2_3                -5.076013e-02 1 1  ON 43
  eH2_4                -1.235025e-05 1 1  ON 44
  eH2_5                 3.715467e-02 1 1  ON 45
  eH2_6                 9.952563e-02 1 1  ON 46
  eH2_7                 1.613415e-01 1 1  ON 47
  eH2_8                 2.013178e-01 1 1  ON 48
  eH2_9                 8.961144e-02 1 1  ON 49
ci_0001                 7.013810e-01 3 1  ON 50
ci_0002                 7.008372e-01 3 1  ON 51
ci_0003                -2.731716e-02 3 1  ON 52
ci_0004                -2.689954e-02 3 1  ON 53
ci_0005                -3.561191e-02 3 1  ON 54
ci_0006                -3.595700e-02 3 1  ON 55
ci_0007                -2.085177e-02 3 1  ON 56
ci_0008                -2.174053e-02 3 1  ON 57
ci_0009                -1.724131e-02 3 1  ON 58
ci_0010                -1.709929e-02 3 1  ON 59
ci_0011                -1.234771e-02 3 1  ON 60
ci_0012                -1.236580e-02 3 1  ON 61
ci_0013                 1.354680e-02 3 1  ON 62
ci_0014                 1.311071e-02 3 1  ON 63
ci_0015                 1.354932e-02 3 1  ON 64
ci_0016                 1.298851e-02 3 1  ON 65
ci_0017                 1.141846e-02 3 1  ON 66
ci_0018                 1.117672e-02 3 1  ON 67
ci_0019                 1.111956e-02 3 1  ON 68
ci_0020                 1.131400e-02 3 1  ON 69
ci_0021                -2.049933e-03 3 1  ON 70
ci_0022                -7.474044e-04 3 1  ON 71
ci_0023                -1.115345e-02 3 1  ON 72
ci_0024                -1.124766e-02 3 1  ON 73
ci_0025                -1.064736e-02 3 1  ON 74
ci_0026                -1.057402e-02 3 1  ON 75
ci_0027                -1.148111e-02 3 1  ON 76
ci_0028                -1.114068e-02 3 1  ON 77
ci_0029                -1.047631e-02 3 1  ON 78
ci_0030                -1.096948e-02 3 1  ON 79
ci_0031                 2.088570e-02 3 1  ON 80
ci_0032                 2.093552e-02 3 1  ON 81
ci_0033                 9.672510e-03 3 1  ON 82
ci_0034                 9.993598e-03 3 1  ON 83
ci_0035                 6.861756e-03 3 1  ON 84
ci_0036                 6.410434e-03 3 1  ON 85
ci_0037                -1.014193e-02 3 1  ON 86
ci_0038                -1.102109e-02 3 1  ON 87
ci_0039                -2.670846e-03 3 1  ON 88
ci_0040                -2.754293e-03 3 1  ON 89
ci_0041                 7.451030e-03 3 1  ON 90
ci_0042                 6.945064e-03 3 1  ON 91
ci_0043                -1.883157e-02 3 1  ON 92
ci_0044                -1.904693e-02 3 1  ON 93
ci_0045                 7.610264e-03 3 1  ON 94
ci_0046                 7.552323e-03 3 1  ON 95
ci_0047                -1.738945e-03 3 1  ON 96
ci_0048                -2.084862e-03 3 1  ON 97
ci_0049                -5.976455e-03 3 1  ON 98
ci_0050                -5.887815e-03 3 1  ON 99
ci_0051                -3.451073e-03 3 1  ON 100
ci_0052                -3.211764e-03 3 1  ON 101
ci_0053                -4.683323e-03 3 1  ON 102
ci_0054                -4.539574e-03 3 1  ON 103
ci_0055                 6.291762e-03 3 1  ON 104
ci_0056                 6.761236e-03 3 1  ON 105
ci_0057                 4.860407e-03 3 1  ON 106
ci_0058                 4.627709e-03 3 1  ON 107
ci_0059                -4.752620e-03 3 1  ON 108
ci_0060                -4.786919e-03 3 1  ON 109
ci_0061                -3.577689e-03 3 1  ON 110
ci_0062                -3.355710e-03 3 1  ON 111
ci_0063                -8.439375e-03 3 1  ON 112
ci_0064                -8.193336e-03 3 1  ON 113
ci_0065                -5.440610e-03 3 1  ON 114
ci_0066                -5.562883e-03 3 1  ON 115
ci_0067                -4.727646e-03 3 1  ON 116
ci_0068                -5.149456e-03 3 1  ON 117
ci_0069                 4.348157e-03 3 1  ON 118
ci_0070                 4.248003e-03 3 1  ON 119
ci_0071                -1.006773e-04 3 1  ON 120
ci_0072                 4.276296e-04 3 1  ON 121
ci_0073                 4.211752e-03 3 1  ON 122
ci_0074                 4.253474e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 80
    time step          = 0.05
    reference energy   = -16.8301
    reference variance = 0.573463
====================================================
  Execution time = 2.1101e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s080
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3461e-01
  Total weights = 1.9519e+06
  Execution time = 1.9024e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323170822504
                                         uncertainty =       0.002008686697

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323170822504
                                         uncertainty =       0.002008686697

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402007593
  error estimate for blocks of size 2^( 2) =       0.000414961414
  error estimate for blocks of size 2^( 3) =       0.000428703849
  error estimate for blocks of size 2^( 4) =       0.000440909094
  error estimate for blocks of size 2^( 5) =       0.000450230595
  error estimate for blocks of size 2^( 6) =       0.000455678850
  error estimate for blocks of size 2^( 7) =       0.000461476351

      target function =                  N/A
              le_mean =     -16.905875999030
             les_mean =     286.143254107637
             stat err =       0.000452073722
             autocorr =       1.264590790993
              std dev =       0.568524590577
             le_variance =       0.323220210090

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323170650655
                                         uncertainty =       0.002008726940

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323170650655
                                         uncertainty =       0.002008726940

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402007482
  error estimate for blocks of size 2^( 2) =       0.000414961225
  error estimate for blocks of size 2^( 3) =       0.000428703619
  error estimate for blocks of size 2^( 4) =       0.000440908797
  error estimate for blocks of size 2^( 5) =       0.000450230256
  error estimate for blocks of size 2^( 6) =       0.000455678516
  error estimate for blocks of size 2^( 7) =       0.000461476073

      target function =                  N/A
              le_mean =     -16.905876009024
             les_mean =     286.143254582379
             stat err =       0.000452073411
             autocorr =       1.264589745777
              std dev =       0.568524433234
             le_variance =       0.323220031184

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323170735605
                                         uncertainty =       0.002008706827

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323170735605
                                         uncertainty =       0.002008706827

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402007537
  error estimate for blocks of size 2^( 2) =       0.000414961319
  error estimate for blocks of size 2^( 3) =       0.000428703733
  error estimate for blocks of size 2^( 4) =       0.000440908945
  error estimate for blocks of size 2^( 5) =       0.000450230425
  error estimate for blocks of size 2^( 6) =       0.000455678682
  error estimate for blocks of size 2^( 7) =       0.000461476212

      target function =                  N/A
              le_mean =     -16.905876004008
             les_mean =     286.143254331623
             stat err =       0.000452073566
             autocorr =       1.264590268300
              std dev =       0.568524511043
             le_variance =       0.323220119657

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323170811591
                                         uncertainty =       0.002008689213

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323170811591
                                         uncertainty =       0.002008689213

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402007586
  error estimate for blocks of size 2^( 2) =       0.000414961402
  error estimate for blocks of size 2^( 3) =       0.000428703834
  error estimate for blocks of size 2^( 4) =       0.000440909075
  error estimate for blocks of size 2^( 5) =       0.000450230573
  error estimate for blocks of size 2^( 6) =       0.000455678829
  error estimate for blocks of size 2^( 7) =       0.000461476334

      target function =                  N/A
              le_mean =     -16.905875999649
             les_mean =     286.143254134215
             stat err =       0.000452073703
             autocorr =       1.264590725663
              std dev =       0.568524580590
             le_variance =       0.323220198735


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905875999030        initial
     1.3235e+02     1.3235e+03             2.2498e-06       -16.905876009024  <--
     5.2940e+02     5.2940e+03             5.6319e-07       -16.905876004008
     2.1176e+03     2.1176e+04             1.4085e-07       -16.905875999649

*****************************************************************************
Applying the update for shift_i =   1.3235e+02     and shift_s =   1.3235e+03
*****************************************************************************

  Execution time = 3.0702e+01
  </log>
  <optVariables href="H2O.s080.opt.xml">
   uu_0                 3.131899e-01 1 1  ON 0
   uu_1                 1.455901e-01 1 1  ON 1
   uu_2                 4.336717e-02 1 1  ON 2
   uu_3                -1.980200e-02 1 1  ON 3
   uu_4                -6.660865e-02 1 1  ON 4
   uu_5                -1.030358e-01 1 1  ON 5
   uu_6                -1.322554e-01 1 1  ON 6
   uu_7                -1.479634e-01 1 1  ON 7
   uu_8                -1.413662e-01 1 1  ON 8
   uu_9                -1.139477e-01 1 1  ON 9
   ud_0                 4.516391e-01 1 1  ON 10
   ud_1                 1.857589e-01 1 1  ON 11
   ud_2                 6.519110e-02 1 1  ON 12
   ud_3                -6.068106e-03 1 1  ON 13
   ud_4                -6.373734e-02 1 1  ON 14
   ud_5                -1.062763e-01 1 1  ON 15
   ud_6                -1.349650e-01 1 1  ON 16
   ud_7                -1.530845e-01 1 1  ON 17
   ud_8                -1.549919e-01 1 1  ON 18
   ud_9                -1.457353e-01 1 1  ON 19
   eO_0                -7.486299e-01 1 1  ON 20
   eO_1                -4.276498e-01 1 1  ON 21
   eO_2                -1.610595e-02 1 1  ON 22
   eO_3                 2.978239e-01 1 1  ON 23
   eO_4                 5.259032e-01 1 1  ON 24
   eO_5                 4.903962e-01 1 1  ON 25
   eO_6                 2.635977e-01 1 1  ON 26
   eO_7                -4.211447e-02 1 1  ON 27
   eO_8                -2.366110e-01 1 1  ON 28
   eO_9                -1.026134e-01 1 1  ON 29
  eH1_0                -2.659717e-01 1 1  ON 30
  eH1_1                -1.582702e-01 1 1  ON 31
  eH1_2                -1.081261e-01 1 1  ON 32
  eH1_3                -5.236090e-02 1 1  ON 33
  eH1_4                -1.609465e-03 1 1  ON 34
  eH1_5                 3.478910e-02 1 1  ON 35
  eH1_6                 9.780263e-02 1 1  ON 36
  eH1_7                 1.596920e-01 1 1  ON 37
  eH1_8                 1.971218e-01 1 1  ON 38
  eH1_9                 9.583136e-02 1 1  ON 39
  eH2_0                -2.643158e-01 1 1  ON 40
  eH2_1                -1.565320e-01 1 1  ON 41
  eH2_2                -1.065217e-01 1 1  ON 42
  eH2_3                -5.076058e-02 1 1  ON 43
  eH2_4                -1.267935e-05 1 1  ON 44
  eH2_5                 3.715435e-02 1 1  ON 45
  eH2_6                 9.952548e-02 1 1  ON 46
  eH2_7                 1.613419e-01 1 1  ON 47
  eH2_8                 2.013184e-01 1 1  ON 48
  eH2_9                 8.961257e-02 1 1  ON 49
ci_0001                 7.013802e-01 3 1  ON 50
ci_0002                 7.008378e-01 3 1  ON 51
ci_0003                -2.731779e-02 3 1  ON 52
ci_0004                -2.690036e-02 3 1  ON 53
ci_0005                -3.561170e-02 3 1  ON 54
ci_0006                -3.595705e-02 3 1  ON 55
ci_0007                -2.085159e-02 3 1  ON 56
ci_0008                -2.174098e-02 3 1  ON 57
ci_0009                -1.724094e-02 3 1  ON 58
ci_0010                -1.710057e-02 3 1  ON 59
ci_0011                -1.234830e-02 3 1  ON 60
ci_0012                -1.236516e-02 3 1  ON 61
ci_0013                 1.354742e-02 3 1  ON 62
ci_0014                 1.311124e-02 3 1  ON 63
ci_0015                 1.354983e-02 3 1  ON 64
ci_0016                 1.298772e-02 3 1  ON 65
ci_0017                 1.141819e-02 3 1  ON 66
ci_0018                 1.117774e-02 3 1  ON 67
ci_0019                 1.112012e-02 3 1  ON 68
ci_0020                 1.131480e-02 3 1  ON 69
ci_0021                -2.049738e-03 3 1  ON 70
ci_0022                -7.480462e-04 3 1  ON 71
ci_0023                -1.115368e-02 3 1  ON 72
ci_0024                -1.124794e-02 3 1  ON 73
ci_0025                -1.064811e-02 3 1  ON 74
ci_0026                -1.057393e-02 3 1  ON 75
ci_0027                -1.148095e-02 3 1  ON 76
ci_0028                -1.114237e-02 3 1  ON 77
ci_0029                -1.047660e-02 3 1  ON 78
ci_0030                -1.097001e-02 3 1  ON 79
ci_0031                 2.088532e-02 3 1  ON 80
ci_0032                 2.093625e-02 3 1  ON 81
ci_0033                 9.673145e-03 3 1  ON 82
ci_0034                 9.993463e-03 3 1  ON 83
ci_0035                 6.862771e-03 3 1  ON 84
ci_0036                 6.409929e-03 3 1  ON 85
ci_0037                -1.014246e-02 3 1  ON 86
ci_0038                -1.102031e-02 3 1  ON 87
ci_0039                -2.670452e-03 3 1  ON 88
ci_0040                -2.754198e-03 3 1  ON 89
ci_0041                 7.450086e-03 3 1  ON 90
ci_0042                 6.945167e-03 3 1  ON 91
ci_0043                -1.883176e-02 3 1  ON 92
ci_0044                -1.904732e-02 3 1  ON 93
ci_0045                 7.611008e-03 3 1  ON 94
ci_0046                 7.551667e-03 3 1  ON 95
ci_0047                -1.738394e-03 3 1  ON 96
ci_0048                -2.083691e-03 3 1  ON 97
ci_0049                -5.976558e-03 3 1  ON 98
ci_0050                -5.886503e-03 3 1  ON 99
ci_0051                -3.451799e-03 3 1  ON 100
ci_0052                -3.212236e-03 3 1  ON 101
ci_0053                -4.682930e-03 3 1  ON 102
ci_0054                -4.539864e-03 3 1  ON 103
ci_0055                 6.291351e-03 3 1  ON 104
ci_0056                 6.762423e-03 3 1  ON 105
ci_0057                 4.859718e-03 3 1  ON 106
ci_0058                 4.628230e-03 3 1  ON 107
ci_0059                -4.752389e-03 3 1  ON 108
ci_0060                -4.786587e-03 3 1  ON 109
ci_0061                -3.577746e-03 3 1  ON 110
ci_0062                -3.354377e-03 3 1  ON 111
ci_0063                -8.439253e-03 3 1  ON 112
ci_0064                -8.194441e-03 3 1  ON 113
ci_0065                -5.440248e-03 3 1  ON 114
ci_0066                -5.562600e-03 3 1  ON 115
ci_0067                -4.728097e-03 3 1  ON 116
ci_0068                -5.149601e-03 3 1  ON 117
ci_0069                 4.348626e-03 3 1  ON 118
ci_0070                 4.249077e-03 3 1  ON 119
ci_0071                -1.005285e-04 3 1  ON 120
ci_0072                 4.284993e-04 3 1  ON 121
ci_0073                 4.210845e-03 3 1  ON 122
ci_0074                 4.252583e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7948e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s081 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s081 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=81  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 81
    time step          = 0.05
    reference energy   = -16.8777
    reference variance = 0.361655
====================================================
  Execution time = 2.1240e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s081
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5235e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3476e-01
  Total weights = 1.951967958e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0811e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320540636425
                                         uncertainty =       0.001815693746

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320540636425
                                         uncertainty =       0.001815693746

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400347939
  error estimate for blocks of size 2^( 2) =       0.000413500980
  error estimate for blocks of size 2^( 3) =       0.000426608509
  error estimate for blocks of size 2^( 4) =       0.000439203458
  error estimate for blocks of size 2^( 5) =       0.000449853209
  error estimate for blocks of size 2^( 6) =       0.000456820627
  error estimate for blocks of size 2^( 7) =       0.000462560631

      target function =                  N/A
              le_mean =     -16.905698921371
             les_mean =     286.137416376566
             stat err =       0.000452109482
             autocorr =       1.275299051334
              std dev =       0.566177484571
             le_variance =       0.320556944035


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690569892137e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.3087e+01, overlap shift 3.3087e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905698921339       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905698977231       residual = 4.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905698975866       residual = 3.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905698967868       residual = 6.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905698959330       residual = 6.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905698961146       residual = 2.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905698966091       residual = 7.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905698974692       residual = 2.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905698971062       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905698971131       residual = 3.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.3087e+01 is 8.147351e-06

solving harmonic davidson linear method for identity shift 1.3235e+02, overlap shift 1.3235e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905698921339       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905698935381       residual = 4.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905698935048       residual = 3.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905698933051       residual = 6.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905698930914       residual = 6.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905698931352       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905698932604       residual = 7.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905698934787       residual = 2.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905698933887       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905698933892       residual = 3.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.3235e+02 is 2.049734e-06

solving harmonic davidson linear method for identity shift 5.2940e+02, overlap shift 5.2940e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905698921339       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905698924854       residual = 4.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905698924772       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905698924272       residual = 6.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905698923738       residual = 6.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905698923847       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905698924160       residual = 7.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905698924707       residual = 2.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905698924484       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905698924485       residual = 3.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.2940e+02 is 5.132462e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.673179 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7329e+01
  </log>
  <optVariables href="H2O.s081.opt.xml">
   uu_0                 3.131900e-01 1 1  ON 0
   uu_1                 1.455897e-01 1 1  ON 1
   uu_2                 4.336727e-02 1 1  ON 2
   uu_3                -1.980304e-02 1 1  ON 3
   uu_4                -6.660916e-02 1 1  ON 4
   uu_5                -1.030354e-01 1 1  ON 5
   uu_6                -1.322545e-01 1 1  ON 6
   uu_7                -1.479633e-01 1 1  ON 7
   uu_8                -1.413667e-01 1 1  ON 8
   uu_9                -1.139477e-01 1 1  ON 9
   ud_0                 4.516400e-01 1 1  ON 10
   ud_1                 1.857587e-01 1 1  ON 11
   ud_2                 6.519187e-02 1 1  ON 12
   ud_3                -6.068248e-03 1 1  ON 13
   ud_4                -6.373735e-02 1 1  ON 14
   ud_5                -1.062772e-01 1 1  ON 15
   ud_6                -1.349654e-01 1 1  ON 16
   ud_7                -1.530849e-01 1 1  ON 17
   ud_8                -1.549915e-01 1 1  ON 18
   ud_9                -1.457350e-01 1 1  ON 19
   eO_0                -7.486298e-01 1 1  ON 20
   eO_1                -4.276498e-01 1 1  ON 21
   eO_2                -1.610679e-02 1 1  ON 22
   eO_3                 2.978245e-01 1 1  ON 23
   eO_4                 5.259037e-01 1 1  ON 24
   eO_5                 4.903970e-01 1 1  ON 25
   eO_6                 2.635982e-01 1 1  ON 26
   eO_7                -4.211462e-02 1 1  ON 27
   eO_8                -2.366114e-01 1 1  ON 28
   eO_9                -1.026143e-01 1 1  ON 29
  eH1_0                -2.659719e-01 1 1  ON 30
  eH1_1                -1.582701e-01 1 1  ON 31
  eH1_2                -1.081266e-01 1 1  ON 32
  eH1_3                -5.236194e-02 1 1  ON 33
  eH1_4                -1.609998e-03 1 1  ON 34
  eH1_5                 3.478944e-02 1 1  ON 35
  eH1_6                 9.780206e-02 1 1  ON 36
  eH1_7                 1.596919e-01 1 1  ON 37
  eH1_8                 1.971224e-01 1 1  ON 38
  eH1_9                 9.583298e-02 1 1  ON 39
  eH2_0                -2.643158e-01 1 1  ON 40
  eH2_1                -1.565325e-01 1 1  ON 41
  eH2_2                -1.065222e-01 1 1  ON 42
  eH2_3                -5.076058e-02 1 1  ON 43
  eH2_4                -1.266962e-05 1 1  ON 44
  eH2_5                 3.715351e-02 1 1  ON 45
  eH2_6                 9.952511e-02 1 1  ON 46
  eH2_7                 1.613419e-01 1 1  ON 47
  eH2_8                 2.013188e-01 1 1  ON 48
  eH2_9                 8.961402e-02 1 1  ON 49
ci_0001                 7.013805e-01 3 1  ON 50
ci_0002                 7.008373e-01 3 1  ON 51
ci_0003                -2.731878e-02 3 1  ON 52
ci_0004                -2.689922e-02 3 1  ON 53
ci_0005                -3.561349e-02 3 1  ON 54
ci_0006                -3.595886e-02 3 1  ON 55
ci_0007                -2.085238e-02 3 1  ON 56
ci_0008                -2.173990e-02 3 1  ON 57
ci_0009                -1.724126e-02 3 1  ON 58
ci_0010                -1.709948e-02 3 1  ON 59
ci_0011                -1.234652e-02 3 1  ON 60
ci_0012                -1.236557e-02 3 1  ON 61
ci_0013                 1.354690e-02 3 1  ON 62
ci_0014                 1.311288e-02 3 1  ON 63
ci_0015                 1.355036e-02 3 1  ON 64
ci_0016                 1.298819e-02 3 1  ON 65
ci_0017                 1.141721e-02 3 1  ON 66
ci_0018                 1.117868e-02 3 1  ON 67
ci_0019                 1.112183e-02 3 1  ON 68
ci_0020                 1.131290e-02 3 1  ON 69
ci_0021                -2.048040e-03 3 1  ON 70
ci_0022                -7.488212e-04 3 1  ON 71
ci_0023                -1.115496e-02 3 1  ON 72
ci_0024                -1.124769e-02 3 1  ON 73
ci_0025                -1.064726e-02 3 1  ON 74
ci_0026                -1.057418e-02 3 1  ON 75
ci_0027                -1.148008e-02 3 1  ON 76
ci_0028                -1.114263e-02 3 1  ON 77
ci_0029                -1.047632e-02 3 1  ON 78
ci_0030                -1.097052e-02 3 1  ON 79
ci_0031                 2.088591e-02 3 1  ON 80
ci_0032                 2.093679e-02 3 1  ON 81
ci_0033                 9.673726e-03 3 1  ON 82
ci_0034                 9.993126e-03 3 1  ON 83
ci_0035                 6.863157e-03 3 1  ON 84
ci_0036                 6.411018e-03 3 1  ON 85
ci_0037                -1.014281e-02 3 1  ON 86
ci_0038                -1.101975e-02 3 1  ON 87
ci_0039                -2.671180e-03 3 1  ON 88
ci_0040                -2.752429e-03 3 1  ON 89
ci_0041                 7.449169e-03 3 1  ON 90
ci_0042                 6.946932e-03 3 1  ON 91
ci_0043                -1.883140e-02 3 1  ON 92
ci_0044                -1.904695e-02 3 1  ON 93
ci_0045                 7.610897e-03 3 1  ON 94
ci_0046                 7.551870e-03 3 1  ON 95
ci_0047                -1.738602e-03 3 1  ON 96
ci_0048                -2.082635e-03 3 1  ON 97
ci_0049                -5.975094e-03 3 1  ON 98
ci_0050                -5.885595e-03 3 1  ON 99
ci_0051                -3.453430e-03 3 1  ON 100
ci_0052                -3.212324e-03 3 1  ON 101
ci_0053                -4.683432e-03 3 1  ON 102
ci_0054                -4.539928e-03 3 1  ON 103
ci_0055                 6.290836e-03 3 1  ON 104
ci_0056                 6.761346e-03 3 1  ON 105
ci_0057                 4.859203e-03 3 1  ON 106
ci_0058                 4.627637e-03 3 1  ON 107
ci_0059                -4.753343e-03 3 1  ON 108
ci_0060                -4.786665e-03 3 1  ON 109
ci_0061                -3.577379e-03 3 1  ON 110
ci_0062                -3.355531e-03 3 1  ON 111
ci_0063                -8.439940e-03 3 1  ON 112
ci_0064                -8.196490e-03 3 1  ON 113
ci_0065                -5.439312e-03 3 1  ON 114
ci_0066                -5.561732e-03 3 1  ON 115
ci_0067                -4.728066e-03 3 1  ON 116
ci_0068                -5.149298e-03 3 1  ON 117
ci_0069                 4.349936e-03 3 1  ON 118
ci_0070                 4.250601e-03 3 1  ON 119
ci_0071                -1.015574e-04 3 1  ON 120
ci_0072                 4.282085e-04 3 1  ON 121
ci_0073                 4.209881e-03 3 1  ON 122
ci_0074                 4.253124e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 81
    time step          = 0.05
    reference energy   = -16.923
    reference variance = 0.512781
====================================================
  Execution time = 2.1142e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s081
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4125e-01
  Total weights = 1.9517e+06
  Execution time = 1.9136e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327386914375
                                         uncertainty =       0.004023216769

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327386914375
                                         uncertainty =       0.004023216769

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404556150
  error estimate for blocks of size 2^( 2) =       0.000417288442
  error estimate for blocks of size 2^( 3) =       0.000430927191
  error estimate for blocks of size 2^( 4) =       0.000442754895
  error estimate for blocks of size 2^( 5) =       0.000453173575
  error estimate for blocks of size 2^( 6) =       0.000460964863
  error estimate for blocks of size 2^( 7) =       0.000465467110

      target function =                  N/A
              le_mean =     -16.906667162811
             les_mean =     286.176637462915
             stat err =       0.000455590111
             autocorr =       1.268209383926
              std dev =       0.572128793455
             le_variance =       0.327331356301

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327389461819
                                         uncertainty =       0.004023037679

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327389461819
                                         uncertainty =       0.004023037679

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404557715
  error estimate for blocks of size 2^( 2) =       0.000417289813
  error estimate for blocks of size 2^( 3) =       0.000430928235
  error estimate for blocks of size 2^( 4) =       0.000442755684
  error estimate for blocks of size 2^( 5) =       0.000453174105
  error estimate for blocks of size 2^( 6) =       0.000460965367
  error estimate for blocks of size 2^( 7) =       0.000465467129

      target function =                  N/A
              le_mean =     -16.906667237075
             les_mean =     286.176655104288
             stat err =       0.000455590571
             autocorr =       1.268202134267
              std dev =       0.572131007079
             le_variance =       0.327333889261

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327388192916
                                         uncertainty =       0.004023128942

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327388192916
                                         uncertainty =       0.004023128942

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404556935
  error estimate for blocks of size 2^( 2) =       0.000417289130
  error estimate for blocks of size 2^( 3) =       0.000430927714
  error estimate for blocks of size 2^( 4) =       0.000442755290
  error estimate for blocks of size 2^( 5) =       0.000453173839
  error estimate for blocks of size 2^( 6) =       0.000460965115
  error estimate for blocks of size 2^( 7) =       0.000465467120

      target function =                  N/A
              le_mean =     -16.906667199550
             les_mean =     286.176645462307
             stat err =       0.000455590341
             autocorr =       1.268205741766
              std dev =       0.572129904451
             le_variance =       0.327332627568

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327387073859
                                         uncertainty =       0.004023205837

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327387073859
                                         uncertainty =       0.004023205837

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404556248
  error estimate for blocks of size 2^( 2) =       0.000417288528
  error estimate for blocks of size 2^( 3) =       0.000430927256
  error estimate for blocks of size 2^( 4) =       0.000442754944
  error estimate for blocks of size 2^( 5) =       0.000453173607
  error estimate for blocks of size 2^( 6) =       0.000460964894
  error estimate for blocks of size 2^( 7) =       0.000465467111

      target function =                  N/A
              le_mean =     -16.906667167337
             les_mean =     286.176638369298
             stat err =       0.000455590139
             autocorr =       1.268208928242
              std dev =       0.572128932037
             le_variance =       0.327331514874


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906667162811        initial
     3.3087e+01     3.3087e+02             8.1474e-06       -16.906667237075  <--
     1.3235e+02     1.3235e+03             2.0497e-06       -16.906667199550
     5.2940e+02     5.2940e+03             5.1325e-07       -16.906667167337

*****************************************************************************
Applying the update for shift_i =   3.3087e+01     and shift_s =   3.3087e+02
*****************************************************************************

  Execution time = 3.0953e+01
  </log>
  <optVariables href="H2O.s081.opt.xml">
   uu_0                 3.131905e-01 1 1  ON 0
   uu_1                 1.455883e-01 1 1  ON 1
   uu_2                 4.336753e-02 1 1  ON 2
   uu_3                -1.980614e-02 1 1  ON 3
   uu_4                -6.661070e-02 1 1  ON 4
   uu_5                -1.030343e-01 1 1  ON 5
   uu_6                -1.322519e-01 1 1  ON 6
   uu_7                -1.479629e-01 1 1  ON 7
   uu_8                -1.413682e-01 1 1  ON 8
   uu_9                -1.139477e-01 1 1  ON 9
   ud_0                 4.516426e-01 1 1  ON 10
   ud_1                 1.857579e-01 1 1  ON 11
   ud_2                 6.519413e-02 1 1  ON 12
   ud_3                -6.068655e-03 1 1  ON 13
   ud_4                -6.373738e-02 1 1  ON 14
   ud_5                -1.062802e-01 1 1  ON 15
   ud_6                -1.349666e-01 1 1  ON 16
   ud_7                -1.530864e-01 1 1  ON 17
   ud_8                -1.549905e-01 1 1  ON 18
   ud_9                -1.457338e-01 1 1  ON 19
   eO_0                -7.486295e-01 1 1  ON 20
   eO_1                -4.276497e-01 1 1  ON 21
   eO_2                -1.610931e-02 1 1  ON 22
   eO_3                 2.978264e-01 1 1  ON 23
   eO_4                 5.259054e-01 1 1  ON 24
   eO_5                 4.903993e-01 1 1  ON 25
   eO_6                 2.635998e-01 1 1  ON 26
   eO_7                -4.211509e-02 1 1  ON 27
   eO_8                -2.366126e-01 1 1  ON 28
   eO_9                -1.026171e-01 1 1  ON 29
  eH1_0                -2.659727e-01 1 1  ON 30
  eH1_1                -1.582700e-01 1 1  ON 31
  eH1_2                -1.081281e-01 1 1  ON 32
  eH1_3                -5.236502e-02 1 1  ON 33
  eH1_4                -1.611600e-03 1 1  ON 34
  eH1_5                 3.479048e-02 1 1  ON 35
  eH1_6                 9.780038e-02 1 1  ON 36
  eH1_7                 1.596918e-01 1 1  ON 37
  eH1_8                 1.971243e-01 1 1  ON 38
  eH1_9                 9.583785e-02 1 1  ON 39
  eH2_0                -2.643160e-01 1 1  ON 40
  eH2_1                -1.565339e-01 1 1  ON 41
  eH2_2                -1.065235e-01 1 1  ON 42
  eH2_3                -5.076058e-02 1 1  ON 43
  eH2_4                -1.264041e-05 1 1  ON 44
  eH2_5                 3.715099e-02 1 1  ON 45
  eH2_6                 9.952401e-02 1 1  ON 46
  eH2_7                 1.613421e-01 1 1  ON 47
  eH2_8                 2.013201e-01 1 1  ON 48
  eH2_9                 8.961835e-02 1 1  ON 49
ci_0001                 7.013814e-01 3 1  ON 50
ci_0002                 7.008358e-01 3 1  ON 51
ci_0003                -2.732173e-02 3 1  ON 52
ci_0004                -2.689580e-02 3 1  ON 53
ci_0005                -3.561882e-02 3 1  ON 54
ci_0006                -3.596425e-02 3 1  ON 55
ci_0007                -2.085473e-02 3 1  ON 56
ci_0008                -2.173669e-02 3 1  ON 57
ci_0009                -1.724223e-02 3 1  ON 58
ci_0010                -1.709625e-02 3 1  ON 59
ci_0011                -1.234122e-02 3 1  ON 60
ci_0012                -1.236678e-02 3 1  ON 61
ci_0013                 1.354535e-02 3 1  ON 62
ci_0014                 1.311777e-02 3 1  ON 63
ci_0015                 1.355192e-02 3 1  ON 64
ci_0016                 1.298958e-02 3 1  ON 65
ci_0017                 1.141428e-02 3 1  ON 66
ci_0018                 1.118150e-02 3 1  ON 67
ci_0019                 1.112693e-02 3 1  ON 68
ci_0020                 1.130724e-02 3 1  ON 69
ci_0021                -2.042960e-03 3 1  ON 70
ci_0022                -7.511381e-04 3 1  ON 71
ci_0023                -1.115876e-02 3 1  ON 72
ci_0024                -1.124693e-02 3 1  ON 73
ci_0025                -1.064475e-02 3 1  ON 74
ci_0026                -1.057491e-02 3 1  ON 75
ci_0027                -1.147748e-02 3 1  ON 76
ci_0028                -1.114340e-02 3 1  ON 77
ci_0029                -1.047547e-02 3 1  ON 78
ci_0030                -1.097203e-02 3 1  ON 79
ci_0031                 2.088770e-02 3 1  ON 80
ci_0032                 2.093838e-02 3 1  ON 81
ci_0033                 9.675466e-03 3 1  ON 82
ci_0034                 9.992120e-03 3 1  ON 83
ci_0035                 6.864310e-03 3 1  ON 84
ci_0036                 6.414267e-03 3 1  ON 85
ci_0037                -1.014383e-02 3 1  ON 86
ci_0038                -1.101808e-02 3 1  ON 87
ci_0039                -2.673342e-03 3 1  ON 88
ci_0040                -2.747179e-03 3 1  ON 89
ci_0041                 7.446435e-03 3 1  ON 90
ci_0042                 6.952195e-03 3 1  ON 91
ci_0043                -1.883031e-02 3 1  ON 92
ci_0044                -1.904581e-02 3 1  ON 93
ci_0045                 7.610565e-03 3 1  ON 94
ci_0046                 7.552475e-03 3 1  ON 95
ci_0047                -1.739223e-03 3 1  ON 96
ci_0048                -2.079501e-03 3 1  ON 97
ci_0049                -5.970732e-03 3 1  ON 98
ci_0050                -5.882885e-03 3 1  ON 99
ci_0051                -3.458279e-03 3 1  ON 100
ci_0052                -3.212586e-03 3 1  ON 101
ci_0053                -4.684922e-03 3 1  ON 102
ci_0054                -4.540115e-03 3 1  ON 103
ci_0055                 6.289297e-03 3 1  ON 104
ci_0056                 6.758134e-03 3 1  ON 105
ci_0057                 4.857662e-03 3 1  ON 106
ci_0058                 4.625867e-03 3 1  ON 107
ci_0059                -4.756182e-03 3 1  ON 108
ci_0060                -4.786899e-03 3 1  ON 109
ci_0061                -3.576285e-03 3 1  ON 110
ci_0062                -3.358971e-03 3 1  ON 111
ci_0063                -8.441983e-03 3 1  ON 112
ci_0064                -8.202588e-03 3 1  ON 113
ci_0065                -5.436528e-03 3 1  ON 114
ci_0066                -5.559146e-03 3 1  ON 115
ci_0067                -4.727971e-03 3 1  ON 116
ci_0068                -5.148396e-03 3 1  ON 117
ci_0069                 4.353825e-03 3 1  ON 118
ci_0070                 4.255127e-03 3 1  ON 119
ci_0071                -1.046225e-04 3 1  ON 120
ci_0072                 4.273431e-04 3 1  ON 121
ci_0073                 4.207017e-03 3 1  ON 122
ci_0074                 4.254729e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8288e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s082 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s082 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=82  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 82
    time step          = 0.05
    reference energy   = -16.9189
    reference variance = 0.259893
====================================================
  Execution time = 2.3241e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s082
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5218e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4147e-01
  Total weights = 1.951689837e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0517e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324771957887
                                         uncertainty =       0.005512273538

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324771957887
                                         uncertainty =       0.005512273538

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402962126
  error estimate for blocks of size 2^( 2) =       0.000415489837
  error estimate for blocks of size 2^( 3) =       0.000427960108
  error estimate for blocks of size 2^( 4) =       0.000440861521
  error estimate for blocks of size 2^( 5) =       0.000451292593
  error estimate for blocks of size 2^( 6) =       0.000459089792
  error estimate for blocks of size 2^( 7) =       0.000461325059

      target function =                  N/A
              le_mean =     -16.905870947804
             les_mean =     286.149945001773
             stat err =       0.000453142241
             autocorr =       1.264563491923
              std dev =       0.569874503186
             le_variance =       0.324756949381


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690587094780e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.2718e+00, overlap shift 8.2718e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905870947807       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905871090785       residual = 5.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905871076002       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905871064201       residual = 7.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905871060912       residual = 4.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905870994946       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905871002066       residual = 8.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905871004664       residual = 3.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905871011110       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905871018524       residual = 3.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 8.2718e+00 is 4.973602e-05

solving harmonic davidson linear method for identity shift 3.3087e+01, overlap shift 3.3087e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905870947807       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905870984318       residual = 5.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905870980561       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905870977567       residual = 7.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905870976707       residual = 4.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905870959754       residual = 2.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905870961319       residual = 8.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905870962020       residual = 3.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905870963531       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905870965306       residual = 3.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.3087e+01 is 1.276924e-05

solving harmonic davidson linear method for identity shift 1.3235e+02, overlap shift 1.3235e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905870947807       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905870956984       residual = 5.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905870956040       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905870955290       residual = 8.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905870955073       residual = 4.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905870950805       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905870951182       residual = 8.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905870951359       residual = 3.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905870951732       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905870952170       residual = 3.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.3235e+02 is 3.213985e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.677144 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9301e+01
  </log>
  <optVariables href="H2O.s082.opt.xml">
   uu_0                 3.131911e-01 1 1  ON 0
   uu_1                 1.455904e-01 1 1  ON 1
   uu_2                 4.336716e-02 1 1  ON 2
   uu_3                -1.980630e-02 1 1  ON 3
   uu_4                -6.661008e-02 1 1  ON 4
   uu_5                -1.030359e-01 1 1  ON 5
   uu_6                -1.322529e-01 1 1  ON 6
   uu_7                -1.479641e-01 1 1  ON 7
   uu_8                -1.413693e-01 1 1  ON 8
   uu_9                -1.139497e-01 1 1  ON 9
   ud_0                 4.516417e-01 1 1  ON 10
   ud_1                 1.857581e-01 1 1  ON 11
   ud_2                 6.519694e-02 1 1  ON 12
   ud_3                -6.070027e-03 1 1  ON 13
   ud_4                -6.373558e-02 1 1  ON 14
   ud_5                -1.062804e-01 1 1  ON 15
   ud_6                -1.349666e-01 1 1  ON 16
   ud_7                -1.530835e-01 1 1  ON 17
   ud_8                -1.549942e-01 1 1  ON 18
   ud_9                -1.457343e-01 1 1  ON 19
   eO_0                -7.486264e-01 1 1  ON 20
   eO_1                -4.276520e-01 1 1  ON 21
   eO_2                -1.610840e-02 1 1  ON 22
   eO_3                 2.978292e-01 1 1  ON 23
   eO_4                 5.259069e-01 1 1  ON 24
   eO_5                 4.904020e-01 1 1  ON 25
   eO_6                 2.635988e-01 1 1  ON 26
   eO_7                -4.211584e-02 1 1  ON 27
   eO_8                -2.366162e-01 1 1  ON 28
   eO_9                -1.026200e-01 1 1  ON 29
  eH1_0                -2.659733e-01 1 1  ON 30
  eH1_1                -1.582734e-01 1 1  ON 31
  eH1_2                -1.081319e-01 1 1  ON 32
  eH1_3                -5.236310e-02 1 1  ON 33
  eH1_4                -1.609973e-03 1 1  ON 34
  eH1_5                 3.479130e-02 1 1  ON 35
  eH1_6                 9.779806e-02 1 1  ON 36
  eH1_7                 1.596906e-01 1 1  ON 37
  eH1_8                 1.971240e-01 1 1  ON 38
  eH1_9                 9.584340e-02 1 1  ON 39
  eH2_0                -2.643156e-01 1 1  ON 40
  eH2_1                -1.565359e-01 1 1  ON 41
  eH2_2                -1.065256e-01 1 1  ON 42
  eH2_3                -5.076125e-02 1 1  ON 43
  eH2_4                -1.431302e-05 1 1  ON 44
  eH2_5                 3.714732e-02 1 1  ON 45
  eH2_6                 9.952259e-02 1 1  ON 46
  eH2_7                 1.613451e-01 1 1  ON 47
  eH2_8                 2.013229e-01 1 1  ON 48
  eH2_9                 8.962315e-02 1 1  ON 49
ci_0001                 7.013792e-01 3 1  ON 50
ci_0002                 7.008378e-01 3 1  ON 51
ci_0003                -2.732144e-02 3 1  ON 52
ci_0004                -2.689395e-02 3 1  ON 53
ci_0005                -3.562574e-02 3 1  ON 54
ci_0006                -3.596386e-02 3 1  ON 55
ci_0007                -2.085166e-02 3 1  ON 56
ci_0008                -2.174266e-02 3 1  ON 57
ci_0009                -1.725152e-02 3 1  ON 58
ci_0010                -1.709753e-02 3 1  ON 59
ci_0011                -1.233838e-02 3 1  ON 60
ci_0012                -1.235870e-02 3 1  ON 61
ci_0013                 1.354020e-02 3 1  ON 62
ci_0014                 1.311862e-02 3 1  ON 63
ci_0015                 1.355645e-02 3 1  ON 64
ci_0016                 1.298703e-02 3 1  ON 65
ci_0017                 1.140982e-02 3 1  ON 66
ci_0018                 1.118100e-02 3 1  ON 67
ci_0019                 1.113048e-02 3 1  ON 68
ci_0020                 1.130743e-02 3 1  ON 69
ci_0021                -2.038261e-03 3 1  ON 70
ci_0022                -7.476503e-04 3 1  ON 71
ci_0023                -1.115633e-02 3 1  ON 72
ci_0024                -1.124177e-02 3 1  ON 73
ci_0025                -1.063971e-02 3 1  ON 74
ci_0026                -1.057367e-02 3 1  ON 75
ci_0027                -1.147199e-02 3 1  ON 76
ci_0028                -1.114367e-02 3 1  ON 77
ci_0029                -1.047097e-02 3 1  ON 78
ci_0030                -1.096721e-02 3 1  ON 79
ci_0031                 2.088766e-02 3 1  ON 80
ci_0032                 2.093790e-02 3 1  ON 81
ci_0033                 9.684209e-03 3 1  ON 82
ci_0034                 9.993766e-03 3 1  ON 83
ci_0035                 6.865855e-03 3 1  ON 84
ci_0036                 6.418009e-03 3 1  ON 85
ci_0037                -1.014584e-02 3 1  ON 86
ci_0038                -1.101190e-02 3 1  ON 87
ci_0039                -2.680792e-03 3 1  ON 88
ci_0040                -2.741575e-03 3 1  ON 89
ci_0041                 7.439803e-03 3 1  ON 90
ci_0042                 6.956100e-03 3 1  ON 91
ci_0043                -1.883148e-02 3 1  ON 92
ci_0044                -1.904452e-02 3 1  ON 93
ci_0045                 7.612909e-03 3 1  ON 94
ci_0046                 7.551414e-03 3 1  ON 95
ci_0047                -1.738078e-03 3 1  ON 96
ci_0048                -2.078987e-03 3 1  ON 97
ci_0049                -5.969272e-03 3 1  ON 98
ci_0050                -5.879193e-03 3 1  ON 99
ci_0051                -3.463223e-03 3 1  ON 100
ci_0052                -3.207460e-03 3 1  ON 101
ci_0053                -4.688883e-03 3 1  ON 102
ci_0054                -4.545142e-03 3 1  ON 103
ci_0055                 6.281480e-03 3 1  ON 104
ci_0056                 6.753922e-03 3 1  ON 105
ci_0057                 4.854934e-03 3 1  ON 106
ci_0058                 4.630600e-03 3 1  ON 107
ci_0059                -4.768951e-03 3 1  ON 108
ci_0060                -4.791442e-03 3 1  ON 109
ci_0061                -3.580440e-03 3 1  ON 110
ci_0062                -3.357459e-03 3 1  ON 111
ci_0063                -8.451212e-03 3 1  ON 112
ci_0064                -8.205444e-03 3 1  ON 113
ci_0065                -5.444500e-03 3 1  ON 114
ci_0066                -5.556515e-03 3 1  ON 115
ci_0067                -4.735114e-03 3 1  ON 116
ci_0068                -5.153102e-03 3 1  ON 117
ci_0069                 4.356886e-03 3 1  ON 118
ci_0070                 4.253992e-03 3 1  ON 119
ci_0071                -1.074509e-04 3 1  ON 120
ci_0072                 4.310919e-04 3 1  ON 121
ci_0073                 4.197239e-03 3 1  ON 122
ci_0074                 4.256471e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 82
    time step          = 0.05
    reference energy   = -16.9427
    reference variance = 0.130465
====================================================
  Execution time = 2.1442e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s082
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3857e-01
  Total weights = 1.9520e+06
  Execution time = 1.9236e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326595344390
                                         uncertainty =       0.003681581508

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326595344390
                                         uncertainty =       0.003681581508

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404068294
  error estimate for blocks of size 2^( 2) =       0.000416990603
  error estimate for blocks of size 2^( 3) =       0.000429989127
  error estimate for blocks of size 2^( 4) =       0.000442462158
  error estimate for blocks of size 2^( 5) =       0.000453677745
  error estimate for blocks of size 2^( 6) =       0.000462425594
  error estimate for blocks of size 2^( 7) =       0.000466795066

      target function =                  N/A
              le_mean =     -16.906145221670
             les_mean =     286.156322972154
             stat err =       0.000456340141
             autocorr =       1.275462800661
              std dev =       0.571438860991
             le_variance =       0.326542371851

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326591013937
                                         uncertainty =       0.003683279555

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326591013937
                                         uncertainty =       0.003683279555

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404065659
  error estimate for blocks of size 2^( 2) =       0.000416988009
  error estimate for blocks of size 2^( 3) =       0.000429986365
  error estimate for blocks of size 2^( 4) =       0.000442459379
  error estimate for blocks of size 2^( 5) =       0.000453673966
  error estimate for blocks of size 2^( 6) =       0.000462422450
  error estimate for blocks of size 2^( 7) =       0.000466789696

      target function =                  N/A
              le_mean =     -16.906145293106
             les_mean =     286.156339803917
             stat err =       0.000456336373
             autocorr =       1.275458374720
              std dev =       0.571435134423
             le_variance =       0.326538112853

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326593044727
                                         uncertainty =       0.003682473803

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326593044727
                                         uncertainty =       0.003682473803

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404066893
  error estimate for blocks of size 2^( 2) =       0.000416989227
  error estimate for blocks of size 2^( 3) =       0.000429987665
  error estimate for blocks of size 2^( 4) =       0.000442460693
  error estimate for blocks of size 2^( 5) =       0.000453675769
  error estimate for blocks of size 2^( 6) =       0.000462423947
  error estimate for blocks of size 2^( 7) =       0.000466792280

      target function =                  N/A
              le_mean =     -16.906145247634
             les_mean =     286.156310773471
             stat err =       0.000456338172
             autocorr =       1.275460636613
              std dev =       0.571436880813
             le_variance =       0.326540108753

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326595042167
                                         uncertainty =       0.003681694351

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326595042167
                                         uncertainty =       0.003681694351

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404068110
  error estimate for blocks of size 2^( 2) =       0.000416990422
  error estimate for blocks of size 2^( 3) =       0.000429988935
  error estimate for blocks of size 2^( 4) =       0.000442461967
  error estimate for blocks of size 2^( 5) =       0.000453677489
  error estimate for blocks of size 2^( 6) =       0.000462425380
  error estimate for blocks of size 2^( 7) =       0.000466794708

      target function =                  N/A
              le_mean =     -16.906145223546
             les_mean =     286.156319742907
             stat err =       0.000456339886
             autocorr =       1.275462538508
              std dev =       0.571438600579
             le_variance =       0.326542074231


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906145221670        initial
     8.2718e+00     8.2718e+01             4.9736e-05       -16.906145293106  <--
     3.3087e+01     3.3087e+02             1.2769e-05       -16.906145247634
     1.3235e+02     1.3235e+03             3.2140e-06       -16.906145223546

*****************************************************************************
Applying the update for shift_i =   8.2718e+00     and shift_s =   8.2718e+01
*****************************************************************************

  Execution time = 3.1136e+01
  </log>
  <optVariables href="H2O.s082.opt.xml">
   uu_0                 3.131930e-01 1 1  ON 0
   uu_1                 1.455963e-01 1 1  ON 1
   uu_2                 4.336625e-02 1 1  ON 2
   uu_3                -1.980671e-02 1 1  ON 3
   uu_4                -6.660828e-02 1 1  ON 4
   uu_5                -1.030405e-01 1 1  ON 5
   uu_6                -1.322558e-01 1 1  ON 6
   uu_7                -1.479677e-01 1 1  ON 7
   uu_8                -1.413727e-01 1 1  ON 8
   uu_9                -1.139556e-01 1 1  ON 9
   ud_0                 4.516392e-01 1 1  ON 10
   ud_1                 1.857591e-01 1 1  ON 11
   ud_2                 6.520491e-02 1 1  ON 12
   ud_3                -6.073733e-03 1 1  ON 13
   ud_4                -6.373060e-02 1 1  ON 14
   ud_5                -1.062808e-01 1 1  ON 15
   ud_6                -1.349665e-01 1 1  ON 16
   ud_7                -1.530751e-01 1 1  ON 17
   ud_8                -1.550052e-01 1 1  ON 18
   ud_9                -1.457359e-01 1 1  ON 19
   eO_0                -7.486175e-01 1 1  ON 20
   eO_1                -4.276586e-01 1 1  ON 21
   eO_2                -1.610576e-02 1 1  ON 22
   eO_3                 2.978375e-01 1 1  ON 23
   eO_4                 5.259115e-01 1 1  ON 24
   eO_5                 4.904104e-01 1 1  ON 25
   eO_6                 2.635958e-01 1 1  ON 26
   eO_7                -4.211807e-02 1 1  ON 27
   eO_8                -2.366268e-01 1 1  ON 28
   eO_9                -1.026290e-01 1 1  ON 29
  eH1_0                -2.659754e-01 1 1  ON 30
  eH1_1                -1.582833e-01 1 1  ON 31
  eH1_2                -1.081432e-01 1 1  ON 32
  eH1_3                -5.235760e-02 1 1  ON 33
  eH1_4                -1.605153e-03 1 1  ON 34
  eH1_5                 3.479381e-02 1 1  ON 35
  eH1_6                 9.779113e-02 1 1  ON 36
  eH1_7                 1.596867e-01 1 1  ON 37
  eH1_8                 1.971233e-01 1 1  ON 38
  eH1_9                 9.586002e-02 1 1  ON 39
  eH2_0                -2.643146e-01 1 1  ON 40
  eH2_1                -1.565418e-01 1 1  ON 41
  eH2_2                -1.065319e-01 1 1  ON 42
  eH2_3                -5.076333e-02 1 1  ON 43
  eH2_4                -1.933904e-05 1 1  ON 44
  eH2_5                 3.713638e-02 1 1  ON 45
  eH2_6                 9.951832e-02 1 1  ON 46
  eH2_7                 1.613543e-01 1 1  ON 47
  eH2_8                 2.013314e-01 1 1  ON 48
  eH2_9                 8.963752e-02 1 1  ON 49
ci_0001                 7.013726e-01 3 1  ON 50
ci_0002                 7.008435e-01 3 1  ON 51
ci_0003                -2.732058e-02 3 1  ON 52
ci_0004                -2.688861e-02 3 1  ON 53
ci_0005                -3.564618e-02 3 1  ON 54
ci_0006                -3.596272e-02 3 1  ON 55
ci_0007                -2.084250e-02 3 1  ON 56
ci_0008                -2.176039e-02 3 1  ON 57
ci_0009                -1.727862e-02 3 1  ON 58
ci_0010                -1.710128e-02 3 1  ON 59
ci_0011                -1.233007e-02 3 1  ON 60
ci_0012                -1.233507e-02 3 1  ON 61
ci_0013                 1.352516e-02 3 1  ON 62
ci_0014                 1.312117e-02 3 1  ON 63
ci_0015                 1.356975e-02 3 1  ON 64
ci_0016                 1.297958e-02 3 1  ON 65
ci_0017                 1.139685e-02 3 1  ON 66
ci_0018                 1.117961e-02 3 1  ON 67
ci_0019                 1.114088e-02 3 1  ON 68
ci_0020                 1.130803e-02 3 1  ON 69
ci_0021                -2.024275e-03 3 1  ON 70
ci_0022                -7.373469e-04 3 1  ON 71
ci_0023                -1.114926e-02 3 1  ON 72
ci_0024                -1.122679e-02 3 1  ON 73
ci_0025                -1.062504e-02 3 1  ON 74
ci_0026                -1.057002e-02 3 1  ON 75
ci_0027                -1.145591e-02 3 1  ON 76
ci_0028                -1.114450e-02 3 1  ON 77
ci_0029                -1.045780e-02 3 1  ON 78
ci_0030                -1.095315e-02 3 1  ON 79
ci_0031                 2.088752e-02 3 1  ON 80
ci_0032                 2.093647e-02 3 1  ON 81
ci_0033                 9.710079e-03 3 1  ON 82
ci_0034                 9.998616e-03 3 1  ON 83
ci_0035                 6.870387e-03 3 1  ON 84
ci_0036                 6.429019e-03 3 1  ON 85
ci_0037                -1.015171e-02 3 1  ON 86
ci_0038                -1.099373e-02 3 1  ON 87
ci_0039                -2.702202e-03 3 1  ON 88
ci_0040                -2.725467e-03 3 1  ON 89
ci_0041                 7.420444e-03 3 1  ON 90
ci_0042                 6.967523e-03 3 1  ON 91
ci_0043                -1.883490e-02 3 1  ON 92
ci_0044                -1.904070e-02 3 1  ON 93
ci_0045                 7.619792e-03 3 1  ON 94
ci_0046                 7.548290e-03 3 1  ON 95
ci_0047                -1.734766e-03 3 1  ON 96
ci_0048                -2.077526e-03 3 1  ON 97
ci_0049                -5.964981e-03 3 1  ON 98
ci_0050                -5.868392e-03 3 1  ON 99
ci_0051                -3.477507e-03 3 1  ON 100
ci_0052                -3.192681e-03 3 1  ON 101
ci_0053                -4.700321e-03 3 1  ON 102
ci_0054                -4.559686e-03 3 1  ON 103
ci_0055                 6.258509e-03 3 1  ON 104
ci_0056                 6.741518e-03 3 1  ON 105
ci_0057                 4.846919e-03 3 1  ON 106
ci_0058                 4.644489e-03 3 1  ON 107
ci_0059                -4.805918e-03 3 1  ON 108
ci_0060                -4.804596e-03 3 1  ON 109
ci_0061                -3.592618e-03 3 1  ON 110
ci_0062                -3.353014e-03 3 1  ON 111
ci_0063                -8.477990e-03 3 1  ON 112
ci_0064                -8.213787e-03 3 1  ON 113
ci_0065                -5.467743e-03 3 1  ON 114
ci_0066                -5.548841e-03 3 1  ON 115
ci_0067                -4.755690e-03 3 1  ON 116
ci_0068                -5.166700e-03 3 1  ON 117
ci_0069                 4.365695e-03 3 1  ON 118
ci_0070                 4.250707e-03 3 1  ON 119
ci_0071                -1.156332e-04 3 1  ON 120
ci_0072                 4.421136e-04 3 1  ON 121
ci_0073                 4.169098e-03 3 1  ON 122
ci_0074                 4.261493e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.0443e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s083 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s083 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=83  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 83
    time step          = 0.05
    reference energy   = -16.9647
    reference variance = 0.255844
====================================================
  Execution time = 2.1036e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s083
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5241e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3267e-01
  Total weights = 1.951935797e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0109e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322472772254
                                         uncertainty =       0.002167155144

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322472772254
                                         uncertainty =       0.002167155144

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401535594
  error estimate for blocks of size 2^( 2) =       0.000414634301
  error estimate for blocks of size 2^( 3) =       0.000428246488
  error estimate for blocks of size 2^( 4) =       0.000440932260
  error estimate for blocks of size 2^( 5) =       0.000452970079
  error estimate for blocks of size 2^( 6) =       0.000462668316
  error estimate for blocks of size 2^( 7) =       0.000468401716

      target function =                  N/A
              le_mean =     -16.906183183763
             les_mean =     286.151699001641
             stat err =       0.000456243092
             autocorr =       1.291054295229
              std dev =       0.567857082263
             le_variance =       0.322461665876


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690618318376e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.0680e+00, overlap shift 2.0680e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906183183795       residual = 9.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906185930074       residual = 8.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906185935945       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906185999807       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906186188686       residual = 6.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906186242315       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906186307589       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906186367249       residual = 3.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906186363841       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906186347224       residual = 6.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.0680e+00 is 1.289610e-04

solving harmonic davidson linear method for identity shift 8.2718e+00, overlap shift 8.2718e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906183183795       residual = 9.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906183925290       residual = 8.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906183931647       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906183958161       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906184015067       residual = 6.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906184022049       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906184033821       residual = 9.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906184049721       residual = 3.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906184049382       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906184047025       residual = 4.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 8.2718e+00 is 3.407363e-05

solving harmonic davidson linear method for identity shift 3.3087e+01, overlap shift 3.3087e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906183183795       residual = 9.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906183372951       residual = 8.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906183374929       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906183382357       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906183397167       residual = 6.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906183398645       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906183401216       residual = 9.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906183405100       residual = 3.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906183405123       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906183404594       residual = 3.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.3087e+01 is 8.640565e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.681114 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7055e+01
  </log>
  <optVariables href="H2O.s083.opt.xml">
   uu_0                 3.131794e-01 1 1  ON 0
   uu_1                 1.455937e-01 1 1  ON 1
   uu_2                 4.337690e-02 1 1  ON 2
   uu_3                -1.980355e-02 1 1  ON 3
   uu_4                -6.661284e-02 1 1  ON 4
   uu_5                -1.030462e-01 1 1  ON 5
   uu_6                -1.322773e-01 1 1  ON 6
   uu_7                -1.479679e-01 1 1  ON 7
   uu_8                -1.413680e-01 1 1  ON 8
   uu_9                -1.139539e-01 1 1  ON 9
   ud_0                 4.516267e-01 1 1  ON 10
   ud_1                 1.857429e-01 1 1  ON 11
   ud_2                 6.519932e-02 1 1  ON 12
   ud_3                -6.076775e-03 1 1  ON 13
   ud_4                -6.373075e-02 1 1  ON 14
   ud_5                -1.062830e-01 1 1  ON 15
   ud_6                -1.349723e-01 1 1  ON 16
   ud_7                -1.530605e-01 1 1  ON 17
   ud_8                -1.549787e-01 1 1  ON 18
   ud_9                -1.457216e-01 1 1  ON 19
   eO_0                -7.486085e-01 1 1  ON 20
   eO_1                -4.276438e-01 1 1  ON 21
   eO_2                -1.611593e-02 1 1  ON 22
   eO_3                 2.978413e-01 1 1  ON 23
   eO_4                 5.259097e-01 1 1  ON 24
   eO_5                 4.904052e-01 1 1  ON 25
   eO_6                 2.635954e-01 1 1  ON 26
   eO_7                -4.211368e-02 1 1  ON 27
   eO_8                -2.366273e-01 1 1  ON 28
   eO_9                -1.026403e-01 1 1  ON 29
  eH1_0                -2.659831e-01 1 1  ON 30
  eH1_1                -1.582973e-01 1 1  ON 31
  eH1_2                -1.081506e-01 1 1  ON 32
  eH1_3                -5.236409e-02 1 1  ON 33
  eH1_4                -1.623510e-03 1 1  ON 34
  eH1_5                 3.478652e-02 1 1  ON 35
  eH1_6                 9.779696e-02 1 1  ON 36
  eH1_7                 1.597006e-01 1 1  ON 37
  eH1_8                 1.971342e-01 1 1  ON 38
  eH1_9                 9.588377e-02 1 1  ON 39
  eH2_0                -2.643155e-01 1 1  ON 40
  eH2_1                -1.565499e-01 1 1  ON 41
  eH2_2                -1.065393e-01 1 1  ON 42
  eH2_3                -5.077599e-02 1 1  ON 43
  eH2_4                -1.858939e-05 1 1  ON 44
  eH2_5                 3.713716e-02 1 1  ON 45
  eH2_6                 9.950043e-02 1 1  ON 46
  eH2_7                 1.613525e-01 1 1  ON 47
  eH2_8                 2.013445e-01 1 1  ON 48
  eH2_9                 8.966367e-02 1 1  ON 49
ci_0001                 7.013766e-01 3 1  ON 50
ci_0002                 7.008383e-01 3 1  ON 51
ci_0003                -2.732284e-02 3 1  ON 52
ci_0004                -2.690257e-02 3 1  ON 53
ci_0005                -3.565440e-02 3 1  ON 54
ci_0006                -3.597352e-02 3 1  ON 55
ci_0007                -2.086351e-02 3 1  ON 56
ci_0008                -2.177734e-02 3 1  ON 57
ci_0009                -1.728001e-02 3 1  ON 58
ci_0010                -1.709442e-02 3 1  ON 59
ci_0011                -1.234972e-02 3 1  ON 60
ci_0012                -1.231997e-02 3 1  ON 61
ci_0013                 1.352231e-02 3 1  ON 62
ci_0014                 1.313543e-02 3 1  ON 63
ci_0015                 1.357399e-02 3 1  ON 64
ci_0016                 1.297340e-02 3 1  ON 65
ci_0017                 1.138792e-02 3 1  ON 66
ci_0018                 1.117704e-02 3 1  ON 67
ci_0019                 1.116112e-02 3 1  ON 68
ci_0020                 1.129900e-02 3 1  ON 69
ci_0021                -2.011292e-03 3 1  ON 70
ci_0022                -7.259916e-04 3 1  ON 71
ci_0023                -1.114274e-02 3 1  ON 72
ci_0024                -1.123431e-02 3 1  ON 73
ci_0025                -1.062319e-02 3 1  ON 74
ci_0026                -1.055664e-02 3 1  ON 75
ci_0027                -1.144475e-02 3 1  ON 76
ci_0028                -1.113189e-02 3 1  ON 77
ci_0029                -1.047086e-02 3 1  ON 78
ci_0030                -1.093176e-02 3 1  ON 79
ci_0031                 2.088330e-02 3 1  ON 80
ci_0032                 2.092697e-02 3 1  ON 81
ci_0033                 9.731582e-03 3 1  ON 82
ci_0034                 1.000102e-02 3 1  ON 83
ci_0035                 6.871010e-03 3 1  ON 84
ci_0036                 6.435348e-03 3 1  ON 85
ci_0037                -1.015889e-02 3 1  ON 86
ci_0038                -1.099656e-02 3 1  ON 87
ci_0039                -2.678851e-03 3 1  ON 88
ci_0040                -2.724145e-03 3 1  ON 89
ci_0041                 7.397441e-03 3 1  ON 90
ci_0042                 6.967801e-03 3 1  ON 91
ci_0043                -1.883140e-02 3 1  ON 92
ci_0044                -1.904500e-02 3 1  ON 93
ci_0045                 7.600714e-03 3 1  ON 94
ci_0046                 7.552674e-03 3 1  ON 95
ci_0047                -1.747388e-03 3 1  ON 96
ci_0048                -2.064639e-03 3 1  ON 97
ci_0049                -5.949887e-03 3 1  ON 98
ci_0050                -5.842965e-03 3 1  ON 99
ci_0051                -3.491258e-03 3 1  ON 100
ci_0052                -3.206434e-03 3 1  ON 101
ci_0053                -4.687608e-03 3 1  ON 102
ci_0054                -4.557441e-03 3 1  ON 103
ci_0055                 6.272700e-03 3 1  ON 104
ci_0056                 6.707445e-03 3 1  ON 105
ci_0057                 4.844515e-03 3 1  ON 106
ci_0058                 4.643082e-03 3 1  ON 107
ci_0059                -4.801461e-03 3 1  ON 108
ci_0060                -4.787490e-03 3 1  ON 109
ci_0061                -3.583875e-03 3 1  ON 110
ci_0062                -3.344819e-03 3 1  ON 111
ci_0063                -8.493631e-03 3 1  ON 112
ci_0064                -8.239593e-03 3 1  ON 113
ci_0065                -5.449728e-03 3 1  ON 114
ci_0066                -5.548225e-03 3 1  ON 115
ci_0067                -4.755476e-03 3 1  ON 116
ci_0068                -5.167763e-03 3 1  ON 117
ci_0069                 4.359858e-03 3 1  ON 118
ci_0070                 4.253251e-03 3 1  ON 119
ci_0071                -1.204201e-04 3 1  ON 120
ci_0072                 4.373884e-04 3 1  ON 121
ci_0073                 4.199521e-03 3 1  ON 122
ci_0074                 4.239900e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 83
    time step          = 0.05
    reference energy   = -16.9638
    reference variance = 0.346162
====================================================
  Execution time = 2.0810e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s083
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3738e-01
  Total weights = 1.9516e+06
  Execution time = 1.9239e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326550754669
                                         uncertainty =       0.002215375862

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326550754669
                                         uncertainty =       0.002215375862

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404024039
  error estimate for blocks of size 2^( 2) =       0.000417023703
  error estimate for blocks of size 2^( 3) =       0.000429783351
  error estimate for blocks of size 2^( 4) =       0.000442536069
  error estimate for blocks of size 2^( 5) =       0.000452996543
  error estimate for blocks of size 2^( 6) =       0.000461814709
  error estimate for blocks of size 2^( 7) =       0.000469861054

      target function =                  N/A
              le_mean =     -16.907218746764
             les_mean =     286.191437907934
             stat err =       0.000456802094
             autocorr =       1.278326402383
              std dev =       0.571376275888
             le_variance =       0.326470848647

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326483003239
                                         uncertainty =       0.002211977337

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326483003239
                                         uncertainty =       0.002211977337

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403982186
  error estimate for blocks of size 2^( 2) =       0.000416984510
  error estimate for blocks of size 2^( 3) =       0.000429745864
  error estimate for blocks of size 2^( 4) =       0.000442503554
  error estimate for blocks of size 2^( 5) =       0.000452966323
  error estimate for blocks of size 2^( 6) =       0.000461786154
  error estimate for blocks of size 2^( 7) =       0.000469826664

      target function =                  N/A
              le_mean =     -16.907219518084
             les_mean =     286.191949502537
             stat err =       0.000456770674
             autocorr =       1.278415409621
              std dev =       0.571317086188
             le_variance =       0.326403212971

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326513521101
                                         uncertainty =       0.002213481893

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326513521101
                                         uncertainty =       0.002213481893

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404001038
  error estimate for blocks of size 2^( 2) =       0.000417002114
  error estimate for blocks of size 2^( 3) =       0.000429762665
  error estimate for blocks of size 2^( 4) =       0.000442518134
  error estimate for blocks of size 2^( 5) =       0.000452979856
  error estimate for blocks of size 2^( 6) =       0.000461799099
  error estimate for blocks of size 2^( 7) =       0.000469842337

      target function =                  N/A
              le_mean =     -16.907219167215
             les_mean =     286.191471763790
             stat err =       0.000456784857
             autocorr =       1.278375484372
              std dev =       0.571343747199
             le_variance =       0.326433677463

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326545895293
                                         uncertainty =       0.002215130671

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326545895293
                                         uncertainty =       0.002215130671

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404021037
  error estimate for blocks of size 2^( 2) =       0.000417020867
  error estimate for blocks of size 2^( 3) =       0.000429780636
  error estimate for blocks of size 2^( 4) =       0.000442533698
  error estimate for blocks of size 2^( 5) =       0.000452994380
  error estimate for blocks of size 2^( 6) =       0.000461812671
  error estimate for blocks of size 2^( 7) =       0.000469858554

      target function =                  N/A
              le_mean =     -16.907218765016
             les_mean =     286.191979190166
             stat err =       0.000456799826
             autocorr =       1.278332706118
              std dev =       0.571372030464
             le_variance =       0.326465997197


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.907218746764        initial
     2.0680e+00     2.0680e+01             1.2896e-04       -16.907219518084  <--
     8.2718e+00     8.2718e+01             3.4074e-05       -16.907219167215
     3.3087e+01     3.3087e+02             8.6406e-06       -16.907218765016

*****************************************************************************
Applying the update for shift_i =   2.0680e+00     and shift_s =   2.0680e+01
*****************************************************************************

  Execution time = 3.0516e+01
  </log>
  <optVariables href="H2O.s083.opt.xml">
   uu_0                 3.131430e-01 1 1  ON 0
   uu_1                 1.455893e-01 1 1  ON 1
   uu_2                 4.340176e-02 1 1  ON 2
   uu_3                -1.979390e-02 1 1  ON 3
   uu_4                -6.662689e-02 1 1  ON 4
   uu_5                -1.030635e-01 1 1  ON 5
   uu_6                -1.323387e-01 1 1  ON 6
   uu_7                -1.479708e-01 1 1  ON 7
   uu_8                -1.413551e-01 1 1  ON 8
   uu_9                -1.139485e-01 1 1  ON 9
   ud_0                 4.515882e-01 1 1  ON 10
   ud_1                 1.857003e-01 1 1  ON 11
   ud_2                 6.518111e-02 1 1  ON 12
   ud_3                -6.085260e-03 1 1  ON 13
   ud_4                -6.373227e-02 1 1  ON 14
   ud_5                -1.062888e-01 1 1  ON 15
   ud_6                -1.349881e-01 1 1  ON 16
   ud_7                -1.530201e-01 1 1  ON 17
   ud_8                -1.549014e-01 1 1  ON 18
   ud_9                -1.456789e-01 1 1  ON 19
   eO_0                -7.485808e-01 1 1  ON 20
   eO_1                -4.276045e-01 1 1  ON 21
   eO_2                -1.613968e-02 1 1  ON 22
   eO_3                 2.978514e-01 1 1  ON 23
   eO_4                 5.259042e-01 1 1  ON 24
   eO_5                 4.903896e-01 1 1  ON 25
   eO_6                 2.635934e-01 1 1  ON 26
   eO_7                -4.210108e-02 1 1  ON 27
   eO_8                -2.366288e-01 1 1  ON 28
   eO_9                -1.026742e-01 1 1  ON 29
  eH1_0                -2.660061e-01 1 1  ON 30
  eH1_1                -1.583380e-01 1 1  ON 31
  eH1_2                -1.081731e-01 1 1  ON 32
  eH1_3                -5.238493e-02 1 1  ON 33
  eH1_4                -1.675920e-03 1 1  ON 34
  eH1_5                 3.476371e-02 1 1  ON 35
  eH1_6                 9.781387e-02 1 1  ON 36
  eH1_7                 1.597419e-01 1 1  ON 37
  eH1_8                 1.971670e-01 1 1  ON 38
  eH1_9                 9.595465e-02 1 1  ON 39
  eH2_0                -2.643182e-01 1 1  ON 40
  eH2_1                -1.565743e-01 1 1  ON 41
  eH2_2                -1.065615e-01 1 1  ON 42
  eH2_3                -5.081220e-02 1 1  ON 43
  eH2_4                -1.748627e-05 1 1  ON 44
  eH2_5                 3.713932e-02 1 1  ON 45
  eH2_6                 9.944771e-02 1 1  ON 46
  eH2_7                 1.613469e-01 1 1  ON 47
  eH2_8                 2.013833e-01 1 1  ON 48
  eH2_9                 8.974165e-02 1 1  ON 49
ci_0001                 7.013887e-01 3 1  ON 50
ci_0002                 7.008221e-01 3 1  ON 51
ci_0003                -2.732861e-02 3 1  ON 52
ci_0004                -2.694108e-02 3 1  ON 53
ci_0005                -3.567813e-02 3 1  ON 54
ci_0006                -3.600427e-02 3 1  ON 55
ci_0007                -2.092413e-02 3 1  ON 56
ci_0008                -2.182638e-02 3 1  ON 57
ci_0009                -1.728402e-02 3 1  ON 58
ci_0010                -1.707626e-02 3 1  ON 59
ci_0011                -1.240331e-02 3 1  ON 60
ci_0012                -1.227898e-02 3 1  ON 61
ci_0013                 1.351449e-02 3 1  ON 62
ci_0014                 1.317466e-02 3 1  ON 63
ci_0015                 1.358545e-02 3 1  ON 64
ci_0016                 1.295705e-02 3 1  ON 65
ci_0017                 1.136347e-02 3 1  ON 66
ci_0018                 1.117059e-02 3 1  ON 67
ci_0019                 1.121617e-02 3 1  ON 68
ci_0020                 1.127437e-02 3 1  ON 69
ci_0021                -1.973756e-03 3 1  ON 70
ci_0022                -6.933528e-04 3 1  ON 71
ci_0023                -1.112513e-02 3 1  ON 72
ci_0024                -1.125469e-02 3 1  ON 73
ci_0025                -1.061829e-02 3 1  ON 74
ci_0026                -1.052023e-02 3 1  ON 75
ci_0027                -1.141444e-02 3 1  ON 76
ci_0028                -1.109724e-02 3 1  ON 77
ci_0029                -1.050643e-02 3 1  ON 78
ci_0030                -1.087367e-02 3 1  ON 79
ci_0031                 2.087124e-02 3 1  ON 80
ci_0032                 2.090055e-02 3 1  ON 81
ci_0033                 9.792800e-03 3 1  ON 82
ci_0034                 1.000799e-02 3 1  ON 83
ci_0035                 6.873014e-03 3 1  ON 84
ci_0036                 6.453048e-03 3 1  ON 85
ci_0037                -1.017866e-02 3 1  ON 86
ci_0038                -1.100395e-02 3 1  ON 87
ci_0039                -2.618829e-03 3 1  ON 88
ci_0040                -2.720800e-03 3 1  ON 89
ci_0041                 7.334772e-03 3 1  ON 90
ci_0042                 6.969062e-03 3 1  ON 91
ci_0043                -1.882100e-02 3 1  ON 92
ci_0044                -1.905724e-02 3 1  ON 93
ci_0045                 7.547470e-03 3 1  ON 94
ci_0046                 7.564988e-03 3 1  ON 95
ci_0047                -1.779991e-03 3 1  ON 96
ci_0048                -2.031415e-03 3 1  ON 97
ci_0049                -5.909042e-03 3 1  ON 98
ci_0050                -5.773711e-03 3 1  ON 99
ci_0051                -3.526735e-03 3 1  ON 100
ci_0052                -3.242082e-03 3 1  ON 101
ci_0053                -4.654432e-03 3 1  ON 102
ci_0054                -4.551715e-03 3 1  ON 103
ci_0055                 6.312257e-03 3 1  ON 104
ci_0056                 6.612557e-03 3 1  ON 105
ci_0057                 4.837956e-03 3 1  ON 106
ci_0058                 4.639393e-03 3 1  ON 107
ci_0059                -4.789635e-03 3 1  ON 108
ci_0060                -4.743505e-03 3 1  ON 109
ci_0061                -3.559975e-03 3 1  ON 110
ci_0062                -3.322324e-03 3 1  ON 111
ci_0063                -8.534470e-03 3 1  ON 112
ci_0064                -8.307359e-03 3 1  ON 113
ci_0065                -5.401538e-03 3 1  ON 114
ci_0066                -5.546592e-03 3 1  ON 115
ci_0067                -4.755071e-03 3 1  ON 116
ci_0068                -5.170543e-03 3 1  ON 117
ci_0069                 4.344949e-03 3 1  ON 118
ci_0070                 4.259920e-03 3 1  ON 119
ci_0071                -1.336412e-04 3 1  ON 120
ci_0072                 4.246606e-04 3 1  ON 121
ci_0073                 4.278271e-03 3 1  ON 122
ci_0074                 4.184395e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7576e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s084 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s084 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=84  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 84
    time step          = 0.05
    reference energy   = -16.8606
    reference variance = 0.31461
====================================================
  Execution time = 2.1288e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s084
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5275e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3282e-01
  Total weights = 1.952064817e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0170e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320907474713
                                         uncertainty =       0.001977808648

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320907474713
                                         uncertainty =       0.001977808648

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400571934
  error estimate for blocks of size 2^( 2) =       0.000413243486
  error estimate for blocks of size 2^( 3) =       0.000426046537
  error estimate for blocks of size 2^( 4) =       0.000437192002
  error estimate for blocks of size 2^( 5) =       0.000447304238
  error estimate for blocks of size 2^( 6) =       0.000454039388
  error estimate for blocks of size 2^( 7) =       0.000459013620

      target function =                  N/A
              le_mean =     -16.906187175890
             les_mean =     286.151984062650
             stat err =       0.000449387312
             autocorr =       1.258579279295
              std dev =       0.566494262423
             le_variance =       0.320915749358


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690618717589e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.1699e-01, overlap shift 5.1699e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906187175907       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906191927929       residual = 3.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906191675084       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906192157651       residual = 4.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906192618129       residual = 3.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906192879689       residual = 2.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906193134271       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906192931231       residual = 6.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906192866928       residual = 2.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906192789803       residual = 7.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.1699e-01 is 4.410707e-04

solving harmonic davidson linear method for identity shift 2.0680e+00, overlap shift 2.0680e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906187175907       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906188679864       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906188587234       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906188752549       residual = 4.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906188928078       residual = 3.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906189003970       residual = 2.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906189064829       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906189024218       residual = 3.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906189012336       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906188971308       residual = 3.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.0680e+00 is 1.365448e-04

solving harmonic davidson linear method for identity shift 8.2718e+00, overlap shift 8.2718e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906187175907       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906187578676       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906187553275       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906187597980       residual = 5.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906187642828       residual = 3.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906187663270       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906187679402       residual = 9.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906187674181       residual = 2.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906187669754       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906187658849       residual = 2.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 8.2718e+00 is 3.712515e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.685053 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7313e+01
  </log>
  <optVariables href="H2O.s084.opt.xml">
   uu_0                 3.131284e-01 1 1  ON 0
   uu_1                 1.455440e-01 1 1  ON 1
   uu_2                 4.342139e-02 1 1  ON 2
   uu_3                -1.975762e-02 1 1  ON 3
   uu_4                -6.661993e-02 1 1  ON 4
   uu_5                -1.030760e-01 1 1  ON 5
   uu_6                -1.323409e-01 1 1  ON 6
   uu_7                -1.479850e-01 1 1  ON 7
   uu_8                -1.413801e-01 1 1  ON 8
   uu_9                -1.139701e-01 1 1  ON 9
   ud_0                 4.516502e-01 1 1  ON 10
   ud_1                 1.857260e-01 1 1  ON 11
   ud_2                 6.519436e-02 1 1  ON 12
   ud_3                -6.133105e-03 1 1  ON 13
   ud_4                -6.373215e-02 1 1  ON 14
   ud_5                -1.062636e-01 1 1  ON 15
   ud_6                -1.350216e-01 1 1  ON 16
   ud_7                -1.529793e-01 1 1  ON 17
   ud_8                -1.548827e-01 1 1  ON 18
   ud_9                -1.457084e-01 1 1  ON 19
   eO_0                -7.485327e-01 1 1  ON 20
   eO_1                -4.276094e-01 1 1  ON 21
   eO_2                -1.615156e-02 1 1  ON 22
   eO_3                 2.978837e-01 1 1  ON 23
   eO_4                 5.259462e-01 1 1  ON 24
   eO_5                 4.903900e-01 1 1  ON 25
   eO_6                 2.635867e-01 1 1  ON 26
   eO_7                -4.208500e-02 1 1  ON 27
   eO_8                -2.366557e-01 1 1  ON 28
   eO_9                -1.027460e-01 1 1  ON 29
  eH1_0                -2.660498e-01 1 1  ON 30
  eH1_1                -1.583450e-01 1 1  ON 31
  eH1_2                -1.081504e-01 1 1  ON 32
  eH1_3                -5.241468e-02 1 1  ON 33
  eH1_4                -1.683873e-03 1 1  ON 34
  eH1_5                 3.473534e-02 1 1  ON 35
  eH1_6                 9.777914e-02 1 1  ON 36
  eH1_7                 1.597452e-01 1 1  ON 37
  eH1_8                 1.972140e-01 1 1  ON 38
  eH1_9                 9.603441e-02 1 1  ON 39
  eH2_0                -2.643415e-01 1 1  ON 40
  eH2_1                -1.566006e-01 1 1  ON 41
  eH2_2                -1.065604e-01 1 1  ON 42
  eH2_3                -5.084253e-02 1 1  ON 43
  eH2_4                -4.666533e-05 1 1  ON 44
  eH2_5                 3.713773e-02 1 1  ON 45
  eH2_6                 9.945919e-02 1 1  ON 46
  eH2_7                 1.613540e-01 1 1  ON 47
  eH2_8                 2.013954e-01 1 1  ON 48
  eH2_9                 8.981383e-02 1 1  ON 49
ci_0001                 7.013902e-01 3 1  ON 50
ci_0002                 7.008094e-01 3 1  ON 51
ci_0003                -2.733219e-02 3 1  ON 52
ci_0004                -2.690422e-02 3 1  ON 53
ci_0005                -3.580644e-02 3 1  ON 54
ci_0006                -3.605065e-02 3 1  ON 55
ci_0007                -2.102880e-02 3 1  ON 56
ci_0008                -2.171111e-02 3 1  ON 57
ci_0009                -1.733806e-02 3 1  ON 58
ci_0010                -1.707758e-02 3 1  ON 59
ci_0011                -1.238427e-02 3 1  ON 60
ci_0012                -1.221522e-02 3 1  ON 61
ci_0013                 1.354163e-02 3 1  ON 62
ci_0014                 1.315481e-02 3 1  ON 63
ci_0015                 1.347772e-02 3 1  ON 64
ci_0016                 1.296154e-02 3 1  ON 65
ci_0017                 1.132692e-02 3 1  ON 66
ci_0018                 1.122202e-02 3 1  ON 67
ci_0019                 1.128808e-02 3 1  ON 68
ci_0020                 1.135153e-02 3 1  ON 69
ci_0021                -1.955006e-03 3 1  ON 70
ci_0022                -7.030886e-04 3 1  ON 71
ci_0023                -1.126167e-02 3 1  ON 72
ci_0024                -1.127491e-02 3 1  ON 73
ci_0025                -1.061687e-02 3 1  ON 74
ci_0026                -1.050295e-02 3 1  ON 75
ci_0027                -1.140414e-02 3 1  ON 76
ci_0028                -1.112803e-02 3 1  ON 77
ci_0029                -1.054527e-02 3 1  ON 78
ci_0030                -1.089302e-02 3 1  ON 79
ci_0031                 2.078848e-02 3 1  ON 80
ci_0032                 2.091948e-02 3 1  ON 81
ci_0033                 9.770339e-03 3 1  ON 82
ci_0034                 1.010211e-02 3 1  ON 83
ci_0035                 6.849950e-03 3 1  ON 84
ci_0036                 6.502940e-03 3 1  ON 85
ci_0037                -1.030818e-02 3 1  ON 86
ci_0038                -1.101079e-02 3 1  ON 87
ci_0039                -2.532442e-03 3 1  ON 88
ci_0040                -2.683574e-03 3 1  ON 89
ci_0041                 7.314038e-03 3 1  ON 90
ci_0042                 6.952167e-03 3 1  ON 91
ci_0043                -1.879586e-02 3 1  ON 92
ci_0044                -1.905343e-02 3 1  ON 93
ci_0045                 7.579810e-03 3 1  ON 94
ci_0046                 7.492808e-03 3 1  ON 95
ci_0047                -1.693635e-03 3 1  ON 96
ci_0048                -1.985229e-03 3 1  ON 97
ci_0049                -5.838483e-03 3 1  ON 98
ci_0050                -5.752065e-03 3 1  ON 99
ci_0051                -3.469265e-03 3 1  ON 100
ci_0052                -3.233835e-03 3 1  ON 101
ci_0053                -4.637600e-03 3 1  ON 102
ci_0054                -4.643336e-03 3 1  ON 103
ci_0055                 6.355371e-03 3 1  ON 104
ci_0056                 6.711990e-03 3 1  ON 105
ci_0057                 4.941441e-03 3 1  ON 106
ci_0058                 4.620285e-03 3 1  ON 107
ci_0059                -4.849732e-03 3 1  ON 108
ci_0060                -4.721667e-03 3 1  ON 109
ci_0061                -3.533496e-03 3 1  ON 110
ci_0062                -3.298843e-03 3 1  ON 111
ci_0063                -8.468743e-03 3 1  ON 112
ci_0064                -8.396308e-03 3 1  ON 113
ci_0065                -5.447332e-03 3 1  ON 114
ci_0066                -5.499737e-03 3 1  ON 115
ci_0067                -4.770700e-03 3 1  ON 116
ci_0068                -5.192129e-03 3 1  ON 117
ci_0069                 4.278136e-03 3 1  ON 118
ci_0070                 4.224531e-03 3 1  ON 119
ci_0071                -1.096589e-04 3 1  ON 120
ci_0072                 2.961076e-04 3 1  ON 121
ci_0073                 4.281081e-03 3 1  ON 122
ci_0074                 4.173371e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 84
    time step          = 0.05
    reference energy   = -16.9219
    reference variance = 0.228428
====================================================
  Execution time = 2.0854e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s084
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4012e-01
  Total weights = 1.9514e+06
  Execution time = 1.9180e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327009965688
                                         uncertainty =       0.003314479276

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327009965688
                                         uncertainty =       0.003314479276

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404325965
  error estimate for blocks of size 2^( 2) =       0.000417726603
  error estimate for blocks of size 2^( 3) =       0.000431410043
  error estimate for blocks of size 2^( 4) =       0.000444829016
  error estimate for blocks of size 2^( 5) =       0.000456345615
  error estimate for blocks of size 2^( 6) =       0.000466746987
  error estimate for blocks of size 2^( 7) =       0.000471789025

      target function =                  N/A
              le_mean =     -16.905913166993
             les_mean =     286.200807439494
             stat err =       0.000459927661
             autocorr =       1.293944933587
              std dev =       0.571803263770
             le_variance =       0.326958972458

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327071184876
                                         uncertainty =       0.003337222627

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327071184876
                                         uncertainty =       0.003337222627

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404364930
  error estimate for blocks of size 2^( 2) =       0.000417761133
  error estimate for blocks of size 2^( 3) =       0.000431440725
  error estimate for blocks of size 2^( 4) =       0.000444860154
  error estimate for blocks of size 2^( 5) =       0.000456374535
  error estimate for blocks of size 2^( 6) =       0.000466768752
  error estimate for blocks of size 2^( 7) =       0.000471836486

      target function =                  N/A
              le_mean =     -16.905914876950
             les_mean =     286.151273862808
             stat err =       0.000459959982
             autocorr =       1.293877408072
              std dev =       0.571858368549
             le_variance =       0.327021993680

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327080766438
                                         uncertainty =       0.003326907309

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327080766438
                                         uncertainty =       0.003326907309

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404370298
  error estimate for blocks of size 2^( 2) =       0.000417767348
  error estimate for blocks of size 2^( 3) =       0.000431449311
  error estimate for blocks of size 2^( 4) =       0.000444871467
  error estimate for blocks of size 2^( 5) =       0.000456390210
  error estimate for blocks of size 2^( 6) =       0.000466800947
  error estimate for blocks of size 2^( 7) =       0.000471881403

      target function =                  N/A
              le_mean =     -16.905908116653
             les_mean =     286.563665267221
             stat err =       0.000459986007
             autocorr =       1.293989474693
              std dev =       0.571865959994
             le_variance =       0.327030676200

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327006000494
                                         uncertainty =       0.003316360257

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327006000494
                                         uncertainty =       0.003316360257

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404323615
  error estimate for blocks of size 2^( 2) =       0.000417724342
  error estimate for blocks of size 2^( 3) =       0.000431407797
  error estimate for blocks of size 2^( 4) =       0.000444827537
  error estimate for blocks of size 2^( 5) =       0.000456343352
  error estimate for blocks of size 2^( 6) =       0.000466747869
  error estimate for blocks of size 2^( 7) =       0.000471795361

      target function =                  N/A
              le_mean =     -16.905911491432
             les_mean =     286.150039411131
             stat err =       0.000459928530
             autocorr =       1.293964867271
              std dev =       0.571799940159
             le_variance =       0.326955171566


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905913166993        initial
     5.1699e-01     5.1699e+00             4.4107e-04       -16.905914876950  <--
     2.0680e+00     2.0680e+01             1.3654e-04       -16.905908116653
     8.2718e+00     8.2718e+01             3.7125e-05       -16.905911491432

*****************************************************************************
Applying the update for shift_i =   5.1699e-01     and shift_s =   5.1699e+00
*****************************************************************************

  Execution time = 3.0532e+01
  </log>
  <optVariables href="H2O.s084.opt.xml">
   uu_0                 3.130648e-01 1 1  ON 0
   uu_1                 1.454725e-01 1 1  ON 1
   uu_2                 4.345641e-02 1 1  ON 2
   uu_3                -1.968589e-02 1 1  ON 3
   uu_4                -6.660475e-02 1 1  ON 4
   uu_5                -1.030966e-01 1 1  ON 5
   uu_6                -1.323447e-01 1 1  ON 6
   uu_7                -1.480265e-01 1 1  ON 7
   uu_8                -1.414515e-01 1 1  ON 8
   uu_9                -1.140327e-01 1 1  ON 9
   ud_0                 4.517817e-01 1 1  ON 10
   ud_1                 1.857933e-01 1 1  ON 11
   ud_2                 6.522165e-02 1 1  ON 12
   ud_3                -6.205238e-03 1 1  ON 13
   ud_4                -6.373556e-02 1 1  ON 14
   ud_5                -1.062086e-01 1 1  ON 15
   ud_6                -1.350810e-01 1 1  ON 16
   ud_7                -1.528755e-01 1 1  ON 17
   ud_8                -1.548298e-01 1 1  ON 18
   ud_9                -1.457914e-01 1 1  ON 19
   eO_0                -7.484355e-01 1 1  ON 20
   eO_1                -4.275899e-01 1 1  ON 21
   eO_2                -1.616387e-02 1 1  ON 22
   eO_3                 2.979594e-01 1 1  ON 23
   eO_4                 5.260675e-01 1 1  ON 24
   eO_5                 4.903977e-01 1 1  ON 25
   eO_6                 2.635678e-01 1 1  ON 26
   eO_7                -4.203854e-02 1 1  ON 27
   eO_8                -2.367335e-01 1 1  ON 28
   eO_9                -1.029560e-01 1 1  ON 29
  eH1_0                -2.661682e-01 1 1  ON 30
  eH1_1                -1.583642e-01 1 1  ON 31
  eH1_2                -1.081180e-01 1 1  ON 32
  eH1_3                -5.247155e-02 1 1  ON 33
  eH1_4                -1.710226e-03 1 1  ON 34
  eH1_5                 3.465067e-02 1 1  ON 35
  eH1_6                 9.767523e-02 1 1  ON 36
  eH1_7                 1.597532e-01 1 1  ON 37
  eH1_8                 1.973517e-01 1 1  ON 38
  eH1_9                 9.626861e-02 1 1  ON 39
  eH2_0                -2.644126e-01 1 1  ON 40
  eH2_1                -1.566775e-01 1 1  ON 41
  eH2_2                -1.065838e-01 1 1  ON 42
  eH2_3                -5.091194e-02 1 1  ON 43
  eH2_4                -1.276746e-04 1 1  ON 44
  eH2_5                 3.713023e-02 1 1  ON 45
  eH2_6                 9.949686e-02 1 1  ON 46
  eH2_7                 1.613780e-01 1 1  ON 47
  eH2_8                 2.014314e-01 1 1  ON 48
  eH2_9                 9.002537e-02 1 1  ON 49
ci_0001                 7.014002e-01 3 1  ON 50
ci_0002                 7.007741e-01 3 1  ON 51
ci_0003                -2.734512e-02 3 1  ON 52
ci_0004                -2.681684e-02 3 1  ON 53
ci_0005                -3.611920e-02 3 1  ON 54
ci_0006                -3.615898e-02 3 1  ON 55
ci_0007                -2.129720e-02 3 1  ON 56
ci_0008                -2.141301e-02 3 1  ON 57
ci_0009                -1.744733e-02 3 1  ON 58
ci_0010                -1.707828e-02 3 1  ON 59
ci_0011                -1.233650e-02 3 1  ON 60
ci_0012                -1.207311e-02 3 1  ON 61
ci_0013                 1.359747e-02 3 1  ON 62
ci_0014                 1.311359e-02 3 1  ON 63
ci_0015                 1.324758e-02 3 1  ON 64
ci_0016                 1.296803e-02 3 1  ON 65
ci_0017                 1.124635e-02 3 1  ON 66
ci_0018                 1.132569e-02 3 1  ON 67
ci_0019                 1.144004e-02 3 1  ON 68
ci_0020                 1.151344e-02 3 1  ON 69
ci_0021                -1.901437e-03 3 1  ON 70
ci_0022                -7.270423e-04 3 1  ON 71
ci_0023                -1.153901e-02 3 1  ON 72
ci_0024                -1.131478e-02 3 1  ON 73
ci_0025                -1.061507e-02 3 1  ON 74
ci_0026                -1.046409e-02 3 1  ON 75
ci_0027                -1.138008e-02 3 1  ON 76
ci_0028                -1.119108e-02 3 1  ON 77
ci_0029                -1.063029e-02 3 1  ON 78
ci_0030                -1.093350e-02 3 1  ON 79
ci_0031                 2.058969e-02 3 1  ON 80
ci_0032                 2.096744e-02 3 1  ON 81
ci_0033                 9.714042e-03 3 1  ON 82
ci_0034                 1.033860e-02 3 1  ON 83
ci_0035                 6.800153e-03 3 1  ON 84
ci_0036                 6.613831e-03 3 1  ON 85
ci_0037                -1.060480e-02 3 1  ON 86
ci_0038                -1.102364e-02 3 1  ON 87
ci_0039                -2.381679e-03 3 1  ON 88
ci_0040                -2.616908e-03 3 1  ON 89
ci_0041                 7.270254e-03 3 1  ON 90
ci_0042                 6.920206e-03 3 1  ON 91
ci_0043                -1.873668e-02 3 1  ON 92
ci_0044                -1.904166e-02 3 1  ON 93
ci_0045                 7.654397e-03 3 1  ON 94
ci_0046                 7.322733e-03 3 1  ON 95
ci_0047                -1.539160e-03 3 1  ON 96
ci_0048                -1.901855e-03 3 1  ON 97
ci_0049                -5.687029e-03 3 1  ON 98
ci_0050                -5.702027e-03 3 1  ON 99
ci_0051                -3.366077e-03 3 1  ON 100
ci_0052                -3.217221e-03 3 1  ON 101
ci_0053                -4.605685e-03 3 1  ON 102
ci_0054                -4.812100e-03 3 1  ON 103
ci_0055                 6.454811e-03 3 1  ON 104
ci_0056                 6.942772e-03 3 1  ON 105
ci_0057                 5.169514e-03 3 1  ON 106
ci_0058                 4.579345e-03 3 1  ON 107
ci_0059                -4.964464e-03 3 1  ON 108
ci_0060                -4.681277e-03 3 1  ON 109
ci_0061                -3.476349e-03 3 1  ON 110
ci_0062                -3.248538e-03 3 1  ON 111
ci_0063                -8.335574e-03 3 1  ON 112
ci_0064                -8.570201e-03 3 1  ON 113
ci_0065                -5.539593e-03 3 1  ON 114
ci_0066                -5.406903e-03 3 1  ON 115
ci_0067                -4.799720e-03 3 1  ON 116
ci_0068                -5.226550e-03 3 1  ON 117
ci_0069                 4.155812e-03 3 1  ON 118
ci_0070                 4.156638e-03 3 1  ON 119
ci_0071                -5.659619e-05 3 1  ON 120
ci_0072                 2.400957e-05 3 1  ON 121
ci_0073                 4.284857e-03 3 1  ON 122
ci_0074                 4.152023e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7851e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s085 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s085 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=85  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 85
    time step          = 0.05
    reference energy   = -16.9151
    reference variance = 0.191704
====================================================
  Execution time = 2.1275e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s085
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5226e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3505e-01
  Total weights = 1.951682389e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0910e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322166230404
                                         uncertainty =       0.002153597613

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322166230404
                                         uncertainty =       0.002153597613

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401330048
  error estimate for blocks of size 2^( 2) =       0.000414642877
  error estimate for blocks of size 2^( 3) =       0.000428573791
  error estimate for blocks of size 2^( 4) =       0.000442251980
  error estimate for blocks of size 2^( 5) =       0.000455082833
  error estimate for blocks of size 2^( 6) =       0.000464124660
  error estimate for blocks of size 2^( 7) =       0.000470873439

      target function =                  N/A
              le_mean =     -16.904939709246
             les_mean =     286.112041453643
             stat err =       0.000458083228
             autocorr =       1.302823031951
              std dev =       0.567566396899
             le_variance =       0.322131614889


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690493970925e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.2925e-01, overlap shift 1.2925e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904939709241       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904939764071       residual = 8.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904943208412       residual = 4.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904942426534       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904940977257       residual = 8.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904940704197       residual = 4.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904940639467       residual = 3.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904940327671       residual = 3.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.904941500956       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.904941180218       residual = 6.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.904941426236       residual = 4.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.904941526049       residual = 2.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.904941627198       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.904941661195       residual = 2.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.2925e-01 is 1.850006e-03

solving harmonic davidson linear method for identity shift 5.1699e-01, overlap shift 5.1699e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904939709241       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904939734942       residual = 4.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904940957312       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904940868601       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904940480141       residual = 5.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904939935767       residual = 2.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904939998694       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904940071510       residual = 6.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.904940077024       residual = 2.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.904940095859       residual = 7.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.1699e-01 is 4.527953e-04

solving harmonic davidson linear method for identity shift 2.0680e+00, overlap shift 2.0680e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904939709241       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904939717465       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904940061758       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904940028044       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904939953762       residual = 4.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904939710021       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904939767288       residual = 8.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904939759970       residual = 4.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.904939732577       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.904939748918       residual = 2.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.0680e+00 is 1.419379e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.690073 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7375e+01
  </log>
  <optVariables href="H2O.s085.opt.xml">
   uu_0                 3.131834e-01 1 1  ON 0
   uu_1                 1.455609e-01 1 1  ON 1
   uu_2                 4.335299e-02 1 1  ON 2
   uu_3                -1.971469e-02 1 1  ON 3
   uu_4                -6.664046e-02 1 1  ON 4
   uu_5                -1.030554e-01 1 1  ON 5
   uu_6                -1.324467e-01 1 1  ON 6
   uu_7                -1.480786e-01 1 1  ON 7
   uu_8                -1.414655e-01 1 1  ON 8
   uu_9                -1.140979e-01 1 1  ON 9
   ud_0                 4.518928e-01 1 1  ON 10
   ud_1                 1.858328e-01 1 1  ON 11
   ud_2                 6.519960e-02 1 1  ON 12
   ud_3                -6.190480e-03 1 1  ON 13
   ud_4                -6.368760e-02 1 1  ON 14
   ud_5                -1.062390e-01 1 1  ON 15
   ud_6                -1.350139e-01 1 1  ON 16
   ud_7                -1.529021e-01 1 1  ON 17
   ud_8                -1.548099e-01 1 1  ON 18
   ud_9                -1.458213e-01 1 1  ON 19
   eO_0                -7.483609e-01 1 1  ON 20
   eO_1                -4.274567e-01 1 1  ON 21
   eO_2                -1.604826e-02 1 1  ON 22
   eO_3                 2.979139e-01 1 1  ON 23
   eO_4                 5.260399e-01 1 1  ON 24
   eO_5                 4.904265e-01 1 1  ON 25
   eO_6                 2.636781e-01 1 1  ON 26
   eO_7                -4.203434e-02 1 1  ON 27
   eO_8                -2.368393e-01 1 1  ON 28
   eO_9                -1.031918e-01 1 1  ON 29
  eH1_0                -2.663223e-01 1 1  ON 30
  eH1_1                -1.585729e-01 1 1  ON 31
  eH1_2                -1.081553e-01 1 1  ON 32
  eH1_3                -5.250135e-02 1 1  ON 33
  eH1_4                -1.908373e-03 1 1  ON 34
  eH1_5                 3.478022e-02 1 1  ON 35
  eH1_6                 9.769500e-02 1 1  ON 36
  eH1_7                 1.596774e-01 1 1  ON 37
  eH1_8                 1.974433e-01 1 1  ON 38
  eH1_9                 9.664520e-02 1 1  ON 39
  eH2_0                -2.645078e-01 1 1  ON 40
  eH2_1                -1.567328e-01 1 1  ON 41
  eH2_2                -1.065334e-01 1 1  ON 42
  eH2_3                -5.083797e-02 1 1  ON 43
  eH2_4                -2.448504e-04 1 1  ON 44
  eH2_5                 3.694684e-02 1 1  ON 45
  eH2_6                 9.937016e-02 1 1  ON 46
  eH2_7                 1.611766e-01 1 1  ON 47
  eH2_8                 2.015987e-01 1 1  ON 48
  eH2_9                 9.047817e-02 1 1  ON 49
ci_0001                 7.012896e-01 3 1  ON 50
ci_0002                 7.008306e-01 3 1  ON 51
ci_0003                -2.754867e-02 3 1  ON 52
ci_0004                -2.707508e-02 3 1  ON 53
ci_0005                -3.641497e-02 3 1  ON 54
ci_0006                -3.645372e-02 3 1  ON 55
ci_0007                -2.121223e-02 3 1  ON 56
ci_0008                -2.164422e-02 3 1  ON 57
ci_0009                -1.733603e-02 3 1  ON 58
ci_0010                -1.732007e-02 3 1  ON 59
ci_0011                -1.215924e-02 3 1  ON 60
ci_0012                -1.174680e-02 3 1  ON 61
ci_0013                 1.355315e-02 3 1  ON 62
ci_0014                 1.292932e-02 3 1  ON 63
ci_0015                 1.342757e-02 3 1  ON 64
ci_0016                 1.297707e-02 3 1  ON 65
ci_0017                 1.128458e-02 3 1  ON 66
ci_0018                 1.138981e-02 3 1  ON 67
ci_0019                 1.181174e-02 3 1  ON 68
ci_0020                 1.155756e-02 3 1  ON 69
ci_0021                -1.693357e-03 3 1  ON 70
ci_0022                -1.046337e-03 3 1  ON 71
ci_0023                -1.126371e-02 3 1  ON 72
ci_0024                -1.122257e-02 3 1  ON 73
ci_0025                -1.057513e-02 3 1  ON 74
ci_0026                -1.034554e-02 3 1  ON 75
ci_0027                -1.158527e-02 3 1  ON 76
ci_0028                -1.139320e-02 3 1  ON 77
ci_0029                -1.043484e-02 3 1  ON 78
ci_0030                -1.088545e-02 3 1  ON 79
ci_0031                 2.064242e-02 3 1  ON 80
ci_0032                 2.120140e-02 3 1  ON 81
ci_0033                 9.815560e-03 3 1  ON 82
ci_0034                 1.031121e-02 3 1  ON 83
ci_0035                 6.449012e-03 3 1  ON 84
ci_0036                 6.421954e-03 3 1  ON 85
ci_0037                -1.039805e-02 3 1  ON 86
ci_0038                -1.104978e-02 3 1  ON 87
ci_0039                -2.505689e-03 3 1  ON 88
ci_0040                -2.502738e-03 3 1  ON 89
ci_0041                 6.972677e-03 3 1  ON 90
ci_0042                 6.989511e-03 3 1  ON 91
ci_0043                -1.889965e-02 3 1  ON 92
ci_0044                -1.904030e-02 3 1  ON 93
ci_0045                 7.496272e-03 3 1  ON 94
ci_0046                 7.407465e-03 3 1  ON 95
ci_0047                -1.540591e-03 3 1  ON 96
ci_0048                -1.925739e-03 3 1  ON 97
ci_0049                -5.624350e-03 3 1  ON 98
ci_0050                -5.654971e-03 3 1  ON 99
ci_0051                -3.468368e-03 3 1  ON 100
ci_0052                -3.414441e-03 3 1  ON 101
ci_0053                -4.370036e-03 3 1  ON 102
ci_0054                -4.927230e-03 3 1  ON 103
ci_0055                 6.574340e-03 3 1  ON 104
ci_0056                 6.728113e-03 3 1  ON 105
ci_0057                 5.044138e-03 3 1  ON 106
ci_0058                 4.814765e-03 3 1  ON 107
ci_0059                -4.908841e-03 3 1  ON 108
ci_0060                -4.761872e-03 3 1  ON 109
ci_0061                -3.454629e-03 3 1  ON 110
ci_0062                -3.697535e-03 3 1  ON 111
ci_0063                -8.597066e-03 3 1  ON 112
ci_0064                -8.189352e-03 3 1  ON 113
ci_0065                -5.712126e-03 3 1  ON 114
ci_0066                -5.495682e-03 3 1  ON 115
ci_0067                -4.854638e-03 3 1  ON 116
ci_0068                -5.075687e-03 3 1  ON 117
ci_0069                 4.013136e-03 3 1  ON 118
ci_0070                 4.232922e-03 3 1  ON 119
ci_0071                -1.577187e-04 3 1  ON 120
ci_0072                 2.485197e-05 3 1  ON 121
ci_0073                 4.377297e-03 3 1  ON 122
ci_0074                 4.335266e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 85
    time step          = 0.05
    reference energy   = -16.9039
    reference variance = 0.140129
====================================================
  Execution time = 2.1142e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s085
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3291e-01
  Total weights = 1.9518e+06
  Execution time = 1.9229e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320704923302
                                         uncertainty =       0.002188470292

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320704923302
                                         uncertainty =       0.002188470292

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400411076
  error estimate for blocks of size 2^( 2) =       0.000413218211
  error estimate for blocks of size 2^( 3) =       0.000425967467
  error estimate for blocks of size 2^( 4) =       0.000436839764
  error estimate for blocks of size 2^( 5) =       0.000445363527
  error estimate for blocks of size 2^( 6) =       0.000451044737
  error estimate for blocks of size 2^( 7) =       0.000455380699

      target function =                  N/A
              le_mean =     -16.907055245207
             les_mean =     286.198317158026
             stat err =       0.000447157182
             autocorr =       1.247120033417
              std dev =       0.566266774612
             le_variance =       0.320658060030

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320756614508
                                         uncertainty =       0.002160704943

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320756614508
                                         uncertainty =       0.002160704943

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400442928
  error estimate for blocks of size 2^( 2) =       0.000413226122
  error estimate for blocks of size 2^( 3) =       0.000425945396
  error estimate for blocks of size 2^( 4) =       0.000436799055
  error estimate for blocks of size 2^( 5) =       0.000445307729
  error estimate for blocks of size 2^( 6) =       0.000450916652
  error estimate for blocks of size 2^( 7) =       0.000455225946

      target function =                  N/A
              le_mean =     -16.907050576647
             les_mean =     286.183590549160
             stat err =       0.000447062345
             autocorr =       1.246392788094
              std dev =       0.566311819788
             le_variance =       0.320709077232

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320820085620
                                         uncertainty =       0.002160579374

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320820085620
                                         uncertainty =       0.002160579374

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400482606
  error estimate for blocks of size 2^( 2) =       0.000413264598
  error estimate for blocks of size 2^( 3) =       0.000425981566
  error estimate for blocks of size 2^( 4) =       0.000436834169
  error estimate for blocks of size 2^( 5) =       0.000445338309
  error estimate for blocks of size 2^( 6) =       0.000450947216
  error estimate for blocks of size 2^( 7) =       0.000455256084

      target function =                  N/A
              le_mean =     -16.907048722514
             les_mean =     286.184208276813
             stat err =       0.000447093945
             autocorr =       1.246321991407
              std dev =       0.566367933399
             le_variance =       0.320772635983

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320750310437
                                         uncertainty =       0.002174426063

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320750310437
                                         uncertainty =       0.002174426063

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400439234
  error estimate for blocks of size 2^( 2) =       0.000413239997
  error estimate for blocks of size 2^( 3) =       0.000425983905
  error estimate for blocks of size 2^( 4) =       0.000436847800
  error estimate for blocks of size 2^( 5) =       0.000445364432
  error estimate for blocks of size 2^( 6) =       0.000451028509
  error estimate for blocks of size 2^( 7) =       0.000455406763

      target function =                  N/A
              le_mean =     -16.907044951487
             les_mean =     286.289530060865
             stat err =       0.000447161876
             autocorr =       1.246970834210
              std dev =       0.566306594948
             le_variance =       0.320703159482


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.907055245207        initial  <--
     1.2925e-01     1.2925e+00             1.8500e-03       -16.907050576647
     5.1699e-01     5.1699e+00             4.5280e-04       -16.907048722514
     2.0680e+00     2.0680e+01             1.4194e-04       -16.907044951487

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.8540
  </log>
  <optVariables href="H2O.s085.opt.xml">
   uu_0                 3.130648e-01 1 1  ON 0
   uu_1                 1.454725e-01 1 1  ON 1
   uu_2                 4.345641e-02 1 1  ON 2
   uu_3                -1.968589e-02 1 1  ON 3
   uu_4                -6.660475e-02 1 1  ON 4
   uu_5                -1.030966e-01 1 1  ON 5
   uu_6                -1.323447e-01 1 1  ON 6
   uu_7                -1.480265e-01 1 1  ON 7
   uu_8                -1.414515e-01 1 1  ON 8
   uu_9                -1.140327e-01 1 1  ON 9
   ud_0                 4.517817e-01 1 1  ON 10
   ud_1                 1.857933e-01 1 1  ON 11
   ud_2                 6.522165e-02 1 1  ON 12
   ud_3                -6.205238e-03 1 1  ON 13
   ud_4                -6.373556e-02 1 1  ON 14
   ud_5                -1.062086e-01 1 1  ON 15
   ud_6                -1.350810e-01 1 1  ON 16
   ud_7                -1.528755e-01 1 1  ON 17
   ud_8                -1.548298e-01 1 1  ON 18
   ud_9                -1.457914e-01 1 1  ON 19
   eO_0                -7.484355e-01 1 1  ON 20
   eO_1                -4.275899e-01 1 1  ON 21
   eO_2                -1.616387e-02 1 1  ON 22
   eO_3                 2.979594e-01 1 1  ON 23
   eO_4                 5.260675e-01 1 1  ON 24
   eO_5                 4.903977e-01 1 1  ON 25
   eO_6                 2.635678e-01 1 1  ON 26
   eO_7                -4.203854e-02 1 1  ON 27
   eO_8                -2.367335e-01 1 1  ON 28
   eO_9                -1.029560e-01 1 1  ON 29
  eH1_0                -2.661682e-01 1 1  ON 30
  eH1_1                -1.583642e-01 1 1  ON 31
  eH1_2                -1.081180e-01 1 1  ON 32
  eH1_3                -5.247155e-02 1 1  ON 33
  eH1_4                -1.710226e-03 1 1  ON 34
  eH1_5                 3.465067e-02 1 1  ON 35
  eH1_6                 9.767523e-02 1 1  ON 36
  eH1_7                 1.597532e-01 1 1  ON 37
  eH1_8                 1.973517e-01 1 1  ON 38
  eH1_9                 9.626861e-02 1 1  ON 39
  eH2_0                -2.644126e-01 1 1  ON 40
  eH2_1                -1.566775e-01 1 1  ON 41
  eH2_2                -1.065838e-01 1 1  ON 42
  eH2_3                -5.091194e-02 1 1  ON 43
  eH2_4                -1.276746e-04 1 1  ON 44
  eH2_5                 3.713023e-02 1 1  ON 45
  eH2_6                 9.949686e-02 1 1  ON 46
  eH2_7                 1.613780e-01 1 1  ON 47
  eH2_8                 2.014314e-01 1 1  ON 48
  eH2_9                 9.002537e-02 1 1  ON 49
ci_0001                 7.014002e-01 3 1  ON 50
ci_0002                 7.007741e-01 3 1  ON 51
ci_0003                -2.734512e-02 3 1  ON 52
ci_0004                -2.681684e-02 3 1  ON 53
ci_0005                -3.611920e-02 3 1  ON 54
ci_0006                -3.615898e-02 3 1  ON 55
ci_0007                -2.129720e-02 3 1  ON 56
ci_0008                -2.141301e-02 3 1  ON 57
ci_0009                -1.744733e-02 3 1  ON 58
ci_0010                -1.707828e-02 3 1  ON 59
ci_0011                -1.233650e-02 3 1  ON 60
ci_0012                -1.207311e-02 3 1  ON 61
ci_0013                 1.359747e-02 3 1  ON 62
ci_0014                 1.311359e-02 3 1  ON 63
ci_0015                 1.324758e-02 3 1  ON 64
ci_0016                 1.296803e-02 3 1  ON 65
ci_0017                 1.124635e-02 3 1  ON 66
ci_0018                 1.132569e-02 3 1  ON 67
ci_0019                 1.144004e-02 3 1  ON 68
ci_0020                 1.151344e-02 3 1  ON 69
ci_0021                -1.901437e-03 3 1  ON 70
ci_0022                -7.270423e-04 3 1  ON 71
ci_0023                -1.153901e-02 3 1  ON 72
ci_0024                -1.131478e-02 3 1  ON 73
ci_0025                -1.061507e-02 3 1  ON 74
ci_0026                -1.046409e-02 3 1  ON 75
ci_0027                -1.138008e-02 3 1  ON 76
ci_0028                -1.119108e-02 3 1  ON 77
ci_0029                -1.063029e-02 3 1  ON 78
ci_0030                -1.093350e-02 3 1  ON 79
ci_0031                 2.058969e-02 3 1  ON 80
ci_0032                 2.096744e-02 3 1  ON 81
ci_0033                 9.714042e-03 3 1  ON 82
ci_0034                 1.033860e-02 3 1  ON 83
ci_0035                 6.800153e-03 3 1  ON 84
ci_0036                 6.613831e-03 3 1  ON 85
ci_0037                -1.060480e-02 3 1  ON 86
ci_0038                -1.102364e-02 3 1  ON 87
ci_0039                -2.381679e-03 3 1  ON 88
ci_0040                -2.616908e-03 3 1  ON 89
ci_0041                 7.270254e-03 3 1  ON 90
ci_0042                 6.920206e-03 3 1  ON 91
ci_0043                -1.873668e-02 3 1  ON 92
ci_0044                -1.904166e-02 3 1  ON 93
ci_0045                 7.654397e-03 3 1  ON 94
ci_0046                 7.322733e-03 3 1  ON 95
ci_0047                -1.539160e-03 3 1  ON 96
ci_0048                -1.901855e-03 3 1  ON 97
ci_0049                -5.687029e-03 3 1  ON 98
ci_0050                -5.702027e-03 3 1  ON 99
ci_0051                -3.366077e-03 3 1  ON 100
ci_0052                -3.217221e-03 3 1  ON 101
ci_0053                -4.605685e-03 3 1  ON 102
ci_0054                -4.812100e-03 3 1  ON 103
ci_0055                 6.454811e-03 3 1  ON 104
ci_0056                 6.942772e-03 3 1  ON 105
ci_0057                 5.169514e-03 3 1  ON 106
ci_0058                 4.579345e-03 3 1  ON 107
ci_0059                -4.964464e-03 3 1  ON 108
ci_0060                -4.681277e-03 3 1  ON 109
ci_0061                -3.476349e-03 3 1  ON 110
ci_0062                -3.248538e-03 3 1  ON 111
ci_0063                -8.335574e-03 3 1  ON 112
ci_0064                -8.570201e-03 3 1  ON 113
ci_0065                -5.539593e-03 3 1  ON 114
ci_0066                -5.406903e-03 3 1  ON 115
ci_0067                -4.799720e-03 3 1  ON 116
ci_0068                -5.226550e-03 3 1  ON 117
ci_0069                 4.155812e-03 3 1  ON 118
ci_0070                 4.156638e-03 3 1  ON 119
ci_0071                -5.659619e-05 3 1  ON 120
ci_0072                 2.400957e-05 3 1  ON 121
ci_0073                 4.284857e-03 3 1  ON 122
ci_0074                 4.152023e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8235e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s086 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s086 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=86  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 86
    time step          = 0.05
    reference energy   = -16.912
    reference variance = 0.157455
====================================================
  Execution time = 2.1287e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s086
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5263e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3718e-01
  Total weights = 1.951563088e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1439e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321582585289
                                         uncertainty =       0.002024224909

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321582585289
                                         uncertainty =       0.002024224909

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400947346
  error estimate for blocks of size 2^( 2) =       0.000413581274
  error estimate for blocks of size 2^( 3) =       0.000426803191
  error estimate for blocks of size 2^( 4) =       0.000438985238
  error estimate for blocks of size 2^( 5) =       0.000450260468
  error estimate for blocks of size 2^( 6) =       0.000457410763
  error estimate for blocks of size 2^( 7) =       0.000463297119

      target function =                  N/A
              le_mean =     -16.907017805943
             les_mean =     286.184433879148
             stat err =       0.000452488397
             autocorr =       1.273620989473
              std dev =       0.567025174782
             le_variance =       0.321517548836


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690701780594e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.2925e+00, overlap shift 1.2925e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907017805955       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907019365251       residual = 8.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907019181618       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907019220927       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907019417988       residual = 5.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907019287438       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907019425798       residual = 9.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907019494042       residual = 2.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.907019407916       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.907019418370       residual = 4.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.2925e+00 is 2.661242e-04

solving harmonic davidson linear method for identity shift 5.1699e+00, overlap shift 5.1699e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907017805955       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907018246876       residual = 8.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907018193577       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907018192911       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907018243010       residual = 5.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907018223295       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907018232026       residual = 8.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907018274604       residual = 3.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.907018252440       residual = 7.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.1699e+00 is 7.449270e-05

solving harmonic davidson linear method for identity shift 2.0680e+01, overlap shift 2.0680e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907017805955       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907017919920       residual = 9.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907017906052       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907017905213       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907017917279       residual = 5.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907017913425       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907017914261       residual = 7.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907017925456       residual = 3.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.907017920498       residual = 7.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.0680e+01 is 1.916667e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.693633 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7439e+01
  </log>
  <optVariables href="H2O.s086.opt.xml">
   uu_0                 3.130630e-01 1 1  ON 0
   uu_1                 1.454817e-01 1 1  ON 1
   uu_2                 4.344574e-02 1 1  ON 2
   uu_3                -1.969444e-02 1 1  ON 3
   uu_4                -6.660914e-02 1 1  ON 4
   uu_5                -1.030885e-01 1 1  ON 5
   uu_6                -1.323118e-01 1 1  ON 6
   uu_7                -1.480348e-01 1 1  ON 7
   uu_8                -1.414646e-01 1 1  ON 8
   uu_9                -1.140437e-01 1 1  ON 9
   ud_0                 4.517876e-01 1 1  ON 10
   ud_1                 1.858146e-01 1 1  ON 11
   ud_2                 6.523106e-02 1 1  ON 12
   ud_3                -6.189198e-03 1 1  ON 13
   ud_4                -6.372708e-02 1 1  ON 14
   ud_5                -1.062102e-01 1 1  ON 15
   ud_6                -1.350725e-01 1 1  ON 16
   ud_7                -1.528951e-01 1 1  ON 17
   ud_8                -1.548528e-01 1 1  ON 18
   ud_9                -1.458012e-01 1 1  ON 19
   eO_0                -7.484588e-01 1 1  ON 20
   eO_1                -4.275846e-01 1 1  ON 21
   eO_2                -1.613517e-02 1 1  ON 22
   eO_3                 2.979876e-01 1 1  ON 23
   eO_4                 5.260778e-01 1 1  ON 24
   eO_5                 4.904130e-01 1 1  ON 25
   eO_6                 2.635600e-01 1 1  ON 26
   eO_7                -4.204710e-02 1 1  ON 27
   eO_8                -2.367527e-01 1 1  ON 28
   eO_9                -1.029804e-01 1 1  ON 29
  eH1_0                -2.661604e-01 1 1  ON 30
  eH1_1                -1.583665e-01 1 1  ON 31
  eH1_2                -1.081441e-01 1 1  ON 32
  eH1_3                -5.247510e-02 1 1  ON 33
  eH1_4                -1.718765e-03 1 1  ON 34
  eH1_5                 3.465651e-02 1 1  ON 35
  eH1_6                 9.765670e-02 1 1  ON 36
  eH1_7                 1.597367e-01 1 1  ON 37
  eH1_8                 1.973667e-01 1 1  ON 38
  eH1_9                 9.630679e-02 1 1  ON 39
  eH2_0                -2.644053e-01 1 1  ON 40
  eH2_1                -1.566775e-01 1 1  ON 41
  eH2_2                -1.065906e-01 1 1  ON 42
  eH2_3                -5.091843e-02 1 1  ON 43
  eH2_4                -1.264015e-04 1 1  ON 44
  eH2_5                 3.710579e-02 1 1  ON 45
  eH2_6                 9.949193e-02 1 1  ON 46
  eH2_7                 1.613768e-01 1 1  ON 47
  eH2_8                 2.014379e-01 1 1  ON 48
  eH2_9                 9.005151e-02 1 1  ON 49
ci_0001                 7.014053e-01 3 1  ON 50
ci_0002                 7.007730e-01 3 1  ON 51
ci_0003                -2.736821e-02 3 1  ON 52
ci_0004                -2.682753e-02 3 1  ON 53
ci_0005                -3.613643e-02 3 1  ON 54
ci_0006                -3.617031e-02 3 1  ON 55
ci_0007                -2.129581e-02 3 1  ON 56
ci_0008                -2.141049e-02 3 1  ON 57
ci_0009                -1.745031e-02 3 1  ON 58
ci_0010                -1.709137e-02 3 1  ON 59
ci_0011                -1.232970e-02 3 1  ON 60
ci_0012                -1.208762e-02 3 1  ON 61
ci_0013                 1.356056e-02 3 1  ON 62
ci_0014                 1.308079e-02 3 1  ON 63
ci_0015                 1.326126e-02 3 1  ON 64
ci_0016                 1.298466e-02 3 1  ON 65
ci_0017                 1.122800e-02 3 1  ON 66
ci_0018                 1.132980e-02 3 1  ON 67
ci_0019                 1.144004e-02 3 1  ON 68
ci_0020                 1.149139e-02 3 1  ON 69
ci_0021                -1.864293e-03 3 1  ON 70
ci_0022                -7.114347e-04 3 1  ON 71
ci_0023                -1.153123e-02 3 1  ON 72
ci_0024                -1.130717e-02 3 1  ON 73
ci_0025                -1.055985e-02 3 1  ON 74
ci_0026                -1.044652e-02 3 1  ON 75
ci_0027                -1.139321e-02 3 1  ON 76
ci_0028                -1.119751e-02 3 1  ON 77
ci_0029                -1.061182e-02 3 1  ON 78
ci_0030                -1.092014e-02 3 1  ON 79
ci_0031                 2.056297e-02 3 1  ON 80
ci_0032                 2.096986e-02 3 1  ON 81
ci_0033                 9.746081e-03 3 1  ON 82
ci_0034                 1.032649e-02 3 1  ON 83
ci_0035                 6.772043e-03 3 1  ON 84
ci_0036                 6.595040e-03 3 1  ON 85
ci_0037                -1.057725e-02 3 1  ON 86
ci_0038                -1.102058e-02 3 1  ON 87
ci_0039                -2.393861e-03 3 1  ON 88
ci_0040                -2.572437e-03 3 1  ON 89
ci_0041                 7.226272e-03 3 1  ON 90
ci_0042                 6.942993e-03 3 1  ON 91
ci_0043                -1.871373e-02 3 1  ON 92
ci_0044                -1.902639e-02 3 1  ON 93
ci_0045                 7.654653e-03 3 1  ON 94
ci_0046                 7.318793e-03 3 1  ON 95
ci_0047                -1.552062e-03 3 1  ON 96
ci_0048                -1.913734e-03 3 1  ON 97
ci_0049                -5.637642e-03 3 1  ON 98
ci_0050                -5.698029e-03 3 1  ON 99
ci_0051                -3.345987e-03 3 1  ON 100
ci_0052                -3.221964e-03 3 1  ON 101
ci_0053                -4.589562e-03 3 1  ON 102
ci_0054                -4.782151e-03 3 1  ON 103
ci_0055                 6.448805e-03 3 1  ON 104
ci_0056                 6.926641e-03 3 1  ON 105
ci_0057                 5.142809e-03 3 1  ON 106
ci_0058                 4.567010e-03 3 1  ON 107
ci_0059                -4.901507e-03 3 1  ON 108
ci_0060                -4.687525e-03 3 1  ON 109
ci_0061                -3.489092e-03 3 1  ON 110
ci_0062                -3.323031e-03 3 1  ON 111
ci_0063                -8.310704e-03 3 1  ON 112
ci_0064                -8.550794e-03 3 1  ON 113
ci_0065                -5.540111e-03 3 1  ON 114
ci_0066                -5.432756e-03 3 1  ON 115
ci_0067                -4.817523e-03 3 1  ON 116
ci_0068                -5.240001e-03 3 1  ON 117
ci_0069                 4.197097e-03 3 1  ON 118
ci_0070                 4.182910e-03 3 1  ON 119
ci_0071                -5.976468e-05 3 1  ON 120
ci_0072                 1.695991e-05 3 1  ON 121
ci_0073                 4.234727e-03 3 1  ON 122
ci_0074                 4.140700e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 86
    time step          = 0.05
    reference energy   = -16.9171
    reference variance = 0.300605
====================================================
  Execution time = 2.0923e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s086
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3198e-01
  Total weights = 1.9518e+06
  Execution time = 1.9245e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320167945639
                                         uncertainty =       0.001952137722

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320167945639
                                         uncertainty =       0.001952137722

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400067817
  error estimate for blocks of size 2^( 2) =       0.000413214007
  error estimate for blocks of size 2^( 3) =       0.000426370402
  error estimate for blocks of size 2^( 4) =       0.000440103625
  error estimate for blocks of size 2^( 5) =       0.000450840617
  error estimate for blocks of size 2^( 6) =       0.000457348487
  error estimate for blocks of size 2^( 7) =       0.000465114008

      target function =                  N/A
              le_mean =     -16.906737876211
             les_mean =     286.169701918424
             stat err =       0.000453351684
             autocorr =       1.284112976719
              std dev =       0.565781332473
             le_variance =       0.320108516175

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320059469501
                                         uncertainty =       0.001949862381

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320059469501
                                         uncertainty =       0.001949862381

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400000387
  error estimate for blocks of size 2^( 2) =       0.000413150098
  error estimate for blocks of size 2^( 3) =       0.000426307400
  error estimate for blocks of size 2^( 4) =       0.000440040027
  error estimate for blocks of size 2^( 5) =       0.000450779293
  error estimate for blocks of size 2^( 6) =       0.000457281152
  error estimate for blocks of size 2^( 7) =       0.000465036515

      target function =                  N/A
              le_mean =     -16.906734216462
             les_mean =     286.170960017125
             stat err =       0.000453284247
             autocorr =       1.284163817418
              std dev =       0.565685972032
             le_variance =       0.320000618954

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320098729020
                                         uncertainty =       0.001950789434

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320098729020
                                         uncertainty =       0.001950789434

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400024769
  error estimate for blocks of size 2^( 2) =       0.000413173227
  error estimate for blocks of size 2^( 3) =       0.000426330202
  error estimate for blocks of size 2^( 4) =       0.000440063805
  error estimate for blocks of size 2^( 5) =       0.000450801779
  error estimate for blocks of size 2^( 6) =       0.000457306442
  error estimate for blocks of size 2^( 7) =       0.000465066153

      target function =                  N/A
              le_mean =     -16.906735882400
             les_mean =     286.173993784874
             stat err =       0.000453309545
             autocorr =       1.284150607222
              std dev =       0.565720453480
             le_variance =       0.320039631485

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320158518191
                                         uncertainty =       0.001951957889

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320158518191
                                         uncertainty =       0.001951957889

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400061953
  error estimate for blocks of size 2^( 2) =       0.000413208438
  error estimate for blocks of size 2^( 3) =       0.000426364905
  error estimate for blocks of size 2^( 4) =       0.000440098136
  error estimate for blocks of size 2^( 5) =       0.000450835283
  error estimate for blocks of size 2^( 6) =       0.000457342698
  error estimate for blocks of size 2^( 7) =       0.000465107495

      target function =                  N/A
              le_mean =     -16.906737555200
             les_mean =     286.169692631135
             stat err =       0.000453345903
             autocorr =       1.284117870017
              std dev =       0.565773039201
             le_variance =       0.320099131887


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906737876211        initial  <--
     1.2925e+00     1.2925e+01             2.6612e-04       -16.906734216462
     5.1699e+00     5.1699e+01             7.4493e-05       -16.906735882400
     2.0680e+01     2.0680e+02             1.9167e-05       -16.906737555200

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.6379
  </log>
  <optVariables href="H2O.s086.opt.xml">
   uu_0                 3.130648e-01 1 1  ON 0
   uu_1                 1.454725e-01 1 1  ON 1
   uu_2                 4.345641e-02 1 1  ON 2
   uu_3                -1.968589e-02 1 1  ON 3
   uu_4                -6.660475e-02 1 1  ON 4
   uu_5                -1.030966e-01 1 1  ON 5
   uu_6                -1.323447e-01 1 1  ON 6
   uu_7                -1.480265e-01 1 1  ON 7
   uu_8                -1.414515e-01 1 1  ON 8
   uu_9                -1.140327e-01 1 1  ON 9
   ud_0                 4.517817e-01 1 1  ON 10
   ud_1                 1.857933e-01 1 1  ON 11
   ud_2                 6.522165e-02 1 1  ON 12
   ud_3                -6.205238e-03 1 1  ON 13
   ud_4                -6.373556e-02 1 1  ON 14
   ud_5                -1.062086e-01 1 1  ON 15
   ud_6                -1.350810e-01 1 1  ON 16
   ud_7                -1.528755e-01 1 1  ON 17
   ud_8                -1.548298e-01 1 1  ON 18
   ud_9                -1.457914e-01 1 1  ON 19
   eO_0                -7.484355e-01 1 1  ON 20
   eO_1                -4.275899e-01 1 1  ON 21
   eO_2                -1.616387e-02 1 1  ON 22
   eO_3                 2.979594e-01 1 1  ON 23
   eO_4                 5.260675e-01 1 1  ON 24
   eO_5                 4.903977e-01 1 1  ON 25
   eO_6                 2.635678e-01 1 1  ON 26
   eO_7                -4.203854e-02 1 1  ON 27
   eO_8                -2.367335e-01 1 1  ON 28
   eO_9                -1.029560e-01 1 1  ON 29
  eH1_0                -2.661682e-01 1 1  ON 30
  eH1_1                -1.583642e-01 1 1  ON 31
  eH1_2                -1.081180e-01 1 1  ON 32
  eH1_3                -5.247155e-02 1 1  ON 33
  eH1_4                -1.710226e-03 1 1  ON 34
  eH1_5                 3.465067e-02 1 1  ON 35
  eH1_6                 9.767523e-02 1 1  ON 36
  eH1_7                 1.597532e-01 1 1  ON 37
  eH1_8                 1.973517e-01 1 1  ON 38
  eH1_9                 9.626861e-02 1 1  ON 39
  eH2_0                -2.644126e-01 1 1  ON 40
  eH2_1                -1.566775e-01 1 1  ON 41
  eH2_2                -1.065838e-01 1 1  ON 42
  eH2_3                -5.091194e-02 1 1  ON 43
  eH2_4                -1.276746e-04 1 1  ON 44
  eH2_5                 3.713023e-02 1 1  ON 45
  eH2_6                 9.949686e-02 1 1  ON 46
  eH2_7                 1.613780e-01 1 1  ON 47
  eH2_8                 2.014314e-01 1 1  ON 48
  eH2_9                 9.002537e-02 1 1  ON 49
ci_0001                 7.014002e-01 3 1  ON 50
ci_0002                 7.007741e-01 3 1  ON 51
ci_0003                -2.734512e-02 3 1  ON 52
ci_0004                -2.681684e-02 3 1  ON 53
ci_0005                -3.611920e-02 3 1  ON 54
ci_0006                -3.615898e-02 3 1  ON 55
ci_0007                -2.129720e-02 3 1  ON 56
ci_0008                -2.141301e-02 3 1  ON 57
ci_0009                -1.744733e-02 3 1  ON 58
ci_0010                -1.707828e-02 3 1  ON 59
ci_0011                -1.233650e-02 3 1  ON 60
ci_0012                -1.207311e-02 3 1  ON 61
ci_0013                 1.359747e-02 3 1  ON 62
ci_0014                 1.311359e-02 3 1  ON 63
ci_0015                 1.324758e-02 3 1  ON 64
ci_0016                 1.296803e-02 3 1  ON 65
ci_0017                 1.124635e-02 3 1  ON 66
ci_0018                 1.132569e-02 3 1  ON 67
ci_0019                 1.144004e-02 3 1  ON 68
ci_0020                 1.151344e-02 3 1  ON 69
ci_0021                -1.901437e-03 3 1  ON 70
ci_0022                -7.270423e-04 3 1  ON 71
ci_0023                -1.153901e-02 3 1  ON 72
ci_0024                -1.131478e-02 3 1  ON 73
ci_0025                -1.061507e-02 3 1  ON 74
ci_0026                -1.046409e-02 3 1  ON 75
ci_0027                -1.138008e-02 3 1  ON 76
ci_0028                -1.119108e-02 3 1  ON 77
ci_0029                -1.063029e-02 3 1  ON 78
ci_0030                -1.093350e-02 3 1  ON 79
ci_0031                 2.058969e-02 3 1  ON 80
ci_0032                 2.096744e-02 3 1  ON 81
ci_0033                 9.714042e-03 3 1  ON 82
ci_0034                 1.033860e-02 3 1  ON 83
ci_0035                 6.800153e-03 3 1  ON 84
ci_0036                 6.613831e-03 3 1  ON 85
ci_0037                -1.060480e-02 3 1  ON 86
ci_0038                -1.102364e-02 3 1  ON 87
ci_0039                -2.381679e-03 3 1  ON 88
ci_0040                -2.616908e-03 3 1  ON 89
ci_0041                 7.270254e-03 3 1  ON 90
ci_0042                 6.920206e-03 3 1  ON 91
ci_0043                -1.873668e-02 3 1  ON 92
ci_0044                -1.904166e-02 3 1  ON 93
ci_0045                 7.654397e-03 3 1  ON 94
ci_0046                 7.322733e-03 3 1  ON 95
ci_0047                -1.539160e-03 3 1  ON 96
ci_0048                -1.901855e-03 3 1  ON 97
ci_0049                -5.687029e-03 3 1  ON 98
ci_0050                -5.702027e-03 3 1  ON 99
ci_0051                -3.366077e-03 3 1  ON 100
ci_0052                -3.217221e-03 3 1  ON 101
ci_0053                -4.605685e-03 3 1  ON 102
ci_0054                -4.812100e-03 3 1  ON 103
ci_0055                 6.454811e-03 3 1  ON 104
ci_0056                 6.942772e-03 3 1  ON 105
ci_0057                 5.169514e-03 3 1  ON 106
ci_0058                 4.579345e-03 3 1  ON 107
ci_0059                -4.964464e-03 3 1  ON 108
ci_0060                -4.681277e-03 3 1  ON 109
ci_0061                -3.476349e-03 3 1  ON 110
ci_0062                -3.248538e-03 3 1  ON 111
ci_0063                -8.335574e-03 3 1  ON 112
ci_0064                -8.570201e-03 3 1  ON 113
ci_0065                -5.539593e-03 3 1  ON 114
ci_0066                -5.406903e-03 3 1  ON 115
ci_0067                -4.799720e-03 3 1  ON 116
ci_0068                -5.226550e-03 3 1  ON 117
ci_0069                 4.155812e-03 3 1  ON 118
ci_0070                 4.156638e-03 3 1  ON 119
ci_0071                -5.659619e-05 3 1  ON 120
ci_0072                 2.400957e-05 3 1  ON 121
ci_0073                 4.284857e-03 3 1  ON 122
ci_0074                 4.152023e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8083e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s087 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s087 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=87  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 87
    time step          = 0.05
    reference energy   = -16.9369
    reference variance = 0.214052
====================================================
  Execution time = 2.3255e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s087
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5255e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4064e-01
  Total weights = 1.951943997e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1125e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328227559207
                                         uncertainty =       0.003397614807

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328227559207
                                         uncertainty =       0.003397614807

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405171442
  error estimate for blocks of size 2^( 2) =       0.000418090160
  error estimate for blocks of size 2^( 3) =       0.000431027363
  error estimate for blocks of size 2^( 4) =       0.000443425223
  error estimate for blocks of size 2^( 5) =       0.000453098899
  error estimate for blocks of size 2^( 6) =       0.000460004640
  error estimate for blocks of size 2^( 7) =       0.000462614343

      target function =                  N/A
              le_mean =     -16.906746598366
             les_mean =     286.178720157079
             stat err =       0.000454785776
             autocorr =       1.259900049216
              std dev =       0.572998948297
             le_variance =       0.328327794749


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690674659837e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.2925e+01, overlap shift 1.2925e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906746598363       residual = 9.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906746924522       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906746926529       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906746930646       residual = 9.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906746959149       residual = 3.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906746995843       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906747015401       residual = 8.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906747011370       residual = 2.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906747008184       residual = 8.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.2925e+01 is 2.280932e-05

solving harmonic davidson linear method for identity shift 5.1699e+01, overlap shift 5.1699e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906746598363       residual = 9.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906746680947       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906746681732       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906746683016       residual = 9.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906746690268       residual = 3.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906746699650       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906746704617       residual = 7.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906746703561       residual = 2.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906746702780       residual = 8.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.1699e+01 is 5.761837e-06

solving harmonic davidson linear method for identity shift 2.0680e+02, overlap shift 2.0680e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906746598363       residual = 9.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906746619075       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906746619290       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906746619627       residual = 9.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906746621448       residual = 3.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906746623808       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906746625054       residual = 7.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906746624788       residual = 2.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906746624594       residual = 7.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.0680e+02 is 1.444223e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.697046 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9375e+01
  </log>
  <optVariables href="H2O.s087.opt.xml">
   uu_0                 3.130644e-01 1 1  ON 0
   uu_1                 1.454718e-01 1 1  ON 1
   uu_2                 4.345745e-02 1 1  ON 2
   uu_3                -1.968768e-02 1 1  ON 3
   uu_4                -6.660570e-02 1 1  ON 4
   uu_5                -1.030956e-01 1 1  ON 5
   uu_6                -1.323449e-01 1 1  ON 6
   uu_7                -1.480259e-01 1 1  ON 7
   uu_8                -1.414524e-01 1 1  ON 8
   uu_9                -1.140331e-01 1 1  ON 9
   ud_0                 4.517814e-01 1 1  ON 10
   ud_1                 1.857927e-01 1 1  ON 11
   ud_2                 6.522228e-02 1 1  ON 12
   ud_3                -6.203216e-03 1 1  ON 13
   ud_4                -6.373628e-02 1 1  ON 14
   ud_5                -1.062082e-01 1 1  ON 15
   ud_6                -1.350804e-01 1 1  ON 16
   ud_7                -1.528757e-01 1 1  ON 17
   ud_8                -1.548292e-01 1 1  ON 18
   ud_9                -1.457910e-01 1 1  ON 19
   eO_0                -7.484351e-01 1 1  ON 20
   eO_1                -4.275879e-01 1 1  ON 21
   eO_2                -1.616556e-02 1 1  ON 22
   eO_3                 2.979621e-01 1 1  ON 23
   eO_4                 5.260680e-01 1 1  ON 24
   eO_5                 4.903971e-01 1 1  ON 25
   eO_6                 2.635686e-01 1 1  ON 26
   eO_7                -4.203796e-02 1 1  ON 27
   eO_8                -2.367353e-01 1 1  ON 28
   eO_9                -1.029585e-01 1 1  ON 29
  eH1_0                -2.661683e-01 1 1  ON 30
  eH1_1                -1.583656e-01 1 1  ON 31
  eH1_2                -1.081203e-01 1 1  ON 32
  eH1_3                -5.247262e-02 1 1  ON 33
  eH1_4                -1.711623e-03 1 1  ON 34
  eH1_5                 3.465188e-02 1 1  ON 35
  eH1_6                 9.767481e-02 1 1  ON 36
  eH1_7                 1.597529e-01 1 1  ON 37
  eH1_8                 1.973537e-01 1 1  ON 38
  eH1_9                 9.627221e-02 1 1  ON 39
  eH2_0                -2.644140e-01 1 1  ON 40
  eH2_1                -1.566787e-01 1 1  ON 41
  eH2_2                -1.065848e-01 1 1  ON 42
  eH2_3                -5.091020e-02 1 1  ON 43
  eH2_4                -1.290548e-04 1 1  ON 44
  eH2_5                 3.712715e-02 1 1  ON 45
  eH2_6                 9.949679e-02 1 1  ON 46
  eH2_7                 1.613794e-01 1 1  ON 47
  eH2_8                 2.014329e-01 1 1  ON 48
  eH2_9                 9.002850e-02 1 1  ON 49
ci_0001                 7.013985e-01 3 1  ON 50
ci_0002                 7.007762e-01 3 1  ON 51
ci_0003                -2.734417e-02 3 1  ON 52
ci_0004                -2.681682e-02 3 1  ON 53
ci_0005                -3.612302e-02 3 1  ON 54
ci_0006                -3.615917e-02 3 1  ON 55
ci_0007                -2.129880e-02 3 1  ON 56
ci_0008                -2.141245e-02 3 1  ON 57
ci_0009                -1.744648e-02 3 1  ON 58
ci_0010                -1.707510e-02 3 1  ON 59
ci_0011                -1.233746e-02 3 1  ON 60
ci_0012                -1.207012e-02 3 1  ON 61
ci_0013                 1.359921e-02 3 1  ON 62
ci_0014                 1.311564e-02 3 1  ON 63
ci_0015                 1.324651e-02 3 1  ON 64
ci_0016                 1.296725e-02 3 1  ON 65
ci_0017                 1.124689e-02 3 1  ON 66
ci_0018                 1.132606e-02 3 1  ON 67
ci_0019                 1.143930e-02 3 1  ON 68
ci_0020                 1.151290e-02 3 1  ON 69
ci_0021                -1.899796e-03 3 1  ON 70
ci_0022                -7.283279e-04 3 1  ON 71
ci_0023                -1.154256e-02 3 1  ON 72
ci_0024                -1.131418e-02 3 1  ON 73
ci_0025                -1.061606e-02 3 1  ON 74
ci_0026                -1.046542e-02 3 1  ON 75
ci_0027                -1.137911e-02 3 1  ON 76
ci_0028                -1.118781e-02 3 1  ON 77
ci_0029                -1.063003e-02 3 1  ON 78
ci_0030                -1.093135e-02 3 1  ON 79
ci_0031                 2.058830e-02 3 1  ON 80
ci_0032                 2.096240e-02 3 1  ON 81
ci_0033                 9.713857e-03 3 1  ON 82
ci_0034                 1.033730e-02 3 1  ON 83
ci_0035                 6.798604e-03 3 1  ON 84
ci_0036                 6.614796e-03 3 1  ON 85
ci_0037                -1.060260e-02 3 1  ON 86
ci_0038                -1.101788e-02 3 1  ON 87
ci_0039                -2.380042e-03 3 1  ON 88
ci_0040                -2.616648e-03 3 1  ON 89
ci_0041                 7.270815e-03 3 1  ON 90
ci_0042                 6.924355e-03 3 1  ON 91
ci_0043                -1.873809e-02 3 1  ON 92
ci_0044                -1.904174e-02 3 1  ON 93
ci_0045                 7.652341e-03 3 1  ON 94
ci_0046                 7.321765e-03 3 1  ON 95
ci_0047                -1.542520e-03 3 1  ON 96
ci_0048                -1.898293e-03 3 1  ON 97
ci_0049                -5.684206e-03 3 1  ON 98
ci_0050                -5.699843e-03 3 1  ON 99
ci_0051                -3.366664e-03 3 1  ON 100
ci_0052                -3.218304e-03 3 1  ON 101
ci_0053                -4.604993e-03 3 1  ON 102
ci_0054                -4.815083e-03 3 1  ON 103
ci_0055                 6.452294e-03 3 1  ON 104
ci_0056                 6.940579e-03 3 1  ON 105
ci_0057                 5.167262e-03 3 1  ON 106
ci_0058                 4.581446e-03 3 1  ON 107
ci_0059                -4.963958e-03 3 1  ON 108
ci_0060                -4.678837e-03 3 1  ON 109
ci_0061                -3.477362e-03 3 1  ON 110
ci_0062                -3.245488e-03 3 1  ON 111
ci_0063                -8.341319e-03 3 1  ON 112
ci_0064                -8.564940e-03 3 1  ON 113
ci_0065                -5.538779e-03 3 1  ON 114
ci_0066                -5.407238e-03 3 1  ON 115
ci_0067                -4.799265e-03 3 1  ON 116
ci_0068                -5.226660e-03 3 1  ON 117
ci_0069                 4.158678e-03 3 1  ON 118
ci_0070                 4.158132e-03 3 1  ON 119
ci_0071                -5.499045e-05 3 1  ON 120
ci_0072                 2.495044e-05 3 1  ON 121
ci_0073                 4.285302e-03 3 1  ON 122
ci_0074                 4.149245e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 87
    time step          = 0.05
    reference energy   = -16.9393
    reference variance = 0.31463
====================================================
  Execution time = 2.0926e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s087
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4241e-01
  Total weights = 1.9514e+06
  Execution time = 1.9120e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327395171415
                                         uncertainty =       0.002746178693

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327395171415
                                         uncertainty =       0.002746178693

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404582698
  error estimate for blocks of size 2^( 2) =       0.000417493825
  error estimate for blocks of size 2^( 3) =       0.000430615087
  error estimate for blocks of size 2^( 4) =       0.000442430614
  error estimate for blocks of size 2^( 5) =       0.000452331793
  error estimate for blocks of size 2^( 6) =       0.000462047315
  error estimate for blocks of size 2^( 7) =       0.000467623989

      target function =                  N/A
              le_mean =     -16.906221406135
             les_mean =     286.162721088588
             stat err =       0.000456108428
             autocorr =       1.270929858184
              std dev =       0.572166338112
             le_variance =       0.327374318468

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327384290287
                                         uncertainty =       0.002745068213

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327384290287
                                         uncertainty =       0.002745068213

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404575974
  error estimate for blocks of size 2^( 2) =       0.000417487711
  error estimate for blocks of size 2^( 3) =       0.000430609609
  error estimate for blocks of size 2^( 4) =       0.000442425144
  error estimate for blocks of size 2^( 5) =       0.000452326147
  error estimate for blocks of size 2^( 6) =       0.000462042579
  error estimate for blocks of size 2^( 7) =       0.000467619665

      target function =                  N/A
              le_mean =     -16.906221653288
             les_mean =     286.162805392283
             stat err =       0.000456103384
             autocorr =       1.270943990808
              std dev =       0.572156829024
             le_variance =       0.327363436998

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327389637804
                                         uncertainty =       0.002745612223

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327389637804
                                         uncertainty =       0.002745612223

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404579278
  error estimate for blocks of size 2^( 2) =       0.000417490712
  error estimate for blocks of size 2^( 3) =       0.000430612295
  error estimate for blocks of size 2^( 4) =       0.000442427828
  error estimate for blocks of size 2^( 5) =       0.000452328918
  error estimate for blocks of size 2^( 6) =       0.000462044902
  error estimate for blocks of size 2^( 7) =       0.000467621782

      target function =                  N/A
              le_mean =     -16.906221529320
             les_mean =     286.162758570671
             stat err =       0.000456105858
             autocorr =       1.270937017643
              std dev =       0.572161502248
             le_variance =       0.327368784655

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327394474406
                                         uncertainty =       0.002746107409

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327394474406
                                         uncertainty =       0.002746107409

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404582267
  error estimate for blocks of size 2^( 2) =       0.000417493433
  error estimate for blocks of size 2^( 3) =       0.000430614735
  error estimate for blocks of size 2^( 4) =       0.000442430263
  error estimate for blocks of size 2^( 5) =       0.000452331431
  error estimate for blocks of size 2^( 6) =       0.000462047011
  error estimate for blocks of size 2^( 7) =       0.000467623710

      target function =                  N/A
              le_mean =     -16.906221421224
             les_mean =     286.162725240712
             stat err =       0.000456108104
             autocorr =       1.270930757325
              std dev =       0.572165728993
             le_variance =       0.327373621434


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906221406135        initial
     1.2925e+01     1.2925e+02             2.2809e-05       -16.906221653288  <--
     5.1699e+01     5.1699e+02             5.7618e-06       -16.906221529320
     2.0680e+02     2.0680e+03             1.4442e-06       -16.906221421224

*****************************************************************************
Applying the update for shift_i =   1.2925e+01     and shift_s =   1.2925e+02
*****************************************************************************

  Execution time = 3.0585e+01
  </log>
  <optVariables href="H2O.s087.opt.xml">
   uu_0                 3.130635e-01 1 1  ON 0
   uu_1                 1.454698e-01 1 1  ON 1
   uu_2                 4.346035e-02 1 1  ON 2
   uu_3                -1.969287e-02 1 1  ON 3
   uu_4                -6.660863e-02 1 1  ON 4
   uu_5                -1.030926e-01 1 1  ON 5
   uu_6                -1.323457e-01 1 1  ON 6
   uu_7                -1.480241e-01 1 1  ON 7
   uu_8                -1.414549e-01 1 1  ON 8
   uu_9                -1.140345e-01 1 1  ON 9
   ud_0                 4.517803e-01 1 1  ON 10
   ud_1                 1.857912e-01 1 1  ON 11
   ud_2                 6.522413e-02 1 1  ON 12
   ud_3                -6.197324e-03 1 1  ON 13
   ud_4                -6.373829e-02 1 1  ON 14
   ud_5                -1.062071e-01 1 1  ON 15
   ud_6                -1.350789e-01 1 1  ON 16
   ud_7                -1.528764e-01 1 1  ON 17
   ud_8                -1.548273e-01 1 1  ON 18
   ud_9                -1.457899e-01 1 1  ON 19
   eO_0                -7.484336e-01 1 1  ON 20
   eO_1                -4.275820e-01 1 1  ON 21
   eO_2                -1.617042e-02 1 1  ON 22
   eO_3                 2.979704e-01 1 1  ON 23
   eO_4                 5.260693e-01 1 1  ON 24
   eO_5                 4.903953e-01 1 1  ON 25
   eO_6                 2.635708e-01 1 1  ON 26
   eO_7                -4.203621e-02 1 1  ON 27
   eO_8                -2.367409e-01 1 1  ON 28
   eO_9                -1.029659e-01 1 1  ON 29
  eH1_0                -2.661686e-01 1 1  ON 30
  eH1_1                -1.583700e-01 1 1  ON 31
  eH1_2                -1.081271e-01 1 1  ON 32
  eH1_3                -5.247585e-02 1 1  ON 33
  eH1_4                -1.715812e-03 1 1  ON 34
  eH1_5                 3.465550e-02 1 1  ON 35
  eH1_6                 9.767354e-02 1 1  ON 36
  eH1_7                 1.597519e-01 1 1  ON 37
  eH1_8                 1.973597e-01 1 1  ON 38
  eH1_9                 9.628298e-02 1 1  ON 39
  eH2_0                -2.644179e-01 1 1  ON 40
  eH2_1                -1.566822e-01 1 1  ON 41
  eH2_2                -1.065880e-01 1 1  ON 42
  eH2_3                -5.090509e-02 1 1  ON 43
  eH2_4                -1.331182e-04 1 1  ON 44
  eH2_5                 3.711791e-02 1 1  ON 45
  eH2_6                 9.949657e-02 1 1  ON 46
  eH2_7                 1.613833e-01 1 1  ON 47
  eH2_8                 2.014373e-01 1 1  ON 48
  eH2_9                 9.003785e-02 1 1  ON 49
ci_0001                 7.013934e-01 3 1  ON 50
ci_0002                 7.007822e-01 3 1  ON 51
ci_0003                -2.734133e-02 3 1  ON 52
ci_0004                -2.681677e-02 3 1  ON 53
ci_0005                -3.613438e-02 3 1  ON 54
ci_0006                -3.615974e-02 3 1  ON 55
ci_0007                -2.130360e-02 3 1  ON 56
ci_0008                -2.141081e-02 3 1  ON 57
ci_0009                -1.744397e-02 3 1  ON 58
ci_0010                -1.706576e-02 3 1  ON 59
ci_0011                -1.234027e-02 3 1  ON 60
ci_0012                -1.206129e-02 3 1  ON 61
ci_0013                 1.360434e-02 3 1  ON 62
ci_0014                 1.312169e-02 3 1  ON 63
ci_0015                 1.324334e-02 3 1  ON 64
ci_0016                 1.296495e-02 3 1  ON 65
ci_0017                 1.124846e-02 3 1  ON 66
ci_0018                 1.132716e-02 3 1  ON 67
ci_0019                 1.143714e-02 3 1  ON 68
ci_0020                 1.151130e-02 3 1  ON 69
ci_0021                -1.894900e-03 3 1  ON 70
ci_0022                -7.321711e-04 3 1  ON 71
ci_0023                -1.155301e-02 3 1  ON 72
ci_0024                -1.131240e-02 3 1  ON 73
ci_0025                -1.061897e-02 3 1  ON 74
ci_0026                -1.046934e-02 3 1  ON 75
ci_0027                -1.137623e-02 3 1  ON 76
ci_0028                -1.117814e-02 3 1  ON 77
ci_0029                -1.062929e-02 3 1  ON 78
ci_0030                -1.092500e-02 3 1  ON 79
ci_0031                 2.058414e-02 3 1  ON 80
ci_0032                 2.094743e-02 3 1  ON 81
ci_0033                 9.713311e-03 3 1  ON 82
ci_0034                 1.033342e-02 3 1  ON 83
ci_0035                 6.794030e-03 3 1  ON 84
ci_0036                 6.617650e-03 3 1  ON 85
ci_0037                -1.059605e-02 3 1  ON 86
ci_0038                -1.100083e-02 3 1  ON 87
ci_0039                -2.375269e-03 3 1  ON 88
ci_0040                -2.615889e-03 3 1  ON 89
ci_0041                 7.272488e-03 3 1  ON 90
ci_0042                 6.936596e-03 3 1  ON 91
ci_0043                -1.874230e-02 3 1  ON 92
ci_0044                -1.904196e-02 3 1  ON 93
ci_0045                 7.646243e-03 3 1  ON 94
ci_0046                 7.318899e-03 3 1  ON 95
ci_0047                -1.552335e-03 3 1  ON 96
ci_0048                -1.887892e-03 3 1  ON 97
ci_0049                -5.675870e-03 3 1  ON 98
ci_0050                -5.693402e-03 3 1  ON 99
ci_0051                -3.368385e-03 3 1  ON 100
ci_0052                -3.221462e-03 3 1  ON 101
ci_0053                -4.602984e-03 3 1  ON 102
ci_0054                -4.823824e-03 3 1  ON 103
ci_0055                 6.444839e-03 3 1  ON 104
ci_0056                 6.934083e-03 3 1  ON 105
ci_0057                 5.160599e-03 3 1  ON 106
ci_0058                 4.587675e-03 3 1  ON 107
ci_0059                -4.962483e-03 3 1  ON 108
ci_0060                -4.671693e-03 3 1  ON 109
ci_0061                -3.480348e-03 3 1  ON 110
ci_0062                -3.236471e-03 3 1  ON 111
ci_0063                -8.358192e-03 3 1  ON 112
ci_0064                -8.549511e-03 3 1  ON 113
ci_0065                -5.536391e-03 3 1  ON 114
ci_0066                -5.408219e-03 3 1  ON 115
ci_0067                -4.797942e-03 3 1  ON 116
ci_0068                -5.226982e-03 3 1  ON 117
ci_0069                 4.167060e-03 3 1  ON 118
ci_0070                 4.162506e-03 3 1  ON 119
ci_0071                -5.024420e-05 3 1  ON 120
ci_0072                 2.774158e-05 3 1  ON 121
ci_0073                 4.286599e-03 3 1  ON 122
ci_0074                 4.141130e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9967e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s088 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s088 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=88  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 88
    time step          = 0.05
    reference energy   = -16.8863
    reference variance = 0.361394
====================================================
  Execution time = 2.1205e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s088
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5237e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3424e-01
  Total weights = 1.951771825e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.2323e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322521972322
                                         uncertainty =       0.001714581290

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322521972322
                                         uncertainty =       0.001714581290

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401616550
  error estimate for blocks of size 2^( 2) =       0.000414510860
  error estimate for blocks of size 2^( 3) =       0.000427799741
  error estimate for blocks of size 2^( 4) =       0.000440465084
  error estimate for blocks of size 2^( 5) =       0.000452503092
  error estimate for blocks of size 2^( 6) =       0.000462147372
  error estimate for blocks of size 2^( 7) =       0.000469699930

      target function =                  N/A
              le_mean =     -16.905719376424
             les_mean =     286.137588935258
             stat err =       0.000456203869
             autocorr =       1.290311969454
              std dev =       0.567971572556
             le_variance =       0.322591707232


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690571937642e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.2312e+00, overlap shift 3.2312e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905719376438       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905720072204       residual = 4.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905720141467       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905720223499       residual = 9.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905720158002       residual = 3.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905720233540       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905720175256       residual = 7.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905720255263       residual = 2.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905720283668       residual = 6.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.2312e+00 is 1.001542e-04

solving harmonic davidson linear method for identity shift 1.2925e+01, overlap shift 1.2925e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905719376438       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905719558581       residual = 4.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905719578706       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905719601719       residual = 9.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905719587354       residual = 3.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905719605521       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905719588634       residual = 6.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905719607169       residual = 1.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905719616014       residual = 6.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.2925e+01 is 2.551886e-05

solving harmonic davidson linear method for identity shift 5.1699e+01, overlap shift 5.1699e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905719376438       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905719422517       residual = 4.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905719427748       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905719433670       residual = 9.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905719430220       residual = 3.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905719434737       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905719430403       residual = 6.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905719434876       residual = 1.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905719437202       residual = 6.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.1699e+01 is 6.410646e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.700454 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7445e+01
  </log>
  <optVariables href="H2O.s088.opt.xml">
   uu_0                 3.130595e-01 1 1  ON 0
   uu_1                 1.454726e-01 1 1  ON 1
   uu_2                 4.345440e-02 1 1  ON 2
   uu_3                -1.969741e-02 1 1  ON 3
   uu_4                -6.660573e-02 1 1  ON 4
   uu_5                -1.030881e-01 1 1  ON 5
   uu_6                -1.323439e-01 1 1  ON 6
   uu_7                -1.480324e-01 1 1  ON 7
   uu_8                -1.414607e-01 1 1  ON 8
   uu_9                -1.140313e-01 1 1  ON 9
   ud_0                 4.517829e-01 1 1  ON 10
   ud_1                 1.857956e-01 1 1  ON 11
   ud_2                 6.522508e-02 1 1  ON 12
   ud_3                -6.199750e-03 1 1  ON 13
   ud_4                -6.373891e-02 1 1  ON 14
   ud_5                -1.062087e-01 1 1  ON 15
   ud_6                -1.350748e-01 1 1  ON 16
   ud_7                -1.528801e-01 1 1  ON 17
   ud_8                -1.548299e-01 1 1  ON 18
   ud_9                -1.457880e-01 1 1  ON 19
   eO_0                -7.484391e-01 1 1  ON 20
   eO_1                -4.275757e-01 1 1  ON 21
   eO_2                -1.615743e-02 1 1  ON 22
   eO_3                 2.979650e-01 1 1  ON 23
   eO_4                 5.260716e-01 1 1  ON 24
   eO_5                 4.903973e-01 1 1  ON 25
   eO_6                 2.635750e-01 1 1  ON 26
   eO_7                -4.203585e-02 1 1  ON 27
   eO_8                -2.367475e-01 1 1  ON 28
   eO_9                -1.029746e-01 1 1  ON 29
  eH1_0                -2.661657e-01 1 1  ON 30
  eH1_1                -1.583768e-01 1 1  ON 31
  eH1_2                -1.081346e-01 1 1  ON 32
  eH1_3                -5.248088e-02 1 1  ON 33
  eH1_4                -1.720087e-03 1 1  ON 34
  eH1_5                 3.465317e-02 1 1  ON 35
  eH1_6                 9.767722e-02 1 1  ON 36
  eH1_7                 1.597491e-01 1 1  ON 37
  eH1_8                 1.973645e-01 1 1  ON 38
  eH1_9                 9.629825e-02 1 1  ON 39
  eH2_0                -2.644279e-01 1 1  ON 40
  eH2_1                -1.566902e-01 1 1  ON 41
  eH2_2                -1.065921e-01 1 1  ON 42
  eH2_3                -5.090405e-02 1 1  ON 43
  eH2_4                -1.379442e-04 1 1  ON 44
  eH2_5                 3.711758e-02 1 1  ON 45
  eH2_6                 9.949844e-02 1 1  ON 46
  eH2_7                 1.613902e-01 1 1  ON 47
  eH2_8                 2.014410e-01 1 1  ON 48
  eH2_9                 9.004997e-02 1 1  ON 49
ci_0001                 7.013948e-01 3 1  ON 50
ci_0002                 7.007815e-01 3 1  ON 51
ci_0003                -2.734620e-02 3 1  ON 52
ci_0004                -2.681092e-02 3 1  ON 53
ci_0005                -3.612796e-02 3 1  ON 54
ci_0006                -3.617245e-02 3 1  ON 55
ci_0007                -2.129840e-02 3 1  ON 56
ci_0008                -2.143633e-02 3 1  ON 57
ci_0009                -1.743565e-02 3 1  ON 58
ci_0010                -1.707775e-02 3 1  ON 59
ci_0011                -1.232553e-02 3 1  ON 60
ci_0012                -1.206750e-02 3 1  ON 61
ci_0013                 1.359016e-02 3 1  ON 62
ci_0014                 1.313220e-02 3 1  ON 63
ci_0015                 1.323039e-02 3 1  ON 64
ci_0016                 1.296043e-02 3 1  ON 65
ci_0017                 1.125870e-02 3 1  ON 66
ci_0018                 1.131723e-02 3 1  ON 67
ci_0019                 1.144513e-02 3 1  ON 68
ci_0020                 1.150276e-02 3 1  ON 69
ci_0021                -1.892967e-03 3 1  ON 70
ci_0022                -7.417664e-04 3 1  ON 71
ci_0023                -1.153971e-02 3 1  ON 72
ci_0024                -1.130254e-02 3 1  ON 73
ci_0025                -1.062685e-02 3 1  ON 74
ci_0026                -1.046231e-02 3 1  ON 75
ci_0027                -1.135490e-02 3 1  ON 76
ci_0028                -1.117557e-02 3 1  ON 77
ci_0029                -1.063370e-02 3 1  ON 78
ci_0030                -1.092233e-02 3 1  ON 79
ci_0031                 2.058774e-02 3 1  ON 80
ci_0032                 2.093822e-02 3 1  ON 81
ci_0033                 9.715187e-03 3 1  ON 82
ci_0034                 1.033001e-02 3 1  ON 83
ci_0035                 6.802169e-03 3 1  ON 84
ci_0036                 6.617793e-03 3 1  ON 85
ci_0037                -1.059898e-02 3 1  ON 86
ci_0038                -1.097650e-02 3 1  ON 87
ci_0039                -2.382845e-03 3 1  ON 88
ci_0040                -2.622552e-03 3 1  ON 89
ci_0041                 7.275313e-03 3 1  ON 90
ci_0042                 6.936742e-03 3 1  ON 91
ci_0043                -1.874745e-02 3 1  ON 92
ci_0044                -1.904022e-02 3 1  ON 93
ci_0045                 7.649025e-03 3 1  ON 94
ci_0046                 7.318455e-03 3 1  ON 95
ci_0047                -1.561001e-03 3 1  ON 96
ci_0048                -1.873740e-03 3 1  ON 97
ci_0049                -5.683837e-03 3 1  ON 98
ci_0050                -5.677604e-03 3 1  ON 99
ci_0051                -3.366354e-03 3 1  ON 100
ci_0052                -3.224592e-03 3 1  ON 101
ci_0053                -4.606800e-03 3 1  ON 102
ci_0054                -4.829987e-03 3 1  ON 103
ci_0055                 6.445247e-03 3 1  ON 104
ci_0056                 6.934187e-03 3 1  ON 105
ci_0057                 5.138689e-03 3 1  ON 106
ci_0058                 4.589056e-03 3 1  ON 107
ci_0059                -4.959185e-03 3 1  ON 108
ci_0060                -4.670983e-03 3 1  ON 109
ci_0061                -3.490446e-03 3 1  ON 110
ci_0062                -3.246764e-03 3 1  ON 111
ci_0063                -8.382587e-03 3 1  ON 112
ci_0064                -8.543214e-03 3 1  ON 113
ci_0065                -5.542583e-03 3 1  ON 114
ci_0066                -5.399720e-03 3 1  ON 115
ci_0067                -4.793796e-03 3 1  ON 116
ci_0068                -5.213595e-03 3 1  ON 117
ci_0069                 4.162794e-03 3 1  ON 118
ci_0070                 4.158742e-03 3 1  ON 119
ci_0071                -5.019237e-05 3 1  ON 120
ci_0072                 2.787815e-05 3 1  ON 121
ci_0073                 4.277327e-03 3 1  ON 122
ci_0074                 4.133161e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 88
    time step          = 0.05
    reference energy   = -16.816
    reference variance = 0.238676
====================================================
  Execution time = 2.0752e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s088
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4055e-01
  Total weights = 1.9517e+06
  Execution time = 1.9207e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325262418633
                                         uncertainty =       0.002607026694

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325262418633
                                         uncertainty =       0.002607026694

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403435489
  error estimate for blocks of size 2^( 2) =       0.000416565916
  error estimate for blocks of size 2^( 3) =       0.000429577697
  error estimate for blocks of size 2^( 4) =       0.000441656226
  error estimate for blocks of size 2^( 5) =       0.000453320089
  error estimate for blocks of size 2^( 6) =       0.000462660708
  error estimate for blocks of size 2^( 7) =       0.000469278051

      target function =                  N/A
              le_mean =     -16.906540504032
             les_mean =     286.171702457604
             stat err =       0.000456728769
             autocorr =       1.281647332559
              std dev =       0.570543939959
             le_variance =       0.325520387424

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325267281300
                                         uncertainty =       0.002606260122

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325267281300
                                         uncertainty =       0.002606260122

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403438243
  error estimate for blocks of size 2^( 2) =       0.000416568782
  error estimate for blocks of size 2^( 3) =       0.000429581865
  error estimate for blocks of size 2^( 4) =       0.000441661108
  error estimate for blocks of size 2^( 5) =       0.000453325789
  error estimate for blocks of size 2^( 6) =       0.000462669368
  error estimate for blocks of size 2^( 7) =       0.000469286318

      target function =                  N/A
              le_mean =     -16.906541368294
             les_mean =     286.171634829903
             stat err =       0.000456735646
             autocorr =       1.281668430647
              std dev =       0.570547834583
             le_variance =       0.325524831547

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325263834666
                                         uncertainty =       0.002606577381

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325263834666
                                         uncertainty =       0.002606577381

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403436227
  error estimate for blocks of size 2^( 2) =       0.000416566733
  error estimate for blocks of size 2^( 3) =       0.000429579213
  error estimate for blocks of size 2^( 4) =       0.000441658152
  error estimate for blocks of size 2^( 5) =       0.000453322475
  error estimate for blocks of size 2^( 6) =       0.000462664652
  error estimate for blocks of size 2^( 7) =       0.000469281702

      target function =                  N/A
              le_mean =     -16.906540911581
             les_mean =     286.171645435712
             stat err =       0.000456731745
             autocorr =       1.281659346484
              std dev =       0.570544984021
             le_variance =       0.325521578792

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325262523840
                                         uncertainty =       0.002606967430

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325262523840
                                         uncertainty =       0.002606967430

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403435536
  error estimate for blocks of size 2^( 2) =       0.000416565974
  error estimate for blocks of size 2^( 3) =       0.000429577844
  error estimate for blocks of size 2^( 4) =       0.000441656428
  error estimate for blocks of size 2^( 5) =       0.000453320352
  error estimate for blocks of size 2^( 6) =       0.000462661171
  error estimate for blocks of size 2^( 7) =       0.000469278472

      target function =                  N/A
              le_mean =     -16.906540549529
             les_mean =     286.171688984274
             stat err =       0.000456729106
             autocorr =       1.281648922498
              std dev =       0.570544007063
             le_variance =       0.325520463996


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906540504032        initial
     3.2312e+00     3.2312e+01             1.0015e-04       -16.906541368294  <--
     1.2925e+01     1.2925e+02             2.5519e-05       -16.906540911581
     5.1699e+01     5.1699e+02             6.4106e-06       -16.906540549529

*****************************************************************************
Applying the update for shift_i =   3.2312e+00     and shift_s =   3.2312e+01
*****************************************************************************

  Execution time = 3.0425e+01
  </log>
  <optVariables href="H2O.s088.opt.xml">
   uu_0                 3.130489e-01 1 1  ON 0
   uu_1                 1.454795e-01 1 1  ON 1
   uu_2                 4.343751e-02 1 1  ON 2
   uu_3                -1.971005e-02 1 1  ON 3
   uu_4                -6.659792e-02 1 1  ON 4
   uu_5                -1.030755e-01 1 1  ON 5
   uu_6                -1.323387e-01 1 1  ON 6
   uu_7                -1.480568e-01 1 1  ON 7
   uu_8                -1.414782e-01 1 1  ON 8
   uu_9                -1.140218e-01 1 1  ON 9
   ud_0                 4.517917e-01 1 1  ON 10
   ud_1                 1.858076e-01 1 1  ON 11
   ud_2                 6.522749e-02 1 1  ON 12
   ud_3                -6.206470e-03 1 1  ON 13
   ud_4                -6.374066e-02 1 1  ON 14
   ud_5                -1.062129e-01 1 1  ON 15
   ud_6                -1.350631e-01 1 1  ON 16
   ud_7                -1.528907e-01 1 1  ON 17
   ud_8                -1.548377e-01 1 1  ON 18
   ud_9                -1.457823e-01 1 1  ON 19
   eO_0                -7.484535e-01 1 1  ON 20
   eO_1                -4.275578e-01 1 1  ON 21
   eO_2                -1.612044e-02 1 1  ON 22
   eO_3                 2.979494e-01 1 1  ON 23
   eO_4                 5.260782e-01 1 1  ON 24
   eO_5                 4.904036e-01 1 1  ON 25
   eO_6                 2.635878e-01 1 1  ON 26
   eO_7                -4.203475e-02 1 1  ON 27
   eO_8                -2.367671e-01 1 1  ON 28
   eO_9                -1.030004e-01 1 1  ON 29
  eH1_0                -2.661577e-01 1 1  ON 30
  eH1_1                -1.583973e-01 1 1  ON 31
  eH1_2                -1.081558e-01 1 1  ON 32
  eH1_3                -5.249658e-02 1 1  ON 33
  eH1_4                -1.732832e-03 1 1  ON 34
  eH1_5                 3.464629e-02 1 1  ON 35
  eH1_6                 9.768819e-02 1 1  ON 36
  eH1_7                 1.597409e-01 1 1  ON 37
  eH1_8                 1.973789e-01 1 1  ON 38
  eH1_9                 9.634380e-02 1 1  ON 39
  eH2_0                -2.644579e-01 1 1  ON 40
  eH2_1                -1.567131e-01 1 1  ON 41
  eH2_2                -1.066039e-01 1 1  ON 42
  eH2_3                -5.090253e-02 1 1  ON 43
  eH2_4                -1.517410e-04 1 1  ON 44
  eH2_5                 3.711633e-02 1 1  ON 45
  eH2_6                 9.950389e-02 1 1  ON 46
  eH2_7                 1.614106e-01 1 1  ON 47
  eH2_8                 2.014520e-01 1 1  ON 48
  eH2_9                 9.008612e-02 1 1  ON 49
ci_0001                 7.013990e-01 3 1  ON 50
ci_0002                 7.007792e-01 3 1  ON 51
ci_0003                -2.735975e-02 3 1  ON 52
ci_0004                -2.679436e-02 3 1  ON 53
ci_0005                -3.610920e-02 3 1  ON 54
ci_0006                -3.620914e-02 3 1  ON 55
ci_0007                -2.128329e-02 3 1  ON 56
ci_0008                -2.151097e-02 3 1  ON 57
ci_0009                -1.741253e-02 3 1  ON 58
ci_0010                -1.711131e-02 3 1  ON 59
ci_0011                -1.228385e-02 3 1  ON 60
ci_0012                -1.208501e-02 3 1  ON 61
ci_0013                 1.355051e-02 3 1  ON 62
ci_0014                 1.316172e-02 3 1  ON 63
ci_0015                 1.319395e-02 3 1  ON 64
ci_0016                 1.294776e-02 3 1  ON 65
ci_0017                 1.128750e-02 3 1  ON 66
ci_0018                 1.128948e-02 3 1  ON 67
ci_0019                 1.146805e-02 3 1  ON 68
ci_0020                 1.147893e-02 3 1  ON 69
ci_0021                -1.887289e-03 3 1  ON 70
ci_0022                -7.695915e-04 3 1  ON 71
ci_0023                -1.150282e-02 3 1  ON 72
ci_0024                -1.127516e-02 3 1  ON 73
ci_0025                -1.064897e-02 3 1  ON 74
ci_0026                -1.044259e-02 3 1  ON 75
ci_0027                -1.129535e-02 3 1  ON 76
ci_0028                -1.116833e-02 3 1  ON 77
ci_0029                -1.064655e-02 3 1  ON 78
ci_0030                -1.091489e-02 3 1  ON 79
ci_0031                 2.059818e-02 3 1  ON 80
ci_0032                 2.091145e-02 3 1  ON 81
ci_0033                 9.720625e-03 3 1  ON 82
ci_0034                 1.032010e-02 3 1  ON 83
ci_0035                 6.825370e-03 3 1  ON 84
ci_0036                 6.618260e-03 3 1  ON 85
ci_0037                -1.060697e-02 3 1  ON 86
ci_0038                -1.090710e-02 3 1  ON 87
ci_0039                -2.403165e-03 3 1  ON 88
ci_0040                -2.640560e-03 3 1  ON 89
ci_0041                 7.283395e-03 3 1  ON 90
ci_0042                 6.937109e-03 3 1  ON 91
ci_0043                -1.876222e-02 3 1  ON 92
ci_0044                -1.903486e-02 3 1  ON 93
ci_0045                 7.657011e-03 3 1  ON 94
ci_0046                 7.317203e-03 3 1  ON 95
ci_0047                -1.584487e-03 3 1  ON 96
ci_0048                -1.835263e-03 3 1  ON 97
ci_0049                -5.706309e-03 3 1  ON 98
ci_0050                -5.633148e-03 3 1  ON 99
ci_0051                -3.360725e-03 3 1  ON 100
ci_0052                -3.233139e-03 3 1  ON 101
ci_0053                -4.617481e-03 3 1  ON 102
ci_0054                -4.846939e-03 3 1  ON 103
ci_0055                 6.446470e-03 3 1  ON 104
ci_0056                 6.934480e-03 3 1  ON 105
ci_0057                 5.076578e-03 3 1  ON 106
ci_0058                 4.592851e-03 3 1  ON 107
ci_0059                -4.950287e-03 3 1  ON 108
ci_0060                -4.668984e-03 3 1  ON 109
ci_0061                -3.519071e-03 3 1  ON 110
ci_0062                -3.276025e-03 3 1  ON 111
ci_0063                -8.449743e-03 3 1  ON 112
ci_0064                -8.526079e-03 3 1  ON 113
ci_0065                -5.559798e-03 3 1  ON 114
ci_0066                -5.375897e-03 3 1  ON 115
ci_0067                -4.782444e-03 3 1  ON 116
ci_0068                -5.177186e-03 3 1  ON 117
ci_0069                 4.151287e-03 3 1  ON 118
ci_0070                 4.148604e-03 3 1  ON 119
ci_0071                -5.018932e-05 3 1  ON 120
ci_0072                 2.800348e-05 3 1  ON 121
ci_0073                 4.252104e-03 3 1  ON 122
ci_0074                 4.111456e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7876e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s089 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s089 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=89  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 89
    time step          = 0.05
    reference energy   = -16.9212
    reference variance = 0.183025
====================================================
  Execution time = 2.1287e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s089
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5289e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3775e-01
  Total weights = 1.951828624e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1170e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323432052945
                                         uncertainty =       0.002651821714

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323432052945
                                         uncertainty =       0.002651821714

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402110530
  error estimate for blocks of size 2^( 2) =       0.000414814546
  error estimate for blocks of size 2^( 3) =       0.000427396910
  error estimate for blocks of size 2^( 4) =       0.000439749624
  error estimate for blocks of size 2^( 5) =       0.000449439268
  error estimate for blocks of size 2^( 6) =       0.000456222716
  error estimate for blocks of size 2^( 7) =       0.000460954494

      target function =                  N/A
              le_mean =     -16.906022060457
             les_mean =     286.151335824020
             stat err =       0.000451591525
             autocorr =       1.261248532519
              std dev =       0.568670165398
             le_variance =       0.323385757014


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690602206046e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.0779e-01, overlap shift 8.0779e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906022060433       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906019785651       residual = 2.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906020454468       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906020537519       residual = 9.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906020175248       residual = 7.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906020213644       residual = 3.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906020047024       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906020134656       residual = 5.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906020038150       residual = 2.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906020118375       residual = 7.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 8.0779e-01 is 3.492912e-04

solving harmonic davidson linear method for identity shift 3.2312e+00, overlap shift 3.2312e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906022060433       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906021385734       residual = 2.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906021571128       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906021604479       residual = 9.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906021500207       residual = 7.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906021500619       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906021463161       residual = 9.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906021484963       residual = 3.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906021480315       residual = 1.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906021492218       residual = 3.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.2312e+00 is 1.014878e-04

solving harmonic davidson linear method for identity shift 1.2925e+01, overlap shift 1.2925e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906022060433       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906021883514       residual = 2.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906021931291       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906021940024       residual = 9.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906021913333       residual = 7.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906021913656       residual = 2.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906021904024       residual = 8.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906021909703       residual = 2.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906021909947       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906021913093       residual = 3.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.2925e+01 is 2.644769e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.704433 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7412e+01
  </log>
  <optVariables href="H2O.s089.opt.xml">
   uu_0                 3.130597e-01 1 1  ON 0
   uu_1                 1.454787e-01 1 1  ON 1
   uu_2                 4.341597e-02 1 1  ON 2
   uu_3                -1.972687e-02 1 1  ON 3
   uu_4                -6.660413e-02 1 1  ON 4
   uu_5                -1.030929e-01 1 1  ON 5
   uu_6                -1.323516e-01 1 1  ON 6
   uu_7                -1.480809e-01 1 1  ON 7
   uu_8                -1.414555e-01 1 1  ON 8
   uu_9                -1.140010e-01 1 1  ON 9
   ud_0                 4.517637e-01 1 1  ON 10
   ud_1                 1.857757e-01 1 1  ON 11
   ud_2                 6.522455e-02 1 1  ON 12
   ud_3                -6.167699e-03 1 1  ON 13
   ud_4                -6.374470e-02 1 1  ON 14
   ud_5                -1.062162e-01 1 1  ON 15
   ud_6                -1.350531e-01 1 1  ON 16
   ud_7                -1.528796e-01 1 1  ON 17
   ud_8                -1.548199e-01 1 1  ON 18
   ud_9                -1.457722e-01 1 1  ON 19
   eO_0                -7.484589e-01 1 1  ON 20
   eO_1                -4.275473e-01 1 1  ON 21
   eO_2                -1.611548e-02 1 1  ON 22
   eO_3                 2.979828e-01 1 1  ON 23
   eO_4                 5.260831e-01 1 1  ON 24
   eO_5                 4.904090e-01 1 1  ON 25
   eO_6                 2.635896e-01 1 1  ON 26
   eO_7                -4.203813e-02 1 1  ON 27
   eO_8                -2.367824e-01 1 1  ON 28
   eO_9                -1.030303e-01 1 1  ON 29
  eH1_0                -2.661357e-01 1 1  ON 30
  eH1_1                -1.583562e-01 1 1  ON 31
  eH1_2                -1.081934e-01 1 1  ON 32
  eH1_3                -5.254550e-02 1 1  ON 33
  eH1_4                -1.755386e-03 1 1  ON 34
  eH1_5                 3.463595e-02 1 1  ON 35
  eH1_6                 9.765768e-02 1 1  ON 36
  eH1_7                 1.597374e-01 1 1  ON 37
  eH1_8                 1.973995e-01 1 1  ON 38
  eH1_9                 9.640158e-02 1 1  ON 39
  eH2_0                -2.644581e-01 1 1  ON 40
  eH2_1                -1.567218e-01 1 1  ON 41
  eH2_2                -1.066484e-01 1 1  ON 42
  eH2_3                -5.090179e-02 1 1  ON 43
  eH2_4                -1.942240e-04 1 1  ON 44
  eH2_5                 3.707332e-02 1 1  ON 45
  eH2_6                 9.954411e-02 1 1  ON 46
  eH2_7                 1.614386e-01 1 1  ON 47
  eH2_8                 2.014711e-01 1 1  ON 48
  eH2_9                 9.013259e-02 1 1  ON 49
ci_0001                 7.013876e-01 3 1  ON 50
ci_0002                 7.007911e-01 3 1  ON 51
ci_0003                -2.736545e-02 3 1  ON 52
ci_0004                -2.683217e-02 3 1  ON 53
ci_0005                -3.607141e-02 3 1  ON 54
ci_0006                -3.615478e-02 3 1  ON 55
ci_0007                -2.136758e-02 3 1  ON 56
ci_0008                -2.145391e-02 3 1  ON 57
ci_0009                -1.737092e-02 3 1  ON 58
ci_0010                -1.715739e-02 3 1  ON 59
ci_0011                -1.223401e-02 3 1  ON 60
ci_0012                -1.212893e-02 3 1  ON 61
ci_0013                 1.356340e-02 3 1  ON 62
ci_0014                 1.319045e-02 3 1  ON 63
ci_0015                 1.324159e-02 3 1  ON 64
ci_0016                 1.303912e-02 3 1  ON 65
ci_0017                 1.129111e-02 3 1  ON 66
ci_0018                 1.134510e-02 3 1  ON 67
ci_0019                 1.148647e-02 3 1  ON 68
ci_0020                 1.142935e-02 3 1  ON 69
ci_0021                -1.867585e-03 3 1  ON 70
ci_0022                -7.740613e-04 3 1  ON 71
ci_0023                -1.147008e-02 3 1  ON 72
ci_0024                -1.132785e-02 3 1  ON 73
ci_0025                -1.072377e-02 3 1  ON 74
ci_0026                -1.039876e-02 3 1  ON 75
ci_0027                -1.129438e-02 3 1  ON 76
ci_0028                -1.117675e-02 3 1  ON 77
ci_0029                -1.068476e-02 3 1  ON 78
ci_0030                -1.090377e-02 3 1  ON 79
ci_0031                 2.052582e-02 3 1  ON 80
ci_0032                 2.093621e-02 3 1  ON 81
ci_0033                 9.672873e-03 3 1  ON 82
ci_0034                 1.031040e-02 3 1  ON 83
ci_0035                 6.815020e-03 3 1  ON 84
ci_0036                 6.602372e-03 3 1  ON 85
ci_0037                -1.062964e-02 3 1  ON 86
ci_0038                -1.093993e-02 3 1  ON 87
ci_0039                -2.423085e-03 3 1  ON 88
ci_0040                -2.599988e-03 3 1  ON 89
ci_0041                 7.256227e-03 3 1  ON 90
ci_0042                 6.931480e-03 3 1  ON 91
ci_0043                -1.871379e-02 3 1  ON 92
ci_0044                -1.901118e-02 3 1  ON 93
ci_0045                 7.650011e-03 3 1  ON 94
ci_0046                 7.264629e-03 3 1  ON 95
ci_0047                -1.606700e-03 3 1  ON 96
ci_0048                -1.876513e-03 3 1  ON 97
ci_0049                -5.698673e-03 3 1  ON 98
ci_0050                -5.560044e-03 3 1  ON 99
ci_0051                -3.418346e-03 3 1  ON 100
ci_0052                -3.313604e-03 3 1  ON 101
ci_0053                -4.624229e-03 3 1  ON 102
ci_0054                -4.804389e-03 3 1  ON 103
ci_0055                 6.440584e-03 3 1  ON 104
ci_0056                 6.916726e-03 3 1  ON 105
ci_0057                 5.109248e-03 3 1  ON 106
ci_0058                 4.694338e-03 3 1  ON 107
ci_0059                -4.966506e-03 3 1  ON 108
ci_0060                -4.745944e-03 3 1  ON 109
ci_0061                -3.514271e-03 3 1  ON 110
ci_0062                -3.270055e-03 3 1  ON 111
ci_0063                -8.467068e-03 3 1  ON 112
ci_0064                -8.429312e-03 3 1  ON 113
ci_0065                -5.587266e-03 3 1  ON 114
ci_0066                -5.410445e-03 3 1  ON 115
ci_0067                -4.807095e-03 3 1  ON 116
ci_0068                -5.167404e-03 3 1  ON 117
ci_0069                 4.198374e-03 3 1  ON 118
ci_0070                 4.164660e-03 3 1  ON 119
ci_0071                 2.628284e-05 3 1  ON 120
ci_0072                 8.001893e-05 3 1  ON 121
ci_0073                 4.284410e-03 3 1  ON 122
ci_0074                 4.094874e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 89
    time step          = 0.05
    reference energy   = -16.9007
    reference variance = 0.161004
====================================================
  Execution time = 2.0873e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s089
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3310e-01
  Total weights = 1.9518e+06
  Execution time = 1.9199e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322180591206
                                         uncertainty =       0.002215471912

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322180591206
                                         uncertainty =       0.002215471912

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401329017
  error estimate for blocks of size 2^( 2) =       0.000414439601
  error estimate for blocks of size 2^( 3) =       0.000427990292
  error estimate for blocks of size 2^( 4) =       0.000440535898
  error estimate for blocks of size 2^( 5) =       0.000451557028
  error estimate for blocks of size 2^( 6) =       0.000459338752
  error estimate for blocks of size 2^( 7) =       0.000462230173

      target function =                  N/A
              le_mean =     -16.905748987039
             les_mean =     286.137537175698
             stat err =       0.000453415463
             autocorr =       1.276413916116
              std dev =       0.567564938851
             le_variance =       0.322129959812

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322230877249
                                         uncertainty =       0.002213399624

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322230877249
                                         uncertainty =       0.002213399624

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401360253
  error estimate for blocks of size 2^( 2) =       0.000414465044
  error estimate for blocks of size 2^( 3) =       0.000428019518
  error estimate for blocks of size 2^( 4) =       0.000440565061
  error estimate for blocks of size 2^( 5) =       0.000451573061
  error estimate for blocks of size 2^( 6) =       0.000459350224
  error estimate for blocks of size 2^( 7) =       0.000462257241

      target function =                  N/A
              le_mean =     -16.905744389997
             les_mean =     286.137425373804
             stat err =       0.000453436397
             autocorr =       1.276333098840
              std dev =       0.567609112624
             le_variance =       0.322180104734

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322220147837
                                         uncertainty =       0.002213933205

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322220147837
                                         uncertainty =       0.002213933205

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401353596
  error estimate for blocks of size 2^( 2) =       0.000414460143
  error estimate for blocks of size 2^( 3) =       0.000428012675
  error estimate for blocks of size 2^( 4) =       0.000440558212
  error estimate for blocks of size 2^( 5) =       0.000451571398
  error estimate for blocks of size 2^( 6) =       0.000459350296
  error estimate for blocks of size 2^( 7) =       0.000462251392

      target function =                  N/A
              le_mean =     -16.905745646406
             les_mean =     286.137400736588
             stat err =       0.000453432824
             autocorr =       1.276355323812
              std dev =       0.567599699151
             le_variance =       0.322169418477

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322185557478
                                         uncertainty =       0.002215252935

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322185557478
                                         uncertainty =       0.002215252935

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401332102
  error estimate for blocks of size 2^( 2) =       0.000414442208
  error estimate for blocks of size 2^( 3) =       0.000427993315
  error estimate for blocks of size 2^( 4) =       0.000440538858
  error estimate for blocks of size 2^( 5) =       0.000451558285
  error estimate for blocks of size 2^( 6) =       0.000459339785
  error estimate for blocks of size 2^( 7) =       0.000462232396

      target function =                  N/A
              le_mean =     -16.905748276515
             les_mean =     286.138603497172
             stat err =       0.000453417331
             autocorr =       1.276404809087
              std dev =       0.567569302229
             le_variance =       0.322134912832


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905748987039        initial  <--
     8.0779e-01     8.0779e+00             3.4929e-04       -16.905744389997
     3.2312e+00     3.2312e+01             1.0149e-04       -16.905745646406
     1.2925e+01     1.2925e+02             2.6448e-05       -16.905748276515

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.5603
  </log>
  <optVariables href="H2O.s089.opt.xml">
   uu_0                 3.130489e-01 1 1  ON 0
   uu_1                 1.454795e-01 1 1  ON 1
   uu_2                 4.343751e-02 1 1  ON 2
   uu_3                -1.971005e-02 1 1  ON 3
   uu_4                -6.659792e-02 1 1  ON 4
   uu_5                -1.030755e-01 1 1  ON 5
   uu_6                -1.323387e-01 1 1  ON 6
   uu_7                -1.480568e-01 1 1  ON 7
   uu_8                -1.414782e-01 1 1  ON 8
   uu_9                -1.140218e-01 1 1  ON 9
   ud_0                 4.517917e-01 1 1  ON 10
   ud_1                 1.858076e-01 1 1  ON 11
   ud_2                 6.522749e-02 1 1  ON 12
   ud_3                -6.206470e-03 1 1  ON 13
   ud_4                -6.374066e-02 1 1  ON 14
   ud_5                -1.062129e-01 1 1  ON 15
   ud_6                -1.350631e-01 1 1  ON 16
   ud_7                -1.528907e-01 1 1  ON 17
   ud_8                -1.548377e-01 1 1  ON 18
   ud_9                -1.457823e-01 1 1  ON 19
   eO_0                -7.484535e-01 1 1  ON 20
   eO_1                -4.275578e-01 1 1  ON 21
   eO_2                -1.612044e-02 1 1  ON 22
   eO_3                 2.979494e-01 1 1  ON 23
   eO_4                 5.260782e-01 1 1  ON 24
   eO_5                 4.904036e-01 1 1  ON 25
   eO_6                 2.635878e-01 1 1  ON 26
   eO_7                -4.203475e-02 1 1  ON 27
   eO_8                -2.367671e-01 1 1  ON 28
   eO_9                -1.030004e-01 1 1  ON 29
  eH1_0                -2.661577e-01 1 1  ON 30
  eH1_1                -1.583973e-01 1 1  ON 31
  eH1_2                -1.081558e-01 1 1  ON 32
  eH1_3                -5.249658e-02 1 1  ON 33
  eH1_4                -1.732832e-03 1 1  ON 34
  eH1_5                 3.464629e-02 1 1  ON 35
  eH1_6                 9.768819e-02 1 1  ON 36
  eH1_7                 1.597409e-01 1 1  ON 37
  eH1_8                 1.973789e-01 1 1  ON 38
  eH1_9                 9.634380e-02 1 1  ON 39
  eH2_0                -2.644579e-01 1 1  ON 40
  eH2_1                -1.567131e-01 1 1  ON 41
  eH2_2                -1.066039e-01 1 1  ON 42
  eH2_3                -5.090253e-02 1 1  ON 43
  eH2_4                -1.517410e-04 1 1  ON 44
  eH2_5                 3.711633e-02 1 1  ON 45
  eH2_6                 9.950389e-02 1 1  ON 46
  eH2_7                 1.614106e-01 1 1  ON 47
  eH2_8                 2.014520e-01 1 1  ON 48
  eH2_9                 9.008612e-02 1 1  ON 49
ci_0001                 7.013990e-01 3 1  ON 50
ci_0002                 7.007792e-01 3 1  ON 51
ci_0003                -2.735975e-02 3 1  ON 52
ci_0004                -2.679436e-02 3 1  ON 53
ci_0005                -3.610920e-02 3 1  ON 54
ci_0006                -3.620914e-02 3 1  ON 55
ci_0007                -2.128329e-02 3 1  ON 56
ci_0008                -2.151097e-02 3 1  ON 57
ci_0009                -1.741253e-02 3 1  ON 58
ci_0010                -1.711131e-02 3 1  ON 59
ci_0011                -1.228385e-02 3 1  ON 60
ci_0012                -1.208501e-02 3 1  ON 61
ci_0013                 1.355051e-02 3 1  ON 62
ci_0014                 1.316172e-02 3 1  ON 63
ci_0015                 1.319395e-02 3 1  ON 64
ci_0016                 1.294776e-02 3 1  ON 65
ci_0017                 1.128750e-02 3 1  ON 66
ci_0018                 1.128948e-02 3 1  ON 67
ci_0019                 1.146805e-02 3 1  ON 68
ci_0020                 1.147893e-02 3 1  ON 69
ci_0021                -1.887289e-03 3 1  ON 70
ci_0022                -7.695915e-04 3 1  ON 71
ci_0023                -1.150282e-02 3 1  ON 72
ci_0024                -1.127516e-02 3 1  ON 73
ci_0025                -1.064897e-02 3 1  ON 74
ci_0026                -1.044259e-02 3 1  ON 75
ci_0027                -1.129535e-02 3 1  ON 76
ci_0028                -1.116833e-02 3 1  ON 77
ci_0029                -1.064655e-02 3 1  ON 78
ci_0030                -1.091489e-02 3 1  ON 79
ci_0031                 2.059818e-02 3 1  ON 80
ci_0032                 2.091145e-02 3 1  ON 81
ci_0033                 9.720625e-03 3 1  ON 82
ci_0034                 1.032010e-02 3 1  ON 83
ci_0035                 6.825370e-03 3 1  ON 84
ci_0036                 6.618260e-03 3 1  ON 85
ci_0037                -1.060697e-02 3 1  ON 86
ci_0038                -1.090710e-02 3 1  ON 87
ci_0039                -2.403165e-03 3 1  ON 88
ci_0040                -2.640560e-03 3 1  ON 89
ci_0041                 7.283395e-03 3 1  ON 90
ci_0042                 6.937109e-03 3 1  ON 91
ci_0043                -1.876222e-02 3 1  ON 92
ci_0044                -1.903486e-02 3 1  ON 93
ci_0045                 7.657011e-03 3 1  ON 94
ci_0046                 7.317203e-03 3 1  ON 95
ci_0047                -1.584487e-03 3 1  ON 96
ci_0048                -1.835263e-03 3 1  ON 97
ci_0049                -5.706309e-03 3 1  ON 98
ci_0050                -5.633148e-03 3 1  ON 99
ci_0051                -3.360725e-03 3 1  ON 100
ci_0052                -3.233139e-03 3 1  ON 101
ci_0053                -4.617481e-03 3 1  ON 102
ci_0054                -4.846939e-03 3 1  ON 103
ci_0055                 6.446470e-03 3 1  ON 104
ci_0056                 6.934480e-03 3 1  ON 105
ci_0057                 5.076578e-03 3 1  ON 106
ci_0058                 4.592851e-03 3 1  ON 107
ci_0059                -4.950287e-03 3 1  ON 108
ci_0060                -4.668984e-03 3 1  ON 109
ci_0061                -3.519071e-03 3 1  ON 110
ci_0062                -3.276025e-03 3 1  ON 111
ci_0063                -8.449743e-03 3 1  ON 112
ci_0064                -8.526079e-03 3 1  ON 113
ci_0065                -5.559798e-03 3 1  ON 114
ci_0066                -5.375897e-03 3 1  ON 115
ci_0067                -4.782444e-03 3 1  ON 116
ci_0068                -5.177186e-03 3 1  ON 117
ci_0069                 4.151287e-03 3 1  ON 118
ci_0070                 4.148604e-03 3 1  ON 119
ci_0071                -5.018932e-05 3 1  ON 120
ci_0072                 2.800348e-05 3 1  ON 121
ci_0073                 4.252104e-03 3 1  ON 122
ci_0074                 4.111456e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7986e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s090 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s090 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=90  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 90
    time step          = 0.05
    reference energy   = -16.893
    reference variance = 0.181
====================================================
  Execution time = 2.1313e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s090
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5280e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3888e-01
  Total weights = 1.951860742e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0380e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324989128193
                                         uncertainty =       0.001977328482

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324989128193
                                         uncertainty =       0.001977328482

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403037542
  error estimate for blocks of size 2^( 2) =       0.000415848892
  error estimate for blocks of size 2^( 3) =       0.000428643210
  error estimate for blocks of size 2^( 4) =       0.000441539347
  error estimate for blocks of size 2^( 5) =       0.000453058909
  error estimate for blocks of size 2^( 6) =       0.000462518616
  error estimate for blocks of size 2^( 7) =       0.000467925139

      target function =                  N/A
              le_mean =     -16.906275494506
             les_mean =     286.161035001170
             stat err =       0.000456260503
             autocorr =       1.281547613760
              std dev =       0.569981157941
             le_variance =       0.324878520408


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690627549451e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.0779e+00, overlap shift 8.0779e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906275494486       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906275872475       residual = 6.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906275859766       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906275810361       residual = 7.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906275725774       residual = 7.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906275701304       residual = 3.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906275674541       residual = 8.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906275665738       residual = 4.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906275668697       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906275678990       residual = 4.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 8.0779e+00 is 4.008654e-05

solving harmonic davidson linear method for identity shift 3.2312e+01, overlap shift 3.2312e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906275494486       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906275590968       residual = 6.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906275587472       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906275574224       residual = 7.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906275552213       residual = 7.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906275545193       residual = 3.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906275538481       residual = 8.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906275536209       residual = 4.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906275536670       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906275539127       residual = 4.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.2312e+01 is 1.011463e-05

solving harmonic davidson linear method for identity shift 1.2925e+02, overlap shift 1.2925e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906275494486       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906275518734       residual = 6.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906275517839       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906275514468       residual = 7.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906275508911       residual = 7.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906275507095       residual = 3.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906275505411       residual = 8.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906275504841       residual = 4.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906275504937       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906275505542       residual = 4.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.2925e+02 is 2.534542e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.713349 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7367e+01
  </log>
  <optVariables href="H2O.s090.opt.xml">
   uu_0                 3.130535e-01 1 1  ON 0
   uu_1                 1.454788e-01 1 1  ON 1
   uu_2                 4.343806e-02 1 1  ON 2
   uu_3                -1.971267e-02 1 1  ON 3
   uu_4                -6.659600e-02 1 1  ON 4
   uu_5                -1.030735e-01 1 1  ON 5
   uu_6                -1.323390e-01 1 1  ON 6
   uu_7                -1.480597e-01 1 1  ON 7
   uu_8                -1.414825e-01 1 1  ON 8
   uu_9                -1.140235e-01 1 1  ON 9
   ud_0                 4.517936e-01 1 1  ON 10
   ud_1                 1.858143e-01 1 1  ON 11
   ud_2                 6.522508e-02 1 1  ON 12
   ud_3                -6.206949e-03 1 1  ON 13
   ud_4                -6.373989e-02 1 1  ON 14
   ud_5                -1.062128e-01 1 1  ON 15
   ud_6                -1.350632e-01 1 1  ON 16
   ud_7                -1.528897e-01 1 1  ON 17
   ud_8                -1.548378e-01 1 1  ON 18
   ud_9                -1.457846e-01 1 1  ON 19
   eO_0                -7.484527e-01 1 1  ON 20
   eO_1                -4.275574e-01 1 1  ON 21
   eO_2                -1.611359e-02 1 1  ON 22
   eO_3                 2.979508e-01 1 1  ON 23
   eO_4                 5.260775e-01 1 1  ON 24
   eO_5                 4.904044e-01 1 1  ON 25
   eO_6                 2.635871e-01 1 1  ON 26
   eO_7                -4.203559e-02 1 1  ON 27
   eO_8                -2.367699e-01 1 1  ON 28
   eO_9                -1.030047e-01 1 1  ON 29
  eH1_0                -2.661600e-01 1 1  ON 30
  eH1_1                -1.583997e-01 1 1  ON 31
  eH1_2                -1.081541e-01 1 1  ON 32
  eH1_3                -5.249760e-02 1 1  ON 33
  eH1_4                -1.735835e-03 1 1  ON 34
  eH1_5                 3.464588e-02 1 1  ON 35
  eH1_6                 9.768827e-02 1 1  ON 36
  eH1_7                 1.597416e-01 1 1  ON 37
  eH1_8                 1.973802e-01 1 1  ON 38
  eH1_9                 9.634825e-02 1 1  ON 39
  eH2_0                -2.644593e-01 1 1  ON 40
  eH2_1                -1.567159e-01 1 1  ON 41
  eH2_2                -1.066057e-01 1 1  ON 42
  eH2_3                -5.090091e-02 1 1  ON 43
  eH2_4                -1.547826e-04 1 1  ON 44
  eH2_5                 3.711523e-02 1 1  ON 45
  eH2_6                 9.950347e-02 1 1  ON 46
  eH2_7                 1.614117e-01 1 1  ON 47
  eH2_8                 2.014535e-01 1 1  ON 48
  eH2_9                 9.009163e-02 1 1  ON 49
ci_0001                 7.013989e-01 3 1  ON 50
ci_0002                 7.007798e-01 3 1  ON 51
ci_0003                -2.736145e-02 3 1  ON 52
ci_0004                -2.679990e-02 3 1  ON 53
ci_0005                -3.610819e-02 3 1  ON 54
ci_0006                -3.620656e-02 3 1  ON 55
ci_0007                -2.128693e-02 3 1  ON 56
ci_0008                -2.150768e-02 3 1  ON 57
ci_0009                -1.741068e-02 3 1  ON 58
ci_0010                -1.710649e-02 3 1  ON 59
ci_0011                -1.227716e-02 3 1  ON 60
ci_0012                -1.208557e-02 3 1  ON 61
ci_0013                 1.354640e-02 3 1  ON 62
ci_0014                 1.315901e-02 3 1  ON 63
ci_0015                 1.319034e-02 3 1  ON 64
ci_0016                 1.293932e-02 3 1  ON 65
ci_0017                 1.128921e-02 3 1  ON 66
ci_0018                 1.128479e-02 3 1  ON 67
ci_0019                 1.146626e-02 3 1  ON 68
ci_0020                 1.148046e-02 3 1  ON 69
ci_0021                -1.890206e-03 3 1  ON 70
ci_0022                -7.735585e-04 3 1  ON 71
ci_0023                -1.150003e-02 3 1  ON 72
ci_0024                -1.126918e-02 3 1  ON 73
ci_0025                -1.064733e-02 3 1  ON 74
ci_0026                -1.044200e-02 3 1  ON 75
ci_0027                -1.130088e-02 3 1  ON 76
ci_0028                -1.116585e-02 3 1  ON 77
ci_0029                -1.064276e-02 3 1  ON 78
ci_0030                -1.091518e-02 3 1  ON 79
ci_0031                 2.059548e-02 3 1  ON 80
ci_0032                 2.091204e-02 3 1  ON 81
ci_0033                 9.721491e-03 3 1  ON 82
ci_0034                 1.033021e-02 3 1  ON 83
ci_0035                 6.827467e-03 3 1  ON 84
ci_0036                 6.619760e-03 3 1  ON 85
ci_0037                -1.060423e-02 3 1  ON 86
ci_0038                -1.090606e-02 3 1  ON 87
ci_0039                -2.407125e-03 3 1  ON 88
ci_0040                -2.645253e-03 3 1  ON 89
ci_0041                 7.287809e-03 3 1  ON 90
ci_0042                 6.938312e-03 3 1  ON 91
ci_0043                -1.876322e-02 3 1  ON 92
ci_0044                -1.903553e-02 3 1  ON 93
ci_0045                 7.648299e-03 3 1  ON 94
ci_0046                 7.316982e-03 3 1  ON 95
ci_0047                -1.583786e-03 3 1  ON 96
ci_0048                -1.834355e-03 3 1  ON 97
ci_0049                -5.705619e-03 3 1  ON 98
ci_0050                -5.635435e-03 3 1  ON 99
ci_0051                -3.360872e-03 3 1  ON 100
ci_0052                -3.236066e-03 3 1  ON 101
ci_0053                -4.620289e-03 3 1  ON 102
ci_0054                -4.847906e-03 3 1  ON 103
ci_0055                 6.451508e-03 3 1  ON 104
ci_0056                 6.929474e-03 3 1  ON 105
ci_0057                 5.070885e-03 3 1  ON 106
ci_0058                 4.594145e-03 3 1  ON 107
ci_0059                -4.946242e-03 3 1  ON 108
ci_0060                -4.673407e-03 3 1  ON 109
ci_0061                -3.522901e-03 3 1  ON 110
ci_0062                -3.277601e-03 3 1  ON 111
ci_0063                -8.458954e-03 3 1  ON 112
ci_0064                -8.516713e-03 3 1  ON 113
ci_0065                -5.557074e-03 3 1  ON 114
ci_0066                -5.378756e-03 3 1  ON 115
ci_0067                -4.791665e-03 3 1  ON 116
ci_0068                -5.169967e-03 3 1  ON 117
ci_0069                 4.152902e-03 3 1  ON 118
ci_0070                 4.155943e-03 3 1  ON 119
ci_0071                -4.806504e-05 3 1  ON 120
ci_0072                 2.866712e-05 3 1  ON 121
ci_0073                 4.247608e-03 3 1  ON 122
ci_0074                 4.113211e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 90
    time step          = 0.05
    reference energy   = -16.8902
    reference variance = 0.306047
====================================================
  Execution time = 2.0984e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s090
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4018e-01
  Total weights = 1.9519e+06
  Execution time = 1.9131e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324927998124
                                         uncertainty =       0.003112031916

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324927998124
                                         uncertainty =       0.003112031916

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403111886
  error estimate for blocks of size 2^( 2) =       0.000415943541
  error estimate for blocks of size 2^( 3) =       0.000429188204
  error estimate for blocks of size 2^( 4) =       0.000441435994
  error estimate for blocks of size 2^( 5) =       0.000453043597
  error estimate for blocks of size 2^( 6) =       0.000463772288
  error estimate for blocks of size 2^( 7) =       0.000471461453

      target function =                  N/A
              le_mean =     -16.904867352262
             les_mean =     286.114694518787
             stat err =       0.000457428333
             autocorr =       1.287641351563
              std dev =       0.570086295963
             le_variance =       0.324998384844

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324943760791
                                         uncertainty =       0.003108967074

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324943760791
                                         uncertainty =       0.003108967074

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403121648
  error estimate for blocks of size 2^( 2) =       0.000415952626
  error estimate for blocks of size 2^( 3) =       0.000429196848
  error estimate for blocks of size 2^( 4) =       0.000441444191
  error estimate for blocks of size 2^( 5) =       0.000453051048
  error estimate for blocks of size 2^( 6) =       0.000463779956
  error estimate for blocks of size 2^( 7) =       0.000471465993

      target function =                  N/A
              le_mean =     -16.904867574266
             les_mean =     286.114821673452
             stat err =       0.000457435297
             autocorr =       1.287618192600
              std dev =       0.570100101565
             le_variance =       0.325014125804

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324935651305
                                         uncertainty =       0.003110458324

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324935651305
                                         uncertainty =       0.003110458324

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403116625
  error estimate for blocks of size 2^( 2) =       0.000415947973
  error estimate for blocks of size 2^( 3) =       0.000429192405
  error estimate for blocks of size 2^( 4) =       0.000441439945
  error estimate for blocks of size 2^( 5) =       0.000453047241
  error estimate for blocks of size 2^( 6) =       0.000463776116
  error estimate for blocks of size 2^( 7) =       0.000471463802

      target function =                  N/A
              le_mean =     -16.904867434961
             les_mean =     286.114744893450
             stat err =       0.000457431776
             autocorr =       1.287630459445
              std dev =       0.570092998129
             le_variance =       0.325006026516

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324928934585
                                         uncertainty =       0.003111833167

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324928934585
                                         uncertainty =       0.003111833167

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403112466
  error estimate for blocks of size 2^( 2) =       0.000415944085
  error estimate for blocks of size 2^( 3) =       0.000429188719
  error estimate for blocks of size 2^( 4) =       0.000441436475
  error estimate for blocks of size 2^( 5) =       0.000453044047
  error estimate for blocks of size 2^( 6) =       0.000463772767
  error estimate for blocks of size 2^( 7) =       0.000471461756

      target function =                  N/A
              le_mean =     -16.904867359643
             les_mean =     286.114699577185
             stat err =       0.000457428761
             autocorr =       1.287640057990
              std dev =       0.570087116014
             le_variance =       0.324999319846


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904867352262        initial
     8.0779e+00     8.0779e+01             4.0087e-05       -16.904867574266  <--
     3.2312e+01     3.2312e+02             1.0115e-05       -16.904867434961
     1.2925e+02     1.2925e+03             2.5345e-06       -16.904867359643

*****************************************************************************
Applying the update for shift_i =   8.0779e+00     and shift_s =   8.0779e+01
*****************************************************************************

  Execution time = 3.0621e+01
  </log>
  <optVariables href="H2O.s090.opt.xml">
   uu_0                 3.130669e-01 1 1  ON 0
   uu_1                 1.454768e-01 1 1  ON 1
   uu_2                 4.343958e-02 1 1  ON 2
   uu_3                -1.972010e-02 1 1  ON 3
   uu_4                -6.659050e-02 1 1  ON 4
   uu_5                -1.030676e-01 1 1  ON 5
   uu_6                -1.323396e-01 1 1  ON 6
   uu_7                -1.480683e-01 1 1  ON 7
   uu_8                -1.414956e-01 1 1  ON 8
   uu_9                -1.140288e-01 1 1  ON 9
   ud_0                 4.517997e-01 1 1  ON 10
   ud_1                 1.858331e-01 1 1  ON 11
   ud_2                 6.521854e-02 1 1  ON 12
   ud_3                -6.208549e-03 1 1  ON 13
   ud_4                -6.373754e-02 1 1  ON 14
   ud_5                -1.062122e-01 1 1  ON 15
   ud_6                -1.350634e-01 1 1  ON 16
   ud_7                -1.528866e-01 1 1  ON 17
   ud_8                -1.548384e-01 1 1  ON 18
   ud_9                -1.457914e-01 1 1  ON 19
   eO_0                -7.484505e-01 1 1  ON 20
   eO_1                -4.275558e-01 1 1  ON 21
   eO_2                -1.609358e-02 1 1  ON 22
   eO_3                 2.979550e-01 1 1  ON 23
   eO_4                 5.260754e-01 1 1  ON 24
   eO_5                 4.904071e-01 1 1  ON 25
   eO_6                 2.635851e-01 1 1  ON 26
   eO_7                -4.203810e-02 1 1  ON 27
   eO_8                -2.367785e-01 1 1  ON 28
   eO_9                -1.030176e-01 1 1  ON 29
  eH1_0                -2.661669e-01 1 1  ON 30
  eH1_1                -1.584067e-01 1 1  ON 31
  eH1_2                -1.081491e-01 1 1  ON 32
  eH1_3                -5.250062e-02 1 1  ON 33
  eH1_4                -1.744805e-03 1 1  ON 34
  eH1_5                 3.464464e-02 1 1  ON 35
  eH1_6                 9.768853e-02 1 1  ON 36
  eH1_7                 1.597436e-01 1 1  ON 37
  eH1_8                 1.973841e-01 1 1  ON 38
  eH1_9                 9.636158e-02 1 1  ON 39
  eH2_0                -2.644637e-01 1 1  ON 40
  eH2_1                -1.567243e-01 1 1  ON 41
  eH2_2                -1.066111e-01 1 1  ON 42
  eH2_3                -5.089631e-02 1 1  ON 43
  eH2_4                -1.637787e-04 1 1  ON 44
  eH2_5                 3.711194e-02 1 1  ON 45
  eH2_6                 9.950221e-02 1 1  ON 46
  eH2_7                 1.614149e-01 1 1  ON 47
  eH2_8                 2.014580e-01 1 1  ON 48
  eH2_9                 9.010814e-02 1 1  ON 49
ci_0001                 7.013986e-01 3 1  ON 50
ci_0002                 7.007818e-01 3 1  ON 51
ci_0003                -2.736643e-02 3 1  ON 52
ci_0004                -2.681621e-02 3 1  ON 53
ci_0005                -3.610515e-02 3 1  ON 54
ci_0006                -3.619892e-02 3 1  ON 55
ci_0007                -2.129773e-02 3 1  ON 56
ci_0008                -2.149794e-02 3 1  ON 57
ci_0009                -1.740529e-02 3 1  ON 58
ci_0010                -1.709247e-02 3 1  ON 59
ci_0011                -1.225761e-02 3 1  ON 60
ci_0012                -1.208724e-02 3 1  ON 61
ci_0013                 1.353436e-02 3 1  ON 62
ci_0014                 1.315115e-02 3 1  ON 63
ci_0015                 1.317979e-02 3 1  ON 64
ci_0016                 1.291468e-02 3 1  ON 65
ci_0017                 1.129423e-02 3 1  ON 66
ci_0018                 1.127116e-02 3 1  ON 67
ci_0019                 1.146100e-02 3 1  ON 68
ci_0020                 1.148502e-02 3 1  ON 69
ci_0021                -1.898850e-03 3 1  ON 70
ci_0022                -7.852882e-04 3 1  ON 71
ci_0023                -1.149188e-02 3 1  ON 72
ci_0024                -1.125179e-02 3 1  ON 73
ci_0025                -1.064252e-02 3 1  ON 74
ci_0026                -1.044031e-02 3 1  ON 75
ci_0027                -1.131705e-02 3 1  ON 76
ci_0028                -1.115863e-02 3 1  ON 77
ci_0029                -1.063172e-02 3 1  ON 78
ci_0030                -1.091604e-02 3 1  ON 79
ci_0031                 2.058751e-02 3 1  ON 80
ci_0032                 2.091375e-02 3 1  ON 81
ci_0033                 9.724022e-03 3 1  ON 82
ci_0034                 1.036019e-02 3 1  ON 83
ci_0035                 6.833627e-03 3 1  ON 84
ci_0036                 6.624125e-03 3 1  ON 85
ci_0037                -1.059614e-02 3 1  ON 86
ci_0038                -1.090303e-02 3 1  ON 87
ci_0039                -2.418470e-03 3 1  ON 88
ci_0040                -2.658697e-03 3 1  ON 89
ci_0041                 7.300721e-03 3 1  ON 90
ci_0042                 6.941808e-03 3 1  ON 91
ci_0043                -1.876615e-02 3 1  ON 92
ci_0044                -1.903747e-02 3 1  ON 93
ci_0045                 7.622648e-03 3 1  ON 94
ci_0046                 7.316314e-03 3 1  ON 95
ci_0047                -1.581759e-03 3 1  ON 96
ci_0048                -1.831714e-03 3 1  ON 97
ci_0049                -5.703609e-03 3 1  ON 98
ci_0050                -5.642122e-03 3 1  ON 99
ci_0051                -3.361282e-03 3 1  ON 100
ci_0052                -3.244505e-03 3 1  ON 101
ci_0053                -4.628393e-03 3 1  ON 102
ci_0054                -4.850707e-03 3 1  ON 103
ci_0055                 6.466338e-03 3 1  ON 104
ci_0056                 6.914753e-03 3 1  ON 105
ci_0057                 5.054182e-03 3 1  ON 106
ci_0058                 4.597954e-03 3 1  ON 107
ci_0059                -4.934595e-03 3 1  ON 108
ci_0060                -4.686176e-03 3 1  ON 109
ci_0061                -3.534129e-03 3 1  ON 110
ci_0062                -3.282201e-03 3 1  ON 111
ci_0063                -8.485618e-03 3 1  ON 112
ci_0064                -8.489577e-03 3 1  ON 113
ci_0065                -5.549153e-03 3 1  ON 114
ci_0066                -5.387077e-03 3 1  ON 115
ci_0067                -4.818264e-03 3 1  ON 116
ci_0068                -5.149163e-03 3 1  ON 117
ci_0069                 4.157520e-03 3 1  ON 118
ci_0070                 4.177154e-03 3 1  ON 119
ci_0071                -4.174817e-05 3 1  ON 120
ci_0072                 3.060729e-05 3 1  ON 121
ci_0073                 4.234657e-03 3 1  ON 122
ci_0074                 4.118259e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8003e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s091 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s091 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=91  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 91
    time step          = 0.05
    reference energy   = -16.99
    reference variance = 0.31972
====================================================
  Execution time = 2.1358e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s091
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5233e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3949e-01
  Total weights = 1.951740759e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1335e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324641481665
                                         uncertainty =       0.002127118886

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324641481665
                                         uncertainty =       0.002127118886

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402848202
  error estimate for blocks of size 2^( 2) =       0.000415704619
  error estimate for blocks of size 2^( 3) =       0.000429354726
  error estimate for blocks of size 2^( 4) =       0.000441751764
  error estimate for blocks of size 2^( 5) =       0.000453100316
  error estimate for blocks of size 2^( 6) =       0.000461985604
  error estimate for blocks of size 2^( 7) =       0.000467929656

      target function =                  N/A
              le_mean =     -16.906137948180
             les_mean =     286.156987765279
             stat err =       0.000456191835
             autocorr =       1.282366473810
              std dev =       0.569713391349
             le_variance =       0.324573348282


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690613794818e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.0195e+00, overlap shift 2.0195e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906137948185       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906138164207       residual = 6.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906138012975       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906138105197       residual = 8.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906138020694       residual = 6.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906138061208       residual = 5.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906137982729       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906137905979       residual = 6.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906137898484       residual = 2.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906137916671       residual = 5.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.0195e+00 is 2.049077e-04

solving harmonic davidson linear method for identity shift 8.0779e+00, overlap shift 8.0779e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906137948185       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906138006149       residual = 7.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906137966973       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906137989527       residual = 9.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906137999286       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906137972712       residual = 3.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906137971533       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906137946691       residual = 5.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906137940164       residual = 2.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906137944920       residual = 4.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 8.0779e+00 is 5.491827e-05

solving harmonic davidson linear method for identity shift 3.2312e+01, overlap shift 3.2312e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906137948185       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906137962946       residual = 7.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906137953056       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906137958651       residual = 9.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906137962252       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906137954913       residual = 3.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906137955041       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906137948597       residual = 5.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906137946631       residual = 2.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906137947791       residual = 4.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.2312e+01 is 1.397996e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.717269 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7499e+01
  </log>
  <optVariables href="H2O.s091.opt.xml">
   uu_0                 3.130931e-01 1 1  ON 0
   uu_1                 1.455003e-01 1 1  ON 1
   uu_2                 4.343925e-02 1 1  ON 2
   uu_3                -1.973618e-02 1 1  ON 3
   uu_4                -6.660082e-02 1 1  ON 4
   uu_5                -1.030745e-01 1 1  ON 5
   uu_6                -1.323466e-01 1 1  ON 6
   uu_7                -1.480734e-01 1 1  ON 7
   uu_8                -1.415104e-01 1 1  ON 8
   uu_9                -1.140343e-01 1 1  ON 9
   ud_0                 4.517820e-01 1 1  ON 10
   ud_1                 1.858180e-01 1 1  ON 11
   ud_2                 6.521086e-02 1 1  ON 12
   ud_3                -6.204421e-03 1 1  ON 13
   ud_4                -6.372322e-02 1 1  ON 14
   ud_5                -1.062006e-01 1 1  ON 15
   ud_6                -1.350581e-01 1 1  ON 16
   ud_7                -1.528676e-01 1 1  ON 17
   ud_8                -1.548348e-01 1 1  ON 18
   ud_9                -1.457947e-01 1 1  ON 19
   eO_0                -7.484470e-01 1 1  ON 20
   eO_1                -4.275387e-01 1 1  ON 21
   eO_2                -1.609209e-02 1 1  ON 22
   eO_3                 2.979567e-01 1 1  ON 23
   eO_4                 5.260754e-01 1 1  ON 24
   eO_5                 4.904069e-01 1 1  ON 25
   eO_6                 2.635887e-01 1 1  ON 26
   eO_7                -4.203377e-02 1 1  ON 27
   eO_8                -2.367904e-01 1 1  ON 28
   eO_9                -1.030335e-01 1 1  ON 29
  eH1_0                -2.661684e-01 1 1  ON 30
  eH1_1                -1.584292e-01 1 1  ON 31
  eH1_2                -1.081537e-01 1 1  ON 32
  eH1_3                -5.249893e-02 1 1  ON 33
  eH1_4                -1.752924e-03 1 1  ON 34
  eH1_5                 3.463972e-02 1 1  ON 35
  eH1_6                 9.768197e-02 1 1  ON 36
  eH1_7                 1.597546e-01 1 1  ON 37
  eH1_8                 1.973956e-01 1 1  ON 38
  eH1_9                 9.638128e-02 1 1  ON 39
  eH2_0                -2.644711e-01 1 1  ON 40
  eH2_1                -1.567275e-01 1 1  ON 41
  eH2_2                -1.066119e-01 1 1  ON 42
  eH2_3                -5.089470e-02 1 1  ON 43
  eH2_4                -1.640530e-04 1 1  ON 44
  eH2_5                 3.709303e-02 1 1  ON 45
  eH2_6                 9.948839e-02 1 1  ON 46
  eH2_7                 1.614166e-01 1 1  ON 47
  eH2_8                 2.014680e-01 1 1  ON 48
  eH2_9                 9.013460e-02 1 1  ON 49
ci_0001                 7.013953e-01 3 1  ON 50
ci_0002                 7.007798e-01 3 1  ON 51
ci_0003                -2.740768e-02 3 1  ON 52
ci_0004                -2.684840e-02 3 1  ON 53
ci_0005                -3.613441e-02 3 1  ON 54
ci_0006                -3.622378e-02 3 1  ON 55
ci_0007                -2.131198e-02 3 1  ON 56
ci_0008                -2.148642e-02 3 1  ON 57
ci_0009                -1.745239e-02 3 1  ON 58
ci_0010                -1.710673e-02 3 1  ON 59
ci_0011                -1.226644e-02 3 1  ON 60
ci_0012                -1.206147e-02 3 1  ON 61
ci_0013                 1.350295e-02 3 1  ON 62
ci_0014                 1.314529e-02 3 1  ON 63
ci_0015                 1.317193e-02 3 1  ON 64
ci_0016                 1.294105e-02 3 1  ON 65
ci_0017                 1.128901e-02 3 1  ON 66
ci_0018                 1.125426e-02 3 1  ON 67
ci_0019                 1.144441e-02 3 1  ON 68
ci_0020                 1.146755e-02 3 1  ON 69
ci_0021                -1.868441e-03 3 1  ON 70
ci_0022                -7.894123e-04 3 1  ON 71
ci_0023                -1.147867e-02 3 1  ON 72
ci_0024                -1.121264e-02 3 1  ON 73
ci_0025                -1.066087e-02 3 1  ON 74
ci_0026                -1.046444e-02 3 1  ON 75
ci_0027                -1.131172e-02 3 1  ON 76
ci_0028                -1.115422e-02 3 1  ON 77
ci_0029                -1.064334e-02 3 1  ON 78
ci_0030                -1.091030e-02 3 1  ON 79
ci_0031                 2.059256e-02 3 1  ON 80
ci_0032                 2.090435e-02 3 1  ON 81
ci_0033                 9.738583e-03 3 1  ON 82
ci_0034                 1.036700e-02 3 1  ON 83
ci_0035                 6.778708e-03 3 1  ON 84
ci_0036                 6.633771e-03 3 1  ON 85
ci_0037                -1.062207e-02 3 1  ON 86
ci_0038                -1.089099e-02 3 1  ON 87
ci_0039                -2.425091e-03 3 1  ON 88
ci_0040                -2.655573e-03 3 1  ON 89
ci_0041                 7.309557e-03 3 1  ON 90
ci_0042                 6.964329e-03 3 1  ON 91
ci_0043                -1.877084e-02 3 1  ON 92
ci_0044                -1.903865e-02 3 1  ON 93
ci_0045                 7.627424e-03 3 1  ON 94
ci_0046                 7.317273e-03 3 1  ON 95
ci_0047                -1.585748e-03 3 1  ON 96
ci_0048                -1.858045e-03 3 1  ON 97
ci_0049                -5.695007e-03 3 1  ON 98
ci_0050                -5.642437e-03 3 1  ON 99
ci_0051                -3.364469e-03 3 1  ON 100
ci_0052                -3.258124e-03 3 1  ON 101
ci_0053                -4.623387e-03 3 1  ON 102
ci_0054                -4.832774e-03 3 1  ON 103
ci_0055                 6.470395e-03 3 1  ON 104
ci_0056                 6.887782e-03 3 1  ON 105
ci_0057                 5.052599e-03 3 1  ON 106
ci_0058                 4.584072e-03 3 1  ON 107
ci_0059                -4.917335e-03 3 1  ON 108
ci_0060                -4.692976e-03 3 1  ON 109
ci_0061                -3.531465e-03 3 1  ON 110
ci_0062                -3.279545e-03 3 1  ON 111
ci_0063                -8.510872e-03 3 1  ON 112
ci_0064                -8.494732e-03 3 1  ON 113
ci_0065                -5.535752e-03 3 1  ON 114
ci_0066                -5.379678e-03 3 1  ON 115
ci_0067                -4.806214e-03 3 1  ON 116
ci_0068                -5.120057e-03 3 1  ON 117
ci_0069                 4.156309e-03 3 1  ON 118
ci_0070                 4.180394e-03 3 1  ON 119
ci_0071                -8.895154e-05 3 1  ON 120
ci_0072                 4.697179e-05 3 1  ON 121
ci_0073                 4.252788e-03 3 1  ON 122
ci_0074                 4.107456e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 91
    time step          = 0.05
    reference energy   = -16.9371
    reference variance = 0.402081
====================================================
  Execution time = 2.1044e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s091
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3300e-01
  Total weights = 1.9517e+06
  Execution time = 1.9166e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321522414708
                                         uncertainty =       0.003043925751

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321522414708
                                         uncertainty =       0.003043925751

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401026020
  error estimate for blocks of size 2^( 2) =       0.000414041322
  error estimate for blocks of size 2^( 3) =       0.000426810406
  error estimate for blocks of size 2^( 4) =       0.000439049255
  error estimate for blocks of size 2^( 5) =       0.000450638562
  error estimate for blocks of size 2^( 6) =       0.000458524402
  error estimate for blocks of size 2^( 7) =       0.000466135069

      target function =                  N/A
              le_mean =     -16.905319766205
             les_mean =     286.122943906381
             stat err =       0.000453586822
             autocorr =       1.279309878346
              std dev =       0.567136435721
             le_variance =       0.321643736722

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321560982119
                                         uncertainty =       0.003034578496

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321560982119
                                         uncertainty =       0.003034578496

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401049999
  error estimate for blocks of size 2^( 2) =       0.000414063810
  error estimate for blocks of size 2^( 3) =       0.000426832726
  error estimate for blocks of size 2^( 4) =       0.000439070554
  error estimate for blocks of size 2^( 5) =       0.000450660462
  error estimate for blocks of size 2^( 6) =       0.000458546481
  error estimate for blocks of size 2^( 7) =       0.000466154430

      target function =                  N/A
              le_mean =     -16.905322381776
             les_mean =     286.124590873961
             stat err =       0.000453607982
             autocorr =       1.279276249913
              std dev =       0.567170347774
             le_variance =       0.321682203394

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321542761552
                                         uncertainty =       0.003038812665

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321542761552
                                         uncertainty =       0.003038812665

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401038674
  error estimate for blocks of size 2^( 2) =       0.000414053095
  error estimate for blocks of size 2^( 3) =       0.000426821942
  error estimate for blocks of size 2^( 4) =       0.000439060221
  error estimate for blocks of size 2^( 5) =       0.000450649792
  error estimate for blocks of size 2^( 6) =       0.000458535956
  error estimate for blocks of size 2^( 7) =       0.000466145142

      target function =                  N/A
              le_mean =     -16.905321093273
             les_mean =     286.123284630331
             stat err =       0.000453597778
             autocorr =       1.279290941952
              std dev =       0.567154332424
             le_variance =       0.321664036787

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321524843099
                                         uncertainty =       0.003043269595

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321524843099
                                         uncertainty =       0.003043269595

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401027530
  error estimate for blocks of size 2^( 2) =       0.000414042695
  error estimate for blocks of size 2^( 3) =       0.000426811751
  error estimate for blocks of size 2^( 4) =       0.000439050517
  error estimate for blocks of size 2^( 5) =       0.000450639801
  error estimate for blocks of size 2^( 6) =       0.000458525514
  error estimate for blocks of size 2^( 7) =       0.000466136018

      target function =                  N/A
              le_mean =     -16.905319942804
             les_mean =     286.122794618755
             stat err =       0.000453587963
             autocorr =       1.279306677351
              std dev =       0.567138571713
             le_variance =       0.321646159525


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905319766205        initial
     2.0195e+00     2.0195e+01             2.0491e-04       -16.905322381776  <--
     8.0779e+00     8.0779e+01             5.4918e-05       -16.905321093273
     3.2312e+01     3.2312e+02             1.3980e-05       -16.905319942804

*****************************************************************************
Applying the update for shift_i =   2.0195e+00     and shift_s =   2.0195e+01
*****************************************************************************

  Execution time = 3.0710e+01
  </log>
  <optVariables href="H2O.s091.opt.xml">
   uu_0                 3.131715e-01 1 1  ON 0
   uu_1                 1.455607e-01 1 1  ON 1
   uu_2                 4.343960e-02 1 1  ON 2
   uu_3                -1.977939e-02 1 1  ON 3
   uu_4                -6.663034e-02 1 1  ON 4
   uu_5                -1.030939e-01 1 1  ON 5
   uu_6                -1.323675e-01 1 1  ON 6
   uu_7                -1.480883e-01 1 1  ON 7
   uu_8                -1.415535e-01 1 1  ON 8
   uu_9                -1.140502e-01 1 1  ON 9
   ud_0                 4.517289e-01 1 1  ON 10
   ud_1                 1.857766e-01 1 1  ON 11
   ud_2                 6.518936e-02 1 1  ON 12
   ud_3                -6.192544e-03 1 1  ON 13
   ud_4                -6.368516e-02 1 1  ON 14
   ud_5                -1.061655e-01 1 1  ON 15
   ud_6                -1.350413e-01 1 1  ON 16
   ud_7                -1.528133e-01 1 1  ON 17
   ud_8                -1.548238e-01 1 1  ON 18
   ud_9                -1.458043e-01 1 1  ON 19
   eO_0                -7.484355e-01 1 1  ON 20
   eO_1                -4.274884e-01 1 1  ON 21
   eO_2                -1.608878e-02 1 1  ON 22
   eO_3                 2.979607e-01 1 1  ON 23
   eO_4                 5.260764e-01 1 1  ON 24
   eO_5                 4.904069e-01 1 1  ON 25
   eO_6                 2.635987e-01 1 1  ON 26
   eO_7                -4.202109e-02 1 1  ON 27
   eO_8                -2.368257e-01 1 1  ON 28
   eO_9                -1.030805e-01 1 1  ON 29
  eH1_0                -2.661747e-01 1 1  ON 30
  eH1_1                -1.584927e-01 1 1  ON 31
  eH1_2                -1.081677e-01 1 1  ON 32
  eH1_3                -5.249666e-02 1 1  ON 33
  eH1_4                -1.775523e-03 1 1  ON 34
  eH1_5                 3.462489e-02 1 1  ON 35
  eH1_6                 9.766287e-02 1 1  ON 36
  eH1_7                 1.597870e-01 1 1  ON 37
  eH1_8                 1.974297e-01 1 1  ON 38
  eH1_9                 9.643944e-02 1 1  ON 39
  eH2_0                -2.644926e-01 1 1  ON 40
  eH2_1                -1.567372e-01 1 1  ON 41
  eH2_2                -1.066135e-01 1 1  ON 42
  eH2_3                -5.089128e-02 1 1  ON 43
  eH2_4                -1.645342e-04 1 1  ON 44
  eH2_5                 3.703757e-02 1 1  ON 45
  eH2_6                 9.944726e-02 1 1  ON 46
  eH2_7                 1.614213e-01 1 1  ON 47
  eH2_8                 2.014975e-01 1 1  ON 48
  eH2_9                 9.021272e-02 1 1  ON 49
ci_0001                 7.013862e-01 3 1  ON 50
ci_0002                 7.007742e-01 3 1  ON 51
ci_0003                -2.752128e-02 3 1  ON 52
ci_0004                -2.693678e-02 3 1  ON 53
ci_0005                -3.621729e-02 3 1  ON 54
ci_0006                -3.629454e-02 3 1  ON 55
ci_0007                -2.135337e-02 3 1  ON 56
ci_0008                -2.145382e-02 3 1  ON 57
ci_0009                -1.757894e-02 3 1  ON 58
ci_0010                -1.714519e-02 3 1  ON 59
ci_0011                -1.229090e-02 3 1  ON 60
ci_0012                -1.199146e-02 3 1  ON 61
ci_0013                 1.341714e-02 3 1  ON 62
ci_0014                 1.312954e-02 3 1  ON 63
ci_0015                 1.315030e-02 3 1  ON 64
ci_0016                 1.301264e-02 3 1  ON 65
ci_0017                 1.127481e-02 3 1  ON 66
ci_0018                 1.120951e-02 3 1  ON 67
ci_0019                 1.139917e-02 3 1  ON 68
ci_0020                 1.142091e-02 3 1  ON 69
ci_0021                -1.780556e-03 3 1  ON 70
ci_0022                -8.012906e-04 3 1  ON 71
ci_0023                -1.144331e-02 3 1  ON 72
ci_0024                -1.110838e-02 3 1  ON 73
ci_0025                -1.071134e-02 3 1  ON 74
ci_0026                -1.053000e-02 3 1  ON 75
ci_0027                -1.129738e-02 3 1  ON 76
ci_0028                -1.114211e-02 3 1  ON 77
ci_0029                -1.067509e-02 3 1  ON 78
ci_0030                -1.089422e-02 3 1  ON 79
ci_0031                 2.060704e-02 3 1  ON 80
ci_0032                 2.087778e-02 3 1  ON 81
ci_0033                 9.780643e-03 3 1  ON 82
ci_0034                 1.038647e-02 3 1  ON 83
ci_0035                 6.628719e-03 3 1  ON 84
ci_0036                 6.660267e-03 3 1  ON 85
ci_0037                -1.069325e-02 3 1  ON 86
ci_0038                -1.085745e-02 3 1  ON 87
ci_0039                -2.442192e-03 3 1  ON 88
ci_0040                -2.647473e-03 3 1  ON 89
ci_0041                 7.333998e-03 3 1  ON 90
ci_0042                 7.025345e-03 3 1  ON 91
ci_0043                -1.878341e-02 3 1  ON 92
ci_0044                -1.904110e-02 3 1  ON 93
ci_0045                 7.640855e-03 3 1  ON 94
ci_0046                 7.320089e-03 3 1  ON 95
ci_0047                -1.595997e-03 3 1  ON 96
ci_0048                -1.925882e-03 3 1  ON 97
ci_0049                -5.672191e-03 3 1  ON 98
ci_0050                -5.643511e-03 3 1  ON 99
ci_0051                -3.372930e-03 3 1  ON 100
ci_0052                -3.293209e-03 3 1  ON 101
ci_0053                -4.609902e-03 3 1  ON 102
ci_0054                -4.786555e-03 3 1  ON 103
ci_0055                 6.481693e-03 3 1  ON 104
ci_0056                 6.812808e-03 3 1  ON 105
ci_0057                 5.048621e-03 3 1  ON 106
ci_0058                 4.546070e-03 3 1  ON 107
ci_0059                -4.872688e-03 3 1  ON 108
ci_0060                -4.711163e-03 3 1  ON 109
ci_0061                -3.524052e-03 3 1  ON 110
ci_0062                -3.272048e-03 3 1  ON 111
ci_0063                -8.576682e-03 3 1  ON 112
ci_0064                -8.508085e-03 3 1  ON 113
ci_0065                -5.499586e-03 3 1  ON 114
ci_0066                -5.359824e-03 3 1  ON 115
ci_0067                -4.774440e-03 3 1  ON 116
ci_0068                -5.045519e-03 3 1  ON 117
ci_0069                 4.152805e-03 3 1  ON 118
ci_0070                 4.189396e-03 3 1  ON 119
ci_0071                -2.181279e-04 3 1  ON 120
ci_0072                 8.955013e-05 3 1  ON 121
ci_0073                 4.299575e-03 3 1  ON 122
ci_0074                 4.079691e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8216e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s092 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s092 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=92  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 92
    time step          = 0.05
    reference energy   = -16.9261
    reference variance = 0.253329
====================================================
  Execution time = 2.2114e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s092
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5245e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3298e-01
  Total weights = 1.951639460e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.2893e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320034829250
                                         uncertainty =       0.002583900848

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320034829250
                                         uncertainty =       0.002583900848

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400026687
  error estimate for blocks of size 2^( 2) =       0.000412942632
  error estimate for blocks of size 2^( 3) =       0.000425877587
  error estimate for blocks of size 2^( 4) =       0.000437811587
  error estimate for blocks of size 2^( 5) =       0.000446847802
  error estimate for blocks of size 2^( 6) =       0.000453573906
  error estimate for blocks of size 2^( 7) =       0.000456608117

      target function =                  N/A
              le_mean =     -16.906531569946
             les_mean =     286.163788871030
             stat err =       0.000448710353
             autocorr =       1.258213234330
              std dev =       0.565723166113
             le_variance =       0.320042700677


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690653156995e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.0487e-01, overlap shift 5.0487e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906531569974       residual = 2.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906539743921       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906539093079       residual = 6.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906541138744       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906541694061       residual = 6.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906541874304       residual = 3.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906542167530       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906542198495       residual = 9.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906542327883       residual = 4.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906542231854       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906542234549       residual = 8.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.0487e-01 is 7.297241e-04

solving harmonic davidson linear method for identity shift 2.0195e+00, overlap shift 2.0195e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906531569974       residual = 2.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906534185979       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906533964166       residual = 4.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906534574389       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906534790332       residual = 6.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906534932816       residual = 2.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906534923928       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906534930456       residual = 5.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906534974473       residual = 2.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906534933709       residual = 4.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.0195e+00 is 2.359698e-04

solving harmonic davidson linear method for identity shift 8.0779e+00, overlap shift 8.0779e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906531569974       residual = 2.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906532273233       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906532211273       residual = 4.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906532371649       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906532428743       residual = 6.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906532483069       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906532478542       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906532477686       residual = 4.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906532486718       residual = 2.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906532476650       residual = 3.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 8.0779e+00 is 6.375371e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.721451 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8411e+01
  </log>
  <optVariables href="H2O.s092.opt.xml">
   uu_0                 3.131005e-01 1 1  ON 0
   uu_1                 1.454938e-01 1 1  ON 1
   uu_2                 4.346128e-02 1 1  ON 2
   uu_3                -1.975386e-02 1 1  ON 3
   uu_4                -6.651620e-02 1 1  ON 4
   uu_5                -1.030644e-01 1 1  ON 5
   uu_6                -1.323921e-01 1 1  ON 6
   uu_7                -1.480803e-01 1 1  ON 7
   uu_8                -1.416015e-01 1 1  ON 8
   uu_9                -1.141057e-01 1 1  ON 9
   ud_0                 4.517641e-01 1 1  ON 10
   ud_1                 1.857915e-01 1 1  ON 11
   ud_2                 6.518131e-02 1 1  ON 12
   ud_3                -6.201161e-03 1 1  ON 13
   ud_4                -6.365512e-02 1 1  ON 14
   ud_5                -1.061837e-01 1 1  ON 15
   ud_6                -1.349819e-01 1 1  ON 16
   ud_7                -1.528307e-01 1 1  ON 17
   ud_8                -1.548503e-01 1 1  ON 18
   ud_9                -1.458156e-01 1 1  ON 19
   eO_0                -7.484313e-01 1 1  ON 20
   eO_1                -4.274858e-01 1 1  ON 21
   eO_2                -1.606043e-02 1 1  ON 22
   eO_3                 2.980097e-01 1 1  ON 23
   eO_4                 5.260637e-01 1 1  ON 24
   eO_5                 4.904431e-01 1 1  ON 25
   eO_6                 2.636465e-01 1 1  ON 26
   eO_7                -4.202203e-02 1 1  ON 27
   eO_8                -2.368989e-01 1 1  ON 28
   eO_9                -1.031494e-01 1 1  ON 29
  eH1_0                -2.661608e-01 1 1  ON 30
  eH1_1                -1.585069e-01 1 1  ON 31
  eH1_2                -1.082119e-01 1 1  ON 32
  eH1_3                -5.243833e-02 1 1  ON 33
  eH1_4                -1.799443e-03 1 1  ON 34
  eH1_5                 3.459269e-02 1 1  ON 35
  eH1_6                 9.762293e-02 1 1  ON 36
  eH1_7                 1.597810e-01 1 1  ON 37
  eH1_8                 1.974545e-01 1 1  ON 38
  eH1_9                 9.649455e-02 1 1  ON 39
  eH2_0                -2.645489e-01 1 1  ON 40
  eH2_1                -1.567864e-01 1 1  ON 41
  eH2_2                -1.066007e-01 1 1  ON 42
  eH2_3                -5.094130e-02 1 1  ON 43
  eH2_4                -2.195096e-04 1 1  ON 44
  eH2_5                 3.703447e-02 1 1  ON 45
  eH2_6                 9.948195e-02 1 1  ON 46
  eH2_7                 1.614457e-01 1 1  ON 47
  eH2_8                 2.015337e-01 1 1  ON 48
  eH2_9                 9.030291e-02 1 1  ON 49
ci_0001                 7.014959e-01 3 1  ON 50
ci_0002                 7.006676e-01 3 1  ON 51
ci_0003                -2.749665e-02 3 1  ON 52
ci_0004                -2.705254e-02 3 1  ON 53
ci_0005                -3.610367e-02 3 1  ON 54
ci_0006                -3.620001e-02 3 1  ON 55
ci_0007                -2.137511e-02 3 1  ON 56
ci_0008                -2.147666e-02 3 1  ON 57
ci_0009                -1.749054e-02 3 1  ON 58
ci_0010                -1.721852e-02 3 1  ON 59
ci_0011                -1.229410e-02 3 1  ON 60
ci_0012                -1.202786e-02 3 1  ON 61
ci_0013                 1.341881e-02 3 1  ON 62
ci_0014                 1.307579e-02 3 1  ON 63
ci_0015                 1.319275e-02 3 1  ON 64
ci_0016                 1.308126e-02 3 1  ON 65
ci_0017                 1.137819e-02 3 1  ON 66
ci_0018                 1.123447e-02 3 1  ON 67
ci_0019                 1.132519e-02 3 1  ON 68
ci_0020                 1.165688e-02 3 1  ON 69
ci_0021                -1.798941e-03 3 1  ON 70
ci_0022                -7.619166e-04 3 1  ON 71
ci_0023                -1.143524e-02 3 1  ON 72
ci_0024                -1.107276e-02 3 1  ON 73
ci_0025                -1.063073e-02 3 1  ON 74
ci_0026                -1.050523e-02 3 1  ON 75
ci_0027                -1.135238e-02 3 1  ON 76
ci_0028                -1.130895e-02 3 1  ON 77
ci_0029                -1.062859e-02 3 1  ON 78
ci_0030                -1.089968e-02 3 1  ON 79
ci_0031                 2.074580e-02 3 1  ON 80
ci_0032                 2.080807e-02 3 1  ON 81
ci_0033                 9.954781e-03 3 1  ON 82
ci_0034                 1.031223e-02 3 1  ON 83
ci_0035                 6.635678e-03 3 1  ON 84
ci_0036                 6.648397e-03 3 1  ON 85
ci_0037                -1.079045e-02 3 1  ON 86
ci_0038                -1.087109e-02 3 1  ON 87
ci_0039                -2.461049e-03 3 1  ON 88
ci_0040                -2.627602e-03 3 1  ON 89
ci_0041                 7.308324e-03 3 1  ON 90
ci_0042                 7.000006e-03 3 1  ON 91
ci_0043                -1.875361e-02 3 1  ON 92
ci_0044                -1.886809e-02 3 1  ON 93
ci_0045                 7.714148e-03 3 1  ON 94
ci_0046                 7.266811e-03 3 1  ON 95
ci_0047                -1.673048e-03 3 1  ON 96
ci_0048                -1.846390e-03 3 1  ON 97
ci_0049                -5.721763e-03 3 1  ON 98
ci_0050                -5.648823e-03 3 1  ON 99
ci_0051                -3.452201e-03 3 1  ON 100
ci_0052                -3.339054e-03 3 1  ON 101
ci_0053                -4.648949e-03 3 1  ON 102
ci_0054                -4.883387e-03 3 1  ON 103
ci_0055                 6.476328e-03 3 1  ON 104
ci_0056                 6.813313e-03 3 1  ON 105
ci_0057                 4.905455e-03 3 1  ON 106
ci_0058                 4.527707e-03 3 1  ON 107
ci_0059                -4.850088e-03 3 1  ON 108
ci_0060                -4.590182e-03 3 1  ON 109
ci_0061                -3.494443e-03 3 1  ON 110
ci_0062                -3.259109e-03 3 1  ON 111
ci_0063                -8.677260e-03 3 1  ON 112
ci_0064                -8.295610e-03 3 1  ON 113
ci_0065                -5.469963e-03 3 1  ON 114
ci_0066                -5.289650e-03 3 1  ON 115
ci_0067                -4.753758e-03 3 1  ON 116
ci_0068                -5.023742e-03 3 1  ON 117
ci_0069                 4.099187e-03 3 1  ON 118
ci_0070                 4.310802e-03 3 1  ON 119
ci_0071                -2.098773e-04 3 1  ON 120
ci_0072                 7.485958e-05 3 1  ON 121
ci_0073                 4.280726e-03 3 1  ON 122
ci_0074                 3.969192e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 92
    time step          = 0.05
    reference energy   = -16.9997
    reference variance = 0.438346
====================================================
  Execution time = 2.0871e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s092
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3447e-01
  Total weights = 1.9520e+06
  Execution time = 1.9140e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322544763219
                                         uncertainty =       0.001763036985

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322544763219
                                         uncertainty =       0.001763036985

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401584897
  error estimate for blocks of size 2^( 2) =       0.000414247339
  error estimate for blocks of size 2^( 3) =       0.000427090875
  error estimate for blocks of size 2^( 4) =       0.000439875978
  error estimate for blocks of size 2^( 5) =       0.000449638132
  error estimate for blocks of size 2^( 6) =       0.000458778885
  error estimate for blocks of size 2^( 7) =       0.000462736593

      target function =                  N/A
              le_mean =     -16.907176378251
             les_mean =     286.200151075317
             stat err =       0.000452757397
             autocorr =       1.271090186764
              std dev =       0.567926807899
             le_variance =       0.322540859130

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322446670154
                                         uncertainty =       0.001761019205

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322446670154
                                         uncertainty =       0.001761019205

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401523565
  error estimate for blocks of size 2^( 2) =       0.000414165559
  error estimate for blocks of size 2^( 3) =       0.000426993442
  error estimate for blocks of size 2^( 4) =       0.000439780565
  error estimate for blocks of size 2^( 5) =       0.000449529365
  error estimate for blocks of size 2^( 6) =       0.000458654242
  error estimate for blocks of size 2^( 7) =       0.000462591695

      target function =                  N/A
              le_mean =     -16.907183848723
             les_mean =     286.187535580071
             stat err =       0.000452638967
             autocorr =       1.270813443471
              std dev =       0.567840070939
             le_variance =       0.322442346164

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322478930497
                                         uncertainty =       0.001760483168

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322478930497
                                         uncertainty =       0.001760483168

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401543749
  error estimate for blocks of size 2^( 2) =       0.000414190968
  error estimate for blocks of size 2^( 3) =       0.000427025281
  error estimate for blocks of size 2^( 4) =       0.000439810742
  error estimate for blocks of size 2^( 5) =       0.000449564392
  error estimate for blocks of size 2^( 6) =       0.000458693013
  error estimate for blocks of size 2^( 7) =       0.000462633329

      target function =                  N/A
              le_mean =     -16.907178970366
             les_mean =     286.187561271627
             stat err =       0.000452675369
             autocorr =       1.270890078509
              std dev =       0.567868615977
             le_variance =       0.322474765012

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322532152479
                                         uncertainty =       0.001762666061

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322532152479
                                         uncertainty =       0.001762666061

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401577027
  error estimate for blocks of size 2^( 2) =       0.000414237790
  error estimate for blocks of size 2^( 3) =       0.000427079460
  error estimate for blocks of size 2^( 4) =       0.000439865200
  error estimate for blocks of size 2^( 5) =       0.000449625765
  error estimate for blocks of size 2^( 6) =       0.000458765613
  error estimate for blocks of size 2^( 7) =       0.000462720792

      target function =                  N/A
              le_mean =     -16.907176862291
             les_mean =     286.187666428108
             stat err =       0.000452744343
             autocorr =       1.271066710854
              std dev =       0.567915677354
             le_variance =       0.322528216584


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.907176378251        initial
     5.0487e-01     5.0487e+00             7.2972e-04       -16.907183848723  <--
     2.0195e+00     2.0195e+01             2.3597e-04       -16.907178970366
     8.0779e+00     8.0779e+01             6.3754e-05       -16.907176862291

*****************************************************************************
Applying the update for shift_i =   5.0487e-01     and shift_s =   5.0487e+00
*****************************************************************************

  Execution time = 3.0519e+01
  </log>
  <optVariables href="H2O.s092.opt.xml">
   uu_0                 3.129109e-01 1 1  ON 0
   uu_1                 1.453786e-01 1 1  ON 1
   uu_2                 4.348808e-02 1 1  ON 2
   uu_3                -1.966767e-02 1 1  ON 3
   uu_4                -6.628661e-02 1 1  ON 4
   uu_5                -1.029631e-01 1 1  ON 5
   uu_6                -1.324442e-01 1 1  ON 6
   uu_7                -1.480686e-01 1 1  ON 7
   uu_8                -1.417385e-01 1 1  ON 8
   uu_9                -1.142689e-01 1 1  ON 9
   ud_0                 4.518415e-01 1 1  ON 10
   ud_1                 1.858321e-01 1 1  ON 11
   ud_2                 6.518595e-02 1 1  ON 12
   ud_3                -6.201926e-03 1 1  ON 13
   ud_4                -6.359906e-02 1 1  ON 14
   ud_5                -1.061922e-01 1 1  ON 15
   ud_6                -1.348676e-01 1 1  ON 16
   ud_7                -1.528646e-01 1 1  ON 17
   ud_8                -1.549158e-01 1 1  ON 18
   ud_9                -1.458502e-01 1 1  ON 19
   eO_0                -7.484087e-01 1 1  ON 20
   eO_1                -4.274903e-01 1 1  ON 21
   eO_2                -1.597938e-02 1 1  ON 22
   eO_3                 2.981428e-01 1 1  ON 23
   eO_4                 5.260594e-01 1 1  ON 24
   eO_5                 4.905477e-01 1 1  ON 25
   eO_6                 2.637771e-01 1 1  ON 26
   eO_7                -4.202367e-02 1 1  ON 27
   eO_8                -2.371169e-01 1 1  ON 28
   eO_9                -1.033562e-01 1 1  ON 29
  eH1_0                -2.661200e-01 1 1  ON 30
  eH1_1                -1.585482e-01 1 1  ON 31
  eH1_2                -1.083032e-01 1 1  ON 32
  eH1_3                -5.234200e-02 1 1  ON 33
  eH1_4                -1.846250e-03 1 1  ON 34
  eH1_5                 3.451170e-02 1 1  ON 35
  eH1_6                 9.750614e-02 1 1  ON 36
  eH1_7                 1.597589e-01 1 1  ON 37
  eH1_8                 1.975267e-01 1 1  ON 38
  eH1_9                 9.665951e-02 1 1  ON 39
  eH2_0                -2.646983e-01 1 1  ON 40
  eH2_1                -1.569049e-01 1 1  ON 41
  eH2_2                -1.066227e-01 1 1  ON 42
  eH2_3                -5.107708e-02 1 1  ON 43
  eH2_4                -3.839877e-04 1 1  ON 44
  eH2_5                 3.702106e-02 1 1  ON 45
  eH2_6                 9.958405e-02 1 1  ON 46
  eH2_7                 1.615205e-01 1 1  ON 47
  eH2_8                 2.016439e-01 1 1  ON 48
  eH2_9                 9.057343e-02 1 1  ON 49
ci_0001                 7.018176e-01 3 1  ON 50
ci_0002                 7.003563e-01 3 1  ON 51
ci_0003                -2.744114e-02 3 1  ON 52
ci_0004                -2.730373e-02 3 1  ON 53
ci_0005                -3.583438e-02 3 1  ON 54
ci_0006                -3.596614e-02 3 1  ON 55
ci_0007                -2.143652e-02 3 1  ON 56
ci_0008                -2.153662e-02 3 1  ON 57
ci_0009                -1.731046e-02 3 1  ON 58
ci_0010                -1.736121e-02 3 1  ON 59
ci_0011                -1.230772e-02 3 1  ON 60
ci_0012                -1.209872e-02 3 1  ON 61
ci_0013                 1.343011e-02 3 1  ON 62
ci_0014                 1.295167e-02 3 1  ON 63
ci_0015                 1.328938e-02 3 1  ON 64
ci_0016                 1.321444e-02 3 1  ON 65
ci_0017                 1.159697e-02 3 1  ON 66
ci_0018                 1.127925e-02 3 1  ON 67
ci_0019                 1.116878e-02 3 1  ON 68
ci_0020                 1.215064e-02 3 1  ON 69
ci_0021                -1.841439e-03 3 1  ON 70
ci_0022                -6.614731e-04 3 1  ON 71
ci_0023                -1.142019e-02 3 1  ON 72
ci_0024                -1.098788e-02 3 1  ON 73
ci_0025                -1.046772e-02 3 1  ON 74
ci_0026                -1.045183e-02 3 1  ON 75
ci_0027                -1.147337e-02 3 1  ON 76
ci_0028                -1.165075e-02 3 1  ON 77
ci_0029                -1.053216e-02 3 1  ON 78
ci_0030                -1.090431e-02 3 1  ON 79
ci_0031                 2.108447e-02 3 1  ON 80
ci_0032                 2.063543e-02 3 1  ON 81
ci_0033                 1.038026e-02 3 1  ON 82
ci_0034                 1.012415e-02 3 1  ON 83
ci_0035                 6.652501e-03 3 1  ON 84
ci_0036                 6.624558e-03 3 1  ON 85
ci_0037                -1.100816e-02 3 1  ON 86
ci_0038                -1.090526e-02 3 1  ON 87
ci_0039                -2.492398e-03 3 1  ON 88
ci_0040                -2.591476e-03 3 1  ON 89
ci_0041                 7.260383e-03 3 1  ON 90
ci_0042                 6.940468e-03 3 1  ON 91
ci_0043                -1.868483e-02 3 1  ON 92
ci_0044                -1.842408e-02 3 1  ON 93
ci_0045                 7.887299e-03 3 1  ON 94
ci_0046                 7.142516e-03 3 1  ON 95
ci_0047                -1.808121e-03 3 1  ON 96
ci_0048                -1.705033e-03 3 1  ON 97
ci_0049                -5.828715e-03 3 1  ON 98
ci_0050                -5.658552e-03 3 1  ON 99
ci_0051                -3.601950e-03 3 1  ON 100
ci_0052                -3.418678e-03 3 1  ON 101
ci_0053                -4.727950e-03 3 1  ON 102
ci_0054                -5.055479e-03 3 1  ON 103
ci_0055                 6.462690e-03 3 1  ON 104
ci_0056                 6.815722e-03 3 1  ON 105
ci_0057                 4.591388e-03 3 1  ON 106
ci_0058                 4.490712e-03 3 1  ON 107
ci_0059                -4.811018e-03 3 1  ON 108
ci_0060                -4.362901e-03 3 1  ON 109
ci_0061                -3.428437e-03 3 1  ON 110
ci_0062                -3.231584e-03 3 1  ON 111
ci_0063                -8.872901e-03 3 1  ON 112
ci_0064                -7.890813e-03 3 1  ON 113
ci_0065                -5.412680e-03 3 1  ON 114
ci_0066                -5.143046e-03 3 1  ON 115
ci_0067                -4.719320e-03 3 1  ON 116
ci_0068                -4.982695e-03 3 1  ON 117
ci_0069                 4.002357e-03 3 1  ON 118
ci_0070                 4.524048e-03 3 1  ON 119
ci_0071                -1.895260e-04 3 1  ON 120
ci_0072                 5.316214e-05 3 1  ON 121
ci_0073                 4.247689e-03 3 1  ON 122
ci_0074                 3.770142e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8936e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s093 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s093 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=93  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 93
    time step          = 0.05
    reference energy   = -16.8427
    reference variance = 0.278971
====================================================
  Execution time = 2.1793e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s093
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5229e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3768e-01
  Total weights = 1.951780731e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0727e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324809533716
                                         uncertainty =       0.002489902307

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324809533716
                                         uncertainty =       0.002489902307

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402991614
  error estimate for blocks of size 2^( 2) =       0.000415931199
  error estimate for blocks of size 2^( 3) =       0.000428345311
  error estimate for blocks of size 2^( 4) =       0.000440833650
  error estimate for blocks of size 2^( 5) =       0.000451086647
  error estimate for blocks of size 2^( 6) =       0.000460173414
  error estimate for blocks of size 2^( 7) =       0.000466404985

      target function =                  N/A
              le_mean =     -16.905871357940
             les_mean =     286.146169888705
             stat err =       0.000454624674
             autocorr =       1.272664671967
              std dev =       0.569916205616
             le_variance =       0.324804481424


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690587135794e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.2622e-01, overlap shift 1.2622e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905871357911       residual = 9.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905890641979       residual = 2.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905887864967       residual = 7.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905886656083       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905886537187       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905886660107       residual = 4.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905887739421       residual = 3.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905887656047       residual = 2.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905887280791       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905887801589       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905887606984       residual = 7.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905887523011       residual = 3.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905887700219       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905887677196       residual = 7.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.2622e-01 is 1.449547e-03

solving harmonic davidson linear method for identity shift 5.0487e-01, overlap shift 5.0487e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905871357911       residual = 9.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905880470276       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905879315557       residual = 4.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905878801905       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905878528447       residual = 5.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905878999386       residual = 2.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905879106311       residual = 1.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905879244891       residual = 8.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905879146993       residual = 3.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905879167772       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905879169373       residual = 6.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.0487e-01 is 5.239159e-04

solving harmonic davidson linear method for identity shift 2.0195e+00, overlap shift 2.0195e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905871357911       residual = 9.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905874288053       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905873953728       residual = 4.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905873835826       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905873721223       residual = 4.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905873868313       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905873870353       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905873942178       residual = 5.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905873938499       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905873920769       residual = 4.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.0195e+00 is 1.478719e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.726700 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7875e+01
  </log>
  <optVariables href="H2O.s093.opt.xml">
   uu_0                 3.128999e-01 1 1  ON 0
   uu_1                 1.455577e-01 1 1  ON 1
   uu_2                 4.343683e-02 1 1  ON 2
   uu_3                -1.971022e-02 1 1  ON 3
   uu_4                -6.633581e-02 1 1  ON 4
   uu_5                -1.029490e-01 1 1  ON 5
   uu_6                -1.323615e-01 1 1  ON 6
   uu_7                -1.482362e-01 1 1  ON 7
   uu_8                -1.419726e-01 1 1  ON 8
   uu_9                -1.143395e-01 1 1  ON 9
   ud_0                 4.519000e-01 1 1  ON 10
   ud_1                 1.859825e-01 1 1  ON 11
   ud_2                 6.528094e-02 1 1  ON 12
   ud_3                -6.106638e-03 1 1  ON 13
   ud_4                -6.367090e-02 1 1  ON 14
   ud_5                -1.061419e-01 1 1  ON 15
   ud_6                -1.348160e-01 1 1  ON 16
   ud_7                -1.529755e-01 1 1  ON 17
   ud_8                -1.549756e-01 1 1  ON 18
   ud_9                -1.459530e-01 1 1  ON 19
   eO_0                -7.483063e-01 1 1  ON 20
   eO_1                -4.272817e-01 1 1  ON 21
   eO_2                -1.578089e-02 1 1  ON 22
   eO_3                 2.981882e-01 1 1  ON 23
   eO_4                 5.260393e-01 1 1  ON 24
   eO_5                 4.905992e-01 1 1  ON 25
   eO_6                 2.637535e-01 1 1  ON 26
   eO_7                -4.214249e-02 1 1  ON 27
   eO_8                -2.373493e-01 1 1  ON 28
   eO_9                -1.035417e-01 1 1  ON 29
  eH1_0                -2.665220e-01 1 1  ON 30
  eH1_1                -1.587339e-01 1 1  ON 31
  eH1_2                -1.083516e-01 1 1  ON 32
  eH1_3                -5.228620e-02 1 1  ON 33
  eH1_4                -1.840514e-03 1 1  ON 34
  eH1_5                 3.439477e-02 1 1  ON 35
  eH1_6                 9.755306e-02 1 1  ON 36
  eH1_7                 1.598574e-01 1 1  ON 37
  eH1_8                 1.976847e-01 1 1  ON 38
  eH1_9                 9.695434e-02 1 1  ON 39
  eH2_0                -2.647885e-01 1 1  ON 40
  eH2_1                -1.569756e-01 1 1  ON 41
  eH2_2                -1.065410e-01 1 1  ON 42
  eH2_3                -5.095311e-02 1 1  ON 43
  eH2_4                -5.105303e-04 1 1  ON 44
  eH2_5                 3.675995e-02 1 1  ON 45
  eH2_6                 9.944874e-02 1 1  ON 46
  eH2_7                 1.615205e-01 1 1  ON 47
  eH2_8                 2.017242e-01 1 1  ON 48
  eH2_9                 9.089017e-02 1 1  ON 49
ci_0001                 7.018206e-01 3 1  ON 50
ci_0002                 7.003328e-01 3 1  ON 51
ci_0003                -2.739431e-02 3 1  ON 52
ci_0004                -2.718288e-02 3 1  ON 53
ci_0005                -3.601203e-02 3 1  ON 54
ci_0006                -3.631013e-02 3 1  ON 55
ci_0007                -2.124911e-02 3 1  ON 56
ci_0008                -2.149690e-02 3 1  ON 57
ci_0009                -1.722352e-02 3 1  ON 58
ci_0010                -1.752952e-02 3 1  ON 59
ci_0011                -1.234288e-02 3 1  ON 60
ci_0012                -1.196845e-02 3 1  ON 61
ci_0013                 1.321532e-02 3 1  ON 62
ci_0014                 1.320663e-02 3 1  ON 63
ci_0015                 1.335610e-02 3 1  ON 64
ci_0016                 1.302243e-02 3 1  ON 65
ci_0017                 1.140850e-02 3 1  ON 66
ci_0018                 1.133563e-02 3 1  ON 67
ci_0019                 1.125386e-02 3 1  ON 68
ci_0020                 1.195592e-02 3 1  ON 69
ci_0021                -1.957213e-03 3 1  ON 70
ci_0022                -1.185389e-03 3 1  ON 71
ci_0023                -1.121630e-02 3 1  ON 72
ci_0024                -1.117954e-02 3 1  ON 73
ci_0025                -1.046395e-02 3 1  ON 74
ci_0026                -1.054131e-02 3 1  ON 75
ci_0027                -1.137253e-02 3 1  ON 76
ci_0028                -1.166660e-02 3 1  ON 77
ci_0029                -1.032043e-02 3 1  ON 78
ci_0030                -1.096485e-02 3 1  ON 79
ci_0031                 2.081689e-02 3 1  ON 80
ci_0032                 2.081821e-02 3 1  ON 81
ci_0033                 1.051346e-02 3 1  ON 82
ci_0034                 1.025385e-02 3 1  ON 83
ci_0035                 6.758071e-03 3 1  ON 84
ci_0036                 6.833889e-03 3 1  ON 85
ci_0037                -1.088146e-02 3 1  ON 86
ci_0038                -1.078105e-02 3 1  ON 87
ci_0039                -2.391758e-03 3 1  ON 88
ci_0040                -2.568729e-03 3 1  ON 89
ci_0041                 7.342059e-03 3 1  ON 90
ci_0042                 6.871608e-03 3 1  ON 91
ci_0043                -1.884793e-02 3 1  ON 92
ci_0044                -1.871100e-02 3 1  ON 93
ci_0045                 7.791546e-03 3 1  ON 94
ci_0046                 7.079133e-03 3 1  ON 95
ci_0047                -1.715101e-03 3 1  ON 96
ci_0048                -1.816945e-03 3 1  ON 97
ci_0049                -5.883093e-03 3 1  ON 98
ci_0050                -5.624843e-03 3 1  ON 99
ci_0051                -3.454272e-03 3 1  ON 100
ci_0052                -3.523978e-03 3 1  ON 101
ci_0053                -4.751627e-03 3 1  ON 102
ci_0054                -4.779425e-03 3 1  ON 103
ci_0055                 6.262383e-03 3 1  ON 104
ci_0056                 6.687118e-03 3 1  ON 105
ci_0057                 4.819701e-03 3 1  ON 106
ci_0058                 4.829617e-03 3 1  ON 107
ci_0059                -4.718719e-03 3 1  ON 108
ci_0060                -4.465654e-03 3 1  ON 109
ci_0061                -3.231212e-03 3 1  ON 110
ci_0062                -3.633009e-03 3 1  ON 111
ci_0063                -9.115805e-03 3 1  ON 112
ci_0064                -8.054305e-03 3 1  ON 113
ci_0065                -5.418879e-03 3 1  ON 114
ci_0066                -4.945539e-03 3 1  ON 115
ci_0067                -4.626519e-03 3 1  ON 116
ci_0068                -4.973660e-03 3 1  ON 117
ci_0069                 4.108526e-03 3 1  ON 118
ci_0070                 4.505653e-03 3 1  ON 119
ci_0071                -4.826179e-04 3 1  ON 120
ci_0072                 1.434121e-06 3 1  ON 121
ci_0073                 4.218280e-03 3 1  ON 122
ci_0074                 4.095639e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 93
    time step          = 0.05
    reference energy   = -16.8817
    reference variance = 0.197432
====================================================
  Execution time = 2.1553e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s093
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3135e-01
  Total weights = 1.9512e+06
  Execution time = 1.9092e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320741077832
                                         uncertainty =       0.001794013479

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320741077832
                                         uncertainty =       0.001794013479

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400497637
  error estimate for blocks of size 2^( 2) =       0.000414011819
  error estimate for blocks of size 2^( 3) =       0.000427840645
  error estimate for blocks of size 2^( 4) =       0.000440955535
  error estimate for blocks of size 2^( 5) =       0.000453315163
  error estimate for blocks of size 2^( 6) =       0.000465981522
  error estimate for blocks of size 2^( 7) =       0.000474252341

      target function =                  N/A
              le_mean =     -16.905680240648
             les_mean =     286.133848469922
             stat err =       0.000458626140
             autocorr =       1.311347200465
              std dev =       0.566389189535
             le_variance =       0.320796714022

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320656364162
                                         uncertainty =       0.001774477295

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320656364162
                                         uncertainty =       0.001774477295

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400444352
  error estimate for blocks of size 2^( 2) =       0.000413979008
  error estimate for blocks of size 2^( 3) =       0.000427817879
  error estimate for blocks of size 2^( 4) =       0.000440945488
  error estimate for blocks of size 2^( 5) =       0.000453290200
  error estimate for blocks of size 2^( 6) =       0.000465969534
  error estimate for blocks of size 2^( 7) =       0.000474241348

      target function =                  N/A
              le_mean =     -16.905678342537
             les_mean =     286.136868778090
             stat err =       0.000458611643
             autocorr =       1.311613283596
              std dev =       0.566313833466
             le_variance =       0.320711357975

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320620896989
                                         uncertainty =       0.001773252282

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320620896989
                                         uncertainty =       0.001773252282

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400422362
  error estimate for blocks of size 2^( 2) =       0.000413955631
  error estimate for blocks of size 2^( 3) =       0.000427794799
  error estimate for blocks of size 2^( 4) =       0.000440920147
  error estimate for blocks of size 2^( 5) =       0.000453267624
  error estimate for blocks of size 2^( 6) =       0.000465950481
  error estimate for blocks of size 2^( 7) =       0.000474219251

      target function =                  N/A
              le_mean =     -16.905681846825
             les_mean =     286.141093484040
             stat err =       0.000458589376
             autocorr =       1.311629970951
              std dev =       0.566282735281
             le_variance =       0.320676136277

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320691865637
                                         uncertainty =       0.001789425108

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320691865637
                                         uncertainty =       0.001789425108

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400466906
  error estimate for blocks of size 2^( 2) =       0.000413983460
  error estimate for blocks of size 2^( 3) =       0.000427812964
  error estimate for blocks of size 2^( 4) =       0.000440929086
  error estimate for blocks of size 2^( 5) =       0.000453284956
  error estimate for blocks of size 2^( 6) =       0.000465952539
  error estimate for blocks of size 2^( 7) =       0.000474224868

      target function =                  N/A
              le_mean =     -16.905678919434
             les_mean =     286.134590518175
             stat err =       0.000458597862
             autocorr =       1.311386735182
              std dev =       0.566345730039
             le_variance =       0.320747485933


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905680240648        initial
     1.2622e-01     1.2622e+00             1.4495e-03       -16.905678342537
     5.0487e-01     5.0487e+00             5.2392e-04       -16.905681846825  <--
     2.0195e+00     2.0195e+01             1.4787e-04       -16.905678919434

*****************************************************************************
Applying the update for shift_i =   5.0487e-01     and shift_s =   5.0487e+00
*****************************************************************************

  Execution time = 3.1208e+01
  </log>
  <optVariables href="H2O.s093.opt.xml">
   uu_0                 3.128999e-01 1 1  ON 0
   uu_1                 1.455577e-01 1 1  ON 1
   uu_2                 4.343683e-02 1 1  ON 2
   uu_3                -1.971022e-02 1 1  ON 3
   uu_4                -6.633581e-02 1 1  ON 4
   uu_5                -1.029490e-01 1 1  ON 5
   uu_6                -1.323615e-01 1 1  ON 6
   uu_7                -1.482362e-01 1 1  ON 7
   uu_8                -1.419726e-01 1 1  ON 8
   uu_9                -1.143395e-01 1 1  ON 9
   ud_0                 4.519000e-01 1 1  ON 10
   ud_1                 1.859825e-01 1 1  ON 11
   ud_2                 6.528094e-02 1 1  ON 12
   ud_3                -6.106638e-03 1 1  ON 13
   ud_4                -6.367090e-02 1 1  ON 14
   ud_5                -1.061419e-01 1 1  ON 15
   ud_6                -1.348160e-01 1 1  ON 16
   ud_7                -1.529755e-01 1 1  ON 17
   ud_8                -1.549756e-01 1 1  ON 18
   ud_9                -1.459530e-01 1 1  ON 19
   eO_0                -7.483063e-01 1 1  ON 20
   eO_1                -4.272817e-01 1 1  ON 21
   eO_2                -1.578089e-02 1 1  ON 22
   eO_3                 2.981882e-01 1 1  ON 23
   eO_4                 5.260393e-01 1 1  ON 24
   eO_5                 4.905992e-01 1 1  ON 25
   eO_6                 2.637535e-01 1 1  ON 26
   eO_7                -4.214249e-02 1 1  ON 27
   eO_8                -2.373493e-01 1 1  ON 28
   eO_9                -1.035417e-01 1 1  ON 29
  eH1_0                -2.665220e-01 1 1  ON 30
  eH1_1                -1.587339e-01 1 1  ON 31
  eH1_2                -1.083516e-01 1 1  ON 32
  eH1_3                -5.228620e-02 1 1  ON 33
  eH1_4                -1.840514e-03 1 1  ON 34
  eH1_5                 3.439477e-02 1 1  ON 35
  eH1_6                 9.755306e-02 1 1  ON 36
  eH1_7                 1.598574e-01 1 1  ON 37
  eH1_8                 1.976847e-01 1 1  ON 38
  eH1_9                 9.695434e-02 1 1  ON 39
  eH2_0                -2.647885e-01 1 1  ON 40
  eH2_1                -1.569756e-01 1 1  ON 41
  eH2_2                -1.065410e-01 1 1  ON 42
  eH2_3                -5.095311e-02 1 1  ON 43
  eH2_4                -5.105303e-04 1 1  ON 44
  eH2_5                 3.675995e-02 1 1  ON 45
  eH2_6                 9.944874e-02 1 1  ON 46
  eH2_7                 1.615205e-01 1 1  ON 47
  eH2_8                 2.017242e-01 1 1  ON 48
  eH2_9                 9.089017e-02 1 1  ON 49
ci_0001                 7.018206e-01 3 1  ON 50
ci_0002                 7.003328e-01 3 1  ON 51
ci_0003                -2.739431e-02 3 1  ON 52
ci_0004                -2.718288e-02 3 1  ON 53
ci_0005                -3.601203e-02 3 1  ON 54
ci_0006                -3.631013e-02 3 1  ON 55
ci_0007                -2.124911e-02 3 1  ON 56
ci_0008                -2.149690e-02 3 1  ON 57
ci_0009                -1.722352e-02 3 1  ON 58
ci_0010                -1.752952e-02 3 1  ON 59
ci_0011                -1.234288e-02 3 1  ON 60
ci_0012                -1.196845e-02 3 1  ON 61
ci_0013                 1.321532e-02 3 1  ON 62
ci_0014                 1.320663e-02 3 1  ON 63
ci_0015                 1.335610e-02 3 1  ON 64
ci_0016                 1.302243e-02 3 1  ON 65
ci_0017                 1.140850e-02 3 1  ON 66
ci_0018                 1.133563e-02 3 1  ON 67
ci_0019                 1.125386e-02 3 1  ON 68
ci_0020                 1.195592e-02 3 1  ON 69
ci_0021                -1.957213e-03 3 1  ON 70
ci_0022                -1.185389e-03 3 1  ON 71
ci_0023                -1.121630e-02 3 1  ON 72
ci_0024                -1.117954e-02 3 1  ON 73
ci_0025                -1.046395e-02 3 1  ON 74
ci_0026                -1.054131e-02 3 1  ON 75
ci_0027                -1.137253e-02 3 1  ON 76
ci_0028                -1.166660e-02 3 1  ON 77
ci_0029                -1.032043e-02 3 1  ON 78
ci_0030                -1.096485e-02 3 1  ON 79
ci_0031                 2.081689e-02 3 1  ON 80
ci_0032                 2.081821e-02 3 1  ON 81
ci_0033                 1.051346e-02 3 1  ON 82
ci_0034                 1.025385e-02 3 1  ON 83
ci_0035                 6.758071e-03 3 1  ON 84
ci_0036                 6.833889e-03 3 1  ON 85
ci_0037                -1.088146e-02 3 1  ON 86
ci_0038                -1.078105e-02 3 1  ON 87
ci_0039                -2.391758e-03 3 1  ON 88
ci_0040                -2.568729e-03 3 1  ON 89
ci_0041                 7.342059e-03 3 1  ON 90
ci_0042                 6.871608e-03 3 1  ON 91
ci_0043                -1.884793e-02 3 1  ON 92
ci_0044                -1.871100e-02 3 1  ON 93
ci_0045                 7.791546e-03 3 1  ON 94
ci_0046                 7.079133e-03 3 1  ON 95
ci_0047                -1.715101e-03 3 1  ON 96
ci_0048                -1.816945e-03 3 1  ON 97
ci_0049                -5.883093e-03 3 1  ON 98
ci_0050                -5.624843e-03 3 1  ON 99
ci_0051                -3.454272e-03 3 1  ON 100
ci_0052                -3.523978e-03 3 1  ON 101
ci_0053                -4.751627e-03 3 1  ON 102
ci_0054                -4.779425e-03 3 1  ON 103
ci_0055                 6.262383e-03 3 1  ON 104
ci_0056                 6.687118e-03 3 1  ON 105
ci_0057                 4.819701e-03 3 1  ON 106
ci_0058                 4.829617e-03 3 1  ON 107
ci_0059                -4.718719e-03 3 1  ON 108
ci_0060                -4.465654e-03 3 1  ON 109
ci_0061                -3.231212e-03 3 1  ON 110
ci_0062                -3.633009e-03 3 1  ON 111
ci_0063                -9.115805e-03 3 1  ON 112
ci_0064                -8.054305e-03 3 1  ON 113
ci_0065                -5.418879e-03 3 1  ON 114
ci_0066                -4.945539e-03 3 1  ON 115
ci_0067                -4.626519e-03 3 1  ON 116
ci_0068                -4.973660e-03 3 1  ON 117
ci_0069                 4.108526e-03 3 1  ON 118
ci_0070                 4.505653e-03 3 1  ON 119
ci_0071                -4.826179e-04 3 1  ON 120
ci_0072                 1.434121e-06 3 1  ON 121
ci_0073                 4.218280e-03 3 1  ON 122
ci_0074                 4.095639e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9090e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s094 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s094 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=94  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 94
    time step          = 0.05
    reference energy   = -16.8171
    reference variance = 0.229744
====================================================
  Execution time = 2.1880e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s094
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5242e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4653e-01
  Total weights = 1.951893175e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.2532e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332053752712
                                         uncertainty =       0.005248877337

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332053752712
                                         uncertainty =       0.005248877337

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407544753
  error estimate for blocks of size 2^( 2) =       0.000420361012
  error estimate for blocks of size 2^( 3) =       0.000433287974
  error estimate for blocks of size 2^( 4) =       0.000445858409
  error estimate for blocks of size 2^( 5) =       0.000456077805
  error estimate for blocks of size 2^( 6) =       0.000463574971
  error estimate for blocks of size 2^( 7) =       0.000468203212

      target function =                  N/A
              le_mean =     -16.906323163277
             les_mean =     286.170294390149
             stat err =       0.000458428599
             autocorr =       1.265297921490
              std dev =       0.576355317014
             le_variance =       0.332185451450


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690632316328e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.2622e-01, overlap shift 1.2622e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906323163304       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906322072004       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906323992940       residual = 7.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906324941564       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906323484265       residual = 7.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906326265815       residual = 8.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906326232110       residual = 5.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906326572971       residual = 3.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906325878167       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906325886654       residual = 9.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906325649847       residual = 7.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906326002317       residual = 3.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906326478036       residual = 1.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906326539718       residual = 8.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.2622e-01 is 1.715040e-03

solving harmonic davidson linear method for identity shift 5.0487e-01, overlap shift 5.0487e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906323163304       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906322645490       residual = 6.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906323159233       residual = 3.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906323673086       residual = 7.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906323334985       residual = 9.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906323742694       residual = 4.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906324241679       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906324111342       residual = 8.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906323862838       residual = 3.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906323876953       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906323906632       residual = 6.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.0487e-01 is 5.353368e-04

solving harmonic davidson linear method for identity shift 2.0195e+00, overlap shift 2.0195e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906323163304       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906322996376       residual = 6.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906323120523       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906323254617       residual = 7.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906323257935       residual = 9.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906323314365       residual = 2.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906323404253       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906323378348       residual = 3.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906323331614       residual = 1.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906323329367       residual = 3.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.0195e+00 is 1.742688e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.731930 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8142e+01
  </log>
  <optVariables href="H2O.s094.opt.xml">
   uu_0                 3.129259e-01 1 1  ON 0
   uu_1                 1.453791e-01 1 1  ON 1
   uu_2                 4.334635e-02 1 1  ON 2
   uu_3                -1.978705e-02 1 1  ON 3
   uu_4                -6.651930e-02 1 1  ON 4
   uu_5                -1.030936e-01 1 1  ON 5
   uu_6                -1.324458e-01 1 1  ON 6
   uu_7                -1.480457e-01 1 1  ON 7
   uu_8                -1.417995e-01 1 1  ON 8
   uu_9                -1.142808e-01 1 1  ON 9
   ud_0                 4.519531e-01 1 1  ON 10
   ud_1                 1.860053e-01 1 1  ON 11
   ud_2                 6.523898e-02 1 1  ON 12
   ud_3                -6.107421e-03 1 1  ON 13
   ud_4                -6.365246e-02 1 1  ON 14
   ud_5                -1.061841e-01 1 1  ON 15
   ud_6                -1.349692e-01 1 1  ON 16
   ud_7                -1.531594e-01 1 1  ON 17
   ud_8                -1.548374e-01 1 1  ON 18
   ud_9                -1.457285e-01 1 1  ON 19
   eO_0                -7.482350e-01 1 1  ON 20
   eO_1                -4.270116e-01 1 1  ON 21
   eO_2                -1.587728e-02 1 1  ON 22
   eO_3                 2.982042e-01 1 1  ON 23
   eO_4                 5.258785e-01 1 1  ON 24
   eO_5                 4.907043e-01 1 1  ON 25
   eO_6                 2.637554e-01 1 1  ON 26
   eO_7                -4.203228e-02 1 1  ON 27
   eO_8                -2.373907e-01 1 1  ON 28
   eO_9                -1.037553e-01 1 1  ON 29
  eH1_0                -2.666954e-01 1 1  ON 30
  eH1_1                -1.588590e-01 1 1  ON 31
  eH1_2                -1.085504e-01 1 1  ON 32
  eH1_3                -5.258626e-02 1 1  ON 33
  eH1_4                -1.925716e-03 1 1  ON 34
  eH1_5                 3.426666e-02 1 1  ON 35
  eH1_6                 9.770353e-02 1 1  ON 36
  eH1_7                 1.599846e-01 1 1  ON 37
  eH1_8                 1.979106e-01 1 1  ON 38
  eH1_9                 9.737933e-02 1 1  ON 39
  eH2_0                -2.650735e-01 1 1  ON 40
  eH2_1                -1.569047e-01 1 1  ON 41
  eH2_2                -1.067562e-01 1 1  ON 42
  eH2_3                -5.101119e-02 1 1  ON 43
  eH2_4                -4.550324e-04 1 1  ON 44
  eH2_5                 3.658487e-02 1 1  ON 45
  eH2_6                 9.952193e-02 1 1  ON 46
  eH2_7                 1.615771e-01 1 1  ON 47
  eH2_8                 2.018708e-01 1 1  ON 48
  eH2_9                 9.119707e-02 1 1  ON 49
ci_0001                 7.018134e-01 3 1  ON 50
ci_0002                 7.003527e-01 3 1  ON 51
ci_0003                -2.712384e-02 3 1  ON 52
ci_0004                -2.720086e-02 3 1  ON 53
ci_0005                -3.599162e-02 3 1  ON 54
ci_0006                -3.650440e-02 3 1  ON 55
ci_0007                -2.078229e-02 3 1  ON 56
ci_0008                -2.172635e-02 3 1  ON 57
ci_0009                -1.725169e-02 3 1  ON 58
ci_0010                -1.717004e-02 3 1  ON 59
ci_0011                -1.228750e-02 3 1  ON 60
ci_0012                -1.190595e-02 3 1  ON 61
ci_0013                 1.324567e-02 3 1  ON 62
ci_0014                 1.316945e-02 3 1  ON 63
ci_0015                 1.341341e-02 3 1  ON 64
ci_0016                 1.270941e-02 3 1  ON 65
ci_0017                 1.125393e-02 3 1  ON 66
ci_0018                 1.130591e-02 3 1  ON 67
ci_0019                 1.131594e-02 3 1  ON 68
ci_0020                 1.193250e-02 3 1  ON 69
ci_0021                -2.257460e-03 3 1  ON 70
ci_0022                -1.082594e-03 3 1  ON 71
ci_0023                -1.091744e-02 3 1  ON 72
ci_0024                -1.123004e-02 3 1  ON 73
ci_0025                -1.099929e-02 3 1  ON 74
ci_0026                -1.047397e-02 3 1  ON 75
ci_0027                -1.143149e-02 3 1  ON 76
ci_0028                -1.165320e-02 3 1  ON 77
ci_0029                -1.042665e-02 3 1  ON 78
ci_0030                -1.107005e-02 3 1  ON 79
ci_0031                 2.087545e-02 3 1  ON 80
ci_0032                 2.071585e-02 3 1  ON 81
ci_0033                 1.054811e-02 3 1  ON 82
ci_0034                 1.017733e-02 3 1  ON 83
ci_0035                 6.763759e-03 3 1  ON 84
ci_0036                 6.596675e-03 3 1  ON 85
ci_0037                -1.095775e-02 3 1  ON 86
ci_0038                -1.074558e-02 3 1  ON 87
ci_0039                -2.403701e-03 3 1  ON 88
ci_0040                -2.510186e-03 3 1  ON 89
ci_0041                 6.943639e-03 3 1  ON 90
ci_0042                 6.938527e-03 3 1  ON 91
ci_0043                -1.918478e-02 3 1  ON 92
ci_0044                -1.874626e-02 3 1  ON 93
ci_0045                 8.010277e-03 3 1  ON 94
ci_0046                 7.217457e-03 3 1  ON 95
ci_0047                -1.575435e-03 3 1  ON 96
ci_0048                -1.744965e-03 3 1  ON 97
ci_0049                -5.926242e-03 3 1  ON 98
ci_0050                -6.038728e-03 3 1  ON 99
ci_0051                -3.372667e-03 3 1  ON 100
ci_0052                -3.485976e-03 3 1  ON 101
ci_0053                -4.509104e-03 3 1  ON 102
ci_0054                -4.632951e-03 3 1  ON 103
ci_0055                 6.425073e-03 3 1  ON 104
ci_0056                 6.503831e-03 3 1  ON 105
ci_0057                 5.137633e-03 3 1  ON 106
ci_0058                 4.863582e-03 3 1  ON 107
ci_0059                -4.564300e-03 3 1  ON 108
ci_0060                -4.440266e-03 3 1  ON 109
ci_0061                -3.155145e-03 3 1  ON 110
ci_0062                -3.507401e-03 3 1  ON 111
ci_0063                -8.602933e-03 3 1  ON 112
ci_0064                -8.282060e-03 3 1  ON 113
ci_0065                -5.410017e-03 3 1  ON 114
ci_0066                -4.963077e-03 3 1  ON 115
ci_0067                -4.971517e-03 3 1  ON 116
ci_0068                -5.049533e-03 3 1  ON 117
ci_0069                 3.996023e-03 3 1  ON 118
ci_0070                 4.526046e-03 3 1  ON 119
ci_0071                -2.189362e-04 3 1  ON 120
ci_0072                 8.171430e-05 3 1  ON 121
ci_0073                 4.142655e-03 3 1  ON 122
ci_0074                 4.294568e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 94
    time step          = 0.05
    reference energy   = -16.9564
    reference variance = 0.502541
====================================================
  Execution time = 2.1728e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s094
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3595e-01
  Total weights = 1.9519e+06
  Execution time = 1.9840e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322724501745
                                         uncertainty =       0.002425041636

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322724501745
                                         uncertainty =       0.002425041636

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401728711
  error estimate for blocks of size 2^( 2) =       0.000414159405
  error estimate for blocks of size 2^( 3) =       0.000427280637
  error estimate for blocks of size 2^( 4) =       0.000439498050
  error estimate for blocks of size 2^( 5) =       0.000449771648
  error estimate for blocks of size 2^( 6) =       0.000458089166
  error estimate for blocks of size 2^( 7) =       0.000462418218

      target function =                  N/A
              le_mean =     -16.905650415680
             les_mean =     286.145037166686
             stat err =       0.000452444271
             autocorr =       1.268423978275
              std dev =       0.568130191602
             le_variance =       0.322771914609

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323193975958
                                         uncertainty =       0.002429291302

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323193975958
                                         uncertainty =       0.002429291302

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402021619
  error estimate for blocks of size 2^( 2) =       0.000414475245
  error estimate for blocks of size 2^( 3) =       0.000427624227
  error estimate for blocks of size 2^( 4) =       0.000439842908
  error estimate for blocks of size 2^( 5) =       0.000450132345
  error estimate for blocks of size 2^( 6) =       0.000458428280
  error estimate for blocks of size 2^( 7) =       0.000462692355

      target function =                  N/A
              le_mean =     -16.905665977490
             les_mean =     286.162498296911
             stat err =       0.000452773972
             autocorr =       1.268422946598
              std dev =       0.568544425861
             le_variance =       0.323242764178

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323213653105
                                         uncertainty =       0.002425164744

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323213653105
                                         uncertainty =       0.002425164744

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402033754
  error estimate for blocks of size 2^( 2) =       0.000414492378
  error estimate for blocks of size 2^( 3) =       0.000427650207
  error estimate for blocks of size 2^( 4) =       0.000439880490
  error estimate for blocks of size 2^( 5) =       0.000450175426
  error estimate for blocks of size 2^( 6) =       0.000458466357
  error estimate for blocks of size 2^( 7) =       0.000462742196

      target function =                  N/A
              le_mean =     -16.905675621582
             les_mean =     286.229429236311
             stat err =       0.000452816117
             autocorr =       1.268582506860
              std dev =       0.568561587425
             le_variance =       0.323262278695

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322766122252
                                         uncertainty =       0.002425312616

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322766122252
                                         uncertainty =       0.002425312616

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401754683
  error estimate for blocks of size 2^( 2) =       0.000414189422
  error estimate for blocks of size 2^( 3) =       0.000427316559
  error estimate for blocks of size 2^( 4) =       0.000439533596
  error estimate for blocks of size 2^( 5) =       0.000449812124
  error estimate for blocks of size 2^( 6) =       0.000458125711
  error estimate for blocks of size 2^( 7) =       0.000462454806

      target function =                  N/A
              le_mean =     -16.905649699051
             les_mean =     286.157021644108
             stat err =       0.000452481560
             autocorr =       1.268469046152
              std dev =       0.568166921385
             le_variance =       0.322813650556


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905650415680        initial
     1.2622e-01     1.2622e+00             1.7150e-03       -16.905665977490
     5.0487e-01     5.0487e+00             5.3534e-04       -16.905675621582  <--
     2.0195e+00     2.0195e+01             1.7427e-04       -16.905649699051

*****************************************************************************
Applying the update for shift_i =   5.0487e-01     and shift_s =   5.0487e+00
*****************************************************************************

  Execution time = 3.1529e+01
  </log>
  <optVariables href="H2O.s094.opt.xml">
   uu_0                 3.129259e-01 1 1  ON 0
   uu_1                 1.453791e-01 1 1  ON 1
   uu_2                 4.334635e-02 1 1  ON 2
   uu_3                -1.978705e-02 1 1  ON 3
   uu_4                -6.651930e-02 1 1  ON 4
   uu_5                -1.030936e-01 1 1  ON 5
   uu_6                -1.324458e-01 1 1  ON 6
   uu_7                -1.480457e-01 1 1  ON 7
   uu_8                -1.417995e-01 1 1  ON 8
   uu_9                -1.142808e-01 1 1  ON 9
   ud_0                 4.519531e-01 1 1  ON 10
   ud_1                 1.860053e-01 1 1  ON 11
   ud_2                 6.523898e-02 1 1  ON 12
   ud_3                -6.107421e-03 1 1  ON 13
   ud_4                -6.365246e-02 1 1  ON 14
   ud_5                -1.061841e-01 1 1  ON 15
   ud_6                -1.349692e-01 1 1  ON 16
   ud_7                -1.531594e-01 1 1  ON 17
   ud_8                -1.548374e-01 1 1  ON 18
   ud_9                -1.457285e-01 1 1  ON 19
   eO_0                -7.482350e-01 1 1  ON 20
   eO_1                -4.270116e-01 1 1  ON 21
   eO_2                -1.587728e-02 1 1  ON 22
   eO_3                 2.982042e-01 1 1  ON 23
   eO_4                 5.258785e-01 1 1  ON 24
   eO_5                 4.907043e-01 1 1  ON 25
   eO_6                 2.637554e-01 1 1  ON 26
   eO_7                -4.203228e-02 1 1  ON 27
   eO_8                -2.373907e-01 1 1  ON 28
   eO_9                -1.037553e-01 1 1  ON 29
  eH1_0                -2.666954e-01 1 1  ON 30
  eH1_1                -1.588590e-01 1 1  ON 31
  eH1_2                -1.085504e-01 1 1  ON 32
  eH1_3                -5.258626e-02 1 1  ON 33
  eH1_4                -1.925716e-03 1 1  ON 34
  eH1_5                 3.426666e-02 1 1  ON 35
  eH1_6                 9.770353e-02 1 1  ON 36
  eH1_7                 1.599846e-01 1 1  ON 37
  eH1_8                 1.979106e-01 1 1  ON 38
  eH1_9                 9.737933e-02 1 1  ON 39
  eH2_0                -2.650735e-01 1 1  ON 40
  eH2_1                -1.569047e-01 1 1  ON 41
  eH2_2                -1.067562e-01 1 1  ON 42
  eH2_3                -5.101119e-02 1 1  ON 43
  eH2_4                -4.550324e-04 1 1  ON 44
  eH2_5                 3.658487e-02 1 1  ON 45
  eH2_6                 9.952193e-02 1 1  ON 46
  eH2_7                 1.615771e-01 1 1  ON 47
  eH2_8                 2.018708e-01 1 1  ON 48
  eH2_9                 9.119707e-02 1 1  ON 49
ci_0001                 7.018134e-01 3 1  ON 50
ci_0002                 7.003527e-01 3 1  ON 51
ci_0003                -2.712384e-02 3 1  ON 52
ci_0004                -2.720086e-02 3 1  ON 53
ci_0005                -3.599162e-02 3 1  ON 54
ci_0006                -3.650440e-02 3 1  ON 55
ci_0007                -2.078229e-02 3 1  ON 56
ci_0008                -2.172635e-02 3 1  ON 57
ci_0009                -1.725169e-02 3 1  ON 58
ci_0010                -1.717004e-02 3 1  ON 59
ci_0011                -1.228750e-02 3 1  ON 60
ci_0012                -1.190595e-02 3 1  ON 61
ci_0013                 1.324567e-02 3 1  ON 62
ci_0014                 1.316945e-02 3 1  ON 63
ci_0015                 1.341341e-02 3 1  ON 64
ci_0016                 1.270941e-02 3 1  ON 65
ci_0017                 1.125393e-02 3 1  ON 66
ci_0018                 1.130591e-02 3 1  ON 67
ci_0019                 1.131594e-02 3 1  ON 68
ci_0020                 1.193250e-02 3 1  ON 69
ci_0021                -2.257460e-03 3 1  ON 70
ci_0022                -1.082594e-03 3 1  ON 71
ci_0023                -1.091744e-02 3 1  ON 72
ci_0024                -1.123004e-02 3 1  ON 73
ci_0025                -1.099929e-02 3 1  ON 74
ci_0026                -1.047397e-02 3 1  ON 75
ci_0027                -1.143149e-02 3 1  ON 76
ci_0028                -1.165320e-02 3 1  ON 77
ci_0029                -1.042665e-02 3 1  ON 78
ci_0030                -1.107005e-02 3 1  ON 79
ci_0031                 2.087545e-02 3 1  ON 80
ci_0032                 2.071585e-02 3 1  ON 81
ci_0033                 1.054811e-02 3 1  ON 82
ci_0034                 1.017733e-02 3 1  ON 83
ci_0035                 6.763759e-03 3 1  ON 84
ci_0036                 6.596675e-03 3 1  ON 85
ci_0037                -1.095775e-02 3 1  ON 86
ci_0038                -1.074558e-02 3 1  ON 87
ci_0039                -2.403701e-03 3 1  ON 88
ci_0040                -2.510186e-03 3 1  ON 89
ci_0041                 6.943639e-03 3 1  ON 90
ci_0042                 6.938527e-03 3 1  ON 91
ci_0043                -1.918478e-02 3 1  ON 92
ci_0044                -1.874626e-02 3 1  ON 93
ci_0045                 8.010277e-03 3 1  ON 94
ci_0046                 7.217457e-03 3 1  ON 95
ci_0047                -1.575435e-03 3 1  ON 96
ci_0048                -1.744965e-03 3 1  ON 97
ci_0049                -5.926242e-03 3 1  ON 98
ci_0050                -6.038728e-03 3 1  ON 99
ci_0051                -3.372667e-03 3 1  ON 100
ci_0052                -3.485976e-03 3 1  ON 101
ci_0053                -4.509104e-03 3 1  ON 102
ci_0054                -4.632951e-03 3 1  ON 103
ci_0055                 6.425073e-03 3 1  ON 104
ci_0056                 6.503831e-03 3 1  ON 105
ci_0057                 5.137633e-03 3 1  ON 106
ci_0058                 4.863582e-03 3 1  ON 107
ci_0059                -4.564300e-03 3 1  ON 108
ci_0060                -4.440266e-03 3 1  ON 109
ci_0061                -3.155145e-03 3 1  ON 110
ci_0062                -3.507401e-03 3 1  ON 111
ci_0063                -8.602933e-03 3 1  ON 112
ci_0064                -8.282060e-03 3 1  ON 113
ci_0065                -5.410017e-03 3 1  ON 114
ci_0066                -4.963077e-03 3 1  ON 115
ci_0067                -4.971517e-03 3 1  ON 116
ci_0068                -5.049533e-03 3 1  ON 117
ci_0069                 3.996023e-03 3 1  ON 118
ci_0070                 4.526046e-03 3 1  ON 119
ci_0071                -2.189362e-04 3 1  ON 120
ci_0072                 8.171430e-05 3 1  ON 121
ci_0073                 4.142655e-03 3 1  ON 122
ci_0074                 4.294568e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9677e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s095 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s095 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=95  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 95
    time step          = 0.05
    reference energy   = -16.9108
    reference variance = 0.238637
====================================================
  Execution time = 2.1731e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s095
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5261e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3478e-01
  Total weights = 1.951602359e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1172e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322318911721
                                         uncertainty =       0.002008119564

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322318911721
                                         uncertainty =       0.002008119564

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401413390
  error estimate for blocks of size 2^( 2) =       0.000414655976
  error estimate for blocks of size 2^( 3) =       0.000427969424
  error estimate for blocks of size 2^( 4) =       0.000440303907
  error estimate for blocks of size 2^( 5) =       0.000450569645
  error estimate for blocks of size 2^( 6) =       0.000456883244
  error estimate for blocks of size 2^( 7) =       0.000461427127

      target function =                  N/A
              le_mean =     -16.906555254471
             les_mean =     286.166388182997
             stat err =       0.000452295981
             autocorr =       1.269584897136
              std dev =       0.567684259732
             le_variance =       0.322265418747


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690655525447e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.2622e-01, overlap shift 1.2622e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906555254493       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906559628354       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906557482405       residual = 5.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906559126145       residual = 9.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906558367746       residual = 7.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906560530673       residual = 5.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906560313703       residual = 4.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906561458208       residual = 3.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906560803393       residual = 2.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906560603561       residual = 7.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906561016092       residual = 4.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906561040237       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906560962242       residual = 7.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.2622e-01 is 1.590894e-03

solving harmonic davidson linear method for identity shift 5.0487e-01, overlap shift 5.0487e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906555254493       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906557368946       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906556557376       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906556885731       residual = 6.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906556536387       residual = 6.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906557530378       residual = 3.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906557436432       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906557678567       residual = 8.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906557625093       residual = 2.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906557424416       residual = 8.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.0487e-01 is 5.225150e-04

solving harmonic davidson linear method for identity shift 2.0195e+00, overlap shift 2.0195e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906555254493       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906555944075       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906555699429       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906555737149       residual = 7.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906555619743       residual = 5.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906555900790       residual = 2.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906555932777       residual = 8.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906555987781       residual = 3.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906555981146       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906555919558       residual = 2.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.0195e+00 is 1.810055e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.736702 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7857e+01
  </log>
  <optVariables href="H2O.s095.opt.xml">
   uu_0                 3.130745e-01 1 1  ON 0
   uu_1                 1.452103e-01 1 1  ON 1
   uu_2                 4.328785e-02 1 1  ON 2
   uu_3                -1.986576e-02 1 1  ON 3
   uu_4                -6.663668e-02 1 1  ON 4
   uu_5                -1.030456e-01 1 1  ON 5
   uu_6                -1.323636e-01 1 1  ON 6
   uu_7                -1.481793e-01 1 1  ON 7
   uu_8                -1.418494e-01 1 1  ON 8
   uu_9                -1.144101e-01 1 1  ON 9
   ud_0                 4.519764e-01 1 1  ON 10
   ud_1                 1.859179e-01 1 1  ON 11
   ud_2                 6.523930e-02 1 1  ON 12
   ud_3                -6.092368e-03 1 1  ON 13
   ud_4                -6.362089e-02 1 1  ON 14
   ud_5                -1.062285e-01 1 1  ON 15
   ud_6                -1.350061e-01 1 1  ON 16
   ud_7                -1.531890e-01 1 1  ON 17
   ud_8                -1.547246e-01 1 1  ON 18
   ud_9                -1.456088e-01 1 1  ON 19
   eO_0                -7.481018e-01 1 1  ON 20
   eO_1                -4.269274e-01 1 1  ON 21
   eO_2                -1.595004e-02 1 1  ON 22
   eO_3                 2.983647e-01 1 1  ON 23
   eO_4                 5.259673e-01 1 1  ON 24
   eO_5                 4.906715e-01 1 1  ON 25
   eO_6                 2.637660e-01 1 1  ON 26
   eO_7                -4.197861e-02 1 1  ON 27
   eO_8                -2.375636e-01 1 1  ON 28
   eO_9                -1.039720e-01 1 1  ON 29
  eH1_0                -2.667509e-01 1 1  ON 30
  eH1_1                -1.589307e-01 1 1  ON 31
  eH1_2                -1.086306e-01 1 1  ON 32
  eH1_3                -5.259181e-02 1 1  ON 33
  eH1_4                -2.154831e-03 1 1  ON 34
  eH1_5                 3.411635e-02 1 1  ON 35
  eH1_6                 9.776859e-02 1 1  ON 36
  eH1_7                 1.600033e-01 1 1  ON 37
  eH1_8                 1.979558e-01 1 1  ON 38
  eH1_9                 9.775587e-02 1 1  ON 39
  eH2_0                -2.650918e-01 1 1  ON 40
  eH2_1                -1.570141e-01 1 1  ON 41
  eH2_2                -1.068368e-01 1 1  ON 42
  eH2_3                -5.110370e-02 1 1  ON 43
  eH2_4                -7.170698e-04 1 1  ON 44
  eH2_5                 3.653947e-02 1 1  ON 45
  eH2_6                 9.936223e-02 1 1  ON 46
  eH2_7                 1.616476e-01 1 1  ON 47
  eH2_8                 2.021012e-01 1 1  ON 48
  eH2_9                 9.158867e-02 1 1  ON 49
ci_0001                 7.018683e-01 3 1  ON 50
ci_0002                 7.002896e-01 3 1  ON 51
ci_0003                -2.741073e-02 3 1  ON 52
ci_0004                -2.719667e-02 3 1  ON 53
ci_0005                -3.598576e-02 3 1  ON 54
ci_0006                -3.683056e-02 3 1  ON 55
ci_0007                -2.099477e-02 3 1  ON 56
ci_0008                -2.157415e-02 3 1  ON 57
ci_0009                -1.739970e-02 3 1  ON 58
ci_0010                -1.699183e-02 3 1  ON 59
ci_0011                -1.221141e-02 3 1  ON 60
ci_0012                -1.202597e-02 3 1  ON 61
ci_0013                 1.327575e-02 3 1  ON 62
ci_0014                 1.319637e-02 3 1  ON 63
ci_0015                 1.366075e-02 3 1  ON 64
ci_0016                 1.302943e-02 3 1  ON 65
ci_0017                 1.105777e-02 3 1  ON 66
ci_0018                 1.118399e-02 3 1  ON 67
ci_0019                 1.104925e-02 3 1  ON 68
ci_0020                 1.150899e-02 3 1  ON 69
ci_0021                -2.031117e-03 3 1  ON 70
ci_0022                -1.294254e-03 3 1  ON 71
ci_0023                -1.111302e-02 3 1  ON 72
ci_0024                -1.117302e-02 3 1  ON 73
ci_0025                -1.092431e-02 3 1  ON 74
ci_0026                -1.029669e-02 3 1  ON 75
ci_0027                -1.127911e-02 3 1  ON 76
ci_0028                -1.162666e-02 3 1  ON 77
ci_0029                -1.094916e-02 3 1  ON 78
ci_0030                -1.077692e-02 3 1  ON 79
ci_0031                 2.063138e-02 3 1  ON 80
ci_0032                 2.060469e-02 3 1  ON 81
ci_0033                 1.050029e-02 3 1  ON 82
ci_0034                 1.019134e-02 3 1  ON 83
ci_0035                 7.070501e-03 3 1  ON 84
ci_0036                 6.523672e-03 3 1  ON 85
ci_0037                -1.088006e-02 3 1  ON 86
ci_0038                -1.079135e-02 3 1  ON 87
ci_0039                -2.531303e-03 3 1  ON 88
ci_0040                -2.594437e-03 3 1  ON 89
ci_0041                 6.951091e-03 3 1  ON 90
ci_0042                 6.844312e-03 3 1  ON 91
ci_0043                -1.906890e-02 3 1  ON 92
ci_0044                -1.887290e-02 3 1  ON 93
ci_0045                 7.875820e-03 3 1  ON 94
ci_0046                 7.230703e-03 3 1  ON 95
ci_0047                -1.825437e-03 3 1  ON 96
ci_0048                -1.639573e-03 3 1  ON 97
ci_0049                -5.710880e-03 3 1  ON 98
ci_0050                -6.166493e-03 3 1  ON 99
ci_0051                -3.344257e-03 3 1  ON 100
ci_0052                -3.252170e-03 3 1  ON 101
ci_0053                -4.501150e-03 3 1  ON 102
ci_0054                -4.802508e-03 3 1  ON 103
ci_0055                 6.175355e-03 3 1  ON 104
ci_0056                 6.288546e-03 3 1  ON 105
ci_0057                 5.045316e-03 3 1  ON 106
ci_0058                 5.072662e-03 3 1  ON 107
ci_0059                -5.083283e-03 3 1  ON 108
ci_0060                -4.549308e-03 3 1  ON 109
ci_0061                -3.300409e-03 3 1  ON 110
ci_0062                -3.701808e-03 3 1  ON 111
ci_0063                -8.399258e-03 3 1  ON 112
ci_0064                -8.099153e-03 3 1  ON 113
ci_0065                -5.443738e-03 3 1  ON 114
ci_0066                -5.072339e-03 3 1  ON 115
ci_0067                -4.912494e-03 3 1  ON 116
ci_0068                -4.953982e-03 3 1  ON 117
ci_0069                 4.282628e-03 3 1  ON 118
ci_0070                 4.382357e-03 3 1  ON 119
ci_0071                -2.433088e-04 3 1  ON 120
ci_0072                 6.141808e-06 3 1  ON 121
ci_0073                 3.986480e-03 3 1  ON 122
ci_0074                 4.268651e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 95
    time step          = 0.05
    reference energy   = -16.8233
    reference variance = 0.232721
====================================================
  Execution time = 2.1829e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s095
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3947e-01
  Total weights = 1.9517e+06
  Execution time = 1.9065e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328141285979
                                         uncertainty =       0.004257596776

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328141285979
                                         uncertainty =       0.004257596776

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405012135
  error estimate for blocks of size 2^( 2) =       0.000417798832
  error estimate for blocks of size 2^( 3) =       0.000431005910
  error estimate for blocks of size 2^( 4) =       0.000443813111
  error estimate for blocks of size 2^( 5) =       0.000455048381
  error estimate for blocks of size 2^( 6) =       0.000463792295
  error estimate for blocks of size 2^( 7) =       0.000466768051

      target function =                  N/A
              le_mean =     -16.905535314600
             les_mean =     286.137537448723
             stat err =       0.000457355460
             autocorr =       1.275180502961
              std dev =       0.572773654241
             le_variance =       0.328069658992

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328009445447
                                         uncertainty =       0.004140690049

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328009445447
                                         uncertainty =       0.004140690049

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404931625
  error estimate for blocks of size 2^( 2) =       0.000417739743
  error estimate for blocks of size 2^( 3) =       0.000430966790
  error estimate for blocks of size 2^( 4) =       0.000443782198
  error estimate for blocks of size 2^( 5) =       0.000455026543
  error estimate for blocks of size 2^( 6) =       0.000463826767
  error estimate for blocks of size 2^( 7) =       0.000466847702

      target function =                  N/A
              le_mean =     -16.905542113948
             les_mean =     286.187059700179
             stat err =       0.000457370802
             autocorr =       1.275773215977
              std dev =       0.572659796285
             le_variance =       0.327939242281

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328118505652
                                         uncertainty =       0.004167620650

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328118505652
                                         uncertainty =       0.004167620650

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404998845
  error estimate for blocks of size 2^( 2) =       0.000417802266
  error estimate for blocks of size 2^( 3) =       0.000431020310
  error estimate for blocks of size 2^( 4) =       0.000443830278
  error estimate for blocks of size 2^( 5) =       0.000455074043
  error estimate for blocks of size 2^( 6) =       0.000463881933
  error estimate for blocks of size 2^( 7) =       0.000466891378

      target function =                  N/A
              le_mean =     -16.905543219655
             les_mean =     286.137295399116
             stat err =       0.000457419408
             autocorr =       1.275620842812
              std dev =       0.572754858682
             le_variance =       0.328048128144

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328126815176
                                         uncertainty =       0.004244909504

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328126815176
                                         uncertainty =       0.004244909504

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405003334
  error estimate for blocks of size 2^( 2) =       0.000417791862
  error estimate for blocks of size 2^( 3) =       0.000430999378
  error estimate for blocks of size 2^( 4) =       0.000443806463
  error estimate for blocks of size 2^( 5) =       0.000455042665
  error estimate for blocks of size 2^( 6) =       0.000463796331
  error estimate for blocks of size 2^( 7) =       0.000466775911

      target function =                  N/A
              le_mean =     -16.905533422024
             les_mean =     286.136697213061
             stat err =       0.000457355343
             autocorr =       1.275235275518
              std dev =       0.572761207178
             le_variance =       0.328055400448


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905535314600        initial
     1.2622e-01     1.2622e+00             1.5909e-03       -16.905542113948
     5.0487e-01     5.0487e+00             5.2251e-04       -16.905543219655  <--
     2.0195e+00     2.0195e+01             1.8101e-04       -16.905533422024

*****************************************************************************
Applying the update for shift_i =   5.0487e-01     and shift_s =   5.0487e+00
*****************************************************************************

  Execution time = 3.1462e+01
  </log>
  <optVariables href="H2O.s095.opt.xml">
   uu_0                 3.130745e-01 1 1  ON 0
   uu_1                 1.452103e-01 1 1  ON 1
   uu_2                 4.328785e-02 1 1  ON 2
   uu_3                -1.986576e-02 1 1  ON 3
   uu_4                -6.663668e-02 1 1  ON 4
   uu_5                -1.030456e-01 1 1  ON 5
   uu_6                -1.323636e-01 1 1  ON 6
   uu_7                -1.481793e-01 1 1  ON 7
   uu_8                -1.418494e-01 1 1  ON 8
   uu_9                -1.144101e-01 1 1  ON 9
   ud_0                 4.519764e-01 1 1  ON 10
   ud_1                 1.859179e-01 1 1  ON 11
   ud_2                 6.523930e-02 1 1  ON 12
   ud_3                -6.092368e-03 1 1  ON 13
   ud_4                -6.362089e-02 1 1  ON 14
   ud_5                -1.062285e-01 1 1  ON 15
   ud_6                -1.350061e-01 1 1  ON 16
   ud_7                -1.531890e-01 1 1  ON 17
   ud_8                -1.547246e-01 1 1  ON 18
   ud_9                -1.456088e-01 1 1  ON 19
   eO_0                -7.481018e-01 1 1  ON 20
   eO_1                -4.269274e-01 1 1  ON 21
   eO_2                -1.595004e-02 1 1  ON 22
   eO_3                 2.983647e-01 1 1  ON 23
   eO_4                 5.259673e-01 1 1  ON 24
   eO_5                 4.906715e-01 1 1  ON 25
   eO_6                 2.637660e-01 1 1  ON 26
   eO_7                -4.197861e-02 1 1  ON 27
   eO_8                -2.375636e-01 1 1  ON 28
   eO_9                -1.039720e-01 1 1  ON 29
  eH1_0                -2.667509e-01 1 1  ON 30
  eH1_1                -1.589307e-01 1 1  ON 31
  eH1_2                -1.086306e-01 1 1  ON 32
  eH1_3                -5.259181e-02 1 1  ON 33
  eH1_4                -2.154831e-03 1 1  ON 34
  eH1_5                 3.411635e-02 1 1  ON 35
  eH1_6                 9.776859e-02 1 1  ON 36
  eH1_7                 1.600033e-01 1 1  ON 37
  eH1_8                 1.979558e-01 1 1  ON 38
  eH1_9                 9.775587e-02 1 1  ON 39
  eH2_0                -2.650918e-01 1 1  ON 40
  eH2_1                -1.570141e-01 1 1  ON 41
  eH2_2                -1.068368e-01 1 1  ON 42
  eH2_3                -5.110370e-02 1 1  ON 43
  eH2_4                -7.170698e-04 1 1  ON 44
  eH2_5                 3.653947e-02 1 1  ON 45
  eH2_6                 9.936223e-02 1 1  ON 46
  eH2_7                 1.616476e-01 1 1  ON 47
  eH2_8                 2.021012e-01 1 1  ON 48
  eH2_9                 9.158867e-02 1 1  ON 49
ci_0001                 7.018683e-01 3 1  ON 50
ci_0002                 7.002896e-01 3 1  ON 51
ci_0003                -2.741073e-02 3 1  ON 52
ci_0004                -2.719667e-02 3 1  ON 53
ci_0005                -3.598576e-02 3 1  ON 54
ci_0006                -3.683056e-02 3 1  ON 55
ci_0007                -2.099477e-02 3 1  ON 56
ci_0008                -2.157415e-02 3 1  ON 57
ci_0009                -1.739970e-02 3 1  ON 58
ci_0010                -1.699183e-02 3 1  ON 59
ci_0011                -1.221141e-02 3 1  ON 60
ci_0012                -1.202597e-02 3 1  ON 61
ci_0013                 1.327575e-02 3 1  ON 62
ci_0014                 1.319637e-02 3 1  ON 63
ci_0015                 1.366075e-02 3 1  ON 64
ci_0016                 1.302943e-02 3 1  ON 65
ci_0017                 1.105777e-02 3 1  ON 66
ci_0018                 1.118399e-02 3 1  ON 67
ci_0019                 1.104925e-02 3 1  ON 68
ci_0020                 1.150899e-02 3 1  ON 69
ci_0021                -2.031117e-03 3 1  ON 70
ci_0022                -1.294254e-03 3 1  ON 71
ci_0023                -1.111302e-02 3 1  ON 72
ci_0024                -1.117302e-02 3 1  ON 73
ci_0025                -1.092431e-02 3 1  ON 74
ci_0026                -1.029669e-02 3 1  ON 75
ci_0027                -1.127911e-02 3 1  ON 76
ci_0028                -1.162666e-02 3 1  ON 77
ci_0029                -1.094916e-02 3 1  ON 78
ci_0030                -1.077692e-02 3 1  ON 79
ci_0031                 2.063138e-02 3 1  ON 80
ci_0032                 2.060469e-02 3 1  ON 81
ci_0033                 1.050029e-02 3 1  ON 82
ci_0034                 1.019134e-02 3 1  ON 83
ci_0035                 7.070501e-03 3 1  ON 84
ci_0036                 6.523672e-03 3 1  ON 85
ci_0037                -1.088006e-02 3 1  ON 86
ci_0038                -1.079135e-02 3 1  ON 87
ci_0039                -2.531303e-03 3 1  ON 88
ci_0040                -2.594437e-03 3 1  ON 89
ci_0041                 6.951091e-03 3 1  ON 90
ci_0042                 6.844312e-03 3 1  ON 91
ci_0043                -1.906890e-02 3 1  ON 92
ci_0044                -1.887290e-02 3 1  ON 93
ci_0045                 7.875820e-03 3 1  ON 94
ci_0046                 7.230703e-03 3 1  ON 95
ci_0047                -1.825437e-03 3 1  ON 96
ci_0048                -1.639573e-03 3 1  ON 97
ci_0049                -5.710880e-03 3 1  ON 98
ci_0050                -6.166493e-03 3 1  ON 99
ci_0051                -3.344257e-03 3 1  ON 100
ci_0052                -3.252170e-03 3 1  ON 101
ci_0053                -4.501150e-03 3 1  ON 102
ci_0054                -4.802508e-03 3 1  ON 103
ci_0055                 6.175355e-03 3 1  ON 104
ci_0056                 6.288546e-03 3 1  ON 105
ci_0057                 5.045316e-03 3 1  ON 106
ci_0058                 5.072662e-03 3 1  ON 107
ci_0059                -5.083283e-03 3 1  ON 108
ci_0060                -4.549308e-03 3 1  ON 109
ci_0061                -3.300409e-03 3 1  ON 110
ci_0062                -3.701808e-03 3 1  ON 111
ci_0063                -8.399258e-03 3 1  ON 112
ci_0064                -8.099153e-03 3 1  ON 113
ci_0065                -5.443738e-03 3 1  ON 114
ci_0066                -5.072339e-03 3 1  ON 115
ci_0067                -4.912494e-03 3 1  ON 116
ci_0068                -4.953982e-03 3 1  ON 117
ci_0069                 4.282628e-03 3 1  ON 118
ci_0070                 4.382357e-03 3 1  ON 119
ci_0071                -2.433088e-04 3 1  ON 120
ci_0072                 6.141808e-06 3 1  ON 121
ci_0073                 3.986480e-03 3 1  ON 122
ci_0074                 4.268651e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9324e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s096 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s096 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=96  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 96
    time step          = 0.05
    reference energy   = -16.9596
    reference variance = 0.393729
====================================================
  Execution time = 2.1599e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s096
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5251e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4151e-01
  Total weights = 1.951518289e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1944e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327331524085
                                         uncertainty =       0.004323044657

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327331524085
                                         uncertainty =       0.004323044657

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404528342
  error estimate for blocks of size 2^( 2) =       0.000417461938
  error estimate for blocks of size 2^( 3) =       0.000431157878
  error estimate for blocks of size 2^( 4) =       0.000443180940
  error estimate for blocks of size 2^( 5) =       0.000453188611
  error estimate for blocks of size 2^( 6) =       0.000463150340
  error estimate for blocks of size 2^( 7) =       0.000469723909

      target function =                  N/A
              le_mean =     -16.905746915728
             les_mean =     286.145792335840
             stat err =       0.000457310950
             autocorr =       1.277983630291
              std dev =       0.572089468017
             le_variance =       0.327286359416


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690574691573e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.2622e-01, overlap shift 1.2622e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905746915753       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905741186192       residual = 9.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905738320524       residual = 5.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905738396785       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905738950337       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905738380767       residual = 6.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905738268867       residual = 4.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905738427300       residual = 3.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905737982552       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905739120721       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905738983948       residual = 7.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905739148670       residual = 3.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905739114305       residual = 1.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905739333727       residual = 8.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.2622e-01 is 1.816681e-03

solving harmonic davidson linear method for identity shift 5.0487e-01, overlap shift 5.0487e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905746915753       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905744179306       residual = 5.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905742569522       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905742257673       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905742389045       residual = 8.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905742670692       residual = 3.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905742516609       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905742805905       residual = 8.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905742760780       residual = 3.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905742935426       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905742909865       residual = 8.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.0487e-01 is 5.900732e-04

solving harmonic davidson linear method for identity shift 2.0195e+00, overlap shift 2.0195e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905746915753       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905746030055       residual = 4.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905745422781       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905745254726       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905745239679       residual = 7.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905745355621       residual = 3.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905745383106       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905745440120       residual = 4.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905745471899       residual = 2.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905745502330       residual = 5.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.0195e+00 is 1.765161e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.741954 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7802e+01
  </log>
  <optVariables href="H2O.s096.opt.xml">
   uu_0                 3.130662e-01 1 1  ON 0
   uu_1                 1.453726e-01 1 1  ON 1
   uu_2                 4.303368e-02 1 1  ON 2
   uu_3                -2.006151e-02 1 1  ON 3
   uu_4                -6.673674e-02 1 1  ON 4
   uu_5                -1.030848e-01 1 1  ON 5
   uu_6                -1.321611e-01 1 1  ON 6
   uu_7                -1.481982e-01 1 1  ON 7
   uu_8                -1.419083e-01 1 1  ON 8
   uu_9                -1.144165e-01 1 1  ON 9
   ud_0                 4.519897e-01 1 1  ON 10
   ud_1                 1.858972e-01 1 1  ON 11
   ud_2                 6.526633e-02 1 1  ON 12
   ud_3                -6.173469e-03 1 1  ON 13
   ud_4                -6.365357e-02 1 1  ON 14
   ud_5                -1.062409e-01 1 1  ON 15
   ud_6                -1.350940e-01 1 1  ON 16
   ud_7                -1.532617e-01 1 1  ON 17
   ud_8                -1.545847e-01 1 1  ON 18
   ud_9                -1.455064e-01 1 1  ON 19
   eO_0                -7.482155e-01 1 1  ON 20
   eO_1                -4.268055e-01 1 1  ON 21
   eO_2                -1.563883e-02 1 1  ON 22
   eO_3                 2.985779e-01 1 1  ON 23
   eO_4                 5.258733e-01 1 1  ON 24
   eO_5                 4.905801e-01 1 1  ON 25
   eO_6                 2.636676e-01 1 1  ON 26
   eO_7                -4.195701e-02 1 1  ON 27
   eO_8                -2.375882e-01 1 1  ON 28
   eO_9                -1.041780e-01 1 1  ON 29
  eH1_0                -2.668815e-01 1 1  ON 30
  eH1_1                -1.589504e-01 1 1  ON 31
  eH1_2                -1.086004e-01 1 1  ON 32
  eH1_3                -5.264452e-02 1 1  ON 33
  eH1_4                -2.383720e-03 1 1  ON 34
  eH1_5                 3.388654e-02 1 1  ON 35
  eH1_6                 9.785190e-02 1 1  ON 36
  eH1_7                 1.599793e-01 1 1  ON 37
  eH1_8                 1.980641e-01 1 1  ON 38
  eH1_9                 9.813213e-02 1 1  ON 39
  eH2_0                -2.651474e-01 1 1  ON 40
  eH2_1                -1.571042e-01 1 1  ON 41
  eH2_2                -1.068302e-01 1 1  ON 42
  eH2_3                -5.128402e-02 1 1  ON 43
  eH2_4                -7.249988e-04 1 1  ON 44
  eH2_5                 3.620076e-02 1 1  ON 45
  eH2_6                 9.923463e-02 1 1  ON 46
  eH2_7                 1.617122e-01 1 1  ON 47
  eH2_8                 2.022490e-01 1 1  ON 48
  eH2_9                 9.203419e-02 1 1  ON 49
ci_0001                 7.019140e-01 3 1  ON 50
ci_0002                 7.002472e-01 3 1  ON 51
ci_0003                -2.711933e-02 3 1  ON 52
ci_0004                -2.718313e-02 3 1  ON 53
ci_0005                -3.633990e-02 3 1  ON 54
ci_0006                -3.707718e-02 3 1  ON 55
ci_0007                -2.127904e-02 3 1  ON 56
ci_0008                -2.134073e-02 3 1  ON 57
ci_0009                -1.754211e-02 3 1  ON 58
ci_0010                -1.703627e-02 3 1  ON 59
ci_0011                -1.211816e-02 3 1  ON 60
ci_0012                -1.185917e-02 3 1  ON 61
ci_0013                 1.313680e-02 3 1  ON 62
ci_0014                 1.313768e-02 3 1  ON 63
ci_0015                 1.343711e-02 3 1  ON 64
ci_0016                 1.280575e-02 3 1  ON 65
ci_0017                 1.102078e-02 3 1  ON 66
ci_0018                 1.109874e-02 3 1  ON 67
ci_0019                 1.115353e-02 3 1  ON 68
ci_0020                 1.144398e-02 3 1  ON 69
ci_0021                -1.913269e-03 3 1  ON 70
ci_0022                -1.338397e-03 3 1  ON 71
ci_0023                -1.116238e-02 3 1  ON 72
ci_0024                -1.090881e-02 3 1  ON 73
ci_0025                -1.106251e-02 3 1  ON 74
ci_0026                -1.026021e-02 3 1  ON 75
ci_0027                -1.110422e-02 3 1  ON 76
ci_0028                -1.108196e-02 3 1  ON 77
ci_0029                -1.085382e-02 3 1  ON 78
ci_0030                -1.069723e-02 3 1  ON 79
ci_0031                 2.034670e-02 3 1  ON 80
ci_0032                 2.043296e-02 3 1  ON 81
ci_0033                 1.061071e-02 3 1  ON 82
ci_0034                 1.009961e-02 3 1  ON 83
ci_0035                 7.061856e-03 3 1  ON 84
ci_0036                 6.351596e-03 3 1  ON 85
ci_0037                -1.091238e-02 3 1  ON 86
ci_0038                -1.060882e-02 3 1  ON 87
ci_0039                -2.298456e-03 3 1  ON 88
ci_0040                -2.551458e-03 3 1  ON 89
ci_0041                 7.088045e-03 3 1  ON 90
ci_0042                 6.819922e-03 3 1  ON 91
ci_0043                -1.906810e-02 3 1  ON 92
ci_0044                -1.946298e-02 3 1  ON 93
ci_0045                 7.696345e-03 3 1  ON 94
ci_0046                 7.190938e-03 3 1  ON 95
ci_0047                -1.713204e-03 3 1  ON 96
ci_0048                -1.731536e-03 3 1  ON 97
ci_0049                -5.627357e-03 3 1  ON 98
ci_0050                -5.960795e-03 3 1  ON 99
ci_0051                -3.350473e-03 3 1  ON 100
ci_0052                -3.380967e-03 3 1  ON 101
ci_0053                -4.752804e-03 3 1  ON 102
ci_0054                -4.650351e-03 3 1  ON 103
ci_0055                 6.469773e-03 3 1  ON 104
ci_0056                 6.405626e-03 3 1  ON 105
ci_0057                 4.884077e-03 3 1  ON 106
ci_0058                 5.111593e-03 3 1  ON 107
ci_0059                -4.950948e-03 3 1  ON 108
ci_0060                -4.625122e-03 3 1  ON 109
ci_0061                -3.220719e-03 3 1  ON 110
ci_0062                -3.841991e-03 3 1  ON 111
ci_0063                -8.302337e-03 3 1  ON 112
ci_0064                -8.268292e-03 3 1  ON 113
ci_0065                -5.688479e-03 3 1  ON 114
ci_0066                -5.265592e-03 3 1  ON 115
ci_0067                -4.995433e-03 3 1  ON 116
ci_0068                -5.064743e-03 3 1  ON 117
ci_0069                 4.332219e-03 3 1  ON 118
ci_0070                 4.390095e-03 3 1  ON 119
ci_0071                -3.219457e-04 3 1  ON 120
ci_0072                -1.993239e-04 3 1  ON 121
ci_0073                 4.479380e-03 3 1  ON 122
ci_0074                 4.238861e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 96
    time step          = 0.05
    reference energy   = -16.9858
    reference variance = 0.448957
====================================================
  Execution time = 2.1756e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s096
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3729e-01
  Total weights = 1.9517e+06
  Execution time = 1.9162e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324961849697
                                         uncertainty =       0.002164796917

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324961849697
                                         uncertainty =       0.002164796917

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403051114
  error estimate for blocks of size 2^( 2) =       0.000415662197
  error estimate for blocks of size 2^( 3) =       0.000429378518
  error estimate for blocks of size 2^( 4) =       0.000441512465
  error estimate for blocks of size 2^( 5) =       0.000451570682
  error estimate for blocks of size 2^( 6) =       0.000458213743
  error estimate for blocks of size 2^( 7) =       0.000464033338

      target function =                  N/A
              le_mean =     -16.905073306421
             les_mean =     286.138628351289
             stat err =       0.000453832557
             autocorr =       1.267859254232
              std dev =       0.570000351413
             le_variance =       0.324900400611

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325307002436
                                         uncertainty =       0.002158989338

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325307002436
                                         uncertainty =       0.002158989338

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403268920
  error estimate for blocks of size 2^( 2) =       0.000415907408
  error estimate for blocks of size 2^( 3) =       0.000429641031
  error estimate for blocks of size 2^( 4) =       0.000441774451
  error estimate for blocks of size 2^( 5) =       0.000451824202
  error estimate for blocks of size 2^( 6) =       0.000458426200
  error estimate for blocks of size 2^( 7) =       0.000464236925

      target function =                  N/A
              le_mean =     -16.905069311775
             les_mean =     286.120551587565
             stat err =       0.000454065445
             autocorr =       1.267790230740
              std dev =       0.570308375739
             le_variance =       0.325251643438

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325217278762
                                         uncertainty =       0.002154879142

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325217278762
                                         uncertainty =       0.002154879142

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403214085
  error estimate for blocks of size 2^( 2) =       0.000415850661
  error estimate for blocks of size 2^( 3) =       0.000429582324
  error estimate for blocks of size 2^( 4) =       0.000441714584
  error estimate for blocks of size 2^( 5) =       0.000451766708
  error estimate for blocks of size 2^( 6) =       0.000458374445
  error estimate for blocks of size 2^( 7) =       0.000464182972

      target function =                  N/A
              le_mean =     -16.905065575861
             les_mean =     286.118806183504
             stat err =       0.000454009677
             autocorr =       1.267823596039
              std dev =       0.570230828006
             le_variance =       0.325163197208

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324917861723
                                         uncertainty =       0.002165916583

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324917861723
                                         uncertainty =       0.002165916583

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403024645
  error estimate for blocks of size 2^( 2) =       0.000415639263
  error estimate for blocks of size 2^( 3) =       0.000429356217
  error estimate for blocks of size 2^( 4) =       0.000441485268
  error estimate for blocks of size 2^( 5) =       0.000451541418
  error estimate for blocks of size 2^( 6) =       0.000458170262
  error estimate for blocks of size 2^( 7) =       0.000463990568

      target function =                  N/A
              le_mean =     -16.905071302978
             les_mean =     286.119634943182
             stat err =       0.000453796879
             autocorr =       1.267826433734
              std dev =       0.569962918421
             le_variance =       0.324857728374


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905073306421        initial  <--
     1.2622e-01     1.2622e+00             1.8167e-03       -16.905069311775
     5.0487e-01     5.0487e+00             5.9007e-04       -16.905065575861
     2.0195e+00     2.0195e+01             1.7652e-04       -16.905071302978

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.4497
  </log>
  <optVariables href="H2O.s096.opt.xml">
   uu_0                 3.130745e-01 1 1  ON 0
   uu_1                 1.452103e-01 1 1  ON 1
   uu_2                 4.328785e-02 1 1  ON 2
   uu_3                -1.986576e-02 1 1  ON 3
   uu_4                -6.663668e-02 1 1  ON 4
   uu_5                -1.030456e-01 1 1  ON 5
   uu_6                -1.323636e-01 1 1  ON 6
   uu_7                -1.481793e-01 1 1  ON 7
   uu_8                -1.418494e-01 1 1  ON 8
   uu_9                -1.144101e-01 1 1  ON 9
   ud_0                 4.519764e-01 1 1  ON 10
   ud_1                 1.859179e-01 1 1  ON 11
   ud_2                 6.523930e-02 1 1  ON 12
   ud_3                -6.092368e-03 1 1  ON 13
   ud_4                -6.362089e-02 1 1  ON 14
   ud_5                -1.062285e-01 1 1  ON 15
   ud_6                -1.350061e-01 1 1  ON 16
   ud_7                -1.531890e-01 1 1  ON 17
   ud_8                -1.547246e-01 1 1  ON 18
   ud_9                -1.456088e-01 1 1  ON 19
   eO_0                -7.481018e-01 1 1  ON 20
   eO_1                -4.269274e-01 1 1  ON 21
   eO_2                -1.595004e-02 1 1  ON 22
   eO_3                 2.983647e-01 1 1  ON 23
   eO_4                 5.259673e-01 1 1  ON 24
   eO_5                 4.906715e-01 1 1  ON 25
   eO_6                 2.637660e-01 1 1  ON 26
   eO_7                -4.197861e-02 1 1  ON 27
   eO_8                -2.375636e-01 1 1  ON 28
   eO_9                -1.039720e-01 1 1  ON 29
  eH1_0                -2.667509e-01 1 1  ON 30
  eH1_1                -1.589307e-01 1 1  ON 31
  eH1_2                -1.086306e-01 1 1  ON 32
  eH1_3                -5.259181e-02 1 1  ON 33
  eH1_4                -2.154831e-03 1 1  ON 34
  eH1_5                 3.411635e-02 1 1  ON 35
  eH1_6                 9.776859e-02 1 1  ON 36
  eH1_7                 1.600033e-01 1 1  ON 37
  eH1_8                 1.979558e-01 1 1  ON 38
  eH1_9                 9.775587e-02 1 1  ON 39
  eH2_0                -2.650918e-01 1 1  ON 40
  eH2_1                -1.570141e-01 1 1  ON 41
  eH2_2                -1.068368e-01 1 1  ON 42
  eH2_3                -5.110370e-02 1 1  ON 43
  eH2_4                -7.170698e-04 1 1  ON 44
  eH2_5                 3.653947e-02 1 1  ON 45
  eH2_6                 9.936223e-02 1 1  ON 46
  eH2_7                 1.616476e-01 1 1  ON 47
  eH2_8                 2.021012e-01 1 1  ON 48
  eH2_9                 9.158867e-02 1 1  ON 49
ci_0001                 7.018683e-01 3 1  ON 50
ci_0002                 7.002896e-01 3 1  ON 51
ci_0003                -2.741073e-02 3 1  ON 52
ci_0004                -2.719667e-02 3 1  ON 53
ci_0005                -3.598576e-02 3 1  ON 54
ci_0006                -3.683056e-02 3 1  ON 55
ci_0007                -2.099477e-02 3 1  ON 56
ci_0008                -2.157415e-02 3 1  ON 57
ci_0009                -1.739970e-02 3 1  ON 58
ci_0010                -1.699183e-02 3 1  ON 59
ci_0011                -1.221141e-02 3 1  ON 60
ci_0012                -1.202597e-02 3 1  ON 61
ci_0013                 1.327575e-02 3 1  ON 62
ci_0014                 1.319637e-02 3 1  ON 63
ci_0015                 1.366075e-02 3 1  ON 64
ci_0016                 1.302943e-02 3 1  ON 65
ci_0017                 1.105777e-02 3 1  ON 66
ci_0018                 1.118399e-02 3 1  ON 67
ci_0019                 1.104925e-02 3 1  ON 68
ci_0020                 1.150899e-02 3 1  ON 69
ci_0021                -2.031117e-03 3 1  ON 70
ci_0022                -1.294254e-03 3 1  ON 71
ci_0023                -1.111302e-02 3 1  ON 72
ci_0024                -1.117302e-02 3 1  ON 73
ci_0025                -1.092431e-02 3 1  ON 74
ci_0026                -1.029669e-02 3 1  ON 75
ci_0027                -1.127911e-02 3 1  ON 76
ci_0028                -1.162666e-02 3 1  ON 77
ci_0029                -1.094916e-02 3 1  ON 78
ci_0030                -1.077692e-02 3 1  ON 79
ci_0031                 2.063138e-02 3 1  ON 80
ci_0032                 2.060469e-02 3 1  ON 81
ci_0033                 1.050029e-02 3 1  ON 82
ci_0034                 1.019134e-02 3 1  ON 83
ci_0035                 7.070501e-03 3 1  ON 84
ci_0036                 6.523672e-03 3 1  ON 85
ci_0037                -1.088006e-02 3 1  ON 86
ci_0038                -1.079135e-02 3 1  ON 87
ci_0039                -2.531303e-03 3 1  ON 88
ci_0040                -2.594437e-03 3 1  ON 89
ci_0041                 6.951091e-03 3 1  ON 90
ci_0042                 6.844312e-03 3 1  ON 91
ci_0043                -1.906890e-02 3 1  ON 92
ci_0044                -1.887290e-02 3 1  ON 93
ci_0045                 7.875820e-03 3 1  ON 94
ci_0046                 7.230703e-03 3 1  ON 95
ci_0047                -1.825437e-03 3 1  ON 96
ci_0048                -1.639573e-03 3 1  ON 97
ci_0049                -5.710880e-03 3 1  ON 98
ci_0050                -6.166493e-03 3 1  ON 99
ci_0051                -3.344257e-03 3 1  ON 100
ci_0052                -3.252170e-03 3 1  ON 101
ci_0053                -4.501150e-03 3 1  ON 102
ci_0054                -4.802508e-03 3 1  ON 103
ci_0055                 6.175355e-03 3 1  ON 104
ci_0056                 6.288546e-03 3 1  ON 105
ci_0057                 5.045316e-03 3 1  ON 106
ci_0058                 5.072662e-03 3 1  ON 107
ci_0059                -5.083283e-03 3 1  ON 108
ci_0060                -4.549308e-03 3 1  ON 109
ci_0061                -3.300409e-03 3 1  ON 110
ci_0062                -3.701808e-03 3 1  ON 111
ci_0063                -8.399258e-03 3 1  ON 112
ci_0064                -8.099153e-03 3 1  ON 113
ci_0065                -5.443738e-03 3 1  ON 114
ci_0066                -5.072339e-03 3 1  ON 115
ci_0067                -4.912494e-03 3 1  ON 116
ci_0068                -4.953982e-03 3 1  ON 117
ci_0069                 4.282628e-03 3 1  ON 118
ci_0070                 4.382357e-03 3 1  ON 119
ci_0071                -2.433088e-04 3 1  ON 120
ci_0072                 6.141808e-06 3 1  ON 121
ci_0073                 3.986480e-03 3 1  ON 122
ci_0074                 4.268651e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9258e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s097 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s097 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=97  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 97
    time step          = 0.05
    reference energy   = -16.9716
    reference variance = 0.21346
====================================================
  Execution time = 2.1926e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s097
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5243e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3701e-01
  Total weights = 1.951647019e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.8289e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325569252481
                                         uncertainty =       0.002921237820

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325569252481
                                         uncertainty =       0.002921237820

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403436669
  error estimate for blocks of size 2^( 2) =       0.000416693228
  error estimate for blocks of size 2^( 3) =       0.000429941883
  error estimate for blocks of size 2^( 4) =       0.000442757731
  error estimate for blocks of size 2^( 5) =       0.000453303685
  error estimate for blocks of size 2^( 6) =       0.000459938620
  error estimate for blocks of size 2^( 7) =       0.000465065607

      target function =                  N/A
              le_mean =     -16.906273393876
             les_mean =     286.159093820599
             stat err =       0.000455266411
             autocorr =       1.273445840375
              std dev =       0.570545609476
             le_variance =       0.325522292493


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690627339388e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.2622e+00, overlap shift 1.2622e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906273393877       residual = 9.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906274509741       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906274873594       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906274902990       residual = 6.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906274941332       residual = 4.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906275041962       residual = 2.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906274874545       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906274907301       residual = 4.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906274914078       residual = 2.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906274897565       residual = 6.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.2622e+00 is 2.015106e-04

solving harmonic davidson linear method for identity shift 5.0487e+00, overlap shift 5.0487e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906273393877       residual = 9.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906273705984       residual = 2.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906273816759       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906273863266       residual = 7.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906273829228       residual = 6.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906273872485       residual = 2.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906273841108       residual = 9.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906273840632       residual = 3.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906273840971       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906273841699       residual = 3.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.0487e+00 is 5.586295e-05

solving harmonic davidson linear method for identity shift 2.0195e+01, overlap shift 2.0195e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906273393877       residual = 9.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906273474292       residual = 2.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906273503571       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906273517998       residual = 8.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906273508247       residual = 6.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906273518890       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906273511797       residual = 9.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906273511289       residual = 3.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906273511211       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906273511673       residual = 3.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.0195e+01 is 1.455387e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.745873 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9133e+01
  </log>
  <optVariables href="H2O.s097.opt.xml">
   uu_0                 3.130711e-01 1 1  ON 0
   uu_1                 1.452364e-01 1 1  ON 1
   uu_2                 4.328819e-02 1 1  ON 2
   uu_3                -1.988934e-02 1 1  ON 3
   uu_4                -6.665644e-02 1 1  ON 4
   uu_5                -1.030659e-01 1 1  ON 5
   uu_6                -1.323757e-01 1 1  ON 6
   uu_7                -1.481702e-01 1 1  ON 7
   uu_8                -1.418376e-01 1 1  ON 8
   uu_9                -1.144107e-01 1 1  ON 9
   ud_0                 4.519497e-01 1 1  ON 10
   ud_1                 1.858960e-01 1 1  ON 11
   ud_2                 6.524732e-02 1 1  ON 12
   ud_3                -6.088292e-03 1 1  ON 13
   ud_4                -6.362000e-02 1 1  ON 14
   ud_5                -1.062225e-01 1 1  ON 15
   ud_6                -1.349864e-01 1 1  ON 16
   ud_7                -1.531902e-01 1 1  ON 17
   ud_8                -1.547038e-01 1 1  ON 18
   ud_9                -1.456044e-01 1 1  ON 19
   eO_0                -7.481053e-01 1 1  ON 20
   eO_1                -4.269283e-01 1 1  ON 21
   eO_2                -1.591770e-02 1 1  ON 22
   eO_3                 2.983525e-01 1 1  ON 23
   eO_4                 5.259875e-01 1 1  ON 24
   eO_5                 4.906723e-01 1 1  ON 25
   eO_6                 2.637629e-01 1 1  ON 26
   eO_7                -4.198166e-02 1 1  ON 27
   eO_8                -2.375679e-01 1 1  ON 28
   eO_9                -1.039941e-01 1 1  ON 29
  eH1_0                -2.667682e-01 1 1  ON 30
  eH1_1                -1.589575e-01 1 1  ON 31
  eH1_2                -1.086413e-01 1 1  ON 32
  eH1_3                -5.260494e-02 1 1  ON 33
  eH1_4                -2.150146e-03 1 1  ON 34
  eH1_5                 3.411891e-02 1 1  ON 35
  eH1_6                 9.776709e-02 1 1  ON 36
  eH1_7                 1.600214e-01 1 1  ON 37
  eH1_8                 1.979626e-01 1 1  ON 38
  eH1_9                 9.778577e-02 1 1  ON 39
  eH2_0                -2.651091e-01 1 1  ON 40
  eH2_1                -1.570100e-01 1 1  ON 41
  eH2_2                -1.068336e-01 1 1  ON 42
  eH2_3                -5.112574e-02 1 1  ON 43
  eH2_4                -7.186137e-04 1 1  ON 44
  eH2_5                 3.650895e-02 1 1  ON 45
  eH2_6                 9.936804e-02 1 1  ON 46
  eH2_7                 1.616485e-01 1 1  ON 47
  eH2_8                 2.021124e-01 1 1  ON 48
  eH2_9                 9.162943e-02 1 1  ON 49
ci_0001                 7.018853e-01 3 1  ON 50
ci_0002                 7.002680e-01 3 1  ON 51
ci_0003                -2.743028e-02 3 1  ON 52
ci_0004                -2.721758e-02 3 1  ON 53
ci_0005                -3.600777e-02 3 1  ON 54
ci_0006                -3.683411e-02 3 1  ON 55
ci_0007                -2.098454e-02 3 1  ON 56
ci_0008                -2.159396e-02 3 1  ON 57
ci_0009                -1.737818e-02 3 1  ON 58
ci_0010                -1.697459e-02 3 1  ON 59
ci_0011                -1.221170e-02 3 1  ON 60
ci_0012                -1.202196e-02 3 1  ON 61
ci_0013                 1.325855e-02 3 1  ON 62
ci_0014                 1.319416e-02 3 1  ON 63
ci_0015                 1.363730e-02 3 1  ON 64
ci_0016                 1.308054e-02 3 1  ON 65
ci_0017                 1.104291e-02 3 1  ON 66
ci_0018                 1.118028e-02 3 1  ON 67
ci_0019                 1.104506e-02 3 1  ON 68
ci_0020                 1.152182e-02 3 1  ON 69
ci_0021                -2.004914e-03 3 1  ON 70
ci_0022                -1.272956e-03 3 1  ON 71
ci_0023                -1.115487e-02 3 1  ON 72
ci_0024                -1.116594e-02 3 1  ON 73
ci_0025                -1.088523e-02 3 1  ON 74
ci_0026                -1.032106e-02 3 1  ON 75
ci_0027                -1.126025e-02 3 1  ON 76
ci_0028                -1.161520e-02 3 1  ON 77
ci_0029                -1.094605e-02 3 1  ON 78
ci_0030                -1.076806e-02 3 1  ON 79
ci_0031                 2.062397e-02 3 1  ON 80
ci_0032                 2.062328e-02 3 1  ON 81
ci_0033                 1.050090e-02 3 1  ON 82
ci_0034                 1.024485e-02 3 1  ON 83
ci_0035                 7.027954e-03 3 1  ON 84
ci_0036                 6.499460e-03 3 1  ON 85
ci_0037                -1.085155e-02 3 1  ON 86
ci_0038                -1.079879e-02 3 1  ON 87
ci_0039                -2.532923e-03 3 1  ON 88
ci_0040                -2.613536e-03 3 1  ON 89
ci_0041                 6.929632e-03 3 1  ON 90
ci_0042                 6.866243e-03 3 1  ON 91
ci_0043                -1.909295e-02 3 1  ON 92
ci_0044                -1.889636e-02 3 1  ON 93
ci_0045                 7.858575e-03 3 1  ON 94
ci_0046                 7.228550e-03 3 1  ON 95
ci_0047                -1.831312e-03 3 1  ON 96
ci_0048                -1.684389e-03 3 1  ON 97
ci_0049                -5.705158e-03 3 1  ON 98
ci_0050                -6.134675e-03 3 1  ON 99
ci_0051                -3.349912e-03 3 1  ON 100
ci_0052                -3.258173e-03 3 1  ON 101
ci_0053                -4.503583e-03 3 1  ON 102
ci_0054                -4.816215e-03 3 1  ON 103
ci_0055                 6.160594e-03 3 1  ON 104
ci_0056                 6.265437e-03 3 1  ON 105
ci_0057                 5.049970e-03 3 1  ON 106
ci_0058                 5.067609e-03 3 1  ON 107
ci_0059                -5.074103e-03 3 1  ON 108
ci_0060                -4.569358e-03 3 1  ON 109
ci_0061                -3.315726e-03 3 1  ON 110
ci_0062                -3.705405e-03 3 1  ON 111
ci_0063                -8.417158e-03 3 1  ON 112
ci_0064                -8.155016e-03 3 1  ON 113
ci_0065                -5.481066e-03 3 1  ON 114
ci_0066                -5.110170e-03 3 1  ON 115
ci_0067                -4.910509e-03 3 1  ON 116
ci_0068                -4.940629e-03 3 1  ON 117
ci_0069                 4.289310e-03 3 1  ON 118
ci_0070                 4.394596e-03 3 1  ON 119
ci_0071                -2.365070e-04 3 1  ON 120
ci_0072                 1.837239e-05 3 1  ON 121
ci_0073                 4.028960e-03 3 1  ON 122
ci_0074                 4.288946e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 97
    time step          = 0.05
    reference energy   = -16.9451
    reference variance = 0.227416
====================================================
  Execution time = 2.1864e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s097
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3901e-01
  Total weights = 1.9516e+06
  Execution time = 1.9183e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323724455445
                                         uncertainty =       0.002232822822

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323724455445
                                         uncertainty =       0.002232822822

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402279803
  error estimate for blocks of size 2^( 2) =       0.000415044139
  error estimate for blocks of size 2^( 3) =       0.000428108189
  error estimate for blocks of size 2^( 4) =       0.000440162047
  error estimate for blocks of size 2^( 5) =       0.000451134842
  error estimate for blocks of size 2^( 6) =       0.000459468228
  error estimate for blocks of size 2^( 7) =       0.000465465118

      target function =                  N/A
              le_mean =     -16.906048216170
             les_mean =     286.153428021798
             stat err =       0.000454057559
             autocorr =       1.273988074342
              std dev =       0.568909553000
             le_variance =       0.323658079495

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323623561072
                                         uncertainty =       0.002230696846

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323623561072
                                         uncertainty =       0.002230696846

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402217072
  error estimate for blocks of size 2^( 2) =       0.000414978072
  error estimate for blocks of size 2^( 3) =       0.000428038959
  error estimate for blocks of size 2^( 4) =       0.000440093554
  error estimate for blocks of size 2^( 5) =       0.000451065231
  error estimate for blocks of size 2^( 6) =       0.000459398604
  error estimate for blocks of size 2^( 7) =       0.000465388704

      target function =                  N/A
              le_mean =     -16.906051464974
             les_mean =     286.190191237592
             stat err =       0.000453986523
             autocorr =       1.273986778268
              std dev =       0.568820838714
             le_variance =       0.323557146555

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323664491713
                                         uncertainty =       0.002231644852

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323664491713
                                         uncertainty =       0.002231644852

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402242527
  error estimate for blocks of size 2^( 2) =       0.000415005158
  error estimate for blocks of size 2^( 3) =       0.000428067568
  error estimate for blocks of size 2^( 4) =       0.000440121254
  error estimate for blocks of size 2^( 5) =       0.000451092686
  error estimate for blocks of size 2^( 6) =       0.000459424368
  error estimate for blocks of size 2^( 7) =       0.000465419664

      target function =                  N/A
              le_mean =     -16.906049284400
             les_mean =     286.153610134614
             stat err =       0.000454014493
             autocorr =       1.273982509587
              std dev =       0.568856836439
             le_variance =       0.323598100363

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323716460970
                                         uncertainty =       0.002232666429

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323716460970
                                         uncertainty =       0.002232666429

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402274833
  error estimate for blocks of size 2^( 2) =       0.000415038951
  error estimate for blocks of size 2^( 3) =       0.000428102786
  error estimate for blocks of size 2^( 4) =       0.000440156626
  error estimate for blocks of size 2^( 5) =       0.000451129259
  error estimate for blocks of size 2^( 6) =       0.000459462441
  error estimate for blocks of size 2^( 7) =       0.000465459097

      target function =                  N/A
              le_mean =     -16.906048320854
             les_mean =     286.153439587535
             stat err =       0.000454051856
             autocorr =       1.273987546811
              std dev =       0.568902525242
             le_variance =       0.323650083227


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906048216170        initial
     1.2622e+00     1.2622e+01             2.0151e-04       -16.906051464974  <--
     5.0487e+00     5.0487e+01             5.5863e-05       -16.906049284400
     2.0195e+01     2.0195e+02             1.4554e-05       -16.906048320854

*****************************************************************************
Applying the update for shift_i =   1.2622e+00     and shift_s =   1.2622e+01
*****************************************************************************

  Execution time = 3.1552e+01
  </log>
  <optVariables href="H2O.s097.opt.xml">
   uu_0                 3.130695e-01 1 1  ON 0
   uu_1                 1.452965e-01 1 1  ON 1
   uu_2                 4.328565e-02 1 1  ON 2
   uu_3                -1.994902e-02 1 1  ON 3
   uu_4                -6.671453e-02 1 1  ON 4
   uu_5                -1.031216e-01 1 1  ON 5
   uu_6                -1.324118e-01 1 1  ON 6
   uu_7                -1.481463e-01 1 1  ON 7
   uu_8                -1.418030e-01 1 1  ON 8
   uu_9                -1.144117e-01 1 1  ON 9
   ud_0                 4.518774e-01 1 1  ON 10
   ud_1                 1.858467e-01 1 1  ON 11
   ud_2                 6.525835e-02 1 1  ON 12
   ud_3                -6.075578e-03 1 1  ON 13
   ud_4                -6.361996e-02 1 1  ON 14
   ud_5                -1.062072e-01 1 1  ON 15
   ud_6                -1.349336e-01 1 1  ON 16
   ud_7                -1.531928e-01 1 1  ON 17
   ud_8                -1.546434e-01 1 1  ON 18
   ud_9                -1.455913e-01 1 1  ON 19
   eO_0                -7.481130e-01 1 1  ON 20
   eO_1                -4.269257e-01 1 1  ON 21
   eO_2                -1.583131e-02 1 1  ON 22
   eO_3                 2.983214e-01 1 1  ON 23
   eO_4                 5.260432e-01 1 1  ON 24
   eO_5                 4.906749e-01 1 1  ON 25
   eO_6                 2.637541e-01 1 1  ON 26
   eO_7                -4.199066e-02 1 1  ON 27
   eO_8                -2.375807e-01 1 1  ON 28
   eO_9                -1.040592e-01 1 1  ON 29
  eH1_0                -2.668210e-01 1 1  ON 30
  eH1_1                -1.590316e-01 1 1  ON 31
  eH1_2                -1.086731e-01 1 1  ON 32
  eH1_3                -5.264289e-02 1 1  ON 33
  eH1_4                -2.140035e-03 1 1  ON 34
  eH1_5                 3.412642e-02 1 1  ON 35
  eH1_6                 9.776241e-02 1 1  ON 36
  eH1_7                 1.600747e-01 1 1  ON 37
  eH1_8                 1.979828e-01 1 1  ON 38
  eH1_9                 9.787404e-02 1 1  ON 39
  eH2_0                -2.651573e-01 1 1  ON 40
  eH2_1                -1.570017e-01 1 1  ON 41
  eH2_2                -1.068274e-01 1 1  ON 42
  eH2_3                -5.118384e-02 1 1  ON 43
  eH2_4                -7.271717e-04 1 1  ON 44
  eH2_5                 3.642110e-02 1 1  ON 45
  eH2_6                 9.938363e-02 1 1  ON 46
  eH2_7                 1.616510e-01 1 1  ON 47
  eH2_8                 2.021459e-01 1 1  ON 48
  eH2_9                 9.174997e-02 1 1  ON 49
ci_0001                 7.019341e-01 3 1  ON 50
ci_0002                 7.002073e-01 3 1  ON 51
ci_0003                -2.748202e-02 3 1  ON 52
ci_0004                -2.726997e-02 3 1  ON 53
ci_0005                -3.606687e-02 3 1  ON 54
ci_0006                -3.684317e-02 3 1  ON 55
ci_0007                -2.095516e-02 3 1  ON 56
ci_0008                -2.164999e-02 3 1  ON 57
ci_0009                -1.732430e-02 3 1  ON 58
ci_0010                -1.693070e-02 3 1  ON 59
ci_0011                -1.221250e-02 3 1  ON 60
ci_0012                -1.201149e-02 3 1  ON 61
ci_0013                 1.321409e-02 3 1  ON 62
ci_0014                 1.318864e-02 3 1  ON 63
ci_0015                 1.357717e-02 3 1  ON 64
ci_0016                 1.321169e-02 3 1  ON 65
ci_0017                 1.100463e-02 3 1  ON 66
ci_0018                 1.117025e-02 3 1  ON 67
ci_0019                 1.103448e-02 3 1  ON 68
ci_0020                 1.155419e-02 3 1  ON 69
ci_0021                -1.931335e-03 3 1  ON 70
ci_0022                -1.212500e-03 3 1  ON 71
ci_0023                -1.126211e-02 3 1  ON 72
ci_0024                -1.114931e-02 3 1  ON 73
ci_0025                -1.078509e-02 3 1  ON 74
ci_0026                -1.038351e-02 3 1  ON 75
ci_0027                -1.121283e-02 3 1  ON 76
ci_0028                -1.158540e-02 3 1  ON 77
ci_0029                -1.093936e-02 3 1  ON 78
ci_0030                -1.074415e-02 3 1  ON 79
ci_0031                 2.060196e-02 3 1  ON 80
ci_0032                 2.067435e-02 3 1  ON 81
ci_0033                 1.050201e-02 3 1  ON 82
ci_0034                 1.039285e-02 3 1  ON 83
ci_0035                 6.917795e-03 3 1  ON 84
ci_0036                 6.437026e-03 3 1  ON 85
ci_0037                -1.077496e-02 3 1  ON 86
ci_0038                -1.081728e-02 3 1  ON 87
ci_0039                -2.536928e-03 3 1  ON 88
ci_0040                -2.658055e-03 3 1  ON 89
ci_0041                 6.874564e-03 3 1  ON 90
ci_0042                 6.923054e-03 3 1  ON 91
ci_0043                -1.915934e-02 3 1  ON 92
ci_0044                -1.896007e-02 3 1  ON 93
ci_0045                 7.812430e-03 3 1  ON 94
ci_0046                 7.222828e-03 3 1  ON 95
ci_0047                -1.845373e-03 3 1  ON 96
ci_0048                -1.790519e-03 3 1  ON 97
ci_0049                -5.691127e-03 3 1  ON 98
ci_0050                -6.053672e-03 3 1  ON 99
ci_0051                -3.363432e-03 3 1  ON 100
ci_0052                -3.271686e-03 3 1  ON 101
ci_0053                -4.509428e-03 3 1  ON 102
ci_0054                -4.849823e-03 3 1  ON 103
ci_0055                 6.122140e-03 3 1  ON 104
ci_0056                 6.203862e-03 3 1  ON 105
ci_0057                 5.062734e-03 3 1  ON 106
ci_0058                 5.054440e-03 3 1  ON 107
ci_0059                -5.051771e-03 3 1  ON 108
ci_0060                -4.618760e-03 3 1  ON 109
ci_0061                -3.354931e-03 3 1  ON 110
ci_0062                -3.714025e-03 3 1  ON 111
ci_0063                -8.460954e-03 3 1  ON 112
ci_0064                -8.291704e-03 3 1  ON 113
ci_0065                -5.575482e-03 3 1  ON 114
ci_0066                -5.205582e-03 3 1  ON 115
ci_0067                -4.905662e-03 3 1  ON 116
ci_0068                -4.908910e-03 3 1  ON 117
ci_0069                 4.305929e-03 3 1  ON 118
ci_0070                 4.423976e-03 3 1  ON 119
ci_0071                -2.189129e-04 3 1  ON 120
ci_0072                 4.934010e-05 3 1  ON 121
ci_0073                 4.130475e-03 3 1  ON 122
ci_0074                 4.337437e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.0691e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s098 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s098 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=98  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 98
    time step          = 0.05
    reference energy   = -16.8835
    reference variance = 0.209793
====================================================
  Execution time = 2.1608e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s098
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5222e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4043e-01
  Total weights = 1.952210910e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0352e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329086483964
                                         uncertainty =       0.002638464643

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329086483964
                                         uncertainty =       0.002638464643

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405641312
  error estimate for blocks of size 2^( 2) =       0.000418645599
  error estimate for blocks of size 2^( 3) =       0.000432120511
  error estimate for blocks of size 2^( 4) =       0.000444856646
  error estimate for blocks of size 2^( 5) =       0.000457098628
  error estimate for blocks of size 2^( 6) =       0.000464422512
  error estimate for blocks of size 2^( 7) =       0.000472341846

      target function =                  N/A
              le_mean =     -16.906565591975
             les_mean =     286.172386165977
             stat err =       0.000459679908
             autocorr =       1.284182317886
              std dev =       0.573663444859
             le_variance =       0.329089747968


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690656559198e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.1554e-01, overlap shift 3.1554e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906565591970       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906572283163       residual = 4.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906570506465       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906571198559       residual = 7.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906571098673       residual = 4.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906570915092       residual = 8.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906571075859       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906571051706       residual = 9.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906571131272       residual = 4.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906570830927       residual = 2.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906571069490       residual = 8.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.1554e-01 is 7.713831e-04

solving harmonic davidson linear method for identity shift 1.2622e+00, overlap shift 1.2622e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906565591970       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906568060425       residual = 3.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906567784721       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906567933433       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906568148363       residual = 6.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906567998296       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906567999769       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906567974831       residual = 4.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906567984796       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906567910888       residual = 5.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.2622e+00 is 2.757545e-04

solving harmonic davidson linear method for identity shift 5.0487e+00, overlap shift 5.0487e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906565591970       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906566292369       residual = 3.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906566253138       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906566304292       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906566383500       residual = 6.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906566338874       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906566335033       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906566321924       residual = 4.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906566329172       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906566307752       residual = 3.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.0487e+00 is 7.746833e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.750128 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7651e+01
  </log>
  <optVariables href="H2O.s098.opt.xml">
   uu_0                 3.131182e-01 1 1  ON 0
   uu_1                 1.453525e-01 1 1  ON 1
   uu_2                 4.324929e-02 1 1  ON 2
   uu_3                -1.999761e-02 1 1  ON 3
   uu_4                -6.679032e-02 1 1  ON 4
   uu_5                -1.032038e-01 1 1  ON 5
   uu_6                -1.324655e-01 1 1  ON 6
   uu_7                -1.481723e-01 1 1  ON 7
   uu_8                -1.417648e-01 1 1  ON 8
   uu_9                -1.143688e-01 1 1  ON 9
   ud_0                 4.517968e-01 1 1  ON 10
   ud_1                 1.858555e-01 1 1  ON 11
   ud_2                 6.529566e-02 1 1  ON 12
   ud_3                -6.100957e-03 1 1  ON 13
   ud_4                -6.363096e-02 1 1  ON 14
   ud_5                -1.061939e-01 1 1  ON 15
   ud_6                -1.350116e-01 1 1  ON 16
   ud_7                -1.532185e-01 1 1  ON 17
   ud_8                -1.545449e-01 1 1  ON 18
   ud_9                -1.454676e-01 1 1  ON 19
   eO_0                -7.481073e-01 1 1  ON 20
   eO_1                -4.269009e-01 1 1  ON 21
   eO_2                -1.581580e-02 1 1  ON 22
   eO_3                 2.983552e-01 1 1  ON 23
   eO_4                 5.260644e-01 1 1  ON 24
   eO_5                 4.906472e-01 1 1  ON 25
   eO_6                 2.637728e-01 1 1  ON 26
   eO_7                -4.196778e-02 1 1  ON 27
   eO_8                -2.375995e-01 1 1  ON 28
   eO_9                -1.041345e-01 1 1  ON 29
  eH1_0                -2.669138e-01 1 1  ON 30
  eH1_1                -1.590254e-01 1 1  ON 31
  eH1_2                -1.087919e-01 1 1  ON 32
  eH1_3                -5.267470e-02 1 1  ON 33
  eH1_4                -2.221555e-03 1 1  ON 34
  eH1_5                 3.414848e-02 1 1  ON 35
  eH1_6                 9.773653e-02 1 1  ON 36
  eH1_7                 1.601361e-01 1 1  ON 37
  eH1_8                 1.980507e-01 1 1  ON 38
  eH1_9                 9.804488e-02 1 1  ON 39
  eH2_0                -2.651915e-01 1 1  ON 40
  eH2_1                -1.570880e-01 1 1  ON 41
  eH2_2                -1.069728e-01 1 1  ON 42
  eH2_3                -5.114568e-02 1 1  ON 43
  eH2_4                -7.853228e-04 1 1  ON 44
  eH2_5                 3.641391e-02 1 1  ON 45
  eH2_6                 9.940758e-02 1 1  ON 46
  eH2_7                 1.617110e-01 1 1  ON 47
  eH2_8                 2.022362e-01 1 1  ON 48
  eH2_9                 9.186472e-02 1 1  ON 49
ci_0001                 7.019013e-01 3 1  ON 50
ci_0002                 7.002209e-01 3 1  ON 51
ci_0003                -2.742946e-02 3 1  ON 52
ci_0004                -2.730559e-02 3 1  ON 53
ci_0005                -3.616096e-02 3 1  ON 54
ci_0006                -3.696679e-02 3 1  ON 55
ci_0007                -2.104193e-02 3 1  ON 56
ci_0008                -2.158542e-02 3 1  ON 57
ci_0009                -1.744072e-02 3 1  ON 58
ci_0010                -1.686210e-02 3 1  ON 59
ci_0011                -1.221133e-02 3 1  ON 60
ci_0012                -1.196739e-02 3 1  ON 61
ci_0013                 1.333335e-02 3 1  ON 62
ci_0014                 1.314473e-02 3 1  ON 63
ci_0015                 1.356941e-02 3 1  ON 64
ci_0016                 1.323358e-02 3 1  ON 65
ci_0017                 1.101099e-02 3 1  ON 66
ci_0018                 1.123350e-02 3 1  ON 67
ci_0019                 1.108108e-02 3 1  ON 68
ci_0020                 1.127844e-02 3 1  ON 69
ci_0021                -1.893945e-03 3 1  ON 70
ci_0022                -1.236646e-03 3 1  ON 71
ci_0023                -1.128160e-02 3 1  ON 72
ci_0024                -1.112524e-02 3 1  ON 73
ci_0025                -1.066070e-02 3 1  ON 74
ci_0026                -1.028381e-02 3 1  ON 75
ci_0027                -1.129330e-02 3 1  ON 76
ci_0028                -1.148217e-02 3 1  ON 77
ci_0029                -1.102598e-02 3 1  ON 78
ci_0030                -1.088886e-02 3 1  ON 79
ci_0031                 2.063163e-02 3 1  ON 80
ci_0032                 2.073163e-02 3 1  ON 81
ci_0033                 1.043511e-02 3 1  ON 82
ci_0034                 1.039157e-02 3 1  ON 83
ci_0035                 7.076591e-03 3 1  ON 84
ci_0036                 6.353599e-03 3 1  ON 85
ci_0037                -1.072816e-02 3 1  ON 86
ci_0038                -1.082742e-02 3 1  ON 87
ci_0039                -2.487340e-03 3 1  ON 88
ci_0040                -2.698689e-03 3 1  ON 89
ci_0041                 6.984314e-03 3 1  ON 90
ci_0042                 6.972980e-03 3 1  ON 91
ci_0043                -1.917792e-02 3 1  ON 92
ci_0044                -1.904900e-02 3 1  ON 93
ci_0045                 7.805971e-03 3 1  ON 94
ci_0046                 7.332589e-03 3 1  ON 95
ci_0047                -1.729962e-03 3 1  ON 96
ci_0048                -1.831020e-03 3 1  ON 97
ci_0049                -5.685637e-03 3 1  ON 98
ci_0050                -5.987508e-03 3 1  ON 99
ci_0051                -3.329586e-03 3 1  ON 100
ci_0052                -3.418355e-03 3 1  ON 101
ci_0053                -4.535073e-03 3 1  ON 102
ci_0054                -4.684840e-03 3 1  ON 103
ci_0055                 6.027028e-03 3 1  ON 104
ci_0056                 6.257778e-03 3 1  ON 105
ci_0057                 5.051290e-03 3 1  ON 106
ci_0058                 5.025606e-03 3 1  ON 107
ci_0059                -5.001457e-03 3 1  ON 108
ci_0060                -4.605893e-03 3 1  ON 109
ci_0061                -3.341144e-03 3 1  ON 110
ci_0062                -3.771335e-03 3 1  ON 111
ci_0063                -8.631900e-03 3 1  ON 112
ci_0064                -8.481286e-03 3 1  ON 113
ci_0065                -5.512015e-03 3 1  ON 114
ci_0066                -5.155629e-03 3 1  ON 115
ci_0067                -4.925335e-03 3 1  ON 116
ci_0068                -4.810232e-03 3 1  ON 117
ci_0069                 4.419090e-03 3 1  ON 118
ci_0070                 4.434185e-03 3 1  ON 119
ci_0071                -1.391281e-04 3 1  ON 120
ci_0072                 4.006989e-05 3 1  ON 121
ci_0073                 4.106277e-03 3 1  ON 122
ci_0074                 4.387885e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 98
    time step          = 0.05
    reference energy   = -16.961
    reference variance = 0.383717
====================================================
  Execution time = 2.1785e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s098
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3876e-01
  Total weights = 1.9515e+06
  Execution time = 1.9065e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324170058470
                                         uncertainty =       0.002253215083

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324170058470
                                         uncertainty =       0.002253215083

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402558547
  error estimate for blocks of size 2^( 2) =       0.000415551476
  error estimate for blocks of size 2^( 3) =       0.000429006479
  error estimate for blocks of size 2^( 4) =       0.000442584043
  error estimate for blocks of size 2^( 5) =       0.000454461706
  error estimate for blocks of size 2^( 6) =       0.000464549928
  error estimate for blocks of size 2^( 7) =       0.000468957629

      target function =                  N/A
              le_mean =     -16.906399289808
             les_mean =     286.165901812257
             stat err =       0.000457638326
             autocorr =       1.292369423364
              std dev =       0.569303756185
             le_variance =       0.324106766806

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324046128523
                                         uncertainty =       0.002273336554

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324046128523
                                         uncertainty =       0.002273336554

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402481197
  error estimate for blocks of size 2^( 2) =       0.000415473358
  error estimate for blocks of size 2^( 3) =       0.000428918073
  error estimate for blocks of size 2^( 4) =       0.000442495121
  error estimate for blocks of size 2^( 5) =       0.000454350625
  error estimate for blocks of size 2^( 6) =       0.000464440409
  error estimate for blocks of size 2^( 7) =       0.000468859948

      target function =                  N/A
              le_mean =     -16.906399597387
             les_mean =     286.168347785622
             stat err =       0.000457536526
             autocorr =       1.292291084448
              std dev =       0.569194367426
             le_variance =       0.323982227910

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324029697970
                                         uncertainty =       0.002268065568

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324029697970
                                         uncertainty =       0.002268065568

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402471090
  error estimate for blocks of size 2^( 2) =       0.000415463897
  error estimate for blocks of size 2^( 3) =       0.000428911955
  error estimate for blocks of size 2^( 4) =       0.000442490001
  error estimate for blocks of size 2^( 5) =       0.000454351895
  error estimate for blocks of size 2^( 6) =       0.000464445358
  error estimate for blocks of size 2^( 7) =       0.000468860184

      target function =                  N/A
              le_mean =     -16.906398269203
             les_mean =     286.165047106740
             stat err =       0.000457536859
             autocorr =       1.292357874923
              std dev =       0.569180074021
             le_variance =       0.323965956663

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324143032562
                                         uncertainty =       0.002255212576

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324143032562
                                         uncertainty =       0.002255212576

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402541723
  error estimate for blocks of size 2^( 2) =       0.000415534671
  error estimate for blocks of size 2^( 3) =       0.000428988727
  error estimate for blocks of size 2^( 4) =       0.000442566628
  error estimate for blocks of size 2^( 5) =       0.000454442125
  error estimate for blocks of size 2^( 6) =       0.000464531681
  error estimate for blocks of size 2^( 7) =       0.000468940399

      target function =                  N/A
              le_mean =     -16.906398528502
             les_mean =     286.165270055314
             stat err =       0.000457620208
             autocorr =       1.292375110290
              std dev =       0.569279964663
             le_variance =       0.324079678167


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906399289808        initial
     3.1554e-01     3.1554e+00             7.7138e-04       -16.906399597387  <--
     1.2622e+00     1.2622e+01             2.7575e-04       -16.906398269203
     5.0487e+00     5.0487e+01             7.7468e-05       -16.906398528502

*****************************************************************************
Applying the update for shift_i =   3.1554e-01     and shift_s =   3.1554e+00
*****************************************************************************

  Execution time = 3.1436e+01
  </log>
  <optVariables href="H2O.s098.opt.xml">
   uu_0                 3.132380e-01 1 1  ON 0
   uu_1                 1.454218e-01 1 1  ON 1
   uu_2                 4.319245e-02 1 1  ON 2
   uu_3                -2.011270e-02 1 1  ON 3
   uu_4                -6.695141e-02 1 1  ON 4
   uu_5                -1.033967e-01 1 1  ON 5
   uu_6                -1.326191e-01 1 1  ON 6
   uu_7                -1.482883e-01 1 1  ON 7
   uu_8                -1.416895e-01 1 1  ON 8
   uu_9                -1.142495e-01 1 1  ON 9
   ud_0                 4.516944e-01 1 1  ON 10
   ud_1                 1.858578e-01 1 1  ON 11
   ud_2                 6.532287e-02 1 1  ON 12
   ud_3                -6.147596e-03 1 1  ON 13
   ud_4                -6.367175e-02 1 1  ON 14
   ud_5                -1.062246e-01 1 1  ON 15
   ud_6                -1.351432e-01 1 1  ON 16
   ud_7                -1.533145e-01 1 1  ON 17
   ud_8                -1.543084e-01 1 1  ON 18
   ud_9                -1.451062e-01 1 1  ON 19
   eO_0                -7.480430e-01 1 1  ON 20
   eO_1                -4.268435e-01 1 1  ON 21
   eO_2                -1.575093e-02 1 1  ON 22
   eO_3                 2.984208e-01 1 1  ON 23
   eO_4                 5.261106e-01 1 1  ON 24
   eO_5                 4.905835e-01 1 1  ON 25
   eO_6                 2.638329e-01 1 1  ON 26
   eO_7                -4.191235e-02 1 1  ON 27
   eO_8                -2.376610e-01 1 1  ON 28
   eO_9                -1.043611e-01 1 1  ON 29
  eH1_0                -2.671748e-01 1 1  ON 30
  eH1_1                -1.590930e-01 1 1  ON 31
  eH1_2                -1.090613e-01 1 1  ON 32
  eH1_3                -5.279577e-02 1 1  ON 33
  eH1_4                -2.427070e-03 1 1  ON 34
  eH1_5                 3.417814e-02 1 1  ON 35
  eH1_6                 9.766468e-02 1 1  ON 36
  eH1_7                 1.603217e-01 1 1  ON 37
  eH1_8                 1.982513e-01 1 1  ON 38
  eH1_9                 9.855774e-02 1 1  ON 39
  eH2_0                -2.653369e-01 1 1  ON 40
  eH2_1                -1.573157e-01 1 1  ON 41
  eH2_2                -1.072847e-01 1 1  ON 42
  eH2_3                -5.114819e-02 1 1  ON 43
  eH2_4                -9.093014e-04 1 1  ON 44
  eH2_5                 3.636814e-02 1 1  ON 45
  eH2_6                 9.946584e-02 1 1  ON 46
  eH2_7                 1.618862e-01 1 1  ON 47
  eH2_8                 2.025029e-01 1 1  ON 48
  eH2_9                 9.220948e-02 1 1  ON 49
ci_0001                 7.018252e-01 3 1  ON 50
ci_0002                 7.002592e-01 3 1  ON 51
ci_0003                -2.731445e-02 3 1  ON 52
ci_0004                -2.736810e-02 3 1  ON 53
ci_0005                -3.636136e-02 3 1  ON 54
ci_0006                -3.723439e-02 3 1  ON 55
ci_0007                -2.124456e-02 3 1  ON 56
ci_0008                -2.143204e-02 3 1  ON 57
ci_0009                -1.763255e-02 3 1  ON 58
ci_0010                -1.674539e-02 3 1  ON 59
ci_0011                -1.219711e-02 3 1  ON 60
ci_0012                -1.188821e-02 3 1  ON 61
ci_0013                 1.353852e-02 3 1  ON 62
ci_0014                 1.306622e-02 3 1  ON 63
ci_0015                 1.354357e-02 3 1  ON 64
ci_0016                 1.327385e-02 3 1  ON 65
ci_0017                 1.101507e-02 3 1  ON 66
ci_0018                 1.134166e-02 3 1  ON 67
ci_0019                 1.116407e-02 3 1  ON 68
ci_0020                 1.078281e-02 3 1  ON 69
ci_0021                -1.801321e-03 3 1  ON 70
ci_0022                -1.277793e-03 3 1  ON 71
ci_0023                -1.130769e-02 3 1  ON 72
ci_0024                -1.109526e-02 3 1  ON 73
ci_0025                -1.043794e-02 3 1  ON 74
ci_0026                -1.010739e-02 3 1  ON 75
ci_0027                -1.142950e-02 3 1  ON 76
ci_0028                -1.130795e-02 3 1  ON 77
ci_0029                -1.118218e-02 3 1  ON 78
ci_0030                -1.116097e-02 3 1  ON 79
ci_0031                 2.069701e-02 3 1  ON 80
ci_0032                 2.085574e-02 3 1  ON 81
ci_0033                 1.028741e-02 3 1  ON 82
ci_0034                 1.039247e-02 3 1  ON 83
ci_0035                 7.373635e-03 3 1  ON 84
ci_0036                 6.193341e-03 3 1  ON 85
ci_0037                -1.063110e-02 3 1  ON 86
ci_0038                -1.084092e-02 3 1  ON 87
ci_0039                -2.416740e-03 3 1  ON 88
ci_0040                -2.754563e-03 3 1  ON 89
ci_0041                 7.174351e-03 3 1  ON 90
ci_0042                 7.062482e-03 3 1  ON 91
ci_0043                -1.921353e-02 3 1  ON 92
ci_0044                -1.924944e-02 3 1  ON 93
ci_0045                 7.791236e-03 3 1  ON 94
ci_0046                 7.558879e-03 3 1  ON 95
ci_0047                -1.563355e-03 3 1  ON 96
ci_0048                -1.886556e-03 3 1  ON 97
ci_0049                -5.671551e-03 3 1  ON 98
ci_0050                -5.872301e-03 3 1  ON 99
ci_0051                -3.277863e-03 3 1  ON 100
ci_0052                -3.635114e-03 3 1  ON 101
ci_0053                -4.573023e-03 3 1  ON 102
ci_0054                -4.437405e-03 3 1  ON 103
ci_0055                 5.835986e-03 3 1  ON 104
ci_0056                 6.366224e-03 3 1  ON 105
ci_0057                 5.027237e-03 3 1  ON 106
ci_0058                 4.969047e-03 3 1  ON 107
ci_0059                -4.927332e-03 3 1  ON 108
ci_0060                -4.588919e-03 3 1  ON 109
ci_0061                -3.315057e-03 3 1  ON 110
ci_0062                -3.877361e-03 3 1  ON 111
ci_0063                -8.900479e-03 3 1  ON 112
ci_0064                -8.777506e-03 3 1  ON 113
ci_0065                -5.400668e-03 3 1  ON 114
ci_0066                -5.069793e-03 3 1  ON 115
ci_0067                -4.954885e-03 3 1  ON 116
ci_0068                -4.667198e-03 3 1  ON 117
ci_0069                 4.581882e-03 3 1  ON 118
ci_0070                 4.446808e-03 3 1  ON 119
ci_0071                 1.123784e-05 3 1  ON 120
ci_0072                 7.278098e-06 3 1  ON 121
ci_0073                 4.067531e-03 3 1  ON 122
ci_0074                 4.456616e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9093e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s099 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s099 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=99  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 99
    time step          = 0.05
    reference energy   = -16.8971
    reference variance = 0.125213
====================================================
  Execution time = 2.1554e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s099
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5222e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3721e-01
  Total weights = 1.951811550e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0137e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325389429388
                                         uncertainty =       0.002774566656

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325389429388
                                         uncertainty =       0.002774566656

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403301118
  error estimate for blocks of size 2^( 2) =       0.000416421132
  error estimate for blocks of size 2^( 3) =       0.000430042823
  error estimate for blocks of size 2^( 4) =       0.000442700196
  error estimate for blocks of size 2^( 5) =       0.000453899076
  error estimate for blocks of size 2^( 6) =       0.000462109185
  error estimate for blocks of size 2^( 7) =       0.000468010500

      target function =                  N/A
              le_mean =     -16.906498228031
             les_mean =     286.166892947119
             stat err =       0.000456679739
             autocorr =       1.282226171898
              std dev =       0.570353910520
             le_variance =       0.325303583245


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690649822803e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 7.8886e-02, overlap shift 7.8886e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906498228037       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906496197205       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906499917299       residual = 7.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906501776545       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906501282608       residual = 5.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906502924868       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906502857572       residual = 8.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906505306543       residual = 5.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906506626318       residual = 3.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906506598784       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906506485022       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906506183174       residual = 7.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906505836789       residual = 4.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906505710566       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906505465697       residual = 7.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         14 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 7.8886e-02 is 2.834826e-03

solving harmonic davidson linear method for identity shift 3.1554e-01, overlap shift 3.1554e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906498228037       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906497120090       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906498158490       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906499027441       residual = 4.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906498600257       residual = 5.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906499491126       residual = 6.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906499543548       residual = 2.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906499900081       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906499990888       residual = 3.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906499949908       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906499925411       residual = 8.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.1554e-01 is 6.936418e-04

solving harmonic davidson linear method for identity shift 1.2622e+00, overlap shift 1.2622e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906498228037       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906497834834       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906498039811       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906498122365       residual = 4.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906497907422       residual = 5.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906498098298       residual = 3.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906498167557       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906498227968       residual = 2.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906498225644       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906498247997       residual = 4.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.2622e+00 is 1.833846e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.755796 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7577e+01
  </log>
  <optVariables href="H2O.s099.opt.xml">
   uu_0                 3.132814e-01 1 1  ON 0
   uu_1                 1.453533e-01 1 1  ON 1
   uu_2                 4.307055e-02 1 1  ON 2
   uu_3                -2.000873e-02 1 1  ON 3
   uu_4                -6.683446e-02 1 1  ON 4
   uu_5                -1.034482e-01 1 1  ON 5
   uu_6                -1.326198e-01 1 1  ON 6
   uu_7                -1.484251e-01 1 1  ON 7
   uu_8                -1.417559e-01 1 1  ON 8
   uu_9                -1.144870e-01 1 1  ON 9
   ud_0                 4.518067e-01 1 1  ON 10
   ud_1                 1.857996e-01 1 1  ON 11
   ud_2                 6.538343e-02 1 1  ON 12
   ud_3                -6.074047e-03 1 1  ON 13
   ud_4                -6.369817e-02 1 1  ON 14
   ud_5                -1.062766e-01 1 1  ON 15
   ud_6                -1.351934e-01 1 1  ON 16
   ud_7                -1.530637e-01 1 1  ON 17
   ud_8                -1.544554e-01 1 1  ON 18
   ud_9                -1.451001e-01 1 1  ON 19
   eO_0                -7.478240e-01 1 1  ON 20
   eO_1                -4.267679e-01 1 1  ON 21
   eO_2                -1.569306e-02 1 1  ON 22
   eO_3                 2.982773e-01 1 1  ON 23
   eO_4                 5.262496e-01 1 1  ON 24
   eO_5                 4.909112e-01 1 1  ON 25
   eO_6                 2.638877e-01 1 1  ON 26
   eO_7                -4.190032e-02 1 1  ON 27
   eO_8                -2.379038e-01 1 1  ON 28
   eO_9                -1.047800e-01 1 1  ON 29
  eH1_0                -2.676323e-01 1 1  ON 30
  eH1_1                -1.591576e-01 1 1  ON 31
  eH1_2                -1.092265e-01 1 1  ON 32
  eH1_3                -5.299585e-02 1 1  ON 33
  eH1_4                -2.382142e-03 1 1  ON 34
  eH1_5                 3.400633e-02 1 1  ON 35
  eH1_6                 9.770469e-02 1 1  ON 36
  eH1_7                 1.603156e-01 1 1  ON 37
  eH1_8                 1.985851e-01 1 1  ON 38
  eH1_9                 9.911716e-02 1 1  ON 39
  eH2_0                -2.653712e-01 1 1  ON 40
  eH2_1                -1.573832e-01 1 1  ON 41
  eH2_2                -1.072761e-01 1 1  ON 42
  eH2_3                -5.143276e-02 1 1  ON 43
  eH2_4                -1.029800e-03 1 1  ON 44
  eH2_5                 3.597648e-02 1 1  ON 45
  eH2_6                 9.916251e-02 1 1  ON 46
  eH2_7                 1.619369e-01 1 1  ON 47
  eH2_8                 2.028288e-01 1 1  ON 48
  eH2_9                 9.290312e-02 1 1  ON 49
ci_0001                 7.018106e-01 3 1  ON 50
ci_0002                 7.003525e-01 3 1  ON 51
ci_0003                -2.708797e-02 3 1  ON 52
ci_0004                -2.737070e-02 3 1  ON 53
ci_0005                -3.626623e-02 3 1  ON 54
ci_0006                -3.664273e-02 3 1  ON 55
ci_0007                -2.080416e-02 3 1  ON 56
ci_0008                -2.090680e-02 3 1  ON 57
ci_0009                -1.762548e-02 3 1  ON 58
ci_0010                -1.679179e-02 3 1  ON 59
ci_0011                -1.248721e-02 3 1  ON 60
ci_0012                -1.207066e-02 3 1  ON 61
ci_0013                 1.305876e-02 3 1  ON 62
ci_0014                 1.335140e-02 3 1  ON 63
ci_0015                 1.382548e-02 3 1  ON 64
ci_0016                 1.331383e-02 3 1  ON 65
ci_0017                 1.074750e-02 3 1  ON 66
ci_0018                 1.156704e-02 3 1  ON 67
ci_0019                 1.117513e-02 3 1  ON 68
ci_0020                 1.099960e-02 3 1  ON 69
ci_0021                -1.891813e-03 3 1  ON 70
ci_0022                -1.126723e-03 3 1  ON 71
ci_0023                -1.102940e-02 3 1  ON 72
ci_0024                -1.114808e-02 3 1  ON 73
ci_0025                -1.070034e-02 3 1  ON 74
ci_0026                -1.010788e-02 3 1  ON 75
ci_0027                -1.131303e-02 3 1  ON 76
ci_0028                -1.099730e-02 3 1  ON 77
ci_0029                -1.135985e-02 3 1  ON 78
ci_0030                -1.070128e-02 3 1  ON 79
ci_0031                 2.086089e-02 3 1  ON 80
ci_0032                 2.055027e-02 3 1  ON 81
ci_0033                 1.010488e-02 3 1  ON 82
ci_0034                 9.889391e-03 3 1  ON 83
ci_0035                 7.233854e-03 3 1  ON 84
ci_0036                 6.604356e-03 3 1  ON 85
ci_0037                -1.053983e-02 3 1  ON 86
ci_0038                -1.116327e-02 3 1  ON 87
ci_0039                -2.650799e-03 3 1  ON 88
ci_0040                -2.743120e-03 3 1  ON 89
ci_0041                 7.328414e-03 3 1  ON 90
ci_0042                 7.372385e-03 3 1  ON 91
ci_0043                -1.920113e-02 3 1  ON 92
ci_0044                -1.914251e-02 3 1  ON 93
ci_0045                 7.710785e-03 3 1  ON 94
ci_0046                 7.252718e-03 3 1  ON 95
ci_0047                -1.825391e-03 3 1  ON 96
ci_0048                -1.835269e-03 3 1  ON 97
ci_0049                -5.701391e-03 3 1  ON 98
ci_0050                -5.787876e-03 3 1  ON 99
ci_0051                -3.549010e-03 3 1  ON 100
ci_0052                -3.796321e-03 3 1  ON 101
ci_0053                -4.516888e-03 3 1  ON 102
ci_0054                -4.535293e-03 3 1  ON 103
ci_0055                 5.851064e-03 3 1  ON 104
ci_0056                 6.261133e-03 3 1  ON 105
ci_0057                 5.350040e-03 3 1  ON 106
ci_0058                 5.107541e-03 3 1  ON 107
ci_0059                -5.024637e-03 3 1  ON 108
ci_0060                -4.299293e-03 3 1  ON 109
ci_0061                -3.299271e-03 3 1  ON 110
ci_0062                -3.505002e-03 3 1  ON 111
ci_0063                -8.907034e-03 3 1  ON 112
ci_0064                -8.713758e-03 3 1  ON 113
ci_0065                -5.452130e-03 3 1  ON 114
ci_0066                -5.193518e-03 3 1  ON 115
ci_0067                -5.206737e-03 3 1  ON 116
ci_0068                -4.763041e-03 3 1  ON 117
ci_0069                 4.355593e-03 3 1  ON 118
ci_0070                 4.481844e-03 3 1  ON 119
ci_0071                 1.356371e-04 3 1  ON 120
ci_0072                -4.313279e-04 3 1  ON 121
ci_0073                 4.314583e-03 3 1  ON 122
ci_0074                 4.263038e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 99
    time step          = 0.05
    reference energy   = -16.9486
    reference variance = 0.308632
====================================================
  Execution time = 2.1567e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s099
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3377e-01
  Total weights = 1.9518e+06
  Execution time = 1.9077e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320732306643
                                         uncertainty =       0.001956321241

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320732306643
                                         uncertainty =       0.001956321241

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400502843
  error estimate for blocks of size 2^( 2) =       0.000413366123
  error estimate for blocks of size 2^( 3) =       0.000425836829
  error estimate for blocks of size 2^( 4) =       0.000438265522
  error estimate for blocks of size 2^( 5) =       0.000450509864
  error estimate for blocks of size 2^( 6) =       0.000458350049
  error estimate for blocks of size 2^( 7) =       0.000462291173

      target function =                  N/A
              le_mean =     -16.906817018621
             les_mean =     286.176495908330
             stat err =       0.000452354152
             autocorr =       1.275692359821
              std dev =       0.566396552590
             le_variance =       0.320805054786

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321140749418
                                         uncertainty =       0.001976024868

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321140749418
                                         uncertainty =       0.001976024868

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400756833
  error estimate for blocks of size 2^( 2) =       0.000413615233
  error estimate for blocks of size 2^( 3) =       0.000426070543
  error estimate for blocks of size 2^( 4) =       0.000438471243
  error estimate for blocks of size 2^( 5) =       0.000450688621
  error estimate for blocks of size 2^( 6) =       0.000458528102
  error estimate for blocks of size 2^( 7) =       0.000462410265

      target function =                  N/A
              le_mean =     -16.906801098265
             les_mean =     286.174665947265
             stat err =       0.000452524558
             autocorr =       1.275035957234
              std dev =       0.566755748817
             le_variance =       0.321212078817

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321342995904
                                         uncertainty =       0.001973281208

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321342995904
                                         uncertainty =       0.001973281208

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400882779
  error estimate for blocks of size 2^( 2) =       0.000413737520
  error estimate for blocks of size 2^( 3) =       0.000426189469
  error estimate for blocks of size 2^( 4) =       0.000438584185
  error estimate for blocks of size 2^( 5) =       0.000450794878
  error estimate for blocks of size 2^( 6) =       0.000458631752
  error estimate for blocks of size 2^( 7) =       0.000462503444

      target function =                  N/A
              le_mean =     -16.906799963942
             les_mean =     286.179099485247
             stat err =       0.000452628565
             autocorr =       1.274820729253
              std dev =       0.566933862323
             le_variance =       0.321414004248

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320834620895
                                         uncertainty =       0.001958580700

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320834620895
                                         uncertainty =       0.001958580700

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400566514
  error estimate for blocks of size 2^( 2) =       0.000413428753
  error estimate for blocks of size 2^( 3) =       0.000425893175
  error estimate for blocks of size 2^( 4) =       0.000438309698
  error estimate for blocks of size 2^( 5) =       0.000450548253
  error estimate for blocks of size 2^( 6) =       0.000458384800
  error estimate for blocks of size 2^( 7) =       0.000462318170

      target function =                  N/A
              le_mean =     -16.906806432440
             les_mean =     286.174427381241
             stat err =       0.000452390230
             autocorr =       1.275490278117
              std dev =       0.566486597153
             le_variance =       0.320907064754


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906817018621        initial  <--
     7.8886e-02     7.8886e-01             2.8348e-03       -16.906801098265
     3.1554e-01     3.1554e+00             6.9364e-04       -16.906799963942
     1.2622e+00     1.2622e+01             1.8338e-04       -16.906806432440

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.2156
  </log>
  <optVariables href="H2O.s099.opt.xml">
   uu_0                 3.132380e-01 1 1  ON 0
   uu_1                 1.454218e-01 1 1  ON 1
   uu_2                 4.319245e-02 1 1  ON 2
   uu_3                -2.011270e-02 1 1  ON 3
   uu_4                -6.695141e-02 1 1  ON 4
   uu_5                -1.033967e-01 1 1  ON 5
   uu_6                -1.326191e-01 1 1  ON 6
   uu_7                -1.482883e-01 1 1  ON 7
   uu_8                -1.416895e-01 1 1  ON 8
   uu_9                -1.142495e-01 1 1  ON 9
   ud_0                 4.516944e-01 1 1  ON 10
   ud_1                 1.858578e-01 1 1  ON 11
   ud_2                 6.532287e-02 1 1  ON 12
   ud_3                -6.147596e-03 1 1  ON 13
   ud_4                -6.367175e-02 1 1  ON 14
   ud_5                -1.062246e-01 1 1  ON 15
   ud_6                -1.351432e-01 1 1  ON 16
   ud_7                -1.533145e-01 1 1  ON 17
   ud_8                -1.543084e-01 1 1  ON 18
   ud_9                -1.451062e-01 1 1  ON 19
   eO_0                -7.480430e-01 1 1  ON 20
   eO_1                -4.268435e-01 1 1  ON 21
   eO_2                -1.575093e-02 1 1  ON 22
   eO_3                 2.984208e-01 1 1  ON 23
   eO_4                 5.261106e-01 1 1  ON 24
   eO_5                 4.905835e-01 1 1  ON 25
   eO_6                 2.638329e-01 1 1  ON 26
   eO_7                -4.191235e-02 1 1  ON 27
   eO_8                -2.376610e-01 1 1  ON 28
   eO_9                -1.043611e-01 1 1  ON 29
  eH1_0                -2.671748e-01 1 1  ON 30
  eH1_1                -1.590930e-01 1 1  ON 31
  eH1_2                -1.090613e-01 1 1  ON 32
  eH1_3                -5.279577e-02 1 1  ON 33
  eH1_4                -2.427070e-03 1 1  ON 34
  eH1_5                 3.417814e-02 1 1  ON 35
  eH1_6                 9.766468e-02 1 1  ON 36
  eH1_7                 1.603217e-01 1 1  ON 37
  eH1_8                 1.982513e-01 1 1  ON 38
  eH1_9                 9.855774e-02 1 1  ON 39
  eH2_0                -2.653369e-01 1 1  ON 40
  eH2_1                -1.573157e-01 1 1  ON 41
  eH2_2                -1.072847e-01 1 1  ON 42
  eH2_3                -5.114819e-02 1 1  ON 43
  eH2_4                -9.093014e-04 1 1  ON 44
  eH2_5                 3.636814e-02 1 1  ON 45
  eH2_6                 9.946584e-02 1 1  ON 46
  eH2_7                 1.618862e-01 1 1  ON 47
  eH2_8                 2.025029e-01 1 1  ON 48
  eH2_9                 9.220948e-02 1 1  ON 49
ci_0001                 7.018252e-01 3 1  ON 50
ci_0002                 7.002592e-01 3 1  ON 51
ci_0003                -2.731445e-02 3 1  ON 52
ci_0004                -2.736810e-02 3 1  ON 53
ci_0005                -3.636136e-02 3 1  ON 54
ci_0006                -3.723439e-02 3 1  ON 55
ci_0007                -2.124456e-02 3 1  ON 56
ci_0008                -2.143204e-02 3 1  ON 57
ci_0009                -1.763255e-02 3 1  ON 58
ci_0010                -1.674539e-02 3 1  ON 59
ci_0011                -1.219711e-02 3 1  ON 60
ci_0012                -1.188821e-02 3 1  ON 61
ci_0013                 1.353852e-02 3 1  ON 62
ci_0014                 1.306622e-02 3 1  ON 63
ci_0015                 1.354357e-02 3 1  ON 64
ci_0016                 1.327385e-02 3 1  ON 65
ci_0017                 1.101507e-02 3 1  ON 66
ci_0018                 1.134166e-02 3 1  ON 67
ci_0019                 1.116407e-02 3 1  ON 68
ci_0020                 1.078281e-02 3 1  ON 69
ci_0021                -1.801321e-03 3 1  ON 70
ci_0022                -1.277793e-03 3 1  ON 71
ci_0023                -1.130769e-02 3 1  ON 72
ci_0024                -1.109526e-02 3 1  ON 73
ci_0025                -1.043794e-02 3 1  ON 74
ci_0026                -1.010739e-02 3 1  ON 75
ci_0027                -1.142950e-02 3 1  ON 76
ci_0028                -1.130795e-02 3 1  ON 77
ci_0029                -1.118218e-02 3 1  ON 78
ci_0030                -1.116097e-02 3 1  ON 79
ci_0031                 2.069701e-02 3 1  ON 80
ci_0032                 2.085574e-02 3 1  ON 81
ci_0033                 1.028741e-02 3 1  ON 82
ci_0034                 1.039247e-02 3 1  ON 83
ci_0035                 7.373635e-03 3 1  ON 84
ci_0036                 6.193341e-03 3 1  ON 85
ci_0037                -1.063110e-02 3 1  ON 86
ci_0038                -1.084092e-02 3 1  ON 87
ci_0039                -2.416740e-03 3 1  ON 88
ci_0040                -2.754563e-03 3 1  ON 89
ci_0041                 7.174351e-03 3 1  ON 90
ci_0042                 7.062482e-03 3 1  ON 91
ci_0043                -1.921353e-02 3 1  ON 92
ci_0044                -1.924944e-02 3 1  ON 93
ci_0045                 7.791236e-03 3 1  ON 94
ci_0046                 7.558879e-03 3 1  ON 95
ci_0047                -1.563355e-03 3 1  ON 96
ci_0048                -1.886556e-03 3 1  ON 97
ci_0049                -5.671551e-03 3 1  ON 98
ci_0050                -5.872301e-03 3 1  ON 99
ci_0051                -3.277863e-03 3 1  ON 100
ci_0052                -3.635114e-03 3 1  ON 101
ci_0053                -4.573023e-03 3 1  ON 102
ci_0054                -4.437405e-03 3 1  ON 103
ci_0055                 5.835986e-03 3 1  ON 104
ci_0056                 6.366224e-03 3 1  ON 105
ci_0057                 5.027237e-03 3 1  ON 106
ci_0058                 4.969047e-03 3 1  ON 107
ci_0059                -4.927332e-03 3 1  ON 108
ci_0060                -4.588919e-03 3 1  ON 109
ci_0061                -3.315057e-03 3 1  ON 110
ci_0062                -3.877361e-03 3 1  ON 111
ci_0063                -8.900479e-03 3 1  ON 112
ci_0064                -8.777506e-03 3 1  ON 113
ci_0065                -5.400668e-03 3 1  ON 114
ci_0066                -5.069793e-03 3 1  ON 115
ci_0067                -4.954885e-03 3 1  ON 116
ci_0068                -4.667198e-03 3 1  ON 117
ci_0069                 4.581882e-03 3 1  ON 118
ci_0070                 4.446808e-03 3 1  ON 119
ci_0071                 1.123784e-05 3 1  ON 120
ci_0072                 7.278098e-06 3 1  ON 121
ci_0073                 4.067531e-03 3 1  ON 122
ci_0074                 4.456616e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8798e+01 secs
  Total Execution time = 5.8622e+03 secs

=========================================================
  A new xml input file : H2O.s099.cont.xml
