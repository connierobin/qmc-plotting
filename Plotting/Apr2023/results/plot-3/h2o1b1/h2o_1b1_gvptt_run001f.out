Rank =    0  Free Memory = 71100 MB
Rank =    1  Free Memory = 71100 MB
Rank =    2  Free Memory = 71100 MB
Rank =    3  Free Memory = 71100 MB
Rank =    4  Free Memory = 71099 MB
Rank =    5  Free Memory = 71098 MB
Rank =    6  Free Memory = 71098 MB
Rank =    7  Free Memory = 71097 MB
Rank =    8  Free Memory = 71097 MB
Rank =    9  Free Memory = 71097 MB
Rank =   10  Free Memory = 71097 MB
Rank =   11  Free Memory = 71097 MB
Rank =   12  Free Memory = 71096 MB
Rank =   13  Free Memory = 71096 MB
Rank =   14  Free Memory = 71096 MB
Rank =   15  Free Memory = 71084 MB
Rank =   16  Free Memory = 71083 MB
Rank =   17  Free Memory = 71083 MB
Rank =   18  Free Memory = 71083 MB
Rank =   19  Free Memory = 71083 MB
Rank =   20  Free Memory = 71083 MB
Rank =   21  Free Memory = 71083 MB
Rank =   22  Free Memory = 71083 MB
Rank =   23  Free Memory = 71083 MB
Rank =   24  Free Memory = 71083 MB
Rank =   25  Free Memory = 71083 MB
Rank =   26  Free Memory = 71083 MB
Rank =   27  Free Memory = 71083 MB
Rank =   28  Free Memory = 71083 MB
Rank =   29  Free Memory = 71083 MB
Rank =   30  Free Memory = 71083 MB
Rank =   31  Free Memory = 71083 MB
Rank =   32  Free Memory = 73140 MB
Rank =   33  Free Memory = 73140 MB
Rank =   34  Free Memory = 73140 MB
Rank =   35  Free Memory = 73140 MB
Rank =   36  Free Memory = 73140 MB
Rank =   37  Free Memory = 73140 MB
Rank =   38  Free Memory = 73140 MB
Rank =   39  Free Memory = 73140 MB
Rank =   40  Free Memory = 73140 MB
Rank =   41  Free Memory = 73139 MB
Rank =   42  Free Memory = 73139 MB
Rank =   43  Free Memory = 73139 MB
Rank =   44  Free Memory = 73139 MB
Rank =   45  Free Memory = 73139 MB
Rank =   46  Free Memory = 73139 MB
Rank =   47  Free Memory = 73139 MB
Rank =   48  Free Memory = 73139 MB
Rank =   49  Free Memory = 73139 MB
Rank =   50  Free Memory = 73139 MB
Rank =   51  Free Memory = 73139 MB
Rank =   52  Free Memory = 73139 MB
Rank =   53  Free Memory = 73139 MB
Rank =   54  Free Memory = 73139 MB
Rank =   55  Free Memory = 73139 MB
Rank =   56  Free Memory = 73139 MB
Rank =   57  Free Memory = 73139 MB
Rank =   58  Free Memory = 73139 MB
Rank =   59  Free Memory = 73139 MB
Rank =   60  Free Memory = 73139 MB
Rank =   61  Free Memory = 73139 MB
Rank =   62  Free Memory = 73139 MB
Rank =   63  Free Memory = 73139 MB
Rank =   64  Free Memory = 89727 MB
Rank =   65  Free Memory = 89727 MB
Rank =   66  Free Memory = 89727 MB
Rank =   67  Free Memory = 89727 MB
Rank =   68  Free Memory = 89727 MB
Rank =   69  Free Memory = 89727 MB
Rank =   70  Free Memory = 89727 MB
Rank =   71  Free Memory = 89727 MB
Rank =   72  Free Memory = 89727 MB
Rank =   73  Free Memory = 89727 MB
Rank =   74  Free Memory = 89727 MB
Rank =   75  Free Memory = 89727 MB
Rank =   76  Free Memory = 89727 MB
Rank =   77  Free Memory = 89727 MB
Rank =   78  Free Memory = 89727 MB
Rank =   79  Free Memory = 89727 MB
Rank =   80  Free Memory = 89727 MB
Rank =   81  Free Memory = 89727 MB
Rank =   82  Free Memory = 89727 MB
Rank =   83  Free Memory = 89727 MB
Rank =   84  Free Memory = 89727 MB
Rank =   85  Free Memory = 89726 MB
Rank =   86  Free Memory = 89726 MB
Rank =   87  Free Memory = 89726 MB
Rank =   88  Free Memory = 89726 MB
Rank =   89  Free Memory = 89726 MB
Rank =   90  Free Memory = 89726 MB
Rank =   91  Free Memory = 89726 MB
Rank =   92  Free Memory = 89726 MB
Rank =   93  Free Memory = 89726 MB
Rank =   94  Free Memory = 89726 MB
Rank =   95  Free Memory = 89726 MB
Rank =   96  Free Memory = 62994 MB
Rank =   97  Free Memory = 62994 MB
Rank =   98  Free Memory = 62994 MB
Rank =   99  Free Memory = 62994 MB
Rank =  100  Free Memory = 62994 MB
Rank =  101  Free Memory = 62994 MB
Rank =  102  Free Memory = 62994 MB
Rank =  103  Free Memory = 62994 MB
Rank =  104  Free Memory = 62994 MB
Rank =  105  Free Memory = 62994 MB
Rank =  106  Free Memory = 62994 MB
Rank =  107  Free Memory = 62994 MB
Rank =  108  Free Memory = 62994 MB
Rank =  109  Free Memory = 62994 MB
Rank =  110  Free Memory = 62994 MB
Rank =  111  Free Memory = 62994 MB
Rank =  112  Free Memory = 62994 MB
Rank =  113  Free Memory = 62994 MB
Rank =  114  Free Memory = 62994 MB
Rank =  115  Free Memory = 62994 MB
Rank =  116  Free Memory = 62994 MB
Rank =  117  Free Memory = 62994 MB
Rank =  118  Free Memory = 62994 MB
Rank =  119  Free Memory = 62994 MB
Rank =  120  Free Memory = 62994 MB
Rank =  121  Free Memory = 62994 MB
Rank =  122  Free Memory = 62994 MB
Rank =  123  Free Memory = 62994 MB
Rank =  124  Free Memory = 62994 MB
Rank =  125  Free Memory = 62994 MB
Rank =  126  Free Memory = 62994 MB
Rank =  127  Free Memory = 62994 MB
  Input file(s): opt_h2o_1b1_gvptt_run001f.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: a1d851bbe8d902a0d3168a885b757a378aeaab54-dirty
  Last git commit date: Mon Feb 13 11:52:39 2023 -0800
  Last git commit subject: Print param update magnitude and largest update
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_1b1_gvptt_run001f.xml

  Project = H2O
  date    = 2023-03-06 14:47:02 PST
  host    = n0082.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 358

  Range of prime numbers to use as seeds over processors and threads = 2423-3491


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 3.067805e-01    1         1  ON     0
     uu_1                 1.406915e-01    1         1  ON     1
     uu_2                 4.009771e-02    1         1  ON     2
     uu_3                -2.105015e-02    1         1  ON     3
     uu_4                -6.451373e-02    1         1  ON     4
     uu_5                -9.716614e-02    1         1  ON     5
     uu_6                -1.228909e-01    1         1  ON     6
     uu_7                -1.345299e-01    1         1  ON     7
     uu_8                -1.259801e-01    1         1  ON     8
     uu_9                -9.461304e-02    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 4.420304e-01    1         1  ON     0
     ud_1                 1.770673e-01    1         1  ON     1
     ud_2                 5.810533e-02    1         1  ON     2
     ud_3                -1.153563e-02    1         1  ON     3
     ud_4                -6.719212e-02    1         1  ON     4
     ud_5                -1.070291e-01    1         1  ON     5
     ud_6                -1.331108e-01    1         1  ON     6
     ud_7                -1.481128e-01    1         1  ON     7
     ud_8                -1.494834e-01    1         1  ON     8
     ud_9                -1.364664e-01    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -7.499291e-01    1         1  ON     0
     eO_1                -4.314314e-01    1         1  ON     1
     eO_2                -1.659442e-02    1         1  ON     2
     eO_3                 2.965679e-01    1         1  ON     3
     eO_4                 5.126149e-01    1         1  ON     4
     eO_5                 4.680976e-01    1         1  ON     5
     eO_6                 2.398140e-01    1         1  ON     6
     eO_7                -5.339122e-02    1         1  ON     7
     eO_8                -2.038095e-01    1         1  ON     8
     eO_9                -6.408722e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -2.333359e-01    1         1  ON     0
     eH1_1                -1.345231e-01    1         1  ON     1
     eH1_2                -8.872797e-02    1         1  ON     2
     eH1_3                -3.584472e-02    1         1  ON     3
     eH1_4                 1.146494e-02    1         1  ON     4
     eH1_5                 4.510729e-02    1         1  ON     5
     eH1_6                 9.872711e-02    1         1  ON     6
     eH1_7                 1.439967e-01    1         1  ON     7
     eH1_8                 1.556260e-01    1         1  ON     8
     eH1_9                 4.154689e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -2.312502e-01    1         1  ON     0
     eH2_1                -1.327408e-01    1         1  ON     1
     eH2_2                -8.695784e-02    1         1  ON     2
     eH2_3                -3.391448e-02    1         1  ON     3
     eH2_4                 1.399508e-02    1         1  ON     4
     eH2_5                 4.807721e-02    1         1  ON     5
     eH2_6                 1.021202e-01    1         1  ON     6
     eH2_7                 1.498958e-01    1         1  ON     7
     eH2_8                 1.632884e-01    1         1  ON     8
     eH2_9                 2.501344e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 75 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 3.809173e+00
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 30 unique up determinants.
Found 30 unique down determinants.
Number of terms in pairs array: 20
Number of terms in pairs array: 20
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 2.9781e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u  6.1002844054e-01  1.3250453608e-01 -4.2267217978e-01
    u -4.3494847795e-01 -2.3203549626e-01  1.0876787134e-01
    u -1.5984350305e-01  8.1842956548e-01  5.1837161342e-02
    u  1.1948334779e+00  1.4453040952e+00  1.6346730752e+00
    d -9.5054657961e-01  2.3768909128e-01 -6.0876959125e-01
    d -2.0429807517e-01  1.5546410594e+00 -1.0292769217e-01
    d  4.7451519973e-01  3.4811618685e-02  3.5425821429e-01
    d -8.6403568621e-02 -1.8286319639e+00  9.9844026831e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 50
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.8661
    reference variance = 0.214494
====================================================
  Execution time = 2.0762e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.8071e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4994e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.380825718963
                                         uncertainty =       0.039773812630

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.380825718963
                                         uncertainty =       0.039773812630

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000436295550
  error estimate for blocks of size 2^( 2) =       0.000448387148
  error estimate for blocks of size 2^( 3) =       0.000460674467
  error estimate for blocks of size 2^( 4) =       0.000472023659
  error estimate for blocks of size 2^( 5) =       0.000481339426
  error estimate for blocks of size 2^( 6) =       0.000489290454
  error estimate for blocks of size 2^( 7) =       0.000493751280

      target function =                  N/A
              le_mean =     -16.905404741744
             les_mean =     286.173416905284
             stat err =       0.000484101205
             autocorr =       1.231149407870
              std dev =       0.617015083645
             le_variance =       0.380707613445


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.690540474174e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905404741744       residual = 8.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905409750829       residual = 6.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905416189113       residual = 4.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905415389314       residual = 4.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905415691563       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905417560894       residual = 9.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905416850706       residual = 2.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905417431306       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905417782672       residual = 3.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905417509705       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905417614503       residual = 5.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 1.360841e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905404741744       residual = 8.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905406647718       residual = 7.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905409235948       residual = 3.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905409539757       residual = 3.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905409564486       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905409855357       residual = 4.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905409687955       residual = 8.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905409695732       residual = 3.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905409783429       residual = 3.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 3.840817e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905404741744       residual = 8.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905405289755       residual = 8.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905406075572       residual = 3.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905406238037       residual = 3.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905406293782       residual = 9.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905406354224       residual = 3.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905406282134       residual = 5.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905406296233       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905406296567       residual = 1.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+00 is 1.064201e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.006640 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6274e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0  3.069927e-01                 1 1 ON  0
uu_1  1.409045e-01                 1 1 ON  1
uu_2  4.010411e-02                 1 1 ON  2
uu_3  -2.101218e-02                1 1 ON  3
uu_4  -6.455329e-02                1 1 ON  4
uu_5  -9.733057e-02                1 1 ON  5
uu_6  -1.229067e-01                1 1 ON  6
uu_7  -1.346963e-01                1 1 ON  7
uu_8  -1.261427e-01                1 1 ON  8
uu_9  -9.472735e-02                1 1 ON  9
ud_0  4.424044e-01                 1 1 ON  10
ud_1  1.772861e-01                 1 1 ON  11
ud_2  5.805778e-02                 1 1 ON  12
ud_3  -1.161916e-02                1 1 ON  13
ud_4  -6.722355e-02                1 1 ON  14
ud_5  -1.070629e-01                1 1 ON  15
ud_6  -1.331124e-01                1 1 ON  16
ud_7  -1.481947e-01                1 1 ON  17
ud_8  -1.495983e-01                1 1 ON  18
ud_9  -1.366311e-01                1 1 ON  19
eO_0  -7.501718e-01                1 1 ON  20
eO_1  -4.315554e-01                1 1 ON  21
eO_2  -1.656807e-02                1 1 ON  22
eO_3  2.966695e-01                 1 1 ON  23
eO_4  5.127963e-01                 1 1 ON  24
eO_5  4.682996e-01                 1 1 ON  25
eO_6  2.400146e-01                 1 1 ON  26
eO_7  -5.339019e-02                1 1 ON  27
eO_8  -2.040134e-01                1 1 ON  28
eO_9  -6.421294e-02                1 1 ON  29
eH1_0 -2.337200e-01                1 1 ON  30
eH1_1 -1.346674e-01                1 1 ON  31
eH1_2 -8.877172e-02                1 1 ON  32
eH1_3 -3.583198e-02                1 1 ON  33
eH1_4 1.157407e-02                 1 1 ON  34
eH1_5 4.509180e-02                 1 1 ON  35
eH1_6 9.875648e-02                 1 1 ON  36
eH1_7 1.441138e-01                 1 1 ON  37
eH1_8 1.557953e-01                 1 1 ON  38
eH1_9 4.168367e-02                 1 1 ON  39
eH2_0 -2.315775e-01                1 1 ON  40
eH2_1 -1.329185e-01                1 1 ON  41
eH2_2 -8.696561e-02                1 1 ON  42
eH2_3 -3.388392e-02                1 1 ON  43
eH2_4 1.400869e-02                 1 1 ON  44
eH2_5 4.807556e-02                 1 1 ON  45
eH2_6 1.022939e-01                 1 1 ON  46
eH2_7 1.499019e-01                 1 1 ON  47
eH2_8 1.634194e-01                 1 1 ON  48
eH2_9 2.518528e-02                 1 1 ON  49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.9412
    reference variance = 0.136603
====================================================
  Execution time = 2.0203e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3975e-01
  Total weights = 2.0000e+06
  Execution time = 1.8897e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339450947100
                                         uncertainty =       0.005168633554

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339450947100
                                         uncertainty =       0.005168633554

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411953221
  error estimate for blocks of size 2^( 2) =       0.000424998258
  error estimate for blocks of size 2^( 3) =       0.000437892508
  error estimate for blocks of size 2^( 4) =       0.000450252616
  error estimate for blocks of size 2^( 5) =       0.000462052685
  error estimate for blocks of size 2^( 6) =       0.000470299079
  error estimate for blocks of size 2^( 7) =       0.000477155854

      target function =                  N/A
              le_mean =     -16.905929316772
             les_mean =     286.149856807163
             stat err =       0.000464940058
             autocorr =       1.273790850143
              std dev =       0.582589832719
             le_variance =       0.339410913187

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340309955775
                                         uncertainty =       0.005173924747

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340309955775
                                         uncertainty =       0.005173924747

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412474039
  error estimate for blocks of size 2^( 2) =       0.000425481303
  error estimate for blocks of size 2^( 3) =       0.000438334739
  error estimate for blocks of size 2^( 4) =       0.000450665293
  error estimate for blocks of size 2^( 5) =       0.000462435855
  error estimate for blocks of size 2^( 6) =       0.000470673777
  error estimate for blocks of size 2^( 7) =       0.000477551133

      target function =                  N/A
              le_mean =     -16.905933029832
             les_mean =     286.150841105122
             stat err =       0.000465331515
             autocorr =       1.272716553930
              std dev =       0.583326380421
             le_variance =       0.340269666095

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340132847896
                                         uncertainty =       0.005171888450

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340132847896
                                         uncertainty =       0.005171888450

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412366705
  error estimate for blocks of size 2^( 2) =       0.000425381389
  error estimate for blocks of size 2^( 3) =       0.000438244494
  error estimate for blocks of size 2^( 4) =       0.000450582519
  error estimate for blocks of size 2^( 5) =       0.000462360062
  error estimate for blocks of size 2^( 6) =       0.000470597917
  error estimate for blocks of size 2^( 7) =       0.000477469209

      target function =                  N/A
              le_mean =     -16.905930880465
             les_mean =     286.150591364442
             stat err =       0.000465252427
             autocorr =       1.272946373201
              std dev =       0.583174587426
             le_variance =       0.340092599419

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339552162953
                                         uncertainty =       0.005169020524

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339552162953
                                         uncertainty =       0.005169020524

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412014622
  error estimate for blocks of size 2^( 2) =       0.000425054981
  error estimate for blocks of size 2^( 3) =       0.000437944548
  error estimate for blocks of size 2^( 4) =       0.000450301371
  error estimate for blocks of size 2^( 5) =       0.000462098108
  error estimate for blocks of size 2^( 6) =       0.000470343104
  error estimate for blocks of size 2^( 7) =       0.000477201943

      target function =                  N/A
              le_mean =     -16.905929192690
             les_mean =     286.149953795385
             stat err =       0.000464986131
             autocorr =       1.273663615680
              std dev =       0.582676665832
             le_variance =       0.339512096906


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905929316772        initial
     2.5000e-01     2.5000e+00             1.3608e-03       -16.905933029832  <--
     1.0000e+00     1.0000e+01             3.8408e-04       -16.905930880465
     4.0000e+00     4.0000e+01             1.0642e-04       -16.905929192690

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 2.9732e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
 uu_0                 3.075141e-01 1 1  ON 0
 uu_1                 1.412935e-01 1 1  ON 1
 uu_2                 4.026517e-02 1 1  ON 2
 uu_3                -2.093673e-02 1 1  ON 3
 uu_4                -6.465484e-02 1 1  ON 4
 uu_5                -9.766096e-02 1 1  ON 5
 uu_6                -1.230671e-01 1 1  ON 6
 uu_7                -1.350822e-01 1 1  ON 7
 uu_8                -1.265566e-01 1 1  ON 8
 uu_9                -9.505876e-02 1 1  ON 9
 ud_0                 4.431002e-01 1 1  ON 10
 ud_1                 1.776954e-01 1 1  ON 11
 ud_2                 5.815161e-02 1 1  ON 12
 ud_3                -1.170138e-02 1 1  ON 13
 ud_4                -6.729610e-02 1 1  ON 14
 ud_5                -1.071125e-01 1 1  ON 15
 ud_6                -1.331417e-01 1 1  ON 16
 ud_7                -1.483376e-01 1 1  ON 17
 ud_8                -1.498554e-01 1 1  ON 18
 ud_9                -1.370951e-01 1 1  ON 19
 eO_0                -7.508009e-01 1 1  ON 20
 eO_1                -4.318810e-01 1 1  ON 21
 eO_2                -1.660208e-02 1 1  ON 22
 eO_3                 2.968631e-01 1 1  ON 23
 eO_4                 5.133259e-01 1 1  ON 24
 eO_5                 4.689179e-01 1 1  ON 25
 eO_6                 2.406329e-01 1 1  ON 26
 eO_7                -5.334519e-02 1 1  ON 27
 eO_8                -2.046063e-01 1 1  ON 28
 eO_9                -6.458709e-02 1 1  ON 29
eH1_0                -2.346968e-01 1 1  ON 30
eH1_1                -1.350632e-01 1 1  ON 31
eH1_2                -8.894862e-02 1 1  ON 32
eH1_3                -3.585744e-02 1 1  ON 33
eH1_4                 1.173644e-02 1 1  ON 34
eH1_5                 4.508866e-02 1 1  ON 35
eH1_6                 9.885725e-02 1 1  ON 36
eH1_7                 1.444627e-01 1 1  ON 37
eH1_8                 1.563076e-01 1 1  ON 38
eH1_9                 4.209679e-02 1 1  ON 39
eH2_0                -2.324338e-01 1 1  ON 40
eH2_1                -1.333437e-01 1 1  ON 41
eH2_2                -8.710834e-02 1 1  ON 42
eH2_3                -3.388134e-02 1 1  ON 43
eH2_4                 1.401719e-02 1 1  ON 44
eH2_5                 4.807228e-02 1 1  ON 45
eH2_6                 1.027754e-01 1 1  ON 46
eH2_7                 1.499481e-01 1 1  ON 47
eH2_8                 1.638274e-01 1 1  ON 48
eH2_9                 2.570225e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6012e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.9054
    reference variance = 0.159621
====================================================
  Execution time = 2.0376e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3572e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5425e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335771051062
                                         uncertainty =       0.003912936059

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335771051062
                                         uncertainty =       0.003912936059

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409706080
  error estimate for blocks of size 2^( 2) =       0.000422414364
  error estimate for blocks of size 2^( 3) =       0.000436115512
  error estimate for blocks of size 2^( 4) =       0.000449139489
  error estimate for blocks of size 2^( 5) =       0.000460102312
  error estimate for blocks of size 2^( 6) =       0.000469055095
  error estimate for blocks of size 2^( 7) =       0.000475723717

      target function =                  N/A
              le_mean =     -16.905643471312
             les_mean =     286.136499154936
             stat err =       0.000463505153
             autocorr =       1.279865454515
              std dev =       0.579411894676
             le_variance =       0.335718143692


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690564347131e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905643471312       residual = 3.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905647323022       residual = 3.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905649609318       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905650226795       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905657443052       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905659060506       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905660119898       residual = 8.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905660178921       residual = 4.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905660805439       residual = 4.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905660740531       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905660409226       residual = 8.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905660524073       residual = 2.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905660086743       residual = 6.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 3.621857e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905643471312       residual = 3.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905645638810       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905646579033       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905647096035       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905650434118       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905650152380       residual = 5.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905649999646       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905650112503       residual = 6.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905650163670       residual = 2.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905650228919       residual = 9.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 1.091231e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905643471312       residual = 3.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905644259764       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905644513560       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905644726741       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905645651646       residual = 6.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905645565362       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905645473360       residual = 3.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905645517142       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905645529455       residual = 2.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 3.106706e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.011493 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5928e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.077621e-01 1 1  ON 0
 uu_1                 1.416626e-01 1 1  ON 1
 uu_2                 4.053600e-02 1 1  ON 2
 uu_3                -2.088689e-02 1 1  ON 3
 uu_4                -6.485408e-02 1 1  ON 4
 uu_5                -9.802636e-02 1 1  ON 5
 uu_6                -1.234927e-01 1 1  ON 6
 uu_7                -1.355205e-01 1 1  ON 7
 uu_8                -1.267956e-01 1 1  ON 8
 uu_9                -9.528264e-02 1 1  ON 9
 ud_0                 4.433540e-01 1 1  ON 10
 ud_1                 1.780813e-01 1 1  ON 11
 ud_2                 5.824367e-02 1 1  ON 12
 ud_3                -1.186822e-02 1 1  ON 13
 ud_4                -6.752410e-02 1 1  ON 14
 ud_5                -1.073718e-01 1 1  ON 15
 ud_6                -1.333505e-01 1 1  ON 16
 ud_7                -1.485533e-01 1 1  ON 17
 ud_8                -1.494644e-01 1 1  ON 18
 ud_9                -1.371008e-01 1 1  ON 19
 eO_0                -7.517489e-01 1 1  ON 20
 eO_1                -4.324141e-01 1 1  ON 21
 eO_2                -1.686163e-02 1 1  ON 22
 eO_3                 2.971029e-01 1 1  ON 23
 eO_4                 5.143508e-01 1 1  ON 24
 eO_5                 4.695657e-01 1 1  ON 25
 eO_6                 2.410327e-01 1 1  ON 26
 eO_7                -5.301823e-02 1 1  ON 27
 eO_8                -2.049661e-01 1 1  ON 28
 eO_9                -6.505014e-02 1 1  ON 29
eH1_0                -2.357330e-01 1 1  ON 30
eH1_1                -1.355908e-01 1 1  ON 31
eH1_2                -8.925176e-02 1 1  ON 32
eH1_3                -3.602319e-02 1 1  ON 33
eH1_4                 1.144408e-02 1 1  ON 34
eH1_5                 4.501855e-02 1 1  ON 35
eH1_6                 9.901926e-02 1 1  ON 36
eH1_7                 1.448256e-01 1 1  ON 37
eH1_8                 1.571106e-01 1 1  ON 38
eH1_9                 4.299833e-02 1 1  ON 39
eH2_0                -2.335250e-01 1 1  ON 40
eH2_1                -1.336718e-01 1 1  ON 41
eH2_2                -8.730704e-02 1 1  ON 42
eH2_3                -3.381264e-02 1 1  ON 43
eH2_4                 1.393603e-02 1 1  ON 44
eH2_5                 4.804021e-02 1 1  ON 45
eH2_6                 1.027980e-01 1 1  ON 46
eH2_7                 1.501717e-01 1 1  ON 47
eH2_8                 1.642997e-01 1 1  ON 48
eH2_9                 2.650328e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.9016
    reference variance = 0.459271
====================================================
  Execution time = 1.9794e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4107e-01
  Total weights = 2.0000e+06
  Execution time = 1.9062e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340976044651
                                         uncertainty =       0.007563210963

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340976044651
                                         uncertainty =       0.007563210963

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412870094
  error estimate for blocks of size 2^( 2) =       0.000425833204
  error estimate for blocks of size 2^( 3) =       0.000439435788
  error estimate for blocks of size 2^( 4) =       0.000451055000
  error estimate for blocks of size 2^( 5) =       0.000461844093
  error estimate for blocks of size 2^( 6) =       0.000467393045
  error estimate for blocks of size 2^( 7) =       0.000473630803

      target function =                  N/A
              le_mean =     -16.905667145536
             les_mean =     286.142504894155
             stat err =       0.000463480735
             autocorr =       1.260191430897
              std dev =       0.583886486361
             le_variance =       0.340923428955

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341587561030
                                         uncertainty =       0.007649057182

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341587561030
                                         uncertainty =       0.007649057182

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413239920
  error estimate for blocks of size 2^( 2) =       0.000426184859
  error estimate for blocks of size 2^( 3) =       0.000439751930
  error estimate for blocks of size 2^( 4) =       0.000451335665
  error estimate for blocks of size 2^( 5) =       0.000462122796
  error estimate for blocks of size 2^( 6) =       0.000467665088
  error estimate for blocks of size 2^( 7) =       0.000473885410

      target function =                  N/A
              le_mean =     -16.905669308873
             les_mean =     286.143189073469
             stat err =       0.000463752240
             autocorr =       1.259411057167
              std dev =       0.584409499637
             le_variance =       0.341534463265

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341276679258
                                         uncertainty =       0.007632201489

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341276679258
                                         uncertainty =       0.007632201489

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413051891
  error estimate for blocks of size 2^( 2) =       0.000426003427
  error estimate for blocks of size 2^( 3) =       0.000439579478
  error estimate for blocks of size 2^( 4) =       0.000451175484
  error estimate for blocks of size 2^( 5) =       0.000461978735
  error estimate for blocks of size 2^( 6) =       0.000467528946
  error estimate for blocks of size 2^( 7) =       0.000473762502

      target function =                  N/A
              le_mean =     -16.905670300941
             les_mean =     286.142911882500
             stat err =       0.000463611417
             autocorr =       1.259792490518
              std dev =       0.584143585944
             le_variance =       0.341223728999

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340976135879
                                         uncertainty =       0.007575282381

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340976135879
                                         uncertainty =       0.007575282381

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412870123
  error estimate for blocks of size 2^( 2) =       0.000425832105
  error estimate for blocks of size 2^( 3) =       0.000439430723
  error estimate for blocks of size 2^( 4) =       0.000451046907
  error estimate for blocks of size 2^( 5) =       0.000461840152
  error estimate for blocks of size 2^( 6) =       0.000467390047
  error estimate for blocks of size 2^( 7) =       0.000473628647

      target function =                  N/A
              le_mean =     -16.905667113861
             les_mean =     286.142503870735
             stat err =       0.000463476438
             autocorr =       1.260167888602
              std dev =       0.583886527092
             le_variance =       0.340923476519


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905667145536        initial
     6.2500e-02     6.2500e-01             3.6219e-03       -16.905669308873
     2.5000e-01     2.5000e+00             1.0912e-03       -16.905670300941  <--
     1.0000e+00     1.0000e+01             3.1067e-04       -16.905667113861

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 2.9405e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.077621e-01 1 1  ON 0
 uu_1                 1.416626e-01 1 1  ON 1
 uu_2                 4.053600e-02 1 1  ON 2
 uu_3                -2.088689e-02 1 1  ON 3
 uu_4                -6.485408e-02 1 1  ON 4
 uu_5                -9.802636e-02 1 1  ON 5
 uu_6                -1.234927e-01 1 1  ON 6
 uu_7                -1.355205e-01 1 1  ON 7
 uu_8                -1.267956e-01 1 1  ON 8
 uu_9                -9.528264e-02 1 1  ON 9
 ud_0                 4.433540e-01 1 1  ON 10
 ud_1                 1.780813e-01 1 1  ON 11
 ud_2                 5.824367e-02 1 1  ON 12
 ud_3                -1.186822e-02 1 1  ON 13
 ud_4                -6.752410e-02 1 1  ON 14
 ud_5                -1.073718e-01 1 1  ON 15
 ud_6                -1.333505e-01 1 1  ON 16
 ud_7                -1.485533e-01 1 1  ON 17
 ud_8                -1.494644e-01 1 1  ON 18
 ud_9                -1.371008e-01 1 1  ON 19
 eO_0                -7.517489e-01 1 1  ON 20
 eO_1                -4.324141e-01 1 1  ON 21
 eO_2                -1.686163e-02 1 1  ON 22
 eO_3                 2.971029e-01 1 1  ON 23
 eO_4                 5.143508e-01 1 1  ON 24
 eO_5                 4.695657e-01 1 1  ON 25
 eO_6                 2.410327e-01 1 1  ON 26
 eO_7                -5.301823e-02 1 1  ON 27
 eO_8                -2.049661e-01 1 1  ON 28
 eO_9                -6.505014e-02 1 1  ON 29
eH1_0                -2.357330e-01 1 1  ON 30
eH1_1                -1.355908e-01 1 1  ON 31
eH1_2                -8.925176e-02 1 1  ON 32
eH1_3                -3.602319e-02 1 1  ON 33
eH1_4                 1.144408e-02 1 1  ON 34
eH1_5                 4.501855e-02 1 1  ON 35
eH1_6                 9.901926e-02 1 1  ON 36
eH1_7                 1.448256e-01 1 1  ON 37
eH1_8                 1.571106e-01 1 1  ON 38
eH1_9                 4.299833e-02 1 1  ON 39
eH2_0                -2.335250e-01 1 1  ON 40
eH2_1                -1.336718e-01 1 1  ON 41
eH2_2                -8.730704e-02 1 1  ON 42
eH2_3                -3.381264e-02 1 1  ON 43
eH2_4                 1.393603e-02 1 1  ON 44
eH2_5                 4.804021e-02 1 1  ON 45
eH2_6                 1.027980e-01 1 1  ON 46
eH2_7                 1.501717e-01 1 1  ON 47
eH2_8                 1.642997e-01 1 1  ON 48
eH2_9                 2.650328e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5339e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.9034
    reference variance = 0.212773
====================================================
  Execution time = 2.0274e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3893e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5046e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339040256344
                                         uncertainty =       0.002971287041

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339040256344
                                         uncertainty =       0.002971287041

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411662704
  error estimate for blocks of size 2^( 2) =       0.000424978895
  error estimate for blocks of size 2^( 3) =       0.000439153697
  error estimate for blocks of size 2^( 4) =       0.000452315738
  error estimate for blocks of size 2^( 5) =       0.000464733208
  error estimate for blocks of size 2^( 6) =       0.000474011930
  error estimate for blocks of size 2^( 7) =       0.000479118972

      target function =                  N/A
              le_mean =     -16.906565779534
             les_mean =     286.170898651664
             stat err =       0.000467544962
             autocorr =       1.289922799897
              std dev =       0.582178978864
             le_variance =       0.338932363432


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690656577953e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906565779534       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906569308697       residual = 3.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906571906962       residual = 5.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906573688129       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906573962970       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906577888186       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906579054807       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906584794602       residual = 7.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906584643951       residual = 3.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906583309958       residual = 2.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906584227562       residual = 5.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906584003418       residual = 2.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906584081179       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906584379284       residual = 6.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 3.795495e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906565779534       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906567789086       residual = 3.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906569453556       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906570057674       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906569965305       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906572059910       residual = 4.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906571311598       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906572792050       residual = 5.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906572662478       residual = 2.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906572548039       residual = 4.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 1.022428e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906565779534       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906566517703       residual = 3.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906567216568       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906567267569       residual = 8.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906567497757       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906567826866       residual = 3.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906567750760       residual = 4.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906567939364       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906567923357       residual = 3.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 2.702282e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.016132 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5787e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.081314e-01 1 1  ON 0
 uu_1                 1.418279e-01 1 1  ON 1
 uu_2                 4.065266e-02 1 1  ON 2
 uu_3                -2.102650e-02 1 1  ON 3
 uu_4                -6.524089e-02 1 1  ON 4
 uu_5                -9.832793e-02 1 1  ON 5
 uu_6                -1.237676e-01 1 1  ON 6
 uu_7                -1.357738e-01 1 1  ON 7
 uu_8                -1.272242e-01 1 1  ON 8
 uu_9                -9.540758e-02 1 1  ON 9
 ud_0                 4.435738e-01 1 1  ON 10
 ud_1                 1.782343e-01 1 1  ON 11
 ud_2                 5.846201e-02 1 1  ON 12
 ud_3                -1.188022e-02 1 1  ON 13
 ud_4                -6.762815e-02 1 1  ON 14
 ud_5                -1.072962e-01 1 1  ON 15
 ud_6                -1.336721e-01 1 1  ON 16
 ud_7                -1.485763e-01 1 1  ON 17
 ud_8                -1.492564e-01 1 1  ON 18
 ud_9                -1.371897e-01 1 1  ON 19
 eO_0                -7.524228e-01 1 1  ON 20
 eO_1                -4.328839e-01 1 1  ON 21
 eO_2                -1.720624e-02 1 1  ON 22
 eO_3                 2.972279e-01 1 1  ON 23
 eO_4                 5.150239e-01 1 1  ON 24
 eO_5                 4.704999e-01 1 1  ON 25
 eO_6                 2.414960e-01 1 1  ON 26
 eO_7                -5.255942e-02 1 1  ON 27
 eO_8                -2.054599e-01 1 1  ON 28
 eO_9                -6.564179e-02 1 1  ON 29
eH1_0                -2.367555e-01 1 1  ON 30
eH1_1                -1.364765e-01 1 1  ON 31
eH1_2                -8.964579e-02 1 1  ON 32
eH1_3                -3.608628e-02 1 1  ON 33
eH1_4                 1.158106e-02 1 1  ON 34
eH1_5                 4.456667e-02 1 1  ON 35
eH1_6                 9.925126e-02 1 1  ON 36
eH1_7                 1.455224e-01 1 1  ON 37
eH1_8                 1.580615e-01 1 1  ON 38
eH1_9                 4.382435e-02 1 1  ON 39
eH2_0                -2.342885e-01 1 1  ON 40
eH2_1                -1.342453e-01 1 1  ON 41
eH2_2                -8.731103e-02 1 1  ON 42
eH2_3                -3.361047e-02 1 1  ON 43
eH2_4                 1.393433e-02 1 1  ON 44
eH2_5                 4.760322e-02 1 1  ON 45
eH2_6                 1.031294e-01 1 1  ON 46
eH2_7                 1.501317e-01 1 1  ON 47
eH2_8                 1.647340e-01 1 1  ON 48
eH2_9                 2.735157e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.9761
    reference variance = 0.209332
====================================================
  Execution time = 2.0162e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3824e-01
  Total weights = 2.0000e+06
  Execution time = 1.8926e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338255056944
                                         uncertainty =       0.004224958542

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338255056944
                                         uncertainty =       0.004224958542

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411207089
  error estimate for blocks of size 2^( 2) =       0.000424010708
  error estimate for blocks of size 2^( 3) =       0.000436885641
  error estimate for blocks of size 2^( 4) =       0.000448495766
  error estimate for blocks of size 2^( 5) =       0.000457909182
  error estimate for blocks of size 2^( 6) =       0.000465230234
  error estimate for blocks of size 2^( 7) =       0.000472077243

      target function =                  N/A
              le_mean =     -16.906621680069
             les_mean =     286.172039004777
             stat err =       0.000460928106
             autocorr =       1.256449955094
              std dev =       0.581534642899
             le_variance =       0.338182540892

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338598068899
                                         uncertainty =       0.004216571510

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338598068899
                                         uncertainty =       0.004216571510

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411415385
  error estimate for blocks of size 2^( 2) =       0.000424211219
  error estimate for blocks of size 2^( 3) =       0.000437071618
  error estimate for blocks of size 2^( 4) =       0.000448657589
  error estimate for blocks of size 2^( 5) =       0.000458039633
  error estimate for blocks of size 2^( 6) =       0.000465341987
  error estimate for blocks of size 2^( 7) =       0.000472181472

      target function =                  N/A
              le_mean =     -16.906623436590
             les_mean =     286.172441095836
             stat err =       0.000461055170
             autocorr =       1.255870143721
              std dev =       0.581829217603
             le_variance =       0.338525238457

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338387632085
                                         uncertainty =       0.004211937846

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338387632085
                                         uncertainty =       0.004211937846

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411287500
  error estimate for blocks of size 2^( 2) =       0.000424087463
  error estimate for blocks of size 2^( 3) =       0.000436957494
  error estimate for blocks of size 2^( 4) =       0.000448555025
  error estimate for blocks of size 2^( 5) =       0.000457948577
  error estimate for blocks of size 2^( 6) =       0.000465260781
  error estimate for blocks of size 2^( 7) =       0.000472109658

      target function =                  N/A
              le_mean =     -16.906621820227
             les_mean =     286.172176018742
             stat err =       0.000460968510
             autocorr =       1.256178906204
              std dev =       0.581648360888
             le_variance =       0.338314815723

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338252506859
                                         uncertainty =       0.004221866624

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338252506859
                                         uncertainty =       0.004221866624

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411205504
  error estimate for blocks of size 2^( 2) =       0.000424008785
  error estimate for blocks of size 2^( 3) =       0.000436883481
  error estimate for blocks of size 2^( 4) =       0.000448492015
  error estimate for blocks of size 2^( 5) =       0.000457902302
  error estimate for blocks of size 2^( 6) =       0.000465222740
  error estimate for blocks of size 2^( 7) =       0.000472071233

      target function =                  N/A
              le_mean =     -16.906620947621
             les_mean =     286.172011631014
             stat err =       0.000460922073
             autocorr =       1.256426747200
              std dev =       0.581532401136
             le_variance =       0.338179933571


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906621680069        initial
     6.2500e-02     6.2500e-01             3.7955e-03       -16.906623436590  <--
     2.5000e-01     2.5000e+00             1.0224e-03       -16.906621820227
     1.0000e+00     1.0000e+01             2.7023e-04       -16.906620947621

*****************************************************************************
Applying the update for shift_i =   6.2500e-02     and shift_s =   6.2500e-01
*****************************************************************************

  Execution time = 2.9690e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.086442e-01 1 1  ON 0
 uu_1                 1.421199e-01 1 1  ON 1
 uu_2                 4.079677e-02 1 1  ON 2
 uu_3                -2.119557e-02 1 1  ON 3
 uu_4                -6.577435e-02 1 1  ON 4
 uu_5                -9.903746e-02 1 1  ON 5
 uu_6                -1.245956e-01 1 1  ON 6
 uu_7                -1.365934e-01 1 1  ON 7
 uu_8                -1.283973e-01 1 1  ON 8
 uu_9                -9.588841e-02 1 1  ON 9
 ud_0                 4.441917e-01 1 1  ON 10
 ud_1                 1.788006e-01 1 1  ON 11
 ud_2                 5.891081e-02 1 1  ON 12
 ud_3                -1.165112e-02 1 1  ON 13
 ud_4                -6.765812e-02 1 1  ON 14
 ud_5                -1.073940e-01 1 1  ON 15
 ud_6                -1.340880e-01 1 1  ON 16
 ud_7                -1.487943e-01 1 1  ON 17
 ud_8                -1.490968e-01 1 1  ON 18
 ud_9                -1.374529e-01 1 1  ON 19
 eO_0                -7.540677e-01 1 1  ON 20
 eO_1                -4.340900e-01 1 1  ON 21
 eO_2                -1.796707e-02 1 1  ON 22
 eO_3                 2.974061e-01 1 1  ON 23
 eO_4                 5.164880e-01 1 1  ON 24
 eO_5                 4.729064e-01 1 1  ON 25
 eO_6                 2.432419e-01 1 1  ON 26
 eO_7                -5.119852e-02 1 1  ON 27
 eO_8                -2.069651e-01 1 1  ON 28
 eO_9                -6.743314e-02 1 1  ON 29
eH1_0                -2.388808e-01 1 1  ON 30
eH1_1                -1.382709e-01 1 1  ON 31
eH1_2                -9.094900e-02 1 1  ON 32
eH1_3                -3.703137e-02 1 1  ON 33
eH1_4                 1.114886e-02 1 1  ON 34
eH1_5                 4.375007e-02 1 1  ON 35
eH1_6                 9.951808e-02 1 1  ON 36
eH1_7                 1.473753e-01 1 1  ON 37
eH1_8                 1.609061e-01 1 1  ON 38
eH1_9                 4.634035e-02 1 1  ON 39
eH2_0                -2.356633e-01 1 1  ON 40
eH2_1                -1.352910e-01 1 1  ON 41
eH2_2                -8.787005e-02 1 1  ON 42
eH2_3                -3.387319e-02 1 1  ON 43
eH2_4                 1.363857e-02 1 1  ON 44
eH2_5                 4.673560e-02 1 1  ON 45
eH2_6                 1.035830e-01 1 1  ON 46
eH2_7                 1.501695e-01 1 1  ON 47
eH2_8                 1.660938e-01 1 1  ON 48
eH2_9                 2.989136e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5483e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6916e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.941
    reference variance = 0.297682
====================================================
  Execution time = 2.0389e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4238e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6436e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342375098869
                                         uncertainty =       0.008865423969

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342375098869
                                         uncertainty =       0.008865423969

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413749767
  error estimate for blocks of size 2^( 2) =       0.000426344464
  error estimate for blocks of size 2^( 3) =       0.000439294133
  error estimate for blocks of size 2^( 4) =       0.000451632403
  error estimate for blocks of size 2^( 5) =       0.000460845985
  error estimate for blocks of size 2^( 6) =       0.000468090451
  error estimate for blocks of size 2^( 7) =       0.000475855421

      target function =                  N/A
              le_mean =     -16.906272925117
             les_mean =     286.164441787223
             stat err =       0.000464106065
             autocorr =       1.258226890962
              std dev =       0.585130532326
             le_variance =       0.342377739860


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690627292512e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-02, overlap shift 1.5625e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906272925117       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906278463994       residual = 4.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906281366430       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906278963589       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906272706271       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906282186933       residual = 3.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906289429583       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906291812455       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906291800931       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906296698080       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906291939538       residual = 8.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906291707802       residual = 4.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906298146975       residual = 2.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906297909276       residual = 8.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906298103835       residual = 8.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.906298016618       residual = 4.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.906298886910       residual = 2.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.906299477153       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.906299065884       residual = 1.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.906298952015       residual = 8.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         19 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-02 is 1.390614e-02

solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906272925117       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906277337714       residual = 3.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906279339047       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906277311672       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906273442465       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906278148849       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906281804430       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906283229311       residual = 4.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906282785022       residual = 4.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906283196860       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906282458390       residual = 7.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906281398833       residual = 3.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906282665425       residual = 9.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 3.375414e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906272925117       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906275358493       residual = 3.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906276244367       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906275441857       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906274157117       residual = 9.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906274075787       residual = 4.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906276228865       residual = 1.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906276258209       residual = 7.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906276140778       residual = 3.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906276472068       residual = 8.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 9.891996e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.025038 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6045e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.095042e-01 1 1  ON 0
 uu_1                 1.425867e-01 1 1  ON 1
 uu_2                 4.115423e-02 1 1  ON 2
 uu_3                -2.084240e-02 1 1  ON 3
 uu_4                -6.581213e-02 1 1  ON 4
 uu_5                -9.904550e-02 1 1  ON 5
 uu_6                -1.246230e-01 1 1  ON 6
 uu_7                -1.370127e-01 1 1  ON 7
 uu_8                -1.292740e-01 1 1  ON 8
 uu_9                -9.827960e-02 1 1  ON 9
 ud_0                 4.458457e-01 1 1  ON 10
 ud_1                 1.801761e-01 1 1  ON 11
 ud_2                 5.997843e-02 1 1  ON 12
 ud_3                -1.086302e-02 1 1  ON 13
 ud_4                -6.756999e-02 1 1  ON 14
 ud_5                -1.079291e-01 1 1  ON 15
 ud_6                -1.343975e-01 1 1  ON 16
 ud_7                -1.495124e-01 1 1  ON 17
 ud_8                -1.497870e-01 1 1  ON 18
 ud_9                -1.385374e-01 1 1  ON 19
 eO_0                -7.555396e-01 1 1  ON 20
 eO_1                -4.350863e-01 1 1  ON 21
 eO_2                -1.849247e-02 1 1  ON 22
 eO_3                 2.974584e-01 1 1  ON 23
 eO_4                 5.181341e-01 1 1  ON 24
 eO_5                 4.754681e-01 1 1  ON 25
 eO_6                 2.458175e-01 1 1  ON 26
 eO_7                -4.946856e-02 1 1  ON 27
 eO_8                -2.093452e-01 1 1  ON 28
 eO_9                -7.016804e-02 1 1  ON 29
eH1_0                -2.416042e-01 1 1  ON 30
eH1_1                -1.393074e-01 1 1  ON 31
eH1_2                -9.232328e-02 1 1  ON 32
eH1_3                -3.812986e-02 1 1  ON 33
eH1_4                 1.073026e-02 1 1  ON 34
eH1_5                 4.406200e-02 1 1  ON 35
eH1_6                 1.005804e-01 1 1  ON 36
eH1_7                 1.482209e-01 1 1  ON 37
eH1_8                 1.625666e-01 1 1  ON 38
eH1_9                 4.883985e-02 1 1  ON 39
eH2_0                -2.377786e-01 1 1  ON 40
eH2_1                -1.357241e-01 1 1  ON 41
eH2_2                -8.928591e-02 1 1  ON 42
eH2_3                -3.519245e-02 1 1  ON 43
eH2_4                 1.294646e-02 1 1  ON 44
eH2_5                 4.625946e-02 1 1  ON 45
eH2_6                 1.027554e-01 1 1  ON 46
eH2_7                 1.513287e-01 1 1  ON 47
eH2_8                 1.690350e-01 1 1  ON 48
eH2_9                 3.326677e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.9063
    reference variance = 0.292475
====================================================
  Execution time = 2.0270e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3920e-01
  Total weights = 2.0000e+06
  Execution time = 1.8994e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338438418928
                                         uncertainty =       0.005015465857

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338438418928
                                         uncertainty =       0.005015465857

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411420177
  error estimate for blocks of size 2^( 2) =       0.000424681318
  error estimate for blocks of size 2^( 3) =       0.000438180647
  error estimate for blocks of size 2^( 4) =       0.000450831559
  error estimate for blocks of size 2^( 5) =       0.000462933466
  error estimate for blocks of size 2^( 6) =       0.000471757708
  error estimate for blocks of size 2^( 7) =       0.000477210490

      target function =                  N/A
              le_mean =     -16.906017865736
             les_mean =     286.151973031680
             stat err =       0.000465683306
             autocorr =       1.281180042517
              std dev =       0.581835994391
             le_variance =       0.338533124370

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339646158415
                                         uncertainty =       0.004991812429

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339646158415
                                         uncertainty =       0.004991812429

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412153945
  error estimate for blocks of size 2^( 2) =       0.000425379414
  error estimate for blocks of size 2^( 3) =       0.000438813030
  error estimate for blocks of size 2^( 4) =       0.000451399976
  error estimate for blocks of size 2^( 5) =       0.000463462976
  error estimate for blocks of size 2^( 6) =       0.000472264166
  error estimate for blocks of size 2^( 7) =       0.000477718030

      target function =                  N/A
              le_mean =     -16.906006893816
             les_mean =     286.152810672391
             stat err =       0.000466211287
             autocorr =       1.279518723757
              std dev =       0.582873698579
             le_variance =       0.339741748495

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339801647783
                                         uncertainty =       0.005000135078

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339801647783
                                         uncertainty =       0.005000135078

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412248051
  error estimate for blocks of size 2^( 2) =       0.000425468492
  error estimate for blocks of size 2^( 3) =       0.000438905307
  error estimate for blocks of size 2^( 4) =       0.000451501448
  error estimate for blocks of size 2^( 5) =       0.000463575527
  error estimate for blocks of size 2^( 6) =       0.000472399924
  error estimate for blocks of size 2^( 7) =       0.000477849627

      target function =                  N/A
              le_mean =     -16.906003270716
             les_mean =     286.152843330172
             stat err =       0.000466331631
             autocorr =       1.279594981055
              std dev =       0.583006784397
             le_variance =       0.339896910653

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338745119800
                                         uncertainty =       0.005013738146

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338745119800
                                         uncertainty =       0.005013738146

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411606513
  error estimate for blocks of size 2^( 2) =       0.000424856833
  error estimate for blocks of size 2^( 3) =       0.000438342029
  error estimate for blocks of size 2^( 4) =       0.000450981600
  error estimate for blocks of size 2^( 5) =       0.000463078703
  error estimate for blocks of size 2^( 6) =       0.000471905372
  error estimate for blocks of size 2^( 7) =       0.000477354468

      target function =                  N/A
              le_mean =     -16.906011211893
             les_mean =     286.152054770576
             stat err =       0.000465830036
             autocorr =       1.280827071501
              std dev =       0.582099513253
             le_variance =       0.338839843329


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906017865736        initial  <--
     1.5625e-02     1.5625e-01             1.3906e-02       -16.906006893816
     6.2500e-02     6.2500e-01             3.3754e-03       -16.906003270716
     2.5000e-01     2.5000e+00             9.8920e-04       -16.906011211893

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8350
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.086442e-01 1 1  ON 0
 uu_1                 1.421199e-01 1 1  ON 1
 uu_2                 4.079677e-02 1 1  ON 2
 uu_3                -2.119557e-02 1 1  ON 3
 uu_4                -6.577435e-02 1 1  ON 4
 uu_5                -9.903746e-02 1 1  ON 5
 uu_6                -1.245956e-01 1 1  ON 6
 uu_7                -1.365934e-01 1 1  ON 7
 uu_8                -1.283973e-01 1 1  ON 8
 uu_9                -9.588841e-02 1 1  ON 9
 ud_0                 4.441917e-01 1 1  ON 10
 ud_1                 1.788006e-01 1 1  ON 11
 ud_2                 5.891081e-02 1 1  ON 12
 ud_3                -1.165112e-02 1 1  ON 13
 ud_4                -6.765812e-02 1 1  ON 14
 ud_5                -1.073940e-01 1 1  ON 15
 ud_6                -1.340880e-01 1 1  ON 16
 ud_7                -1.487943e-01 1 1  ON 17
 ud_8                -1.490968e-01 1 1  ON 18
 ud_9                -1.374529e-01 1 1  ON 19
 eO_0                -7.540677e-01 1 1  ON 20
 eO_1                -4.340900e-01 1 1  ON 21
 eO_2                -1.796707e-02 1 1  ON 22
 eO_3                 2.974061e-01 1 1  ON 23
 eO_4                 5.164880e-01 1 1  ON 24
 eO_5                 4.729064e-01 1 1  ON 25
 eO_6                 2.432419e-01 1 1  ON 26
 eO_7                -5.119852e-02 1 1  ON 27
 eO_8                -2.069651e-01 1 1  ON 28
 eO_9                -6.743314e-02 1 1  ON 29
eH1_0                -2.388808e-01 1 1  ON 30
eH1_1                -1.382709e-01 1 1  ON 31
eH1_2                -9.094900e-02 1 1  ON 32
eH1_3                -3.703137e-02 1 1  ON 33
eH1_4                 1.114886e-02 1 1  ON 34
eH1_5                 4.375007e-02 1 1  ON 35
eH1_6                 9.951808e-02 1 1  ON 36
eH1_7                 1.473753e-01 1 1  ON 37
eH1_8                 1.609061e-01 1 1  ON 38
eH1_9                 4.634035e-02 1 1  ON 39
eH2_0                -2.356633e-01 1 1  ON 40
eH2_1                -1.352910e-01 1 1  ON 41
eH2_2                -8.787005e-02 1 1  ON 42
eH2_3                -3.387319e-02 1 1  ON 43
eH2_4                 1.363857e-02 1 1  ON 44
eH2_5                 4.673560e-02 1 1  ON 45
eH2_6                 1.035830e-01 1 1  ON 46
eH2_7                 1.501695e-01 1 1  ON 47
eH2_8                 1.660938e-01 1 1  ON 48
eH2_9                 2.989136e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5886e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6918e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.9245
    reference variance = 0.286296
====================================================
  Execution time = 2.2327e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3466e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6250e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334572191476
                                         uncertainty =       0.003464804077

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334572191476
                                         uncertainty =       0.003464804077

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409057930
  error estimate for blocks of size 2^( 2) =       0.000421383419
  error estimate for blocks of size 2^( 3) =       0.000434087436
  error estimate for blocks of size 2^( 4) =       0.000446509387
  error estimate for blocks of size 2^( 5) =       0.000456965271
  error estimate for blocks of size 2^( 6) =       0.000464322330
  error estimate for blocks of size 2^( 7) =       0.000470058578

      target function =                  N/A
              le_mean =     -16.906129373246
             les_mean =     286.151866997482
             stat err =       0.000459463891
             autocorr =       1.261633292375
              std dev =       0.578495272147
             le_variance =       0.334656779896


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690612937325e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906129373246       residual = 7.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906130520112       residual = 5.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906130654733       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906134559546       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906134104739       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906135505718       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906135873875       residual = 4.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906135858733       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906136160909       residual = 3.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906136278310       residual = 2.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906136053114       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906136091754       residual = 2.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 1.635742e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906129373246       residual = 7.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906129854899       residual = 5.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906129780394       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906131207579       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906131951477       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906131300646       residual = 2.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906131435344       residual = 6.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906131442391       residual = 2.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906131467255       residual = 4.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 4.072520e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906129373246       residual = 7.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906129518317       residual = 5.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906129480978       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906129808491       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906130110410       residual = 7.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906129946736       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906129951620       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906129950746       residual = 5.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 1.021551e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.028623 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7959e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.086951e-01 1 1  ON 0
 uu_1                 1.421357e-01 1 1  ON 1
 uu_2                 4.082046e-02 1 1  ON 2
 uu_3                -2.110901e-02 1 1  ON 3
 uu_4                -6.567952e-02 1 1  ON 4
 uu_5                -9.895415e-02 1 1  ON 5
 uu_6                -1.247118e-01 1 1  ON 6
 uu_7                -1.366385e-01 1 1  ON 7
 uu_8                -1.284690e-01 1 1  ON 8
 uu_9                -9.619879e-02 1 1  ON 9
 ud_0                 4.445064e-01 1 1  ON 10
 ud_1                 1.790954e-01 1 1  ON 11
 ud_2                 5.899472e-02 1 1  ON 12
 ud_3                -1.156196e-02 1 1  ON 13
 ud_4                -6.753976e-02 1 1  ON 14
 ud_5                -1.074851e-01 1 1  ON 15
 ud_6                -1.341787e-01 1 1  ON 16
 ud_7                -1.488561e-01 1 1  ON 17
 ud_8                -1.492796e-01 1 1  ON 18
 ud_9                -1.377814e-01 1 1  ON 19
 eO_0                -7.543002e-01 1 1  ON 20
 eO_1                -4.340929e-01 1 1  ON 21
 eO_2                -1.792060e-02 1 1  ON 22
 eO_3                 2.973260e-01 1 1  ON 23
 eO_4                 5.166938e-01 1 1  ON 24
 eO_5                 4.732145e-01 1 1  ON 25
 eO_6                 2.435038e-01 1 1  ON 26
 eO_7                -5.105868e-02 1 1  ON 27
 eO_8                -2.072710e-01 1 1  ON 28
 eO_9                -6.773103e-02 1 1  ON 29
eH1_0                -2.392648e-01 1 1  ON 30
eH1_1                -1.383802e-01 1 1  ON 31
eH1_2                -9.115245e-02 1 1  ON 32
eH1_3                -3.722208e-02 1 1  ON 33
eH1_4                 1.107843e-02 1 1  ON 34
eH1_5                 4.377618e-02 1 1  ON 35
eH1_6                 9.964419e-02 1 1  ON 36
eH1_7                 1.475391e-01 1 1  ON 37
eH1_8                 1.613133e-01 1 1  ON 38
eH1_9                 4.661635e-02 1 1  ON 39
eH2_0                -2.358315e-01 1 1  ON 40
eH2_1                -1.353669e-01 1 1  ON 41
eH2_2                -8.791515e-02 1 1  ON 42
eH2_3                -3.399964e-02 1 1  ON 43
eH2_4                 1.356295e-02 1 1  ON 44
eH2_5                 4.684252e-02 1 1  ON 45
eH2_6                 1.036091e-01 1 1  ON 46
eH2_7                 1.501175e-01 1 1  ON 47
eH2_8                 1.662189e-01 1 1  ON 48
eH2_9                 3.018619e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.8761
    reference variance = 0.320162
====================================================
  Execution time = 1.9999e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3151e-01
  Total weights = 2.0000e+06
  Execution time = 1.8916e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331401852439
                                         uncertainty =       0.002934640938

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331401852439
                                         uncertainty =       0.002934640938

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407034242
  error estimate for blocks of size 2^( 2) =       0.000420081834
  error estimate for blocks of size 2^( 3) =       0.000433138027
  error estimate for blocks of size 2^( 4) =       0.000445070148
  error estimate for blocks of size 2^( 5) =       0.000456379760
  error estimate for blocks of size 2^( 6) =       0.000466314892
  error estimate for blocks of size 2^( 7) =       0.000473314340

      target function =                  N/A
              le_mean =     -16.905762291122
             les_mean =     286.136152225939
             stat err =       0.000460269785
             autocorr =       1.278683440555
              std dev =       0.575633344837
             le_variance =       0.331353747688

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331777719790
                                         uncertainty =       0.002938160638

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331777719790
                                         uncertainty =       0.002938160638

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407265089
  error estimate for blocks of size 2^( 2) =       0.000420297464
  error estimate for blocks of size 2^( 3) =       0.000433332974
  error estimate for blocks of size 2^( 4) =       0.000445243173
  error estimate for blocks of size 2^( 5) =       0.000456536375
  error estimate for blocks of size 2^( 6) =       0.000466465072
  error estimate for blocks of size 2^( 7) =       0.000473474353

      target function =                  N/A
              le_mean =     -16.905762620365
             les_mean =     286.136539315952
             stat err =       0.000460429743
             autocorr =       1.278122187248
              std dev =       0.575959812558
             le_variance =       0.331729705682

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331714574896
                                         uncertainty =       0.002937816763

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331714574896
                                         uncertainty =       0.002937816763

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407226291
  error estimate for blocks of size 2^( 2) =       0.000420260752
  error estimate for blocks of size 2^( 3) =       0.000433301512
  error estimate for blocks of size 2^( 4) =       0.000445217354
  error estimate for blocks of size 2^( 5) =       0.000456515299
  error estimate for blocks of size 2^( 6) =       0.000466445416
  error estimate for blocks of size 2^( 7) =       0.000473455923

      target function =                  N/A
              le_mean =     -16.905762186119
             les_mean =     286.136461431160
             stat err =       0.000460408498
             autocorr =       1.278247773980
              std dev =       0.575904943014
             le_variance =       0.331666503388

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331448378124
                                         uncertainty =       0.002935142895

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331448378124
                                         uncertainty =       0.002935142895

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407062819
  error estimate for blocks of size 2^( 2) =       0.000420108354
  error estimate for blocks of size 2^( 3) =       0.000433162247
  error estimate for blocks of size 2^( 4) =       0.000445091975
  error estimate for blocks of size 2^( 5) =       0.000456399905
  error estimate for blocks of size 2^( 6) =       0.000466334169
  error estimate for blocks of size 2^( 7) =       0.000473335653

      target function =                  N/A
              le_mean =     -16.905762154549
             les_mean =     286.136194137501
             stat err =       0.000460290425
             autocorr =       1.278618579130
              std dev =       0.575673759180
             le_variance =       0.331400277008


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905762291122        initial
     1.5625e-01     1.5625e+00             1.6357e-03       -16.905762620365  <--
     6.2500e-01     6.2500e+00             4.0725e-04       -16.905762186119
     2.5000e+00     2.5000e+01             1.0216e-04       -16.905762154549

*****************************************************************************
Applying the update for shift_i =   1.5625e-01     and shift_s =   1.5625e+00
*****************************************************************************

  Execution time = 2.9547e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.088598e-01 1 1  ON 0
 uu_1                 1.422652e-01 1 1  ON 1
 uu_2                 4.094525e-02 1 1  ON 2
 uu_3                -2.091768e-02 1 1  ON 3
 uu_4                -6.551961e-02 1 1  ON 4
 uu_5                -9.883274e-02 1 1  ON 5
 uu_6                -1.249396e-01 1 1  ON 6
 uu_7                -1.368474e-01 1 1  ON 7
 uu_8                -1.286439e-01 1 1  ON 8
 uu_9                -9.705595e-02 1 1  ON 9
 ud_0                 4.451813e-01 1 1  ON 10
 ud_1                 1.796860e-01 1 1  ON 11
 ud_2                 5.939641e-02 1 1  ON 12
 ud_3                -1.125855e-02 1 1  ON 13
 ud_4                -6.730672e-02 1 1  ON 14
 ud_5                -1.075617e-01 1 1  ON 15
 ud_6                -1.343630e-01 1 1  ON 16
 ud_7                -1.490690e-01 1 1  ON 17
 ud_8                -1.496727e-01 1 1  ON 18
 ud_9                -1.386753e-01 1 1  ON 19
 eO_0                -7.547586e-01 1 1  ON 20
 eO_1                -4.342786e-01 1 1  ON 21
 eO_2                -1.795430e-02 1 1  ON 22
 eO_3                 2.972980e-01 1 1  ON 23
 eO_4                 5.172380e-01 1 1  ON 24
 eO_5                 4.740841e-01 1 1  ON 25
 eO_6                 2.442692e-01 1 1  ON 26
 eO_7                -5.062404e-02 1 1  ON 27
 eO_8                -2.081505e-01 1 1  ON 28
 eO_9                -6.862845e-02 1 1  ON 29
eH1_0                -2.401838e-01 1 1  ON 30
eH1_1                -1.388641e-01 1 1  ON 31
eH1_2                -9.172258e-02 1 1  ON 32
eH1_3                -3.773116e-02 1 1  ON 33
eH1_4                 1.078383e-02 1 1  ON 34
eH1_5                 4.378331e-02 1 1  ON 35
eH1_6                 9.996427e-02 1 1  ON 36
eH1_7                 1.480212e-01 1 1  ON 37
eH1_8                 1.625418e-01 1 1  ON 38
eH1_9                 4.747406e-02 1 1  ON 39
eH2_0                -2.362831e-01 1 1  ON 40
eH2_1                -1.356283e-01 1 1  ON 41
eH2_2                -8.817251e-02 1 1  ON 42
eH2_3                -3.427361e-02 1 1  ON 43
eH2_4                 1.336767e-02 1 1  ON 44
eH2_5                 4.700364e-02 1 1  ON 45
eH2_6                 1.037119e-01 1 1  ON 46
eH2_7                 1.500214e-01 1 1  ON 47
eH2_8                 1.666083e-01 1 1  ON 48
eH2_9                 3.109297e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7512e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6914e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.947
    reference variance = 0.250529
====================================================
  Execution time = 2.0490e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3603e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5788e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336137906287
                                         uncertainty =       0.005129047535

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336137906287
                                         uncertainty =       0.005129047535

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409894965
  error estimate for blocks of size 2^( 2) =       0.000422633191
  error estimate for blocks of size 2^( 3) =       0.000435960634
  error estimate for blocks of size 2^( 4) =       0.000449043382
  error estimate for blocks of size 2^( 5) =       0.000461062009
  error estimate for blocks of size 2^( 6) =       0.000468993960
  error estimate for blocks of size 2^( 7) =       0.000476948413

      target function =                  N/A
              le_mean =     -16.905847694491
             les_mean =     286.143713866331
             stat err =       0.000464011941
             autocorr =       1.281483877106
              std dev =       0.579679018970
             le_variance =       0.336027765034


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690584769449e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905847694491       residual = 3.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905847764082       residual = 5.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905850926726       residual = 3.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905848673405       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905849092176       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905850117833       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905853837747       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905855053441       residual = 5.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905855521412       residual = 5.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905856420385       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905856960418       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905856966129       residual = 5.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905857225905       residual = 2.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905857930644       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.905857394593       residual = 5.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         14 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-02 is 6.398874e-03

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905847694491       residual = 3.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905847743507       residual = 4.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905849445130       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905848105817       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905847739201       residual = 9.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905848118686       residual = 7.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905849620709       residual = 4.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905849869630       residual = 5.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905849759019       residual = 4.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905849724029       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905850068314       residual = 3.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 1.601246e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905847694491       residual = 3.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905847716948       residual = 4.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905848115448       residual = 8.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905847505367       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905847764846       residual = 8.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905847375855       residual = 2.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905847881885       residual = 8.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905848040843       residual = 2.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905847997242       residual = 4.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 3.996829e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.033800 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6078e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.093224e-01 1 1  ON 0
 uu_1                 1.421538e-01 1 1  ON 1
 uu_2                 4.091520e-02 1 1  ON 2
 uu_3                -2.096544e-02 1 1  ON 3
 uu_4                -6.555445e-02 1 1  ON 4
 uu_5                -9.847082e-02 1 1  ON 5
 uu_6                -1.251822e-01 1 1  ON 6
 uu_7                -1.373233e-01 1 1  ON 7
 uu_8                -1.293284e-01 1 1  ON 8
 uu_9                -9.765799e-02 1 1  ON 9
 ud_0                 4.459925e-01 1 1  ON 10
 ud_1                 1.801217e-01 1 1  ON 11
 ud_2                 5.958676e-02 1 1  ON 12
 ud_3                -1.114982e-02 1 1  ON 13
 ud_4                -6.756607e-02 1 1  ON 14
 ud_5                -1.078898e-01 1 1  ON 15
 ud_6                -1.344299e-01 1 1  ON 16
 ud_7                -1.495388e-01 1 1  ON 17
 ud_8                -1.502859e-01 1 1  ON 18
 ud_9                -1.387591e-01 1 1  ON 19
 eO_0                -7.557407e-01 1 1  ON 20
 eO_1                -4.350132e-01 1 1  ON 21
 eO_2                -1.819586e-02 1 1  ON 22
 eO_3                 2.976004e-01 1 1  ON 23
 eO_4                 5.181814e-01 1 1  ON 24
 eO_5                 4.753612e-01 1 1  ON 25
 eO_6                 2.451936e-01 1 1  ON 26
 eO_7                -5.044434e-02 1 1  ON 27
 eO_8                -2.090774e-01 1 1  ON 28
 eO_9                -6.931675e-02 1 1  ON 29
eH1_0                -2.410281e-01 1 1  ON 30
eH1_1                -1.391158e-01 1 1  ON 31
eH1_2                -9.227631e-02 1 1  ON 32
eH1_3                -3.825045e-02 1 1  ON 33
eH1_4                 9.882588e-03 1 1  ON 34
eH1_5                 4.346910e-02 1 1  ON 35
eH1_6                 1.001542e-01 1 1  ON 36
eH1_7                 1.488976e-01 1 1  ON 37
eH1_8                 1.636820e-01 1 1  ON 38
eH1_9                 4.851299e-02 1 1  ON 39
eH2_0                -2.372077e-01 1 1  ON 40
eH2_1                -1.359584e-01 1 1  ON 41
eH2_2                -8.881291e-02 1 1  ON 42
eH2_3                -3.475589e-02 1 1  ON 43
eH2_4                 1.346636e-02 1 1  ON 44
eH2_5                 4.666030e-02 1 1  ON 45
eH2_6                 1.031225e-01 1 1  ON 46
eH2_7                 1.501652e-01 1 1  ON 47
eH2_8                 1.678494e-01 1 1  ON 48
eH2_9                 3.269421e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.9079
    reference variance = 0.180969
====================================================
  Execution time = 2.0311e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4751e-01
  Total weights = 2.0000e+06
  Execution time = 1.8991e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346965092094
                                         uncertainty =       0.008082373593

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346965092094
                                         uncertainty =       0.008082373593

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416434482
  error estimate for blocks of size 2^( 2) =       0.000428689529
  error estimate for blocks of size 2^( 3) =       0.000441991692
  error estimate for blocks of size 2^( 4) =       0.000454332472
  error estimate for blocks of size 2^( 5) =       0.000465024809
  error estimate for blocks of size 2^( 6) =       0.000473731484
  error estimate for blocks of size 2^( 7) =       0.000480570102

      target function =                  N/A
              le_mean =     -16.905168196858
             les_mean =     286.131546945421
             stat err =       0.000468414716
             autocorr =       1.265224801929
              std dev =       0.588927291589
             le_variance =       0.346835354779

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348176839020
                                         uncertainty =       0.008124126514

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348176839020
                                         uncertainty =       0.008124126514

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417160986
  error estimate for blocks of size 2^( 2) =       0.000429390724
  error estimate for blocks of size 2^( 3) =       0.000442651560
  error estimate for blocks of size 2^( 4) =       0.000454934443
  error estimate for blocks of size 2^( 5) =       0.000465575072
  error estimate for blocks of size 2^( 6) =       0.000474264846
  error estimate for blocks of size 2^( 7) =       0.000481109250

      target function =                  N/A
              le_mean =     -16.905162028868
             les_mean =     286.132549624837
             stat err =       0.000468970903
             autocorr =       1.263817675625
              std dev =       0.589954724182
             le_variance =       0.348046576585

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348333116305
                                         uncertainty =       0.008133944355

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348333116305
                                         uncertainty =       0.008133944355

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417254642
  error estimate for blocks of size 2^( 2) =       0.000429478047
  error estimate for blocks of size 2^( 3) =       0.000442738241
  error estimate for blocks of size 2^( 4) =       0.000455026671
  error estimate for blocks of size 2^( 5) =       0.000465674021
  error estimate for blocks of size 2^( 6) =       0.000474370333
  error estimate for blocks of size 2^( 7) =       0.000481220147

      target function =                  N/A
              le_mean =     -16.905162021693
             les_mean =     286.132705677994
             stat err =       0.000469072793
             autocorr =       1.263799367981
              std dev =       0.590087173572
             le_variance =       0.348202872414

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347277745292
                                         uncertainty =       0.008093957222

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347277745292
                                         uncertainty =       0.008093957222

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416622062
  error estimate for blocks of size 2^( 2) =       0.000428868970
  error estimate for blocks of size 2^( 3) =       0.000442161774
  error estimate for blocks of size 2^( 4) =       0.000454491906
  error estimate for blocks of size 2^( 5) =       0.000465175656
  error estimate for blocks of size 2^( 6) =       0.000473880769
  error estimate for blocks of size 2^( 7) =       0.000480722011

      target function =                  N/A
              le_mean =     -16.905165987240
             les_mean =     286.131784766928
             stat err =       0.000468567585
             autocorr =       1.264910961700
              std dev =       0.589192569852
             le_variance =       0.347147884369


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905168196858        initial  <--
     3.9062e-02     3.9062e-01             6.3989e-03       -16.905162028868
     1.5625e-01     1.5625e+00             1.6012e-03       -16.905162021693
     6.2500e-01     6.2500e+00             3.9968e-04       -16.905165987240

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8666
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.088598e-01 1 1  ON 0
 uu_1                 1.422652e-01 1 1  ON 1
 uu_2                 4.094525e-02 1 1  ON 2
 uu_3                -2.091768e-02 1 1  ON 3
 uu_4                -6.551961e-02 1 1  ON 4
 uu_5                -9.883274e-02 1 1  ON 5
 uu_6                -1.249396e-01 1 1  ON 6
 uu_7                -1.368474e-01 1 1  ON 7
 uu_8                -1.286439e-01 1 1  ON 8
 uu_9                -9.705595e-02 1 1  ON 9
 ud_0                 4.451813e-01 1 1  ON 10
 ud_1                 1.796860e-01 1 1  ON 11
 ud_2                 5.939641e-02 1 1  ON 12
 ud_3                -1.125855e-02 1 1  ON 13
 ud_4                -6.730672e-02 1 1  ON 14
 ud_5                -1.075617e-01 1 1  ON 15
 ud_6                -1.343630e-01 1 1  ON 16
 ud_7                -1.490690e-01 1 1  ON 17
 ud_8                -1.496727e-01 1 1  ON 18
 ud_9                -1.386753e-01 1 1  ON 19
 eO_0                -7.547586e-01 1 1  ON 20
 eO_1                -4.342786e-01 1 1  ON 21
 eO_2                -1.795430e-02 1 1  ON 22
 eO_3                 2.972980e-01 1 1  ON 23
 eO_4                 5.172380e-01 1 1  ON 24
 eO_5                 4.740841e-01 1 1  ON 25
 eO_6                 2.442692e-01 1 1  ON 26
 eO_7                -5.062404e-02 1 1  ON 27
 eO_8                -2.081505e-01 1 1  ON 28
 eO_9                -6.862845e-02 1 1  ON 29
eH1_0                -2.401838e-01 1 1  ON 30
eH1_1                -1.388641e-01 1 1  ON 31
eH1_2                -9.172258e-02 1 1  ON 32
eH1_3                -3.773116e-02 1 1  ON 33
eH1_4                 1.078383e-02 1 1  ON 34
eH1_5                 4.378331e-02 1 1  ON 35
eH1_6                 9.996427e-02 1 1  ON 36
eH1_7                 1.480212e-01 1 1  ON 37
eH1_8                 1.625418e-01 1 1  ON 38
eH1_9                 4.747406e-02 1 1  ON 39
eH2_0                -2.362831e-01 1 1  ON 40
eH2_1                -1.356283e-01 1 1  ON 41
eH2_2                -8.817251e-02 1 1  ON 42
eH2_3                -3.427361e-02 1 1  ON 43
eH2_4                 1.336767e-02 1 1  ON 44
eH2_5                 4.700364e-02 1 1  ON 45
eH2_6                 1.037119e-01 1 1  ON 46
eH2_7                 1.500214e-01 1 1  ON 47
eH2_8                 1.666083e-01 1 1  ON 48
eH2_9                 3.109297e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5951e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6916e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.832
    reference variance = 0.232548
====================================================
  Execution time = 2.0426e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4172e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6438e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341549317941
                                         uncertainty =       0.005699787338

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341549317941
                                         uncertainty =       0.005699787338

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413351102
  error estimate for blocks of size 2^( 2) =       0.000425394676
  error estimate for blocks of size 2^( 3) =       0.000437778301
  error estimate for blocks of size 2^( 4) =       0.000449229411
  error estimate for blocks of size 2^( 5) =       0.000459211491
  error estimate for blocks of size 2^( 6) =       0.000466276980
  error estimate for blocks of size 2^( 7) =       0.000472496378

      target function =                  N/A
              le_mean =     -16.905714577148
             les_mean =     286.144903459597
             stat err =       0.000461803565
             autocorr =       1.248177540996
              std dev =       0.584566733968
             le_variance =       0.341718266462


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690571457715e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905714577148       residual = 4.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905714825885       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905715637370       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905714895746       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905714582216       residual = 5.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905714791061       residual = 3.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905715254728       residual = 6.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905715229092       residual = 2.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905715273374       residual = 6.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-01 is 5.135771e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905714577148       residual = 4.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905714660227       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905714971767       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905714739486       residual = 9.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905714643658       residual = 4.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905714643542       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905714769682       residual = 2.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905714782682       residual = 6.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 1.353393e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905714577148       residual = 4.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905714599822       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905714689616       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905714629524       residual = 8.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905714606382       residual = 4.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905714600994       residual = 9.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905714628732       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905714634911       residual = 4.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 3.453535e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.036650 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6077e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.088500e-01 1 1  ON 0
 uu_1                 1.423173e-01 1 1  ON 1
 uu_2                 4.095048e-02 1 1  ON 2
 uu_3                -2.090271e-02 1 1  ON 3
 uu_4                -6.551462e-02 1 1  ON 4
 uu_5                -9.887633e-02 1 1  ON 5
 uu_6                -1.249572e-01 1 1  ON 6
 uu_7                -1.368614e-01 1 1  ON 7
 uu_8                -1.287181e-01 1 1  ON 8
 uu_9                -9.713736e-02 1 1  ON 9
 ud_0                 4.452508e-01 1 1  ON 10
 ud_1                 1.797183e-01 1 1  ON 11
 ud_2                 5.944044e-02 1 1  ON 12
 ud_3                -1.124796e-02 1 1  ON 13
 ud_4                -6.733493e-02 1 1  ON 14
 ud_5                -1.075758e-01 1 1  ON 15
 ud_6                -1.343106e-01 1 1  ON 16
 ud_7                -1.491156e-01 1 1  ON 17
 ud_8                -1.497615e-01 1 1  ON 18
 ud_9                -1.386844e-01 1 1  ON 19
 eO_0                -7.547804e-01 1 1  ON 20
 eO_1                -4.343425e-01 1 1  ON 21
 eO_2                -1.803399e-02 1 1  ON 22
 eO_3                 2.973268e-01 1 1  ON 23
 eO_4                 5.173733e-01 1 1  ON 24
 eO_5                 4.741159e-01 1 1  ON 25
 eO_6                 2.443690e-01 1 1  ON 26
 eO_7                -5.056009e-02 1 1  ON 27
 eO_8                -2.082458e-01 1 1  ON 28
 eO_9                -6.871620e-02 1 1  ON 29
eH1_0                -2.402654e-01 1 1  ON 30
eH1_1                -1.388444e-01 1 1  ON 31
eH1_2                -9.178709e-02 1 1  ON 32
eH1_3                -3.776009e-02 1 1  ON 33
eH1_4                 1.079001e-02 1 1  ON 34
eH1_5                 4.375235e-02 1 1  ON 35
eH1_6                 9.993004e-02 1 1  ON 36
eH1_7                 1.480337e-01 1 1  ON 37
eH1_8                 1.626324e-01 1 1  ON 38
eH1_9                 4.757296e-02 1 1  ON 39
eH2_0                -2.363565e-01 1 1  ON 40
eH2_1                -1.356190e-01 1 1  ON 41
eH2_2                -8.825162e-02 1 1  ON 42
eH2_3                -3.433388e-02 1 1  ON 43
eH2_4                 1.334031e-02 1 1  ON 44
eH2_5                 4.704101e-02 1 1  ON 45
eH2_6                 1.036125e-01 1 1  ON 46
eH2_7                 1.500744e-01 1 1  ON 47
eH2_8                 1.667367e-01 1 1  ON 48
eH2_9                 3.120671e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.86
    reference variance = 0.313945
====================================================
  Execution time = 1.9966e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3180e-01
  Total weights = 2.0000e+06
  Execution time = 1.8887e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331714944290
                                         uncertainty =       0.003199051579

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331714944290
                                         uncertainty =       0.003199051579

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407285970
  error estimate for blocks of size 2^( 2) =       0.000420028004
  error estimate for blocks of size 2^( 3) =       0.000432921935
  error estimate for blocks of size 2^( 4) =       0.000445280249
  error estimate for blocks of size 2^( 5) =       0.000456367519
  error estimate for blocks of size 2^( 6) =       0.000467047136
  error estimate for blocks of size 2^( 7) =       0.000470540308

      target function =                  N/A
              le_mean =     -16.906116810254
             les_mean =     286.148549159317
             stat err =       0.000459808803
             autocorr =       1.274546434758
              std dev =       0.575989343009
             le_variance =       0.331763723260

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331811771803
                                         uncertainty =       0.003199156498

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331811771803
                                         uncertainty =       0.003199156498

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407345449
  error estimate for blocks of size 2^( 2) =       0.000420084960
  error estimate for blocks of size 2^( 3) =       0.000432972639
  error estimate for blocks of size 2^( 4) =       0.000445325982
  error estimate for blocks of size 2^( 5) =       0.000456411340
  error estimate for blocks of size 2^( 6) =       0.000467093937
  error estimate for blocks of size 2^( 7) =       0.000470586754

      target function =                  N/A
              le_mean =     -16.906115933152
             les_mean =     286.148616408393
             stat err =       0.000459854503
             autocorr =       1.274427548593
              std dev =       0.576073458121
             le_variance =       0.331860629151

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331790352162
                                         uncertainty =       0.003199151836

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331790352162
                                         uncertainty =       0.003199151836

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407332294
  error estimate for blocks of size 2^( 2) =       0.000420072443
  error estimate for blocks of size 2^( 3) =       0.000432962106
  error estimate for blocks of size 2^( 4) =       0.000445317163
  error estimate for blocks of size 2^( 5) =       0.000456402815
  error estimate for blocks of size 2^( 6) =       0.000467083983
  error estimate for blocks of size 2^( 7) =       0.000470576487

      target function =                  N/A
              le_mean =     -16.906116031424
             les_mean =     286.148598297552
             stat err =       0.000459845112
             autocorr =       1.274457808945
              std dev =       0.576054854600
             le_variance =       0.331839195508

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331725850604
                                         uncertainty =       0.003199081037

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331725850604
                                         uncertainty =       0.003199081037

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407292671
  error estimate for blocks of size 2^( 2) =       0.000420034431
  error estimate for blocks of size 2^( 3) =       0.000432927766
  error estimate for blocks of size 2^( 4) =       0.000445285630
  error estimate for blocks of size 2^( 5) =       0.000456372650
  error estimate for blocks of size 2^( 6) =       0.000467052450
  error estimate for blocks of size 2^( 7) =       0.000470545510

      target function =                  N/A
              le_mean =     -16.906116688927
             les_mean =     286.148555972732
             stat err =       0.000459814060
             autocorr =       1.274533644082
              std dev =       0.575998818566
             le_variance =       0.331774638989


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906116810254        initial  <--
     3.9062e-01     3.9062e+00             5.1358e-04       -16.906115933152
     1.5625e+00     1.5625e+01             1.3534e-04       -16.906116031424
     6.2500e+00     6.2500e+01             3.4535e-05       -16.906116688927

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.4674
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.088598e-01 1 1  ON 0
 uu_1                 1.422652e-01 1 1  ON 1
 uu_2                 4.094525e-02 1 1  ON 2
 uu_3                -2.091768e-02 1 1  ON 3
 uu_4                -6.551961e-02 1 1  ON 4
 uu_5                -9.883274e-02 1 1  ON 5
 uu_6                -1.249396e-01 1 1  ON 6
 uu_7                -1.368474e-01 1 1  ON 7
 uu_8                -1.286439e-01 1 1  ON 8
 uu_9                -9.705595e-02 1 1  ON 9
 ud_0                 4.451813e-01 1 1  ON 10
 ud_1                 1.796860e-01 1 1  ON 11
 ud_2                 5.939641e-02 1 1  ON 12
 ud_3                -1.125855e-02 1 1  ON 13
 ud_4                -6.730672e-02 1 1  ON 14
 ud_5                -1.075617e-01 1 1  ON 15
 ud_6                -1.343630e-01 1 1  ON 16
 ud_7                -1.490690e-01 1 1  ON 17
 ud_8                -1.496727e-01 1 1  ON 18
 ud_9                -1.386753e-01 1 1  ON 19
 eO_0                -7.547586e-01 1 1  ON 20
 eO_1                -4.342786e-01 1 1  ON 21
 eO_2                -1.795430e-02 1 1  ON 22
 eO_3                 2.972980e-01 1 1  ON 23
 eO_4                 5.172380e-01 1 1  ON 24
 eO_5                 4.740841e-01 1 1  ON 25
 eO_6                 2.442692e-01 1 1  ON 26
 eO_7                -5.062404e-02 1 1  ON 27
 eO_8                -2.081505e-01 1 1  ON 28
 eO_9                -6.862845e-02 1 1  ON 29
eH1_0                -2.401838e-01 1 1  ON 30
eH1_1                -1.388641e-01 1 1  ON 31
eH1_2                -9.172258e-02 1 1  ON 32
eH1_3                -3.773116e-02 1 1  ON 33
eH1_4                 1.078383e-02 1 1  ON 34
eH1_5                 4.378331e-02 1 1  ON 35
eH1_6                 9.996427e-02 1 1  ON 36
eH1_7                 1.480212e-01 1 1  ON 37
eH1_8                 1.625418e-01 1 1  ON 38
eH1_9                 4.747406e-02 1 1  ON 39
eH2_0                -2.362831e-01 1 1  ON 40
eH2_1                -1.356283e-01 1 1  ON 41
eH2_2                -8.817251e-02 1 1  ON 42
eH2_3                -3.427361e-02 1 1  ON 43
eH2_4                 1.336767e-02 1 1  ON 44
eH2_5                 4.700364e-02 1 1  ON 45
eH2_6                 1.037119e-01 1 1  ON 46
eH2_7                 1.500214e-01 1 1  ON 47
eH2_8                 1.666083e-01 1 1  ON 48
eH2_9                 3.109297e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5550e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.9927
    reference variance = 0.243013
====================================================
  Execution time = 2.0346e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4818e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5018e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348203554778
                                         uncertainty =       0.008230902072

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348203554778
                                         uncertainty =       0.008230902072

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417242703
  error estimate for blocks of size 2^( 2) =       0.000429923548
  error estimate for blocks of size 2^( 3) =       0.000443180709
  error estimate for blocks of size 2^( 4) =       0.000455094918
  error estimate for blocks of size 2^( 5) =       0.000466186221
  error estimate for blocks of size 2^( 6) =       0.000475555899
  error estimate for blocks of size 2^( 7) =       0.000479545489

      target function =                  N/A
              le_mean =     -16.906519948141
             les_mean =     286.178599529687
             stat err =       0.000469095632
             autocorr =       1.263994767789
              std dev =       0.590070289787
             le_variance =       0.348182946889


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690651994814e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906519948141       residual = 3.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906520117627       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906520191384       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906519988591       residual = 8.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906519931384       residual = 9.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906519875354       residual = 8.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906519903307       residual = 3.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906519942441       residual = 3.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+00 is 8.849968e-05

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906519948141       residual = 3.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906519992366       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906520011230       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906519958841       residual = 7.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906519942745       residual = 9.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906519930217       residual = 7.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906519936135       residual = 3.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906519945232       residual = 2.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+01 is 2.228812e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906519948141       residual = 3.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906519959320       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906519964065       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906519950864       residual = 7.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906519946674       residual = 9.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906519943683       residual = 7.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906519945085       residual = 3.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906519947311       residual = 2.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+01 is 5.582367e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.039288 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5855e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.088601e-01 1 1  ON 0
 uu_1                 1.422682e-01 1 1  ON 1
 uu_2                 4.094797e-02 1 1  ON 2
 uu_3                -2.091885e-02 1 1  ON 3
 uu_4                -6.551797e-02 1 1  ON 4
 uu_5                -9.883545e-02 1 1  ON 5
 uu_6                -1.249396e-01 1 1  ON 6
 uu_7                -1.368524e-01 1 1  ON 7
 uu_8                -1.286520e-01 1 1  ON 8
 uu_9                -9.706234e-02 1 1  ON 9
 ud_0                 4.451909e-01 1 1  ON 10
 ud_1                 1.796932e-01 1 1  ON 11
 ud_2                 5.939901e-02 1 1  ON 12
 ud_3                -1.125915e-02 1 1  ON 13
 ud_4                -6.730122e-02 1 1  ON 14
 ud_5                -1.075659e-01 1 1  ON 15
 ud_6                -1.343600e-01 1 1  ON 16
 ud_7                -1.490760e-01 1 1  ON 17
 ud_8                -1.496764e-01 1 1  ON 18
 ud_9                -1.386812e-01 1 1  ON 19
 eO_0                -7.547603e-01 1 1  ON 20
 eO_1                -4.342908e-01 1 1  ON 21
 eO_2                -1.795035e-02 1 1  ON 22
 eO_3                 2.972964e-01 1 1  ON 23
 eO_4                 5.172511e-01 1 1  ON 24
 eO_5                 4.740930e-01 1 1  ON 25
 eO_6                 2.442766e-01 1 1  ON 26
 eO_7                -5.061894e-02 1 1  ON 27
 eO_8                -2.081619e-01 1 1  ON 28
 eO_9                -6.863833e-02 1 1  ON 29
eH1_0                -2.401914e-01 1 1  ON 30
eH1_1                -1.388654e-01 1 1  ON 31
eH1_2                -9.172735e-02 1 1  ON 32
eH1_3                -3.773867e-02 1 1  ON 33
eH1_4                 1.077793e-02 1 1  ON 34
eH1_5                 4.378381e-02 1 1  ON 35
eH1_6                 9.995870e-02 1 1  ON 36
eH1_7                 1.480242e-01 1 1  ON 37
eH1_8                 1.625536e-01 1 1  ON 38
eH1_9                 4.748800e-02 1 1  ON 39
eH2_0                -2.363054e-01 1 1  ON 40
eH2_1                -1.356350e-01 1 1  ON 41
eH2_2                -8.817457e-02 1 1  ON 42
eH2_3                -3.427324e-02 1 1  ON 43
eH2_4                 1.337539e-02 1 1  ON 44
eH2_5                 4.700694e-02 1 1  ON 45
eH2_6                 1.037104e-01 1 1  ON 46
eH2_7                 1.500238e-01 1 1  ON 47
eH2_8                 1.666166e-01 1 1  ON 48
eH2_9                 3.110427e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.9434
    reference variance = 0.199076
====================================================
  Execution time = 2.0300e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3647e-01
  Total weights = 2.0000e+06
  Execution time = 1.8866e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336199976087
                                         uncertainty =       0.003818637763

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336199976087
                                         uncertainty =       0.003818637763

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410164151
  error estimate for blocks of size 2^( 2) =       0.000423353441
  error estimate for blocks of size 2^( 3) =       0.000435994552
  error estimate for blocks of size 2^( 4) =       0.000448465643
  error estimate for blocks of size 2^( 5) =       0.000459493018
  error estimate for blocks of size 2^( 6) =       0.000467876841
  error estimate for blocks of size 2^( 7) =       0.000472822019

      target function =                  N/A
              le_mean =     -16.906575795131
             les_mean =     286.168774210101
             stat err =       0.000462164381
             autocorr =       1.269631070941
              std dev =       0.580059705404
             le_variance =       0.336469261834

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336214410930
                                         uncertainty =       0.003819250265

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336214410930
                                         uncertainty =       0.003819250265

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410172942
  error estimate for blocks of size 2^( 2) =       0.000423361735
  error estimate for blocks of size 2^( 3) =       0.000436002004
  error estimate for blocks of size 2^( 4) =       0.000448472432
  error estimate for blocks of size 2^( 5) =       0.000459499476
  error estimate for blocks of size 2^( 6) =       0.000467882908
  error estimate for blocks of size 2^( 7) =       0.000472827241

      target function =                  N/A
              le_mean =     -16.906575903553
             les_mean =     286.168792299077
             stat err =       0.000462170514
             autocorr =       1.269610350165
              std dev =       0.580072137504
             le_variance =       0.336483684708

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336207326881
                                         uncertainty =       0.003818962531

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336207326881
                                         uncertainty =       0.003818962531

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410168628
  error estimate for blocks of size 2^( 2) =       0.000423357661
  error estimate for blocks of size 2^( 3) =       0.000435998338
  error estimate for blocks of size 2^( 4) =       0.000448469094
  error estimate for blocks of size 2^( 5) =       0.000459496300
  error estimate for blocks of size 2^( 6) =       0.000467879916
  error estimate for blocks of size 2^( 7) =       0.000472824653

      target function =                  N/A
              le_mean =     -16.906575851058
             les_mean =     286.168783445422
             stat err =       0.000462167491
             autocorr =       1.269620448063
              std dev =       0.580066035964
             le_variance =       0.336476606079

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336200897081
                                         uncertainty =       0.003818678984

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336200897081
                                         uncertainty =       0.003818678984

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410164712
  error estimate for blocks of size 2^( 2) =       0.000423353969
  error estimate for blocks of size 2^( 3) =       0.000435995026
  error estimate for blocks of size 2^( 4) =       0.000448466075
  error estimate for blocks of size 2^( 5) =       0.000459493429
  error estimate for blocks of size 2^( 6) =       0.000467877226
  error estimate for blocks of size 2^( 7) =       0.000472822348

      target function =                  N/A
              le_mean =     -16.906575802039
             les_mean =     286.168775363842
             stat err =       0.000462164769
             autocorr =       1.269629735289
              std dev =       0.580060498559
             le_variance =       0.336470181989


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906575795131        initial
     3.9062e+00     3.9062e+01             8.8500e-05       -16.906575903553  <--
     1.5625e+01     1.5625e+02             2.2288e-05       -16.906575851058
     6.2500e+01     6.2500e+02             5.5824e-06       -16.906575802039

*****************************************************************************
Applying the update for shift_i =   3.9062e+00     and shift_s =   3.9062e+01
*****************************************************************************

  Execution time = 2.9832e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.088610e-01 1 1  ON 0
 uu_1                 1.422773e-01 1 1  ON 1
 uu_2                 4.095561e-02 1 1  ON 2
 uu_3                -2.092165e-02 1 1  ON 3
 uu_4                -6.551373e-02 1 1  ON 4
 uu_5                -9.884315e-02 1 1  ON 5
 uu_6                -1.249395e-01 1 1  ON 6
 uu_7                -1.368670e-01 1 1  ON 7
 uu_8                -1.286763e-01 1 1  ON 8
 uu_9                -9.708148e-02 1 1  ON 9
 ud_0                 4.452191e-01 1 1  ON 10
 ud_1                 1.797137e-01 1 1  ON 11
 ud_2                 5.940749e-02 1 1  ON 12
 ud_3                -1.126000e-02 1 1  ON 13
 ud_4                -6.728598e-02 1 1  ON 14
 ud_5                -1.075773e-01 1 1  ON 15
 ud_6                -1.343516e-01 1 1  ON 16
 ud_7                -1.490965e-01 1 1  ON 17
 ud_8                -1.496875e-01 1 1  ON 18
 ud_9                -1.386989e-01 1 1  ON 19
 eO_0                -7.547666e-01 1 1  ON 20
 eO_1                -4.343249e-01 1 1  ON 21
 eO_2                -1.793997e-02 1 1  ON 22
 eO_3                 2.972916e-01 1 1  ON 23
 eO_4                 5.172903e-01 1 1  ON 24
 eO_5                 4.741194e-01 1 1  ON 25
 eO_6                 2.442987e-01 1 1  ON 26
 eO_7                -5.060369e-02 1 1  ON 27
 eO_8                -2.081958e-01 1 1  ON 28
 eO_9                -6.866784e-02 1 1  ON 29
eH1_0                -2.402142e-01 1 1  ON 30
eH1_1                -1.388700e-01 1 1  ON 31
eH1_2                -9.174212e-02 1 1  ON 32
eH1_3                -3.776030e-02 1 1  ON 33
eH1_4                 1.076020e-02 1 1  ON 34
eH1_5                 4.378545e-02 1 1  ON 35
eH1_6                 9.994223e-02 1 1  ON 36
eH1_7                 1.480331e-01 1 1  ON 37
eH1_8                 1.625887e-01 1 1  ON 38
eH1_9                 4.752963e-02 1 1  ON 39
eH2_0                -2.363716e-01 1 1  ON 40
eH2_1                -1.356546e-01 1 1  ON 41
eH2_2                -8.818125e-02 1 1  ON 42
eH2_3                -3.427205e-02 1 1  ON 43
eH2_4                 1.339768e-02 1 1  ON 44
eH2_5                 4.701710e-02 1 1  ON 45
eH2_6                 1.037060e-01 1 1  ON 46
eH2_7                 1.500310e-01 1 1  ON 47
eH2_8                 1.666413e-01 1 1  ON 48
eH2_9                 3.113798e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5693e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6914e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.9614
    reference variance = 0.248653
====================================================
  Execution time = 2.0628e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3778e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5093e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337815628205
                                         uncertainty =       0.003229678366

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337815628205
                                         uncertainty =       0.003229678366

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410964978
  error estimate for blocks of size 2^( 2) =       0.000423835080
  error estimate for blocks of size 2^( 3) =       0.000437623321
  error estimate for blocks of size 2^( 4) =       0.000450225759
  error estimate for blocks of size 2^( 5) =       0.000460576253
  error estimate for blocks of size 2^( 6) =       0.000466595221
  error estimate for blocks of size 2^( 7) =       0.000473044131

      target function =                  N/A
              le_mean =     -16.905791010106
             les_mean =     286.143553935384
             stat err =       0.000462610341
             autocorr =       1.267129627268
              std dev =       0.581192246064
             le_variance =       0.337784426885


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690579101011e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905791010106       residual = 3.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905791762656       residual = 3.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905792281155       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905791987520       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905791741366       residual = 6.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905791489013       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905791638131       residual = 7.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905791800880       residual = 1.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905791856597       residual = 3.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-01 is 2.340352e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905791010106       residual = 3.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905791217566       residual = 4.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905791389975       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905791322653       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905791259387       residual = 5.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905791191018       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905791227107       residual = 3.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905791250946       residual = 8.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+00 is 6.108553e-05

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905791010106       residual = 3.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905791063338       residual = 4.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905791110254       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905791093999       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905791078643       residual = 5.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905791061602       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905791070389       residual = 2.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905791075090       residual = 6.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+01 is 1.543588e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.042153 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6144e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.088698e-01 1 1  ON 0
 uu_1                 1.422936e-01 1 1  ON 1
 uu_2                 4.096883e-02 1 1  ON 2
 uu_3                -2.091045e-02 1 1  ON 3
 uu_4                -6.551250e-02 1 1  ON 4
 uu_5                -9.888635e-02 1 1  ON 5
 uu_6                -1.249276e-01 1 1  ON 6
 uu_7                -1.368947e-01 1 1  ON 7
 uu_8                -1.287108e-01 1 1  ON 8
 uu_9                -9.709690e-02 1 1  ON 9
 ud_0                 4.452550e-01 1 1  ON 10
 ud_1                 1.797378e-01 1 1  ON 11
 ud_2                 5.939659e-02 1 1  ON 12
 ud_3                -1.123216e-02 1 1  ON 13
 ud_4                -6.728198e-02 1 1  ON 14
 ud_5                -1.075987e-01 1 1  ON 15
 ud_6                -1.343191e-01 1 1  ON 16
 ud_7                -1.491235e-01 1 1  ON 17
 ud_8                -1.497236e-01 1 1  ON 18
 ud_9                -1.387181e-01 1 1  ON 19
 eO_0                -7.547945e-01 1 1  ON 20
 eO_1                -4.343453e-01 1 1  ON 21
 eO_2                -1.793364e-02 1 1  ON 22
 eO_3                 2.972615e-01 1 1  ON 23
 eO_4                 5.173367e-01 1 1  ON 24
 eO_5                 4.741695e-01 1 1  ON 25
 eO_6                 2.443504e-01 1 1  ON 26
 eO_7                -5.059761e-02 1 1  ON 27
 eO_8                -2.082414e-01 1 1  ON 28
 eO_9                -6.870095e-02 1 1  ON 29
eH1_0                -2.402260e-01 1 1  ON 30
eH1_1                -1.388946e-01 1 1  ON 31
eH1_2                -9.176602e-02 1 1  ON 32
eH1_3                -3.776232e-02 1 1  ON 33
eH1_4                 1.073392e-02 1 1  ON 34
eH1_5                 4.375848e-02 1 1  ON 35
eH1_6                 9.992073e-02 1 1  ON 36
eH1_7                 1.480549e-01 1 1  ON 37
eH1_8                 1.626446e-01 1 1  ON 38
eH1_9                 4.758086e-02 1 1  ON 39
eH2_0                -2.364327e-01 1 1  ON 40
eH2_1                -1.356565e-01 1 1  ON 41
eH2_2                -8.820429e-02 1 1  ON 42
eH2_3                -3.431490e-02 1 1  ON 43
eH2_4                 1.340734e-02 1 1  ON 44
eH2_5                 4.703772e-02 1 1  ON 45
eH2_6                 1.036856e-01 1 1  ON 46
eH2_7                 1.500563e-01 1 1  ON 47
eH2_8                 1.666822e-01 1 1  ON 48
eH2_9                 3.118996e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.9044
    reference variance = 0.169183
====================================================
  Execution time = 2.0241e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4273e-01
  Total weights = 2.0000e+06
  Execution time = 1.8981e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342732781557
                                         uncertainty =       0.004204520438

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342732781557
                                         uncertainty =       0.004204520438

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413943116
  error estimate for blocks of size 2^( 2) =       0.000426430876
  error estimate for blocks of size 2^( 3) =       0.000439256004
  error estimate for blocks of size 2^( 4) =       0.000451243991
  error estimate for blocks of size 2^( 5) =       0.000460926957
  error estimate for blocks of size 2^( 6) =       0.000466228110
  error estimate for blocks of size 2^( 7) =       0.000470200343

      target function =                  N/A
              le_mean =     -16.906744299139
             les_mean =     286.180700431178
             stat err =       0.000462149850
             autocorr =       1.246477102037
              std dev =       0.585403968257
             le_variance =       0.342697806052

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342835446531
                                         uncertainty =       0.004205264787

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342835446531
                                         uncertainty =       0.004205264787

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414005125
  error estimate for blocks of size 2^( 2) =       0.000426488213
  error estimate for blocks of size 2^( 3) =       0.000439308752
  error estimate for blocks of size 2^( 4) =       0.000451293050
  error estimate for blocks of size 2^( 5) =       0.000460973238
  error estimate for blocks of size 2^( 6) =       0.000466274662
  error estimate for blocks of size 2^( 7) =       0.000470245868

      target function =                  N/A
              le_mean =     -16.906744712482
             les_mean =     286.180817089432
             stat err =       0.000462196704
             autocorr =       1.246356415433
              std dev =       0.585491663313
             le_variance =       0.342800487809

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342797677161
                                         uncertainty =       0.004204915668

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342797677161
                                         uncertainty =       0.004204915668

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413982314
  error estimate for blocks of size 2^( 2) =       0.000426467095
  error estimate for blocks of size 2^( 3) =       0.000439289439
  error estimate for blocks of size 2^( 4) =       0.000451275311
  error estimate for blocks of size 2^( 5) =       0.000460956661
  error estimate for blocks of size 2^( 6) =       0.000466258012
  error estimate for blocks of size 2^( 7) =       0.000470229591

      target function =                  N/A
              le_mean =     -16.906744445530
             les_mean =     286.180770287742
             stat err =       0.000462179894
             autocorr =       1.246403103057
              std dev =       0.585459403094
             le_variance =       0.342762712671

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342741391847
                                         uncertainty =       0.004204570148

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342741391847
                                         uncertainty =       0.004204570148

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413948317
  error estimate for blocks of size 2^( 2) =       0.000426435676
  error estimate for blocks of size 2^( 3) =       0.000439260430
  error estimate for blocks of size 2^( 4) =       0.000451248140
  error estimate for blocks of size 2^( 5) =       0.000460930888
  error estimate for blocks of size 2^( 6) =       0.000466232067
  error estimate for blocks of size 2^( 7) =       0.000470204201

      target function =                  N/A
              le_mean =     -16.906744310871
             les_mean =     286.180709439352
             stat err =       0.000462153824
             autocorr =       1.246467217039
              std dev =       0.585411323381
             le_variance =       0.342706417542


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906744299139        initial
     9.7656e-01     9.7656e+00             2.3404e-04       -16.906744712482  <--
     3.9062e+00     3.9062e+01             6.1086e-05       -16.906744445530
     1.5625e+01     1.5625e+02             1.5436e-05       -16.906744310871

*****************************************************************************
Applying the update for shift_i =   9.7656e-01     and shift_s =   9.7656e+00
*****************************************************************************

  Execution time = 2.9802e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.089001e-01 1 1  ON 0
 uu_1                 1.423329e-01 1 1  ON 1
 uu_2                 4.100575e-02 1 1  ON 2
 uu_3                -2.087956e-02 1 1  ON 3
 uu_4                -6.551322e-02 1 1  ON 4
 uu_5                -9.898908e-02 1 1  ON 5
 uu_6                -1.249148e-01 1 1  ON 6
 uu_7                -1.369754e-01 1 1  ON 7
 uu_8                -1.288089e-01 1 1  ON 8
 uu_9                -9.714327e-02 1 1  ON 9
 ud_0                 4.453492e-01 1 1  ON 10
 ud_1                 1.798034e-01 1 1  ON 11
 ud_2                 5.939515e-02 1 1  ON 12
 ud_3                -1.117231e-02 1 1  ON 13
 ud_4                -6.726643e-02 1 1  ON 14
 ud_5                -1.076419e-01 1 1  ON 15
 ud_6                -1.342510e-01 1 1  ON 16
 ud_7                -1.491945e-01 1 1  ON 17
 ud_8                -1.498230e-01 1 1  ON 18
 ud_9                -1.387757e-01 1 1  ON 19
 eO_0                -7.548742e-01 1 1  ON 20
 eO_1                -4.344109e-01 1 1  ON 21
 eO_2                -1.792943e-02 1 1  ON 22
 eO_3                 2.971921e-01 1 1  ON 23
 eO_4                 5.174700e-01 1 1  ON 24
 eO_5                 4.743192e-01 1 1  ON 25
 eO_6                 2.445059e-01 1 1  ON 26
 eO_7                -5.057540e-02 1 1  ON 27
 eO_8                -2.083795e-01 1 1  ON 28
 eO_9                -6.880252e-02 1 1  ON 29
eH1_0                -2.402673e-01 1 1  ON 30
eH1_1                -1.389693e-01 1 1  ON 31
eH1_2                -9.183346e-02 1 1  ON 32
eH1_3                -3.777813e-02 1 1  ON 33
eH1_4                 1.066171e-02 1 1  ON 34
eH1_5                 4.367777e-02 1 1  ON 35
eH1_6                 9.985419e-02 1 1  ON 36
eH1_7                 1.481199e-01 1 1  ON 37
eH1_8                 1.628157e-01 1 1  ON 38
eH1_9                 4.773850e-02 1 1  ON 39
eH2_0                -2.366057e-01 1 1  ON 40
eH2_1                -1.356768e-01 1 1  ON 41
eH2_2                -8.828399e-02 1 1  ON 42
eH2_3                -3.442254e-02 1 1  ON 43
eH2_4                 1.342214e-02 1 1  ON 44
eH2_5                 4.709656e-02 1 1  ON 45
eH2_6                 1.036264e-01 1 1  ON 46
eH2_7                 1.501343e-01 1 1  ON 47
eH2_8                 1.668081e-01 1 1  ON 48
eH2_9                 3.134984e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5951e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6916e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.8746
    reference variance = 0.314742
====================================================
  Execution time = 2.0656e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4086e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5717e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340948679559
                                         uncertainty =       0.007635754161

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340948679559
                                         uncertainty =       0.007635754161

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412831256
  error estimate for blocks of size 2^( 2) =       0.000425687357
  error estimate for blocks of size 2^( 3) =       0.000438898756
  error estimate for blocks of size 2^( 4) =       0.000450574504
  error estimate for blocks of size 2^( 5) =       0.000461800244
  error estimate for blocks of size 2^( 6) =       0.000469229055
  error estimate for blocks of size 2^( 7) =       0.000475905449

      target function =                  N/A
              le_mean =     -16.905176382538
             les_mean =     286.125847646578
             stat err =       0.000464377313
             autocorr =       1.265309726548
              std dev =       0.583831561566
             le_variance =       0.340859292281


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690517638254e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905176382538       residual = 4.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905175289698       residual = 3.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905176395908       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905174122459       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905174769117       residual = 7.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905176813724       residual = 5.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905176895778       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905176058718       residual = 6.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905175988771       residual = 2.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905175919165       residual = 7.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e-01 is 7.507799e-04

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905176382538       residual = 4.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905176029057       residual = 3.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905176288184       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905175432538       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905175745382       residual = 4.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905176188902       residual = 2.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905176307351       residual = 3.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905176187610       residual = 7.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-01 is 1.890594e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905176382538       residual = 4.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905176287162       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905176340723       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905176094600       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905176193956       residual = 3.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905176300164       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905176329844       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905176320165       residual = 3.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+00 is 4.779294e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.045188 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6234e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.090580e-01 1 1  ON 0
 uu_1                 1.424170e-01 1 1  ON 1
 uu_2                 4.102150e-02 1 1  ON 2
 uu_3                -2.084176e-02 1 1  ON 3
 uu_4                -6.548646e-02 1 1  ON 4
 uu_5                -9.907032e-02 1 1  ON 5
 uu_6                -1.250651e-01 1 1  ON 6
 uu_7                -1.370915e-01 1 1  ON 7
 uu_8                -1.288877e-01 1 1  ON 8
 uu_9                -9.721869e-02 1 1  ON 9
 ud_0                 4.455093e-01 1 1  ON 10
 ud_1                 1.798932e-01 1 1  ON 11
 ud_2                 5.945044e-02 1 1  ON 12
 ud_3                -1.113794e-02 1 1  ON 13
 ud_4                -6.727579e-02 1 1  ON 14
 ud_5                -1.076656e-01 1 1  ON 15
 ud_6                -1.342480e-01 1 1  ON 16
 ud_7                -1.492472e-01 1 1  ON 17
 ud_8                -1.499431e-01 1 1  ON 18
 ud_9                -1.388941e-01 1 1  ON 19
 eO_0                -7.549552e-01 1 1  ON 20
 eO_1                -4.345113e-01 1 1  ON 21
 eO_2                -1.789403e-02 1 1  ON 22
 eO_3                 2.971738e-01 1 1  ON 23
 eO_4                 5.175408e-01 1 1  ON 24
 eO_5                 4.744945e-01 1 1  ON 25
 eO_6                 2.446950e-01 1 1  ON 26
 eO_7                -5.052917e-02 1 1  ON 27
 eO_8                -2.085468e-01 1 1  ON 28
 eO_9                -6.893715e-02 1 1  ON 29
eH1_0                -2.404390e-01 1 1  ON 30
eH1_1                -1.391067e-01 1 1  ON 31
eH1_2                -9.188659e-02 1 1  ON 32
eH1_3                -3.790428e-02 1 1  ON 33
eH1_4                 1.063381e-02 1 1  ON 34
eH1_5                 4.383020e-02 1 1  ON 35
eH1_6                 9.983377e-02 1 1  ON 36
eH1_7                 1.481389e-01 1 1  ON 37
eH1_8                 1.629685e-01 1 1  ON 38
eH1_9                 4.791936e-02 1 1  ON 39
eH2_0                -2.367274e-01 1 1  ON 40
eH2_1                -1.357273e-01 1 1  ON 41
eH2_2                -8.844820e-02 1 1  ON 42
eH2_3                -3.452489e-02 1 1  ON 43
eH2_4                 1.348955e-02 1 1  ON 44
eH2_5                 4.712038e-02 1 1  ON 45
eH2_6                 1.035972e-01 1 1  ON 46
eH2_7                 1.502208e-01 1 1  ON 47
eH2_8                 1.669380e-01 1 1  ON 48
eH2_9                 3.152457e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.8437
    reference variance = 0.287389
====================================================
  Execution time = 2.2260e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3930e-01
  Total weights = 2.0000e+06
  Execution time = 1.8879e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339117028327
                                         uncertainty =       0.003779863356

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339117028327
                                         uncertainty =       0.003779863356

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411803029
  error estimate for blocks of size 2^( 2) =       0.000424769951
  error estimate for blocks of size 2^( 3) =       0.000437808506
  error estimate for blocks of size 2^( 4) =       0.000450629495
  error estimate for blocks of size 2^( 5) =       0.000461223901
  error estimate for blocks of size 2^( 6) =       0.000468181741
  error estimate for blocks of size 2^( 7) =       0.000474528085

      target function =                  N/A
              le_mean =     -16.906169342931
             les_mean =     286.157725151255
             stat err =       0.000463640805
             autocorr =       1.267605836043
              std dev =       0.582377428277
             le_variance =       0.339163468966

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339444217218
                                         uncertainty =       0.003784293349

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339444217218
                                         uncertainty =       0.003784293349

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412001600
  error estimate for blocks of size 2^( 2) =       0.000424958346
  error estimate for blocks of size 2^( 3) =       0.000437982538
  error estimate for blocks of size 2^( 4) =       0.000450787871
  error estimate for blocks of size 2^( 5) =       0.000461373723
  error estimate for blocks of size 2^( 6) =       0.000468328508
  error estimate for blocks of size 2^( 7) =       0.000474676972

      target function =                  N/A
              le_mean =     -16.906168928458
             les_mean =     286.158038305276
             stat err =       0.000463791769
             autocorr =       1.267209052537
              std dev =       0.582658251013
             le_variance =       0.339490637474

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339383380873
                                         uncertainty =       0.003783237462

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339383380873
                                         uncertainty =       0.003783237462

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411964683
  error estimate for blocks of size 2^( 2) =       0.000424923508
  error estimate for blocks of size 2^( 3) =       0.000437951711
  error estimate for blocks of size 2^( 4) =       0.000450761605
  error estimate for blocks of size 2^( 5) =       0.000461350394
  error estimate for blocks of size 2^( 6) =       0.000468306642
  error estimate for blocks of size 2^( 7) =       0.000474653360

      target function =                  N/A
              le_mean =     -16.906168971112
             les_mean =     286.157978909358
             stat err =       0.000463768000
             autocorr =       1.267306279474
              std dev =       0.582606041231
             le_variance =       0.339429799279

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339156792283
                                         uncertainty =       0.003780375355

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339156792283
                                         uncertainty =       0.003780375355

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411827166
  error estimate for blocks of size 2^( 2) =       0.000424792877
  error estimate for blocks of size 2^( 3) =       0.000437829954
  error estimate for blocks of size 2^( 4) =       0.000450649370
  error estimate for blocks of size 2^( 5) =       0.000461242985
  error estimate for blocks of size 2^( 6) =       0.000468200590
  error estimate for blocks of size 2^( 7) =       0.000474546881

      target function =                  N/A
              le_mean =     -16.906169263229
             les_mean =     286.157762216137
             stat err =       0.000463659956
             autocorr =       1.267561962320
              std dev =       0.582411563058
             le_variance =       0.339203228783


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906169342931        initial  <--
     2.4414e-01     2.4414e+00             7.5078e-04       -16.906168928458
     9.7656e-01     9.7656e+00             1.8906e-04       -16.906168971112
     3.9062e+00     3.9062e+01             4.7793e-05       -16.906169263229

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.7784
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.089001e-01 1 1  ON 0
 uu_1                 1.423329e-01 1 1  ON 1
 uu_2                 4.100575e-02 1 1  ON 2
 uu_3                -2.087956e-02 1 1  ON 3
 uu_4                -6.551322e-02 1 1  ON 4
 uu_5                -9.898908e-02 1 1  ON 5
 uu_6                -1.249148e-01 1 1  ON 6
 uu_7                -1.369754e-01 1 1  ON 7
 uu_8                -1.288089e-01 1 1  ON 8
 uu_9                -9.714327e-02 1 1  ON 9
 ud_0                 4.453492e-01 1 1  ON 10
 ud_1                 1.798034e-01 1 1  ON 11
 ud_2                 5.939515e-02 1 1  ON 12
 ud_3                -1.117231e-02 1 1  ON 13
 ud_4                -6.726643e-02 1 1  ON 14
 ud_5                -1.076419e-01 1 1  ON 15
 ud_6                -1.342510e-01 1 1  ON 16
 ud_7                -1.491945e-01 1 1  ON 17
 ud_8                -1.498230e-01 1 1  ON 18
 ud_9                -1.387757e-01 1 1  ON 19
 eO_0                -7.548742e-01 1 1  ON 20
 eO_1                -4.344109e-01 1 1  ON 21
 eO_2                -1.792943e-02 1 1  ON 22
 eO_3                 2.971921e-01 1 1  ON 23
 eO_4                 5.174700e-01 1 1  ON 24
 eO_5                 4.743192e-01 1 1  ON 25
 eO_6                 2.445059e-01 1 1  ON 26
 eO_7                -5.057540e-02 1 1  ON 27
 eO_8                -2.083795e-01 1 1  ON 28
 eO_9                -6.880252e-02 1 1  ON 29
eH1_0                -2.402673e-01 1 1  ON 30
eH1_1                -1.389693e-01 1 1  ON 31
eH1_2                -9.183346e-02 1 1  ON 32
eH1_3                -3.777813e-02 1 1  ON 33
eH1_4                 1.066171e-02 1 1  ON 34
eH1_5                 4.367777e-02 1 1  ON 35
eH1_6                 9.985419e-02 1 1  ON 36
eH1_7                 1.481199e-01 1 1  ON 37
eH1_8                 1.628157e-01 1 1  ON 38
eH1_9                 4.773850e-02 1 1  ON 39
eH2_0                -2.366057e-01 1 1  ON 40
eH2_1                -1.356768e-01 1 1  ON 41
eH2_2                -8.828399e-02 1 1  ON 42
eH2_3                -3.442254e-02 1 1  ON 43
eH2_4                 1.342214e-02 1 1  ON 44
eH2_5                 4.709656e-02 1 1  ON 45
eH2_6                 1.036264e-01 1 1  ON 46
eH2_7                 1.501343e-01 1 1  ON 47
eH2_8                 1.668081e-01 1 1  ON 48
eH2_9                 3.134984e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8019e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.8933
    reference variance = 0.275425
====================================================
  Execution time = 2.0771e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4274e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5827e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341517057649
                                         uncertainty =       0.004688669277

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341517057649
                                         uncertainty =       0.004688669277

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413967012
  error estimate for blocks of size 2^( 2) =       0.000426235623
  error estimate for blocks of size 2^( 3) =       0.000439658946
  error estimate for blocks of size 2^( 4) =       0.000452378584
  error estimate for blocks of size 2^( 5) =       0.000462800950
  error estimate for blocks of size 2^( 6) =       0.000471662742
  error estimate for blocks of size 2^( 7) =       0.000480486686

      target function =                  N/A
              le_mean =     -16.905542783081
             les_mean =     286.140113994056
             stat err =       0.000466832240
             autocorr =       1.271716227303
              std dev =       0.585437763424
             le_variance =       0.342737374843


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690554278308e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905542783081       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905543153657       residual = 4.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905543143086       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905543115179       residual = 7.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905543212554       residual = 6.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905543286536       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905543377839       residual = 3.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905543377301       residual = 1.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905543350740       residual = 1.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+00 is 8.409369e-05

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905542783081       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905542881836       residual = 4.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905542879695       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905542872432       residual = 6.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905542894772       residual = 6.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905542916283       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905542937822       residual = 2.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905542938357       residual = 6.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+00 is 2.058230e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905542783081       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905542808184       residual = 4.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905542807691       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905542805865       residual = 6.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905542811307       residual = 6.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905542816946       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905542822212       residual = 2.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905542822379       residual = 5.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+01 is 5.150329e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.048026 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6363e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.089122e-01 1 1  ON 0
 uu_1                 1.423286e-01 1 1  ON 1
 uu_2                 4.100487e-02 1 1  ON 2
 uu_3                -2.087584e-02 1 1  ON 3
 uu_4                -6.551871e-02 1 1  ON 4
 uu_5                -9.899646e-02 1 1  ON 5
 uu_6                -1.249070e-01 1 1  ON 6
 uu_7                -1.369781e-01 1 1  ON 7
 uu_8                -1.288209e-01 1 1  ON 8
 uu_9                -9.715589e-02 1 1  ON 9
 ud_0                 4.453632e-01 1 1  ON 10
 ud_1                 1.798062e-01 1 1  ON 11
 ud_2                 5.940309e-02 1 1  ON 12
 ud_3                -1.116351e-02 1 1  ON 13
 ud_4                -6.726755e-02 1 1  ON 14
 ud_5                -1.076470e-01 1 1  ON 15
 ud_6                -1.342407e-01 1 1  ON 16
 ud_7                -1.491936e-01 1 1  ON 17
 ud_8                -1.498372e-01 1 1  ON 18
 ud_9                -1.387937e-01 1 1  ON 19
 eO_0                -7.548801e-01 1 1  ON 20
 eO_1                -4.344216e-01 1 1  ON 21
 eO_2                -1.793812e-02 1 1  ON 22
 eO_3                 2.972003e-01 1 1  ON 23
 eO_4                 5.174799e-01 1 1  ON 24
 eO_5                 4.743361e-01 1 1  ON 25
 eO_6                 2.445240e-01 1 1  ON 26
 eO_7                -5.056681e-02 1 1  ON 27
 eO_8                -2.083982e-01 1 1  ON 28
 eO_9                -6.881822e-02 1 1  ON 29
eH1_0                -2.402816e-01 1 1  ON 30
eH1_1                -1.389690e-01 1 1  ON 31
eH1_2                -9.184040e-02 1 1  ON 32
eH1_3                -3.778738e-02 1 1  ON 33
eH1_4                 1.064255e-02 1 1  ON 34
eH1_5                 4.367248e-02 1 1  ON 35
eH1_6                 9.985901e-02 1 1  ON 36
eH1_7                 1.481343e-01 1 1  ON 37
eH1_8                 1.628363e-01 1 1  ON 38
eH1_9                 4.775569e-02 1 1  ON 39
eH2_0                -2.366206e-01 1 1  ON 40
eH2_1                -1.356756e-01 1 1  ON 41
eH2_2                -8.829401e-02 1 1  ON 42
eH2_3                -3.443893e-02 1 1  ON 43
eH2_4                 1.342120e-02 1 1  ON 44
eH2_5                 4.709899e-02 1 1  ON 45
eH2_6                 1.036321e-01 1 1  ON 46
eH2_7                 1.501367e-01 1 1  ON 47
eH2_8                 1.668196e-01 1 1  ON 48
eH2_9                 3.136934e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.8806
    reference variance = 0.198601
====================================================
  Execution time = 2.0015e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3304e-01
  Total weights = 2.0000e+06
  Execution time = 1.9007e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332976539827
                                         uncertainty =       0.002588771737

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332976539827
                                         uncertainty =       0.002588771737

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408064969
  error estimate for blocks of size 2^( 2) =       0.000421539408
  error estimate for blocks of size 2^( 3) =       0.000434607554
  error estimate for blocks of size 2^( 4) =       0.000447519264
  error estimate for blocks of size 2^( 5) =       0.000459711554
  error estimate for blocks of size 2^( 6) =       0.000469663503
  error estimate for blocks of size 2^( 7) =       0.000476455329

      target function =                  N/A
              le_mean =     -16.905927849407
             les_mean =     286.143430321127
             stat err =       0.000463337413
             autocorr =       1.289246943599
              std dev =       0.577091013856
             le_variance =       0.333034038273

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333001933518
                                         uncertainty =       0.002588868294

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333001933518
                                         uncertainty =       0.002588868294

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408080527
  error estimate for blocks of size 2^( 2) =       0.000421554821
  error estimate for blocks of size 2^( 3) =       0.000434622750
  error estimate for blocks of size 2^( 4) =       0.000447534345
  error estimate for blocks of size 2^( 5) =       0.000459726634
  error estimate for blocks of size 2^( 6) =       0.000469677244
  error estimate for blocks of size 2^( 7) =       0.000476469829

      target function =                  N/A
              le_mean =     -16.905927730590
             les_mean =     286.143451697770
             stat err =       0.000463352013
             autocorr =       1.289229891252
              std dev =       0.577113015243
             le_variance =       0.333059432363

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332991892713
                                         uncertainty =       0.002588835695

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332991892713
                                         uncertainty =       0.002588835695

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408074375
  error estimate for blocks of size 2^( 2) =       0.000421548699
  error estimate for blocks of size 2^( 3) =       0.000434616698
  error estimate for blocks of size 2^( 4) =       0.000447528315
  error estimate for blocks of size 2^( 5) =       0.000459720590
  error estimate for blocks of size 2^( 6) =       0.000469671764
  error estimate for blocks of size 2^( 7) =       0.000476463977

      target function =                  N/A
              le_mean =     -16.905927776086
             les_mean =     286.143443194778
             stat err =       0.000463346162
             autocorr =       1.289236198796
              std dev =       0.577104315589
             le_variance =       0.333049391072

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332978526332
                                         uncertainty =       0.002588780073

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332978526332
                                         uncertainty =       0.002588780073

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408066186
  error estimate for blocks of size 2^( 2) =       0.000421540610
  error estimate for blocks of size 2^( 3) =       0.000434608737
  error estimate for blocks of size 2^( 4) =       0.000447520434
  error estimate for blocks of size 2^( 5) =       0.000459712721
  error estimate for blocks of size 2^( 6) =       0.000469664571
  error estimate for blocks of size 2^( 7) =       0.000476456445

      target function =                  N/A
              le_mean =     -16.905927839749
             les_mean =     286.143431981050
             stat err =       0.000463338543
             autocorr =       1.289245541598
              std dev =       0.577092734978
             le_variance =       0.333036024764


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905927849407        initial  <--
     2.4414e+00     2.4414e+01             8.4094e-05       -16.905927730590
     9.7656e+00     9.7656e+01             2.0582e-05       -16.905927776086
     3.9062e+01     3.9062e+02             5.1503e-06       -16.905927839749

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6136
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.089001e-01 1 1  ON 0
 uu_1                 1.423329e-01 1 1  ON 1
 uu_2                 4.100575e-02 1 1  ON 2
 uu_3                -2.087956e-02 1 1  ON 3
 uu_4                -6.551322e-02 1 1  ON 4
 uu_5                -9.898908e-02 1 1  ON 5
 uu_6                -1.249148e-01 1 1  ON 6
 uu_7                -1.369754e-01 1 1  ON 7
 uu_8                -1.288089e-01 1 1  ON 8
 uu_9                -9.714327e-02 1 1  ON 9
 ud_0                 4.453492e-01 1 1  ON 10
 ud_1                 1.798034e-01 1 1  ON 11
 ud_2                 5.939515e-02 1 1  ON 12
 ud_3                -1.117231e-02 1 1  ON 13
 ud_4                -6.726643e-02 1 1  ON 14
 ud_5                -1.076419e-01 1 1  ON 15
 ud_6                -1.342510e-01 1 1  ON 16
 ud_7                -1.491945e-01 1 1  ON 17
 ud_8                -1.498230e-01 1 1  ON 18
 ud_9                -1.387757e-01 1 1  ON 19
 eO_0                -7.548742e-01 1 1  ON 20
 eO_1                -4.344109e-01 1 1  ON 21
 eO_2                -1.792943e-02 1 1  ON 22
 eO_3                 2.971921e-01 1 1  ON 23
 eO_4                 5.174700e-01 1 1  ON 24
 eO_5                 4.743192e-01 1 1  ON 25
 eO_6                 2.445059e-01 1 1  ON 26
 eO_7                -5.057540e-02 1 1  ON 27
 eO_8                -2.083795e-01 1 1  ON 28
 eO_9                -6.880252e-02 1 1  ON 29
eH1_0                -2.402673e-01 1 1  ON 30
eH1_1                -1.389693e-01 1 1  ON 31
eH1_2                -9.183346e-02 1 1  ON 32
eH1_3                -3.777813e-02 1 1  ON 33
eH1_4                 1.066171e-02 1 1  ON 34
eH1_5                 4.367777e-02 1 1  ON 35
eH1_6                 9.985419e-02 1 1  ON 36
eH1_7                 1.481199e-01 1 1  ON 37
eH1_8                 1.628157e-01 1 1  ON 38
eH1_9                 4.773850e-02 1 1  ON 39
eH2_0                -2.366057e-01 1 1  ON 40
eH2_1                -1.356768e-01 1 1  ON 41
eH2_2                -8.828399e-02 1 1  ON 42
eH2_3                -3.442254e-02 1 1  ON 43
eH2_4                 1.342214e-02 1 1  ON 44
eH2_5                 4.709656e-02 1 1  ON 45
eH2_6                 1.036264e-01 1 1  ON 46
eH2_7                 1.501343e-01 1 1  ON 47
eH2_8                 1.668081e-01 1 1  ON 48
eH2_9                 3.134984e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5982e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.9164
    reference variance = 0.271963
====================================================
  Execution time = 2.3038e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4981e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5792e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349835441386
                                         uncertainty =       0.007258912960

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349835441386
                                         uncertainty =       0.007258912960

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418213919
  error estimate for blocks of size 2^( 2) =       0.000431057893
  error estimate for blocks of size 2^( 3) =       0.000443584684
  error estimate for blocks of size 2^( 4) =       0.000455487946
  error estimate for blocks of size 2^( 5) =       0.000466813758
  error estimate for blocks of size 2^( 6) =       0.000476471946
  error estimate for blocks of size 2^( 7) =       0.000480678682

      target function =                  N/A
              le_mean =     -16.905696117656
             les_mean =     286.152366812026
             stat err =       0.000469863083
             autocorr =       1.262250878449
              std dev =       0.591443796483
             le_variance =       0.349805764398


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690569611766e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905696117656       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905696160543       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905696172437       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905696196545       residual = 4.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905696200180       residual = 6.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905696202369       residual = 5.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905696206512       residual = 8.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+01 is 9.760048e-06

solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905696117656       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905696128446       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905696131467       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905696137560       residual = 4.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905696138514       residual = 6.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905696139139       residual = 5.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905696140107       residual = 8.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+01 is 2.441911e-06

solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905696117656       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905696120358       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905696121116       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905696122644       residual = 4.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905696122885       residual = 6.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905696123046       residual = 5.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905696123284       residual = 8.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+02 is 6.105952e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.050353 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8624e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.089013e-01 1 1  ON 0
 uu_1                 1.423321e-01 1 1  ON 1
 uu_2                 4.100663e-02 1 1  ON 2
 uu_3                -2.087984e-02 1 1  ON 3
 uu_4                -6.551318e-02 1 1  ON 4
 uu_5                -9.898787e-02 1 1  ON 5
 uu_6                -1.249155e-01 1 1  ON 6
 uu_7                -1.369774e-01 1 1  ON 7
 uu_8                -1.288099e-01 1 1  ON 8
 uu_9                -9.714419e-02 1 1  ON 9
 ud_0                 4.453507e-01 1 1  ON 10
 ud_1                 1.798036e-01 1 1  ON 11
 ud_2                 5.939520e-02 1 1  ON 12
 ud_3                -1.117208e-02 1 1  ON 13
 ud_4                -6.726727e-02 1 1  ON 14
 ud_5                -1.076421e-01 1 1  ON 15
 ud_6                -1.342503e-01 1 1  ON 16
 ud_7                -1.491965e-01 1 1  ON 17
 ud_8                -1.498226e-01 1 1  ON 18
 ud_9                -1.387754e-01 1 1  ON 19
 eO_0                -7.548750e-01 1 1  ON 20
 eO_1                -4.344127e-01 1 1  ON 21
 eO_2                -1.792950e-02 1 1  ON 22
 eO_3                 2.971934e-01 1 1  ON 23
 eO_4                 5.174707e-01 1 1  ON 24
 eO_5                 4.743213e-01 1 1  ON 25
 eO_6                 2.445071e-01 1 1  ON 26
 eO_7                -5.057545e-02 1 1  ON 27
 eO_8                -2.083806e-01 1 1  ON 28
 eO_9                -6.880360e-02 1 1  ON 29
eH1_0                -2.402690e-01 1 1  ON 30
eH1_1                -1.389705e-01 1 1  ON 31
eH1_2                -9.183306e-02 1 1  ON 32
eH1_3                -3.777940e-02 1 1  ON 33
eH1_4                 1.066013e-02 1 1  ON 34
eH1_5                 4.367742e-02 1 1  ON 35
eH1_6                 9.985400e-02 1 1  ON 36
eH1_7                 1.481217e-01 1 1  ON 37
eH1_8                 1.628181e-01 1 1  ON 38
eH1_9                 4.774016e-02 1 1  ON 39
eH2_0                -2.366076e-01 1 1  ON 40
eH2_1                -1.356766e-01 1 1  ON 41
eH2_2                -8.828414e-02 1 1  ON 42
eH2_3                -3.442332e-02 1 1  ON 43
eH2_4                 1.342136e-02 1 1  ON 44
eH2_5                 4.709539e-02 1 1  ON 45
eH2_6                 1.036268e-01 1 1  ON 46
eH2_7                 1.501349e-01 1 1  ON 47
eH2_8                 1.668096e-01 1 1  ON 48
eH2_9                 3.135195e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.9124
    reference variance = 0.191782
====================================================
  Execution time = 1.9937e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4396e-01
  Total weights = 2.0000e+06
  Execution time = 1.8930e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343960597303
                                         uncertainty =       0.008941372946

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343960597303
                                         uncertainty =       0.008941372946

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414705207
  error estimate for blocks of size 2^( 2) =       0.000427305275
  error estimate for blocks of size 2^( 3) =       0.000439715453
  error estimate for blocks of size 2^( 4) =       0.000451467741
  error estimate for blocks of size 2^( 5) =       0.000461545849
  error estimate for blocks of size 2^( 6) =       0.000467568489
  error estimate for blocks of size 2^( 7) =       0.000471021414

      target function =                  N/A
              le_mean =     -16.905210252360
             les_mean =     286.130094321774
             stat err =       0.000462900873
             autocorr =       1.245939699254
              std dev =       0.586481727990
             le_variance =       0.343960817266

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343963827963
                                         uncertainty =       0.008941471290

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343963827963
                                         uncertainty =       0.008941471290

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414707155
  error estimate for blocks of size 2^( 2) =       0.000427307231
  error estimate for blocks of size 2^( 3) =       0.000439717387
  error estimate for blocks of size 2^( 4) =       0.000451469568
  error estimate for blocks of size 2^( 5) =       0.000461547612
  error estimate for blocks of size 2^( 6) =       0.000467570064
  error estimate for blocks of size 2^( 7) =       0.000471022905

      target function =                  N/A
              le_mean =     -16.905210250531
             les_mean =     286.130097490983
             stat err =       0.000462902537
             autocorr =       1.245936950801
              std dev =       0.586484482589
             le_variance =       0.343964048318

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343962226922
                                         uncertainty =       0.008941422714

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343962226922
                                         uncertainty =       0.008941422714

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414706189
  error estimate for blocks of size 2^( 2) =       0.000427306262
  error estimate for blocks of size 2^( 3) =       0.000439716429
  error estimate for blocks of size 2^( 4) =       0.000451468662
  error estimate for blocks of size 2^( 5) =       0.000461546738
  error estimate for blocks of size 2^( 6) =       0.000467569282
  error estimate for blocks of size 2^( 7) =       0.000471022165

      target function =                  N/A
              le_mean =     -16.905210251351
             les_mean =     286.130095917479
             stat err =       0.000462901712
             autocorr =       1.245938308951
              std dev =       0.586483117480
             le_variance =       0.343962447089

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343960801422
                                         uncertainty =       0.008941379187

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343960801422
                                         uncertainty =       0.008941379187

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414705330
  error estimate for blocks of size 2^( 2) =       0.000427305398
  error estimate for blocks of size 2^( 3) =       0.000439715575
  error estimate for blocks of size 2^( 4) =       0.000451467857
  error estimate for blocks of size 2^( 5) =       0.000461545960
  error estimate for blocks of size 2^( 6) =       0.000467568589
  error estimate for blocks of size 2^( 7) =       0.000471021508

      target function =                  N/A
              le_mean =     -16.905210252226
             les_mean =     286.130094521385
             stat err =       0.000462900978
             autocorr =       1.245939524945
              std dev =       0.586481902031
             le_variance =       0.343961021410


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905210252360        initial  <--
     2.4414e+01     2.4414e+02             9.7600e-06       -16.905210250531
     9.7656e+01     9.7656e+02             2.4419e-06       -16.905210251351
     3.9062e+02     3.9062e+03             6.1060e-07       -16.905210252226

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5062
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.089001e-01 1 1  ON 0
 uu_1                 1.423329e-01 1 1  ON 1
 uu_2                 4.100575e-02 1 1  ON 2
 uu_3                -2.087956e-02 1 1  ON 3
 uu_4                -6.551322e-02 1 1  ON 4
 uu_5                -9.898908e-02 1 1  ON 5
 uu_6                -1.249148e-01 1 1  ON 6
 uu_7                -1.369754e-01 1 1  ON 7
 uu_8                -1.288089e-01 1 1  ON 8
 uu_9                -9.714327e-02 1 1  ON 9
 ud_0                 4.453492e-01 1 1  ON 10
 ud_1                 1.798034e-01 1 1  ON 11
 ud_2                 5.939515e-02 1 1  ON 12
 ud_3                -1.117231e-02 1 1  ON 13
 ud_4                -6.726643e-02 1 1  ON 14
 ud_5                -1.076419e-01 1 1  ON 15
 ud_6                -1.342510e-01 1 1  ON 16
 ud_7                -1.491945e-01 1 1  ON 17
 ud_8                -1.498230e-01 1 1  ON 18
 ud_9                -1.387757e-01 1 1  ON 19
 eO_0                -7.548742e-01 1 1  ON 20
 eO_1                -4.344109e-01 1 1  ON 21
 eO_2                -1.792943e-02 1 1  ON 22
 eO_3                 2.971921e-01 1 1  ON 23
 eO_4                 5.174700e-01 1 1  ON 24
 eO_5                 4.743192e-01 1 1  ON 25
 eO_6                 2.445059e-01 1 1  ON 26
 eO_7                -5.057540e-02 1 1  ON 27
 eO_8                -2.083795e-01 1 1  ON 28
 eO_9                -6.880252e-02 1 1  ON 29
eH1_0                -2.402673e-01 1 1  ON 30
eH1_1                -1.389693e-01 1 1  ON 31
eH1_2                -9.183346e-02 1 1  ON 32
eH1_3                -3.777813e-02 1 1  ON 33
eH1_4                 1.066171e-02 1 1  ON 34
eH1_5                 4.367777e-02 1 1  ON 35
eH1_6                 9.985419e-02 1 1  ON 36
eH1_7                 1.481199e-01 1 1  ON 37
eH1_8                 1.628157e-01 1 1  ON 38
eH1_9                 4.773850e-02 1 1  ON 39
eH2_0                -2.366057e-01 1 1  ON 40
eH2_1                -1.356768e-01 1 1  ON 41
eH2_2                -8.828399e-02 1 1  ON 42
eH2_3                -3.442254e-02 1 1  ON 43
eH2_4                 1.342214e-02 1 1  ON 44
eH2_5                 4.709656e-02 1 1  ON 45
eH2_6                 1.036264e-01 1 1  ON 46
eH2_7                 1.501343e-01 1 1  ON 47
eH2_8                 1.668081e-01 1 1  ON 48
eH2_9                 3.134984e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8136e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.9255
    reference variance = 0.211672
====================================================
  Execution time = 2.0848e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5561e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5194e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355694447969
                                         uncertainty =       0.014672136221

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355694447969
                                         uncertainty =       0.014672136221

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421667040
  error estimate for blocks of size 2^( 2) =       0.000434266316
  error estimate for blocks of size 2^( 3) =       0.000446806366
  error estimate for blocks of size 2^( 4) =       0.000458977644
  error estimate for blocks of size 2^( 5) =       0.000469870263
  error estimate for blocks of size 2^( 6) =       0.000475570125
  error estimate for blocks of size 2^( 7) =       0.000479572617

      target function =                  N/A
              le_mean =     -16.905532765176
             les_mean =     286.152644081948
             stat err =       0.000470997662
             autocorr =       1.247665574716
              std dev =       0.596327246816
             le_variance =       0.355606185296


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690553276518e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905532765176       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905532767609       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905532767098       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905532768090       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905532769143       residual = 4.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905532768491       residual = 8.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905532768895       residual = 2.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905532768709       residual = 2.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+02 is 8.107296e-07

solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905532765176       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905532765785       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905532765657       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905532765905       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905532766169       residual = 4.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905532766006       residual = 8.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905532766108       residual = 2.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905532766057       residual = 2.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+02 is 2.026893e-07

solving harmonic davidson linear method for identity shift 3.9062e+03, overlap shift 3.9062e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905532765176       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905532765329       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905532765297       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905532765361       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905532765424       residual = 4.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905532765381       residual = 8.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905532765414       residual = 2.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905532765407       residual = 2.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+03 is 5.067276e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.053037 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6374e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.089001e-01 1 1  ON 0
 uu_1                 1.423330e-01 1 1  ON 1
 uu_2                 4.100568e-02 1 1  ON 2
 uu_3                -2.087953e-02 1 1  ON 3
 uu_4                -6.551326e-02 1 1  ON 4
 uu_5                -9.898909e-02 1 1  ON 5
 uu_6                -1.249149e-01 1 1  ON 6
 uu_7                -1.369754e-01 1 1  ON 7
 uu_8                -1.288089e-01 1 1  ON 8
 uu_9                -9.714336e-02 1 1  ON 9
 ud_0                 4.453493e-01 1 1  ON 10
 ud_1                 1.798033e-01 1 1  ON 11
 ud_2                 5.939520e-02 1 1  ON 12
 ud_3                -1.117230e-02 1 1  ON 13
 ud_4                -6.726649e-02 1 1  ON 14
 ud_5                -1.076420e-01 1 1  ON 15
 ud_6                -1.342509e-01 1 1  ON 16
 ud_7                -1.491945e-01 1 1  ON 17
 ud_8                -1.498231e-01 1 1  ON 18
 ud_9                -1.387756e-01 1 1  ON 19
 eO_0                -7.548744e-01 1 1  ON 20
 eO_1                -4.344109e-01 1 1  ON 21
 eO_2                -1.792955e-02 1 1  ON 22
 eO_3                 2.971922e-01 1 1  ON 23
 eO_4                 5.174702e-01 1 1  ON 24
 eO_5                 4.743194e-01 1 1  ON 25
 eO_6                 2.445061e-01 1 1  ON 26
 eO_7                -5.057539e-02 1 1  ON 27
 eO_8                -2.083796e-01 1 1  ON 28
 eO_9                -6.880265e-02 1 1  ON 29
eH1_0                -2.402674e-01 1 1  ON 30
eH1_1                -1.389694e-01 1 1  ON 31
eH1_2                -9.183351e-02 1 1  ON 32
eH1_3                -3.777829e-02 1 1  ON 33
eH1_4                 1.066157e-02 1 1  ON 34
eH1_5                 4.367776e-02 1 1  ON 35
eH1_6                 9.985421e-02 1 1  ON 36
eH1_7                 1.481201e-01 1 1  ON 37
eH1_8                 1.628159e-01 1 1  ON 38
eH1_9                 4.773867e-02 1 1  ON 39
eH2_0                -2.366057e-01 1 1  ON 40
eH2_1                -1.356769e-01 1 1  ON 41
eH2_2                -8.828406e-02 1 1  ON 42
eH2_3                -3.442251e-02 1 1  ON 43
eH2_4                 1.342200e-02 1 1  ON 44
eH2_5                 4.709651e-02 1 1  ON 45
eH2_6                 1.036263e-01 1 1  ON 46
eH2_7                 1.501344e-01 1 1  ON 47
eH2_8                 1.668083e-01 1 1  ON 48
eH2_9                 3.135004e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.0086
    reference variance = 0.570392
====================================================
  Execution time = 2.0203e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3756e-01
  Total weights = 2.0000e+06
  Execution time = 1.8898e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337344104773
                                         uncertainty =       0.004669415392

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337344104773
                                         uncertainty =       0.004669415392

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410831343
  error estimate for blocks of size 2^( 2) =       0.000423417596
  error estimate for blocks of size 2^( 3) =       0.000436815087
  error estimate for blocks of size 2^( 4) =       0.000449828756
  error estimate for blocks of size 2^( 5) =       0.000461365399
  error estimate for blocks of size 2^( 6) =       0.000470379947
  error estimate for blocks of size 2^( 7) =       0.000476202344

      target function =                  N/A
              le_mean =     -16.906896708002
             les_mean =     286.180720911654
             stat err =       0.000464444112
             autocorr =       1.278026275959
              std dev =       0.581003257646
             le_variance =       0.337564785396

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337344566716
                                         uncertainty =       0.004669417557

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337344566716
                                         uncertainty =       0.004669417557

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410831625
  error estimate for blocks of size 2^( 2) =       0.000423417872
  error estimate for blocks of size 2^( 3) =       0.000436815351
  error estimate for blocks of size 2^( 4) =       0.000449829009
  error estimate for blocks of size 2^( 5) =       0.000461365640
  error estimate for blocks of size 2^( 6) =       0.000470380178
  error estimate for blocks of size 2^( 7) =       0.000476202567

      target function =                  N/A
              le_mean =     -16.906896708526
             les_mean =     286.180721392247
             stat err =       0.000464444349
             autocorr =       1.278025828682
              std dev =       0.581003655981
             le_variance =       0.337565248264

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337344336081
                                         uncertainty =       0.004669416473

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337344336081
                                         uncertainty =       0.004669416473

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410831484
  error estimate for blocks of size 2^( 2) =       0.000423417734
  error estimate for blocks of size 2^( 3) =       0.000436815219
  error estimate for blocks of size 2^( 4) =       0.000449828883
  error estimate for blocks of size 2^( 5) =       0.000461365520
  error estimate for blocks of size 2^( 6) =       0.000470380063
  error estimate for blocks of size 2^( 7) =       0.000476202456

      target function =                  N/A
              le_mean =     -16.906896708261
             les_mean =     286.180721152196
             stat err =       0.000464444230
             autocorr =       1.278026052023
              std dev =       0.581003457103
             le_variance =       0.337565017166

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337344133696
                                         uncertainty =       0.004669415527

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337344133696
                                         uncertainty =       0.004669415527

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410831361
  error estimate for blocks of size 2^( 2) =       0.000423417613
  error estimate for blocks of size 2^( 3) =       0.000436815103
  error estimate for blocks of size 2^( 4) =       0.000449828771
  error estimate for blocks of size 2^( 5) =       0.000461365414
  error estimate for blocks of size 2^( 6) =       0.000470379961
  error estimate for blocks of size 2^( 7) =       0.000476202358

      target function =                  N/A
              le_mean =     -16.906896708034
             les_mean =     286.180720941728
             stat err =       0.000464444126
             autocorr =       1.278026247960
              std dev =       0.581003282587
             le_variance =       0.337564814377


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906896708002        initial
     2.4414e+02     2.4414e+03             8.1073e-07       -16.906896708526  <--
     9.7656e+02     9.7656e+03             2.0269e-07       -16.906896708261
     3.9062e+03     3.9062e+04             5.0673e-08       -16.906896708034

*****************************************************************************
Applying the update for shift_i =   2.4414e+02     and shift_s =   2.4414e+03
*****************************************************************************

  Execution time = 2.9720e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.089002e-01 1 1  ON 0
 uu_1                 1.423331e-01 1 1  ON 1
 uu_2                 4.100550e-02 1 1  ON 2
 uu_3                -2.087941e-02 1 1  ON 3
 uu_4                -6.551338e-02 1 1  ON 4
 uu_5                -9.898912e-02 1 1  ON 5
 uu_6                -1.249150e-01 1 1  ON 6
 uu_7                -1.369754e-01 1 1  ON 7
 uu_8                -1.288090e-01 1 1  ON 8
 uu_9                -9.714364e-02 1 1  ON 9
 ud_0                 4.453497e-01 1 1  ON 10
 ud_1                 1.798032e-01 1 1  ON 11
 ud_2                 5.939537e-02 1 1  ON 12
 ud_3                -1.117224e-02 1 1  ON 13
 ud_4                -6.726666e-02 1 1  ON 14
 ud_5                -1.076423e-01 1 1  ON 15
 ud_6                -1.342508e-01 1 1  ON 16
 ud_7                -1.491946e-01 1 1  ON 17
 ud_8                -1.498232e-01 1 1  ON 18
 ud_9                -1.387756e-01 1 1  ON 19
 eO_0                -7.548749e-01 1 1  ON 20
 eO_1                -4.344110e-01 1 1  ON 21
 eO_2                -1.792992e-02 1 1  ON 22
 eO_3                 2.971924e-01 1 1  ON 23
 eO_4                 5.174706e-01 1 1  ON 24
 eO_5                 4.743200e-01 1 1  ON 25
 eO_6                 2.445067e-01 1 1  ON 26
 eO_7                -5.057534e-02 1 1  ON 27
 eO_8                -2.083800e-01 1 1  ON 28
 eO_9                -6.880305e-02 1 1  ON 29
eH1_0                -2.402678e-01 1 1  ON 30
eH1_1                -1.389695e-01 1 1  ON 31
eH1_2                -9.183364e-02 1 1  ON 32
eH1_3                -3.777877e-02 1 1  ON 33
eH1_4                 1.066112e-02 1 1  ON 34
eH1_5                 4.367773e-02 1 1  ON 35
eH1_6                 9.985427e-02 1 1  ON 36
eH1_7                 1.481205e-01 1 1  ON 37
eH1_8                 1.628164e-01 1 1  ON 38
eH1_9                 4.773918e-02 1 1  ON 39
eH2_0                -2.366060e-01 1 1  ON 40
eH2_1                -1.356772e-01 1 1  ON 41
eH2_2                -8.828425e-02 1 1  ON 42
eH2_3                -3.442240e-02 1 1  ON 43
eH2_4                 1.342160e-02 1 1  ON 44
eH2_5                 4.709636e-02 1 1  ON 45
eH2_6                 1.036260e-01 1 1  ON 46
eH2_7                 1.501347e-01 1 1  ON 47
eH2_8                 1.668088e-01 1 1  ON 48
eH2_9                 3.135064e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6100e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6913e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.8607
    reference variance = 0.208933
====================================================
  Execution time = 2.0963e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3839e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5216e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338341055443
                                         uncertainty =       0.003657040218

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338341055443
                                         uncertainty =       0.003657040218

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411331503
  error estimate for blocks of size 2^( 2) =       0.000424204902
  error estimate for blocks of size 2^( 3) =       0.000437060671
  error estimate for blocks of size 2^( 4) =       0.000448855139
  error estimate for blocks of size 2^( 5) =       0.000459257968
  error estimate for blocks of size 2^( 6) =       0.000467362300
  error estimate for blocks of size 2^( 7) =       0.000470339012

      target function =                  N/A
              le_mean =     -16.905985421600
             les_mean =     286.150730116827
             stat err =       0.000461453605
             autocorr =       1.258554829718
              std dev =       0.581710590135
             le_variance =       0.338387210675


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690598542160e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905985421600       residual = 6.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905985426416       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905985417863       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905985419257       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905985419695       residual = 4.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905985420528       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905985421295       residual = 2.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905985421941       residual = 6.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+01 is 3.798460e-06

solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905985421600       residual = 6.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905985422806       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905985420663       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905985421016       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905985421122       residual = 4.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905985421327       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905985421517       residual = 2.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905985421676       residual = 6.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+02 is 9.529941e-07

solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905985421600       residual = 6.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905985421901       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905985421366       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905985421454       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905985421480       residual = 4.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905985421531       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905985421579       residual = 2.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905985421618       residual = 6.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+02 is 2.384611e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.055700 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6491e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.089004e-01 1 1  ON 0
 uu_1                 1.423329e-01 1 1  ON 1
 uu_2                 4.100583e-02 1 1  ON 2
 uu_3                -2.087925e-02 1 1  ON 3
 uu_4                -6.551322e-02 1 1  ON 4
 uu_5                -9.898891e-02 1 1  ON 5
 uu_6                -1.249154e-01 1 1  ON 6
 uu_7                -1.369763e-01 1 1  ON 7
 uu_8                -1.288096e-01 1 1  ON 8
 uu_9                -9.714384e-02 1 1  ON 9
 ud_0                 4.453506e-01 1 1  ON 10
 ud_1                 1.798032e-01 1 1  ON 11
 ud_2                 5.939603e-02 1 1  ON 12
 ud_3                -1.117215e-02 1 1  ON 13
 ud_4                -6.726674e-02 1 1  ON 14
 ud_5                -1.076425e-01 1 1  ON 15
 ud_6                -1.342505e-01 1 1  ON 16
 ud_7                -1.491947e-01 1 1  ON 17
 ud_8                -1.498238e-01 1 1  ON 18
 ud_9                -1.387761e-01 1 1  ON 19
 eO_0                -7.548750e-01 1 1  ON 20
 eO_1                -4.344113e-01 1 1  ON 21
 eO_2                -1.793039e-02 1 1  ON 22
 eO_3                 2.971929e-01 1 1  ON 23
 eO_4                 5.174707e-01 1 1  ON 24
 eO_5                 4.743207e-01 1 1  ON 25
 eO_6                 2.445075e-01 1 1  ON 26
 eO_7                -5.057517e-02 1 1  ON 27
 eO_8                -2.083808e-01 1 1  ON 28
 eO_9                -6.880366e-02 1 1  ON 29
eH1_0                -2.402684e-01 1 1  ON 30
eH1_1                -1.389700e-01 1 1  ON 31
eH1_2                -9.183363e-02 1 1  ON 32
eH1_3                -3.777886e-02 1 1  ON 33
eH1_4                 1.066068e-02 1 1  ON 34
eH1_5                 4.367781e-02 1 1  ON 35
eH1_6                 9.985401e-02 1 1  ON 36
eH1_7                 1.481205e-01 1 1  ON 37
eH1_8                 1.628171e-01 1 1  ON 38
eH1_9                 4.774008e-02 1 1  ON 39
eH2_0                -2.366068e-01 1 1  ON 40
eH2_1                -1.356774e-01 1 1  ON 41
eH2_2                -8.828462e-02 1 1  ON 42
eH2_3                -3.442250e-02 1 1  ON 43
eH2_4                 1.342191e-02 1 1  ON 44
eH2_5                 4.709624e-02 1 1  ON 45
eH2_6                 1.036260e-01 1 1  ON 46
eH2_7                 1.501352e-01 1 1  ON 47
eH2_8                 1.668093e-01 1 1  ON 48
eH2_9                 3.135119e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.9071
    reference variance = 0.133042
====================================================
  Execution time = 2.0049e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3896e-01
  Total weights = 2.0000e+06
  Execution time = 1.8963e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338967387494
                                         uncertainty =       0.003406921463

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338967387494
                                         uncertainty =       0.003406921463

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411682026
  error estimate for blocks of size 2^( 2) =       0.000424475354
  error estimate for blocks of size 2^( 3) =       0.000436545197
  error estimate for blocks of size 2^( 4) =       0.000448499110
  error estimate for blocks of size 2^( 5) =       0.000458942468
  error estimate for blocks of size 2^( 6) =       0.000465568538
  error estimate for blocks of size 2^( 7) =       0.000471607434

      target function =                  N/A
              le_mean =     -16.906793285602
             les_mean =     286.178623213594
             stat err =       0.000461154387
             autocorr =       1.254783726493
              std dev =       0.582206304499
             le_variance =       0.338964180998

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338968340992
                                         uncertainty =       0.003406925287

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338968340992
                                         uncertainty =       0.003406925287

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411682605
  error estimate for blocks of size 2^( 2) =       0.000424475931
  error estimate for blocks of size 2^( 3) =       0.000436545777
  error estimate for blocks of size 2^( 4) =       0.000448499631
  error estimate for blocks of size 2^( 5) =       0.000458942976
  error estimate for blocks of size 2^( 6) =       0.000465569070
  error estimate for blocks of size 2^( 7) =       0.000471607946

      target function =                  N/A
              le_mean =     -16.906793299267
             les_mean =     286.178624628563
             stat err =       0.000461154906
             autocorr =       1.254783019615
              std dev =       0.582207122866
             le_variance =       0.338965133916

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338967866798
                                         uncertainty =       0.003406923387

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338967866798
                                         uncertainty =       0.003406923387

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411682317
  error estimate for blocks of size 2^( 2) =       0.000424475644
  error estimate for blocks of size 2^( 3) =       0.000436545489
  error estimate for blocks of size 2^( 4) =       0.000448499372
  error estimate for blocks of size 2^( 5) =       0.000458942723
  error estimate for blocks of size 2^( 6) =       0.000465568805
  error estimate for blocks of size 2^( 7) =       0.000471607692

      target function =                  N/A
              le_mean =     -16.906793292484
             les_mean =     286.178623925303
             stat err =       0.000461154648
             autocorr =       1.254783371827
              std dev =       0.582206715875
             le_variance =       0.338964660010

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338967447481
                                         uncertainty =       0.003406921704

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338967447481
                                         uncertainty =       0.003406921704

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411682062
  error estimate for blocks of size 2^( 2) =       0.000424475390
  error estimate for blocks of size 2^( 3) =       0.000436545233
  error estimate for blocks of size 2^( 4) =       0.000448499143
  error estimate for blocks of size 2^( 5) =       0.000458942500
  error estimate for blocks of size 2^( 6) =       0.000465568571
  error estimate for blocks of size 2^( 7) =       0.000471607466

      target function =                  N/A
              le_mean =     -16.906793286463
             les_mean =     286.178623302660
             stat err =       0.000461154420
             autocorr =       1.254783682127
              std dev =       0.582206355984
             le_variance =       0.338964240948


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906793285602        initial
     6.1035e+01     6.1035e+02             3.7985e-06       -16.906793299267  <--
     2.4414e+02     2.4414e+03             9.5299e-07       -16.906793292484
     9.7656e+02     9.7656e+03             2.3846e-07       -16.906793286463

*****************************************************************************
Applying the update for shift_i =   6.1035e+01     and shift_s =   6.1035e+02
*****************************************************************************

  Execution time = 2.9598e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.089013e-01 1 1  ON 0
 uu_1                 1.423322e-01 1 1  ON 1
 uu_2                 4.100682e-02 1 1  ON 2
 uu_3                -2.087877e-02 1 1  ON 3
 uu_4                -6.551274e-02 1 1  ON 4
 uu_5                -9.898829e-02 1 1  ON 5
 uu_6                -1.249164e-01 1 1  ON 6
 uu_7                -1.369788e-01 1 1  ON 7
 uu_8                -1.288113e-01 1 1  ON 8
 uu_9                -9.714443e-02 1 1  ON 9
 ud_0                 4.453535e-01 1 1  ON 10
 ud_1                 1.798034e-01 1 1  ON 11
 ud_2                 5.939800e-02 1 1  ON 12
 ud_3                -1.117187e-02 1 1  ON 13
 ud_4                -6.726695e-02 1 1  ON 14
 ud_5                -1.076430e-01 1 1  ON 15
 ud_6                -1.342495e-01 1 1  ON 16
 ud_7                -1.491953e-01 1 1  ON 17
 ud_8                -1.498256e-01 1 1  ON 18
 ud_9                -1.387779e-01 1 1  ON 19
 eO_0                -7.548751e-01 1 1  ON 20
 eO_1                -4.344123e-01 1 1  ON 21
 eO_2                -1.793180e-02 1 1  ON 22
 eO_3                 2.971944e-01 1 1  ON 23
 eO_4                 5.174709e-01 1 1  ON 24
 eO_5                 4.743228e-01 1 1  ON 25
 eO_6                 2.445100e-01 1 1  ON 26
 eO_7                -5.057468e-02 1 1  ON 27
 eO_8                -2.083830e-01 1 1  ON 28
 eO_9                -6.880549e-02 1 1  ON 29
eH1_0                -2.402701e-01 1 1  ON 30
eH1_1                -1.389716e-01 1 1  ON 31
eH1_2                -9.183361e-02 1 1  ON 32
eH1_3                -3.777914e-02 1 1  ON 33
eH1_4                 1.065938e-02 1 1  ON 34
eH1_5                 4.367803e-02 1 1  ON 35
eH1_6                 9.985325e-02 1 1  ON 36
eH1_7                 1.481206e-01 1 1  ON 37
eH1_8                 1.628193e-01 1 1  ON 38
eH1_9                 4.774278e-02 1 1  ON 39
eH2_0                -2.366091e-01 1 1  ON 40
eH2_1                -1.356781e-01 1 1  ON 41
eH2_2                -8.828571e-02 1 1  ON 42
eH2_3                -3.442281e-02 1 1  ON 43
eH2_4                 1.342283e-02 1 1  ON 44
eH2_5                 4.709589e-02 1 1  ON 45
eH2_6                 1.036259e-01 1 1  ON 46
eH2_7                 1.501366e-01 1 1  ON 47
eH2_8                 1.668108e-01 1 1  ON 48
eH2_9                 3.135287e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6096e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6911e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.9073
    reference variance = 0.279053
====================================================
  Execution time = 2.1441e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3839e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5165e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338482172201
                                         uncertainty =       0.004448794493

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338482172201
                                         uncertainty =       0.004448794493

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411331361
  error estimate for blocks of size 2^( 2) =       0.000423993155
  error estimate for blocks of size 2^( 3) =       0.000436921411
  error estimate for blocks of size 2^( 4) =       0.000448829282
  error estimate for blocks of size 2^( 5) =       0.000460021358
  error estimate for blocks of size 2^( 6) =       0.000467976856
  error estimate for blocks of size 2^( 7) =       0.000471915302

      target function =                  N/A
              le_mean =     -16.906013445683
             les_mean =     286.151677432881
             stat err =       0.000462185700
             autocorr =       1.262552259372
              std dev =       0.581710388810
             le_variance =       0.338386976449


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690601344568e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906013445683       residual = 3.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906013473282       residual = 4.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906013491122       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906013493155       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906013518861       residual = 5.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906013517523       residual = 8.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906013529794       residual = 2.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906013528950       residual = 6.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+01 is 1.806408e-05

solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906013445683       residual = 3.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906013452639       residual = 4.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906013457101       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906013457535       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906013464049       residual = 5.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906013463911       residual = 8.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906013467060       residual = 2.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906013466953       residual = 6.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+01 is 4.596334e-06

solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906013445683       residual = 3.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906013447426       residual = 4.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906013448541       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906013448645       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906013450279       residual = 5.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906013450257       residual = 7.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906013451049       residual = 2.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906013451029       residual = 6.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+02 is 1.154233e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.058323 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6964e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.089036e-01 1 1  ON 0
 uu_1                 1.423335e-01 1 1  ON 1
 uu_2                 4.100665e-02 1 1  ON 2
 uu_3                -2.087898e-02 1 1  ON 3
 uu_4                -6.551269e-02 1 1  ON 4
 uu_5                -9.898821e-02 1 1  ON 5
 uu_6                -1.249178e-01 1 1  ON 6
 uu_7                -1.369792e-01 1 1  ON 7
 uu_8                -1.288142e-01 1 1  ON 8
 uu_9                -9.714641e-02 1 1  ON 9
 ud_0                 4.453581e-01 1 1  ON 10
 ud_1                 1.798029e-01 1 1  ON 11
 ud_2                 5.939936e-02 1 1  ON 12
 ud_3                -1.117221e-02 1 1  ON 13
 ud_4                -6.726509e-02 1 1  ON 14
 ud_5                -1.076447e-01 1 1  ON 15
 ud_6                -1.342481e-01 1 1  ON 16
 ud_7                -1.491958e-01 1 1  ON 17
 ud_8                -1.498291e-01 1 1  ON 18
 ud_9                -1.387804e-01 1 1  ON 19
 eO_0                -7.548761e-01 1 1  ON 20
 eO_1                -4.344136e-01 1 1  ON 21
 eO_2                -1.793174e-02 1 1  ON 22
 eO_3                 2.971958e-01 1 1  ON 23
 eO_4                 5.174711e-01 1 1  ON 24
 eO_5                 4.743243e-01 1 1  ON 25
 eO_6                 2.445134e-01 1 1  ON 26
 eO_7                -5.057333e-02 1 1  ON 27
 eO_8                -2.083858e-01 1 1  ON 28
 eO_9                -6.880775e-02 1 1  ON 29
eH1_0                -2.402723e-01 1 1  ON 30
eH1_1                -1.389733e-01 1 1  ON 31
eH1_2                -9.183326e-02 1 1  ON 32
eH1_3                -3.777885e-02 1 1  ON 33
eH1_4                 1.065854e-02 1 1  ON 34
eH1_5                 4.367520e-02 1 1  ON 35
eH1_6                 9.985191e-02 1 1  ON 36
eH1_7                 1.481231e-01 1 1  ON 37
eH1_8                 1.628216e-01 1 1  ON 38
eH1_9                 4.774540e-02 1 1  ON 39
eH2_0                -2.366127e-01 1 1  ON 40
eH2_1                -1.356770e-01 1 1  ON 41
eH2_2                -8.828688e-02 1 1  ON 42
eH2_3                -3.442457e-02 1 1  ON 43
eH2_4                 1.342436e-02 1 1  ON 44
eH2_5                 4.709580e-02 1 1  ON 45
eH2_6                 1.036259e-01 1 1  ON 46
eH2_7                 1.501369e-01 1 1  ON 47
eH2_8                 1.668122e-01 1 1  ON 48
eH2_9                 3.135560e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.9283
    reference variance = 0.1734
====================================================
  Execution time = 1.9979e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4379e-01
  Total weights = 2.0000e+06
  Execution time = 1.8926e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343902050900
                                         uncertainty =       0.004937306149

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343902050900
                                         uncertainty =       0.004937306149

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414599215
  error estimate for blocks of size 2^( 2) =       0.000427630926
  error estimate for blocks of size 2^( 3) =       0.000441076744
  error estimate for blocks of size 2^( 4) =       0.000453562545
  error estimate for blocks of size 2^( 5) =       0.000464645090
  error estimate for blocks of size 2^( 6) =       0.000473287865
  error estimate for blocks of size 2^( 7) =       0.000478131010

      target function =                  N/A
              le_mean =     -16.905623043334
             les_mean =     286.143875329798
             stat err =       0.000467406627
             autocorr =       1.270962628096
              std dev =       0.586331833007
             le_variance =       0.343785018397

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343916906050
                                         uncertainty =       0.004937437868

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343916906050
                                         uncertainty =       0.004937437868

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414608171
  error estimate for blocks of size 2^( 2) =       0.000427639482
  error estimate for blocks of size 2^( 3) =       0.000441084918
  error estimate for blocks of size 2^( 4) =       0.000453570410
  error estimate for blocks of size 2^( 5) =       0.000464652846
  error estimate for blocks of size 2^( 6) =       0.000473295818
  error estimate for blocks of size 2^( 7) =       0.000478139299

      target function =                  N/A
              le_mean =     -16.905622933539
             les_mean =     286.143886470701
             stat err =       0.000467414593
             autocorr =       1.270951038398
              std dev =       0.586344499094
             le_variance =       0.343799871618

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343909633316
                                         uncertainty =       0.004937374006

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343909633316
                                         uncertainty =       0.004937374006

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414603787
  error estimate for blocks of size 2^( 2) =       0.000427635294
  error estimate for blocks of size 2^( 3) =       0.000441080917
  error estimate for blocks of size 2^( 4) =       0.000453566562
  error estimate for blocks of size 2^( 5) =       0.000464649051
  error estimate for blocks of size 2^( 6) =       0.000473291926
  error estimate for blocks of size 2^( 7) =       0.000478135243

      target function =                  N/A
              le_mean =     -16.905622987060
             les_mean =     286.143881008560
             stat err =       0.000467410695
             autocorr =       1.270956724216
              std dev =       0.586338298110
             le_variance =       0.343792599831

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343903003499
                                         uncertainty =       0.004937314696

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343903003499
                                         uncertainty =       0.004937314696

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414599789
  error estimate for blocks of size 2^( 2) =       0.000427631475
  error estimate for blocks of size 2^( 3) =       0.000441077268
  error estimate for blocks of size 2^( 4) =       0.000453563049
  error estimate for blocks of size 2^( 5) =       0.000464645588
  error estimate for blocks of size 2^( 6) =       0.000473288375
  error estimate for blocks of size 2^( 7) =       0.000478131542

      target function =                  N/A
              le_mean =     -16.905623036239
             les_mean =     286.143876042408
             stat err =       0.000467407138
             autocorr =       1.270961886666
              std dev =       0.586332645239
             le_variance =       0.343785970873


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905623043334        initial  <--
     1.5259e+01     1.5259e+02             1.8064e-05       -16.905622933539
     6.1035e+01     6.1035e+02             4.5963e-06       -16.905622987060
     2.4414e+02     2.4414e+03             1.1542e-06       -16.905623036239

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 33.3385
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.089013e-01 1 1  ON 0
 uu_1                 1.423322e-01 1 1  ON 1
 uu_2                 4.100682e-02 1 1  ON 2
 uu_3                -2.087877e-02 1 1  ON 3
 uu_4                -6.551274e-02 1 1  ON 4
 uu_5                -9.898829e-02 1 1  ON 5
 uu_6                -1.249164e-01 1 1  ON 6
 uu_7                -1.369788e-01 1 1  ON 7
 uu_8                -1.288113e-01 1 1  ON 8
 uu_9                -9.714443e-02 1 1  ON 9
 ud_0                 4.453535e-01 1 1  ON 10
 ud_1                 1.798034e-01 1 1  ON 11
 ud_2                 5.939800e-02 1 1  ON 12
 ud_3                -1.117187e-02 1 1  ON 13
 ud_4                -6.726695e-02 1 1  ON 14
 ud_5                -1.076430e-01 1 1  ON 15
 ud_6                -1.342495e-01 1 1  ON 16
 ud_7                -1.491953e-01 1 1  ON 17
 ud_8                -1.498256e-01 1 1  ON 18
 ud_9                -1.387779e-01 1 1  ON 19
 eO_0                -7.548751e-01 1 1  ON 20
 eO_1                -4.344123e-01 1 1  ON 21
 eO_2                -1.793180e-02 1 1  ON 22
 eO_3                 2.971944e-01 1 1  ON 23
 eO_4                 5.174709e-01 1 1  ON 24
 eO_5                 4.743228e-01 1 1  ON 25
 eO_6                 2.445100e-01 1 1  ON 26
 eO_7                -5.057468e-02 1 1  ON 27
 eO_8                -2.083830e-01 1 1  ON 28
 eO_9                -6.880549e-02 1 1  ON 29
eH1_0                -2.402701e-01 1 1  ON 30
eH1_1                -1.389716e-01 1 1  ON 31
eH1_2                -9.183361e-02 1 1  ON 32
eH1_3                -3.777914e-02 1 1  ON 33
eH1_4                 1.065938e-02 1 1  ON 34
eH1_5                 4.367803e-02 1 1  ON 35
eH1_6                 9.985325e-02 1 1  ON 36
eH1_7                 1.481206e-01 1 1  ON 37
eH1_8                 1.628193e-01 1 1  ON 38
eH1_9                 4.774278e-02 1 1  ON 39
eH2_0                -2.366091e-01 1 1  ON 40
eH2_1                -1.356781e-01 1 1  ON 41
eH2_2                -8.828571e-02 1 1  ON 42
eH2_3                -3.442281e-02 1 1  ON 43
eH2_4                 1.342283e-02 1 1  ON 44
eH2_5                 4.709589e-02 1 1  ON 45
eH2_6                 1.036259e-01 1 1  ON 46
eH2_7                 1.501366e-01 1 1  ON 47
eH2_8                 1.668108e-01 1 1  ON 48
eH2_9                 3.135287e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.0308e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6912e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.9719
    reference variance = 0.211779
====================================================
  Execution time = 2.0566e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3730e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5249e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337390011863
                                         uncertainty =       0.004315832404

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337390011863
                                         uncertainty =       0.004315832404

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410671239
  error estimate for blocks of size 2^( 2) =       0.000423292638
  error estimate for blocks of size 2^( 3) =       0.000436410438
  error estimate for blocks of size 2^( 4) =       0.000448765489
  error estimate for blocks of size 2^( 5) =       0.000460331113
  error estimate for blocks of size 2^( 6) =       0.000468365986
  error estimate for blocks of size 2^( 7) =       0.000472027383

      target function =                  N/A
              le_mean =     -16.906667162188
             les_mean =     286.172696096970
             stat err =       0.000462372493
             autocorr =       1.267638444609
              std dev =       0.580776835461
             le_variance =       0.337301732608


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690666716219e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906667162188       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906667167105       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906667168268       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906667170874       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906667172243       residual = 6.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906667171991       residual = 9.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906667171803       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906667172322       residual = 5.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+02 is 1.535925e-06

solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906667162188       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906667163419       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906667163710       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906667164362       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906667164704       residual = 6.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906667164641       residual = 9.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906667164595       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906667164723       residual = 5.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+02 is 3.840213e-07

solving harmonic davidson linear method for identity shift 2.4414e+03, overlap shift 2.4414e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906667162188       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906667162496       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906667162569       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906667162732       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906667162818       residual = 6.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906667162802       residual = 9.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906667162790       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906667162823       residual = 5.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+03 is 9.600783e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.060986 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6098e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.089014e-01 1 1  ON 0
 uu_1                 1.423322e-01 1 1  ON 1
 uu_2                 4.100670e-02 1 1  ON 2
 uu_3                -2.087876e-02 1 1  ON 3
 uu_4                -6.551266e-02 1 1  ON 4
 uu_5                -9.898824e-02 1 1  ON 5
 uu_6                -1.249167e-01 1 1  ON 6
 uu_7                -1.369789e-01 1 1  ON 7
 uu_8                -1.288114e-01 1 1  ON 8
 uu_9                -9.714448e-02 1 1  ON 9
 ud_0                 4.453536e-01 1 1  ON 10
 ud_1                 1.798034e-01 1 1  ON 11
 ud_2                 5.939817e-02 1 1  ON 12
 ud_3                -1.117185e-02 1 1  ON 13
 ud_4                -6.726690e-02 1 1  ON 14
 ud_5                -1.076432e-01 1 1  ON 15
 ud_6                -1.342494e-01 1 1  ON 16
 ud_7                -1.491955e-01 1 1  ON 17
 ud_8                -1.498256e-01 1 1  ON 18
 ud_9                -1.387780e-01 1 1  ON 19
 eO_0                -7.548753e-01 1 1  ON 20
 eO_1                -4.344123e-01 1 1  ON 21
 eO_2                -1.793177e-02 1 1  ON 22
 eO_3                 2.971942e-01 1 1  ON 23
 eO_4                 5.174711e-01 1 1  ON 24
 eO_5                 4.743231e-01 1 1  ON 25
 eO_6                 2.445102e-01 1 1  ON 26
 eO_7                -5.057451e-02 1 1  ON 27
 eO_8                -2.083831e-01 1 1  ON 28
 eO_9                -6.880571e-02 1 1  ON 29
eH1_0                -2.402705e-01 1 1  ON 30
eH1_1                -1.389718e-01 1 1  ON 31
eH1_2                -9.183358e-02 1 1  ON 32
eH1_3                -3.777929e-02 1 1  ON 33
eH1_4                 1.065920e-02 1 1  ON 34
eH1_5                 4.367816e-02 1 1  ON 35
eH1_6                 9.985308e-02 1 1  ON 36
eH1_7                 1.481207e-01 1 1  ON 37
eH1_8                 1.628197e-01 1 1  ON 38
eH1_9                 4.774312e-02 1 1  ON 39
eH2_0                -2.366094e-01 1 1  ON 40
eH2_1                -1.356781e-01 1 1  ON 41
eH2_2                -8.828595e-02 1 1  ON 42
eH2_3                -3.442309e-02 1 1  ON 43
eH2_4                 1.342295e-02 1 1  ON 44
eH2_5                 4.709595e-02 1 1  ON 45
eH2_6                 1.036260e-01 1 1  ON 46
eH2_7                 1.501367e-01 1 1  ON 47
eH2_8                 1.668109e-01 1 1  ON 48
eH2_9                 3.135313e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.9594
    reference variance = 0.263373
====================================================
  Execution time = 2.0112e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3269e-01
  Total weights = 2.0000e+06
  Execution time = 1.8939e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332649288528
                                         uncertainty =       0.003078120518

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332649288528
                                         uncertainty =       0.003078120518

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407857013
  error estimate for blocks of size 2^( 2) =       0.000420565172
  error estimate for blocks of size 2^( 3) =       0.000434183444
  error estimate for blocks of size 2^( 4) =       0.000446941409
  error estimate for blocks of size 2^( 5) =       0.000456314565
  error estimate for blocks of size 2^( 6) =       0.000464454686
  error estimate for blocks of size 2^( 7) =       0.000470615120

      target function =                  N/A
              le_mean =     -16.905344624461
             les_mean =     286.123371391197
             stat err =       0.000459581445
             autocorr =       1.269723344259
              std dev =       0.576796918983
             le_variance =       0.332694685748

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332649586674
                                         uncertainty =       0.003078116259

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332649586674
                                         uncertainty =       0.003078116259

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407857195
  error estimate for blocks of size 2^( 2) =       0.000420565352
  error estimate for blocks of size 2^( 3) =       0.000434183622
  error estimate for blocks of size 2^( 4) =       0.000446941574
  error estimate for blocks of size 2^( 5) =       0.000456314725
  error estimate for blocks of size 2^( 6) =       0.000464454851
  error estimate for blocks of size 2^( 7) =       0.000470615298

      target function =                  N/A
              le_mean =     -16.905344619197
             les_mean =     286.123371511249
             stat err =       0.000459581612
             autocorr =       1.269723131092
              std dev =       0.576797177342
             le_variance =       0.332694983790

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332649437761
                                         uncertainty =       0.003078118381

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332649437761
                                         uncertainty =       0.003078118381

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407857104
  error estimate for blocks of size 2^( 2) =       0.000420565262
  error estimate for blocks of size 2^( 3) =       0.000434183533
  error estimate for blocks of size 2^( 4) =       0.000446941492
  error estimate for blocks of size 2^( 5) =       0.000456314645
  error estimate for blocks of size 2^( 6) =       0.000464454769
  error estimate for blocks of size 2^( 7) =       0.000470615209

      target function =                  N/A
              le_mean =     -16.905344621823
             les_mean =     286.123371451173
             stat err =       0.000459581529
             autocorr =       1.269723237697
              std dev =       0.576797048301
             le_variance =       0.332694834929

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332649307187
                                         uncertainty =       0.003078120251

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332649307187
                                         uncertainty =       0.003078120251

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407857024
  error estimate for blocks of size 2^( 2) =       0.000420565183
  error estimate for blocks of size 2^( 3) =       0.000434183456
  error estimate for blocks of size 2^( 4) =       0.000446941419
  error estimate for blocks of size 2^( 5) =       0.000456314575
  error estimate for blocks of size 2^( 6) =       0.000464454697
  error estimate for blocks of size 2^( 7) =       0.000470615131

      target function =                  N/A
              le_mean =     -16.905344624131
             les_mean =     286.123371398688
             stat err =       0.000459581455
             autocorr =       1.269723330947
              std dev =       0.576796935152
             le_variance =       0.332694704400


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905344624461        initial  <--
     1.5259e+02     1.5259e+03             1.5359e-06       -16.905344619197
     6.1035e+02     6.1035e+03             3.8402e-07       -16.905344621823
     2.4414e+03     2.4414e+04             9.6008e-08       -16.905344624131

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6938
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.089013e-01 1 1  ON 0
 uu_1                 1.423322e-01 1 1  ON 1
 uu_2                 4.100682e-02 1 1  ON 2
 uu_3                -2.087877e-02 1 1  ON 3
 uu_4                -6.551274e-02 1 1  ON 4
 uu_5                -9.898829e-02 1 1  ON 5
 uu_6                -1.249164e-01 1 1  ON 6
 uu_7                -1.369788e-01 1 1  ON 7
 uu_8                -1.288113e-01 1 1  ON 8
 uu_9                -9.714443e-02 1 1  ON 9
 ud_0                 4.453535e-01 1 1  ON 10
 ud_1                 1.798034e-01 1 1  ON 11
 ud_2                 5.939800e-02 1 1  ON 12
 ud_3                -1.117187e-02 1 1  ON 13
 ud_4                -6.726695e-02 1 1  ON 14
 ud_5                -1.076430e-01 1 1  ON 15
 ud_6                -1.342495e-01 1 1  ON 16
 ud_7                -1.491953e-01 1 1  ON 17
 ud_8                -1.498256e-01 1 1  ON 18
 ud_9                -1.387779e-01 1 1  ON 19
 eO_0                -7.548751e-01 1 1  ON 20
 eO_1                -4.344123e-01 1 1  ON 21
 eO_2                -1.793180e-02 1 1  ON 22
 eO_3                 2.971944e-01 1 1  ON 23
 eO_4                 5.174709e-01 1 1  ON 24
 eO_5                 4.743228e-01 1 1  ON 25
 eO_6                 2.445100e-01 1 1  ON 26
 eO_7                -5.057468e-02 1 1  ON 27
 eO_8                -2.083830e-01 1 1  ON 28
 eO_9                -6.880549e-02 1 1  ON 29
eH1_0                -2.402701e-01 1 1  ON 30
eH1_1                -1.389716e-01 1 1  ON 31
eH1_2                -9.183361e-02 1 1  ON 32
eH1_3                -3.777914e-02 1 1  ON 33
eH1_4                 1.065938e-02 1 1  ON 34
eH1_5                 4.367803e-02 1 1  ON 35
eH1_6                 9.985325e-02 1 1  ON 36
eH1_7                 1.481206e-01 1 1  ON 37
eH1_8                 1.628193e-01 1 1  ON 38
eH1_9                 4.774278e-02 1 1  ON 39
eH2_0                -2.366091e-01 1 1  ON 40
eH2_1                -1.356781e-01 1 1  ON 41
eH2_2                -8.828571e-02 1 1  ON 42
eH2_3                -3.442281e-02 1 1  ON 43
eH2_4                 1.342283e-02 1 1  ON 44
eH2_5                 4.709589e-02 1 1  ON 45
eH2_6                 1.036259e-01 1 1  ON 46
eH2_7                 1.501366e-01 1 1  ON 47
eH2_8                 1.668108e-01 1 1  ON 48
eH2_9                 3.135287e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5798e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6915e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.861
    reference variance = 0.435646
====================================================
  Execution time = 2.0505e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3734e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4946e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337398039653
                                         uncertainty =       0.003105284113

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337398039653
                                         uncertainty =       0.003105284113

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410692554
  error estimate for blocks of size 2^( 2) =       0.000423850430
  error estimate for blocks of size 2^( 3) =       0.000437602288
  error estimate for blocks of size 2^( 4) =       0.000449640905
  error estimate for blocks of size 2^( 5) =       0.000460725327
  error estimate for blocks of size 2^( 6) =       0.000470574717
  error estimate for blocks of size 2^( 7) =       0.000475646335

      target function =                  N/A
              le_mean =     -16.905909756737
             les_mean =     286.147121282694
             stat err =       0.000464146821
             autocorr =       1.277253500487
              std dev =       0.580806980345
             le_variance =       0.337336748418


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690590975674e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+03, overlap shift 1.5259e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905909756737       residual = 9.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905909756851       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905909756901       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905909757181       residual = 5.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905909757514       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905909757518       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905909757676       residual = 2.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905909757601       residual = 3.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+03 is 1.540072e-07

solving harmonic davidson linear method for identity shift 6.1035e+03, overlap shift 6.1035e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905909756737       residual = 9.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905909756766       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905909756778       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905909756848       residual = 5.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905909756935       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905909756936       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905909756969       residual = 2.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905909756953       residual = 3.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+03 is 3.850201e-08

solving harmonic davidson linear method for identity shift 2.4414e+04, overlap shift 2.4414e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905909756737       residual = 9.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905909756744       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905909756747       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905909756768       residual = 5.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905909756785       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905909756803       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905909756734       residual = 2.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905909756804       residual = 3.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+04 is 9.625515e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.063667 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6006e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.089013e-01 1 1  ON 0
 uu_1                 1.423322e-01 1 1  ON 1
 uu_2                 4.100683e-02 1 1  ON 2
 uu_3                -2.087878e-02 1 1  ON 3
 uu_4                -6.551274e-02 1 1  ON 4
 uu_5                -9.898831e-02 1 1  ON 5
 uu_6                -1.249164e-01 1 1  ON 6
 uu_7                -1.369788e-01 1 1  ON 7
 uu_8                -1.288114e-01 1 1  ON 8
 uu_9                -9.714444e-02 1 1  ON 9
 ud_0                 4.453535e-01 1 1  ON 10
 ud_1                 1.798034e-01 1 1  ON 11
 ud_2                 5.939801e-02 1 1  ON 12
 ud_3                -1.117187e-02 1 1  ON 13
 ud_4                -6.726696e-02 1 1  ON 14
 ud_5                -1.076430e-01 1 1  ON 15
 ud_6                -1.342495e-01 1 1  ON 16
 ud_7                -1.491953e-01 1 1  ON 17
 ud_8                -1.498256e-01 1 1  ON 18
 ud_9                -1.387779e-01 1 1  ON 19
 eO_0                -7.548752e-01 1 1  ON 20
 eO_1                -4.344123e-01 1 1  ON 21
 eO_2                -1.793181e-02 1 1  ON 22
 eO_3                 2.971945e-01 1 1  ON 23
 eO_4                 5.174710e-01 1 1  ON 24
 eO_5                 4.743228e-01 1 1  ON 25
 eO_6                 2.445100e-01 1 1  ON 26
 eO_7                -5.057466e-02 1 1  ON 27
 eO_8                -2.083830e-01 1 1  ON 28
 eO_9                -6.880551e-02 1 1  ON 29
eH1_0                -2.402702e-01 1 1  ON 30
eH1_1                -1.389716e-01 1 1  ON 31
eH1_2                -9.183361e-02 1 1  ON 32
eH1_3                -3.777915e-02 1 1  ON 33
eH1_4                 1.065935e-02 1 1  ON 34
eH1_5                 4.367800e-02 1 1  ON 35
eH1_6                 9.985325e-02 1 1  ON 36
eH1_7                 1.481206e-01 1 1  ON 37
eH1_8                 1.628193e-01 1 1  ON 38
eH1_9                 4.774281e-02 1 1  ON 39
eH2_0                -2.366091e-01 1 1  ON 40
eH2_1                -1.356781e-01 1 1  ON 41
eH2_2                -8.828572e-02 1 1  ON 42
eH2_3                -3.442283e-02 1 1  ON 43
eH2_4                 1.342282e-02 1 1  ON 44
eH2_5                 4.709588e-02 1 1  ON 45
eH2_6                 1.036259e-01 1 1  ON 46
eH2_7                 1.501366e-01 1 1  ON 47
eH2_8                 1.668108e-01 1 1  ON 48
eH2_9                 3.135291e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.8672
    reference variance = 0.19525
====================================================
  Execution time = 2.2390e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3530e-01
  Total weights = 2.0000e+06
  Execution time = 1.8889e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335296280224
                                         uncertainty =       0.003407099179

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335296280224
                                         uncertainty =       0.003407099179

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409453483
  error estimate for blocks of size 2^( 2) =       0.000421946006
  error estimate for blocks of size 2^( 3) =       0.000434565393
  error estimate for blocks of size 2^( 4) =       0.000446683790
  error estimate for blocks of size 2^( 5) =       0.000456785372
  error estimate for blocks of size 2^( 6) =       0.000463228087
  error estimate for blocks of size 2^( 7) =       0.000466666343

      target function =                  N/A
              le_mean =     -16.906198385347
             les_mean =     286.154847986180
             stat err =       0.000458340898
             autocorr =       1.253049083870
              std dev =       0.579054668497
             le_variance =       0.335304309108

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335296342498
                                         uncertainty =       0.003407099880

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335296342498
                                         uncertainty =       0.003407099880

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409453521
  error estimate for blocks of size 2^( 2) =       0.000421946042
  error estimate for blocks of size 2^( 3) =       0.000434565428
  error estimate for blocks of size 2^( 4) =       0.000446683823
  error estimate for blocks of size 2^( 5) =       0.000456785403
  error estimate for blocks of size 2^( 6) =       0.000463228120
  error estimate for blocks of size 2^( 7) =       0.000466666375

      target function =                  N/A
              le_mean =     -16.906198385223
             les_mean =     286.154848044234
             stat err =       0.000458340930
             autocorr =       1.253049028760
              std dev =       0.579054722247
             le_variance =       0.335304371356

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335296311366
                                         uncertainty =       0.003407099530

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335296311366
                                         uncertainty =       0.003407099530

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409453502
  error estimate for blocks of size 2^( 2) =       0.000421946024
  error estimate for blocks of size 2^( 3) =       0.000434565410
  error estimate for blocks of size 2^( 4) =       0.000446683807
  error estimate for blocks of size 2^( 5) =       0.000456785387
  error estimate for blocks of size 2^( 6) =       0.000463228103
  error estimate for blocks of size 2^( 7) =       0.000466666359

      target function =                  N/A
              le_mean =     -16.906198385285
             les_mean =     286.154848015211
             stat err =       0.000458340914
             autocorr =       1.253049056308
              std dev =       0.579054695377
             le_variance =       0.335304340238

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335296284117
                                         uncertainty =       0.003407099223

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335296284117
                                         uncertainty =       0.003407099223

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409453485
  error estimate for blocks of size 2^( 2) =       0.000421946008
  error estimate for blocks of size 2^( 3) =       0.000434565395
  error estimate for blocks of size 2^( 4) =       0.000446683792
  error estimate for blocks of size 2^( 5) =       0.000456785374
  error estimate for blocks of size 2^( 6) =       0.000463228089
  error estimate for blocks of size 2^( 7) =       0.000466666345

      target function =                  N/A
              le_mean =     -16.906198385340
             les_mean =     286.154847989809
             stat err =       0.000458340900
             autocorr =       1.253049080417
              std dev =       0.579054671857
             le_variance =       0.335304312999


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906198385347        initial  <--
     1.5259e+03     1.5259e+04             1.5401e-07       -16.906198385223
     6.1035e+03     6.1035e+04             3.8502e-08       -16.906198385285
     2.4414e+04     2.4414e+05             9.6255e-09       -16.906198385340

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.9105
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.089013e-01 1 1  ON 0
 uu_1                 1.423322e-01 1 1  ON 1
 uu_2                 4.100682e-02 1 1  ON 2
 uu_3                -2.087877e-02 1 1  ON 3
 uu_4                -6.551274e-02 1 1  ON 4
 uu_5                -9.898829e-02 1 1  ON 5
 uu_6                -1.249164e-01 1 1  ON 6
 uu_7                -1.369788e-01 1 1  ON 7
 uu_8                -1.288113e-01 1 1  ON 8
 uu_9                -9.714443e-02 1 1  ON 9
 ud_0                 4.453535e-01 1 1  ON 10
 ud_1                 1.798034e-01 1 1  ON 11
 ud_2                 5.939800e-02 1 1  ON 12
 ud_3                -1.117187e-02 1 1  ON 13
 ud_4                -6.726695e-02 1 1  ON 14
 ud_5                -1.076430e-01 1 1  ON 15
 ud_6                -1.342495e-01 1 1  ON 16
 ud_7                -1.491953e-01 1 1  ON 17
 ud_8                -1.498256e-01 1 1  ON 18
 ud_9                -1.387779e-01 1 1  ON 19
 eO_0                -7.548751e-01 1 1  ON 20
 eO_1                -4.344123e-01 1 1  ON 21
 eO_2                -1.793180e-02 1 1  ON 22
 eO_3                 2.971944e-01 1 1  ON 23
 eO_4                 5.174709e-01 1 1  ON 24
 eO_5                 4.743228e-01 1 1  ON 25
 eO_6                 2.445100e-01 1 1  ON 26
 eO_7                -5.057468e-02 1 1  ON 27
 eO_8                -2.083830e-01 1 1  ON 28
 eO_9                -6.880549e-02 1 1  ON 29
eH1_0                -2.402701e-01 1 1  ON 30
eH1_1                -1.389716e-01 1 1  ON 31
eH1_2                -9.183361e-02 1 1  ON 32
eH1_3                -3.777914e-02 1 1  ON 33
eH1_4                 1.065938e-02 1 1  ON 34
eH1_5                 4.367803e-02 1 1  ON 35
eH1_6                 9.985325e-02 1 1  ON 36
eH1_7                 1.481206e-01 1 1  ON 37
eH1_8                 1.628193e-01 1 1  ON 38
eH1_9                 4.774278e-02 1 1  ON 39
eH2_0                -2.366091e-01 1 1  ON 40
eH2_1                -1.356781e-01 1 1  ON 41
eH2_2                -8.828571e-02 1 1  ON 42
eH2_3                -3.442281e-02 1 1  ON 43
eH2_4                 1.342283e-02 1 1  ON 44
eH2_5                 4.709589e-02 1 1  ON 45
eH2_6                 1.036259e-01 1 1  ON 46
eH2_7                 1.501366e-01 1 1  ON 47
eH2_8                 1.668108e-01 1 1  ON 48
eH2_9                 3.135287e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7923e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6912e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.0235
    reference variance = 1.48126
====================================================
  Execution time = 2.0537e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3713e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4634e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337097825376
                                         uncertainty =       0.003899925473

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337097825376
                                         uncertainty =       0.003899925473

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410569084
  error estimate for blocks of size 2^( 2) =       0.000423260035
  error estimate for blocks of size 2^( 3) =       0.000436396518
  error estimate for blocks of size 2^( 4) =       0.000449175830
  error estimate for blocks of size 2^( 5) =       0.000460433292
  error estimate for blocks of size 2^( 6) =       0.000468089906
  error estimate for blocks of size 2^( 7) =       0.000474425498

      target function =                  N/A
              le_mean =     -16.906090736084
             les_mean =     286.153037753542
             stat err =       0.000463031132
             autocorr =       1.271885147807
              std dev =       0.580632366833
             le_variance =       0.337133945414


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690609073608e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+04, overlap shift 1.5259e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906090736084       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906090736093       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906090736140       residual = 5.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906090736199       residual = 7.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906090736200       residual = 2.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906090736186       residual = 8.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906090736175       residual = 9.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+04 is 1.644085e-08

solving harmonic davidson linear method for identity shift 6.1035e+04, overlap shift 6.1035e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906090736084       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906090736086       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906090736098       residual = 5.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906090736123       residual = 7.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906090736108       residual = 2.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906090736118       residual = 8.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906090736102       residual = 9.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+04 is 4.110221e-09

solving harmonic davidson linear method for identity shift 2.4414e+05, overlap shift 2.4414e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906090736084       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906090736084       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906090736087       residual = 5.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906090736160       residual = 7.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906090736058       residual = 2.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906090735941       residual = 8.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906090735928       residual = 9.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+05 is 1.027556e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.065931 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6006e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.089013e-01 1 1  ON 0
 uu_1                 1.423322e-01 1 1  ON 1
 uu_2                 4.100682e-02 1 1  ON 2
 uu_3                -2.087877e-02 1 1  ON 3
 uu_4                -6.551274e-02 1 1  ON 4
 uu_5                -9.898829e-02 1 1  ON 5
 uu_6                -1.249164e-01 1 1  ON 6
 uu_7                -1.369788e-01 1 1  ON 7
 uu_8                -1.288113e-01 1 1  ON 8
 uu_9                -9.714443e-02 1 1  ON 9
 ud_0                 4.453535e-01 1 1  ON 10
 ud_1                 1.798034e-01 1 1  ON 11
 ud_2                 5.939800e-02 1 1  ON 12
 ud_3                -1.117187e-02 1 1  ON 13
 ud_4                -6.726695e-02 1 1  ON 14
 ud_5                -1.076430e-01 1 1  ON 15
 ud_6                -1.342495e-01 1 1  ON 16
 ud_7                -1.491953e-01 1 1  ON 17
 ud_8                -1.498256e-01 1 1  ON 18
 ud_9                -1.387779e-01 1 1  ON 19
 eO_0                -7.548751e-01 1 1  ON 20
 eO_1                -4.344123e-01 1 1  ON 21
 eO_2                -1.793180e-02 1 1  ON 22
 eO_3                 2.971944e-01 1 1  ON 23
 eO_4                 5.174709e-01 1 1  ON 24
 eO_5                 4.743228e-01 1 1  ON 25
 eO_6                 2.445100e-01 1 1  ON 26
 eO_7                -5.057468e-02 1 1  ON 27
 eO_8                -2.083830e-01 1 1  ON 28
 eO_9                -6.880549e-02 1 1  ON 29
eH1_0                -2.402702e-01 1 1  ON 30
eH1_1                -1.389716e-01 1 1  ON 31
eH1_2                -9.183361e-02 1 1  ON 32
eH1_3                -3.777914e-02 1 1  ON 33
eH1_4                 1.065937e-02 1 1  ON 34
eH1_5                 4.367803e-02 1 1  ON 35
eH1_6                 9.985325e-02 1 1  ON 36
eH1_7                 1.481206e-01 1 1  ON 37
eH1_8                 1.628193e-01 1 1  ON 38
eH1_9                 4.774278e-02 1 1  ON 39
eH2_0                -2.366091e-01 1 1  ON 40
eH2_1                -1.356781e-01 1 1  ON 41
eH2_2                -8.828571e-02 1 1  ON 42
eH2_3                -3.442281e-02 1 1  ON 43
eH2_4                 1.342283e-02 1 1  ON 44
eH2_5                 4.709589e-02 1 1  ON 45
eH2_6                 1.036259e-01 1 1  ON 46
eH2_7                 1.501366e-01 1 1  ON 47
eH2_8                 1.668108e-01 1 1  ON 48
eH2_9                 3.135287e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.7489
    reference variance = 0.698667
====================================================
  Execution time = 2.0209e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3114e-01
  Total weights = 2.0000e+06
  Execution time = 1.8846e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331073649730
                                         uncertainty =       0.002524220851

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331073649730
                                         uncertainty =       0.002524220851

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406901055
  error estimate for blocks of size 2^( 2) =       0.000419790251
  error estimate for blocks of size 2^( 3) =       0.000433259767
  error estimate for blocks of size 2^( 4) =       0.000445112007
  error estimate for blocks of size 2^( 5) =       0.000456301044
  error estimate for blocks of size 2^( 6) =       0.000464588942
  error estimate for blocks of size 2^( 7) =       0.000467405627

      target function =                  N/A
              le_mean =     -16.905641640682
             les_mean =     286.131856054482
             stat err =       0.000458351905
             autocorr =       1.268879701555
              std dev =       0.575444990324
             le_variance =       0.331136936889

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331073654399
                                         uncertainty =       0.002524220899

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331073654399
                                         uncertainty =       0.002524220899

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406901058
  error estimate for blocks of size 2^( 2) =       0.000419790254
  error estimate for blocks of size 2^( 3) =       0.000433259770
  error estimate for blocks of size 2^( 4) =       0.000445112010
  error estimate for blocks of size 2^( 5) =       0.000456301046
  error estimate for blocks of size 2^( 6) =       0.000464588944
  error estimate for blocks of size 2^( 7) =       0.000467405629

      target function =                  N/A
              le_mean =     -16.905641640696
             les_mean =     286.131856059623
             stat err =       0.000458351907
             autocorr =       1.268879696521
              std dev =       0.575444994384
             le_variance =       0.331136941562

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331073652064
                                         uncertainty =       0.002524220875

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331073652064
                                         uncertainty =       0.002524220875

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406901056
  error estimate for blocks of size 2^( 2) =       0.000419790252
  error estimate for blocks of size 2^( 3) =       0.000433259768
  error estimate for blocks of size 2^( 4) =       0.000445112009
  error estimate for blocks of size 2^( 5) =       0.000456301045
  error estimate for blocks of size 2^( 6) =       0.000464588943
  error estimate for blocks of size 2^( 7) =       0.000467405628

      target function =                  N/A
              le_mean =     -16.905641640689
             les_mean =     286.131856057053
             stat err =       0.000458351906
             autocorr =       1.268879699039
              std dev =       0.575444992354
             le_variance =       0.331136939226

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331073650022
                                         uncertainty =       0.002524220854

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331073650022
                                         uncertainty =       0.002524220854

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406901055
  error estimate for blocks of size 2^( 2) =       0.000419790251
  error estimate for blocks of size 2^( 3) =       0.000433259767
  error estimate for blocks of size 2^( 4) =       0.000445112008
  error estimate for blocks of size 2^( 5) =       0.000456301044
  error estimate for blocks of size 2^( 6) =       0.000464588942
  error estimate for blocks of size 2^( 7) =       0.000467405627

      target function =                  N/A
              le_mean =     -16.905641640683
             les_mean =     286.131856054803
             stat err =       0.000458351905
             autocorr =       1.268879701238
              std dev =       0.575444990578
             le_variance =       0.331136937181


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905641640682        initial
     1.5259e+04     1.5259e+05             1.6441e-08       -16.905641640696  <--
     6.1035e+04     6.1035e+05             4.1102e-09       -16.905641640689
     2.4414e+05     2.4414e+06             1.0276e-09       -16.905641640683

*****************************************************************************
Applying the update for shift_i =   1.5259e+04     and shift_s =   1.5259e+05
*****************************************************************************

  Execution time = 2.9720e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.089013e-01 1 1  ON 0
 uu_1                 1.423322e-01 1 1  ON 1
 uu_2                 4.100682e-02 1 1  ON 2
 uu_3                -2.087877e-02 1 1  ON 3
 uu_4                -6.551274e-02 1 1  ON 4
 uu_5                -9.898829e-02 1 1  ON 5
 uu_6                -1.249164e-01 1 1  ON 6
 uu_7                -1.369788e-01 1 1  ON 7
 uu_8                -1.288113e-01 1 1  ON 8
 uu_9                -9.714443e-02 1 1  ON 9
 ud_0                 4.453535e-01 1 1  ON 10
 ud_1                 1.798034e-01 1 1  ON 11
 ud_2                 5.939800e-02 1 1  ON 12
 ud_3                -1.117187e-02 1 1  ON 13
 ud_4                -6.726696e-02 1 1  ON 14
 ud_5                -1.076430e-01 1 1  ON 15
 ud_6                -1.342495e-01 1 1  ON 16
 ud_7                -1.491953e-01 1 1  ON 17
 ud_8                -1.498256e-01 1 1  ON 18
 ud_9                -1.387779e-01 1 1  ON 19
 eO_0                -7.548751e-01 1 1  ON 20
 eO_1                -4.344123e-01 1 1  ON 21
 eO_2                -1.793181e-02 1 1  ON 22
 eO_3                 2.971944e-01 1 1  ON 23
 eO_4                 5.174709e-01 1 1  ON 24
 eO_5                 4.743228e-01 1 1  ON 25
 eO_6                 2.445100e-01 1 1  ON 26
 eO_7                -5.057467e-02 1 1  ON 27
 eO_8                -2.083830e-01 1 1  ON 28
 eO_9                -6.880550e-02 1 1  ON 29
eH1_0                -2.402702e-01 1 1  ON 30
eH1_1                -1.389716e-01 1 1  ON 31
eH1_2                -9.183361e-02 1 1  ON 32
eH1_3                -3.777914e-02 1 1  ON 33
eH1_4                 1.065937e-02 1 1  ON 34
eH1_5                 4.367803e-02 1 1  ON 35
eH1_6                 9.985325e-02 1 1  ON 36
eH1_7                 1.481206e-01 1 1  ON 37
eH1_8                 1.628193e-01 1 1  ON 38
eH1_9                 4.774279e-02 1 1  ON 39
eH2_0                -2.366091e-01 1 1  ON 40
eH2_1                -1.356781e-01 1 1  ON 41
eH2_2                -8.828571e-02 1 1  ON 42
eH2_3                -3.442282e-02 1 1  ON 43
eH2_4                 1.342283e-02 1 1  ON 44
eH2_5                 4.709589e-02 1 1  ON 45
eH2_6                 1.036259e-01 1 1  ON 46
eH2_7                 1.501366e-01 1 1  ON 47
eH2_8                 1.668108e-01 1 1  ON 48
eH2_9                 3.135288e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5732e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6911e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.8754
    reference variance = 0.201347
====================================================
  Execution time = 2.0701e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4939e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5203e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349154237567
                                         uncertainty =       0.005782768344

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349154237567
                                         uncertainty =       0.005782768344

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417965068
  error estimate for blocks of size 2^( 2) =       0.000430956937
  error estimate for blocks of size 2^( 3) =       0.000443592899
  error estimate for blocks of size 2^( 4) =       0.000455890351
  error estimate for blocks of size 2^( 5) =       0.000467811466
  error estimate for blocks of size 2^( 6) =       0.000476307270
  error estimate for blocks of size 2^( 7) =       0.000480512905

      target function =                  N/A
              le_mean =     -16.905408695633
             les_mean =     286.142232588189
             stat err =       0.000470130498
             autocorr =       1.265193281567
              std dev =       0.591091868075
             le_variance =       0.349389596504


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690540869563e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+03, overlap shift 3.8147e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905408695633       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905408695676       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905408695778       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905408695779       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905408695844       residual = 2.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905408695877       residual = 8.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905408695863       residual = 2.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905408695846       residual = 4.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+03 is 6.443931e-08

solving harmonic davidson linear method for identity shift 1.5259e+04, overlap shift 1.5259e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905408695633       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905408695644       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905408695669       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905408695669       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905408695686       residual = 2.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905408695700       residual = 8.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905408695695       residual = 2.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905408695691       residual = 4.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+04 is 1.611072e-08

solving harmonic davidson linear method for identity shift 6.1035e+04, overlap shift 6.1035e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905408695633       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905408695636       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905408695642       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905408695642       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905408695660       residual = 2.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905408695669       residual = 8.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905408695582       residual = 2.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905408695645       residual = 4.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+04 is 4.027736e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.068516 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6228e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.089013e-01 1 1  ON 0
 uu_1                 1.423322e-01 1 1  ON 1
 uu_2                 4.100682e-02 1 1  ON 2
 uu_3                -2.087878e-02 1 1  ON 3
 uu_4                -6.551273e-02 1 1  ON 4
 uu_5                -9.898829e-02 1 1  ON 5
 uu_6                -1.249164e-01 1 1  ON 6
 uu_7                -1.369788e-01 1 1  ON 7
 uu_8                -1.288113e-01 1 1  ON 8
 uu_9                -9.714444e-02 1 1  ON 9
 ud_0                 4.453535e-01 1 1  ON 10
 ud_1                 1.798034e-01 1 1  ON 11
 ud_2                 5.939801e-02 1 1  ON 12
 ud_3                -1.117186e-02 1 1  ON 13
 ud_4                -6.726696e-02 1 1  ON 14
 ud_5                -1.076430e-01 1 1  ON 15
 ud_6                -1.342495e-01 1 1  ON 16
 ud_7                -1.491953e-01 1 1  ON 17
 ud_8                -1.498256e-01 1 1  ON 18
 ud_9                -1.387779e-01 1 1  ON 19
 eO_0                -7.548752e-01 1 1  ON 20
 eO_1                -4.344123e-01 1 1  ON 21
 eO_2                -1.793181e-02 1 1  ON 22
 eO_3                 2.971944e-01 1 1  ON 23
 eO_4                 5.174710e-01 1 1  ON 24
 eO_5                 4.743228e-01 1 1  ON 25
 eO_6                 2.445100e-01 1 1  ON 26
 eO_7                -5.057467e-02 1 1  ON 27
 eO_8                -2.083830e-01 1 1  ON 28
 eO_9                -6.880551e-02 1 1  ON 29
eH1_0                -2.402702e-01 1 1  ON 30
eH1_1                -1.389716e-01 1 1  ON 31
eH1_2                -9.183361e-02 1 1  ON 32
eH1_3                -3.777915e-02 1 1  ON 33
eH1_4                 1.065936e-02 1 1  ON 34
eH1_5                 4.367803e-02 1 1  ON 35
eH1_6                 9.985325e-02 1 1  ON 36
eH1_7                 1.481206e-01 1 1  ON 37
eH1_8                 1.628193e-01 1 1  ON 38
eH1_9                 4.774280e-02 1 1  ON 39
eH2_0                -2.366091e-01 1 1  ON 40
eH2_1                -1.356781e-01 1 1  ON 41
eH2_2                -8.828572e-02 1 1  ON 42
eH2_3                -3.442281e-02 1 1  ON 43
eH2_4                 1.342283e-02 1 1  ON 44
eH2_5                 4.709588e-02 1 1  ON 45
eH2_6                 1.036259e-01 1 1  ON 46
eH2_7                 1.501366e-01 1 1  ON 47
eH2_8                 1.668108e-01 1 1  ON 48
eH2_9                 3.135289e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.9271
    reference variance = 0.278423
====================================================
  Execution time = 2.0149e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3876e-01
  Total weights = 2.0000e+06
  Execution time = 1.8889e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338680252139
                                         uncertainty =       0.004032686583

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338680252139
                                         uncertainty =       0.004032686583

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411560190
  error estimate for blocks of size 2^( 2) =       0.000424433808
  error estimate for blocks of size 2^( 3) =       0.000437090324
  error estimate for blocks of size 2^( 4) =       0.000449049588
  error estimate for blocks of size 2^( 5) =       0.000460572162
  error estimate for blocks of size 2^( 6) =       0.000467814299
  error estimate for blocks of size 2^( 7) =       0.000470829277

      target function =                  N/A
              le_mean =     -16.905524745240
             les_mean =     286.135530322933
             stat err =       0.000462066331
             autocorr =       1.260497332185
              std dev =       0.582034002779
             le_variance =       0.338763580391

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338680295611
                                         uncertainty =       0.004032687402

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338680295611
                                         uncertainty =       0.004032687402

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411560217
  error estimate for blocks of size 2^( 2) =       0.000424433834
  error estimate for blocks of size 2^( 3) =       0.000437090348
  error estimate for blocks of size 2^( 4) =       0.000449049611
  error estimate for blocks of size 2^( 5) =       0.000460572186
  error estimate for blocks of size 2^( 6) =       0.000467814322
  error estimate for blocks of size 2^( 7) =       0.000470829298

      target function =                  N/A
              le_mean =     -16.905524745112
             les_mean =     286.135530362116
             stat err =       0.000462066354
             autocorr =       1.260497294558
              std dev =       0.582034040150
             le_variance =       0.338763623893

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338680273876
                                         uncertainty =       0.004032686992

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338680273876
                                         uncertainty =       0.004032686992

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411560203
  error estimate for blocks of size 2^( 2) =       0.000424433821
  error estimate for blocks of size 2^( 3) =       0.000437090336
  error estimate for blocks of size 2^( 4) =       0.000449049600
  error estimate for blocks of size 2^( 5) =       0.000460572174
  error estimate for blocks of size 2^( 6) =       0.000467814310
  error estimate for blocks of size 2^( 7) =       0.000470829288

      target function =                  N/A
              le_mean =     -16.905524745176
             les_mean =     286.135530342525
             stat err =       0.000462066343
             autocorr =       1.260497313379
              std dev =       0.582034021466
             le_variance =       0.338763602143

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338680254856
                                         uncertainty =       0.004032686634

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338680254856
                                         uncertainty =       0.004032686634

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411560192
  error estimate for blocks of size 2^( 2) =       0.000424433810
  error estimate for blocks of size 2^( 3) =       0.000437090325
  error estimate for blocks of size 2^( 4) =       0.000449049589
  error estimate for blocks of size 2^( 5) =       0.000460572164
  error estimate for blocks of size 2^( 6) =       0.000467814300
  error estimate for blocks of size 2^( 7) =       0.000470829278

      target function =                  N/A
              le_mean =     -16.905524745232
             les_mean =     286.135530325382
             stat err =       0.000462066333
             autocorr =       1.260497329829
              std dev =       0.582034005115
             le_variance =       0.338763583110


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905524745240        initial  <--
     3.8147e+03     3.8147e+04             6.4439e-08       -16.905524745112
     1.5259e+04     1.5259e+05             1.6111e-08       -16.905524745176
     6.1035e+04     6.1035e+05             4.0277e-09       -16.905524745232

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6763
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.089013e-01 1 1  ON 0
 uu_1                 1.423322e-01 1 1  ON 1
 uu_2                 4.100682e-02 1 1  ON 2
 uu_3                -2.087877e-02 1 1  ON 3
 uu_4                -6.551274e-02 1 1  ON 4
 uu_5                -9.898829e-02 1 1  ON 5
 uu_6                -1.249164e-01 1 1  ON 6
 uu_7                -1.369788e-01 1 1  ON 7
 uu_8                -1.288113e-01 1 1  ON 8
 uu_9                -9.714443e-02 1 1  ON 9
 ud_0                 4.453535e-01 1 1  ON 10
 ud_1                 1.798034e-01 1 1  ON 11
 ud_2                 5.939800e-02 1 1  ON 12
 ud_3                -1.117187e-02 1 1  ON 13
 ud_4                -6.726696e-02 1 1  ON 14
 ud_5                -1.076430e-01 1 1  ON 15
 ud_6                -1.342495e-01 1 1  ON 16
 ud_7                -1.491953e-01 1 1  ON 17
 ud_8                -1.498256e-01 1 1  ON 18
 ud_9                -1.387779e-01 1 1  ON 19
 eO_0                -7.548751e-01 1 1  ON 20
 eO_1                -4.344123e-01 1 1  ON 21
 eO_2                -1.793181e-02 1 1  ON 22
 eO_3                 2.971944e-01 1 1  ON 23
 eO_4                 5.174709e-01 1 1  ON 24
 eO_5                 4.743228e-01 1 1  ON 25
 eO_6                 2.445100e-01 1 1  ON 26
 eO_7                -5.057467e-02 1 1  ON 27
 eO_8                -2.083830e-01 1 1  ON 28
 eO_9                -6.880550e-02 1 1  ON 29
eH1_0                -2.402702e-01 1 1  ON 30
eH1_1                -1.389716e-01 1 1  ON 31
eH1_2                -9.183361e-02 1 1  ON 32
eH1_3                -3.777914e-02 1 1  ON 33
eH1_4                 1.065937e-02 1 1  ON 34
eH1_5                 4.367803e-02 1 1  ON 35
eH1_6                 9.985325e-02 1 1  ON 36
eH1_7                 1.481206e-01 1 1  ON 37
eH1_8                 1.628193e-01 1 1  ON 38
eH1_9                 4.774279e-02 1 1  ON 39
eH2_0                -2.366091e-01 1 1  ON 40
eH2_1                -1.356781e-01 1 1  ON 41
eH2_2                -8.828571e-02 1 1  ON 42
eH2_3                -3.442282e-02 1 1  ON 43
eH2_4                 1.342283e-02 1 1  ON 44
eH2_5                 4.709589e-02 1 1  ON 45
eH2_6                 1.036259e-01 1 1  ON 46
eH2_7                 1.501366e-01 1 1  ON 47
eH2_8                 1.668108e-01 1 1  ON 48
eH2_9                 3.135288e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5910e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.8322
    reference variance = 0.363288
====================================================
  Execution time = 2.0465e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3802e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6208e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338003696441
                                         uncertainty =       0.006393606937

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338003696441
                                         uncertainty =       0.006393606937

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411108657
  error estimate for blocks of size 2^( 2) =       0.000423716678
  error estimate for blocks of size 2^( 3) =       0.000436138337
  error estimate for blocks of size 2^( 4) =       0.000448089513
  error estimate for blocks of size 2^( 5) =       0.000459781416
  error estimate for blocks of size 2^( 6) =       0.000466288145
  error estimate for blocks of size 2^( 7) =       0.000468958191

      target function =                  N/A
              le_mean =     -16.906449700318
             les_mean =     286.166061956584
             stat err =       0.000460779316
             autocorr =       1.256240258288
              std dev =       0.581395438769
             le_variance =       0.338020656221


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690644970032e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+04, overlap shift 3.8147e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906449700318       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906449700337       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906449700342       residual = 3.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906449700339       residual = 8.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906449700354       residual = 4.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906449700291       residual = 8.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906449700380       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906449700355       residual = 3.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+04 is 5.819554e-09

solving harmonic davidson linear method for identity shift 1.5259e+05, overlap shift 1.5259e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906449700318       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906449700323       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906449700324       residual = 3.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906449700324       residual = 8.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906449700317       residual = 4.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906449700236       residual = 8.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906449700290       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906449700201       residual = 3.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+05 is 1.454889e-09

solving harmonic davidson linear method for identity shift 6.1035e+05, overlap shift 6.1035e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906449700318       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906449700319       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906449700319       residual = 3.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906449700260       residual = 8.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906449700119       residual = 4.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906449700495       residual = 8.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906449699737       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906449699818       residual = 3.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+05 is 3.637222e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.071121 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6093e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.089013e-01 1 1  ON 0
 uu_1                 1.423322e-01 1 1  ON 1
 uu_2                 4.100682e-02 1 1  ON 2
 uu_3                -2.087877e-02 1 1  ON 3
 uu_4                -6.551274e-02 1 1  ON 4
 uu_5                -9.898829e-02 1 1  ON 5
 uu_6                -1.249164e-01 1 1  ON 6
 uu_7                -1.369788e-01 1 1  ON 7
 uu_8                -1.288113e-01 1 1  ON 8
 uu_9                -9.714443e-02 1 1  ON 9
 ud_0                 4.453535e-01 1 1  ON 10
 ud_1                 1.798034e-01 1 1  ON 11
 ud_2                 5.939801e-02 1 1  ON 12
 ud_3                -1.117187e-02 1 1  ON 13
 ud_4                -6.726695e-02 1 1  ON 14
 ud_5                -1.076430e-01 1 1  ON 15
 ud_6                -1.342495e-01 1 1  ON 16
 ud_7                -1.491953e-01 1 1  ON 17
 ud_8                -1.498256e-01 1 1  ON 18
 ud_9                -1.387779e-01 1 1  ON 19
 eO_0                -7.548751e-01 1 1  ON 20
 eO_1                -4.344123e-01 1 1  ON 21
 eO_2                -1.793181e-02 1 1  ON 22
 eO_3                 2.971944e-01 1 1  ON 23
 eO_4                 5.174709e-01 1 1  ON 24
 eO_5                 4.743228e-01 1 1  ON 25
 eO_6                 2.445100e-01 1 1  ON 26
 eO_7                -5.057467e-02 1 1  ON 27
 eO_8                -2.083830e-01 1 1  ON 28
 eO_9                -6.880550e-02 1 1  ON 29
eH1_0                -2.402702e-01 1 1  ON 30
eH1_1                -1.389716e-01 1 1  ON 31
eH1_2                -9.183361e-02 1 1  ON 32
eH1_3                -3.777914e-02 1 1  ON 33
eH1_4                 1.065937e-02 1 1  ON 34
eH1_5                 4.367803e-02 1 1  ON 35
eH1_6                 9.985325e-02 1 1  ON 36
eH1_7                 1.481206e-01 1 1  ON 37
eH1_8                 1.628193e-01 1 1  ON 38
eH1_9                 4.774279e-02 1 1  ON 39
eH2_0                -2.366091e-01 1 1  ON 40
eH2_1                -1.356781e-01 1 1  ON 41
eH2_2                -8.828571e-02 1 1  ON 42
eH2_3                -3.442282e-02 1 1  ON 43
eH2_4                 1.342283e-02 1 1  ON 44
eH2_5                 4.709589e-02 1 1  ON 45
eH2_6                 1.036259e-01 1 1  ON 46
eH2_7                 1.501366e-01 1 1  ON 47
eH2_8                 1.668108e-01 1 1  ON 48
eH2_9                 3.135288e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.9211
    reference variance = 0.329018
====================================================
  Execution time = 2.0130e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3707e-01
  Total weights = 2.0000e+06
  Execution time = 1.8872e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337111043652
                                         uncertainty =       0.003681230633

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337111043652
                                         uncertainty =       0.003681230633

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410530036
  error estimate for blocks of size 2^( 2) =       0.000423495273
  error estimate for blocks of size 2^( 3) =       0.000437592409
  error estimate for blocks of size 2^( 4) =       0.000449265271
  error estimate for blocks of size 2^( 5) =       0.000459275258
  error estimate for blocks of size 2^( 6) =       0.000467116491
  error estimate for blocks of size 2^( 7) =       0.000472941783

      target function =                  N/A
              le_mean =     -16.906006070785
             les_mean =     286.150110918026
             stat err =       0.000462149701
             autocorr =       1.267288453245
              std dev =       0.580577144862
             le_variance =       0.337069821136

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337111042203
                                         uncertainty =       0.003681230602

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337111042203
                                         uncertainty =       0.003681230602

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410530035
  error estimate for blocks of size 2^( 2) =       0.000423495272
  error estimate for blocks of size 2^( 3) =       0.000437592408
  error estimate for blocks of size 2^( 4) =       0.000449265270
  error estimate for blocks of size 2^( 5) =       0.000459275258
  error estimate for blocks of size 2^( 6) =       0.000467116490
  error estimate for blocks of size 2^( 7) =       0.000472941782

      target function =                  N/A
              le_mean =     -16.906006070828
             les_mean =     286.150110918034
             stat err =       0.000462149700
             autocorr =       1.267288454335
              std dev =       0.580577143613
             le_variance =       0.337069819686

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337111042927
                                         uncertainty =       0.003681230617

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337111042927
                                         uncertainty =       0.003681230617

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410530036
  error estimate for blocks of size 2^( 2) =       0.000423495272
  error estimate for blocks of size 2^( 3) =       0.000437592409
  error estimate for blocks of size 2^( 4) =       0.000449265271
  error estimate for blocks of size 2^( 5) =       0.000459275258
  error estimate for blocks of size 2^( 6) =       0.000467116491
  error estimate for blocks of size 2^( 7) =       0.000472941783

      target function =                  N/A
              le_mean =     -16.906006070807
             les_mean =     286.150110918030
             stat err =       0.000462149701
             autocorr =       1.267288453790
              std dev =       0.580577144237
             le_variance =       0.337069820411

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337111043561
                                         uncertainty =       0.003681230631

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337111043561
                                         uncertainty =       0.003681230631

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410530036
  error estimate for blocks of size 2^( 2) =       0.000423495273
  error estimate for blocks of size 2^( 3) =       0.000437592409
  error estimate for blocks of size 2^( 4) =       0.000449265271
  error estimate for blocks of size 2^( 5) =       0.000459275258
  error estimate for blocks of size 2^( 6) =       0.000467116491
  error estimate for blocks of size 2^( 7) =       0.000472941783

      target function =                  N/A
              le_mean =     -16.906006070788
             les_mean =     286.150110918027
             stat err =       0.000462149701
             autocorr =       1.267288453314
              std dev =       0.580577144784
             le_variance =       0.337069821045


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906006070785        initial
     3.8147e+04     3.8147e+05             5.8196e-09       -16.906006070828  <--
     1.5259e+05     1.5259e+06             1.4549e-09       -16.906006070807
     6.1035e+05     6.1035e+06             3.6372e-10       -16.906006070788

*****************************************************************************
Applying the update for shift_i =   3.8147e+04     and shift_s =   3.8147e+05
*****************************************************************************

  Execution time = 2.9641e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.089013e-01 1 1  ON 0
 uu_1                 1.423322e-01 1 1  ON 1
 uu_2                 4.100682e-02 1 1  ON 2
 uu_3                -2.087877e-02 1 1  ON 3
 uu_4                -6.551274e-02 1 1  ON 4
 uu_5                -9.898829e-02 1 1  ON 5
 uu_6                -1.249164e-01 1 1  ON 6
 uu_7                -1.369788e-01 1 1  ON 7
 uu_8                -1.288113e-01 1 1  ON 8
 uu_9                -9.714444e-02 1 1  ON 9
 ud_0                 4.453535e-01 1 1  ON 10
 ud_1                 1.798034e-01 1 1  ON 11
 ud_2                 5.939801e-02 1 1  ON 12
 ud_3                -1.117186e-02 1 1  ON 13
 ud_4                -6.726695e-02 1 1  ON 14
 ud_5                -1.076430e-01 1 1  ON 15
 ud_6                -1.342495e-01 1 1  ON 16
 ud_7                -1.491953e-01 1 1  ON 17
 ud_8                -1.498256e-01 1 1  ON 18
 ud_9                -1.387779e-01 1 1  ON 19
 eO_0                -7.548751e-01 1 1  ON 20
 eO_1                -4.344123e-01 1 1  ON 21
 eO_2                -1.793181e-02 1 1  ON 22
 eO_3                 2.971944e-01 1 1  ON 23
 eO_4                 5.174710e-01 1 1  ON 24
 eO_5                 4.743228e-01 1 1  ON 25
 eO_6                 2.445100e-01 1 1  ON 26
 eO_7                -5.057467e-02 1 1  ON 27
 eO_8                -2.083830e-01 1 1  ON 28
 eO_9                -6.880550e-02 1 1  ON 29
eH1_0                -2.402702e-01 1 1  ON 30
eH1_1                -1.389716e-01 1 1  ON 31
eH1_2                -9.183361e-02 1 1  ON 32
eH1_3                -3.777914e-02 1 1  ON 33
eH1_4                 1.065937e-02 1 1  ON 34
eH1_5                 4.367803e-02 1 1  ON 35
eH1_6                 9.985325e-02 1 1  ON 36
eH1_7                 1.481206e-01 1 1  ON 37
eH1_8                 1.628193e-01 1 1  ON 38
eH1_9                 4.774279e-02 1 1  ON 39
eH2_0                -2.366091e-01 1 1  ON 40
eH2_1                -1.356781e-01 1 1  ON 41
eH2_2                -8.828572e-02 1 1  ON 42
eH2_3                -3.442282e-02 1 1  ON 43
eH2_4                 1.342283e-02 1 1  ON 44
eH2_5                 4.709589e-02 1 1  ON 45
eH2_6                 1.036259e-01 1 1  ON 46
eH2_7                 1.501366e-01 1 1  ON 47
eH2_8                 1.668108e-01 1 1  ON 48
eH2_9                 3.135289e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5750e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.9564
    reference variance = 0.303177
====================================================
  Execution time = 2.3597e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4200e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4937e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342122426399
                                         uncertainty =       0.004409551147

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342122426399
                                         uncertainty =       0.004409551147

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413520741
  error estimate for blocks of size 2^( 2) =       0.000426347671
  error estimate for blocks of size 2^( 3) =       0.000439522601
  error estimate for blocks of size 2^( 4) =       0.000452848659
  error estimate for blocks of size 2^( 5) =       0.000463537911
  error estimate for blocks of size 2^( 6) =       0.000471679941
  error estimate for blocks of size 2^( 7) =       0.000476393176

      target function =                  N/A
              le_mean =     -16.906141020701
             les_mean =     286.159602847507
             stat err =       0.000466114922
             autocorr =       1.270548996237
              std dev =       0.584806640407
             le_variance =       0.341998806664


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690614102070e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+03, overlap shift 9.5367e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906141020701       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906141020709       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906141020735       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906141020778       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906141020860       residual = 4.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906141020924       residual = 7.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906141020880       residual = 8.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+03 is 2.666020e-08

solving harmonic davidson linear method for identity shift 3.8147e+04, overlap shift 3.8147e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906141020701       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906141020703       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906141020710       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906141020721       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906141020745       residual = 4.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906141020763       residual = 7.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906141020736       residual = 8.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+04 is 6.665087e-09

solving harmonic davidson linear method for identity shift 1.5259e+05, overlap shift 1.5259e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906141020701       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906141020702       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906141020703       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906141020706       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906141020725       residual = 4.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906141020690       residual = 7.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906141020697       residual = 8.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+05 is 1.666274e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.073393 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9097e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.089013e-01 1 1  ON 0
 uu_1                 1.423322e-01 1 1  ON 1
 uu_2                 4.100682e-02 1 1  ON 2
 uu_3                -2.087877e-02 1 1  ON 3
 uu_4                -6.551273e-02 1 1  ON 4
 uu_5                -9.898829e-02 1 1  ON 5
 uu_6                -1.249164e-01 1 1  ON 6
 uu_7                -1.369788e-01 1 1  ON 7
 uu_8                -1.288113e-01 1 1  ON 8
 uu_9                -9.714444e-02 1 1  ON 9
 ud_0                 4.453535e-01 1 1  ON 10
 ud_1                 1.798034e-01 1 1  ON 11
 ud_2                 5.939801e-02 1 1  ON 12
 ud_3                -1.117186e-02 1 1  ON 13
 ud_4                -6.726695e-02 1 1  ON 14
 ud_5                -1.076430e-01 1 1  ON 15
 ud_6                -1.342495e-01 1 1  ON 16
 ud_7                -1.491953e-01 1 1  ON 17
 ud_8                -1.498256e-01 1 1  ON 18
 ud_9                -1.387779e-01 1 1  ON 19
 eO_0                -7.548751e-01 1 1  ON 20
 eO_1                -4.344123e-01 1 1  ON 21
 eO_2                -1.793181e-02 1 1  ON 22
 eO_3                 2.971944e-01 1 1  ON 23
 eO_4                 5.174710e-01 1 1  ON 24
 eO_5                 4.743228e-01 1 1  ON 25
 eO_6                 2.445100e-01 1 1  ON 26
 eO_7                -5.057467e-02 1 1  ON 27
 eO_8                -2.083830e-01 1 1  ON 28
 eO_9                -6.880551e-02 1 1  ON 29
eH1_0                -2.402702e-01 1 1  ON 30
eH1_1                -1.389716e-01 1 1  ON 31
eH1_2                -9.183362e-02 1 1  ON 32
eH1_3                -3.777915e-02 1 1  ON 33
eH1_4                 1.065937e-02 1 1  ON 34
eH1_5                 4.367803e-02 1 1  ON 35
eH1_6                 9.985325e-02 1 1  ON 36
eH1_7                 1.481206e-01 1 1  ON 37
eH1_8                 1.628193e-01 1 1  ON 38
eH1_9                 4.774280e-02 1 1  ON 39
eH2_0                -2.366091e-01 1 1  ON 40
eH2_1                -1.356781e-01 1 1  ON 41
eH2_2                -8.828572e-02 1 1  ON 42
eH2_3                -3.442282e-02 1 1  ON 43
eH2_4                 1.342283e-02 1 1  ON 44
eH2_5                 4.709589e-02 1 1  ON 45
eH2_6                 1.036259e-01 1 1  ON 46
eH2_7                 1.501366e-01 1 1  ON 47
eH2_8                 1.668108e-01 1 1  ON 48
eH2_9                 3.135289e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.8616
    reference variance = 0.172753
====================================================
  Execution time = 2.0000e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3632e-01
  Total weights = 2.0000e+06
  Execution time = 1.8827e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336339282909
                                         uncertainty =       0.003662547221

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336339282909
                                         uncertainty =       0.003662547221

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410072475
  error estimate for blocks of size 2^( 2) =       0.000422320455
  error estimate for blocks of size 2^( 3) =       0.000435309759
  error estimate for blocks of size 2^( 4) =       0.000446584809
  error estimate for blocks of size 2^( 5) =       0.000456526408
  error estimate for blocks of size 2^( 6) =       0.000464804090
  error estimate for blocks of size 2^( 7) =       0.000467697079

      target function =                  N/A
              le_mean =     -16.905782568761
             les_mean =     286.141802963695
             stat err =       0.000458903096
             autocorr =       1.252335631281
              std dev =       0.579930055824
             le_variance =       0.336318869648

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336339292248
                                         uncertainty =       0.003662547260

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336339292248
                                         uncertainty =       0.003662547260

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410072481
  error estimate for blocks of size 2^( 2) =       0.000422320461
  error estimate for blocks of size 2^( 3) =       0.000435309764
  error estimate for blocks of size 2^( 4) =       0.000446584814
  error estimate for blocks of size 2^( 5) =       0.000456526413
  error estimate for blocks of size 2^( 6) =       0.000464804095
  error estimate for blocks of size 2^( 7) =       0.000467697083

      target function =                  N/A
              le_mean =     -16.905782568818
             les_mean =     286.141802974967
             stat err =       0.000458903101
             autocorr =       1.252335623511
              std dev =       0.579930063876
             le_variance =       0.336318878987

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336339287578
                                         uncertainty =       0.003662547240

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336339287578
                                         uncertainty =       0.003662547240

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410072478
  error estimate for blocks of size 2^( 2) =       0.000422320458
  error estimate for blocks of size 2^( 3) =       0.000435309761
  error estimate for blocks of size 2^( 4) =       0.000446584812
  error estimate for blocks of size 2^( 5) =       0.000456526411
  error estimate for blocks of size 2^( 6) =       0.000464804093
  error estimate for blocks of size 2^( 7) =       0.000467697081

      target function =                  N/A
              le_mean =     -16.905782568789
             les_mean =     286.141802969331
             stat err =       0.000458903099
             autocorr =       1.252335627395
              std dev =       0.579930059850
             le_variance =       0.336318874318

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336339283493
                                         uncertainty =       0.003662547224

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336339283493
                                         uncertainty =       0.003662547224

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410072475
  error estimate for blocks of size 2^( 2) =       0.000422320456
  error estimate for blocks of size 2^( 3) =       0.000435309759
  error estimate for blocks of size 2^( 4) =       0.000446584809
  error estimate for blocks of size 2^( 5) =       0.000456526408
  error estimate for blocks of size 2^( 6) =       0.000464804091
  error estimate for blocks of size 2^( 7) =       0.000467697079

      target function =                  N/A
              le_mean =     -16.905782568764
             les_mean =     286.141802964400
             stat err =       0.000458903097
             autocorr =       1.252335630804
              std dev =       0.579930056327
             le_variance =       0.336318870232


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905782568761        initial
     9.5367e+03     9.5367e+04             2.6660e-08       -16.905782568818  <--
     3.8147e+04     3.8147e+05             6.6651e-09       -16.905782568789
     1.5259e+05     1.5259e+06             1.6663e-09       -16.905782568764

*****************************************************************************
Applying the update for shift_i =   9.5367e+03     and shift_s =   9.5367e+04
*****************************************************************************

  Execution time = 2.9500e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.089013e-01 1 1  ON 0
 uu_1                 1.423322e-01 1 1  ON 1
 uu_2                 4.100683e-02 1 1  ON 2
 uu_3                -2.087878e-02 1 1  ON 3
 uu_4                -6.551273e-02 1 1  ON 4
 uu_5                -9.898830e-02 1 1  ON 5
 uu_6                -1.249164e-01 1 1  ON 6
 uu_7                -1.369788e-01 1 1  ON 7
 uu_8                -1.288113e-01 1 1  ON 8
 uu_9                -9.714445e-02 1 1  ON 9
 ud_0                 4.453535e-01 1 1  ON 10
 ud_1                 1.798034e-01 1 1  ON 11
 ud_2                 5.939802e-02 1 1  ON 12
 ud_3                -1.117186e-02 1 1  ON 13
 ud_4                -6.726695e-02 1 1  ON 14
 ud_5                -1.076430e-01 1 1  ON 15
 ud_6                -1.342495e-01 1 1  ON 16
 ud_7                -1.491953e-01 1 1  ON 17
 ud_8                -1.498256e-01 1 1  ON 18
 ud_9                -1.387779e-01 1 1  ON 19
 eO_0                -7.548751e-01 1 1  ON 20
 eO_1                -4.344123e-01 1 1  ON 21
 eO_2                -1.793182e-02 1 1  ON 22
 eO_3                 2.971944e-01 1 1  ON 23
 eO_4                 5.174710e-01 1 1  ON 24
 eO_5                 4.743228e-01 1 1  ON 25
 eO_6                 2.445100e-01 1 1  ON 26
 eO_7                -5.057467e-02 1 1  ON 27
 eO_8                -2.083830e-01 1 1  ON 28
 eO_9                -6.880552e-02 1 1  ON 29
eH1_0                -2.402702e-01 1 1  ON 30
eH1_1                -1.389716e-01 1 1  ON 31
eH1_2                -9.183362e-02 1 1  ON 32
eH1_3                -3.777916e-02 1 1  ON 33
eH1_4                 1.065936e-02 1 1  ON 34
eH1_5                 4.367803e-02 1 1  ON 35
eH1_6                 9.985325e-02 1 1  ON 36
eH1_7                 1.481206e-01 1 1  ON 37
eH1_8                 1.628193e-01 1 1  ON 38
eH1_9                 4.774281e-02 1 1  ON 39
eH2_0                -2.366091e-01 1 1  ON 40
eH2_1                -1.356781e-01 1 1  ON 41
eH2_2                -8.828573e-02 1 1  ON 42
eH2_3                -3.442282e-02 1 1  ON 43
eH2_4                 1.342282e-02 1 1  ON 44
eH2_5                 4.709588e-02 1 1  ON 45
eH2_6                 1.036259e-01 1 1  ON 46
eH2_7                 1.501366e-01 1 1  ON 47
eH2_8                 1.668108e-01 1 1  ON 48
eH2_9                 3.135291e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8603e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.8973
    reference variance = 0.384078
====================================================
  Execution time = 2.0717e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3202e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5502e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331923728151
                                         uncertainty =       0.002365981574

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331923728151
                                         uncertainty =       0.002365981574

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407444501
  error estimate for blocks of size 2^( 2) =       0.000420448185
  error estimate for blocks of size 2^( 3) =       0.000433437000
  error estimate for blocks of size 2^( 4) =       0.000446329892
  error estimate for blocks of size 2^( 5) =       0.000455711361
  error estimate for blocks of size 2^( 6) =       0.000462745024
  error estimate for blocks of size 2^( 7) =       0.000465729523

      target function =                  N/A
              le_mean =     -16.906242657590
             les_mean =     286.153062673484
             stat err =       0.000457628950
             autocorr =       1.261508148186
              std dev =       0.576213538711
             le_variance =       0.332022042193


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690624265759e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+03, overlap shift 2.3842e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906242657590       residual = 4.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906242657282       residual = 5.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906242657184       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906242657016       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906242657507       residual = 3.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906242657412       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906242657307       residual = 2.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906242657277       residual = 8.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+03 is 1.017417e-07

solving harmonic davidson linear method for identity shift 9.5367e+03, overlap shift 9.5367e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906242657590       residual = 4.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906242657513       residual = 5.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906242657488       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906242657447       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906242657570       residual = 3.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906242657544       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906242657519       residual = 2.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906242657508       residual = 8.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+03 is 2.543571e-08

solving harmonic davidson linear method for identity shift 3.8147e+04, overlap shift 3.8147e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906242657590       residual = 4.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906242657570       residual = 5.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906242657564       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906242657513       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906242657582       residual = 3.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906242657546       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906242657586       residual = 2.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906242657542       residual = 8.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+04 is 6.358944e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.076069 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6274e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.089013e-01 1 1  ON 0
 uu_1                 1.423322e-01 1 1  ON 1
 uu_2                 4.100683e-02 1 1  ON 2
 uu_3                -2.087879e-02 1 1  ON 3
 uu_4                -6.551271e-02 1 1  ON 4
 uu_5                -9.898831e-02 1 1  ON 5
 uu_6                -1.249164e-01 1 1  ON 6
 uu_7                -1.369788e-01 1 1  ON 7
 uu_8                -1.288113e-01 1 1  ON 8
 uu_9                -9.714446e-02 1 1  ON 9
 ud_0                 4.453535e-01 1 1  ON 10
 ud_1                 1.798034e-01 1 1  ON 11
 ud_2                 5.939804e-02 1 1  ON 12
 ud_3                -1.117186e-02 1 1  ON 13
 ud_4                -6.726695e-02 1 1  ON 14
 ud_5                -1.076430e-01 1 1  ON 15
 ud_6                -1.342495e-01 1 1  ON 16
 ud_7                -1.491953e-01 1 1  ON 17
 ud_8                -1.498257e-01 1 1  ON 18
 ud_9                -1.387779e-01 1 1  ON 19
 eO_0                -7.548752e-01 1 1  ON 20
 eO_1                -4.344123e-01 1 1  ON 21
 eO_2                -1.793182e-02 1 1  ON 22
 eO_3                 2.971944e-01 1 1  ON 23
 eO_4                 5.174710e-01 1 1  ON 24
 eO_5                 4.743228e-01 1 1  ON 25
 eO_6                 2.445101e-01 1 1  ON 26
 eO_7                -5.057466e-02 1 1  ON 27
 eO_8                -2.083830e-01 1 1  ON 28
 eO_9                -6.880553e-02 1 1  ON 29
eH1_0                -2.402702e-01 1 1  ON 30
eH1_1                -1.389716e-01 1 1  ON 31
eH1_2                -9.183362e-02 1 1  ON 32
eH1_3                -3.777916e-02 1 1  ON 33
eH1_4                 1.065935e-02 1 1  ON 34
eH1_5                 4.367802e-02 1 1  ON 35
eH1_6                 9.985325e-02 1 1  ON 36
eH1_7                 1.481206e-01 1 1  ON 37
eH1_8                 1.628194e-01 1 1  ON 38
eH1_9                 4.774283e-02 1 1  ON 39
eH2_0                -2.366092e-01 1 1  ON 40
eH2_1                -1.356781e-01 1 1  ON 41
eH2_2                -8.828574e-02 1 1  ON 42
eH2_3                -3.442283e-02 1 1  ON 43
eH2_4                 1.342282e-02 1 1  ON 44
eH2_5                 4.709588e-02 1 1  ON 45
eH2_6                 1.036259e-01 1 1  ON 46
eH2_7                 1.501366e-01 1 1  ON 47
eH2_8                 1.668108e-01 1 1  ON 48
eH2_9                 3.135294e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.8257
    reference variance = 0.240331
====================================================
  Execution time = 2.0256e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4360e-01
  Total weights = 2.0000e+06
  Execution time = 1.8914e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343665483290
                                         uncertainty =       0.007948913960

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343665483290
                                         uncertainty =       0.007948913960

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414487808
  error estimate for blocks of size 2^( 2) =       0.000426779598
  error estimate for blocks of size 2^( 3) =       0.000439829526
  error estimate for blocks of size 2^( 4) =       0.000452081238
  error estimate for blocks of size 2^( 5) =       0.000463501512
  error estimate for blocks of size 2^( 6) =       0.000470518201
  error estimate for blocks of size 2^( 7) =       0.000476399256

      target function =                  N/A
              le_mean =     -16.906115724751
             les_mean =     286.160349013647
             stat err =       0.000465625052
             autocorr =       1.261970360961
              std dev =       0.586174280218
             le_variance =       0.343600286789

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343665491917
                                         uncertainty =       0.007948913420

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343665491917
                                         uncertainty =       0.007948913420

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414487814
  error estimate for blocks of size 2^( 2) =       0.000426779603
  error estimate for blocks of size 2^( 3) =       0.000439829529
  error estimate for blocks of size 2^( 4) =       0.000452081240
  error estimate for blocks of size 2^( 5) =       0.000463501513
  error estimate for blocks of size 2^( 6) =       0.000470518201
  error estimate for blocks of size 2^( 7) =       0.000476399255

      target function =                  N/A
              le_mean =     -16.906115724383
             les_mean =     286.160349009863
             stat err =       0.000465625052
             autocorr =       1.261970332117
              std dev =       0.586174287591
             le_variance =       0.343600295433

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343665487603
                                         uncertainty =       0.007948913690

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343665487603
                                         uncertainty =       0.007948913690

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414487811
  error estimate for blocks of size 2^( 2) =       0.000426779600
  error estimate for blocks of size 2^( 3) =       0.000439829527
  error estimate for blocks of size 2^( 4) =       0.000452081239
  error estimate for blocks of size 2^( 5) =       0.000463501512
  error estimate for blocks of size 2^( 6) =       0.000470518201
  error estimate for blocks of size 2^( 7) =       0.000476399256

      target function =                  N/A
              le_mean =     -16.906115724567
             les_mean =     286.160349011754
             stat err =       0.000465625052
             autocorr =       1.261970346536
              std dev =       0.586174283904
             le_variance =       0.343600291111

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343665483829
                                         uncertainty =       0.007948913926

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343665483829
                                         uncertainty =       0.007948913926

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414487809
  error estimate for blocks of size 2^( 2) =       0.000426779598
  error estimate for blocks of size 2^( 3) =       0.000439829526
  error estimate for blocks of size 2^( 4) =       0.000452081238
  error estimate for blocks of size 2^( 5) =       0.000463501512
  error estimate for blocks of size 2^( 6) =       0.000470518201
  error estimate for blocks of size 2^( 7) =       0.000476399256

      target function =                  N/A
              le_mean =     -16.906115724728
             les_mean =     286.160349013410
             stat err =       0.000465625052
             autocorr =       1.261970359161
              std dev =       0.586174280678
             le_variance =       0.343600287329


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906115724751        initial  <--
     2.3842e+03     2.3842e+04             1.0174e-07       -16.906115724383
     9.5367e+03     9.5367e+04             2.5436e-08       -16.906115724567
     3.8147e+04     3.8147e+05             6.3589e-09       -16.906115724728

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7951
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.089013e-01 1 1  ON 0
 uu_1                 1.423322e-01 1 1  ON 1
 uu_2                 4.100683e-02 1 1  ON 2
 uu_3                -2.087878e-02 1 1  ON 3
 uu_4                -6.551273e-02 1 1  ON 4
 uu_5                -9.898830e-02 1 1  ON 5
 uu_6                -1.249164e-01 1 1  ON 6
 uu_7                -1.369788e-01 1 1  ON 7
 uu_8                -1.288113e-01 1 1  ON 8
 uu_9                -9.714445e-02 1 1  ON 9
 ud_0                 4.453535e-01 1 1  ON 10
 ud_1                 1.798034e-01 1 1  ON 11
 ud_2                 5.939802e-02 1 1  ON 12
 ud_3                -1.117186e-02 1 1  ON 13
 ud_4                -6.726695e-02 1 1  ON 14
 ud_5                -1.076430e-01 1 1  ON 15
 ud_6                -1.342495e-01 1 1  ON 16
 ud_7                -1.491953e-01 1 1  ON 17
 ud_8                -1.498256e-01 1 1  ON 18
 ud_9                -1.387779e-01 1 1  ON 19
 eO_0                -7.548751e-01 1 1  ON 20
 eO_1                -4.344123e-01 1 1  ON 21
 eO_2                -1.793182e-02 1 1  ON 22
 eO_3                 2.971944e-01 1 1  ON 23
 eO_4                 5.174710e-01 1 1  ON 24
 eO_5                 4.743228e-01 1 1  ON 25
 eO_6                 2.445100e-01 1 1  ON 26
 eO_7                -5.057467e-02 1 1  ON 27
 eO_8                -2.083830e-01 1 1  ON 28
 eO_9                -6.880552e-02 1 1  ON 29
eH1_0                -2.402702e-01 1 1  ON 30
eH1_1                -1.389716e-01 1 1  ON 31
eH1_2                -9.183362e-02 1 1  ON 32
eH1_3                -3.777916e-02 1 1  ON 33
eH1_4                 1.065936e-02 1 1  ON 34
eH1_5                 4.367803e-02 1 1  ON 35
eH1_6                 9.985325e-02 1 1  ON 36
eH1_7                 1.481206e-01 1 1  ON 37
eH1_8                 1.628193e-01 1 1  ON 38
eH1_9                 4.774281e-02 1 1  ON 39
eH2_0                -2.366091e-01 1 1  ON 40
eH2_1                -1.356781e-01 1 1  ON 41
eH2_2                -8.828573e-02 1 1  ON 42
eH2_3                -3.442282e-02 1 1  ON 43
eH2_4                 1.342282e-02 1 1  ON 44
eH2_5                 4.709588e-02 1 1  ON 45
eH2_6                 1.036259e-01 1 1  ON 46
eH2_7                 1.501366e-01 1 1  ON 47
eH2_8                 1.668108e-01 1 1  ON 48
eH2_9                 3.135291e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6075e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.8675
    reference variance = 0.188957
====================================================
  Execution time = 2.0471e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3745e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4959e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337516546581
                                         uncertainty =       0.002812692950

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337516546581
                                         uncertainty =       0.002812692950

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410762676
  error estimate for blocks of size 2^( 2) =       0.000423356941
  error estimate for blocks of size 2^( 3) =       0.000436680276
  error estimate for blocks of size 2^( 4) =       0.000449522883
  error estimate for blocks of size 2^( 5) =       0.000458694828
  error estimate for blocks of size 2^( 6) =       0.000466997215
  error estimate for blocks of size 2^( 7) =       0.000470332573

      target function =                  N/A
              le_mean =     -16.906467396033
             les_mean =     286.166091596078
             stat err =       0.000461386875
             autocorr =       1.261677978557
              std dev =       0.580906147052
             le_variance =       0.337451951683


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690646739603e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+04, overlap shift 2.3842e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906467396033       residual = 3.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906467396044       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906467396025       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906467396025       residual = 6.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906467396082       residual = 3.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906467396094       residual = 9.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906467396081       residual = 1.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906467396084       residual = 3.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+04 is 9.561634e-09

solving harmonic davidson linear method for identity shift 9.5367e+04, overlap shift 9.5367e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906467396033       residual = 3.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906467396036       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906467396031       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906467396033       residual = 6.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906467396010       residual = 3.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906467395955       residual = 9.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906467396055       residual = 1.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906467395978       residual = 3.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+04 is 2.390410e-09

solving harmonic davidson linear method for identity shift 3.8147e+05, overlap shift 3.8147e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906467396033       residual = 3.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906467396034       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906467396032       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906467395824       residual = 6.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906467396318       residual = 3.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906467396315       residual = 9.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906467396101       residual = 1.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906467396022       residual = 3.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+05 is 5.976028e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.078694 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5974e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.089013e-01 1 1  ON 0
 uu_1                 1.423322e-01 1 1  ON 1
 uu_2                 4.100683e-02 1 1  ON 2
 uu_3                -2.087878e-02 1 1  ON 3
 uu_4                -6.551273e-02 1 1  ON 4
 uu_5                -9.898830e-02 1 1  ON 5
 uu_6                -1.249164e-01 1 1  ON 6
 uu_7                -1.369788e-01 1 1  ON 7
 uu_8                -1.288113e-01 1 1  ON 8
 uu_9                -9.714445e-02 1 1  ON 9
 ud_0                 4.453535e-01 1 1  ON 10
 ud_1                 1.798034e-01 1 1  ON 11
 ud_2                 5.939802e-02 1 1  ON 12
 ud_3                -1.117186e-02 1 1  ON 13
 ud_4                -6.726695e-02 1 1  ON 14
 ud_5                -1.076430e-01 1 1  ON 15
 ud_6                -1.342495e-01 1 1  ON 16
 ud_7                -1.491953e-01 1 1  ON 17
 ud_8                -1.498256e-01 1 1  ON 18
 ud_9                -1.387779e-01 1 1  ON 19
 eO_0                -7.548751e-01 1 1  ON 20
 eO_1                -4.344123e-01 1 1  ON 21
 eO_2                -1.793182e-02 1 1  ON 22
 eO_3                 2.971944e-01 1 1  ON 23
 eO_4                 5.174710e-01 1 1  ON 24
 eO_5                 4.743228e-01 1 1  ON 25
 eO_6                 2.445101e-01 1 1  ON 26
 eO_7                -5.057467e-02 1 1  ON 27
 eO_8                -2.083830e-01 1 1  ON 28
 eO_9                -6.880552e-02 1 1  ON 29
eH1_0                -2.402702e-01 1 1  ON 30
eH1_1                -1.389716e-01 1 1  ON 31
eH1_2                -9.183362e-02 1 1  ON 32
eH1_3                -3.777916e-02 1 1  ON 33
eH1_4                 1.065936e-02 1 1  ON 34
eH1_5                 4.367803e-02 1 1  ON 35
eH1_6                 9.985325e-02 1 1  ON 36
eH1_7                 1.481206e-01 1 1  ON 37
eH1_8                 1.628193e-01 1 1  ON 38
eH1_9                 4.774281e-02 1 1  ON 39
eH2_0                -2.366091e-01 1 1  ON 40
eH2_1                -1.356781e-01 1 1  ON 41
eH2_2                -8.828573e-02 1 1  ON 42
eH2_3                -3.442282e-02 1 1  ON 43
eH2_4                 1.342282e-02 1 1  ON 44
eH2_5                 4.709587e-02 1 1  ON 45
eH2_6                 1.036259e-01 1 1  ON 46
eH2_7                 1.501366e-01 1 1  ON 47
eH2_8                 1.668108e-01 1 1  ON 48
eH2_9                 3.135292e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.9133
    reference variance = 0.299597
====================================================
  Execution time = 2.0072e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4101e-01
  Total weights = 2.0000e+06
  Execution time = 1.8851e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341091726443
                                         uncertainty =       0.003961299826

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341091726443
                                         uncertainty =       0.003961299826

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412919709
  error estimate for blocks of size 2^( 2) =       0.000426296613
  error estimate for blocks of size 2^( 3) =       0.000439309308
  error estimate for blocks of size 2^( 4) =       0.000452067979
  error estimate for blocks of size 2^( 5) =       0.000464215089
  error estimate for blocks of size 2^( 6) =       0.000473418310
  error estimate for blocks of size 2^( 7) =       0.000478326096

      target function =                  N/A
              le_mean =     -16.905940150425
             les_mean =     286.151817571753
             stat err =       0.000467006868
             autocorr =       1.279131841156
              std dev =       0.583956652930
             le_variance =       0.341005372501

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341091729014
                                         uncertainty =       0.003961299874

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341091729014
                                         uncertainty =       0.003961299874

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412919711
  error estimate for blocks of size 2^( 2) =       0.000426296614
  error estimate for blocks of size 2^( 3) =       0.000439309310
  error estimate for blocks of size 2^( 4) =       0.000452067980
  error estimate for blocks of size 2^( 5) =       0.000464215090
  error estimate for blocks of size 2^( 6) =       0.000473418311
  error estimate for blocks of size 2^( 7) =       0.000478326097

      target function =                  N/A
              le_mean =     -16.905940150426
             les_mean =     286.151817574356
             stat err =       0.000467006869
             autocorr =       1.279131838163
              std dev =       0.583956655133
             le_variance =       0.341005375074

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341091727728
                                         uncertainty =       0.003961299850

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341091727728
                                         uncertainty =       0.003961299850

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412919710
  error estimate for blocks of size 2^( 2) =       0.000426296614
  error estimate for blocks of size 2^( 3) =       0.000439309309
  error estimate for blocks of size 2^( 4) =       0.000452067979
  error estimate for blocks of size 2^( 5) =       0.000464215089
  error estimate for blocks of size 2^( 6) =       0.000473418311
  error estimate for blocks of size 2^( 7) =       0.000478326096

      target function =                  N/A
              le_mean =     -16.905940150426
             les_mean =     286.151817573054
             stat err =       0.000467006869
             autocorr =       1.279131839661
              std dev =       0.583956654031
             le_variance =       0.341005373788

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341091726603
                                         uncertainty =       0.003961299829

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341091726603
                                         uncertainty =       0.003961299829

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412919709
  error estimate for blocks of size 2^( 2) =       0.000426296613
  error estimate for blocks of size 2^( 3) =       0.000439309308
  error estimate for blocks of size 2^( 4) =       0.000452067979
  error estimate for blocks of size 2^( 5) =       0.000464215089
  error estimate for blocks of size 2^( 6) =       0.000473418310
  error estimate for blocks of size 2^( 7) =       0.000478326096

      target function =                  N/A
              le_mean =     -16.905940150425
             les_mean =     286.151817571915
             stat err =       0.000467006868
             autocorr =       1.279131840969
              std dev =       0.583956653068
             le_variance =       0.341005372662


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905940150425        initial
     2.3842e+04     2.3842e+05             9.5616e-09       -16.905940150426  <--
     9.5367e+04     9.5367e+05             2.3904e-09       -16.905940150426
     3.8147e+05     3.8147e+06             5.9760e-10       -16.905940150425

*****************************************************************************
Applying the update for shift_i =   2.3842e+04     and shift_s =   2.3842e+05
*****************************************************************************

  Execution time = 2.9580e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.089013e-01 1 1  ON 0
 uu_1                 1.423322e-01 1 1  ON 1
 uu_2                 4.100683e-02 1 1  ON 2
 uu_3                -2.087878e-02 1 1  ON 3
 uu_4                -6.551273e-02 1 1  ON 4
 uu_5                -9.898830e-02 1 1  ON 5
 uu_6                -1.249164e-01 1 1  ON 6
 uu_7                -1.369788e-01 1 1  ON 7
 uu_8                -1.288113e-01 1 1  ON 8
 uu_9                -9.714445e-02 1 1  ON 9
 ud_0                 4.453535e-01 1 1  ON 10
 ud_1                 1.798034e-01 1 1  ON 11
 ud_2                 5.939802e-02 1 1  ON 12
 ud_3                -1.117186e-02 1 1  ON 13
 ud_4                -6.726695e-02 1 1  ON 14
 ud_5                -1.076430e-01 1 1  ON 15
 ud_6                -1.342495e-01 1 1  ON 16
 ud_7                -1.491953e-01 1 1  ON 17
 ud_8                -1.498256e-01 1 1  ON 18
 ud_9                -1.387779e-01 1 1  ON 19
 eO_0                -7.548752e-01 1 1  ON 20
 eO_1                -4.344123e-01 1 1  ON 21
 eO_2                -1.793183e-02 1 1  ON 22
 eO_3                 2.971944e-01 1 1  ON 23
 eO_4                 5.174710e-01 1 1  ON 24
 eO_5                 4.743228e-01 1 1  ON 25
 eO_6                 2.445101e-01 1 1  ON 26
 eO_7                -5.057467e-02 1 1  ON 27
 eO_8                -2.083830e-01 1 1  ON 28
 eO_9                -6.880552e-02 1 1  ON 29
eH1_0                -2.402702e-01 1 1  ON 30
eH1_1                -1.389716e-01 1 1  ON 31
eH1_2                -9.183362e-02 1 1  ON 32
eH1_3                -3.777916e-02 1 1  ON 33
eH1_4                 1.065936e-02 1 1  ON 34
eH1_5                 4.367803e-02 1 1  ON 35
eH1_6                 9.985324e-02 1 1  ON 36
eH1_7                 1.481206e-01 1 1  ON 37
eH1_8                 1.628193e-01 1 1  ON 38
eH1_9                 4.774282e-02 1 1  ON 39
eH2_0                -2.366092e-01 1 1  ON 40
eH2_1                -1.356781e-01 1 1  ON 41
eH2_2                -8.828573e-02 1 1  ON 42
eH2_3                -3.442283e-02 1 1  ON 43
eH2_4                 1.342282e-02 1 1  ON 44
eH2_5                 4.709587e-02 1 1  ON 45
eH2_6                 1.036259e-01 1 1  ON 46
eH2_7                 1.501366e-01 1 1  ON 47
eH2_8                 1.668108e-01 1 1  ON 48
eH2_9                 3.135292e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5560e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.8291
    reference variance = 0.319158
====================================================
  Execution time = 2.0441e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3894e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4639e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338968252239
                                         uncertainty =       0.004061698865

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338968252239
                                         uncertainty =       0.004061698865

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411665612
  error estimate for blocks of size 2^( 2) =       0.000424391899
  error estimate for blocks of size 2^( 3) =       0.000437963819
  error estimate for blocks of size 2^( 4) =       0.000450573238
  error estimate for blocks of size 2^( 5) =       0.000462108293
  error estimate for blocks of size 2^( 6) =       0.000471344256
  error estimate for blocks of size 2^( 7) =       0.000476554313

      target function =                  N/A
              le_mean =     -16.906080499268
             les_mean =     286.154494830785
             stat err =       0.000465145025
             autocorr =       1.276696241874
              std dev =       0.582183091934
             le_variance =       0.338937152534


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690608049927e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+03, overlap shift 5.9605e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906080499268       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906080499255       residual = 3.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906080499351       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906080499405       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906080499439       residual = 8.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906080499462       residual = 7.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906080499437       residual = 6.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+03 is 3.652768e-08

solving harmonic davidson linear method for identity shift 2.3842e+04, overlap shift 2.3842e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906080499268       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906080499265       residual = 3.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906080499288       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906080499298       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906080499308       residual = 8.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906080499320       residual = 7.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906080499328       residual = 6.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+04 is 9.132525e-09

solving harmonic davidson linear method for identity shift 9.5367e+04, overlap shift 9.5367e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906080499268       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906080499267       residual = 3.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906080499273       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906080499276       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906080499180       residual = 8.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906080499279       residual = 7.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906080499305       residual = 6.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+04 is 2.283169e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.080946 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5911e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.089013e-01 1 1  ON 0
 uu_1                 1.423322e-01 1 1  ON 1
 uu_2                 4.100683e-02 1 1  ON 2
 uu_3                -2.087878e-02 1 1  ON 3
 uu_4                -6.551273e-02 1 1  ON 4
 uu_5                -9.898831e-02 1 1  ON 5
 uu_6                -1.249164e-01 1 1  ON 6
 uu_7                -1.369788e-01 1 1  ON 7
 uu_8                -1.288113e-01 1 1  ON 8
 uu_9                -9.714445e-02 1 1  ON 9
 ud_0                 4.453535e-01 1 1  ON 10
 ud_1                 1.798034e-01 1 1  ON 11
 ud_2                 5.939802e-02 1 1  ON 12
 ud_3                -1.117186e-02 1 1  ON 13
 ud_4                -6.726695e-02 1 1  ON 14
 ud_5                -1.076430e-01 1 1  ON 15
 ud_6                -1.342495e-01 1 1  ON 16
 ud_7                -1.491953e-01 1 1  ON 17
 ud_8                -1.498256e-01 1 1  ON 18
 ud_9                -1.387779e-01 1 1  ON 19
 eO_0                -7.548752e-01 1 1  ON 20
 eO_1                -4.344123e-01 1 1  ON 21
 eO_2                -1.793183e-02 1 1  ON 22
 eO_3                 2.971944e-01 1 1  ON 23
 eO_4                 5.174710e-01 1 1  ON 24
 eO_5                 4.743228e-01 1 1  ON 25
 eO_6                 2.445101e-01 1 1  ON 26
 eO_7                -5.057466e-02 1 1  ON 27
 eO_8                -2.083830e-01 1 1  ON 28
 eO_9                -6.880553e-02 1 1  ON 29
eH1_0                -2.402702e-01 1 1  ON 30
eH1_1                -1.389716e-01 1 1  ON 31
eH1_2                -9.183363e-02 1 1  ON 32
eH1_3                -3.777917e-02 1 1  ON 33
eH1_4                 1.065936e-02 1 1  ON 34
eH1_5                 4.367803e-02 1 1  ON 35
eH1_6                 9.985324e-02 1 1  ON 36
eH1_7                 1.481206e-01 1 1  ON 37
eH1_8                 1.628194e-01 1 1  ON 38
eH1_9                 4.774282e-02 1 1  ON 39
eH2_0                -2.366092e-01 1 1  ON 40
eH2_1                -1.356781e-01 1 1  ON 41
eH2_2                -8.828573e-02 1 1  ON 42
eH2_3                -3.442283e-02 1 1  ON 43
eH2_4                 1.342282e-02 1 1  ON 44
eH2_5                 4.709587e-02 1 1  ON 45
eH2_6                 1.036259e-01 1 1  ON 46
eH2_7                 1.501366e-01 1 1  ON 47
eH2_8                 1.668108e-01 1 1  ON 48
eH2_9                 3.135293e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.9193
    reference variance = 0.143148
====================================================
  Execution time = 2.0002e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3827e-01
  Total weights = 2.0000e+06
  Execution time = 1.8821e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338330796781
                                         uncertainty =       0.004637365828

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338330796781
                                         uncertainty =       0.004637365828

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411259286
  error estimate for blocks of size 2^( 2) =       0.000424110457
  error estimate for blocks of size 2^( 3) =       0.000437578703
  error estimate for blocks of size 2^( 4) =       0.000449986453
  error estimate for blocks of size 2^( 5) =       0.000461322114
  error estimate for blocks of size 2^( 6) =       0.000469055515
  error estimate for blocks of size 2^( 7) =       0.000473590746

      target function =                  N/A
              le_mean =     -16.905389910339
             les_mean =     286.130476252450
             stat err =       0.000463488707
             autocorr =       1.270126212505
              std dev =       0.581608460219
             le_variance =       0.338268400998

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338330831210
                                         uncertainty =       0.004637366386

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338330831210
                                         uncertainty =       0.004637366386

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411259307
  error estimate for blocks of size 2^( 2) =       0.000424110477
  error estimate for blocks of size 2^( 3) =       0.000437578723
  error estimate for blocks of size 2^( 4) =       0.000449986472
  error estimate for blocks of size 2^( 5) =       0.000461322132
  error estimate for blocks of size 2^( 6) =       0.000469055532
  error estimate for blocks of size 2^( 7) =       0.000473590763

      target function =                  N/A
              le_mean =     -16.905389910547
             les_mean =     286.130476293925
             stat err =       0.000463488725
             autocorr =       1.270126179956
              std dev =       0.581608489814
             le_variance =       0.338268435424

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338330813997
                                         uncertainty =       0.004637366107

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338330813997
                                         uncertainty =       0.004637366107

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411259297
  error estimate for blocks of size 2^( 2) =       0.000424110467
  error estimate for blocks of size 2^( 3) =       0.000437578713
  error estimate for blocks of size 2^( 4) =       0.000449986463
  error estimate for blocks of size 2^( 5) =       0.000461322123
  error estimate for blocks of size 2^( 6) =       0.000469055524
  error estimate for blocks of size 2^( 7) =       0.000473590754

      target function =                  N/A
              le_mean =     -16.905389910443
             les_mean =     286.130476273189
             stat err =       0.000463488716
             autocorr =       1.270126196224
              std dev =       0.581608475018
             le_variance =       0.338268418212

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338330798933
                                         uncertainty =       0.004637365863

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338330798933
                                         uncertainty =       0.004637365863

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411259288
  error estimate for blocks of size 2^( 2) =       0.000424110458
  error estimate for blocks of size 2^( 3) =       0.000437578705
  error estimate for blocks of size 2^( 4) =       0.000449986454
  error estimate for blocks of size 2^( 5) =       0.000461322115
  error estimate for blocks of size 2^( 6) =       0.000469055516
  error estimate for blocks of size 2^( 7) =       0.000473590747

      target function =                  N/A
              le_mean =     -16.905389910352
             les_mean =     286.130476255043
             stat err =       0.000463488708
             autocorr =       1.270126210476
              std dev =       0.581608462069
             le_variance =       0.338268403150


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905389910339        initial
     5.9605e+03     5.9605e+04             3.6528e-08       -16.905389910547  <--
     2.3842e+04     2.3842e+05             9.1325e-09       -16.905389910443
     9.5367e+04     9.5367e+05             2.2832e-09       -16.905389910352

*****************************************************************************
Applying the update for shift_i =   5.9605e+03     and shift_s =   5.9605e+04
*****************************************************************************

  Execution time = 2.9538e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.089013e-01 1 1  ON 0
 uu_1                 1.423322e-01 1 1  ON 1
 uu_2                 4.100683e-02 1 1  ON 2
 uu_3                -2.087878e-02 1 1  ON 3
 uu_4                -6.551273e-02 1 1  ON 4
 uu_5                -9.898831e-02 1 1  ON 5
 uu_6                -1.249164e-01 1 1  ON 6
 uu_7                -1.369788e-01 1 1  ON 7
 uu_8                -1.288113e-01 1 1  ON 8
 uu_9                -9.714446e-02 1 1  ON 9
 ud_0                 4.453536e-01 1 1  ON 10
 ud_1                 1.798034e-01 1 1  ON 11
 ud_2                 5.939803e-02 1 1  ON 12
 ud_3                -1.117187e-02 1 1  ON 13
 ud_4                -6.726695e-02 1 1  ON 14
 ud_5                -1.076430e-01 1 1  ON 15
 ud_6                -1.342495e-01 1 1  ON 16
 ud_7                -1.491953e-01 1 1  ON 17
 ud_8                -1.498256e-01 1 1  ON 18
 ud_9                -1.387779e-01 1 1  ON 19
 eO_0                -7.548752e-01 1 1  ON 20
 eO_1                -4.344123e-01 1 1  ON 21
 eO_2                -1.793184e-02 1 1  ON 22
 eO_3                 2.971944e-01 1 1  ON 23
 eO_4                 5.174710e-01 1 1  ON 24
 eO_5                 4.743229e-01 1 1  ON 25
 eO_6                 2.445101e-01 1 1  ON 26
 eO_7                -5.057465e-02 1 1  ON 27
 eO_8                -2.083830e-01 1 1  ON 28
 eO_9                -6.880554e-02 1 1  ON 29
eH1_0                -2.402702e-01 1 1  ON 30
eH1_1                -1.389716e-01 1 1  ON 31
eH1_2                -9.183363e-02 1 1  ON 32
eH1_3                -3.777918e-02 1 1  ON 33
eH1_4                 1.065935e-02 1 1  ON 34
eH1_5                 4.367802e-02 1 1  ON 35
eH1_6                 9.985324e-02 1 1  ON 36
eH1_7                 1.481206e-01 1 1  ON 37
eH1_8                 1.628194e-01 1 1  ON 38
eH1_9                 4.774284e-02 1 1  ON 39
eH2_0                -2.366092e-01 1 1  ON 40
eH2_1                -1.356781e-01 1 1  ON 41
eH2_2                -8.828574e-02 1 1  ON 42
eH2_3                -3.442283e-02 1 1  ON 43
eH2_4                 1.342282e-02 1 1  ON 44
eH2_5                 4.709585e-02 1 1  ON 45
eH2_6                 1.036258e-01 1 1  ON 46
eH2_7                 1.501367e-01 1 1  ON 47
eH2_8                 1.668108e-01 1 1  ON 48
eH2_9                 3.135295e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5455e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.9113
    reference variance = 0.24563
====================================================
  Execution time = 2.0686e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3333e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5517e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333419095471
                                         uncertainty =       0.003525972337

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333419095471
                                         uncertainty =       0.003525972337

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408246155
  error estimate for blocks of size 2^( 2) =       0.000420676432
  error estimate for blocks of size 2^( 3) =       0.000433101599
  error estimate for blocks of size 2^( 4) =       0.000444706654
  error estimate for blocks of size 2^( 5) =       0.000453180190
  error estimate for blocks of size 2^( 6) =       0.000460925967
  error estimate for blocks of size 2^( 7) =       0.000465387962

      target function =                  N/A
              le_mean =     -16.906193460489
             les_mean =     286.152707003305
             stat err =       0.000456050193
             autocorr =       1.247903726968
              std dev =       0.577347249496
             le_variance =       0.333329846501


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690619346049e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+03, overlap shift 1.4901e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906193460489       residual = 9.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906193461284       residual = 3.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906193461171       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906193461395       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906193462298       residual = 4.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906193461898       residual = 7.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906193461880       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906193461784       residual = 3.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+03 is 1.567463e-07

solving harmonic davidson linear method for identity shift 5.9605e+03, overlap shift 5.9605e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906193460489       residual = 9.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906193460688       residual = 3.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906193460659       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906193460715       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906193460941       residual = 4.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906193460839       residual = 7.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906193460835       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906193460807       residual = 3.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+03 is 3.918734e-08

solving harmonic davidson linear method for identity shift 2.3842e+04, overlap shift 2.3842e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906193460489       residual = 9.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906193460538       residual = 3.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906193460531       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906193460553       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906193460602       residual = 4.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906193460580       residual = 7.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906193460594       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906193460564       residual = 3.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+04 is 9.796883e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.083586 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6244e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.089013e-01 1 1  ON 0
 uu_1                 1.423322e-01 1 1  ON 1
 uu_2                 4.100685e-02 1 1  ON 2
 uu_3                -2.087879e-02 1 1  ON 3
 uu_4                -6.551272e-02 1 1  ON 4
 uu_5                -9.898833e-02 1 1  ON 5
 uu_6                -1.249164e-01 1 1  ON 6
 uu_7                -1.369788e-01 1 1  ON 7
 uu_8                -1.288114e-01 1 1  ON 8
 uu_9                -9.714449e-02 1 1  ON 9
 ud_0                 4.453536e-01 1 1  ON 10
 ud_1                 1.798034e-01 1 1  ON 11
 ud_2                 5.939806e-02 1 1  ON 12
 ud_3                -1.117185e-02 1 1  ON 13
 ud_4                -6.726693e-02 1 1  ON 14
 ud_5                -1.076430e-01 1 1  ON 15
 ud_6                -1.342495e-01 1 1  ON 16
 ud_7                -1.491953e-01 1 1  ON 17
 ud_8                -1.498257e-01 1 1  ON 18
 ud_9                -1.387779e-01 1 1  ON 19
 eO_0                -7.548752e-01 1 1  ON 20
 eO_1                -4.344123e-01 1 1  ON 21
 eO_2                -1.793185e-02 1 1  ON 22
 eO_3                 2.971944e-01 1 1  ON 23
 eO_4                 5.174710e-01 1 1  ON 24
 eO_5                 4.743229e-01 1 1  ON 25
 eO_6                 2.445101e-01 1 1  ON 26
 eO_7                -5.057464e-02 1 1  ON 27
 eO_8                -2.083830e-01 1 1  ON 28
 eO_9                -6.880557e-02 1 1  ON 29
eH1_0                -2.402702e-01 1 1  ON 30
eH1_1                -1.389716e-01 1 1  ON 31
eH1_2                -9.183364e-02 1 1  ON 32
eH1_3                -3.777919e-02 1 1  ON 33
eH1_4                 1.065933e-02 1 1  ON 34
eH1_5                 4.367805e-02 1 1  ON 35
eH1_6                 9.985324e-02 1 1  ON 36
eH1_7                 1.481206e-01 1 1  ON 37
eH1_8                 1.628194e-01 1 1  ON 38
eH1_9                 4.774287e-02 1 1  ON 39
eH2_0                -2.366092e-01 1 1  ON 40
eH2_1                -1.356781e-01 1 1  ON 41
eH2_2                -8.828575e-02 1 1  ON 42
eH2_3                -3.442283e-02 1 1  ON 43
eH2_4                 1.342282e-02 1 1  ON 44
eH2_5                 4.709584e-02 1 1  ON 45
eH2_6                 1.036258e-01 1 1  ON 46
eH2_7                 1.501367e-01 1 1  ON 47
eH2_8                 1.668109e-01 1 1  ON 48
eH2_9                 3.135299e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.8997
    reference variance = 0.278514
====================================================
  Execution time = 2.0249e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3513e-01
  Total weights = 2.0000e+06
  Execution time = 1.8859e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335123436229
                                         uncertainty =       0.003862743629

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335123436229
                                         uncertainty =       0.003862743629

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409348108
  error estimate for blocks of size 2^( 2) =       0.000422074301
  error estimate for blocks of size 2^( 3) =       0.000434729778
  error estimate for blocks of size 2^( 4) =       0.000446063459
  error estimate for blocks of size 2^( 5) =       0.000455867662
  error estimate for blocks of size 2^( 6) =       0.000462922977
  error estimate for blocks of size 2^( 7) =       0.000467492860

      target function =                  N/A
              le_mean =     -16.906686548333
             les_mean =     286.171181622665
             stat err =       0.000458086739
             autocorr =       1.252304282588
              std dev =       0.578905645722
             le_variance =       0.335131746649

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335123368776
                                         uncertainty =       0.003862743225

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335123368776
                                         uncertainty =       0.003862743225

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409348067
  error estimate for blocks of size 2^( 2) =       0.000422074262
  error estimate for blocks of size 2^( 3) =       0.000434729741
  error estimate for blocks of size 2^( 4) =       0.000446063421
  error estimate for blocks of size 2^( 5) =       0.000455867625
  error estimate for blocks of size 2^( 6) =       0.000462922943
  error estimate for blocks of size 2^( 7) =       0.000467492826

      target function =                  N/A
              le_mean =     -16.906686547570
             les_mean =     286.171181529373
             stat err =       0.000458086704
             autocorr =       1.252304339894
              std dev =       0.578905587428
             le_variance =       0.335131679156

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335123402491
                                         uncertainty =       0.003862743427

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335123402491
                                         uncertainty =       0.003862743427

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409348087
  error estimate for blocks of size 2^( 2) =       0.000422074282
  error estimate for blocks of size 2^( 3) =       0.000434729759
  error estimate for blocks of size 2^( 4) =       0.000446063440
  error estimate for blocks of size 2^( 5) =       0.000455867643
  error estimate for blocks of size 2^( 6) =       0.000462922960
  error estimate for blocks of size 2^( 7) =       0.000467492843

      target function =                  N/A
              le_mean =     -16.906686547951
             les_mean =     286.171181576004
             stat err =       0.000458086722
             autocorr =       1.252304311249
              std dev =       0.578905616565
             le_variance =       0.335131712891

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335123432012
                                         uncertainty =       0.003862743604

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335123432012
                                         uncertainty =       0.003862743604

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409348105
  error estimate for blocks of size 2^( 2) =       0.000422074299
  error estimate for blocks of size 2^( 3) =       0.000434729776
  error estimate for blocks of size 2^( 4) =       0.000446063457
  error estimate for blocks of size 2^( 5) =       0.000455867659
  error estimate for blocks of size 2^( 6) =       0.000462922975
  error estimate for blocks of size 2^( 7) =       0.000467492857

      target function =                  N/A
              le_mean =     -16.906686548285
             les_mean =     286.171181616832
             stat err =       0.000458086737
             autocorr =       1.252304286171
              std dev =       0.578905642077
             le_variance =       0.335131742429


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906686548333        initial  <--
     1.4901e+03     1.4901e+04             1.5675e-07       -16.906686547570
     5.9605e+03     5.9605e+04             3.9187e-08       -16.906686547951
     2.3842e+04     2.3842e+05             9.7969e-09       -16.906686548285

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8249
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.089013e-01 1 1  ON 0
 uu_1                 1.423322e-01 1 1  ON 1
 uu_2                 4.100683e-02 1 1  ON 2
 uu_3                -2.087878e-02 1 1  ON 3
 uu_4                -6.551273e-02 1 1  ON 4
 uu_5                -9.898831e-02 1 1  ON 5
 uu_6                -1.249164e-01 1 1  ON 6
 uu_7                -1.369788e-01 1 1  ON 7
 uu_8                -1.288113e-01 1 1  ON 8
 uu_9                -9.714446e-02 1 1  ON 9
 ud_0                 4.453536e-01 1 1  ON 10
 ud_1                 1.798034e-01 1 1  ON 11
 ud_2                 5.939803e-02 1 1  ON 12
 ud_3                -1.117187e-02 1 1  ON 13
 ud_4                -6.726695e-02 1 1  ON 14
 ud_5                -1.076430e-01 1 1  ON 15
 ud_6                -1.342495e-01 1 1  ON 16
 ud_7                -1.491953e-01 1 1  ON 17
 ud_8                -1.498256e-01 1 1  ON 18
 ud_9                -1.387779e-01 1 1  ON 19
 eO_0                -7.548752e-01 1 1  ON 20
 eO_1                -4.344123e-01 1 1  ON 21
 eO_2                -1.793184e-02 1 1  ON 22
 eO_3                 2.971944e-01 1 1  ON 23
 eO_4                 5.174710e-01 1 1  ON 24
 eO_5                 4.743229e-01 1 1  ON 25
 eO_6                 2.445101e-01 1 1  ON 26
 eO_7                -5.057465e-02 1 1  ON 27
 eO_8                -2.083830e-01 1 1  ON 28
 eO_9                -6.880554e-02 1 1  ON 29
eH1_0                -2.402702e-01 1 1  ON 30
eH1_1                -1.389716e-01 1 1  ON 31
eH1_2                -9.183363e-02 1 1  ON 32
eH1_3                -3.777918e-02 1 1  ON 33
eH1_4                 1.065935e-02 1 1  ON 34
eH1_5                 4.367802e-02 1 1  ON 35
eH1_6                 9.985324e-02 1 1  ON 36
eH1_7                 1.481206e-01 1 1  ON 37
eH1_8                 1.628194e-01 1 1  ON 38
eH1_9                 4.774284e-02 1 1  ON 39
eH2_0                -2.366092e-01 1 1  ON 40
eH2_1                -1.356781e-01 1 1  ON 41
eH2_2                -8.828574e-02 1 1  ON 42
eH2_3                -3.442283e-02 1 1  ON 43
eH2_4                 1.342282e-02 1 1  ON 44
eH2_5                 4.709585e-02 1 1  ON 45
eH2_6                 1.036258e-01 1 1  ON 46
eH2_7                 1.501367e-01 1 1  ON 47
eH2_8                 1.668108e-01 1 1  ON 48
eH2_9                 3.135295e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6075e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.8851
    reference variance = 0.247704
====================================================
  Execution time = 2.0582e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3247e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5152e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332455390822
                                         uncertainty =       0.002920456266

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332455390822
                                         uncertainty =       0.002920456266

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407720927
  error estimate for blocks of size 2^( 2) =       0.000420541579
  error estimate for blocks of size 2^( 3) =       0.000433947585
  error estimate for blocks of size 2^( 4) =       0.000447543109
  error estimate for blocks of size 2^( 5) =       0.000459066820
  error estimate for blocks of size 2^( 6) =       0.000467827845
  error estimate for blocks of size 2^( 7) =       0.000474837316

      target function =                  N/A
              le_mean =     -16.905548007848
             les_mean =     286.130025988688
             stat err =       0.000462318772
             autocorr =       1.285751530169
              std dev =       0.576604465189
             le_variance =       0.332472709276


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690554800785e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+04, overlap shift 1.4901e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905548007848       residual = 5.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905548007876       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905548007901       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905548007895       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905548007989       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905548008003       residual = 4.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905548007977       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905548007989       residual = 4.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+04 is 2.054717e-08

solving harmonic davidson linear method for identity shift 5.9605e+04, overlap shift 5.9605e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905548007848       residual = 5.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905548007855       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905548007861       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905548007860       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905548007856       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905548007885       residual = 4.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905548007884       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905548007895       residual = 4.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+04 is 5.136929e-09

solving harmonic davidson linear method for identity shift 2.3842e+05, overlap shift 2.3842e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905548007848       residual = 5.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905548007850       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905548007851       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905548007851       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905548007839       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905548007819       residual = 4.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905548007889       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905548007655       residual = 4.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+05 is 1.284241e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.086228 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6105e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.089013e-01 1 1  ON 0
 uu_1                 1.423322e-01 1 1  ON 1
 uu_2                 4.100683e-02 1 1  ON 2
 uu_3                -2.087878e-02 1 1  ON 3
 uu_4                -6.551273e-02 1 1  ON 4
 uu_5                -9.898831e-02 1 1  ON 5
 uu_6                -1.249164e-01 1 1  ON 6
 uu_7                -1.369788e-01 1 1  ON 7
 uu_8                -1.288113e-01 1 1  ON 8
 uu_9                -9.714446e-02 1 1  ON 9
 ud_0                 4.453536e-01 1 1  ON 10
 ud_1                 1.798034e-01 1 1  ON 11
 ud_2                 5.939803e-02 1 1  ON 12
 ud_3                -1.117187e-02 1 1  ON 13
 ud_4                -6.726696e-02 1 1  ON 14
 ud_5                -1.076430e-01 1 1  ON 15
 ud_6                -1.342495e-01 1 1  ON 16
 ud_7                -1.491953e-01 1 1  ON 17
 ud_8                -1.498256e-01 1 1  ON 18
 ud_9                -1.387779e-01 1 1  ON 19
 eO_0                -7.548752e-01 1 1  ON 20
 eO_1                -4.344123e-01 1 1  ON 21
 eO_2                -1.793184e-02 1 1  ON 22
 eO_3                 2.971944e-01 1 1  ON 23
 eO_4                 5.174710e-01 1 1  ON 24
 eO_5                 4.743229e-01 1 1  ON 25
 eO_6                 2.445101e-01 1 1  ON 26
 eO_7                -5.057465e-02 1 1  ON 27
 eO_8                -2.083830e-01 1 1  ON 28
 eO_9                -6.880554e-02 1 1  ON 29
eH1_0                -2.402702e-01 1 1  ON 30
eH1_1                -1.389716e-01 1 1  ON 31
eH1_2                -9.183363e-02 1 1  ON 32
eH1_3                -3.777918e-02 1 1  ON 33
eH1_4                 1.065935e-02 1 1  ON 34
eH1_5                 4.367802e-02 1 1  ON 35
eH1_6                 9.985324e-02 1 1  ON 36
eH1_7                 1.481206e-01 1 1  ON 37
eH1_8                 1.628194e-01 1 1  ON 38
eH1_9                 4.774285e-02 1 1  ON 39
eH2_0                -2.366092e-01 1 1  ON 40
eH2_1                -1.356781e-01 1 1  ON 41
eH2_2                -8.828574e-02 1 1  ON 42
eH2_3                -3.442283e-02 1 1  ON 43
eH2_4                 1.342282e-02 1 1  ON 44
eH2_5                 4.709585e-02 1 1  ON 45
eH2_6                 1.036258e-01 1 1  ON 46
eH2_7                 1.501367e-01 1 1  ON 47
eH2_8                 1.668108e-01 1 1  ON 48
eH2_9                 3.135296e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.8616
    reference variance = 0.254835
====================================================
  Execution time = 2.2168e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4488e-01
  Total weights = 2.0000e+06
  Execution time = 1.8945e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344893501642
                                         uncertainty =       0.010416620512

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344893501642
                                         uncertainty =       0.010416620512

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415261931
  error estimate for blocks of size 2^( 2) =       0.000427617815
  error estimate for blocks of size 2^( 3) =       0.000440448416
  error estimate for blocks of size 2^( 4) =       0.000452761512
  error estimate for blocks of size 2^( 5) =       0.000463000068
  error estimate for blocks of size 2^( 6) =       0.000473722061
  error estimate for blocks of size 2^( 7) =       0.000477165091

      target function =                  N/A
              le_mean =     -16.906078838182
             les_mean =     286.160386453224
             stat err =       0.000466662183
             autocorr =       1.262876780054
              std dev =       0.587269054912
             le_variance =       0.344884942858

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344893521095
                                         uncertainty =       0.010416621529

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344893521095
                                         uncertainty =       0.010416621529

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415261943
  error estimate for blocks of size 2^( 2) =       0.000427617826
  error estimate for blocks of size 2^( 3) =       0.000440448427
  error estimate for blocks of size 2^( 4) =       0.000452761522
  error estimate for blocks of size 2^( 5) =       0.000463000078
  error estimate for blocks of size 2^( 6) =       0.000473722071
  error estimate for blocks of size 2^( 7) =       0.000477165101

      target function =                  N/A
              le_mean =     -16.906078838257
             les_mean =     286.160386475207
             stat err =       0.000466662193
             autocorr =       1.262876762212
              std dev =       0.587269071458
             le_variance =       0.344884962291

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344893511369
                                         uncertainty =       0.010416621020

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344893511369
                                         uncertainty =       0.010416621020

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415261937
  error estimate for blocks of size 2^( 2) =       0.000427617821
  error estimate for blocks of size 2^( 3) =       0.000440448421
  error estimate for blocks of size 2^( 4) =       0.000452761517
  error estimate for blocks of size 2^( 5) =       0.000463000073
  error estimate for blocks of size 2^( 6) =       0.000473722066
  error estimate for blocks of size 2^( 7) =       0.000477165096

      target function =                  N/A
              le_mean =     -16.906078838219
             les_mean =     286.160386464216
             stat err =       0.000466662188
             autocorr =       1.262876771130
              std dev =       0.587269063186
             le_variance =       0.344884952575

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344893502858
                                         uncertainty =       0.010416620576

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344893502858
                                         uncertainty =       0.010416620576

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415261932
  error estimate for blocks of size 2^( 2) =       0.000427617816
  error estimate for blocks of size 2^( 3) =       0.000440448417
  error estimate for blocks of size 2^( 4) =       0.000452761513
  error estimate for blocks of size 2^( 5) =       0.000463000069
  error estimate for blocks of size 2^( 6) =       0.000473722061
  error estimate for blocks of size 2^( 7) =       0.000477165092

      target function =                  N/A
              le_mean =     -16.906078838186
             les_mean =     286.160386454598
             stat err =       0.000466662184
             autocorr =       1.262876778938
              std dev =       0.587269055947
             le_variance =       0.344884944072


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906078838182        initial
     1.4901e+04     1.4901e+05             2.0547e-08       -16.906078838257  <--
     5.9605e+04     5.9605e+05             5.1369e-09       -16.906078838219
     2.3842e+05     2.3842e+06             1.2842e-09       -16.906078838186

*****************************************************************************
Applying the update for shift_i =   1.4901e+04     and shift_s =   1.4901e+05
*****************************************************************************

  Execution time = 3.1726e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.089013e-01 1 1  ON 0
 uu_1                 1.423322e-01 1 1  ON 1
 uu_2                 4.100684e-02 1 1  ON 2
 uu_3                -2.087879e-02 1 1  ON 3
 uu_4                -6.551273e-02 1 1  ON 4
 uu_5                -9.898832e-02 1 1  ON 5
 uu_6                -1.249164e-01 1 1  ON 6
 uu_7                -1.369788e-01 1 1  ON 7
 uu_8                -1.288113e-01 1 1  ON 8
 uu_9                -9.714446e-02 1 1  ON 9
 ud_0                 4.453536e-01 1 1  ON 10
 ud_1                 1.798033e-01 1 1  ON 11
 ud_2                 5.939803e-02 1 1  ON 12
 ud_3                -1.117187e-02 1 1  ON 13
 ud_4                -6.726696e-02 1 1  ON 14
 ud_5                -1.076430e-01 1 1  ON 15
 ud_6                -1.342495e-01 1 1  ON 16
 ud_7                -1.491953e-01 1 1  ON 17
 ud_8                -1.498256e-01 1 1  ON 18
 ud_9                -1.387779e-01 1 1  ON 19
 eO_0                -7.548752e-01 1 1  ON 20
 eO_1                -4.344123e-01 1 1  ON 21
 eO_2                -1.793184e-02 1 1  ON 22
 eO_3                 2.971944e-01 1 1  ON 23
 eO_4                 5.174710e-01 1 1  ON 24
 eO_5                 4.743229e-01 1 1  ON 25
 eO_6                 2.445101e-01 1 1  ON 26
 eO_7                -5.057465e-02 1 1  ON 27
 eO_8                -2.083830e-01 1 1  ON 28
 eO_9                -6.880555e-02 1 1  ON 29
eH1_0                -2.402702e-01 1 1  ON 30
eH1_1                -1.389716e-01 1 1  ON 31
eH1_2                -9.183364e-02 1 1  ON 32
eH1_3                -3.777918e-02 1 1  ON 33
eH1_4                 1.065935e-02 1 1  ON 34
eH1_5                 4.367801e-02 1 1  ON 35
eH1_6                 9.985323e-02 1 1  ON 36
eH1_7                 1.481206e-01 1 1  ON 37
eH1_8                 1.628194e-01 1 1  ON 38
eH1_9                 4.774286e-02 1 1  ON 39
eH2_0                -2.366092e-01 1 1  ON 40
eH2_1                -1.356781e-01 1 1  ON 41
eH2_2                -8.828574e-02 1 1  ON 42
eH2_3                -3.442283e-02 1 1  ON 43
eH2_4                 1.342282e-02 1 1  ON 44
eH2_5                 4.709584e-02 1 1  ON 45
eH2_6                 1.036258e-01 1 1  ON 46
eH2_7                 1.501367e-01 1 1  ON 47
eH2_8                 1.668108e-01 1 1  ON 48
eH2_9                 3.135297e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7837e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.8663
    reference variance = 0.407853
====================================================
  Execution time = 2.2564e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3846e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5118e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338513915489
                                         uncertainty =       0.003764532783

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338513915489
                                         uncertainty =       0.003764532783

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411378865
  error estimate for blocks of size 2^( 2) =       0.000424456629
  error estimate for blocks of size 2^( 3) =       0.000437749826
  error estimate for blocks of size 2^( 4) =       0.000450496427
  error estimate for blocks of size 2^( 5) =       0.000462211713
  error estimate for blocks of size 2^( 6) =       0.000470475465
  error estimate for blocks of size 2^( 7) =       0.000475093116

      target function =                  N/A
              le_mean =     -16.906290018846
             les_mean =     286.161107173571
             stat err =       0.000464569180
             autocorr =       1.275313152176
              std dev =       0.581777570451
             le_variance =       0.338465141480


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690629001885e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+03, overlap shift 3.7253e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906290018846       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906290018894       residual = 3.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906290018804       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906290018734       residual = 9.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906290018730       residual = 5.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906290018789       residual = 6.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906290018816       residual = 1.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906290018828       residual = 1.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+03 is 5.817241e-08

solving harmonic davidson linear method for identity shift 1.4901e+04, overlap shift 1.4901e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906290018846       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906290018858       residual = 3.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906290018835       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906290018822       residual = 9.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906290018816       residual = 5.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906290018839       residual = 6.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906290018855       residual = 1.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906290018841       residual = 1.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+04 is 1.454313e-08

solving harmonic davidson linear method for identity shift 5.9605e+04, overlap shift 5.9605e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906290018846       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906290018849       residual = 3.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906290018843       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906290018839       residual = 9.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906290018869       residual = 5.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906290018840       residual = 6.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906290018858       residual = 1.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906290018862       residual = 1.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+04 is 3.635785e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.088915 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8083e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.089013e-01 1 1  ON 0
 uu_1                 1.423322e-01 1 1  ON 1
 uu_2                 4.100684e-02 1 1  ON 2
 uu_3                -2.087878e-02 1 1  ON 3
 uu_4                -6.551273e-02 1 1  ON 4
 uu_5                -9.898832e-02 1 1  ON 5
 uu_6                -1.249164e-01 1 1  ON 6
 uu_7                -1.369789e-01 1 1  ON 7
 uu_8                -1.288114e-01 1 1  ON 8
 uu_9                -9.714447e-02 1 1  ON 9
 ud_0                 4.453536e-01 1 1  ON 10
 ud_1                 1.798033e-01 1 1  ON 11
 ud_2                 5.939804e-02 1 1  ON 12
 ud_3                -1.117187e-02 1 1  ON 13
 ud_4                -6.726696e-02 1 1  ON 14
 ud_5                -1.076430e-01 1 1  ON 15
 ud_6                -1.342495e-01 1 1  ON 16
 ud_7                -1.491953e-01 1 1  ON 17
 ud_8                -1.498256e-01 1 1  ON 18
 ud_9                -1.387779e-01 1 1  ON 19
 eO_0                -7.548752e-01 1 1  ON 20
 eO_1                -4.344123e-01 1 1  ON 21
 eO_2                -1.793185e-02 1 1  ON 22
 eO_3                 2.971944e-01 1 1  ON 23
 eO_4                 5.174710e-01 1 1  ON 24
 eO_5                 4.743229e-01 1 1  ON 25
 eO_6                 2.445101e-01 1 1  ON 26
 eO_7                -5.057465e-02 1 1  ON 27
 eO_8                -2.083830e-01 1 1  ON 28
 eO_9                -6.880555e-02 1 1  ON 29
eH1_0                -2.402702e-01 1 1  ON 30
eH1_1                -1.389716e-01 1 1  ON 31
eH1_2                -9.183364e-02 1 1  ON 32
eH1_3                -3.777918e-02 1 1  ON 33
eH1_4                 1.065934e-02 1 1  ON 34
eH1_5                 4.367801e-02 1 1  ON 35
eH1_6                 9.985323e-02 1 1  ON 36
eH1_7                 1.481206e-01 1 1  ON 37
eH1_8                 1.628194e-01 1 1  ON 38
eH1_9                 4.774287e-02 1 1  ON 39
eH2_0                -2.366092e-01 1 1  ON 40
eH2_1                -1.356781e-01 1 1  ON 41
eH2_2                -8.828575e-02 1 1  ON 42
eH2_3                -3.442284e-02 1 1  ON 43
eH2_4                 1.342282e-02 1 1  ON 44
eH2_5                 4.709584e-02 1 1  ON 45
eH2_6                 1.036258e-01 1 1  ON 46
eH2_7                 1.501367e-01 1 1  ON 47
eH2_8                 1.668109e-01 1 1  ON 48
eH2_9                 3.135298e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.8884
    reference variance = 0.640731
====================================================
  Execution time = 2.0200e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3338e-01
  Total weights = 2.0000e+06
  Execution time = 1.8899e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333384449297
                                         uncertainty =       0.002624839187

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333384449297
                                         uncertainty =       0.002624839187

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408274369
  error estimate for blocks of size 2^( 2) =       0.000421341015
  error estimate for blocks of size 2^( 3) =       0.000434633435
  error estimate for blocks of size 2^( 4) =       0.000447195265
  error estimate for blocks of size 2^( 5) =       0.000458140324
  error estimate for blocks of size 2^( 6) =       0.000466294667
  error estimate for blocks of size 2^( 7) =       0.000470991404

      target function =                  N/A
              le_mean =     -16.906321078685
             les_mean =     286.157068169347
             stat err =       0.000460655415
             autocorr =       1.273057820779
              std dev =       0.577387149546
             le_variance =       0.333375920461

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333384444227
                                         uncertainty =       0.002624839232

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333384444227
                                         uncertainty =       0.002624839232

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408274366
  error estimate for blocks of size 2^( 2) =       0.000421341013
  error estimate for blocks of size 2^( 3) =       0.000434633433
  error estimate for blocks of size 2^( 4) =       0.000447195264
  error estimate for blocks of size 2^( 5) =       0.000458140323
  error estimate for blocks of size 2^( 6) =       0.000466294666
  error estimate for blocks of size 2^( 7) =       0.000470991403

      target function =                  N/A
              le_mean =     -16.906321078884
             les_mean =     286.157068171022
             stat err =       0.000460655414
             autocorr =       1.273057834243
              std dev =       0.577387145152
             le_variance =       0.333375915387

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333384446762
                                         uncertainty =       0.002624839209

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333384446762
                                         uncertainty =       0.002624839209

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408274367
  error estimate for blocks of size 2^( 2) =       0.000421341014
  error estimate for blocks of size 2^( 3) =       0.000434633434
  error estimate for blocks of size 2^( 4) =       0.000447195264
  error estimate for blocks of size 2^( 5) =       0.000458140323
  error estimate for blocks of size 2^( 6) =       0.000466294667
  error estimate for blocks of size 2^( 7) =       0.000470991403

      target function =                  N/A
              le_mean =     -16.906321078784
             les_mean =     286.157068170185
             stat err =       0.000460655415
             autocorr =       1.273057827510
              std dev =       0.577387147349
             le_variance =       0.333375917924

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333384448980
                                         uncertainty =       0.002624839190

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333384448980
                                         uncertainty =       0.002624839190

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408274369
  error estimate for blocks of size 2^( 2) =       0.000421341015
  error estimate for blocks of size 2^( 3) =       0.000434633435
  error estimate for blocks of size 2^( 4) =       0.000447195265
  error estimate for blocks of size 2^( 5) =       0.000458140324
  error estimate for blocks of size 2^( 6) =       0.000466294667
  error estimate for blocks of size 2^( 7) =       0.000470991404

      target function =                  N/A
              le_mean =     -16.906321078697
             les_mean =     286.157068169452
             stat err =       0.000460655415
             autocorr =       1.273057821631
              std dev =       0.577387149272
             le_variance =       0.333375920144


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906321078685        initial
     3.7253e+03     3.7253e+04             5.8172e-08       -16.906321078884  <--
     1.4901e+04     1.4901e+05             1.4543e-08       -16.906321078784
     5.9605e+04     5.9605e+05             3.6358e-09       -16.906321078697

*****************************************************************************
Applying the update for shift_i =   3.7253e+03     and shift_s =   3.7253e+04
*****************************************************************************

  Execution time = 2.9740e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.089013e-01 1 1  ON 0
 uu_1                 1.423322e-01 1 1  ON 1
 uu_2                 4.100684e-02 1 1  ON 2
 uu_3                -2.087878e-02 1 1  ON 3
 uu_4                -6.551273e-02 1 1  ON 4
 uu_5                -9.898832e-02 1 1  ON 5
 uu_6                -1.249164e-01 1 1  ON 6
 uu_7                -1.369789e-01 1 1  ON 7
 uu_8                -1.288114e-01 1 1  ON 8
 uu_9                -9.714449e-02 1 1  ON 9
 ud_0                 4.453536e-01 1 1  ON 10
 ud_1                 1.798033e-01 1 1  ON 11
 ud_2                 5.939806e-02 1 1  ON 12
 ud_3                -1.117187e-02 1 1  ON 13
 ud_4                -6.726696e-02 1 1  ON 14
 ud_5                -1.076430e-01 1 1  ON 15
 ud_6                -1.342495e-01 1 1  ON 16
 ud_7                -1.491954e-01 1 1  ON 17
 ud_8                -1.498256e-01 1 1  ON 18
 ud_9                -1.387779e-01 1 1  ON 19
 eO_0                -7.548752e-01 1 1  ON 20
 eO_1                -4.344123e-01 1 1  ON 21
 eO_2                -1.793186e-02 1 1  ON 22
 eO_3                 2.971945e-01 1 1  ON 23
 eO_4                 5.174710e-01 1 1  ON 24
 eO_5                 4.743229e-01 1 1  ON 25
 eO_6                 2.445101e-01 1 1  ON 26
 eO_7                -5.057465e-02 1 1  ON 27
 eO_8                -2.083831e-01 1 1  ON 28
 eO_9                -6.880557e-02 1 1  ON 29
eH1_0                -2.402703e-01 1 1  ON 30
eH1_1                -1.389716e-01 1 1  ON 31
eH1_2                -9.183366e-02 1 1  ON 32
eH1_3                -3.777918e-02 1 1  ON 33
eH1_4                 1.065931e-02 1 1  ON 34
eH1_5                 4.367800e-02 1 1  ON 35
eH1_6                 9.985324e-02 1 1  ON 36
eH1_7                 1.481207e-01 1 1  ON 37
eH1_8                 1.628194e-01 1 1  ON 38
eH1_9                 4.774290e-02 1 1  ON 39
eH2_0                -2.366092e-01 1 1  ON 40
eH2_1                -1.356781e-01 1 1  ON 41
eH2_2                -8.828577e-02 1 1  ON 42
eH2_3                -3.442287e-02 1 1  ON 43
eH2_4                 1.342282e-02 1 1  ON 44
eH2_5                 4.709582e-02 1 1  ON 45
eH2_6                 1.036258e-01 1 1  ON 46
eH2_7                 1.501367e-01 1 1  ON 47
eH2_8                 1.668109e-01 1 1  ON 48
eH2_9                 3.135302e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7829e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.7974
    reference variance = 0.494491
====================================================
  Execution time = 2.0544e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3307e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5284e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333052490464
                                         uncertainty =       0.003297619763

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333052490464
                                         uncertainty =       0.003297619763

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408085075
  error estimate for blocks of size 2^( 2) =       0.000420942005
  error estimate for blocks of size 2^( 3) =       0.000433871521
  error estimate for blocks of size 2^( 4) =       0.000446346468
  error estimate for blocks of size 2^( 5) =       0.000456848246
  error estimate for blocks of size 2^( 6) =       0.000463593747
  error estimate for blocks of size 2^( 7) =       0.000471819158

      target function =                  N/A
              le_mean =     -16.905658708274
             les_mean =     286.134363051580
             stat err =       0.000459651904
             autocorr =       1.268693467451
              std dev =       0.577119448199
             le_variance =       0.333066857489


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690565870827e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+02, overlap shift 9.3132e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905658708274       residual = 4.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905658708397       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905658709209       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905658709427       residual = 6.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905658709960       residual = 3.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905658710132       residual = 7.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905658709934       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905658709840       residual = 2.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+02 is 2.498500e-07

solving harmonic davidson linear method for identity shift 3.7253e+03, overlap shift 3.7253e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905658708274       residual = 4.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905658708304       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905658708507       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905658708560       residual = 6.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905658708694       residual = 3.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905658708738       residual = 7.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905658708690       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905658708667       residual = 2.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+03 is 6.246284e-08

solving harmonic davidson linear method for identity shift 1.4901e+04, overlap shift 1.4901e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905658708274       residual = 4.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905658708281       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905658708332       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905658708346       residual = 6.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905658708371       residual = 3.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905658708380       residual = 7.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905658708375       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905658708384       residual = 2.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+04 is 1.561573e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.091597 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6079e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.089013e-01 1 1  ON 0
 uu_1                 1.423322e-01 1 1  ON 1
 uu_2                 4.100685e-02 1 1  ON 2
 uu_3                -2.087879e-02 1 1  ON 3
 uu_4                -6.551276e-02 1 1  ON 4
 uu_5                -9.898834e-02 1 1  ON 5
 uu_6                -1.249165e-01 1 1  ON 6
 uu_7                -1.369789e-01 1 1  ON 7
 uu_8                -1.288114e-01 1 1  ON 8
 uu_9                -9.714447e-02 1 1  ON 9
 ud_0                 4.453536e-01 1 1  ON 10
 ud_1                 1.798033e-01 1 1  ON 11
 ud_2                 5.939808e-02 1 1  ON 12
 ud_3                -1.117189e-02 1 1  ON 13
 ud_4                -6.726695e-02 1 1  ON 14
 ud_5                -1.076430e-01 1 1  ON 15
 ud_6                -1.342495e-01 1 1  ON 16
 ud_7                -1.491954e-01 1 1  ON 17
 ud_8                -1.498256e-01 1 1  ON 18
 ud_9                -1.387779e-01 1 1  ON 19
 eO_0                -7.548753e-01 1 1  ON 20
 eO_1                -4.344123e-01 1 1  ON 21
 eO_2                -1.793187e-02 1 1  ON 22
 eO_3                 2.971945e-01 1 1  ON 23
 eO_4                 5.174711e-01 1 1  ON 24
 eO_5                 4.743229e-01 1 1  ON 25
 eO_6                 2.445102e-01 1 1  ON 26
 eO_7                -5.057463e-02 1 1  ON 27
 eO_8                -2.083831e-01 1 1  ON 28
 eO_9                -6.880561e-02 1 1  ON 29
eH1_0                -2.402703e-01 1 1  ON 30
eH1_1                -1.389717e-01 1 1  ON 31
eH1_2                -9.183366e-02 1 1  ON 32
eH1_3                -3.777918e-02 1 1  ON 33
eH1_4                 1.065929e-02 1 1  ON 34
eH1_5                 4.367798e-02 1 1  ON 35
eH1_6                 9.985322e-02 1 1  ON 36
eH1_7                 1.481207e-01 1 1  ON 37
eH1_8                 1.628195e-01 1 1  ON 38
eH1_9                 4.774296e-02 1 1  ON 39
eH2_0                -2.366092e-01 1 1  ON 40
eH2_1                -1.356781e-01 1 1  ON 41
eH2_2                -8.828580e-02 1 1  ON 42
eH2_3                -3.442288e-02 1 1  ON 43
eH2_4                 1.342281e-02 1 1  ON 44
eH2_5                 4.709583e-02 1 1  ON 45
eH2_6                 1.036258e-01 1 1  ON 46
eH2_7                 1.501367e-01 1 1  ON 47
eH2_8                 1.668109e-01 1 1  ON 48
eH2_9                 3.135307e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.9699
    reference variance = 0.18629
====================================================
  Execution time = 2.0110e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5450e-01
  Total weights = 2.0000e+06
  Execution time = 1.8889e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354315422971
                                         uncertainty =       0.009875675777

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354315422971
                                         uncertainty =       0.009875675777

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421012229
  error estimate for blocks of size 2^( 2) =       0.000433307420
  error estimate for blocks of size 2^( 3) =       0.000445771977
  error estimate for blocks of size 2^( 4) =       0.000457491518
  error estimate for blocks of size 2^( 5) =       0.000467548339
  error estimate for blocks of size 2^( 6) =       0.000473803835
  error estimate for blocks of size 2^( 7) =       0.000478885277

      target function =                  N/A
              le_mean =     -16.905890192775
             les_mean =     286.163625626353
             stat err =       0.000469432242
             autocorr =       1.243244107792
              std dev =       0.595401203773
             le_variance =       0.354502593455

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354315574736
                                         uncertainty =       0.009875681844

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354315574736
                                         uncertainty =       0.009875681844

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421012319
  error estimate for blocks of size 2^( 2) =       0.000433307507
  error estimate for blocks of size 2^( 3) =       0.000445772059
  error estimate for blocks of size 2^( 4) =       0.000457491597
  error estimate for blocks of size 2^( 5) =       0.000467548419
  error estimate for blocks of size 2^( 6) =       0.000473803915
  error estimate for blocks of size 2^( 7) =       0.000478885357

      target function =                  N/A
              le_mean =     -16.905890191279
             les_mean =     286.163625727818
             stat err =       0.000469432322
             autocorr =       1.243243997350
              std dev =       0.595401331436
             le_variance =       0.354502745475

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354315498878
                                         uncertainty =       0.009875678811

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354315498878
                                         uncertainty =       0.009875678811

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421012274
  error estimate for blocks of size 2^( 2) =       0.000433307464
  error estimate for blocks of size 2^( 3) =       0.000445772018
  error estimate for blocks of size 2^( 4) =       0.000457491558
  error estimate for blocks of size 2^( 5) =       0.000467548379
  error estimate for blocks of size 2^( 6) =       0.000473803875
  error estimate for blocks of size 2^( 7) =       0.000478885317

      target function =                  N/A
              le_mean =     -16.905890192026
             les_mean =     286.163625677094
             stat err =       0.000469432282
             autocorr =       1.243244052561
              std dev =       0.595401267625
             le_variance =       0.354502669489

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354315432460
                                         uncertainty =       0.009875676156

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354315432460
                                         uncertainty =       0.009875676156

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421012234
  error estimate for blocks of size 2^( 2) =       0.000433307426
  error estimate for blocks of size 2^( 3) =       0.000445771982
  error estimate for blocks of size 2^( 4) =       0.000457491523
  error estimate for blocks of size 2^( 5) =       0.000467548344
  error estimate for blocks of size 2^( 6) =       0.000473803840
  error estimate for blocks of size 2^( 7) =       0.000478885282

      target function =                  N/A
              le_mean =     -16.905890192681
             les_mean =     286.163625632696
             stat err =       0.000469432247
             autocorr =       1.243244100892
              std dev =       0.595401211755
             le_variance =       0.354502602960


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905890192775        initial  <--
     9.3132e+02     9.3132e+03             2.4985e-07       -16.905890191279
     3.7253e+03     3.7253e+04             6.2463e-08       -16.905890192026
     1.4901e+04     1.4901e+05             1.5616e-08       -16.905890192681

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7417
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.089013e-01 1 1  ON 0
 uu_1                 1.423322e-01 1 1  ON 1
 uu_2                 4.100684e-02 1 1  ON 2
 uu_3                -2.087878e-02 1 1  ON 3
 uu_4                -6.551273e-02 1 1  ON 4
 uu_5                -9.898832e-02 1 1  ON 5
 uu_6                -1.249164e-01 1 1  ON 6
 uu_7                -1.369789e-01 1 1  ON 7
 uu_8                -1.288114e-01 1 1  ON 8
 uu_9                -9.714449e-02 1 1  ON 9
 ud_0                 4.453536e-01 1 1  ON 10
 ud_1                 1.798033e-01 1 1  ON 11
 ud_2                 5.939806e-02 1 1  ON 12
 ud_3                -1.117187e-02 1 1  ON 13
 ud_4                -6.726696e-02 1 1  ON 14
 ud_5                -1.076430e-01 1 1  ON 15
 ud_6                -1.342495e-01 1 1  ON 16
 ud_7                -1.491954e-01 1 1  ON 17
 ud_8                -1.498256e-01 1 1  ON 18
 ud_9                -1.387779e-01 1 1  ON 19
 eO_0                -7.548752e-01 1 1  ON 20
 eO_1                -4.344123e-01 1 1  ON 21
 eO_2                -1.793186e-02 1 1  ON 22
 eO_3                 2.971945e-01 1 1  ON 23
 eO_4                 5.174710e-01 1 1  ON 24
 eO_5                 4.743229e-01 1 1  ON 25
 eO_6                 2.445101e-01 1 1  ON 26
 eO_7                -5.057465e-02 1 1  ON 27
 eO_8                -2.083831e-01 1 1  ON 28
 eO_9                -6.880557e-02 1 1  ON 29
eH1_0                -2.402703e-01 1 1  ON 30
eH1_1                -1.389716e-01 1 1  ON 31
eH1_2                -9.183366e-02 1 1  ON 32
eH1_3                -3.777918e-02 1 1  ON 33
eH1_4                 1.065931e-02 1 1  ON 34
eH1_5                 4.367800e-02 1 1  ON 35
eH1_6                 9.985324e-02 1 1  ON 36
eH1_7                 1.481207e-01 1 1  ON 37
eH1_8                 1.628194e-01 1 1  ON 38
eH1_9                 4.774290e-02 1 1  ON 39
eH2_0                -2.366092e-01 1 1  ON 40
eH2_1                -1.356781e-01 1 1  ON 41
eH2_2                -8.828577e-02 1 1  ON 42
eH2_3                -3.442287e-02 1 1  ON 43
eH2_4                 1.342282e-02 1 1  ON 44
eH2_5                 4.709582e-02 1 1  ON 45
eH2_6                 1.036258e-01 1 1  ON 46
eH2_7                 1.501367e-01 1 1  ON 47
eH2_8                 1.668109e-01 1 1  ON 48
eH2_9                 3.135302e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5826e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.9597
    reference variance = 0.149127
====================================================
  Execution time = 2.0818e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3683e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4751e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336904683022
                                         uncertainty =       0.004750501006

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336904683022
                                         uncertainty =       0.004750501006

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410382376
  error estimate for blocks of size 2^( 2) =       0.000423148628
  error estimate for blocks of size 2^( 3) =       0.000436603079
  error estimate for blocks of size 2^( 4) =       0.000448093646
  error estimate for blocks of size 2^( 5) =       0.000458438118
  error estimate for blocks of size 2^( 6) =       0.000464918797
  error estimate for blocks of size 2^( 7) =       0.000469142186

      target function =                  N/A
              le_mean =     -16.905655628724
             les_mean =     286.138019458477
             stat err =       0.000460148187
             autocorr =       1.257239525390
              std dev =       0.580368322590
             le_variance =       0.336827389866


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690565562872e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+03, overlap shift 9.3132e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905655628725       residual = 4.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905655628749       residual = 3.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905655628684       residual = 4.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905655628739       residual = 8.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905655628742       residual = 3.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905655628771       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905655628781       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905655628782       residual = 2.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+03 is 2.782400e-08

solving harmonic davidson linear method for identity shift 3.7253e+04, overlap shift 3.7253e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905655628725       residual = 4.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905655628731       residual = 3.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905655628714       residual = 4.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905655628730       residual = 8.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905655628728       residual = 3.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905655628727       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905655628717       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905655628739       residual = 2.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+04 is 6.956023e-09

solving harmonic davidson linear method for identity shift 1.4901e+05, overlap shift 1.4901e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905655628725       residual = 4.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905655628726       residual = 3.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905655628722       residual = 4.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905655628699       residual = 8.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905655628725       residual = 3.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905655628715       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905655628777       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905655628333       residual = 2.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+05 is 1.739007e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.094228 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6299e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.089013e-01 1 1  ON 0
 uu_1                 1.423322e-01 1 1  ON 1
 uu_2                 4.100684e-02 1 1  ON 2
 uu_3                -2.087878e-02 1 1  ON 3
 uu_4                -6.551274e-02 1 1  ON 4
 uu_5                -9.898832e-02 1 1  ON 5
 uu_6                -1.249164e-01 1 1  ON 6
 uu_7                -1.369789e-01 1 1  ON 7
 uu_8                -1.288114e-01 1 1  ON 8
 uu_9                -9.714449e-02 1 1  ON 9
 ud_0                 4.453536e-01 1 1  ON 10
 ud_1                 1.798033e-01 1 1  ON 11
 ud_2                 5.939806e-02 1 1  ON 12
 ud_3                -1.117187e-02 1 1  ON 13
 ud_4                -6.726696e-02 1 1  ON 14
 ud_5                -1.076430e-01 1 1  ON 15
 ud_6                -1.342495e-01 1 1  ON 16
 ud_7                -1.491954e-01 1 1  ON 17
 ud_8                -1.498256e-01 1 1  ON 18
 ud_9                -1.387779e-01 1 1  ON 19
 eO_0                -7.548752e-01 1 1  ON 20
 eO_1                -4.344123e-01 1 1  ON 21
 eO_2                -1.793187e-02 1 1  ON 22
 eO_3                 2.971945e-01 1 1  ON 23
 eO_4                 5.174710e-01 1 1  ON 24
 eO_5                 4.743229e-01 1 1  ON 25
 eO_6                 2.445101e-01 1 1  ON 26
 eO_7                -5.057465e-02 1 1  ON 27
 eO_8                -2.083831e-01 1 1  ON 28
 eO_9                -6.880558e-02 1 1  ON 29
eH1_0                -2.402703e-01 1 1  ON 30
eH1_1                -1.389716e-01 1 1  ON 31
eH1_2                -9.183366e-02 1 1  ON 32
eH1_3                -3.777918e-02 1 1  ON 33
eH1_4                 1.065931e-02 1 1  ON 34
eH1_5                 4.367800e-02 1 1  ON 35
eH1_6                 9.985324e-02 1 1  ON 36
eH1_7                 1.481207e-01 1 1  ON 37
eH1_8                 1.628194e-01 1 1  ON 38
eH1_9                 4.774291e-02 1 1  ON 39
eH2_0                -2.366092e-01 1 1  ON 40
eH2_1                -1.356781e-01 1 1  ON 41
eH2_2                -8.828577e-02 1 1  ON 42
eH2_3                -3.442287e-02 1 1  ON 43
eH2_4                 1.342282e-02 1 1  ON 44
eH2_5                 4.709582e-02 1 1  ON 45
eH2_6                 1.036258e-01 1 1  ON 46
eH2_7                 1.501367e-01 1 1  ON 47
eH2_8                 1.668109e-01 1 1  ON 48
eH2_9                 3.135303e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.9543
    reference variance = 0.175248
====================================================
  Execution time = 2.0193e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.6284e-01
  Total weights = 2.0000e+06
  Execution time = 1.8858e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.362915669476
                                         uncertainty =       0.019994429018

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.362915669476
                                         uncertainty =       0.019994429018

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000425936446
  error estimate for blocks of size 2^( 2) =       0.000438576126
  error estimate for blocks of size 2^( 3) =       0.000451495819
  error estimate for blocks of size 2^( 4) =       0.000464841708
  error estimate for blocks of size 2^( 5) =       0.000476123688
  error estimate for blocks of size 2^( 6) =       0.000484932673
  error estimate for blocks of size 2^( 7) =       0.000491560643

      target function =                  N/A
              le_mean =     -16.905295949250
             les_mean =     286.151874662764
             stat err =       0.000479364678
             autocorr =       1.266608661045
              std dev =       0.602365098975
             le_variance =       0.362843712463

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.362915681578
                                         uncertainty =       0.019994429269

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.362915681578
                                         uncertainty =       0.019994429269

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000425936453
  error estimate for blocks of size 2^( 2) =       0.000438576132
  error estimate for blocks of size 2^( 3) =       0.000451495826
  error estimate for blocks of size 2^( 4) =       0.000464841714
  error estimate for blocks of size 2^( 5) =       0.000476123693
  error estimate for blocks of size 2^( 6) =       0.000484932679
  error estimate for blocks of size 2^( 7) =       0.000491560649

      target function =                  N/A
              le_mean =     -16.905295949422
             les_mean =     286.151874680696
             stat err =       0.000479364684
             autocorr =       1.266608649160
              std dev =       0.602365109021
             le_variance =       0.362843724566

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.362915675527
                                         uncertainty =       0.019994429144

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.362915675527
                                         uncertainty =       0.019994429144

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000425936450
  error estimate for blocks of size 2^( 2) =       0.000438576129
  error estimate for blocks of size 2^( 3) =       0.000451495822
  error estimate for blocks of size 2^( 4) =       0.000464841711
  error estimate for blocks of size 2^( 5) =       0.000476123691
  error estimate for blocks of size 2^( 6) =       0.000484932676
  error estimate for blocks of size 2^( 7) =       0.000491560646

      target function =                  N/A
              le_mean =     -16.905295949336
             les_mean =     286.151874671730
             stat err =       0.000479364681
             autocorr =       1.266608655105
              std dev =       0.602365103998
             le_variance =       0.362843718515

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.362915670232
                                         uncertainty =       0.019994429034

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.362915670232
                                         uncertainty =       0.019994429034

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000425936447
  error estimate for blocks of size 2^( 2) =       0.000438576126
  error estimate for blocks of size 2^( 3) =       0.000451495820
  error estimate for blocks of size 2^( 4) =       0.000464841708
  error estimate for blocks of size 2^( 5) =       0.000476123688
  error estimate for blocks of size 2^( 6) =       0.000484932673
  error estimate for blocks of size 2^( 7) =       0.000491560643

      target function =                  N/A
              le_mean =     -16.905295949261
             les_mean =     286.151874663885
             stat err =       0.000479364678
             autocorr =       1.266608660300
              std dev =       0.602365099603
             le_variance =       0.362843713220


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905295949250        initial
     9.3132e+03     9.3132e+04             2.7824e-08       -16.905295949422  <--
     3.7253e+04     3.7253e+05             6.9560e-09       -16.905295949336
     1.4901e+05     1.4901e+06             1.7390e-09       -16.905295949261

*****************************************************************************
Applying the update for shift_i =   9.3132e+03     and shift_s =   9.3132e+04
*****************************************************************************

  Execution time = 2.9699e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.089013e-01 1 1  ON 0
 uu_1                 1.423322e-01 1 1  ON 1
 uu_2                 4.100684e-02 1 1  ON 2
 uu_3                -2.087878e-02 1 1  ON 3
 uu_4                -6.551274e-02 1 1  ON 4
 uu_5                -9.898832e-02 1 1  ON 5
 uu_6                -1.249164e-01 1 1  ON 6
 uu_7                -1.369789e-01 1 1  ON 7
 uu_8                -1.288114e-01 1 1  ON 8
 uu_9                -9.714450e-02 1 1  ON 9
 ud_0                 4.453536e-01 1 1  ON 10
 ud_1                 1.798033e-01 1 1  ON 11
 ud_2                 5.939807e-02 1 1  ON 12
 ud_3                -1.117187e-02 1 1  ON 13
 ud_4                -6.726696e-02 1 1  ON 14
 ud_5                -1.076430e-01 1 1  ON 15
 ud_6                -1.342495e-01 1 1  ON 16
 ud_7                -1.491954e-01 1 1  ON 17
 ud_8                -1.498257e-01 1 1  ON 18
 ud_9                -1.387779e-01 1 1  ON 19
 eO_0                -7.548752e-01 1 1  ON 20
 eO_1                -4.344123e-01 1 1  ON 21
 eO_2                -1.793187e-02 1 1  ON 22
 eO_3                 2.971945e-01 1 1  ON 23
 eO_4                 5.174710e-01 1 1  ON 24
 eO_5                 4.743230e-01 1 1  ON 25
 eO_6                 2.445102e-01 1 1  ON 26
 eO_7                -5.057464e-02 1 1  ON 27
 eO_8                -2.083831e-01 1 1  ON 28
 eO_9                -6.880559e-02 1 1  ON 29
eH1_0                -2.402703e-01 1 1  ON 30
eH1_1                -1.389717e-01 1 1  ON 31
eH1_2                -9.183366e-02 1 1  ON 32
eH1_3                -3.777919e-02 1 1  ON 33
eH1_4                 1.065930e-02 1 1  ON 34
eH1_5                 4.367801e-02 1 1  ON 35
eH1_6                 9.985324e-02 1 1  ON 36
eH1_7                 1.481207e-01 1 1  ON 37
eH1_8                 1.628194e-01 1 1  ON 38
eH1_9                 4.774292e-02 1 1  ON 39
eH2_0                -2.366092e-01 1 1  ON 40
eH2_1                -1.356781e-01 1 1  ON 41
eH2_2                -8.828578e-02 1 1  ON 42
eH2_3                -3.442287e-02 1 1  ON 43
eH2_4                 1.342282e-02 1 1  ON 44
eH2_5                 4.709580e-02 1 1  ON 45
eH2_6                 1.036258e-01 1 1  ON 46
eH2_7                 1.501367e-01 1 1  ON 47
eH2_8                 1.668109e-01 1 1  ON 48
eH2_9                 3.135304e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6004e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.8537
    reference variance = 0.139949
====================================================
  Execution time = 2.0925e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3778e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5342e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337830457861
                                         uncertainty =       0.004105023706

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337830457861
                                         uncertainty =       0.004105023706

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410960889
  error estimate for blocks of size 2^( 2) =       0.000423695103
  error estimate for blocks of size 2^( 3) =       0.000437013040
  error estimate for blocks of size 2^( 4) =       0.000449594882
  error estimate for blocks of size 2^( 5) =       0.000460846418
  error estimate for blocks of size 2^( 6) =       0.000467528610
  error estimate for blocks of size 2^( 7) =       0.000471937540

      target function =                  N/A
              le_mean =     -16.906373626246
             les_mean =     286.163246726660
             stat err =       0.000462476862
             autocorr =       1.266423715674
              std dev =       0.581186463461
             le_variance =       0.337777705310


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690637362625e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+03, overlap shift 2.3283e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906373626246       residual = 3.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906373626591       residual = 5.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906373626801       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906373626986       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906373626878       residual = 5.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906373626886       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906373626914       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906373626947       residual = 5.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+03 is 9.785212e-08

solving harmonic davidson linear method for identity shift 9.3132e+03, overlap shift 9.3132e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906373626246       residual = 3.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906373626332       residual = 5.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906373626385       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906373626431       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906373626399       residual = 5.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906373626417       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906373626412       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906373626424       residual = 5.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+03 is 2.446301e-08

solving harmonic davidson linear method for identity shift 3.7253e+04, overlap shift 3.7253e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906373626246       residual = 3.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906373626268       residual = 5.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906373626281       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906373626293       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906373626284       residual = 5.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906373626244       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906373626312       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906373626301       residual = 5.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+04 is 6.115751e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.096913 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6466e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.089013e-01 1 1  ON 0
 uu_1                 1.423322e-01 1 1  ON 1
 uu_2                 4.100685e-02 1 1  ON 2
 uu_3                -2.087877e-02 1 1  ON 3
 uu_4                -6.551273e-02 1 1  ON 4
 uu_5                -9.898832e-02 1 1  ON 5
 uu_6                -1.249164e-01 1 1  ON 6
 uu_7                -1.369789e-01 1 1  ON 7
 uu_8                -1.288114e-01 1 1  ON 8
 uu_9                -9.714451e-02 1 1  ON 9
 ud_0                 4.453536e-01 1 1  ON 10
 ud_1                 1.798033e-01 1 1  ON 11
 ud_2                 5.939809e-02 1 1  ON 12
 ud_3                -1.117187e-02 1 1  ON 13
 ud_4                -6.726696e-02 1 1  ON 14
 ud_5                -1.076430e-01 1 1  ON 15
 ud_6                -1.342495e-01 1 1  ON 16
 ud_7                -1.491954e-01 1 1  ON 17
 ud_8                -1.498257e-01 1 1  ON 18
 ud_9                -1.387779e-01 1 1  ON 19
 eO_0                -7.548752e-01 1 1  ON 20
 eO_1                -4.344123e-01 1 1  ON 21
 eO_2                -1.793187e-02 1 1  ON 22
 eO_3                 2.971945e-01 1 1  ON 23
 eO_4                 5.174710e-01 1 1  ON 24
 eO_5                 4.743230e-01 1 1  ON 25
 eO_6                 2.445102e-01 1 1  ON 26
 eO_7                -5.057464e-02 1 1  ON 27
 eO_8                -2.083831e-01 1 1  ON 28
 eO_9                -6.880561e-02 1 1  ON 29
eH1_0                -2.402703e-01 1 1  ON 30
eH1_1                -1.389717e-01 1 1  ON 31
eH1_2                -9.183366e-02 1 1  ON 32
eH1_3                -3.777921e-02 1 1  ON 33
eH1_4                 1.065930e-02 1 1  ON 34
eH1_5                 4.367802e-02 1 1  ON 35
eH1_6                 9.985324e-02 1 1  ON 36
eH1_7                 1.481207e-01 1 1  ON 37
eH1_8                 1.628195e-01 1 1  ON 38
eH1_9                 4.774293e-02 1 1  ON 39
eH2_0                -2.366092e-01 1 1  ON 40
eH2_1                -1.356781e-01 1 1  ON 41
eH2_2                -8.828580e-02 1 1  ON 42
eH2_3                -3.442289e-02 1 1  ON 43
eH2_4                 1.342282e-02 1 1  ON 44
eH2_5                 4.709582e-02 1 1  ON 45
eH2_6                 1.036258e-01 1 1  ON 46
eH2_7                 1.501367e-01 1 1  ON 47
eH2_8                 1.668109e-01 1 1  ON 48
eH2_9                 3.135307e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.899
    reference variance = 0.421123
====================================================
  Execution time = 2.0317e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3764e-01
  Total weights = 2.0000e+06
  Execution time = 1.8981e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337739176119
                                         uncertainty =       0.003874684555

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337739176119
                                         uncertainty =       0.003874684555

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410875962
  error estimate for blocks of size 2^( 2) =       0.000423345496
  error estimate for blocks of size 2^( 3) =       0.000435577589
  error estimate for blocks of size 2^( 4) =       0.000447642594
  error estimate for blocks of size 2^( 5) =       0.000456708549
  error estimate for blocks of size 2^( 6) =       0.000463573464
  error estimate for blocks of size 2^( 7) =       0.000468117022

      target function =                  N/A
              le_mean =     -16.906344084519
             les_mean =     286.162108247608
             stat err =       0.000459010407
             autocorr =       1.248025896725
              std dev =       0.581066357907
             le_variance =       0.337638112291

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337739176174
                                         uncertainty =       0.003874684611

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337739176174
                                         uncertainty =       0.003874684611

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410875962
  error estimate for blocks of size 2^( 2) =       0.000423345495
  error estimate for blocks of size 2^( 3) =       0.000435577588
  error estimate for blocks of size 2^( 4) =       0.000447642593
  error estimate for blocks of size 2^( 5) =       0.000456708547
  error estimate for blocks of size 2^( 6) =       0.000463573463
  error estimate for blocks of size 2^( 7) =       0.000468117023

      target function =                  N/A
              le_mean =     -16.906344085239
             les_mean =     286.162108272025
             stat err =       0.000459010406
             autocorr =       1.248025891569
              std dev =       0.581066357966
             le_variance =       0.337638112360

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337739176146
                                         uncertainty =       0.003874684583

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337739176146
                                         uncertainty =       0.003874684583

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410875962
  error estimate for blocks of size 2^( 2) =       0.000423345495
  error estimate for blocks of size 2^( 3) =       0.000435577588
  error estimate for blocks of size 2^( 4) =       0.000447642593
  error estimate for blocks of size 2^( 5) =       0.000456708548
  error estimate for blocks of size 2^( 6) =       0.000463573463
  error estimate for blocks of size 2^( 7) =       0.000468117022

      target function =                  N/A
              le_mean =     -16.906344084879
             les_mean =     286.162108259817
             stat err =       0.000459010407
             autocorr =       1.248025894159
              std dev =       0.581066357936
             le_variance =       0.337638112325

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337739176122
                                         uncertainty =       0.003874684558

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337739176122
                                         uncertainty =       0.003874684558

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410875962
  error estimate for blocks of size 2^( 2) =       0.000423345496
  error estimate for blocks of size 2^( 3) =       0.000435577589
  error estimate for blocks of size 2^( 4) =       0.000447642594
  error estimate for blocks of size 2^( 5) =       0.000456708549
  error estimate for blocks of size 2^( 6) =       0.000463573464
  error estimate for blocks of size 2^( 7) =       0.000468117022

      target function =                  N/A
              le_mean =     -16.906344084564
             les_mean =     286.162108249134
             stat err =       0.000459010407
             autocorr =       1.248025896401
              std dev =       0.581066357910
             le_variance =       0.337638112295


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906344084519        initial
     2.3283e+03     2.3283e+04             9.7852e-08       -16.906344085239  <--
     9.3132e+03     9.3132e+04             2.4463e-08       -16.906344084879
     3.7253e+04     3.7253e+05             6.1158e-09       -16.906344084564

*****************************************************************************
Applying the update for shift_i =   2.3283e+03     and shift_s =   2.3283e+04
*****************************************************************************

  Execution time = 2.9942e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.089013e-01 1 1  ON 0
 uu_1                 1.423322e-01 1 1  ON 1
 uu_2                 4.100685e-02 1 1  ON 2
 uu_3                -2.087876e-02 1 1  ON 3
 uu_4                -6.551270e-02 1 1  ON 4
 uu_5                -9.898831e-02 1 1  ON 5
 uu_6                -1.249164e-01 1 1  ON 6
 uu_7                -1.369789e-01 1 1  ON 7
 uu_8                -1.288115e-01 1 1  ON 8
 uu_9                -9.714454e-02 1 1  ON 9
 ud_0                 4.453537e-01 1 1  ON 10
 ud_1                 1.798033e-01 1 1  ON 11
 ud_2                 5.939815e-02 1 1  ON 12
 ud_3                -1.117185e-02 1 1  ON 13
 ud_4                -6.726697e-02 1 1  ON 14
 ud_5                -1.076430e-01 1 1  ON 15
 ud_6                -1.342495e-01 1 1  ON 16
 ud_7                -1.491954e-01 1 1  ON 17
 ud_8                -1.498257e-01 1 1  ON 18
 ud_9                -1.387780e-01 1 1  ON 19
 eO_0                -7.548753e-01 1 1  ON 20
 eO_1                -4.344123e-01 1 1  ON 21
 eO_2                -1.793188e-02 1 1  ON 22
 eO_3                 2.971945e-01 1 1  ON 23
 eO_4                 5.174711e-01 1 1  ON 24
 eO_5                 4.743230e-01 1 1  ON 25
 eO_6                 2.445103e-01 1 1  ON 26
 eO_7                -5.057463e-02 1 1  ON 27
 eO_8                -2.083832e-01 1 1  ON 28
 eO_9                -6.880566e-02 1 1  ON 29
eH1_0                -2.402703e-01 1 1  ON 30
eH1_1                -1.389717e-01 1 1  ON 31
eH1_2                -9.183369e-02 1 1  ON 32
eH1_3                -3.777927e-02 1 1  ON 33
eH1_4                 1.065929e-02 1 1  ON 34
eH1_5                 4.367803e-02 1 1  ON 35
eH1_6                 9.985326e-02 1 1  ON 36
eH1_7                 1.481207e-01 1 1  ON 37
eH1_8                 1.628195e-01 1 1  ON 38
eH1_9                 4.774297e-02 1 1  ON 39
eH2_0                -2.366093e-01 1 1  ON 40
eH2_1                -1.356781e-01 1 1  ON 41
eH2_2                -8.828587e-02 1 1  ON 42
eH2_3                -3.442294e-02 1 1  ON 43
eH2_4                 1.342283e-02 1 1  ON 44
eH2_5                 4.709585e-02 1 1  ON 45
eH2_6                 1.036258e-01 1 1  ON 46
eH2_7                 1.501367e-01 1 1  ON 47
eH2_8                 1.668110e-01 1 1  ON 48
eH2_9                 3.135314e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6413e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.9426
    reference variance = 0.280197
====================================================
  Execution time = 2.0511e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3311e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6016e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332996687258
                                         uncertainty =       0.002998387097

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332996687258
                                         uncertainty =       0.002998387097

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408110779
  error estimate for blocks of size 2^( 2) =       0.000421161981
  error estimate for blocks of size 2^( 3) =       0.000434585832
  error estimate for blocks of size 2^( 4) =       0.000447154562
  error estimate for blocks of size 2^( 5) =       0.000458448335
  error estimate for blocks of size 2^( 6) =       0.000466667462
  error estimate for blocks of size 2^( 7) =       0.000473335898

      target function =                  N/A
              le_mean =     -16.906190043259
             les_mean =     286.152370427354
             stat err =       0.000461401564
             autocorr =       1.278209365968
              std dev =       0.577155797951
             le_variance =       0.333108815108


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690619004326e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+02, overlap shift 5.8208e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906190043259       residual = 4.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906190043285       residual = 4.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906190042897       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906190042940       residual = 8.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906190042941       residual = 3.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906190042303       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906190043116       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906190043063       residual = 3.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+02 is 5.093594e-07

solving harmonic davidson linear method for identity shift 2.3283e+03, overlap shift 2.3283e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906190043259       residual = 4.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906190043266       residual = 4.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906190043169       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906190043180       residual = 8.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906190043180       residual = 3.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906190043021       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906190043223       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906190043210       residual = 3.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+03 is 1.273516e-07

solving harmonic davidson linear method for identity shift 9.3132e+03, overlap shift 9.3132e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906190043259       residual = 4.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906190043261       residual = 4.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906190043237       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906190043237       residual = 8.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906190043239       residual = 3.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906190043197       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906190043241       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906190043253       residual = 3.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+03 is 3.183863e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.099550 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6119e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.089013e-01 1 1  ON 0
 uu_1                 1.423322e-01 1 1  ON 1
 uu_2                 4.100687e-02 1 1  ON 2
 uu_3                -2.087875e-02 1 1  ON 3
 uu_4                -6.551267e-02 1 1  ON 4
 uu_5                -9.898831e-02 1 1  ON 5
 uu_6                -1.249165e-01 1 1  ON 6
 uu_7                -1.369790e-01 1 1  ON 7
 uu_8                -1.288115e-01 1 1  ON 8
 uu_9                -9.714455e-02 1 1  ON 9
 ud_0                 4.453538e-01 1 1  ON 10
 ud_1                 1.798034e-01 1 1  ON 11
 ud_2                 5.939813e-02 1 1  ON 12
 ud_3                -1.117183e-02 1 1  ON 13
 ud_4                -6.726699e-02 1 1  ON 14
 ud_5                -1.076431e-01 1 1  ON 15
 ud_6                -1.342494e-01 1 1  ON 16
 ud_7                -1.491954e-01 1 1  ON 17
 ud_8                -1.498258e-01 1 1  ON 18
 ud_9                -1.387780e-01 1 1  ON 19
 eO_0                -7.548754e-01 1 1  ON 20
 eO_1                -4.344123e-01 1 1  ON 21
 eO_2                -1.793191e-02 1 1  ON 22
 eO_3                 2.971945e-01 1 1  ON 23
 eO_4                 5.174712e-01 1 1  ON 24
 eO_5                 4.743231e-01 1 1  ON 25
 eO_6                 2.445103e-01 1 1  ON 26
 eO_7                -5.057461e-02 1 1  ON 27
 eO_8                -2.083832e-01 1 1  ON 28
 eO_9                -6.880571e-02 1 1  ON 29
eH1_0                -2.402704e-01 1 1  ON 30
eH1_1                -1.389717e-01 1 1  ON 31
eH1_2                -9.183366e-02 1 1  ON 32
eH1_3                -3.777928e-02 1 1  ON 33
eH1_4                 1.065919e-02 1 1  ON 34
eH1_5                 4.367805e-02 1 1  ON 35
eH1_6                 9.985327e-02 1 1  ON 36
eH1_7                 1.481207e-01 1 1  ON 37
eH1_8                 1.628195e-01 1 1  ON 38
eH1_9                 4.774305e-02 1 1  ON 39
eH2_0                -2.366094e-01 1 1  ON 40
eH2_1                -1.356781e-01 1 1  ON 41
eH2_2                -8.828586e-02 1 1  ON 42
eH2_3                -3.442298e-02 1 1  ON 43
eH2_4                 1.342281e-02 1 1  ON 44
eH2_5                 4.709584e-02 1 1  ON 45
eH2_6                 1.036258e-01 1 1  ON 46
eH2_7                 1.501368e-01 1 1  ON 47
eH2_8                 1.668110e-01 1 1  ON 48
eH2_9                 3.135322e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.8925
    reference variance = 0.301305
====================================================
  Execution time = 2.1434e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4710e-01
  Total weights = 2.0000e+06
  Execution time = 2.1683e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347077279955
                                         uncertainty =       0.010073360352

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347077279955
                                         uncertainty =       0.010073360352

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416594587
  error estimate for blocks of size 2^( 2) =       0.000429325894
  error estimate for blocks of size 2^( 3) =       0.000442582866
  error estimate for blocks of size 2^( 4) =       0.000454694844
  error estimate for blocks of size 2^( 5) =       0.000465395720
  error estimate for blocks of size 2^( 6) =       0.000475498579
  error estimate for blocks of size 2^( 7) =       0.000481931574

      target function =                  N/A
              le_mean =     -16.906119903405
             les_mean =     286.163992114294
             stat err =       0.000469380179
             autocorr =       1.269469432744
              std dev =       0.589153714688
             le_variance =       0.347102099530

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347077526583
                                         uncertainty =       0.010073365442

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347077526583
                                         uncertainty =       0.010073365442

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416594735
  error estimate for blocks of size 2^( 2) =       0.000429326036
  error estimate for blocks of size 2^( 3) =       0.000442583003
  error estimate for blocks of size 2^( 4) =       0.000454694978
  error estimate for blocks of size 2^( 5) =       0.000465395841
  error estimate for blocks of size 2^( 6) =       0.000475498700
  error estimate for blocks of size 2^( 7) =       0.000481931694

      target function =                  N/A
              le_mean =     -16.906119901668
             les_mean =     286.163992302060
             stat err =       0.000469380303
             autocorr =       1.269469199720
              std dev =       0.589153923904
             le_variance =       0.347102346051

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347077403328
                                         uncertainty =       0.010073362896

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347077403328
                                         uncertainty =       0.010073362896

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416594661
  error estimate for blocks of size 2^( 2) =       0.000429325965
  error estimate for blocks of size 2^( 3) =       0.000442582935
  error estimate for blocks of size 2^( 4) =       0.000454694911
  error estimate for blocks of size 2^( 5) =       0.000465395780
  error estimate for blocks of size 2^( 6) =       0.000475498640
  error estimate for blocks of size 2^( 7) =       0.000481931634

      target function =                  N/A
              le_mean =     -16.906119902536
             les_mean =     286.163992208219
             stat err =       0.000469380241
             autocorr =       1.269469316172
              std dev =       0.589153819345
             le_variance =       0.347102222849

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347077295379
                                         uncertainty =       0.010073360670

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347077295379
                                         uncertainty =       0.010073360670

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416594596
  error estimate for blocks of size 2^( 2) =       0.000429325903
  error estimate for blocks of size 2^( 3) =       0.000442582875
  error estimate for blocks of size 2^( 4) =       0.000454694853
  error estimate for blocks of size 2^( 5) =       0.000465395727
  error estimate for blocks of size 2^( 6) =       0.000475498587
  error estimate for blocks of size 2^( 7) =       0.000481931581

      target function =                  N/A
              le_mean =     -16.906119903297
             les_mean =     286.163992126035
             stat err =       0.000469380187
             autocorr =       1.269469418162
              std dev =       0.589153727771
             le_variance =       0.347102114947


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906119903405        initial  <--
     5.8208e+02     5.8208e+03             5.0936e-07       -16.906119901668
     2.3283e+03     2.3283e+04             1.2735e-07       -16.906119902536
     9.3132e+03     9.3132e+04             3.1839e-08       -16.906119903297

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.2612
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.089013e-01 1 1  ON 0
 uu_1                 1.423322e-01 1 1  ON 1
 uu_2                 4.100685e-02 1 1  ON 2
 uu_3                -2.087876e-02 1 1  ON 3
 uu_4                -6.551270e-02 1 1  ON 4
 uu_5                -9.898831e-02 1 1  ON 5
 uu_6                -1.249164e-01 1 1  ON 6
 uu_7                -1.369789e-01 1 1  ON 7
 uu_8                -1.288115e-01 1 1  ON 8
 uu_9                -9.714454e-02 1 1  ON 9
 ud_0                 4.453537e-01 1 1  ON 10
 ud_1                 1.798033e-01 1 1  ON 11
 ud_2                 5.939815e-02 1 1  ON 12
 ud_3                -1.117185e-02 1 1  ON 13
 ud_4                -6.726697e-02 1 1  ON 14
 ud_5                -1.076430e-01 1 1  ON 15
 ud_6                -1.342495e-01 1 1  ON 16
 ud_7                -1.491954e-01 1 1  ON 17
 ud_8                -1.498257e-01 1 1  ON 18
 ud_9                -1.387780e-01 1 1  ON 19
 eO_0                -7.548753e-01 1 1  ON 20
 eO_1                -4.344123e-01 1 1  ON 21
 eO_2                -1.793188e-02 1 1  ON 22
 eO_3                 2.971945e-01 1 1  ON 23
 eO_4                 5.174711e-01 1 1  ON 24
 eO_5                 4.743230e-01 1 1  ON 25
 eO_6                 2.445103e-01 1 1  ON 26
 eO_7                -5.057463e-02 1 1  ON 27
 eO_8                -2.083832e-01 1 1  ON 28
 eO_9                -6.880566e-02 1 1  ON 29
eH1_0                -2.402703e-01 1 1  ON 30
eH1_1                -1.389717e-01 1 1  ON 31
eH1_2                -9.183369e-02 1 1  ON 32
eH1_3                -3.777927e-02 1 1  ON 33
eH1_4                 1.065929e-02 1 1  ON 34
eH1_5                 4.367803e-02 1 1  ON 35
eH1_6                 9.985326e-02 1 1  ON 36
eH1_7                 1.481207e-01 1 1  ON 37
eH1_8                 1.628195e-01 1 1  ON 38
eH1_9                 4.774297e-02 1 1  ON 39
eH2_0                -2.366093e-01 1 1  ON 40
eH2_1                -1.356781e-01 1 1  ON 41
eH2_2                -8.828587e-02 1 1  ON 42
eH2_3                -3.442294e-02 1 1  ON 43
eH2_4                 1.342283e-02 1 1  ON 44
eH2_5                 4.709585e-02 1 1  ON 45
eH2_6                 1.036258e-01 1 1  ON 46
eH2_7                 1.501367e-01 1 1  ON 47
eH2_8                 1.668110e-01 1 1  ON 48
eH2_9                 3.135314e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7386e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.8191
    reference variance = 1.81757
====================================================
  Execution time = 2.2609e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3858e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5858e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338601259389
                                         uncertainty =       0.005775110981

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338601259389
                                         uncertainty =       0.005775110981

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411451765
  error estimate for blocks of size 2^( 2) =       0.000424083980
  error estimate for blocks of size 2^( 3) =       0.000436688244
  error estimate for blocks of size 2^( 4) =       0.000449470715
  error estimate for blocks of size 2^( 5) =       0.000460563348
  error estimate for blocks of size 2^( 6) =       0.000468545752
  error estimate for blocks of size 2^( 7) =       0.000474486302

      target function =                  N/A
              le_mean =     -16.905858003430
             les_mean =     286.146619773324
             stat err =       0.000463266529
             autocorr =       1.267721884721
              std dev =       0.581880666860
             le_variance =       0.338585110465


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690585800343e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+03, overlap shift 5.8208e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905858003430       residual = 7.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905858003369       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905858003170       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905858003113       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905858003208       residual = 3.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905858003326       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905858003288       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905858003288       residual = 6.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+03 is 4.658948e-08

solving harmonic davidson linear method for identity shift 2.3283e+04, overlap shift 2.3283e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905858003430       residual = 7.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905858003415       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905858003365       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905858003347       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905858003373       residual = 3.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905858003410       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905858003401       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905858003371       residual = 6.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+04 is 1.164752e-08

solving harmonic davidson linear method for identity shift 9.3132e+04, overlap shift 9.3132e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905858003430       residual = 7.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905858003427       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905858003414       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905858003454       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905858003439       residual = 3.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905858003409       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905858003429       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905858003439       residual = 6.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+04 is 2.911889e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.102207 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8204e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.089013e-01 1 1  ON 0
 uu_1                 1.423322e-01 1 1  ON 1
 uu_2                 4.100685e-02 1 1  ON 2
 uu_3                -2.087876e-02 1 1  ON 3
 uu_4                -6.551270e-02 1 1  ON 4
 uu_5                -9.898831e-02 1 1  ON 5
 uu_6                -1.249164e-01 1 1  ON 6
 uu_7                -1.369789e-01 1 1  ON 7
 uu_8                -1.288115e-01 1 1  ON 8
 uu_9                -9.714455e-02 1 1  ON 9
 ud_0                 4.453537e-01 1 1  ON 10
 ud_1                 1.798033e-01 1 1  ON 11
 ud_2                 5.939816e-02 1 1  ON 12
 ud_3                -1.117185e-02 1 1  ON 13
 ud_4                -6.726697e-02 1 1  ON 14
 ud_5                -1.076430e-01 1 1  ON 15
 ud_6                -1.342495e-01 1 1  ON 16
 ud_7                -1.491954e-01 1 1  ON 17
 ud_8                -1.498257e-01 1 1  ON 18
 ud_9                -1.387780e-01 1 1  ON 19
 eO_0                -7.548753e-01 1 1  ON 20
 eO_1                -4.344123e-01 1 1  ON 21
 eO_2                -1.793188e-02 1 1  ON 22
 eO_3                 2.971945e-01 1 1  ON 23
 eO_4                 5.174711e-01 1 1  ON 24
 eO_5                 4.743230e-01 1 1  ON 25
 eO_6                 2.445103e-01 1 1  ON 26
 eO_7                -5.057463e-02 1 1  ON 27
 eO_8                -2.083832e-01 1 1  ON 28
 eO_9                -6.880566e-02 1 1  ON 29
eH1_0                -2.402703e-01 1 1  ON 30
eH1_1                -1.389717e-01 1 1  ON 31
eH1_2                -9.183369e-02 1 1  ON 32
eH1_3                -3.777927e-02 1 1  ON 33
eH1_4                 1.065928e-02 1 1  ON 34
eH1_5                 4.367803e-02 1 1  ON 35
eH1_6                 9.985327e-02 1 1  ON 36
eH1_7                 1.481207e-01 1 1  ON 37
eH1_8                 1.628195e-01 1 1  ON 38
eH1_9                 4.774297e-02 1 1  ON 39
eH2_0                -2.366093e-01 1 1  ON 40
eH2_1                -1.356781e-01 1 1  ON 41
eH2_2                -8.828587e-02 1 1  ON 42
eH2_3                -3.442294e-02 1 1  ON 43
eH2_4                 1.342283e-02 1 1  ON 44
eH2_5                 4.709584e-02 1 1  ON 45
eH2_6                 1.036258e-01 1 1  ON 46
eH2_7                 1.501367e-01 1 1  ON 47
eH2_8                 1.668110e-01 1 1  ON 48
eH2_9                 3.135315e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.9536
    reference variance = 0.219002
====================================================
  Execution time = 2.0274e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3622e-01
  Total weights = 2.0000e+06
  Execution time = 1.8791e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336244416671
                                         uncertainty =       0.002843022468

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336244416671
                                         uncertainty =       0.002843022468

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410010364
  error estimate for blocks of size 2^( 2) =       0.000422487793
  error estimate for blocks of size 2^( 3) =       0.000436324243
  error estimate for blocks of size 2^( 4) =       0.000449745927
  error estimate for blocks of size 2^( 5) =       0.000460528130
  error estimate for blocks of size 2^( 6) =       0.000468207595
  error estimate for blocks of size 2^( 7) =       0.000470233353

      target function =                  N/A
              le_mean =     -16.905983335694
             les_mean =     286.148489376076
             stat err =       0.000462178751
             autocorr =       1.270662696349
              std dev =       0.579842217699
             le_variance =       0.336216997426

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336244440521
                                         uncertainty =       0.002843022744

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336244440521
                                         uncertainty =       0.002843022744

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410010379
  error estimate for blocks of size 2^( 2) =       0.000422487807
  error estimate for blocks of size 2^( 3) =       0.000436324257
  error estimate for blocks of size 2^( 4) =       0.000449745940
  error estimate for blocks of size 2^( 5) =       0.000460528143
  error estimate for blocks of size 2^( 6) =       0.000468207608
  error estimate for blocks of size 2^( 7) =       0.000470233366

      target function =                  N/A
              le_mean =     -16.905983335634
             les_mean =     286.148489397910
             stat err =       0.000462178764
             autocorr =       1.270662676822
              std dev =       0.579842238271
             le_variance =       0.336217021284

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336244428597
                                         uncertainty =       0.002843022606

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336244428597
                                         uncertainty =       0.002843022606

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410010371
  error estimate for blocks of size 2^( 2) =       0.000422487800
  error estimate for blocks of size 2^( 3) =       0.000436324250
  error estimate for blocks of size 2^( 4) =       0.000449745934
  error estimate for blocks of size 2^( 5) =       0.000460528137
  error estimate for blocks of size 2^( 6) =       0.000468207601
  error estimate for blocks of size 2^( 7) =       0.000470233360

      target function =                  N/A
              le_mean =     -16.905983335664
             les_mean =     286.148489386993
             stat err =       0.000462178758
             autocorr =       1.270662686587
              std dev =       0.579842227986
             le_variance =       0.336217009356

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336244418162
                                         uncertainty =       0.002843022485

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336244418162
                                         uncertainty =       0.002843022485

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410010365
  error estimate for blocks of size 2^( 2) =       0.000422487794
  error estimate for blocks of size 2^( 3) =       0.000436324244
  error estimate for blocks of size 2^( 4) =       0.000449745928
  error estimate for blocks of size 2^( 5) =       0.000460528131
  error estimate for blocks of size 2^( 6) =       0.000468207596
  error estimate for blocks of size 2^( 7) =       0.000470233354

      target function =                  N/A
              le_mean =     -16.905983335690
             les_mean =     286.148489377441
             stat err =       0.000462178752
             autocorr =       1.270662695119
              std dev =       0.579842218985
             le_variance =       0.336216998918


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905983335694        initial  <--
     5.8208e+03     5.8208e+04             4.6589e-08       -16.905983335634
     2.3283e+04     2.3283e+05             1.1648e-08       -16.905983335664
     9.3132e+04     9.3132e+05             2.9119e-09       -16.905983335690

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7785
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.089013e-01 1 1  ON 0
 uu_1                 1.423322e-01 1 1  ON 1
 uu_2                 4.100685e-02 1 1  ON 2
 uu_3                -2.087876e-02 1 1  ON 3
 uu_4                -6.551270e-02 1 1  ON 4
 uu_5                -9.898831e-02 1 1  ON 5
 uu_6                -1.249164e-01 1 1  ON 6
 uu_7                -1.369789e-01 1 1  ON 7
 uu_8                -1.288115e-01 1 1  ON 8
 uu_9                -9.714454e-02 1 1  ON 9
 ud_0                 4.453537e-01 1 1  ON 10
 ud_1                 1.798033e-01 1 1  ON 11
 ud_2                 5.939815e-02 1 1  ON 12
 ud_3                -1.117185e-02 1 1  ON 13
 ud_4                -6.726697e-02 1 1  ON 14
 ud_5                -1.076430e-01 1 1  ON 15
 ud_6                -1.342495e-01 1 1  ON 16
 ud_7                -1.491954e-01 1 1  ON 17
 ud_8                -1.498257e-01 1 1  ON 18
 ud_9                -1.387780e-01 1 1  ON 19
 eO_0                -7.548753e-01 1 1  ON 20
 eO_1                -4.344123e-01 1 1  ON 21
 eO_2                -1.793188e-02 1 1  ON 22
 eO_3                 2.971945e-01 1 1  ON 23
 eO_4                 5.174711e-01 1 1  ON 24
 eO_5                 4.743230e-01 1 1  ON 25
 eO_6                 2.445103e-01 1 1  ON 26
 eO_7                -5.057463e-02 1 1  ON 27
 eO_8                -2.083832e-01 1 1  ON 28
 eO_9                -6.880566e-02 1 1  ON 29
eH1_0                -2.402703e-01 1 1  ON 30
eH1_1                -1.389717e-01 1 1  ON 31
eH1_2                -9.183369e-02 1 1  ON 32
eH1_3                -3.777927e-02 1 1  ON 33
eH1_4                 1.065929e-02 1 1  ON 34
eH1_5                 4.367803e-02 1 1  ON 35
eH1_6                 9.985326e-02 1 1  ON 36
eH1_7                 1.481207e-01 1 1  ON 37
eH1_8                 1.628195e-01 1 1  ON 38
eH1_9                 4.774297e-02 1 1  ON 39
eH2_0                -2.366093e-01 1 1  ON 40
eH2_1                -1.356781e-01 1 1  ON 41
eH2_2                -8.828587e-02 1 1  ON 42
eH2_3                -3.442294e-02 1 1  ON 43
eH2_4                 1.342283e-02 1 1  ON 44
eH2_5                 4.709585e-02 1 1  ON 45
eH2_6                 1.036258e-01 1 1  ON 46
eH2_7                 1.501367e-01 1 1  ON 47
eH2_8                 1.668110e-01 1 1  ON 48
eH2_9                 3.135314e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7988e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.9688
    reference variance = 0.270305
====================================================
  Execution time = 2.0633e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3829e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5017e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338366701324
                                         uncertainty =       0.004402006033

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338366701324
                                         uncertainty =       0.004402006033

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411272836
  error estimate for blocks of size 2^( 2) =       0.000424397487
  error estimate for blocks of size 2^( 3) =       0.000437879086
  error estimate for blocks of size 2^( 4) =       0.000449780182
  error estimate for blocks of size 2^( 5) =       0.000460511044
  error estimate for blocks of size 2^( 6) =       0.000467363812
  error estimate for blocks of size 2^( 7) =       0.000472145955

      target function =                  N/A
              le_mean =     -16.906656847019
             les_mean =     286.173336265053
             stat err =       0.000462450248
             autocorr =       1.264357770340
              std dev =       0.581627622584
             le_variance =       0.338290691353


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690665684702e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+04, overlap shift 5.8208e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906656847019       residual = 4.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906656847023       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906656847019       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906656847001       residual = 5.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906656847020       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906656847003       residual = 8.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906656846732       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906656847048       residual = 3.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+04 is 3.914076e-09

solving harmonic davidson linear method for identity shift 2.3283e+05, overlap shift 2.3283e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906656847019       residual = 4.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906656847020       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906656847019       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906656846970       residual = 5.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906656847019       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906656846957       residual = 8.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906656847148       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906656847045       residual = 3.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+05 is 9.785192e-10

solving harmonic davidson linear method for identity shift 9.3132e+05, overlap shift 9.3132e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906656847019       residual = 4.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906656847019       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906656847019       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906656846851       residual = 5.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906656847187       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906656846777       residual = 8.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906656847738       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906656847435       residual = 3.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+05 is 2.446298e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.104893 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6141e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.089013e-01 1 1  ON 0
 uu_1                 1.423322e-01 1 1  ON 1
 uu_2                 4.100685e-02 1 1  ON 2
 uu_3                -2.087876e-02 1 1  ON 3
 uu_4                -6.551270e-02 1 1  ON 4
 uu_5                -9.898831e-02 1 1  ON 5
 uu_6                -1.249164e-01 1 1  ON 6
 uu_7                -1.369789e-01 1 1  ON 7
 uu_8                -1.288115e-01 1 1  ON 8
 uu_9                -9.714454e-02 1 1  ON 9
 ud_0                 4.453537e-01 1 1  ON 10
 ud_1                 1.798033e-01 1 1  ON 11
 ud_2                 5.939815e-02 1 1  ON 12
 ud_3                -1.117185e-02 1 1  ON 13
 ud_4                -6.726697e-02 1 1  ON 14
 ud_5                -1.076430e-01 1 1  ON 15
 ud_6                -1.342495e-01 1 1  ON 16
 ud_7                -1.491954e-01 1 1  ON 17
 ud_8                -1.498257e-01 1 1  ON 18
 ud_9                -1.387780e-01 1 1  ON 19
 eO_0                -7.548753e-01 1 1  ON 20
 eO_1                -4.344123e-01 1 1  ON 21
 eO_2                -1.793188e-02 1 1  ON 22
 eO_3                 2.971945e-01 1 1  ON 23
 eO_4                 5.174711e-01 1 1  ON 24
 eO_5                 4.743230e-01 1 1  ON 25
 eO_6                 2.445103e-01 1 1  ON 26
 eO_7                -5.057463e-02 1 1  ON 27
 eO_8                -2.083832e-01 1 1  ON 28
 eO_9                -6.880566e-02 1 1  ON 29
eH1_0                -2.402703e-01 1 1  ON 30
eH1_1                -1.389717e-01 1 1  ON 31
eH1_2                -9.183369e-02 1 1  ON 32
eH1_3                -3.777927e-02 1 1  ON 33
eH1_4                 1.065929e-02 1 1  ON 34
eH1_5                 4.367803e-02 1 1  ON 35
eH1_6                 9.985326e-02 1 1  ON 36
eH1_7                 1.481207e-01 1 1  ON 37
eH1_8                 1.628195e-01 1 1  ON 38
eH1_9                 4.774297e-02 1 1  ON 39
eH2_0                -2.366093e-01 1 1  ON 40
eH2_1                -1.356781e-01 1 1  ON 41
eH2_2                -8.828587e-02 1 1  ON 42
eH2_3                -3.442294e-02 1 1  ON 43
eH2_4                 1.342283e-02 1 1  ON 44
eH2_5                 4.709585e-02 1 1  ON 45
eH2_6                 1.036258e-01 1 1  ON 46
eH2_7                 1.501367e-01 1 1  ON 47
eH2_8                 1.668110e-01 1 1  ON 48
eH2_9                 3.135314e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.0302
    reference variance = 0.696227
====================================================
  Execution time = 1.9970e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4359e-01
  Total weights = 2.0000e+06
  Execution time = 1.8981e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343596161922
                                         uncertainty =       0.003837287455

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343596161922
                                         uncertainty =       0.003837287455

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414482395
  error estimate for blocks of size 2^( 2) =       0.000427869246
  error estimate for blocks of size 2^( 3) =       0.000441964257
  error estimate for blocks of size 2^( 4) =       0.000455296789
  error estimate for blocks of size 2^( 5) =       0.000466578559
  error estimate for blocks of size 2^( 6) =       0.000477044922
  error estimate for blocks of size 2^( 7) =       0.000485786754

      target function =                  N/A
              le_mean =     -16.905044510252
             les_mean =     286.124121033649
             stat err =       0.000471176756
             autocorr =       1.292276769955
              std dev =       0.586166624628
             le_variance =       0.343591311828

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343596160750
                                         uncertainty =       0.003837287444

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343596160750
                                         uncertainty =       0.003837287444

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414482394
  error estimate for blocks of size 2^( 2) =       0.000427869245
  error estimate for blocks of size 2^( 3) =       0.000441964257
  error estimate for blocks of size 2^( 4) =       0.000455296789
  error estimate for blocks of size 2^( 5) =       0.000466578558
  error estimate for blocks of size 2^( 6) =       0.000477044921
  error estimate for blocks of size 2^( 7) =       0.000485786753

      target function =                  N/A
              le_mean =     -16.905044510229
             les_mean =     286.124121031693
             stat err =       0.000471176755
             autocorr =       1.292276771577
              std dev =       0.586166623628
             le_variance =       0.343591310656

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343596161336
                                         uncertainty =       0.003837287450

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343596161336
                                         uncertainty =       0.003837287450

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414482395
  error estimate for blocks of size 2^( 2) =       0.000427869246
  error estimate for blocks of size 2^( 3) =       0.000441964257
  error estimate for blocks of size 2^( 4) =       0.000455296789
  error estimate for blocks of size 2^( 5) =       0.000466578559
  error estimate for blocks of size 2^( 6) =       0.000477044922
  error estimate for blocks of size 2^( 7) =       0.000485786753

      target function =                  N/A
              le_mean =     -16.905044510241
             les_mean =     286.124121032671
             stat err =       0.000471176756
             autocorr =       1.292276770767
              std dev =       0.586166624128
             le_variance =       0.343591311242

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343596161849
                                         uncertainty =       0.003837287455

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343596161849
                                         uncertainty =       0.003837287455

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414482395
  error estimate for blocks of size 2^( 2) =       0.000427869246
  error estimate for blocks of size 2^( 3) =       0.000441964257
  error estimate for blocks of size 2^( 4) =       0.000455296789
  error estimate for blocks of size 2^( 5) =       0.000466578559
  error estimate for blocks of size 2^( 6) =       0.000477044922
  error estimate for blocks of size 2^( 7) =       0.000485786754

      target function =                  N/A
              le_mean =     -16.905044510251
             les_mean =     286.124121033527
             stat err =       0.000471176756
             autocorr =       1.292276770051
              std dev =       0.586166624566
             le_variance =       0.343591311755


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905044510252        initial  <--
     5.8208e+04     5.8208e+05             3.9141e-09       -16.905044510229
     2.3283e+05     2.3283e+06             9.7852e-10       -16.905044510241
     9.3132e+05     9.3132e+06             2.4463e-10       -16.905044510251

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5919
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.089013e-01 1 1  ON 0
 uu_1                 1.423322e-01 1 1  ON 1
 uu_2                 4.100685e-02 1 1  ON 2
 uu_3                -2.087876e-02 1 1  ON 3
 uu_4                -6.551270e-02 1 1  ON 4
 uu_5                -9.898831e-02 1 1  ON 5
 uu_6                -1.249164e-01 1 1  ON 6
 uu_7                -1.369789e-01 1 1  ON 7
 uu_8                -1.288115e-01 1 1  ON 8
 uu_9                -9.714454e-02 1 1  ON 9
 ud_0                 4.453537e-01 1 1  ON 10
 ud_1                 1.798033e-01 1 1  ON 11
 ud_2                 5.939815e-02 1 1  ON 12
 ud_3                -1.117185e-02 1 1  ON 13
 ud_4                -6.726697e-02 1 1  ON 14
 ud_5                -1.076430e-01 1 1  ON 15
 ud_6                -1.342495e-01 1 1  ON 16
 ud_7                -1.491954e-01 1 1  ON 17
 ud_8                -1.498257e-01 1 1  ON 18
 ud_9                -1.387780e-01 1 1  ON 19
 eO_0                -7.548753e-01 1 1  ON 20
 eO_1                -4.344123e-01 1 1  ON 21
 eO_2                -1.793188e-02 1 1  ON 22
 eO_3                 2.971945e-01 1 1  ON 23
 eO_4                 5.174711e-01 1 1  ON 24
 eO_5                 4.743230e-01 1 1  ON 25
 eO_6                 2.445103e-01 1 1  ON 26
 eO_7                -5.057463e-02 1 1  ON 27
 eO_8                -2.083832e-01 1 1  ON 28
 eO_9                -6.880566e-02 1 1  ON 29
eH1_0                -2.402703e-01 1 1  ON 30
eH1_1                -1.389717e-01 1 1  ON 31
eH1_2                -9.183369e-02 1 1  ON 32
eH1_3                -3.777927e-02 1 1  ON 33
eH1_4                 1.065929e-02 1 1  ON 34
eH1_5                 4.367803e-02 1 1  ON 35
eH1_6                 9.985326e-02 1 1  ON 36
eH1_7                 1.481207e-01 1 1  ON 37
eH1_8                 1.628195e-01 1 1  ON 38
eH1_9                 4.774297e-02 1 1  ON 39
eH2_0                -2.366093e-01 1 1  ON 40
eH2_1                -1.356781e-01 1 1  ON 41
eH2_2                -8.828587e-02 1 1  ON 42
eH2_3                -3.442294e-02 1 1  ON 43
eH2_4                 1.342283e-02 1 1  ON 44
eH2_5                 4.709585e-02 1 1  ON 45
eH2_6                 1.036258e-01 1 1  ON 46
eH2_7                 1.501367e-01 1 1  ON 47
eH2_8                 1.668110e-01 1 1  ON 48
eH2_9                 3.135314e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5738e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.8876
    reference variance = 0.197814
====================================================
  Execution time = 2.0386e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3774e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4748e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337775595817
                                         uncertainty =       0.002990560171

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337775595817
                                         uncertainty =       0.002990560171

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410939016
  error estimate for blocks of size 2^( 2) =       0.000423638630
  error estimate for blocks of size 2^( 3) =       0.000436633183
  error estimate for blocks of size 2^( 4) =       0.000448403706
  error estimate for blocks of size 2^( 5) =       0.000458499113
  error estimate for blocks of size 2^( 6) =       0.000465866165
  error estimate for blocks of size 2^( 7) =       0.000468632432

      target function =                  N/A
              le_mean =     -16.906373650408
             les_mean =     286.163211588855
             stat err =       0.000460350354
             autocorr =       1.254937820645
              std dev =       0.581155530408
             le_variance =       0.337741750524


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690637365041e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+05, overlap shift 5.8208e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906373650408       residual = 5.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906373650409       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906373650409       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906373650761       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906373650326       residual = 4.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906373650324       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906373650261       residual = 2.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906373650366       residual = 4.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+05 is 3.906044e-10

solving harmonic davidson linear method for identity shift 2.3283e+06, overlap shift 2.3283e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906373650408       residual = 5.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906373650408       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906373650408       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906373650408       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906373650408       residual = 4.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906373648120       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906373650711       residual = 2.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906373650060       residual = 4.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+06 is 9.765124e-11

solving harmonic davidson linear method for identity shift 9.3132e+06, overlap shift 9.3132e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906373650408       residual = 5.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906373650408       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906373650408       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906373645788       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906373648141       residual = 4.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906373647493       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906373650398       residual = 2.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906373658193       residual = 4.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+06 is 2.441286e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.107514 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5868e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.089013e-01 1 1  ON 0
 uu_1                 1.423322e-01 1 1  ON 1
 uu_2                 4.100685e-02 1 1  ON 2
 uu_3                -2.087876e-02 1 1  ON 3
 uu_4                -6.551270e-02 1 1  ON 4
 uu_5                -9.898831e-02 1 1  ON 5
 uu_6                -1.249164e-01 1 1  ON 6
 uu_7                -1.369789e-01 1 1  ON 7
 uu_8                -1.288115e-01 1 1  ON 8
 uu_9                -9.714454e-02 1 1  ON 9
 ud_0                 4.453537e-01 1 1  ON 10
 ud_1                 1.798033e-01 1 1  ON 11
 ud_2                 5.939815e-02 1 1  ON 12
 ud_3                -1.117185e-02 1 1  ON 13
 ud_4                -6.726697e-02 1 1  ON 14
 ud_5                -1.076430e-01 1 1  ON 15
 ud_6                -1.342495e-01 1 1  ON 16
 ud_7                -1.491954e-01 1 1  ON 17
 ud_8                -1.498257e-01 1 1  ON 18
 ud_9                -1.387780e-01 1 1  ON 19
 eO_0                -7.548753e-01 1 1  ON 20
 eO_1                -4.344123e-01 1 1  ON 21
 eO_2                -1.793188e-02 1 1  ON 22
 eO_3                 2.971945e-01 1 1  ON 23
 eO_4                 5.174711e-01 1 1  ON 24
 eO_5                 4.743230e-01 1 1  ON 25
 eO_6                 2.445103e-01 1 1  ON 26
 eO_7                -5.057463e-02 1 1  ON 27
 eO_8                -2.083832e-01 1 1  ON 28
 eO_9                -6.880566e-02 1 1  ON 29
eH1_0                -2.402703e-01 1 1  ON 30
eH1_1                -1.389717e-01 1 1  ON 31
eH1_2                -9.183369e-02 1 1  ON 32
eH1_3                -3.777927e-02 1 1  ON 33
eH1_4                 1.065929e-02 1 1  ON 34
eH1_5                 4.367803e-02 1 1  ON 35
eH1_6                 9.985326e-02 1 1  ON 36
eH1_7                 1.481207e-01 1 1  ON 37
eH1_8                 1.628195e-01 1 1  ON 38
eH1_9                 4.774297e-02 1 1  ON 39
eH2_0                -2.366093e-01 1 1  ON 40
eH2_1                -1.356781e-01 1 1  ON 41
eH2_2                -8.828587e-02 1 1  ON 42
eH2_3                -3.442294e-02 1 1  ON 43
eH2_4                 1.342283e-02 1 1  ON 44
eH2_5                 4.709585e-02 1 1  ON 45
eH2_6                 1.036258e-01 1 1  ON 46
eH2_7                 1.501367e-01 1 1  ON 47
eH2_8                 1.668110e-01 1 1  ON 48
eH2_9                 3.135314e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.9472
    reference variance = 0.299315
====================================================
  Execution time = 2.0329e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3560e-01
  Total weights = 2.0000e+06
  Execution time = 1.8857e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335598921031
                                         uncertainty =       0.003153242050

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335598921031
                                         uncertainty =       0.003153242050

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409634083
  error estimate for blocks of size 2^( 2) =       0.000422345975
  error estimate for blocks of size 2^( 3) =       0.000435599969
  error estimate for blocks of size 2^( 4) =       0.000447252154
  error estimate for blocks of size 2^( 5) =       0.000458015515
  error estimate for blocks of size 2^( 6) =       0.000466738520
  error estimate for blocks of size 2^( 7) =       0.000472018714

      target function =                  N/A
              le_mean =     -16.905759385151
             les_mean =     286.140300384419
             stat err =       0.000461006226
             autocorr =       1.266547298925
              std dev =       0.579310075529
             le_variance =       0.335600163609

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335598921258
                                         uncertainty =       0.003153242052

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335598921258
                                         uncertainty =       0.003153242052

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409634083
  error estimate for blocks of size 2^( 2) =       0.000422345975
  error estimate for blocks of size 2^( 3) =       0.000435599969
  error estimate for blocks of size 2^( 4) =       0.000447252154
  error estimate for blocks of size 2^( 5) =       0.000458015515
  error estimate for blocks of size 2^( 6) =       0.000466738520
  error estimate for blocks of size 2^( 7) =       0.000472018715

      target function =                  N/A
              le_mean =     -16.905759385151
             les_mean =     286.140300384668
             stat err =       0.000461006226
             autocorr =       1.266547298688
              std dev =       0.579310075724
             le_variance =       0.335600163835

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335598921145
                                         uncertainty =       0.003153242051

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335598921145
                                         uncertainty =       0.003153242051

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409634083
  error estimate for blocks of size 2^( 2) =       0.000422345975
  error estimate for blocks of size 2^( 3) =       0.000435599969
  error estimate for blocks of size 2^( 4) =       0.000447252154
  error estimate for blocks of size 2^( 5) =       0.000458015515
  error estimate for blocks of size 2^( 6) =       0.000466738520
  error estimate for blocks of size 2^( 7) =       0.000472018715

      target function =                  N/A
              le_mean =     -16.905759385151
             les_mean =     286.140300384543
             stat err =       0.000461006226
             autocorr =       1.266547298807
              std dev =       0.579310075626
             le_variance =       0.335600163722

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335598921046
                                         uncertainty =       0.003153242051

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335598921046
                                         uncertainty =       0.003153242051

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409634083
  error estimate for blocks of size 2^( 2) =       0.000422345975
  error estimate for blocks of size 2^( 3) =       0.000435599969
  error estimate for blocks of size 2^( 4) =       0.000447252154
  error estimate for blocks of size 2^( 5) =       0.000458015515
  error estimate for blocks of size 2^( 6) =       0.000466738520
  error estimate for blocks of size 2^( 7) =       0.000472018714

      target function =                  N/A
              le_mean =     -16.905759385151
             les_mean =     286.140300384435
             stat err =       0.000461006226
             autocorr =       1.266547298911
              std dev =       0.579310075541
             le_variance =       0.335600163623


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905759385151        initial
     5.8208e+05     5.8208e+06             3.9060e-10       -16.905759385151  <--
     2.3283e+06     2.3283e+07             9.7651e-11       -16.905759385151
     9.3132e+06     9.3132e+07             2.4413e-11       -16.905759385151

*****************************************************************************
Applying the update for shift_i =   5.8208e+05     and shift_s =   5.8208e+06
*****************************************************************************

  Execution time = 2.9858e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.089013e-01 1 1  ON 0
 uu_1                 1.423322e-01 1 1  ON 1
 uu_2                 4.100685e-02 1 1  ON 2
 uu_3                -2.087876e-02 1 1  ON 3
 uu_4                -6.551270e-02 1 1  ON 4
 uu_5                -9.898831e-02 1 1  ON 5
 uu_6                -1.249164e-01 1 1  ON 6
 uu_7                -1.369789e-01 1 1  ON 7
 uu_8                -1.288115e-01 1 1  ON 8
 uu_9                -9.714454e-02 1 1  ON 9
 ud_0                 4.453537e-01 1 1  ON 10
 ud_1                 1.798033e-01 1 1  ON 11
 ud_2                 5.939815e-02 1 1  ON 12
 ud_3                -1.117185e-02 1 1  ON 13
 ud_4                -6.726697e-02 1 1  ON 14
 ud_5                -1.076430e-01 1 1  ON 15
 ud_6                -1.342495e-01 1 1  ON 16
 ud_7                -1.491954e-01 1 1  ON 17
 ud_8                -1.498257e-01 1 1  ON 18
 ud_9                -1.387780e-01 1 1  ON 19
 eO_0                -7.548753e-01 1 1  ON 20
 eO_1                -4.344123e-01 1 1  ON 21
 eO_2                -1.793188e-02 1 1  ON 22
 eO_3                 2.971945e-01 1 1  ON 23
 eO_4                 5.174711e-01 1 1  ON 24
 eO_5                 4.743230e-01 1 1  ON 25
 eO_6                 2.445103e-01 1 1  ON 26
 eO_7                -5.057463e-02 1 1  ON 27
 eO_8                -2.083832e-01 1 1  ON 28
 eO_9                -6.880566e-02 1 1  ON 29
eH1_0                -2.402703e-01 1 1  ON 30
eH1_1                -1.389717e-01 1 1  ON 31
eH1_2                -9.183369e-02 1 1  ON 32
eH1_3                -3.777927e-02 1 1  ON 33
eH1_4                 1.065929e-02 1 1  ON 34
eH1_5                 4.367803e-02 1 1  ON 35
eH1_6                 9.985326e-02 1 1  ON 36
eH1_7                 1.481207e-01 1 1  ON 37
eH1_8                 1.628195e-01 1 1  ON 38
eH1_9                 4.774297e-02 1 1  ON 39
eH2_0                -2.366093e-01 1 1  ON 40
eH2_1                -1.356781e-01 1 1  ON 41
eH2_2                -8.828587e-02 1 1  ON 42
eH2_3                -3.442294e-02 1 1  ON 43
eH2_4                 1.342283e-02 1 1  ON 44
eH2_5                 4.709585e-02 1 1  ON 45
eH2_6                 1.036258e-01 1 1  ON 46
eH2_7                 1.501367e-01 1 1  ON 47
eH2_8                 1.668110e-01 1 1  ON 48
eH2_9                 3.135314e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5731e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.8715
    reference variance = 0.341853
====================================================
  Execution time = 2.0298e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.2956e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4555e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329596097359
                                         uncertainty =       0.002305786484

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329596097359
                                         uncertainty =       0.002305786484

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405932049
  error estimate for blocks of size 2^( 2) =       0.000418671097
  error estimate for blocks of size 2^( 3) =       0.000431774518
  error estimate for blocks of size 2^( 4) =       0.000443531854
  error estimate for blocks of size 2^( 5) =       0.000454223712
  error estimate for blocks of size 2^( 6) =       0.000461413140
  error estimate for blocks of size 2^( 7) =       0.000464922877

      target function =                  N/A
              le_mean =     -16.905965299893
             les_mean =     286.141224212618
             stat err =       0.000456022896
             autocorr =       1.262021096487
              std dev =       0.574074608583
             le_variance =       0.329561656220


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690596529989e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+05, overlap shift 1.4552e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905965299893       residual = 4.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905965299899       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905965299903       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905965299926       residual = 4.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905965299933       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905965299932       residual = 4.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905965299985       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905965299999       residual = 2.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+05 is 1.580233e-09

solving harmonic davidson linear method for identity shift 5.8208e+05, overlap shift 5.8208e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905965299893       residual = 4.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905965299894       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905965299895       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905965299896       residual = 4.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905965299738       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905965300075       residual = 4.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905965299739       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905965300034       residual = 2.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+05 is 3.950583e-10

solving harmonic davidson linear method for identity shift 2.3283e+06, overlap shift 2.3283e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905965299893       residual = 4.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905965299893       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905965299893       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905965300042       residual = 4.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905965300908       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905965299895       residual = 4.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905965299781       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905965300992       residual = 2.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+06 is 9.876460e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.110127 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5760e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.089013e-01 1 1  ON 0
 uu_1                 1.423322e-01 1 1  ON 1
 uu_2                 4.100685e-02 1 1  ON 2
 uu_3                -2.087876e-02 1 1  ON 3
 uu_4                -6.551270e-02 1 1  ON 4
 uu_5                -9.898831e-02 1 1  ON 5
 uu_6                -1.249164e-01 1 1  ON 6
 uu_7                -1.369789e-01 1 1  ON 7
 uu_8                -1.288115e-01 1 1  ON 8
 uu_9                -9.714454e-02 1 1  ON 9
 ud_0                 4.453537e-01 1 1  ON 10
 ud_1                 1.798033e-01 1 1  ON 11
 ud_2                 5.939815e-02 1 1  ON 12
 ud_3                -1.117185e-02 1 1  ON 13
 ud_4                -6.726697e-02 1 1  ON 14
 ud_5                -1.076430e-01 1 1  ON 15
 ud_6                -1.342495e-01 1 1  ON 16
 ud_7                -1.491954e-01 1 1  ON 17
 ud_8                -1.498257e-01 1 1  ON 18
 ud_9                -1.387780e-01 1 1  ON 19
 eO_0                -7.548753e-01 1 1  ON 20
 eO_1                -4.344123e-01 1 1  ON 21
 eO_2                -1.793188e-02 1 1  ON 22
 eO_3                 2.971945e-01 1 1  ON 23
 eO_4                 5.174711e-01 1 1  ON 24
 eO_5                 4.743230e-01 1 1  ON 25
 eO_6                 2.445103e-01 1 1  ON 26
 eO_7                -5.057463e-02 1 1  ON 27
 eO_8                -2.083832e-01 1 1  ON 28
 eO_9                -6.880566e-02 1 1  ON 29
eH1_0                -2.402703e-01 1 1  ON 30
eH1_1                -1.389717e-01 1 1  ON 31
eH1_2                -9.183369e-02 1 1  ON 32
eH1_3                -3.777927e-02 1 1  ON 33
eH1_4                 1.065929e-02 1 1  ON 34
eH1_5                 4.367803e-02 1 1  ON 35
eH1_6                 9.985326e-02 1 1  ON 36
eH1_7                 1.481207e-01 1 1  ON 37
eH1_8                 1.628195e-01 1 1  ON 38
eH1_9                 4.774297e-02 1 1  ON 39
eH2_0                -2.366093e-01 1 1  ON 40
eH2_1                -1.356781e-01 1 1  ON 41
eH2_2                -8.828587e-02 1 1  ON 42
eH2_3                -3.442294e-02 1 1  ON 43
eH2_4                 1.342283e-02 1 1  ON 44
eH2_5                 4.709585e-02 1 1  ON 45
eH2_6                 1.036258e-01 1 1  ON 46
eH2_7                 1.501367e-01 1 1  ON 47
eH2_8                 1.668110e-01 1 1  ON 48
eH2_9                 3.135314e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.898
    reference variance = 0.181315
====================================================
  Execution time = 1.9965e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3168e-01
  Total weights = 2.0000e+06
  Execution time = 1.8928e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331813192447
                                         uncertainty =       0.002737739889

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331813192447
                                         uncertainty =       0.002737739889

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407233075
  error estimate for blocks of size 2^( 2) =       0.000420044466
  error estimate for blocks of size 2^( 3) =       0.000433135782
  error estimate for blocks of size 2^( 4) =       0.000444736923
  error estimate for blocks of size 2^( 5) =       0.000455555584
  error estimate for blocks of size 2^( 6) =       0.000464420105
  error estimate for blocks of size 2^( 7) =       0.000469946590

      target function =                  N/A
              le_mean =     -16.905280839606
             les_mean =     286.120197654221
             stat err =       0.000458664800
             autocorr =       1.268541669483
              std dev =       0.575914537168
             le_variance =       0.331677554121

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331813193393
                                         uncertainty =       0.002737739899

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331813193393
                                         uncertainty =       0.002737739899

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407233075
  error estimate for blocks of size 2^( 2) =       0.000420044467
  error estimate for blocks of size 2^( 3) =       0.000433135782
  error estimate for blocks of size 2^( 4) =       0.000444736923
  error estimate for blocks of size 2^( 5) =       0.000455555584
  error estimate for blocks of size 2^( 6) =       0.000464420106
  error estimate for blocks of size 2^( 7) =       0.000469946590

      target function =                  N/A
              le_mean =     -16.905280839602
             les_mean =     286.120197655029
             stat err =       0.000458664801
             autocorr =       1.268541668737
              std dev =       0.575914537989
             le_variance =       0.331677555067

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331813192920
                                         uncertainty =       0.002737739894

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331813192920
                                         uncertainty =       0.002737739894

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407233075
  error estimate for blocks of size 2^( 2) =       0.000420044467
  error estimate for blocks of size 2^( 3) =       0.000433135782
  error estimate for blocks of size 2^( 4) =       0.000444736923
  error estimate for blocks of size 2^( 5) =       0.000455555584
  error estimate for blocks of size 2^( 6) =       0.000464420106
  error estimate for blocks of size 2^( 7) =       0.000469946590

      target function =                  N/A
              le_mean =     -16.905280839604
             les_mean =     286.120197654625
             stat err =       0.000458664801
             autocorr =       1.268541669106
              std dev =       0.575914537578
             le_variance =       0.331677554594

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331813192506
                                         uncertainty =       0.002737739890

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331813192506
                                         uncertainty =       0.002737739890

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407233075
  error estimate for blocks of size 2^( 2) =       0.000420044467
  error estimate for blocks of size 2^( 3) =       0.000433135782
  error estimate for blocks of size 2^( 4) =       0.000444736923
  error estimate for blocks of size 2^( 5) =       0.000455555584
  error estimate for blocks of size 2^( 6) =       0.000464420105
  error estimate for blocks of size 2^( 7) =       0.000469946590

      target function =                  N/A
              le_mean =     -16.905280839605
             les_mean =     286.120197654272
             stat err =       0.000458664800
             autocorr =       1.268541669445
              std dev =       0.575914537219
             le_variance =       0.331677554180


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905280839606        initial  <--
     1.4552e+05     1.4552e+06             1.5802e-09       -16.905280839602
     5.8208e+05     5.8208e+06             3.9506e-10       -16.905280839604
     2.3283e+06     2.3283e+07             9.8765e-11       -16.905280839605

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5091
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.089013e-01 1 1  ON 0
 uu_1                 1.423322e-01 1 1  ON 1
 uu_2                 4.100685e-02 1 1  ON 2
 uu_3                -2.087876e-02 1 1  ON 3
 uu_4                -6.551270e-02 1 1  ON 4
 uu_5                -9.898831e-02 1 1  ON 5
 uu_6                -1.249164e-01 1 1  ON 6
 uu_7                -1.369789e-01 1 1  ON 7
 uu_8                -1.288115e-01 1 1  ON 8
 uu_9                -9.714454e-02 1 1  ON 9
 ud_0                 4.453537e-01 1 1  ON 10
 ud_1                 1.798033e-01 1 1  ON 11
 ud_2                 5.939815e-02 1 1  ON 12
 ud_3                -1.117185e-02 1 1  ON 13
 ud_4                -6.726697e-02 1 1  ON 14
 ud_5                -1.076430e-01 1 1  ON 15
 ud_6                -1.342495e-01 1 1  ON 16
 ud_7                -1.491954e-01 1 1  ON 17
 ud_8                -1.498257e-01 1 1  ON 18
 ud_9                -1.387780e-01 1 1  ON 19
 eO_0                -7.548753e-01 1 1  ON 20
 eO_1                -4.344123e-01 1 1  ON 21
 eO_2                -1.793188e-02 1 1  ON 22
 eO_3                 2.971945e-01 1 1  ON 23
 eO_4                 5.174711e-01 1 1  ON 24
 eO_5                 4.743230e-01 1 1  ON 25
 eO_6                 2.445103e-01 1 1  ON 26
 eO_7                -5.057463e-02 1 1  ON 27
 eO_8                -2.083832e-01 1 1  ON 28
 eO_9                -6.880566e-02 1 1  ON 29
eH1_0                -2.402703e-01 1 1  ON 30
eH1_1                -1.389717e-01 1 1  ON 31
eH1_2                -9.183369e-02 1 1  ON 32
eH1_3                -3.777927e-02 1 1  ON 33
eH1_4                 1.065929e-02 1 1  ON 34
eH1_5                 4.367803e-02 1 1  ON 35
eH1_6                 9.985326e-02 1 1  ON 36
eH1_7                 1.481207e-01 1 1  ON 37
eH1_8                 1.628195e-01 1 1  ON 38
eH1_9                 4.774297e-02 1 1  ON 39
eH2_0                -2.366093e-01 1 1  ON 40
eH2_1                -1.356781e-01 1 1  ON 41
eH2_2                -8.828587e-02 1 1  ON 42
eH2_3                -3.442294e-02 1 1  ON 43
eH2_4                 1.342283e-02 1 1  ON 44
eH2_5                 4.709585e-02 1 1  ON 45
eH2_6                 1.036258e-01 1 1  ON 46
eH2_7                 1.501367e-01 1 1  ON 47
eH2_8                 1.668110e-01 1 1  ON 48
eH2_9                 3.135314e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5274e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.9059
    reference variance = 0.722181
====================================================
  Execution time = 2.0515e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3873e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5150e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338777435153
                                         uncertainty =       0.005338364629

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338777435153
                                         uncertainty =       0.005338364629

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411537906
  error estimate for blocks of size 2^( 2) =       0.000424347201
  error estimate for blocks of size 2^( 3) =       0.000437338214
  error estimate for blocks of size 2^( 4) =       0.000449038748
  error estimate for blocks of size 2^( 5) =       0.000459495220
  error estimate for blocks of size 2^( 6) =       0.000466809754
  error estimate for blocks of size 2^( 7) =       0.000467484496

      target function =                  N/A
              le_mean =     -16.905105122593
             les_mean =     286.121305932187
             stat err =       0.000460707054
             autocorr =       1.253227852611
              std dev =       0.582002487651
             le_variance =       0.338726895632


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690510512259e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+06, overlap shift 1.4552e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905105122593       residual = 5.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905105122593       residual = 6.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905105122593       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905105122030       residual = 7.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905105122488       residual = 3.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905105122406       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905105122941       residual = 2.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905105121817       residual = 2.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+06 is 1.874269e-10

solving harmonic davidson linear method for identity shift 5.8208e+06, overlap shift 5.8208e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905105122593       residual = 5.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905105122593       residual = 6.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905105122593       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905105122593       residual = 7.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905105122395       residual = 3.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905105125623       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905105120724       residual = 2.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905105124080       residual = 2.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+06 is 4.685673e-11

solving harmonic davidson linear method for identity shift 2.3283e+07, overlap shift 2.3283e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905105122593       residual = 5.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905105122593       residual = 6.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905105122593       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905105131848       residual = 7.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905105114301       residual = 3.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905105120065       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905105140851       residual = 2.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905105096417       residual = 2.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+07 is 1.171361e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.112728 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6037e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.089013e-01 1 1  ON 0
 uu_1                 1.423322e-01 1 1  ON 1
 uu_2                 4.100685e-02 1 1  ON 2
 uu_3                -2.087876e-02 1 1  ON 3
 uu_4                -6.551270e-02 1 1  ON 4
 uu_5                -9.898831e-02 1 1  ON 5
 uu_6                -1.249164e-01 1 1  ON 6
 uu_7                -1.369789e-01 1 1  ON 7
 uu_8                -1.288115e-01 1 1  ON 8
 uu_9                -9.714454e-02 1 1  ON 9
 ud_0                 4.453537e-01 1 1  ON 10
 ud_1                 1.798033e-01 1 1  ON 11
 ud_2                 5.939815e-02 1 1  ON 12
 ud_3                -1.117185e-02 1 1  ON 13
 ud_4                -6.726697e-02 1 1  ON 14
 ud_5                -1.076430e-01 1 1  ON 15
 ud_6                -1.342495e-01 1 1  ON 16
 ud_7                -1.491954e-01 1 1  ON 17
 ud_8                -1.498257e-01 1 1  ON 18
 ud_9                -1.387780e-01 1 1  ON 19
 eO_0                -7.548753e-01 1 1  ON 20
 eO_1                -4.344123e-01 1 1  ON 21
 eO_2                -1.793188e-02 1 1  ON 22
 eO_3                 2.971945e-01 1 1  ON 23
 eO_4                 5.174711e-01 1 1  ON 24
 eO_5                 4.743230e-01 1 1  ON 25
 eO_6                 2.445103e-01 1 1  ON 26
 eO_7                -5.057463e-02 1 1  ON 27
 eO_8                -2.083832e-01 1 1  ON 28
 eO_9                -6.880566e-02 1 1  ON 29
eH1_0                -2.402703e-01 1 1  ON 30
eH1_1                -1.389717e-01 1 1  ON 31
eH1_2                -9.183369e-02 1 1  ON 32
eH1_3                -3.777927e-02 1 1  ON 33
eH1_4                 1.065929e-02 1 1  ON 34
eH1_5                 4.367803e-02 1 1  ON 35
eH1_6                 9.985326e-02 1 1  ON 36
eH1_7                 1.481207e-01 1 1  ON 37
eH1_8                 1.628195e-01 1 1  ON 38
eH1_9                 4.774297e-02 1 1  ON 39
eH2_0                -2.366093e-01 1 1  ON 40
eH2_1                -1.356781e-01 1 1  ON 41
eH2_2                -8.828587e-02 1 1  ON 42
eH2_3                -3.442294e-02 1 1  ON 43
eH2_4                 1.342283e-02 1 1  ON 44
eH2_5                 4.709585e-02 1 1  ON 45
eH2_6                 1.036258e-01 1 1  ON 46
eH2_7                 1.501367e-01 1 1  ON 47
eH2_8                 1.668110e-01 1 1  ON 48
eH2_9                 3.135314e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.0136
    reference variance = 0.222253
====================================================
  Execution time = 2.0050e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4393e-01
  Total weights = 2.0000e+06
  Execution time = 1.8937e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343676689990
                                         uncertainty =       0.008196409235

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343676689990
                                         uncertainty =       0.008196409235

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414688762
  error estimate for blocks of size 2^( 2) =       0.000427194711
  error estimate for blocks of size 2^( 3) =       0.000439866288
  error estimate for blocks of size 2^( 4) =       0.000451014721
  error estimate for blocks of size 2^( 5) =       0.000459778247
  error estimate for blocks of size 2^( 6) =       0.000465118205
  error estimate for blocks of size 2^( 7) =       0.000466173388

      target function =                  N/A
              le_mean =     -16.906084124051
             les_mean =     286.159613776910
             stat err =       0.000460521140
             autocorr =       1.233259895568
              std dev =       0.586458471999
             le_variance =       0.343933539380

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343676690094
                                         uncertainty =       0.008196409239

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343676690094
                                         uncertainty =       0.008196409239

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414688762
  error estimate for blocks of size 2^( 2) =       0.000427194711
  error estimate for blocks of size 2^( 3) =       0.000439866288
  error estimate for blocks of size 2^( 4) =       0.000451014721
  error estimate for blocks of size 2^( 5) =       0.000459778247
  error estimate for blocks of size 2^( 6) =       0.000465118205
  error estimate for blocks of size 2^( 7) =       0.000466173388

      target function =                  N/A
              le_mean =     -16.906084124052
             les_mean =     286.159613777030
             stat err =       0.000460521140
             autocorr =       1.233259895473
              std dev =       0.586458472087
             le_variance =       0.343933539483

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343676690042
                                         uncertainty =       0.008196409237

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343676690042
                                         uncertainty =       0.008196409237

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414688762
  error estimate for blocks of size 2^( 2) =       0.000427194711
  error estimate for blocks of size 2^( 3) =       0.000439866288
  error estimate for blocks of size 2^( 4) =       0.000451014721
  error estimate for blocks of size 2^( 5) =       0.000459778247
  error estimate for blocks of size 2^( 6) =       0.000465118205
  error estimate for blocks of size 2^( 7) =       0.000466173388

      target function =                  N/A
              le_mean =     -16.906084124051
             les_mean =     286.159613776970
             stat err =       0.000460521140
             autocorr =       1.233259895522
              std dev =       0.586458472043
             le_variance =       0.343933539431

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343676689997
                                         uncertainty =       0.008196409235

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343676689997
                                         uncertainty =       0.008196409235

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414688762
  error estimate for blocks of size 2^( 2) =       0.000427194711
  error estimate for blocks of size 2^( 3) =       0.000439866288
  error estimate for blocks of size 2^( 4) =       0.000451014721
  error estimate for blocks of size 2^( 5) =       0.000459778247
  error estimate for blocks of size 2^( 6) =       0.000465118205
  error estimate for blocks of size 2^( 7) =       0.000466173388

      target function =                  N/A
              le_mean =     -16.906084124051
             les_mean =     286.159613776917
             stat err =       0.000460521140
             autocorr =       1.233259895561
              std dev =       0.586458472005
             le_variance =       0.343933539386


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906084124051        initial
     1.4552e+06     1.4552e+07             1.8743e-10       -16.906084124052  <--
     5.8208e+06     5.8208e+07             4.6857e-11       -16.906084124051
     2.3283e+07     2.3283e+08             1.1714e-11       -16.906084124051

*****************************************************************************
Applying the update for shift_i =   1.4552e+06     and shift_s =   1.4552e+07
*****************************************************************************

  Execution time = 2.9595e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.089013e-01 1 1  ON 0
 uu_1                 1.423322e-01 1 1  ON 1
 uu_2                 4.100685e-02 1 1  ON 2
 uu_3                -2.087876e-02 1 1  ON 3
 uu_4                -6.551270e-02 1 1  ON 4
 uu_5                -9.898831e-02 1 1  ON 5
 uu_6                -1.249164e-01 1 1  ON 6
 uu_7                -1.369789e-01 1 1  ON 7
 uu_8                -1.288115e-01 1 1  ON 8
 uu_9                -9.714454e-02 1 1  ON 9
 ud_0                 4.453537e-01 1 1  ON 10
 ud_1                 1.798033e-01 1 1  ON 11
 ud_2                 5.939815e-02 1 1  ON 12
 ud_3                -1.117185e-02 1 1  ON 13
 ud_4                -6.726697e-02 1 1  ON 14
 ud_5                -1.076430e-01 1 1  ON 15
 ud_6                -1.342495e-01 1 1  ON 16
 ud_7                -1.491954e-01 1 1  ON 17
 ud_8                -1.498257e-01 1 1  ON 18
 ud_9                -1.387780e-01 1 1  ON 19
 eO_0                -7.548753e-01 1 1  ON 20
 eO_1                -4.344123e-01 1 1  ON 21
 eO_2                -1.793188e-02 1 1  ON 22
 eO_3                 2.971945e-01 1 1  ON 23
 eO_4                 5.174711e-01 1 1  ON 24
 eO_5                 4.743230e-01 1 1  ON 25
 eO_6                 2.445103e-01 1 1  ON 26
 eO_7                -5.057463e-02 1 1  ON 27
 eO_8                -2.083832e-01 1 1  ON 28
 eO_9                -6.880566e-02 1 1  ON 29
eH1_0                -2.402703e-01 1 1  ON 30
eH1_1                -1.389717e-01 1 1  ON 31
eH1_2                -9.183369e-02 1 1  ON 32
eH1_3                -3.777927e-02 1 1  ON 33
eH1_4                 1.065929e-02 1 1  ON 34
eH1_5                 4.367803e-02 1 1  ON 35
eH1_6                 9.985326e-02 1 1  ON 36
eH1_7                 1.481207e-01 1 1  ON 37
eH1_8                 1.628195e-01 1 1  ON 38
eH1_9                 4.774297e-02 1 1  ON 39
eH2_0                -2.366093e-01 1 1  ON 40
eH2_1                -1.356781e-01 1 1  ON 41
eH2_2                -8.828587e-02 1 1  ON 42
eH2_3                -3.442294e-02 1 1  ON 43
eH2_4                 1.342283e-02 1 1  ON 44
eH2_5                 4.709585e-02 1 1  ON 45
eH2_6                 1.036258e-01 1 1  ON 46
eH2_7                 1.501367e-01 1 1  ON 47
eH2_8                 1.668110e-01 1 1  ON 48
eH2_9                 3.135314e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5637e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.8791
    reference variance = 0.278796
====================================================
  Execution time = 2.2442e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4253e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5593e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342382949710
                                         uncertainty =       0.004273102001

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342382949710
                                         uncertainty =       0.004273102001

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413840138
  error estimate for blocks of size 2^( 2) =       0.000426580242
  error estimate for blocks of size 2^( 3) =       0.000439223120
  error estimate for blocks of size 2^( 4) =       0.000451830313
  error estimate for blocks of size 2^( 5) =       0.000463052166
  error estimate for blocks of size 2^( 6) =       0.000470632723
  error estimate for blocks of size 2^( 7) =       0.000473582663

      target function =                  N/A
              le_mean =     -16.905628674584
             les_mean =     286.142808031901
             stat err =       0.000464774466
             autocorr =       1.261302627050
              std dev =       0.585258336331
             le_variance =       0.342527320245


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690562867458e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+05, overlap shift 3.6380e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905628674584       residual = 3.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905628674585       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905628674589       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905628674590       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905628674591       residual = 4.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905628674592       residual = 7.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905628674795       residual = 1.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905628674435       residual = 4.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+05 is 6.882547e-10

solving harmonic davidson linear method for identity shift 1.4552e+06, overlap shift 1.4552e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905628674584       residual = 3.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905628674584       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905628674585       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905628674546       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905628674473       residual = 4.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905628674811       residual = 7.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905628674618       residual = 1.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905628675038       residual = 4.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+06 is 1.720635e-10

solving harmonic davidson linear method for identity shift 5.8208e+06, overlap shift 5.8208e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905628674584       residual = 3.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905628674584       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905628674584       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905628674584       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905628674492       residual = 4.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905628674598       residual = 7.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905628674578       residual = 1.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905628675940       residual = 4.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+06 is 4.301592e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.115373 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8008e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.089013e-01 1 1  ON 0
 uu_1                 1.423322e-01 1 1  ON 1
 uu_2                 4.100685e-02 1 1  ON 2
 uu_3                -2.087876e-02 1 1  ON 3
 uu_4                -6.551270e-02 1 1  ON 4
 uu_5                -9.898831e-02 1 1  ON 5
 uu_6                -1.249164e-01 1 1  ON 6
 uu_7                -1.369789e-01 1 1  ON 7
 uu_8                -1.288115e-01 1 1  ON 8
 uu_9                -9.714454e-02 1 1  ON 9
 ud_0                 4.453537e-01 1 1  ON 10
 ud_1                 1.798033e-01 1 1  ON 11
 ud_2                 5.939815e-02 1 1  ON 12
 ud_3                -1.117185e-02 1 1  ON 13
 ud_4                -6.726697e-02 1 1  ON 14
 ud_5                -1.076430e-01 1 1  ON 15
 ud_6                -1.342495e-01 1 1  ON 16
 ud_7                -1.491954e-01 1 1  ON 17
 ud_8                -1.498257e-01 1 1  ON 18
 ud_9                -1.387780e-01 1 1  ON 19
 eO_0                -7.548753e-01 1 1  ON 20
 eO_1                -4.344123e-01 1 1  ON 21
 eO_2                -1.793188e-02 1 1  ON 22
 eO_3                 2.971945e-01 1 1  ON 23
 eO_4                 5.174711e-01 1 1  ON 24
 eO_5                 4.743230e-01 1 1  ON 25
 eO_6                 2.445103e-01 1 1  ON 26
 eO_7                -5.057463e-02 1 1  ON 27
 eO_8                -2.083832e-01 1 1  ON 28
 eO_9                -6.880566e-02 1 1  ON 29
eH1_0                -2.402703e-01 1 1  ON 30
eH1_1                -1.389717e-01 1 1  ON 31
eH1_2                -9.183369e-02 1 1  ON 32
eH1_3                -3.777927e-02 1 1  ON 33
eH1_4                 1.065929e-02 1 1  ON 34
eH1_5                 4.367803e-02 1 1  ON 35
eH1_6                 9.985326e-02 1 1  ON 36
eH1_7                 1.481207e-01 1 1  ON 37
eH1_8                 1.628195e-01 1 1  ON 38
eH1_9                 4.774297e-02 1 1  ON 39
eH2_0                -2.366093e-01 1 1  ON 40
eH2_1                -1.356781e-01 1 1  ON 41
eH2_2                -8.828587e-02 1 1  ON 42
eH2_3                -3.442294e-02 1 1  ON 43
eH2_4                 1.342283e-02 1 1  ON 44
eH2_5                 4.709585e-02 1 1  ON 45
eH2_6                 1.036258e-01 1 1  ON 46
eH2_7                 1.501367e-01 1 1  ON 47
eH2_8                 1.668110e-01 1 1  ON 48
eH2_9                 3.135314e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.9785
    reference variance = 0.22087
====================================================
  Execution time = 2.2347e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3335e-01
  Total weights = 2.0000e+06
  Execution time = 1.8935e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333358458322
                                         uncertainty =       0.003818520159

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333358458322
                                         uncertainty =       0.003818520159

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408261000
  error estimate for blocks of size 2^( 2) =       0.000420930670
  error estimate for blocks of size 2^( 3) =       0.000434125393
  error estimate for blocks of size 2^( 4) =       0.000445779067
  error estimate for blocks of size 2^( 5) =       0.000456134442
  error estimate for blocks of size 2^( 6) =       0.000465071877
  error estimate for blocks of size 2^( 7) =       0.000469563361

      target function =                  N/A
              le_mean =     -16.905661874455
             les_mean =     286.134757335611
             stat err =       0.000459137187
             autocorr =       1.264762985011
              std dev =       0.577368243733
             le_variance =       0.333354088871

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333358458919
                                         uncertainty =       0.003818520168

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333358458919
                                         uncertainty =       0.003818520168

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408261001
  error estimate for blocks of size 2^( 2) =       0.000420930670
  error estimate for blocks of size 2^( 3) =       0.000434125394
  error estimate for blocks of size 2^( 4) =       0.000445779067
  error estimate for blocks of size 2^( 5) =       0.000456134443
  error estimate for blocks of size 2^( 6) =       0.000465071877
  error estimate for blocks of size 2^( 7) =       0.000469563361

      target function =                  N/A
              le_mean =     -16.905661874453
             les_mean =     286.134757336134
             stat err =       0.000459137187
             autocorr =       1.264762984426
              std dev =       0.577368244250
             le_variance =       0.333354089468

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333358458621
                                         uncertainty =       0.003818520164

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333358458621
                                         uncertainty =       0.003818520164

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408261001
  error estimate for blocks of size 2^( 2) =       0.000420930670
  error estimate for blocks of size 2^( 3) =       0.000434125393
  error estimate for blocks of size 2^( 4) =       0.000445779067
  error estimate for blocks of size 2^( 5) =       0.000456134442
  error estimate for blocks of size 2^( 6) =       0.000465071877
  error estimate for blocks of size 2^( 7) =       0.000469563361

      target function =                  N/A
              le_mean =     -16.905661874454
             les_mean =     286.134757335873
             stat err =       0.000459137187
             autocorr =       1.264762984715
              std dev =       0.577368243991
             le_variance =       0.333354089170

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333358458359
                                         uncertainty =       0.003818520159

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333358458359
                                         uncertainty =       0.003818520159

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408261000
  error estimate for blocks of size 2^( 2) =       0.000420930670
  error estimate for blocks of size 2^( 3) =       0.000434125393
  error estimate for blocks of size 2^( 4) =       0.000445779067
  error estimate for blocks of size 2^( 5) =       0.000456134442
  error estimate for blocks of size 2^( 6) =       0.000465071877
  error estimate for blocks of size 2^( 7) =       0.000469563361

      target function =                  N/A
              le_mean =     -16.905661874455
             les_mean =     286.134757335644
             stat err =       0.000459137187
             autocorr =       1.264762984968
              std dev =       0.577368243765
             le_variance =       0.333354088909


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905661874455        initial  <--
     3.6380e+05     3.6380e+06             6.8825e-10       -16.905661874453
     1.4552e+06     1.4552e+07             1.7206e-10       -16.905661874454
     5.8208e+06     5.8208e+07             4.3016e-11       -16.905661874455

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.9046
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.089013e-01 1 1  ON 0
 uu_1                 1.423322e-01 1 1  ON 1
 uu_2                 4.100685e-02 1 1  ON 2
 uu_3                -2.087876e-02 1 1  ON 3
 uu_4                -6.551270e-02 1 1  ON 4
 uu_5                -9.898831e-02 1 1  ON 5
 uu_6                -1.249164e-01 1 1  ON 6
 uu_7                -1.369789e-01 1 1  ON 7
 uu_8                -1.288115e-01 1 1  ON 8
 uu_9                -9.714454e-02 1 1  ON 9
 ud_0                 4.453537e-01 1 1  ON 10
 ud_1                 1.798033e-01 1 1  ON 11
 ud_2                 5.939815e-02 1 1  ON 12
 ud_3                -1.117185e-02 1 1  ON 13
 ud_4                -6.726697e-02 1 1  ON 14
 ud_5                -1.076430e-01 1 1  ON 15
 ud_6                -1.342495e-01 1 1  ON 16
 ud_7                -1.491954e-01 1 1  ON 17
 ud_8                -1.498257e-01 1 1  ON 18
 ud_9                -1.387780e-01 1 1  ON 19
 eO_0                -7.548753e-01 1 1  ON 20
 eO_1                -4.344123e-01 1 1  ON 21
 eO_2                -1.793188e-02 1 1  ON 22
 eO_3                 2.971945e-01 1 1  ON 23
 eO_4                 5.174711e-01 1 1  ON 24
 eO_5                 4.743230e-01 1 1  ON 25
 eO_6                 2.445103e-01 1 1  ON 26
 eO_7                -5.057463e-02 1 1  ON 27
 eO_8                -2.083832e-01 1 1  ON 28
 eO_9                -6.880566e-02 1 1  ON 29
eH1_0                -2.402703e-01 1 1  ON 30
eH1_1                -1.389717e-01 1 1  ON 31
eH1_2                -9.183369e-02 1 1  ON 32
eH1_3                -3.777927e-02 1 1  ON 33
eH1_4                 1.065929e-02 1 1  ON 34
eH1_5                 4.367803e-02 1 1  ON 35
eH1_6                 9.985326e-02 1 1  ON 36
eH1_7                 1.481207e-01 1 1  ON 37
eH1_8                 1.628195e-01 1 1  ON 38
eH1_9                 4.774297e-02 1 1  ON 39
eH2_0                -2.366093e-01 1 1  ON 40
eH2_1                -1.356781e-01 1 1  ON 41
eH2_2                -8.828587e-02 1 1  ON 42
eH2_3                -3.442294e-02 1 1  ON 43
eH2_4                 1.342283e-02 1 1  ON 44
eH2_5                 4.709585e-02 1 1  ON 45
eH2_6                 1.036258e-01 1 1  ON 46
eH2_7                 1.501367e-01 1 1  ON 47
eH2_8                 1.668110e-01 1 1  ON 48
eH2_9                 3.135314e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9918e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.9664
    reference variance = 0.12835
====================================================
  Execution time = 2.0349e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3898e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5094e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339063120551
                                         uncertainty =       0.005401263361

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339063120551
                                         uncertainty =       0.005401263361

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411690399
  error estimate for blocks of size 2^( 2) =       0.000424393473
  error estimate for blocks of size 2^( 3) =       0.000436872041
  error estimate for blocks of size 2^( 4) =       0.000449455317
  error estimate for blocks of size 2^( 5) =       0.000460066600
  error estimate for blocks of size 2^( 6) =       0.000469580985
  error estimate for blocks of size 2^( 7) =       0.000475842230

      target function =                  N/A
              le_mean =     -16.906910966119
             les_mean =     286.182616216390
             stat err =       0.000463736283
             autocorr =       1.268821926461
              std dev =       0.582218146065
             le_variance =       0.338977969607


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690691096612e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+06, overlap shift 3.6380e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906910966119       residual = 8.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906910966119       residual = 3.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906910966119       residual = 4.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906910965115       residual = 7.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906910966119       residual = 3.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906910966704       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906910968373       residual = 3.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906910966733       residual = 7.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+06 is 5.716911e-11

solving harmonic davidson linear method for identity shift 1.4552e+07, overlap shift 1.4552e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906910966119       residual = 8.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906910966119       residual = 3.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906910966119       residual = 4.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906910966533       residual = 7.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906910966329       residual = 3.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906910969185       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906910976480       residual = 3.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906910954791       residual = 7.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+07 is 1.429237e-11

solving harmonic davidson linear method for identity shift 5.8208e+07, overlap shift 5.8208e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906910966119       residual = 8.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906910966119       residual = 3.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906910966119       residual = 4.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906910966119       residual = 7.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906910967914       residual = 3.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906910937659       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906910942119       residual = 3.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906910938641       residual = 7.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+07 is 3.572939e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.118009 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5865e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.089013e-01 1 1  ON 0
 uu_1                 1.423322e-01 1 1  ON 1
 uu_2                 4.100685e-02 1 1  ON 2
 uu_3                -2.087876e-02 1 1  ON 3
 uu_4                -6.551270e-02 1 1  ON 4
 uu_5                -9.898831e-02 1 1  ON 5
 uu_6                -1.249164e-01 1 1  ON 6
 uu_7                -1.369789e-01 1 1  ON 7
 uu_8                -1.288115e-01 1 1  ON 8
 uu_9                -9.714454e-02 1 1  ON 9
 ud_0                 4.453537e-01 1 1  ON 10
 ud_1                 1.798033e-01 1 1  ON 11
 ud_2                 5.939815e-02 1 1  ON 12
 ud_3                -1.117185e-02 1 1  ON 13
 ud_4                -6.726697e-02 1 1  ON 14
 ud_5                -1.076430e-01 1 1  ON 15
 ud_6                -1.342495e-01 1 1  ON 16
 ud_7                -1.491954e-01 1 1  ON 17
 ud_8                -1.498257e-01 1 1  ON 18
 ud_9                -1.387780e-01 1 1  ON 19
 eO_0                -7.548753e-01 1 1  ON 20
 eO_1                -4.344123e-01 1 1  ON 21
 eO_2                -1.793188e-02 1 1  ON 22
 eO_3                 2.971945e-01 1 1  ON 23
 eO_4                 5.174711e-01 1 1  ON 24
 eO_5                 4.743230e-01 1 1  ON 25
 eO_6                 2.445103e-01 1 1  ON 26
 eO_7                -5.057463e-02 1 1  ON 27
 eO_8                -2.083832e-01 1 1  ON 28
 eO_9                -6.880566e-02 1 1  ON 29
eH1_0                -2.402703e-01 1 1  ON 30
eH1_1                -1.389717e-01 1 1  ON 31
eH1_2                -9.183369e-02 1 1  ON 32
eH1_3                -3.777927e-02 1 1  ON 33
eH1_4                 1.065929e-02 1 1  ON 34
eH1_5                 4.367803e-02 1 1  ON 35
eH1_6                 9.985326e-02 1 1  ON 36
eH1_7                 1.481207e-01 1 1  ON 37
eH1_8                 1.628195e-01 1 1  ON 38
eH1_9                 4.774297e-02 1 1  ON 39
eH2_0                -2.366093e-01 1 1  ON 40
eH2_1                -1.356781e-01 1 1  ON 41
eH2_2                -8.828587e-02 1 1  ON 42
eH2_3                -3.442294e-02 1 1  ON 43
eH2_4                 1.342283e-02 1 1  ON 44
eH2_5                 4.709585e-02 1 1  ON 45
eH2_6                 1.036258e-01 1 1  ON 46
eH2_7                 1.501367e-01 1 1  ON 47
eH2_8                 1.668110e-01 1 1  ON 48
eH2_9                 3.135314e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.8501
    reference variance = 0.295816
====================================================
  Execution time = 2.0017e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3182e-01
  Total weights = 2.0000e+06
  Execution time = 1.8878e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331857506698
                                         uncertainty =       0.003037693128

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331857506698
                                         uncertainty =       0.003037693128

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407318800
  error estimate for blocks of size 2^( 2) =       0.000420237538
  error estimate for blocks of size 2^( 3) =       0.000433188477
  error estimate for blocks of size 2^( 4) =       0.000445688667
  error estimate for blocks of size 2^( 5) =       0.000455407400
  error estimate for blocks of size 2^( 6) =       0.000462229800
  error estimate for blocks of size 2^( 7) =       0.000465212347

      target function =                  N/A
              le_mean =     -16.906128864683
             les_mean =     286.149010233166
             stat err =       0.000457134553
             autocorr =       1.259560948735
              std dev =       0.576035771298
             le_variance =       0.331817209815

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331857506701
                                         uncertainty =       0.003037693128

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331857506701
                                         uncertainty =       0.003037693128

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407318800
  error estimate for blocks of size 2^( 2) =       0.000420237538
  error estimate for blocks of size 2^( 3) =       0.000433188477
  error estimate for blocks of size 2^( 4) =       0.000445688667
  error estimate for blocks of size 2^( 5) =       0.000455407400
  error estimate for blocks of size 2^( 6) =       0.000462229800
  error estimate for blocks of size 2^( 7) =       0.000465212347

      target function =                  N/A
              le_mean =     -16.906128864683
             les_mean =     286.149010233186
             stat err =       0.000457134553
             autocorr =       1.259560948722
              std dev =       0.576035771301
             le_variance =       0.331817209818

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331857506699
                                         uncertainty =       0.003037693128

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331857506699
                                         uncertainty =       0.003037693128

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407318800
  error estimate for blocks of size 2^( 2) =       0.000420237538
  error estimate for blocks of size 2^( 3) =       0.000433188477
  error estimate for blocks of size 2^( 4) =       0.000445688667
  error estimate for blocks of size 2^( 5) =       0.000455407400
  error estimate for blocks of size 2^( 6) =       0.000462229800
  error estimate for blocks of size 2^( 7) =       0.000465212347

      target function =                  N/A
              le_mean =     -16.906128864683
             les_mean =     286.149010233176
             stat err =       0.000457134553
             autocorr =       1.259560948718
              std dev =       0.576035771299
             le_variance =       0.331817209816

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331857506698
                                         uncertainty =       0.003037693128

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331857506698
                                         uncertainty =       0.003037693128

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407318800
  error estimate for blocks of size 2^( 2) =       0.000420237538
  error estimate for blocks of size 2^( 3) =       0.000433188477
  error estimate for blocks of size 2^( 4) =       0.000445688667
  error estimate for blocks of size 2^( 5) =       0.000455407400
  error estimate for blocks of size 2^( 6) =       0.000462229800
  error estimate for blocks of size 2^( 7) =       0.000465212347

      target function =                  N/A
              le_mean =     -16.906128864683
             les_mean =     286.149010233167
             stat err =       0.000457134553
             autocorr =       1.259560948723
              std dev =       0.576035771298
             le_variance =       0.331817209815


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906128864683        initial
     3.6380e+06     3.6380e+07             5.7169e-11       -16.906128864683  <--
     1.4552e+07     1.4552e+08             1.4292e-11       -16.906128864683
     5.8208e+07     5.8208e+08             3.5729e-12       -16.906128864683

*****************************************************************************
Applying the update for shift_i =   3.6380e+06     and shift_s =   3.6380e+07
*****************************************************************************

  Execution time = 2.9542e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.089013e-01 1 1  ON 0
 uu_1                 1.423322e-01 1 1  ON 1
 uu_2                 4.100685e-02 1 1  ON 2
 uu_3                -2.087876e-02 1 1  ON 3
 uu_4                -6.551270e-02 1 1  ON 4
 uu_5                -9.898831e-02 1 1  ON 5
 uu_6                -1.249164e-01 1 1  ON 6
 uu_7                -1.369789e-01 1 1  ON 7
 uu_8                -1.288115e-01 1 1  ON 8
 uu_9                -9.714454e-02 1 1  ON 9
 ud_0                 4.453537e-01 1 1  ON 10
 ud_1                 1.798033e-01 1 1  ON 11
 ud_2                 5.939815e-02 1 1  ON 12
 ud_3                -1.117185e-02 1 1  ON 13
 ud_4                -6.726697e-02 1 1  ON 14
 ud_5                -1.076430e-01 1 1  ON 15
 ud_6                -1.342495e-01 1 1  ON 16
 ud_7                -1.491954e-01 1 1  ON 17
 ud_8                -1.498257e-01 1 1  ON 18
 ud_9                -1.387780e-01 1 1  ON 19
 eO_0                -7.548753e-01 1 1  ON 20
 eO_1                -4.344123e-01 1 1  ON 21
 eO_2                -1.793188e-02 1 1  ON 22
 eO_3                 2.971945e-01 1 1  ON 23
 eO_4                 5.174711e-01 1 1  ON 24
 eO_5                 4.743230e-01 1 1  ON 25
 eO_6                 2.445103e-01 1 1  ON 26
 eO_7                -5.057463e-02 1 1  ON 27
 eO_8                -2.083832e-01 1 1  ON 28
 eO_9                -6.880566e-02 1 1  ON 29
eH1_0                -2.402703e-01 1 1  ON 30
eH1_1                -1.389717e-01 1 1  ON 31
eH1_2                -9.183369e-02 1 1  ON 32
eH1_3                -3.777927e-02 1 1  ON 33
eH1_4                 1.065929e-02 1 1  ON 34
eH1_5                 4.367803e-02 1 1  ON 35
eH1_6                 9.985326e-02 1 1  ON 36
eH1_7                 1.481207e-01 1 1  ON 37
eH1_8                 1.628195e-01 1 1  ON 38
eH1_9                 4.774297e-02 1 1  ON 39
eH2_0                -2.366093e-01 1 1  ON 40
eH2_1                -1.356781e-01 1 1  ON 41
eH2_2                -8.828587e-02 1 1  ON 42
eH2_3                -3.442294e-02 1 1  ON 43
eH2_4                 1.342283e-02 1 1  ON 44
eH2_5                 4.709585e-02 1 1  ON 45
eH2_6                 1.036258e-01 1 1  ON 46
eH2_7                 1.501367e-01 1 1  ON 47
eH2_8                 1.668110e-01 1 1  ON 48
eH2_9                 3.135314e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5412e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.885
    reference variance = 0.280317
====================================================
  Execution time = 2.0301e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3161e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4791e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331634453635
                                         uncertainty =       0.003801183495

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331634453635
                                         uncertainty =       0.003801183495

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407192078
  error estimate for blocks of size 2^( 2) =       0.000419788654
  error estimate for blocks of size 2^( 3) =       0.000432460420
  error estimate for blocks of size 2^( 4) =       0.000443954419
  error estimate for blocks of size 2^( 5) =       0.000453571035
  error estimate for blocks of size 2^( 6) =       0.000460680064
  error estimate for blocks of size 2^( 7) =       0.000464766241

      target function =                  N/A
              le_mean =     -16.905509445030
             les_mean =     286.127860207517
             stat err =       0.000455742940
             autocorr =       1.252683212573
              std dev =       0.575856559691
             le_variance =       0.331610777339


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690550944503e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+05, overlap shift 9.0949e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905509445030       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905509445031       residual = 3.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905509445031       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905509445030       residual = 5.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905509443570       residual = 4.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905509444715       residual = 9.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905509445375       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905509445223       residual = 5.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+05 is 2.511507e-10

solving harmonic davidson linear method for identity shift 3.6380e+06, overlap shift 3.6380e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905509445030       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905509445030       residual = 3.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905509445030       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905509442253       residual = 5.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905509443646       residual = 4.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905509447307       residual = 9.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905509447002       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905509442532       residual = 5.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+06 is 6.278791e-11

solving harmonic davidson linear method for identity shift 1.4552e+07, overlap shift 1.4552e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905509445030       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905509445030       residual = 3.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905509445030       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905509445030       residual = 5.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905509445030       residual = 4.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905509445030       residual = 9.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905509445140       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905509439597       residual = 5.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+07 is 1.569698e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.120637 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5787e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.089013e-01 1 1  ON 0
 uu_1                 1.423322e-01 1 1  ON 1
 uu_2                 4.100685e-02 1 1  ON 2
 uu_3                -2.087876e-02 1 1  ON 3
 uu_4                -6.551270e-02 1 1  ON 4
 uu_5                -9.898831e-02 1 1  ON 5
 uu_6                -1.249164e-01 1 1  ON 6
 uu_7                -1.369789e-01 1 1  ON 7
 uu_8                -1.288115e-01 1 1  ON 8
 uu_9                -9.714454e-02 1 1  ON 9
 ud_0                 4.453537e-01 1 1  ON 10
 ud_1                 1.798033e-01 1 1  ON 11
 ud_2                 5.939815e-02 1 1  ON 12
 ud_3                -1.117185e-02 1 1  ON 13
 ud_4                -6.726697e-02 1 1  ON 14
 ud_5                -1.076430e-01 1 1  ON 15
 ud_6                -1.342495e-01 1 1  ON 16
 ud_7                -1.491954e-01 1 1  ON 17
 ud_8                -1.498257e-01 1 1  ON 18
 ud_9                -1.387780e-01 1 1  ON 19
 eO_0                -7.548753e-01 1 1  ON 20
 eO_1                -4.344123e-01 1 1  ON 21
 eO_2                -1.793188e-02 1 1  ON 22
 eO_3                 2.971945e-01 1 1  ON 23
 eO_4                 5.174711e-01 1 1  ON 24
 eO_5                 4.743230e-01 1 1  ON 25
 eO_6                 2.445103e-01 1 1  ON 26
 eO_7                -5.057463e-02 1 1  ON 27
 eO_8                -2.083832e-01 1 1  ON 28
 eO_9                -6.880566e-02 1 1  ON 29
eH1_0                -2.402703e-01 1 1  ON 30
eH1_1                -1.389717e-01 1 1  ON 31
eH1_2                -9.183369e-02 1 1  ON 32
eH1_3                -3.777927e-02 1 1  ON 33
eH1_4                 1.065929e-02 1 1  ON 34
eH1_5                 4.367803e-02 1 1  ON 35
eH1_6                 9.985326e-02 1 1  ON 36
eH1_7                 1.481207e-01 1 1  ON 37
eH1_8                 1.628195e-01 1 1  ON 38
eH1_9                 4.774297e-02 1 1  ON 39
eH2_0                -2.366093e-01 1 1  ON 40
eH2_1                -1.356781e-01 1 1  ON 41
eH2_2                -8.828587e-02 1 1  ON 42
eH2_3                -3.442294e-02 1 1  ON 43
eH2_4                 1.342283e-02 1 1  ON 44
eH2_5                 4.709585e-02 1 1  ON 45
eH2_6                 1.036258e-01 1 1  ON 46
eH2_7                 1.501367e-01 1 1  ON 47
eH2_8                 1.668110e-01 1 1  ON 48
eH2_9                 3.135314e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.8859
    reference variance = 0.292741
====================================================
  Execution time = 1.9929e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3317e-01
  Total weights = 2.0000e+06
  Execution time = 1.8849e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333146312786
                                         uncertainty =       0.003541925614

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333146312786
                                         uncertainty =       0.003541925614

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408150539
  error estimate for blocks of size 2^( 2) =       0.000420671430
  error estimate for blocks of size 2^( 3) =       0.000433860726
  error estimate for blocks of size 2^( 4) =       0.000444975817
  error estimate for blocks of size 2^( 5) =       0.000455347474
  error estimate for blocks of size 2^( 6) =       0.000462435555
  error estimate for blocks of size 2^( 7) =       0.000467875937

      target function =                  N/A
              le_mean =     -16.904969306244
             les_mean =     286.111160804093
             stat err =       0.000457658696
             autocorr =       1.257310919524
              std dev =       0.577212028316
             le_variance =       0.333173725633

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333146312751
                                         uncertainty =       0.003541925614

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333146312751
                                         uncertainty =       0.003541925614

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408150539
  error estimate for blocks of size 2^( 2) =       0.000420671430
  error estimate for blocks of size 2^( 3) =       0.000433860726
  error estimate for blocks of size 2^( 4) =       0.000444975817
  error estimate for blocks of size 2^( 5) =       0.000455347474
  error estimate for blocks of size 2^( 6) =       0.000462435555
  error estimate for blocks of size 2^( 7) =       0.000467875937

      target function =                  N/A
              le_mean =     -16.904969306243
             les_mean =     286.111160804021
             stat err =       0.000457658696
             autocorr =       1.257310919566
              std dev =       0.577212028286
             le_variance =       0.333173725598

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333146312769
                                         uncertainty =       0.003541925614

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333146312769
                                         uncertainty =       0.003541925614

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408150539
  error estimate for blocks of size 2^( 2) =       0.000420671430
  error estimate for blocks of size 2^( 3) =       0.000433860726
  error estimate for blocks of size 2^( 4) =       0.000444975817
  error estimate for blocks of size 2^( 5) =       0.000455347474
  error estimate for blocks of size 2^( 6) =       0.000462435555
  error estimate for blocks of size 2^( 7) =       0.000467875937

      target function =                  N/A
              le_mean =     -16.904969306243
             les_mean =     286.111160804057
             stat err =       0.000457658696
             autocorr =       1.257310919550
              std dev =       0.577212028301
             le_variance =       0.333173725615

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333146312784
                                         uncertainty =       0.003541925614

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333146312784
                                         uncertainty =       0.003541925614

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408150539
  error estimate for blocks of size 2^( 2) =       0.000420671430
  error estimate for blocks of size 2^( 3) =       0.000433860726
  error estimate for blocks of size 2^( 4) =       0.000444975817
  error estimate for blocks of size 2^( 5) =       0.000455347474
  error estimate for blocks of size 2^( 6) =       0.000462435555
  error estimate for blocks of size 2^( 7) =       0.000467875937

      target function =                  N/A
              le_mean =     -16.904969306244
             les_mean =     286.111160804089
             stat err =       0.000457658696
             autocorr =       1.257310919527
              std dev =       0.577212028314
             le_variance =       0.333173725631


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904969306244        initial  <--
     9.0949e+05     9.0949e+06             2.5115e-10       -16.904969306243
     3.6380e+06     3.6380e+07             6.2788e-11       -16.904969306243
     1.4552e+07     1.4552e+08             1.5697e-11       -16.904969306244

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.4353
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.089013e-01 1 1  ON 0
 uu_1                 1.423322e-01 1 1  ON 1
 uu_2                 4.100685e-02 1 1  ON 2
 uu_3                -2.087876e-02 1 1  ON 3
 uu_4                -6.551270e-02 1 1  ON 4
 uu_5                -9.898831e-02 1 1  ON 5
 uu_6                -1.249164e-01 1 1  ON 6
 uu_7                -1.369789e-01 1 1  ON 7
 uu_8                -1.288115e-01 1 1  ON 8
 uu_9                -9.714454e-02 1 1  ON 9
 ud_0                 4.453537e-01 1 1  ON 10
 ud_1                 1.798033e-01 1 1  ON 11
 ud_2                 5.939815e-02 1 1  ON 12
 ud_3                -1.117185e-02 1 1  ON 13
 ud_4                -6.726697e-02 1 1  ON 14
 ud_5                -1.076430e-01 1 1  ON 15
 ud_6                -1.342495e-01 1 1  ON 16
 ud_7                -1.491954e-01 1 1  ON 17
 ud_8                -1.498257e-01 1 1  ON 18
 ud_9                -1.387780e-01 1 1  ON 19
 eO_0                -7.548753e-01 1 1  ON 20
 eO_1                -4.344123e-01 1 1  ON 21
 eO_2                -1.793188e-02 1 1  ON 22
 eO_3                 2.971945e-01 1 1  ON 23
 eO_4                 5.174711e-01 1 1  ON 24
 eO_5                 4.743230e-01 1 1  ON 25
 eO_6                 2.445103e-01 1 1  ON 26
 eO_7                -5.057463e-02 1 1  ON 27
 eO_8                -2.083832e-01 1 1  ON 28
 eO_9                -6.880566e-02 1 1  ON 29
eH1_0                -2.402703e-01 1 1  ON 30
eH1_1                -1.389717e-01 1 1  ON 31
eH1_2                -9.183369e-02 1 1  ON 32
eH1_3                -3.777927e-02 1 1  ON 33
eH1_4                 1.065929e-02 1 1  ON 34
eH1_5                 4.367803e-02 1 1  ON 35
eH1_6                 9.985326e-02 1 1  ON 36
eH1_7                 1.481207e-01 1 1  ON 37
eH1_8                 1.628195e-01 1 1  ON 38
eH1_9                 4.774297e-02 1 1  ON 39
eH2_0                -2.366093e-01 1 1  ON 40
eH2_1                -1.356781e-01 1 1  ON 41
eH2_2                -8.828587e-02 1 1  ON 42
eH2_3                -3.442294e-02 1 1  ON 43
eH2_4                 1.342283e-02 1 1  ON 44
eH2_5                 4.709585e-02 1 1  ON 45
eH2_6                 1.036258e-01 1 1  ON 46
eH2_7                 1.501367e-01 1 1  ON 47
eH2_8                 1.668110e-01 1 1  ON 48
eH2_9                 3.135314e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5227e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.894
    reference variance = 0.174247
====================================================
  Execution time = 2.0248e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3338e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4796e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333406955183
                                         uncertainty =       0.002856427974

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333406955183
                                         uncertainty =       0.002856427974

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408276845
  error estimate for blocks of size 2^( 2) =       0.000421267666
  error estimate for blocks of size 2^( 3) =       0.000434555744
  error estimate for blocks of size 2^( 4) =       0.000447766231
  error estimate for blocks of size 2^( 5) =       0.000459307651
  error estimate for blocks of size 2^( 6) =       0.000468708747
  error estimate for blocks of size 2^( 7) =       0.000474397518

      target function =                  N/A
              le_mean =     -16.905510254801
             les_mean =     286.129656772082
             stat err =       0.000462545037
             autocorr =       1.283507914371
              std dev =       0.577390650763
             le_variance =       0.333379963588


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690551025480e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+06, overlap shift 9.0949e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905510254801       residual = 4.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905510254801       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905510254801       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905510254644       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905510257034       residual = 5.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905510252456       residual = 7.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905510252787       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905510255806       residual = 3.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+06 is 3.068636e-11

solving harmonic davidson linear method for identity shift 3.6380e+07, overlap shift 3.6380e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905510254801       residual = 4.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905510254801       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905510254801       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905510275165       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905510243633       residual = 5.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905510266816       residual = 7.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905510262916       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905510227951       residual = 3.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+07 is 7.671552e-12

solving harmonic davidson linear method for identity shift 1.4552e+08, overlap shift 1.4552e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905510254801       residual = 4.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905510254801       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905510254801       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905510212606       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905510233974       residual = 5.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905510249196       residual = 7.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905510258934       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905510208538       residual = 3.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+08 is 1.917917e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.123251 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5734e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.089013e-01 1 1  ON 0
 uu_1                 1.423322e-01 1 1  ON 1
 uu_2                 4.100685e-02 1 1  ON 2
 uu_3                -2.087876e-02 1 1  ON 3
 uu_4                -6.551270e-02 1 1  ON 4
 uu_5                -9.898831e-02 1 1  ON 5
 uu_6                -1.249164e-01 1 1  ON 6
 uu_7                -1.369789e-01 1 1  ON 7
 uu_8                -1.288115e-01 1 1  ON 8
 uu_9                -9.714454e-02 1 1  ON 9
 ud_0                 4.453537e-01 1 1  ON 10
 ud_1                 1.798033e-01 1 1  ON 11
 ud_2                 5.939815e-02 1 1  ON 12
 ud_3                -1.117185e-02 1 1  ON 13
 ud_4                -6.726697e-02 1 1  ON 14
 ud_5                -1.076430e-01 1 1  ON 15
 ud_6                -1.342495e-01 1 1  ON 16
 ud_7                -1.491954e-01 1 1  ON 17
 ud_8                -1.498257e-01 1 1  ON 18
 ud_9                -1.387780e-01 1 1  ON 19
 eO_0                -7.548753e-01 1 1  ON 20
 eO_1                -4.344123e-01 1 1  ON 21
 eO_2                -1.793188e-02 1 1  ON 22
 eO_3                 2.971945e-01 1 1  ON 23
 eO_4                 5.174711e-01 1 1  ON 24
 eO_5                 4.743230e-01 1 1  ON 25
 eO_6                 2.445103e-01 1 1  ON 26
 eO_7                -5.057463e-02 1 1  ON 27
 eO_8                -2.083832e-01 1 1  ON 28
 eO_9                -6.880566e-02 1 1  ON 29
eH1_0                -2.402703e-01 1 1  ON 30
eH1_1                -1.389717e-01 1 1  ON 31
eH1_2                -9.183369e-02 1 1  ON 32
eH1_3                -3.777927e-02 1 1  ON 33
eH1_4                 1.065929e-02 1 1  ON 34
eH1_5                 4.367803e-02 1 1  ON 35
eH1_6                 9.985326e-02 1 1  ON 36
eH1_7                 1.481207e-01 1 1  ON 37
eH1_8                 1.628195e-01 1 1  ON 38
eH1_9                 4.774297e-02 1 1  ON 39
eH2_0                -2.366093e-01 1 1  ON 40
eH2_1                -1.356781e-01 1 1  ON 41
eH2_2                -8.828587e-02 1 1  ON 42
eH2_3                -3.442294e-02 1 1  ON 43
eH2_4                 1.342283e-02 1 1  ON 44
eH2_5                 4.709585e-02 1 1  ON 45
eH2_6                 1.036258e-01 1 1  ON 46
eH2_7                 1.501367e-01 1 1  ON 47
eH2_8                 1.668110e-01 1 1  ON 48
eH2_9                 3.135314e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.8159
    reference variance = 0.229948
====================================================
  Execution time = 2.0126e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4457e-01
  Total weights = 2.0000e+06
  Execution time = 1.8784e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344647383878
                                         uncertainty =       0.005425727956

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344647383878
                                         uncertainty =       0.005425727956

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415072987
  error estimate for blocks of size 2^( 2) =       0.000427547569
  error estimate for blocks of size 2^( 3) =       0.000440176671
  error estimate for blocks of size 2^( 4) =       0.000452671367
  error estimate for blocks of size 2^( 5) =       0.000463943325
  error estimate for blocks of size 2^( 6) =       0.000471885286
  error estimate for blocks of size 2^( 7) =       0.000477753041

      target function =                  N/A
              le_mean =     -16.905787082425
             les_mean =     286.150207873302
             stat err =       0.000466563255
             autocorr =       1.263490913295
              std dev =       0.587001847791
             le_variance =       0.344571169310

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344647383875
                                         uncertainty =       0.005425727955

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344647383875
                                         uncertainty =       0.005425727955

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415072987
  error estimate for blocks of size 2^( 2) =       0.000427547569
  error estimate for blocks of size 2^( 3) =       0.000440176671
  error estimate for blocks of size 2^( 4) =       0.000452671367
  error estimate for blocks of size 2^( 5) =       0.000463943325
  error estimate for blocks of size 2^( 6) =       0.000471885286
  error estimate for blocks of size 2^( 7) =       0.000477753041

      target function =                  N/A
              le_mean =     -16.905787082425
             les_mean =     286.150207873300
             stat err =       0.000466563255
             autocorr =       1.263490913298
              std dev =       0.587001847789
             le_variance =       0.344571169308

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344647383876
                                         uncertainty =       0.005425727956

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344647383876
                                         uncertainty =       0.005425727956

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415072987
  error estimate for blocks of size 2^( 2) =       0.000427547569
  error estimate for blocks of size 2^( 3) =       0.000440176671
  error estimate for blocks of size 2^( 4) =       0.000452671367
  error estimate for blocks of size 2^( 5) =       0.000463943325
  error estimate for blocks of size 2^( 6) =       0.000471885286
  error estimate for blocks of size 2^( 7) =       0.000477753041

      target function =                  N/A
              le_mean =     -16.905787082425
             les_mean =     286.150207873301
             stat err =       0.000466563255
             autocorr =       1.263490913307
              std dev =       0.587001847790
             le_variance =       0.344571169309

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344647383878
                                         uncertainty =       0.005425727956

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344647383878
                                         uncertainty =       0.005425727956

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415072987
  error estimate for blocks of size 2^( 2) =       0.000427547569
  error estimate for blocks of size 2^( 3) =       0.000440176671
  error estimate for blocks of size 2^( 4) =       0.000452671367
  error estimate for blocks of size 2^( 5) =       0.000463943325
  error estimate for blocks of size 2^( 6) =       0.000471885286
  error estimate for blocks of size 2^( 7) =       0.000477753041

      target function =                  N/A
              le_mean =     -16.905787082425
             les_mean =     286.150207873302
             stat err =       0.000466563255
             autocorr =       1.263490913307
              std dev =       0.587001847791
             le_variance =       0.344571169310


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905787082425        initial
     9.0949e+06     9.0949e+07             3.0686e-11       -16.905787082425  <--
     3.6380e+07     3.6380e+08             7.6716e-12       -16.905787082425
     1.4552e+08     1.4552e+09             1.9179e-12       -16.905787082425

*****************************************************************************
Applying the update for shift_i =   9.0949e+06     and shift_s =   9.0949e+07
*****************************************************************************

  Execution time = 2.9589e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.089013e-01 1 1  ON 0
 uu_1                 1.423322e-01 1 1  ON 1
 uu_2                 4.100685e-02 1 1  ON 2
 uu_3                -2.087876e-02 1 1  ON 3
 uu_4                -6.551270e-02 1 1  ON 4
 uu_5                -9.898831e-02 1 1  ON 5
 uu_6                -1.249164e-01 1 1  ON 6
 uu_7                -1.369789e-01 1 1  ON 7
 uu_8                -1.288115e-01 1 1  ON 8
 uu_9                -9.714454e-02 1 1  ON 9
 ud_0                 4.453537e-01 1 1  ON 10
 ud_1                 1.798033e-01 1 1  ON 11
 ud_2                 5.939815e-02 1 1  ON 12
 ud_3                -1.117185e-02 1 1  ON 13
 ud_4                -6.726697e-02 1 1  ON 14
 ud_5                -1.076430e-01 1 1  ON 15
 ud_6                -1.342495e-01 1 1  ON 16
 ud_7                -1.491954e-01 1 1  ON 17
 ud_8                -1.498257e-01 1 1  ON 18
 ud_9                -1.387780e-01 1 1  ON 19
 eO_0                -7.548753e-01 1 1  ON 20
 eO_1                -4.344123e-01 1 1  ON 21
 eO_2                -1.793188e-02 1 1  ON 22
 eO_3                 2.971945e-01 1 1  ON 23
 eO_4                 5.174711e-01 1 1  ON 24
 eO_5                 4.743230e-01 1 1  ON 25
 eO_6                 2.445103e-01 1 1  ON 26
 eO_7                -5.057463e-02 1 1  ON 27
 eO_8                -2.083832e-01 1 1  ON 28
 eO_9                -6.880566e-02 1 1  ON 29
eH1_0                -2.402703e-01 1 1  ON 30
eH1_1                -1.389717e-01 1 1  ON 31
eH1_2                -9.183369e-02 1 1  ON 32
eH1_3                -3.777927e-02 1 1  ON 33
eH1_4                 1.065929e-02 1 1  ON 34
eH1_5                 4.367803e-02 1 1  ON 35
eH1_6                 9.985326e-02 1 1  ON 36
eH1_7                 1.481207e-01 1 1  ON 37
eH1_8                 1.628195e-01 1 1  ON 38
eH1_9                 4.774297e-02 1 1  ON 39
eH2_0                -2.366093e-01 1 1  ON 40
eH2_1                -1.356781e-01 1 1  ON 41
eH2_2                -8.828587e-02 1 1  ON 42
eH2_3                -3.442294e-02 1 1  ON 43
eH2_4                 1.342283e-02 1 1  ON 44
eH2_5                 4.709585e-02 1 1  ON 45
eH2_6                 1.036258e-01 1 1  ON 46
eH2_7                 1.501367e-01 1 1  ON 47
eH2_8                 1.668110e-01 1 1  ON 48
eH2_9                 3.135314e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5327e+01 secs
  Total Execution time = 2.2588e+03 secs

=========================================================
  A new xml input file : H2O.s039.cont.xml
