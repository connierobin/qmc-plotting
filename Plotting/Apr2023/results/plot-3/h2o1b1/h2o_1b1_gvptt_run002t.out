Rank =    0  Free Memory = 84665 MB
Rank =    1  Free Memory = 84665 MB
Rank =    2  Free Memory = 84665 MB
Rank =    3  Free Memory = 84665 MB
Rank =    4  Free Memory = 84665 MB
Rank =    5  Free Memory = 84665 MB
Rank =    6  Free Memory = 84665 MB
Rank =    7  Free Memory = 84665 MB
Rank =    8  Free Memory = 84664 MB
Rank =    9  Free Memory = 84664 MB
Rank =   10  Free Memory = 84664 MB
Rank =   11  Free Memory = 84664 MB
Rank =   12  Free Memory = 84664 MB
Rank =   13  Free Memory = 84664 MB
Rank =   14  Free Memory = 84664 MB
Rank =   15  Free Memory = 84650 MB
Rank =   16  Free Memory = 84649 MB
Rank =   17  Free Memory = 84649 MB
Rank =   18  Free Memory = 84649 MB
Rank =   19  Free Memory = 84649 MB
Rank =   20  Free Memory = 84649 MB
Rank =   21  Free Memory = 84649 MB
Rank =   22  Free Memory = 84649 MB
Rank =   23  Free Memory = 84649 MB
Rank =   24  Free Memory = 84649 MB
Rank =   25  Free Memory = 84649 MB
Rank =   26  Free Memory = 84649 MB
Rank =   27  Free Memory = 84649 MB
Rank =   28  Free Memory = 84649 MB
Rank =   29  Free Memory = 84649 MB
Rank =   30  Free Memory = 84649 MB
Rank =   31  Free Memory = 84649 MB
Rank =   32  Free Memory = 85120 MB
Rank =   33  Free Memory = 85120 MB
Rank =   34  Free Memory = 85119 MB
Rank =   35  Free Memory = 85119 MB
Rank =   36  Free Memory = 85119 MB
Rank =   37  Free Memory = 85119 MB
Rank =   38  Free Memory = 85119 MB
Rank =   39  Free Memory = 85119 MB
Rank =   40  Free Memory = 85119 MB
Rank =   41  Free Memory = 85119 MB
Rank =   42  Free Memory = 85119 MB
Rank =   43  Free Memory = 85119 MB
Rank =   44  Free Memory = 85119 MB
Rank =   45  Free Memory = 85119 MB
Rank =   46  Free Memory = 85119 MB
Rank =   47  Free Memory = 85119 MB
Rank =   48  Free Memory = 85119 MB
Rank =   49  Free Memory = 85119 MB
Rank =   50  Free Memory = 85119 MB
Rank =   51  Free Memory = 85119 MB
Rank =   52  Free Memory = 85119 MB
Rank =   53  Free Memory = 85119 MB
Rank =   54  Free Memory = 85119 MB
Rank =   55  Free Memory = 85119 MB
Rank =   56  Free Memory = 85119 MB
Rank =   57  Free Memory = 85119 MB
Rank =   58  Free Memory = 85119 MB
Rank =   59  Free Memory = 85119 MB
Rank =   60  Free Memory = 85119 MB
Rank =   61  Free Memory = 85119 MB
Rank =   62  Free Memory = 85119 MB
Rank =   63  Free Memory = 85119 MB
Rank =   64  Free Memory = 81066 MB
Rank =   65  Free Memory = 81066 MB
Rank =   66  Free Memory = 81066 MB
Rank =   67  Free Memory = 81066 MB
Rank =   68  Free Memory = 81066 MB
Rank =   69  Free Memory = 81066 MB
Rank =   70  Free Memory = 81066 MB
Rank =   71  Free Memory = 81066 MB
Rank =   72  Free Memory = 81066 MB
Rank =   73  Free Memory = 81066 MB
Rank =   74  Free Memory = 81066 MB
Rank =   75  Free Memory = 81066 MB
Rank =   76  Free Memory = 81066 MB
Rank =   77  Free Memory = 81066 MB
Rank =   78  Free Memory = 81066 MB
Rank =   79  Free Memory = 81066 MB
Rank =   80  Free Memory = 81066 MB
Rank =   81  Free Memory = 81066 MB
Rank =   82  Free Memory = 81066 MB
Rank =   83  Free Memory = 81066 MB
Rank =   84  Free Memory = 81066 MB
Rank =   85  Free Memory = 81066 MB
Rank =   86  Free Memory = 81066 MB
Rank =   87  Free Memory = 81066 MB
Rank =   88  Free Memory = 81066 MB
Rank =   89  Free Memory = 81066 MB
Rank =   90  Free Memory = 81066 MB
Rank =   91  Free Memory = 81066 MB
Rank =   92  Free Memory = 81066 MB
Rank =   93  Free Memory = 81066 MB
Rank =   94  Free Memory = 81066 MB
Rank =   95  Free Memory = 81066 MB
Rank =   96  Free Memory = 84060 MB
Rank =   97  Free Memory = 84060 MB
Rank =   98  Free Memory = 84060 MB
Rank =   99  Free Memory = 84060 MB
Rank =  100  Free Memory = 84060 MB
Rank =  101  Free Memory = 84060 MB
Rank =  102  Free Memory = 84060 MB
Rank =  103  Free Memory = 84060 MB
Rank =  104  Free Memory = 84060 MB
Rank =  105  Free Memory = 84060 MB
Rank =  106  Free Memory = 84060 MB
Rank =  107  Free Memory = 84060 MB
Rank =  108  Free Memory = 84060 MB
Rank =  109  Free Memory = 84060 MB
Rank =  110  Free Memory = 84060 MB
Rank =  111  Free Memory = 84060 MB
Rank =  112  Free Memory = 84060 MB
Rank =  113  Free Memory = 84060 MB
Rank =  114  Free Memory = 84060 MB
Rank =  115  Free Memory = 84060 MB
Rank =  116  Free Memory = 84060 MB
Rank =  117  Free Memory = 84060 MB
Rank =  118  Free Memory = 84060 MB
Rank =  119  Free Memory = 84060 MB
Rank =  120  Free Memory = 84060 MB
Rank =  121  Free Memory = 84060 MB
Rank =  122  Free Memory = 84060 MB
Rank =  123  Free Memory = 84060 MB
Rank =  124  Free Memory = 84060 MB
Rank =  125  Free Memory = 84060 MB
Rank =  126  Free Memory = 84060 MB
Rank =  127  Free Memory = 84060 MB
  Input file(s): opt_h2o_1b1_gvptt_run002t.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: 39b7557df04c29964085ccccce933740e3918067-dirty
  Last git commit date: Wed Mar 22 11:37:25 2023 -0700
  Last git commit subject: deleting more debugging statements
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_1b1_gvptt_run002t.xml

  Project = H2O
  date    = 2023-04-24 10:53:27 PDT
  host    = n0110.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 535

  Range of prime numbers to use as seeds over processors and threads = 3877-4969


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 3.095201e-01    1         1  ON     0
     uu_1                 1.426108e-01    1         1  ON     1
     uu_2                 4.075731e-02    1         1  ON     2
     uu_3                -2.192554e-02    1         1  ON     3
     uu_4                -6.789597e-02    1         1  ON     4
     uu_5                -1.031887e-01    1         1  ON     5
     uu_6                -1.316344e-01    1         1  ON     6
     uu_7                -1.460961e-01    1         1  ON     7
     uu_8                -1.390784e-01    1         1  ON     8
     uu_9                -1.111890e-01    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 4.545888e-01    1         1  ON     0
     ud_1                 1.880161e-01    1         1  ON     1
     ud_2                 6.646956e-02    1         1  ON     2
     ud_3                -5.659344e-03    1         1  ON     3
     ud_4                -6.327304e-02    1         1  ON     4
     ud_5                -1.055939e-01    1         1  ON     5
     ud_6                -1.337190e-01    1         1  ON     6
     ud_7                -1.515868e-01    1         1  ON     7
     ud_8                -1.531793e-01    1         1  ON     8
     ud_9                -1.455855e-01    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -7.642936e-01    1         1  ON     0
     eO_1                -4.409103e-01    1         1  ON     1
     eO_2                -1.727579e-02    1         1  ON     2
     eO_3                 3.069134e-01    1         1  ON     3
     eO_4                 5.353363e-01    1         1  ON     4
     eO_5                 4.991968e-01    1         1  ON     5
     eO_6                 2.693994e-01    1         1  ON     6
     eO_7                -3.700597e-02    1         1  ON     7
     eO_8                -2.392365e-01    1         1  ON     8
     eO_9                -1.073131e-01    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -2.554777e-01    1         1  ON     0
     eH1_1                -1.538082e-01    1         1  ON     1
     eH1_2                -1.066395e-01    1         1  ON     2
     eH1_3                -5.187002e-02    1         1  ON     3
     eH1_4                -3.344801e-03    1         1  ON     4
     eH1_5                 3.232526e-02    1         1  ON     5
     eH1_6                 9.351291e-02    1         1  ON     6
     eH1_7                 1.549206e-01    1         1  ON     7
     eH1_8                 1.944978e-01    1         1  ON     8
     eH1_9                 9.520282e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -2.525027e-01    1         1  ON     0
     eH2_1                -1.512111e-01    1         1  ON     1
     eH2_2                -1.037652e-01    1         1  ON     2
     eH2_3                -4.918115e-02    1         1  ON     3
     eH2_4                -9.034138e-04    1         1  ON     4
     eH2_5                 3.398438e-02    1         1  ON     5
     eH2_6                 9.533144e-02    1         1  ON     6
     eH2_7                 1.555806e-01    1         1  ON     7
     eH2_8                 1.975736e-01    1         1  ON     8
     eH2_9                 8.840239e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 75 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 2.237737e+00
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 30 unique up determinants.
Found 30 unique down determinants.
Number of terms in pairs array: 20
Number of terms in pairs array: 20
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 3.7109e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u  6.1002844054e-01  1.3250453608e-01 -4.2267217978e-01
    u -4.3494847795e-01 -2.3203549626e-01  1.0876787134e-01
    u -1.5984350305e-01  8.1842956548e-01  5.1837161342e-02
    u  1.1948334779e+00  1.4453040952e+00  1.6346730752e+00
    d -9.5054657961e-01  2.3768909128e-01 -6.0876959125e-01
    d -2.0429807517e-01  1.5546410594e+00 -1.0292769217e-01
    d  4.7451519973e-01  3.4811618685e-02  3.5425821429e-01
    d -8.6403568621e-02 -1.8286319639e+00  9.9844026831e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 50
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.9009
    reference variance = 0.27014
====================================================
  Execution time = 2.0737e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3364e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4704e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333699598726
                                         uncertainty =       0.002870555807

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333699598726
                                         uncertainty =       0.002870555807

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408437034
  error estimate for blocks of size 2^( 2) =       0.000421699720
  error estimate for blocks of size 2^( 3) =       0.000435405263
  error estimate for blocks of size 2^( 4) =       0.000447297936
  error estimate for blocks of size 2^( 5) =       0.000458126712
  error estimate for blocks of size 2^( 6) =       0.000466685401
  error estimate for blocks of size 2^( 7) =       0.000472413089

      target function =                  N/A
              le_mean =     -16.904736747194
             les_mean =     286.103765945837
             stat err =       0.000461130784
             autocorr =       1.274670707706
              std dev =       0.577617192199
             le_variance =       0.333641620724


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.690473674719e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904736747194       residual = 7.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904737992988       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904738147731       residual = 9.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904738722508       residual = 6.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904738553680       residual = 4.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904739348209       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904739355421       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904739753431       residual = 5.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.904739502494       residual = 1.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.904739492038       residual = 7.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 8.204520e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904736747194       residual = 7.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904737212497       residual = 3.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904737442098       residual = 7.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904737329307       residual = 4.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904737580290       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904737720148       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904737653872       residual = 4.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904737744616       residual = 9.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 2.012961e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904736747194       residual = 7.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904736879910       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904736971770       residual = 6.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904736898563       residual = 5.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904736995901       residual = 2.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904736997030       residual = 7.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904737017610       residual = 2.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904737028418       residual = 5.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+00 is 5.140469e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.117798 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6330e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0  3.096003e-01                 1 1 ON  0
uu_1  1.426752e-01                 1 1 ON  1
uu_2  4.073589e-02                 1 1 ON  2
uu_3  -2.198788e-02                1 1 ON  3
uu_4  -6.792701e-02                1 1 ON  4
uu_5  -1.033112e-01                1 1 ON  5
uu_6  -1.316557e-01                1 1 ON  6
uu_7  -1.461721e-01                1 1 ON  7
uu_8  -1.389903e-01                1 1 ON  8
uu_9  -1.112200e-01                1 1 ON  9
ud_0  4.545172e-01                 1 1 ON  10
ud_1  1.880042e-01                 1 1 ON  11
ud_2  6.647061e-02                 1 1 ON  12
ud_3  -5.616754e-03                1 1 ON  13
ud_4  -6.337145e-02                1 1 ON  14
ud_5  -1.056151e-01                1 1 ON  15
ud_6  -1.338227e-01                1 1 ON  16
ud_7  -1.515751e-01                1 1 ON  17
ud_8  -1.530254e-01                1 1 ON  18
ud_9  -1.454981e-01                1 1 ON  19
eO_0  -7.641582e-01                1 1 ON  20
eO_1  -4.409561e-01                1 1 ON  21
eO_2  -1.734524e-02                1 1 ON  22
eO_3  3.069241e-01                 1 1 ON  23
eO_4  5.354074e-01                 1 1 ON  24
eO_5  4.992251e-01                 1 1 ON  25
eO_6  2.694227e-01                 1 1 ON  26
eO_7  -3.702096e-02                1 1 ON  27
eO_8  -2.392432e-01                1 1 ON  28
eO_9  -1.074203e-01                1 1 ON  29
eH1_0 -2.555738e-01                1 1 ON  30
eH1_1 -1.539931e-01                1 1 ON  31
eH1_2 -1.066964e-01                1 1 ON  32
eH1_3 -5.192200e-02                1 1 ON  33
eH1_4 -3.287786e-03                1 1 ON  34
eH1_5 3.233928e-02                 1 1 ON  35
eH1_6 9.356284e-02                 1 1 ON  36
eH1_7 1.550067e-01                 1 1 ON  37
eH1_8 1.945160e-01                 1 1 ON  38
eH1_9 9.533030e-02                 1 1 ON  39
eH2_0 -2.525732e-01                1 1 ON  40
eH2_1 -1.512616e-01                1 1 ON  41
eH2_2 -1.038424e-01                1 1 ON  42
eH2_3 -4.920622e-02                1 1 ON  43
eH2_4 -8.926874e-04                1 1 ON  44
eH2_5 3.388476e-02                 1 1 ON  45
eH2_6 9.538096e-02                 1 1 ON  46
eH2_7 1.555455e-01                 1 1 ON  47
eH2_8 1.976392e-01                 1 1 ON  48
eH2_9 8.860368e-02                 1 1 ON  49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.8051
    reference variance = 0.253855
====================================================
  Execution time = 2.0255e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3659e-01
  Total weights = 2.0000e+06
  Execution time = 1.8951e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336712873003
                                         uncertainty =       0.003303939997

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336712873003
                                         uncertainty =       0.003303939997

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410249915
  error estimate for blocks of size 2^( 2) =       0.000422986112
  error estimate for blocks of size 2^( 3) =       0.000436080041
  error estimate for blocks of size 2^( 4) =       0.000448664939
  error estimate for blocks of size 2^( 5) =       0.000457999532
  error estimate for blocks of size 2^( 6) =       0.000466163534
  error estimate for blocks of size 2^( 7) =       0.000468765466

      target function =                  N/A
              le_mean =     -16.905475450933
             les_mean =     286.131710039340
             stat err =       0.000460398368
             autocorr =       1.259419900173
              std dev =       0.580180993781
             le_variance =       0.336609985544

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336688937824
                                         uncertainty =       0.003304450846

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336688937824
                                         uncertainty =       0.003304450846

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410235332
  error estimate for blocks of size 2^( 2) =       0.000422974341
  error estimate for blocks of size 2^( 3) =       0.000436069147
  error estimate for blocks of size 2^( 4) =       0.000448660374
  error estimate for blocks of size 2^( 5) =       0.000457996279
  error estimate for blocks of size 2^( 6) =       0.000466156473
  error estimate for blocks of size 2^( 7) =       0.000468756571

      target function =                  N/A
              le_mean =     -16.905474007494
             les_mean =     286.131637305641
             stat err =       0.000460392424
             autocorr =       1.259476918759
              std dev =       0.580160370819
             le_variance =       0.336586055868

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336670081167
                                         uncertainty =       0.003303836315

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336670081167
                                         uncertainty =       0.003303836315

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410223846
  error estimate for blocks of size 2^( 2) =       0.000422962644
  error estimate for blocks of size 2^( 3) =       0.000436057599
  error estimate for blocks of size 2^( 4) =       0.000448648242
  error estimate for blocks of size 2^( 5) =       0.000457984931
  error estimate for blocks of size 2^( 6) =       0.000466145682
  error estimate for blocks of size 2^( 7) =       0.000468746723

      target function =                  N/A
              le_mean =     -16.905473473624
             les_mean =     286.131600406973
             stat err =       0.000460381395
             autocorr =       1.259487100692
              std dev =       0.580144126797
             le_variance =       0.336567207857

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336706349539
                                         uncertainty =       0.003303922929

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336706349539
                                         uncertainty =       0.003303922929

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410245941
  error estimate for blocks of size 2^( 2) =       0.000422982482
  error estimate for blocks of size 2^( 3) =       0.000436076513
  error estimate for blocks of size 2^( 4) =       0.000448662305
  error estimate for blocks of size 2^( 5) =       0.000457997217
  error estimate for blocks of size 2^( 6) =       0.000466160750
  error estimate for blocks of size 2^( 7) =       0.000468762615

      target function =                  N/A
              le_mean =     -16.905475073011
             les_mean =     286.131690739856
             stat err =       0.000460395721
             autocorr =       1.259429821699
              std dev =       0.580175373458
             le_variance =       0.336603463967


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905475450933        initial  <--
     2.5000e-01     2.5000e+00             8.2045e-04       -16.905474007494
     1.0000e+00     1.0000e+01             2.0130e-04       -16.905473473624
     4.0000e+00     4.0000e+01             5.1405e-05       -16.905475073011

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7220
  </log>
  <optVariables href="H2O.s000.opt.xml">
 uu_0                 3.095201e-01 1 1  ON 0
 uu_1                 1.426108e-01 1 1  ON 1
 uu_2                 4.075731e-02 1 1  ON 2
 uu_3                -2.192554e-02 1 1  ON 3
 uu_4                -6.789597e-02 1 1  ON 4
 uu_5                -1.031887e-01 1 1  ON 5
 uu_6                -1.316344e-01 1 1  ON 6
 uu_7                -1.460961e-01 1 1  ON 7
 uu_8                -1.390784e-01 1 1  ON 8
 uu_9                -1.111890e-01 1 1  ON 9
 ud_0                 4.545888e-01 1 1  ON 10
 ud_1                 1.880161e-01 1 1  ON 11
 ud_2                 6.646956e-02 1 1  ON 12
 ud_3                -5.659344e-03 1 1  ON 13
 ud_4                -6.327304e-02 1 1  ON 14
 ud_5                -1.055939e-01 1 1  ON 15
 ud_6                -1.337190e-01 1 1  ON 16
 ud_7                -1.515868e-01 1 1  ON 17
 ud_8                -1.531793e-01 1 1  ON 18
 ud_9                -1.455855e-01 1 1  ON 19
 eO_0                -7.642936e-01 1 1  ON 20
 eO_1                -4.409103e-01 1 1  ON 21
 eO_2                -1.727579e-02 1 1  ON 22
 eO_3                 3.069134e-01 1 1  ON 23
 eO_4                 5.353363e-01 1 1  ON 24
 eO_5                 4.991968e-01 1 1  ON 25
 eO_6                 2.693994e-01 1 1  ON 26
 eO_7                -3.700597e-02 1 1  ON 27
 eO_8                -2.392365e-01 1 1  ON 28
 eO_9                -1.073131e-01 1 1  ON 29
eH1_0                -2.554777e-01 1 1  ON 30
eH1_1                -1.538082e-01 1 1  ON 31
eH1_2                -1.066395e-01 1 1  ON 32
eH1_3                -5.187002e-02 1 1  ON 33
eH1_4                -3.344801e-03 1 1  ON 34
eH1_5                 3.232526e-02 1 1  ON 35
eH1_6                 9.351291e-02 1 1  ON 36
eH1_7                 1.549206e-01 1 1  ON 37
eH1_8                 1.944978e-01 1 1  ON 38
eH1_9                 9.520282e-02 1 1  ON 39
eH2_0                -2.525027e-01 1 1  ON 40
eH2_1                -1.512111e-01 1 1  ON 41
eH2_2                -1.037652e-01 1 1  ON 42
eH2_3                -4.918115e-02 1 1  ON 43
eH2_4                -9.034138e-04 1 1  ON 44
eH2_5                 3.398438e-02 1 1  ON 45
eH2_6                 9.533144e-02 1 1  ON 46
eH2_7                 1.555806e-01 1 1  ON 47
eH2_8                 1.975736e-01 1 1  ON 48
eH2_9                 8.840239e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6071e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6853e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.8538
    reference variance = 0.232923
====================================================
  Execution time = 2.0684e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5070e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5481e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350746898807
                                         uncertainty =       0.009561228261

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350746898807
                                         uncertainty =       0.009561228261

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418745729
  error estimate for blocks of size 2^( 2) =       0.000432144786
  error estimate for blocks of size 2^( 3) =       0.000444891513
  error estimate for blocks of size 2^( 4) =       0.000457473631
  error estimate for blocks of size 2^( 5) =       0.000468484820
  error estimate for blocks of size 2^( 6) =       0.000475290064
  error estimate for blocks of size 2^( 7) =       0.000480915496

      target function =                  N/A
              le_mean =     -16.905677699950
             les_mean =     286.152634291113
             stat err =       0.000470541003
             autocorr =       1.262682511164
              std dev =       0.592195889784
             le_variance =       0.350695971877


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690567769995e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905677699950       residual = 8.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905677879493       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905677972493       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905678056201       residual = 5.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905678033114       residual = 2.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905677957270       residual = 4.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905678024712       residual = 1.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905678000727       residual = 4.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 7.602068e-05

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905677699950       residual = 8.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905677747238       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905677771688       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905677796756       residual = 5.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905677792223       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905677771976       residual = 3.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905677787983       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905677782600       residual = 3.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+01 is 1.910576e-05

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905677699950       residual = 8.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905677711932       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905677718130       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905677724695       residual = 4.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905677723652       residual = 2.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905677718515       residual = 3.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905677722447       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905677721142       residual = 2.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+01 is 4.782876e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.120566 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6239e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.095320e-01 1 1  ON 0
 uu_1                 1.426026e-01 1 1  ON 1
 uu_2                 4.075866e-02 1 1  ON 2
 uu_3                -2.192986e-02 1 1  ON 3
 uu_4                -6.789836e-02 1 1  ON 4
 uu_5                -1.031976e-01 1 1  ON 5
 uu_6                -1.316368e-01 1 1  ON 6
 uu_7                -1.460976e-01 1 1  ON 7
 uu_8                -1.390766e-01 1 1  ON 8
 uu_9                -1.111865e-01 1 1  ON 9
 ud_0                 4.545899e-01 1 1  ON 10
 ud_1                 1.880220e-01 1 1  ON 11
 ud_2                 6.647100e-02 1 1  ON 12
 ud_3                -5.665499e-03 1 1  ON 13
 ud_4                -6.328065e-02 1 1  ON 14
 ud_5                -1.055885e-01 1 1  ON 15
 ud_6                -1.337206e-01 1 1  ON 16
 ud_7                -1.515774e-01 1 1  ON 17
 ud_8                -1.531809e-01 1 1  ON 18
 ud_9                -1.455852e-01 1 1  ON 19
 eO_0                -7.642820e-01 1 1  ON 20
 eO_1                -4.409152e-01 1 1  ON 21
 eO_2                -1.728193e-02 1 1  ON 22
 eO_3                 3.069210e-01 1 1  ON 23
 eO_4                 5.353372e-01 1 1  ON 24
 eO_5                 4.992020e-01 1 1  ON 25
 eO_6                 2.694047e-01 1 1  ON 26
 eO_7                -3.699879e-02 1 1  ON 27
 eO_8                -2.392433e-01 1 1  ON 28
 eO_9                -1.073290e-01 1 1  ON 29
eH1_0                -2.554887e-01 1 1  ON 30
eH1_1                -1.538148e-01 1 1  ON 31
eH1_2                -1.066409e-01 1 1  ON 32
eH1_3                -5.187818e-02 1 1  ON 33
eH1_4                -3.339216e-03 1 1  ON 34
eH1_5                 3.231571e-02 1 1  ON 35
eH1_6                 9.351627e-02 1 1  ON 36
eH1_7                 1.549223e-01 1 1  ON 37
eH1_8                 1.945081e-01 1 1  ON 38
eH1_9                 9.521781e-02 1 1  ON 39
eH2_0                -2.525069e-01 1 1  ON 40
eH2_1                -1.512142e-01 1 1  ON 41
eH2_2                -1.037796e-01 1 1  ON 42
eH2_3                -4.918274e-02 1 1  ON 43
eH2_4                -9.024747e-04 1 1  ON 44
eH2_5                 3.398361e-02 1 1  ON 45
eH2_6                 9.532857e-02 1 1  ON 46
eH2_7                 1.555810e-01 1 1  ON 47
eH2_8                 1.975799e-01 1 1  ON 48
eH2_9                 8.842149e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.8376
    reference variance = 0.358498
====================================================
  Execution time = 2.0180e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3632e-01
  Total weights = 2.0000e+06
  Execution time = 1.8999e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336310546329
                                         uncertainty =       0.003050506107

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336310546329
                                         uncertainty =       0.003050506107

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410071470
  error estimate for blocks of size 2^( 2) =       0.000422724384
  error estimate for blocks of size 2^( 3) =       0.000436318538
  error estimate for blocks of size 2^( 4) =       0.000448348959
  error estimate for blocks of size 2^( 5) =       0.000458837976
  error estimate for blocks of size 2^( 6) =       0.000465307944
  error estimate for blocks of size 2^( 7) =       0.000469376053

      target function =                  N/A
              le_mean =     -16.906580928998
             les_mean =     286.168795762411
             stat err =       0.000460467733
             autocorr =       1.260896079466
              std dev =       0.579928635094
             le_variance =       0.336317221802

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336311041091
                                         uncertainty =       0.003050420002

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336311041091
                                         uncertainty =       0.003050420002

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410071746
  error estimate for blocks of size 2^( 2) =       0.000422724927
  error estimate for blocks of size 2^( 3) =       0.000436318668
  error estimate for blocks of size 2^( 4) =       0.000448348682
  error estimate for blocks of size 2^( 5) =       0.000458837355
  error estimate for blocks of size 2^( 6) =       0.000465307720
  error estimate for blocks of size 2^( 7) =       0.000469375615

      target function =                  N/A
              le_mean =     -16.906581089093
             les_mean =     286.168801627541
             stat err =       0.000460467343
             autocorr =       1.260892248773
              std dev =       0.579929024632
             le_variance =       0.336317673610

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336309682577
                                         uncertainty =       0.003050445864

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336309682577
                                         uncertainty =       0.003050445864

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410070929
  error estimate for blocks of size 2^( 2) =       0.000422724025
  error estimate for blocks of size 2^( 3) =       0.000436317979
  error estimate for blocks of size 2^( 4) =       0.000448348194
  error estimate for blocks of size 2^( 5) =       0.000458837032
  error estimate for blocks of size 2^( 6) =       0.000465307227
  error estimate for blocks of size 2^( 7) =       0.000469375232

      target function =                  N/A
              le_mean =     -16.906581017834
             les_mean =     286.168797878689
             stat err =       0.000460466921
             autocorr =       1.260894960272
              std dev =       0.579927869871
             le_variance =       0.336316334254

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336310391579
                                         uncertainty =       0.003050497912

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336310391579
                                         uncertainty =       0.003050497912

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410071374
  error estimate for blocks of size 2^( 2) =       0.000422724312
  error estimate for blocks of size 2^( 3) =       0.000436318442
  error estimate for blocks of size 2^( 4) =       0.000448348837
  error estimate for blocks of size 2^( 5) =       0.000458837831
  error estimate for blocks of size 2^( 6) =       0.000465307829
  error estimate for blocks of size 2^( 7) =       0.000469375925

      target function =                  N/A
              le_mean =     -16.906580940104
             les_mean =     286.168795980133
             stat err =       0.000460467605
             autocorr =       1.260895971418
              std dev =       0.579928499038
             le_variance =       0.336317063996


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906580928998        initial
     2.5000e+00     2.5000e+01             7.6021e-05       -16.906581089093  <--
     1.0000e+01     1.0000e+02             1.9106e-05       -16.906581017834
     4.0000e+01     4.0000e+02             4.7829e-06       -16.906580940104

*****************************************************************************
Applying the update for shift_i =   2.5000e+00     and shift_s =   2.5000e+01
*****************************************************************************

  Execution time = 2.9698e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.095638e-01 1 1  ON 0
 uu_1                 1.425814e-01 1 1  ON 1
 uu_2                 4.076128e-02 1 1  ON 2
 uu_3                -2.194133e-02 1 1  ON 3
 uu_4                -6.790658e-02 1 1  ON 4
 uu_5                -1.032224e-01 1 1  ON 5
 uu_6                -1.316442e-01 1 1  ON 6
 uu_7                -1.461024e-01 1 1  ON 7
 uu_8                -1.390714e-01 1 1  ON 8
 uu_9                -1.111791e-01 1 1  ON 9
 ud_0                 4.545940e-01 1 1  ON 10
 ud_1                 1.880370e-01 1 1  ON 11
 ud_2                 6.647456e-02 1 1  ON 12
 ud_3                -5.681867e-03 1 1  ON 13
 ud_4                -6.330216e-02 1 1  ON 14
 ud_5                -1.055742e-01 1 1  ON 15
 ud_6                -1.337239e-01 1 1  ON 16
 ud_7                -1.515499e-01 1 1  ON 17
 ud_8                -1.531851e-01 1 1  ON 18
 ud_9                -1.455842e-01 1 1  ON 19
 eO_0                -7.642511e-01 1 1  ON 20
 eO_1                -4.409259e-01 1 1  ON 21
 eO_2                -1.729889e-02 1 1  ON 22
 eO_3                 3.069413e-01 1 1  ON 23
 eO_4                 5.353401e-01 1 1  ON 24
 eO_5                 4.992178e-01 1 1  ON 25
 eO_6                 2.694206e-01 1 1  ON 26
 eO_7                -3.697734e-02 1 1  ON 27
 eO_8                -2.392632e-01 1 1  ON 28
 eO_9                -1.073764e-01 1 1  ON 29
eH1_0                -2.555214e-01 1 1  ON 30
eH1_1                -1.538333e-01 1 1  ON 31
eH1_2                -1.066469e-01 1 1  ON 32
eH1_3                -5.190056e-02 1 1  ON 33
eH1_4                -3.324058e-03 1 1  ON 34
eH1_5                 3.228766e-02 1 1  ON 35
eH1_6                 9.352617e-02 1 1  ON 36
eH1_7                 1.549276e-01 1 1  ON 37
eH1_8                 1.945388e-01 1 1  ON 38
eH1_9                 9.526249e-02 1 1  ON 39
eH2_0                -2.525196e-01 1 1  ON 40
eH2_1                -1.512250e-01 1 1  ON 41
eH2_2                -1.038202e-01 1 1  ON 42
eH2_3                -4.918793e-02 1 1  ON 43
eH2_4                -9.001643e-04 1 1  ON 44
eH2_5                 3.398154e-02 1 1  ON 45
eH2_6                 9.532009e-02 1 1  ON 46
eH2_7                 1.555824e-01 1 1  ON 47
eH2_8                 1.975988e-01 1 1  ON 48
eH2_9                 8.847841e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5957e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6849e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.8652
    reference variance = 0.344388
====================================================
  Execution time = 2.0423e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3416e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5994e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334210638368
                                         uncertainty =       0.002682051633

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334210638368
                                         uncertainty =       0.002682051633

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408752924
  error estimate for blocks of size 2^( 2) =       0.000421802503
  error estimate for blocks of size 2^( 3) =       0.000434540029
  error estimate for blocks of size 2^( 4) =       0.000445758737
  error estimate for blocks of size 2^( 5) =       0.000455972984
  error estimate for blocks of size 2^( 6) =       0.000463617028
  error estimate for blocks of size 2^( 7) =       0.000467433299

      target function =                  N/A
              le_mean =     -16.905682341149
             les_mean =     286.136253158147
             stat err =       0.000458195512
             autocorr =       1.256550414952
              std dev =       0.578063928454
             le_variance =       0.334157905379


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690568234115e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905682341149       residual = 4.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905682786696       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905683695321       residual = 8.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905683288188       residual = 6.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905683480697       residual = 2.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905683656638       residual = 7.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905683514888       residual = 4.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905683553028       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905683605085       residual = 3.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 2.952316e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905682341149       residual = 4.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905682476788       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905682741971       residual = 6.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905682619142       residual = 6.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905682668254       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905682703742       residual = 6.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905682703147       residual = 2.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905682676218       residual = 6.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 8.511472e-05

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905682341149       residual = 4.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905682377011       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905682446240       residual = 5.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905682414209       residual = 7.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905682426666       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905682432005       residual = 6.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905682435420       residual = 2.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905682426940       residual = 4.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+01 is 2.262153e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.123485 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6029e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.095708e-01 1 1  ON 0
 uu_1                 1.425852e-01 1 1  ON 1
 uu_2                 4.077286e-02 1 1  ON 2
 uu_3                -2.194588e-02 1 1  ON 3
 uu_4                -6.790757e-02 1 1  ON 4
 uu_5                -1.032777e-01 1 1  ON 5
 uu_6                -1.316517e-01 1 1  ON 6
 uu_7                -1.460994e-01 1 1  ON 7
 uu_8                -1.390756e-01 1 1  ON 8
 uu_9                -1.111876e-01 1 1  ON 9
 ud_0                 4.545565e-01 1 1  ON 10
 ud_1                 1.880220e-01 1 1  ON 11
 ud_2                 6.650375e-02 1 1  ON 12
 ud_3                -5.685517e-03 1 1  ON 13
 ud_4                -6.330995e-02 1 1  ON 14
 ud_5                -1.055298e-01 1 1  ON 15
 ud_6                -1.337395e-01 1 1  ON 16
 ud_7                -1.515854e-01 1 1  ON 17
 ud_8                -1.531506e-01 1 1  ON 18
 ud_9                -1.455535e-01 1 1  ON 19
 eO_0                -7.641849e-01 1 1  ON 20
 eO_1                -4.408885e-01 1 1  ON 21
 eO_2                -1.734481e-02 1 1  ON 22
 eO_3                 3.069522e-01 1 1  ON 23
 eO_4                 5.353380e-01 1 1  ON 24
 eO_5                 4.992108e-01 1 1  ON 25
 eO_6                 2.694411e-01 1 1  ON 26
 eO_7                -3.698633e-02 1 1  ON 27
 eO_8                -2.392840e-01 1 1  ON 28
 eO_9                -1.074184e-01 1 1  ON 29
eH1_0                -2.555406e-01 1 1  ON 30
eH1_1                -1.538564e-01 1 1  ON 31
eH1_2                -1.066839e-01 1 1  ON 32
eH1_3                -5.191478e-02 1 1  ON 33
eH1_4                -3.294097e-03 1 1  ON 34
eH1_5                 3.221572e-02 1 1  ON 35
eH1_6                 9.354580e-02 1 1  ON 36
eH1_7                 1.549438e-01 1 1  ON 37
eH1_8                 1.945487e-01 1 1  ON 38
eH1_9                 9.533429e-02 1 1  ON 39
eH2_0                -2.525290e-01 1 1  ON 40
eH2_1                -1.512203e-01 1 1  ON 41
eH2_2                -1.038456e-01 1 1  ON 42
eH2_3                -4.927304e-02 1 1  ON 43
eH2_4                -8.802084e-04 1 1  ON 44
eH2_5                 3.399382e-02 1 1  ON 45
eH2_6                 9.530972e-02 1 1  ON 46
eH2_7                 1.555906e-01 1 1  ON 47
eH2_8                 1.976133e-01 1 1  ON 48
eH2_9                 8.854410e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.9353
    reference variance = 0.644273
====================================================
  Execution time = 2.0413e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4221e-01
  Total weights = 2.0000e+06
  Execution time = 2.3334e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342163170433
                                         uncertainty =       0.008387684156

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342163170433
                                         uncertainty =       0.008387684156

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413678491
  error estimate for blocks of size 2^( 2) =       0.000426409141
  error estimate for blocks of size 2^( 3) =       0.000438812485
  error estimate for blocks of size 2^( 4) =       0.000450615805
  error estimate for blocks of size 2^( 5) =       0.000460514973
  error estimate for blocks of size 2^( 6) =       0.000467899198
  error estimate for blocks of size 2^( 7) =       0.000472712588

      target function =                  N/A
              le_mean =     -16.905432741009
             les_mean =     286.135915778213
             stat err =       0.000462935641
             autocorr =       1.252320107546
              std dev =       0.585029733061
             le_variance =       0.342259788566

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342028069688
                                         uncertainty =       0.008384367873

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342028069688
                                         uncertainty =       0.008384367873

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413596777
  error estimate for blocks of size 2^( 2) =       0.000426332470
  error estimate for blocks of size 2^( 3) =       0.000438739645
  error estimate for blocks of size 2^( 4) =       0.000450545897
  error estimate for blocks of size 2^( 5) =       0.000460449754
  error estimate for blocks of size 2^( 6) =       0.000467837478
  error estimate for blocks of size 2^( 7) =       0.000472647500

      target function =                  N/A
              le_mean =     -16.905431480749
             les_mean =     286.135737966399
             stat err =       0.000462870157
             autocorr =       1.252460598569
              std dev =       0.584914170777
             le_variance =       0.342124587175

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342070403061
                                         uncertainty =       0.008385524254

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342070403061
                                         uncertainty =       0.008385524254

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413622384
  error estimate for blocks of size 2^( 2) =       0.000426356524
  error estimate for blocks of size 2^( 3) =       0.000438762537
  error estimate for blocks of size 2^( 4) =       0.000450567840
  error estimate for blocks of size 2^( 5) =       0.000460470188
  error estimate for blocks of size 2^( 6) =       0.000467857024
  error estimate for blocks of size 2^( 7) =       0.000472668137

      target function =                  N/A
              le_mean =     -16.905431888045
             les_mean =     286.135794103603
             stat err =       0.000462890797
             autocorr =       1.252417208074
              std dev =       0.584950385374
             le_variance =       0.342166953349

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342150432833
                                         uncertainty =       0.008387402334

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342150432833
                                         uncertainty =       0.008387402334

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413670788
  error estimate for blocks of size 2^( 2) =       0.000426401920
  error estimate for blocks of size 2^( 3) =       0.000438805640
  error estimate for blocks of size 2^( 4) =       0.000450609235
  error estimate for blocks of size 2^( 5) =       0.000460508845
  error estimate for blocks of size 2^( 6) =       0.000467893453
  error estimate for blocks of size 2^( 7) =       0.000472706525

      target function =                  N/A
              le_mean =     -16.905432608646
             les_mean =     286.135898556255
             stat err =       0.000462929514
             autocorr =       1.252333601427
              std dev =       0.585018838939
             le_variance =       0.342247041913


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905432741009        initial  <--
     6.2500e-01     6.2500e+00             2.9523e-04       -16.905431480749
     2.5000e+00     2.5000e+01             8.5115e-05       -16.905431888045
     1.0000e+01     1.0000e+02             2.2622e-05       -16.905432608646

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.7014
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.095638e-01 1 1  ON 0
 uu_1                 1.425814e-01 1 1  ON 1
 uu_2                 4.076128e-02 1 1  ON 2
 uu_3                -2.194133e-02 1 1  ON 3
 uu_4                -6.790658e-02 1 1  ON 4
 uu_5                -1.032224e-01 1 1  ON 5
 uu_6                -1.316442e-01 1 1  ON 6
 uu_7                -1.461024e-01 1 1  ON 7
 uu_8                -1.390714e-01 1 1  ON 8
 uu_9                -1.111791e-01 1 1  ON 9
 ud_0                 4.545940e-01 1 1  ON 10
 ud_1                 1.880370e-01 1 1  ON 11
 ud_2                 6.647456e-02 1 1  ON 12
 ud_3                -5.681867e-03 1 1  ON 13
 ud_4                -6.330216e-02 1 1  ON 14
 ud_5                -1.055742e-01 1 1  ON 15
 ud_6                -1.337239e-01 1 1  ON 16
 ud_7                -1.515499e-01 1 1  ON 17
 ud_8                -1.531851e-01 1 1  ON 18
 ud_9                -1.455842e-01 1 1  ON 19
 eO_0                -7.642511e-01 1 1  ON 20
 eO_1                -4.409259e-01 1 1  ON 21
 eO_2                -1.729889e-02 1 1  ON 22
 eO_3                 3.069413e-01 1 1  ON 23
 eO_4                 5.353401e-01 1 1  ON 24
 eO_5                 4.992178e-01 1 1  ON 25
 eO_6                 2.694206e-01 1 1  ON 26
 eO_7                -3.697734e-02 1 1  ON 27
 eO_8                -2.392632e-01 1 1  ON 28
 eO_9                -1.073764e-01 1 1  ON 29
eH1_0                -2.555214e-01 1 1  ON 30
eH1_1                -1.538333e-01 1 1  ON 31
eH1_2                -1.066469e-01 1 1  ON 32
eH1_3                -5.190056e-02 1 1  ON 33
eH1_4                -3.324058e-03 1 1  ON 34
eH1_5                 3.228766e-02 1 1  ON 35
eH1_6                 9.352617e-02 1 1  ON 36
eH1_7                 1.549276e-01 1 1  ON 37
eH1_8                 1.945388e-01 1 1  ON 38
eH1_9                 9.526249e-02 1 1  ON 39
eH2_0                -2.525196e-01 1 1  ON 40
eH2_1                -1.512250e-01 1 1  ON 41
eH2_2                -1.038202e-01 1 1  ON 42
eH2_3                -4.918793e-02 1 1  ON 43
eH2_4                -9.001643e-04 1 1  ON 44
eH2_5                 3.398154e-02 1 1  ON 45
eH2_6                 9.532009e-02 1 1  ON 46
eH2_7                 1.555824e-01 1 1  ON 47
eH2_8                 1.975988e-01 1 1  ON 48
eH2_9                 8.847841e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6750e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6866e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.0211
    reference variance = 0.252094
====================================================
  Execution time = 2.0575e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4779e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5601e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347804347075
                                         uncertainty =       0.007729980674

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347804347075
                                         uncertainty =       0.007729980674

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417006791
  error estimate for blocks of size 2^( 2) =       0.000429541480
  error estimate for blocks of size 2^( 3) =       0.000442740810
  error estimate for blocks of size 2^( 4) =       0.000454161980
  error estimate for blocks of size 2^( 5) =       0.000463882460
  error estimate for blocks of size 2^( 6) =       0.000472001848
  error estimate for blocks of size 2^( 7) =       0.000478938945

      target function =                  N/A
              le_mean =     -16.905461417197
             les_mean =     286.142414882132
             stat err =       0.000467246308
             autocorr =       1.255467578624
              std dev =       0.589736659616
             le_variance =       0.347789327695


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690546141720e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905461417197       residual = 5.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905461461219       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905461598856       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905461637767       residual = 7.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905461675668       residual = 3.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905461708406       residual = 4.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905461734930       residual = 1.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905461730198       residual = 2.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 3.689089e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905461417197       residual = 5.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905461428436       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905461464807       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905461474615       residual = 6.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905461484119       residual = 3.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905461492557       residual = 3.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905461498902       residual = 1.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905461498088       residual = 2.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+01 is 9.296342e-06

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905461417197       residual = 5.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905461420022       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905461429246       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905461431704       residual = 6.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905461434082       residual = 3.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905461436208       residual = 3.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905461437772       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905461437592       residual = 2.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+02 is 2.328743e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.126297 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6142e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.095600e-01 1 1  ON 0
 uu_1                 1.425848e-01 1 1  ON 1
 uu_2                 4.076371e-02 1 1  ON 2
 uu_3                -2.194286e-02 1 1  ON 3
 uu_4                -6.790530e-02 1 1  ON 4
 uu_5                -1.032216e-01 1 1  ON 5
 uu_6                -1.316514e-01 1 1  ON 6
 uu_7                -1.461049e-01 1 1  ON 7
 uu_8                -1.390705e-01 1 1  ON 8
 uu_9                -1.111777e-01 1 1  ON 9
 ud_0                 4.545944e-01 1 1  ON 10
 ud_1                 1.880331e-01 1 1  ON 11
 ud_2                 6.647846e-02 1 1  ON 12
 ud_3                -5.684383e-03 1 1  ON 13
 ud_4                -6.330373e-02 1 1  ON 14
 ud_5                -1.055715e-01 1 1  ON 15
 ud_6                -1.337254e-01 1 1  ON 16
 ud_7                -1.515492e-01 1 1  ON 17
 ud_8                -1.531815e-01 1 1  ON 18
 ud_9                -1.455821e-01 1 1  ON 19
 eO_0                -7.642471e-01 1 1  ON 20
 eO_1                -4.409259e-01 1 1  ON 21
 eO_2                -1.729844e-02 1 1  ON 22
 eO_3                 3.069415e-01 1 1  ON 23
 eO_4                 5.353390e-01 1 1  ON 24
 eO_5                 4.992209e-01 1 1  ON 25
 eO_6                 2.694229e-01 1 1  ON 26
 eO_7                -3.697793e-02 1 1  ON 27
 eO_8                -2.392651e-01 1 1  ON 28
 eO_9                -1.073815e-01 1 1  ON 29
eH1_0                -2.555221e-01 1 1  ON 30
eH1_1                -1.538384e-01 1 1  ON 31
eH1_2                -1.066461e-01 1 1  ON 32
eH1_3                -5.190369e-02 1 1  ON 33
eH1_4                -3.320023e-03 1 1  ON 34
eH1_5                 3.227836e-02 1 1  ON 35
eH1_6                 9.352336e-02 1 1  ON 36
eH1_7                 1.549308e-01 1 1  ON 37
eH1_8                 1.945427e-01 1 1  ON 38
eH1_9                 9.527049e-02 1 1  ON 39
eH2_0                -2.525279e-01 1 1  ON 40
eH2_1                -1.512245e-01 1 1  ON 41
eH2_2                -1.038235e-01 1 1  ON 42
eH2_3                -4.918563e-02 1 1  ON 43
eH2_4                -8.997776e-04 1 1  ON 44
eH2_5                 3.397791e-02 1 1  ON 45
eH2_6                 9.532196e-02 1 1  ON 46
eH2_7                 1.555842e-01 1 1  ON 47
eH2_8                 1.976001e-01 1 1  ON 48
eH2_9                 8.848451e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.9303
    reference variance = 0.262252
====================================================
  Execution time = 2.0412e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3872e-01
  Total weights = 2.0000e+06
  Execution time = 1.8885e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338764056255
                                         uncertainty =       0.003018148053

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338764056255
                                         uncertainty =       0.003018148053

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411535744
  error estimate for blocks of size 2^( 2) =       0.000424825135
  error estimate for blocks of size 2^( 3) =       0.000437445134
  error estimate for blocks of size 2^( 4) =       0.000449323763
  error estimate for blocks of size 2^( 5) =       0.000458807311
  error estimate for blocks of size 2^( 6) =       0.000464357885
  error estimate for blocks of size 2^( 7) =       0.000472733326

      target function =                  N/A
              le_mean =     -16.905625972199
             les_mean =     286.138912679433
             stat err =       0.000461305571
             autocorr =       1.256499372459
              std dev =       0.581999430334
             le_variance =       0.338723336909

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338755417835
                                         uncertainty =       0.003018152683

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338755417835
                                         uncertainty =       0.003018152683

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411530497
  error estimate for blocks of size 2^( 2) =       0.000424820161
  error estimate for blocks of size 2^( 3) =       0.000437440536
  error estimate for blocks of size 2^( 4) =       0.000449319198
  error estimate for blocks of size 2^( 5) =       0.000458802837
  error estimate for blocks of size 2^( 6) =       0.000464353276
  error estimate for blocks of size 2^( 7) =       0.000472729076

      target function =                  N/A
              le_mean =     -16.905625812874
             les_mean =     286.138898654702
             stat err =       0.000461301097
             autocorr =       1.256507039342
              std dev =       0.581992009514
             le_variance =       0.338714699138

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338759714382
                                         uncertainty =       0.003018151344

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338759714382
                                         uncertainty =       0.003018151344

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411533106
  error estimate for blocks of size 2^( 2) =       0.000424822636
  error estimate for blocks of size 2^( 3) =       0.000437442832
  error estimate for blocks of size 2^( 4) =       0.000449321470
  error estimate for blocks of size 2^( 5) =       0.000458805066
  error estimate for blocks of size 2^( 6) =       0.000464355564
  error estimate for blocks of size 2^( 7) =       0.000472731186

      target function =                  N/A
              le_mean =     -16.905625887904
             les_mean =     286.138905487553
             stat err =       0.000461303322
             autocorr =       1.256503222346
              std dev =       0.581995700282
             le_variance =       0.338718995146

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338763511961
                                         uncertainty =       0.003018148495

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338763511961
                                         uncertainty =       0.003018148495

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411535413
  error estimate for blocks of size 2^( 2) =       0.000424824822
  error estimate for blocks of size 2^( 3) =       0.000437444845
  error estimate for blocks of size 2^( 4) =       0.000449323476
  error estimate for blocks of size 2^( 5) =       0.000458807030
  error estimate for blocks of size 2^( 6) =       0.000464357594
  error estimate for blocks of size 2^( 7) =       0.000472733057

      target function =                  N/A
              le_mean =     -16.905625961415
             les_mean =     286.138911770519
             stat err =       0.000461305289
             autocorr =       1.256499854471
              std dev =       0.581998962731
             le_variance =       0.338722792620


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905625972199        initial  <--
     6.2500e+00     6.2500e+01             3.6891e-05       -16.905625812874
     2.5000e+01     2.5000e+02             9.2963e-06       -16.905625887904
     1.0000e+02     1.0000e+03             2.3287e-06       -16.905625961415

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8762
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.095638e-01 1 1  ON 0
 uu_1                 1.425814e-01 1 1  ON 1
 uu_2                 4.076128e-02 1 1  ON 2
 uu_3                -2.194133e-02 1 1  ON 3
 uu_4                -6.790658e-02 1 1  ON 4
 uu_5                -1.032224e-01 1 1  ON 5
 uu_6                -1.316442e-01 1 1  ON 6
 uu_7                -1.461024e-01 1 1  ON 7
 uu_8                -1.390714e-01 1 1  ON 8
 uu_9                -1.111791e-01 1 1  ON 9
 ud_0                 4.545940e-01 1 1  ON 10
 ud_1                 1.880370e-01 1 1  ON 11
 ud_2                 6.647456e-02 1 1  ON 12
 ud_3                -5.681867e-03 1 1  ON 13
 ud_4                -6.330216e-02 1 1  ON 14
 ud_5                -1.055742e-01 1 1  ON 15
 ud_6                -1.337239e-01 1 1  ON 16
 ud_7                -1.515499e-01 1 1  ON 17
 ud_8                -1.531851e-01 1 1  ON 18
 ud_9                -1.455842e-01 1 1  ON 19
 eO_0                -7.642511e-01 1 1  ON 20
 eO_1                -4.409259e-01 1 1  ON 21
 eO_2                -1.729889e-02 1 1  ON 22
 eO_3                 3.069413e-01 1 1  ON 23
 eO_4                 5.353401e-01 1 1  ON 24
 eO_5                 4.992178e-01 1 1  ON 25
 eO_6                 2.694206e-01 1 1  ON 26
 eO_7                -3.697734e-02 1 1  ON 27
 eO_8                -2.392632e-01 1 1  ON 28
 eO_9                -1.073764e-01 1 1  ON 29
eH1_0                -2.555214e-01 1 1  ON 30
eH1_1                -1.538333e-01 1 1  ON 31
eH1_2                -1.066469e-01 1 1  ON 32
eH1_3                -5.190056e-02 1 1  ON 33
eH1_4                -3.324058e-03 1 1  ON 34
eH1_5                 3.228766e-02 1 1  ON 35
eH1_6                 9.352617e-02 1 1  ON 36
eH1_7                 1.549276e-01 1 1  ON 37
eH1_8                 1.945388e-01 1 1  ON 38
eH1_9                 9.526249e-02 1 1  ON 39
eH2_0                -2.525196e-01 1 1  ON 40
eH2_1                -1.512250e-01 1 1  ON 41
eH2_2                -1.038202e-01 1 1  ON 42
eH2_3                -4.918793e-02 1 1  ON 43
eH2_4                -9.001643e-04 1 1  ON 44
eH2_5                 3.398154e-02 1 1  ON 45
eH2_6                 9.532009e-02 1 1  ON 46
eH2_7                 1.555824e-01 1 1  ON 47
eH2_8                 1.975988e-01 1 1  ON 48
eH2_9                 8.847841e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6025e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6894e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.9279
    reference variance = 0.166397
====================================================
  Execution time = 2.0458e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4041e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6338e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340377682071
                                         uncertainty =       0.004106626715

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340377682071
                                         uncertainty =       0.004106626715

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412558759
  error estimate for blocks of size 2^( 2) =       0.000425607664
  error estimate for blocks of size 2^( 3) =       0.000439295086
  error estimate for blocks of size 2^( 4) =       0.000451109753
  error estimate for blocks of size 2^( 5) =       0.000461997534
  error estimate for blocks of size 2^( 6) =       0.000470589729
  error estimate for blocks of size 2^( 7) =       0.000478723844

      target function =                  N/A
              le_mean =     -16.906572063183
             les_mean =     286.172588216547
             stat err =       0.000465605215
             autocorr =       1.273690905726
              std dev =       0.583446192179
             le_variance =       0.340409459168


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690657206318e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906572063183       residual = 3.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906572059073       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906572056385       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906572058589       residual = 9.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906572062508       residual = 2.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906572064737       residual = 4.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906572067179       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906572068344       residual = 2.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+01 is 3.989415e-06

solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906572063183       residual = 3.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906572062152       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906572061475       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906572062021       residual = 9.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906572062996       residual = 2.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906572063555       residual = 4.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906572064169       residual = 1.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906572064459       residual = 2.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+02 is 9.977959e-07

solving harmonic davidson linear method for identity shift 1.0000e+03, overlap shift 1.0000e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906572063183       residual = 3.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906572062925       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906572062755       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906572062891       residual = 9.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906572063135       residual = 2.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906572063275       residual = 4.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906572063428       residual = 1.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906572063501       residual = 2.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+03 is 2.494766e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.129023 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6098e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.095632e-01 1 1  ON 0
 uu_1                 1.425815e-01 1 1  ON 1
 uu_2                 4.076145e-02 1 1  ON 2
 uu_3                -2.194121e-02 1 1  ON 3
 uu_4                -6.790646e-02 1 1  ON 4
 uu_5                -1.032225e-01 1 1  ON 5
 uu_6                -1.316441e-01 1 1  ON 6
 uu_7                -1.461026e-01 1 1  ON 7
 uu_8                -1.390713e-01 1 1  ON 8
 uu_9                -1.111789e-01 1 1  ON 9
 ud_0                 4.545935e-01 1 1  ON 10
 ud_1                 1.880366e-01 1 1  ON 11
 ud_2                 6.647474e-02 1 1  ON 12
 ud_3                -5.681748e-03 1 1  ON 13
 ud_4                -6.330239e-02 1 1  ON 14
 ud_5                -1.055741e-01 1 1  ON 15
 ud_6                -1.337238e-01 1 1  ON 16
 ud_7                -1.515501e-01 1 1  ON 17
 ud_8                -1.531848e-01 1 1  ON 18
 ud_9                -1.455836e-01 1 1  ON 19
 eO_0                -7.642507e-01 1 1  ON 20
 eO_1                -4.409255e-01 1 1  ON 21
 eO_2                -1.729915e-02 1 1  ON 22
 eO_3                 3.069412e-01 1 1  ON 23
 eO_4                 5.353403e-01 1 1  ON 24
 eO_5                 4.992176e-01 1 1  ON 25
 eO_6                 2.694209e-01 1 1  ON 26
 eO_7                -3.697740e-02 1 1  ON 27
 eO_8                -2.392633e-01 1 1  ON 28
 eO_9                -1.073768e-01 1 1  ON 29
eH1_0                -2.555217e-01 1 1  ON 30
eH1_1                -1.538333e-01 1 1  ON 31
eH1_2                -1.066472e-01 1 1  ON 32
eH1_3                -5.190053e-02 1 1  ON 33
eH1_4                -3.324068e-03 1 1  ON 34
eH1_5                 3.228666e-02 1 1  ON 35
eH1_6                 9.352604e-02 1 1  ON 36
eH1_7                 1.549281e-01 1 1  ON 37
eH1_8                 1.945392e-01 1 1  ON 38
eH1_9                 9.526311e-02 1 1  ON 39
eH2_0                -2.525198e-01 1 1  ON 40
eH2_1                -1.512253e-01 1 1  ON 41
eH2_2                -1.038205e-01 1 1  ON 42
eH2_3                -4.918841e-02 1 1  ON 43
eH2_4                -9.004172e-04 1 1  ON 44
eH2_5                 3.398182e-02 1 1  ON 45
eH2_6                 9.532025e-02 1 1  ON 46
eH2_7                 1.555826e-01 1 1  ON 47
eH2_8                 1.975990e-01 1 1  ON 48
eH2_9                 8.847910e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.9183
    reference variance = 0.271448
====================================================
  Execution time = 2.0411e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4269e-01
  Total weights = 2.0000e+06
  Execution time = 1.8924e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342721692149
                                         uncertainty =       0.004193399690

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342721692149
                                         uncertainty =       0.004193399690

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413935911
  error estimate for blocks of size 2^( 2) =       0.000426471087
  error estimate for blocks of size 2^( 3) =       0.000439355688
  error estimate for blocks of size 2^( 4) =       0.000451808023
  error estimate for blocks of size 2^( 5) =       0.000463543374
  error estimate for blocks of size 2^( 6) =       0.000472363446
  error estimate for blocks of size 2^( 7) =       0.000477908167

      target function =                  N/A
              le_mean =     -16.905781887428
             les_mean =     286.148146931328
             stat err =       0.000466405752
             autocorr =       1.269584422322
              std dev =       0.585393779762
             le_variance =       0.342685877384

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342718930514
                                         uncertainty =       0.004193355497

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342718930514
                                         uncertainty =       0.004193355497

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413934243
  error estimate for blocks of size 2^( 2) =       0.000426469523
  error estimate for blocks of size 2^( 3) =       0.000439354229
  error estimate for blocks of size 2^( 4) =       0.000451806638
  error estimate for blocks of size 2^( 5) =       0.000463542035
  error estimate for blocks of size 2^( 6) =       0.000472362148
  error estimate for blocks of size 2^( 7) =       0.000477906905

      target function =                  N/A
              le_mean =     -16.905781874591
             les_mean =     286.148143734685
             stat err =       0.000466404432
             autocorr =       1.269587467108
              std dev =       0.585391420145
             le_variance =       0.342683114780

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342720307465
                                         uncertainty =       0.004193377518

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342720307465
                                         uncertainty =       0.004193377518

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413935075
  error estimate for blocks of size 2^( 2) =       0.000426470303
  error estimate for blocks of size 2^( 3) =       0.000439354957
  error estimate for blocks of size 2^( 4) =       0.000451807329
  error estimate for blocks of size 2^( 5) =       0.000463542703
  error estimate for blocks of size 2^( 6) =       0.000472362795
  error estimate for blocks of size 2^( 7) =       0.000477907534

      target function =                  N/A
              le_mean =     -16.905781880960
             les_mean =     286.148145327470
             stat err =       0.000466405090
             autocorr =       1.269585949633
              std dev =       0.585392596649
             le_variance =       0.342684492212

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342721518938
                                         uncertainty =       0.004193396916

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342721518938
                                         uncertainty =       0.004193396916

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413935807
  error estimate for blocks of size 2^( 2) =       0.000426470989
  error estimate for blocks of size 2^( 3) =       0.000439355597
  error estimate for blocks of size 2^( 4) =       0.000451807936
  error estimate for blocks of size 2^( 5) =       0.000463543290
  error estimate for blocks of size 2^( 6) =       0.000472363364
  error estimate for blocks of size 2^( 7) =       0.000477908087

      target function =                  N/A
              le_mean =     -16.905781886617
             les_mean =     286.148146730649
             stat err =       0.000466405670
             autocorr =       1.269584613391
              std dev =       0.585393631766
             le_variance =       0.342685704112


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905781887428        initial  <--
     6.2500e+01     6.2500e+02             3.9894e-06       -16.905781874591
     2.5000e+02     2.5000e+03             9.9780e-07       -16.905781880960
     1.0000e+03     1.0000e+04             2.4948e-07       -16.905781886617

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8853
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.095638e-01 1 1  ON 0
 uu_1                 1.425814e-01 1 1  ON 1
 uu_2                 4.076128e-02 1 1  ON 2
 uu_3                -2.194133e-02 1 1  ON 3
 uu_4                -6.790658e-02 1 1  ON 4
 uu_5                -1.032224e-01 1 1  ON 5
 uu_6                -1.316442e-01 1 1  ON 6
 uu_7                -1.461024e-01 1 1  ON 7
 uu_8                -1.390714e-01 1 1  ON 8
 uu_9                -1.111791e-01 1 1  ON 9
 ud_0                 4.545940e-01 1 1  ON 10
 ud_1                 1.880370e-01 1 1  ON 11
 ud_2                 6.647456e-02 1 1  ON 12
 ud_3                -5.681867e-03 1 1  ON 13
 ud_4                -6.330216e-02 1 1  ON 14
 ud_5                -1.055742e-01 1 1  ON 15
 ud_6                -1.337239e-01 1 1  ON 16
 ud_7                -1.515499e-01 1 1  ON 17
 ud_8                -1.531851e-01 1 1  ON 18
 ud_9                -1.455842e-01 1 1  ON 19
 eO_0                -7.642511e-01 1 1  ON 20
 eO_1                -4.409259e-01 1 1  ON 21
 eO_2                -1.729889e-02 1 1  ON 22
 eO_3                 3.069413e-01 1 1  ON 23
 eO_4                 5.353401e-01 1 1  ON 24
 eO_5                 4.992178e-01 1 1  ON 25
 eO_6                 2.694206e-01 1 1  ON 26
 eO_7                -3.697734e-02 1 1  ON 27
 eO_8                -2.392632e-01 1 1  ON 28
 eO_9                -1.073764e-01 1 1  ON 29
eH1_0                -2.555214e-01 1 1  ON 30
eH1_1                -1.538333e-01 1 1  ON 31
eH1_2                -1.066469e-01 1 1  ON 32
eH1_3                -5.190056e-02 1 1  ON 33
eH1_4                -3.324058e-03 1 1  ON 34
eH1_5                 3.228766e-02 1 1  ON 35
eH1_6                 9.352617e-02 1 1  ON 36
eH1_7                 1.549276e-01 1 1  ON 37
eH1_8                 1.945388e-01 1 1  ON 38
eH1_9                 9.526249e-02 1 1  ON 39
eH2_0                -2.525196e-01 1 1  ON 40
eH2_1                -1.512250e-01 1 1  ON 41
eH2_2                -1.038202e-01 1 1  ON 42
eH2_3                -4.918793e-02 1 1  ON 43
eH2_4                -9.001643e-04 1 1  ON 44
eH2_5                 3.398154e-02 1 1  ON 45
eH2_6                 9.532009e-02 1 1  ON 46
eH2_7                 1.555824e-01 1 1  ON 47
eH2_8                 1.975988e-01 1 1  ON 48
eH2_9                 8.847841e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5991e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.9533
    reference variance = 0.239705
====================================================
  Execution time = 2.0585e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4230e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5388e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342322209669
                                         uncertainty =       0.005193369244

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342322209669
                                         uncertainty =       0.005193369244

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413702093
  error estimate for blocks of size 2^( 2) =       0.000426941621
  error estimate for blocks of size 2^( 3) =       0.000440684872
  error estimate for blocks of size 2^( 4) =       0.000453721475
  error estimate for blocks of size 2^( 5) =       0.000465880631
  error estimate for blocks of size 2^( 6) =       0.000475819035
  error estimate for blocks of size 2^( 7) =       0.000486086994

      target function =                  N/A
              le_mean =     -16.906109699638
             les_mean =     286.158843848055
             stat err =       0.000470377034
             autocorr =       1.292756657301
              std dev =       0.585063110283
             le_variance =       0.342298843014


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690610969964e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906109699638       residual = 7.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906109700099       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906109700343       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906109701851       residual = 3.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906109702118       residual = 4.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906109702428       residual = 5.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906109702247       residual = 9.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+02 is 3.798720e-07

solving harmonic davidson linear method for identity shift 2.5000e+03, overlap shift 2.5000e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906109699638       residual = 7.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906109699753       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906109699814       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906109700191       residual = 3.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906109700258       residual = 4.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906109700335       residual = 5.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906109700292       residual = 9.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+03 is 9.497328e-08

solving harmonic davidson linear method for identity shift 1.0000e+04, overlap shift 1.0000e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906109699638       residual = 7.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906109699667       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906109699682       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906109699775       residual = 3.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906109699794       residual = 4.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906109699812       residual = 5.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906109699800       residual = 9.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+04 is 2.374365e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.131345 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6129e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.095638e-01 1 1  ON 0
 uu_1                 1.425815e-01 1 1  ON 1
 uu_2                 4.076132e-02 1 1  ON 2
 uu_3                -2.194134e-02 1 1  ON 3
 uu_4                -6.790657e-02 1 1  ON 4
 uu_5                -1.032224e-01 1 1  ON 5
 uu_6                -1.316442e-01 1 1  ON 6
 uu_7                -1.461025e-01 1 1  ON 7
 uu_8                -1.390714e-01 1 1  ON 8
 uu_9                -1.111791e-01 1 1  ON 9
 ud_0                 4.545940e-01 1 1  ON 10
 ud_1                 1.880370e-01 1 1  ON 11
 ud_2                 6.647454e-02 1 1  ON 12
 ud_3                -5.681880e-03 1 1  ON 13
 ud_4                -6.330217e-02 1 1  ON 14
 ud_5                -1.055742e-01 1 1  ON 15
 ud_6                -1.337240e-01 1 1  ON 16
 ud_7                -1.515499e-01 1 1  ON 17
 ud_8                -1.531851e-01 1 1  ON 18
 ud_9                -1.455841e-01 1 1  ON 19
 eO_0                -7.642511e-01 1 1  ON 20
 eO_1                -4.409258e-01 1 1  ON 21
 eO_2                -1.729894e-02 1 1  ON 22
 eO_3                 3.069413e-01 1 1  ON 23
 eO_4                 5.353401e-01 1 1  ON 24
 eO_5                 4.992178e-01 1 1  ON 25
 eO_6                 2.694207e-01 1 1  ON 26
 eO_7                -3.697736e-02 1 1  ON 27
 eO_8                -2.392632e-01 1 1  ON 28
 eO_9                -1.073764e-01 1 1  ON 29
eH1_0                -2.555214e-01 1 1  ON 30
eH1_1                -1.538333e-01 1 1  ON 31
eH1_2                -1.066470e-01 1 1  ON 32
eH1_3                -5.190060e-02 1 1  ON 33
eH1_4                -3.324047e-03 1 1  ON 34
eH1_5                 3.228764e-02 1 1  ON 35
eH1_6                 9.352617e-02 1 1  ON 36
eH1_7                 1.549276e-01 1 1  ON 37
eH1_8                 1.945388e-01 1 1  ON 38
eH1_9                 9.526256e-02 1 1  ON 39
eH2_0                -2.525196e-01 1 1  ON 40
eH2_1                -1.512251e-01 1 1  ON 41
eH2_2                -1.038202e-01 1 1  ON 42
eH2_3                -4.918794e-02 1 1  ON 43
eH2_4                -9.001615e-04 1 1  ON 44
eH2_5                 3.398149e-02 1 1  ON 45
eH2_6                 9.532005e-02 1 1  ON 46
eH2_7                 1.555824e-01 1 1  ON 47
eH2_8                 1.975989e-01 1 1  ON 48
eH2_9                 8.847850e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.8956
    reference variance = 0.160884
====================================================
  Execution time = 2.0145e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5400e-01
  Total weights = 2.0000e+06
  Execution time = 1.9063e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353938535934
                                         uncertainty =       0.019697482469

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353938535934
                                         uncertainty =       0.019697482469

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420712809
  error estimate for blocks of size 2^( 2) =       0.000433052459
  error estimate for blocks of size 2^( 3) =       0.000446248051
  error estimate for blocks of size 2^( 4) =       0.000458499012
  error estimate for blocks of size 2^( 5) =       0.000469318792
  error estimate for blocks of size 2^( 6) =       0.000476033573
  error estimate for blocks of size 2^( 7) =       0.000479161289

      target function =                  N/A
              le_mean =     -16.905745069017
             les_mean =     286.158214696785
             stat err =       0.000470753167
             autocorr =       1.252030852534
              std dev =       0.594977760242
             le_variance =       0.353998535183

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353938556273
                                         uncertainty =       0.019697482510

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353938556273
                                         uncertainty =       0.019697482510

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420712821
  error estimate for blocks of size 2^( 2) =       0.000433052470
  error estimate for blocks of size 2^( 3) =       0.000446248061
  error estimate for blocks of size 2^( 4) =       0.000458499019
  error estimate for blocks of size 2^( 5) =       0.000469318798
  error estimate for blocks of size 2^( 6) =       0.000476033581
  error estimate for blocks of size 2^( 7) =       0.000479161294

      target function =                  N/A
              le_mean =     -16.905745069795
             les_mean =     286.158214743507
             stat err =       0.000470753173
             autocorr =       1.252030814179
              std dev =       0.594977777398
             le_variance =       0.353998555597

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353938546110
                                         uncertainty =       0.019697482490

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353938546110
                                         uncertainty =       0.019697482490

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420712815
  error estimate for blocks of size 2^( 2) =       0.000433052464
  error estimate for blocks of size 2^( 3) =       0.000446248056
  error estimate for blocks of size 2^( 4) =       0.000458499015
  error estimate for blocks of size 2^( 5) =       0.000469318795
  error estimate for blocks of size 2^( 6) =       0.000476033577
  error estimate for blocks of size 2^( 7) =       0.000479161292

      target function =                  N/A
              le_mean =     -16.905745069406
             les_mean =     286.158214720158
             stat err =       0.000470753170
             autocorr =       1.252030833350
              std dev =       0.594977768826
             le_variance =       0.353998545397

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353938537206
                                         uncertainty =       0.019697482472

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353938537206
                                         uncertainty =       0.019697482472

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420712810
  error estimate for blocks of size 2^( 2) =       0.000433052460
  error estimate for blocks of size 2^( 3) =       0.000446248052
  error estimate for blocks of size 2^( 4) =       0.000458499012
  error estimate for blocks of size 2^( 5) =       0.000469318793
  error estimate for blocks of size 2^( 6) =       0.000476033574
  error estimate for blocks of size 2^( 7) =       0.000479161289

      target function =                  N/A
              le_mean =     -16.905745069066
             les_mean =     286.158214699707
             stat err =       0.000470753167
             autocorr =       1.252030850133
              std dev =       0.594977761316
             le_variance =       0.353998536460


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905745069017        initial
     6.2500e+02     6.2500e+03             3.7987e-07       -16.905745069795  <--
     2.5000e+03     2.5000e+04             9.4973e-08       -16.905745069406
     1.0000e+04     1.0000e+05             2.3744e-08       -16.905745069066

*****************************************************************************
Applying the update for shift_i =   6.2500e+02     and shift_s =   6.2500e+03
*****************************************************************************

  Execution time = 2.9677e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.095638e-01 1 1  ON 0
 uu_1                 1.425816e-01 1 1  ON 1
 uu_2                 4.076141e-02 1 1  ON 2
 uu_3                -2.194139e-02 1 1  ON 3
 uu_4                -6.790652e-02 1 1  ON 4
 uu_5                -1.032227e-01 1 1  ON 5
 uu_6                -1.316443e-01 1 1  ON 6
 uu_7                -1.461028e-01 1 1  ON 7
 uu_8                -1.390714e-01 1 1  ON 8
 uu_9                -1.111790e-01 1 1  ON 9
 ud_0                 4.545939e-01 1 1  ON 10
 ud_1                 1.880369e-01 1 1  ON 11
 ud_2                 6.647450e-02 1 1  ON 12
 ud_3                -5.681917e-03 1 1  ON 13
 ud_4                -6.330220e-02 1 1  ON 14
 ud_5                -1.055741e-01 1 1  ON 15
 ud_6                -1.337241e-01 1 1  ON 16
 ud_7                -1.515499e-01 1 1  ON 17
 ud_8                -1.531849e-01 1 1  ON 18
 ud_9                -1.455840e-01 1 1  ON 19
 eO_0                -7.642509e-01 1 1  ON 20
 eO_1                -4.409257e-01 1 1  ON 21
 eO_2                -1.729908e-02 1 1  ON 22
 eO_3                 3.069413e-01 1 1  ON 23
 eO_4                 5.353402e-01 1 1  ON 24
 eO_5                 4.992178e-01 1 1  ON 25
 eO_6                 2.694207e-01 1 1  ON 26
 eO_7                -3.697745e-02 1 1  ON 27
 eO_8                -2.392632e-01 1 1  ON 28
 eO_9                -1.073765e-01 1 1  ON 29
eH1_0                -2.555214e-01 1 1  ON 30
eH1_1                -1.538333e-01 1 1  ON 31
eH1_2                -1.066472e-01 1 1  ON 32
eH1_3                -5.190071e-02 1 1  ON 33
eH1_4                -3.324015e-03 1 1  ON 34
eH1_5                 3.228761e-02 1 1  ON 35
eH1_6                 9.352615e-02 1 1  ON 36
eH1_7                 1.549277e-01 1 1  ON 37
eH1_8                 1.945389e-01 1 1  ON 38
eH1_9                 9.526275e-02 1 1  ON 39
eH2_0                -2.525195e-01 1 1  ON 40
eH2_1                -1.512252e-01 1 1  ON 41
eH2_2                -1.038203e-01 1 1  ON 42
eH2_3                -4.918798e-02 1 1  ON 43
eH2_4                -9.001533e-04 1 1  ON 44
eH2_5                 3.398133e-02 1 1  ON 45
eH2_6                 9.531991e-02 1 1  ON 46
eH2_7                 1.555825e-01 1 1  ON 47
eH2_8                 1.975990e-01 1 1  ON 48
eH2_9                 8.847876e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5832e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.8473
    reference variance = 0.258751
====================================================
  Execution time = 2.0546e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3501e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5660e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335107079451
                                         uncertainty =       0.004051417316

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335107079451
                                         uncertainty =       0.004051417316

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409272902
  error estimate for blocks of size 2^( 2) =       0.000422589710
  error estimate for blocks of size 2^( 3) =       0.000435724508
  error estimate for blocks of size 2^( 4) =       0.000447097788
  error estimate for blocks of size 2^( 5) =       0.000455995186
  error estimate for blocks of size 2^( 6) =       0.000462914956
  error estimate for blocks of size 2^( 7) =       0.000468452482

      target function =                  N/A
              le_mean =     -16.906276661585
             les_mean =     286.157199007685
             stat err =       0.000458615103
             autocorr =       1.255656134954
              std dev =       0.578799289169
             le_variance =       0.335008617143


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690627666158e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906276661585       residual = 4.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906276665499       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906276666287       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906276664519       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906276662531       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906276661854       residual = 5.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906276661384       residual = 8.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+02 is 1.101359e-06

solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906276661585       residual = 4.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906276662564       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906276662761       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906276662319       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906276661822       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906276661653       residual = 5.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906276661534       residual = 8.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+02 is 2.754967e-07

solving harmonic davidson linear method for identity shift 2.5000e+03, overlap shift 2.5000e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906276661585       residual = 4.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906276661830       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906276661879       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906276661769       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906276661643       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906276661601       residual = 5.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906276661572       residual = 8.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+03 is 6.888399e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.133652 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6118e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.095640e-01 1 1  ON 0
 uu_1                 1.425815e-01 1 1  ON 1
 uu_2                 4.076134e-02 1 1  ON 2
 uu_3                -2.194140e-02 1 1  ON 3
 uu_4                -6.790647e-02 1 1  ON 4
 uu_5                -1.032227e-01 1 1  ON 5
 uu_6                -1.316440e-01 1 1  ON 6
 uu_7                -1.461030e-01 1 1  ON 7
 uu_8                -1.390716e-01 1 1  ON 8
 uu_9                -1.111791e-01 1 1  ON 9
 ud_0                 4.545938e-01 1 1  ON 10
 ud_1                 1.880371e-01 1 1  ON 11
 ud_2                 6.647460e-02 1 1  ON 12
 ud_3                -5.681665e-03 1 1  ON 13
 ud_4                -6.330223e-02 1 1  ON 14
 ud_5                -1.055740e-01 1 1  ON 15
 ud_6                -1.337241e-01 1 1  ON 16
 ud_7                -1.515501e-01 1 1  ON 17
 ud_8                -1.531851e-01 1 1  ON 18
 ud_9                -1.455840e-01 1 1  ON 19
 eO_0                -7.642508e-01 1 1  ON 20
 eO_1                -4.409255e-01 1 1  ON 21
 eO_2                -1.729922e-02 1 1  ON 22
 eO_3                 3.069413e-01 1 1  ON 23
 eO_4                 5.353403e-01 1 1  ON 24
 eO_5                 4.992179e-01 1 1  ON 25
 eO_6                 2.694208e-01 1 1  ON 26
 eO_7                -3.697752e-02 1 1  ON 27
 eO_8                -2.392634e-01 1 1  ON 28
 eO_9                -1.073767e-01 1 1  ON 29
eH1_0                -2.555215e-01 1 1  ON 30
eH1_1                -1.538334e-01 1 1  ON 31
eH1_2                -1.066473e-01 1 1  ON 32
eH1_3                -5.190079e-02 1 1  ON 33
eH1_4                -3.324060e-03 1 1  ON 34
eH1_5                 3.228764e-02 1 1  ON 35
eH1_6                 9.352607e-02 1 1  ON 36
eH1_7                 1.549276e-01 1 1  ON 37
eH1_8                 1.945390e-01 1 1  ON 38
eH1_9                 9.526302e-02 1 1  ON 39
eH2_0                -2.525197e-01 1 1  ON 40
eH2_1                -1.512252e-01 1 1  ON 41
eH2_2                -1.038204e-01 1 1  ON 42
eH2_3                -4.918805e-02 1 1  ON 43
eH2_4                -8.999672e-04 1 1  ON 44
eH2_5                 3.398130e-02 1 1  ON 45
eH2_6                 9.531982e-02 1 1  ON 46
eH2_7                 1.555824e-01 1 1  ON 47
eH2_8                 1.975990e-01 1 1  ON 48
eH2_9                 8.847898e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.8857
    reference variance = 0.272088
====================================================
  Execution time = 2.0392e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3262e-01
  Total weights = 2.0000e+06
  Execution time = 1.8968e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332677527867
                                         uncertainty =       0.002689219079

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332677527867
                                         uncertainty =       0.002689219079

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407812254
  error estimate for blocks of size 2^( 2) =       0.000420563820
  error estimate for blocks of size 2^( 3) =       0.000433971714
  error estimate for blocks of size 2^( 4) =       0.000446570167
  error estimate for blocks of size 2^( 5) =       0.000457083005
  error estimate for blocks of size 2^( 6) =       0.000464863064
  error estimate for blocks of size 2^( 7) =       0.000468139706

      target function =                  N/A
              le_mean =     -16.906371474832
             les_mean =     286.158017946993
             stat err =       0.000459163985
             autocorr =       1.267695917994
              std dev =       0.576733619882
             le_variance =       0.332621668302

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332677127055
                                         uncertainty =       0.002689205649

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332677127055
                                         uncertainty =       0.002689205649

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407812008
  error estimate for blocks of size 2^( 2) =       0.000420563587
  error estimate for blocks of size 2^( 3) =       0.000433971477
  error estimate for blocks of size 2^( 4) =       0.000446569930
  error estimate for blocks of size 2^( 5) =       0.000457082761
  error estimate for blocks of size 2^( 6) =       0.000464862832
  error estimate for blocks of size 2^( 7) =       0.000468139445

      target function =                  N/A
              le_mean =     -16.906371475707
             les_mean =     286.158017575410
             stat err =       0.000459163742
             autocorr =       1.267696103524
              std dev =       0.576733272085
             le_variance =       0.332621267130

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332677327064
                                         uncertainty =       0.002689212342

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332677327064
                                         uncertainty =       0.002689212342

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407812130
  error estimate for blocks of size 2^( 2) =       0.000420563703
  error estimate for blocks of size 2^( 3) =       0.000433971595
  error estimate for blocks of size 2^( 4) =       0.000446570048
  error estimate for blocks of size 2^( 5) =       0.000457082883
  error estimate for blocks of size 2^( 6) =       0.000464862948
  error estimate for blocks of size 2^( 7) =       0.000468139576

      target function =                  N/A
              le_mean =     -16.906371475276
             les_mean =     286.158017761032
             stat err =       0.000459163864
             autocorr =       1.267696010992
              std dev =       0.576733445639
             le_variance =       0.332621467318

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332677502753
                                         uncertainty =       0.002689218236

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332677502753
                                         uncertainty =       0.002689218236

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407812238
  error estimate for blocks of size 2^( 2) =       0.000420563805
  error estimate for blocks of size 2^( 3) =       0.000433971700
  error estimate for blocks of size 2^( 4) =       0.000446570152
  error estimate for blocks of size 2^( 5) =       0.000457082990
  error estimate for blocks of size 2^( 6) =       0.000464863049
  error estimate for blocks of size 2^( 7) =       0.000468139690

      target function =                  N/A
              le_mean =     -16.906371474887
             les_mean =     286.158017923738
             stat err =       0.000459163970
             autocorr =       1.267695929621
              std dev =       0.576733598090
             le_variance =       0.332621643166


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906371474832        initial
     1.5625e+02     1.5625e+03             1.1014e-06       -16.906371475707  <--
     6.2500e+02     6.2500e+03             2.7550e-07       -16.906371475276
     2.5000e+03     2.5000e+04             6.8884e-08       -16.906371474887

*****************************************************************************
Applying the update for shift_i =   1.5625e+02     and shift_s =   1.5625e+03
*****************************************************************************

  Execution time = 2.9868e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.095647e-01 1 1  ON 0
 uu_1                 1.425813e-01 1 1  ON 1
 uu_2                 4.076111e-02 1 1  ON 2
 uu_3                -2.194143e-02 1 1  ON 3
 uu_4                -6.790632e-02 1 1  ON 4
 uu_5                -1.032227e-01 1 1  ON 5
 uu_6                -1.316432e-01 1 1  ON 6
 uu_7                -1.461035e-01 1 1  ON 7
 uu_8                -1.390723e-01 1 1  ON 8
 uu_9                -1.111795e-01 1 1  ON 9
 ud_0                 4.545937e-01 1 1  ON 10
 ud_1                 1.880378e-01 1 1  ON 11
 ud_2                 6.647491e-02 1 1  ON 12
 ud_3                -5.680913e-03 1 1  ON 13
 ud_4                -6.330230e-02 1 1  ON 14
 ud_5                -1.055737e-01 1 1  ON 15
 ud_6                -1.337243e-01 1 1  ON 16
 ud_7                -1.515505e-01 1 1  ON 17
 ud_8                -1.531855e-01 1 1  ON 18
 ud_9                -1.455843e-01 1 1  ON 19
 eO_0                -7.642504e-01 1 1  ON 20
 eO_1                -4.409247e-01 1 1  ON 21
 eO_2                -1.729963e-02 1 1  ON 22
 eO_3                 3.069413e-01 1 1  ON 23
 eO_4                 5.353406e-01 1 1  ON 24
 eO_5                 4.992182e-01 1 1  ON 25
 eO_6                 2.694211e-01 1 1  ON 26
 eO_7                -3.697775e-02 1 1  ON 27
 eO_8                -2.392641e-01 1 1  ON 28
 eO_9                -1.073773e-01 1 1  ON 29
eH1_0                -2.555215e-01 1 1  ON 30
eH1_1                -1.538338e-01 1 1  ON 31
eH1_2                -1.066475e-01 1 1  ON 32
eH1_3                -5.190100e-02 1 1  ON 33
eH1_4                -3.324195e-03 1 1  ON 34
eH1_5                 3.228773e-02 1 1  ON 35
eH1_6                 9.352584e-02 1 1  ON 36
eH1_7                 1.549275e-01 1 1  ON 37
eH1_8                 1.945392e-01 1 1  ON 38
eH1_9                 9.526385e-02 1 1  ON 39
eH2_0                -2.525201e-01 1 1  ON 40
eH2_1                -1.512251e-01 1 1  ON 41
eH2_2                -1.038206e-01 1 1  ON 42
eH2_3                -4.918827e-02 1 1  ON 43
eH2_4                -8.994091e-04 1 1  ON 44
eH2_5                 3.398120e-02 1 1  ON 45
eH2_6                 9.531953e-02 1 1  ON 46
eH2_7                 1.555822e-01 1 1  ON 47
eH2_8                 1.975991e-01 1 1  ON 48
eH2_9                 8.847965e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5995e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6898e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.8872
    reference variance = 0.220269
====================================================
  Execution time = 2.1210e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4303e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6744e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343069559321
                                         uncertainty =       0.004424458324

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343069559321
                                         uncertainty =       0.004424458324

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414141583
  error estimate for blocks of size 2^( 2) =       0.000427147106
  error estimate for blocks of size 2^( 3) =       0.000440225923
  error estimate for blocks of size 2^( 4) =       0.000452742827
  error estimate for blocks of size 2^( 5) =       0.000463023413
  error estimate for blocks of size 2^( 6) =       0.000470879990
  error estimate for blocks of size 2^( 7) =       0.000477141084

      target function =                  N/A
              le_mean =     -16.906244820302
             les_mean =     286.164140254474
             stat err =       0.000465946829
             autocorr =       1.265829000253
              std dev =       0.585684643817
             le_variance =       0.343026502003


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690624482030e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906244820302       residual = 5.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906244828231       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906244834366       residual = 8.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906244837653       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906244840325       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906244834040       residual = 4.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906244837301       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906244836890       residual = 2.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+01 is 5.509578e-06

solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906244820302       residual = 5.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906244822291       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906244823832       residual = 8.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906244824662       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906244825347       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906244823779       residual = 4.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906244824603       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906244824499       residual = 2.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+02 is 1.378001e-06

solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906244820302       residual = 5.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906244820800       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906244821185       residual = 8.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906244821393       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906244821566       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906244821174       residual = 4.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906244821381       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906244821354       residual = 2.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+02 is 3.445381e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.136316 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6891e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.095646e-01 1 1  ON 0
 uu_1                 1.425813e-01 1 1  ON 1
 uu_2                 4.076124e-02 1 1  ON 2
 uu_3                -2.194166e-02 1 1  ON 3
 uu_4                -6.790613e-02 1 1  ON 4
 uu_5                -1.032232e-01 1 1  ON 5
 uu_6                -1.316434e-01 1 1  ON 6
 uu_7                -1.461043e-01 1 1  ON 7
 uu_8                -1.390724e-01 1 1  ON 8
 uu_9                -1.111795e-01 1 1  ON 9
 ud_0                 4.545934e-01 1 1  ON 10
 ud_1                 1.880382e-01 1 1  ON 11
 ud_2                 6.647478e-02 1 1  ON 12
 ud_3                -5.680965e-03 1 1  ON 13
 ud_4                -6.330209e-02 1 1  ON 14
 ud_5                -1.055737e-01 1 1  ON 15
 ud_6                -1.337246e-01 1 1  ON 16
 ud_7                -1.515505e-01 1 1  ON 17
 ud_8                -1.531853e-01 1 1  ON 18
 ud_9                -1.455840e-01 1 1  ON 19
 eO_0                -7.642497e-01 1 1  ON 20
 eO_1                -4.409246e-01 1 1  ON 21
 eO_2                -1.729944e-02 1 1  ON 22
 eO_3                 3.069413e-01 1 1  ON 23
 eO_4                 5.353410e-01 1 1  ON 24
 eO_5                 4.992183e-01 1 1  ON 25
 eO_6                 2.694209e-01 1 1  ON 26
 eO_7                -3.697807e-02 1 1  ON 27
 eO_8                -2.392644e-01 1 1  ON 28
 eO_9                -1.073780e-01 1 1  ON 29
eH1_0                -2.555221e-01 1 1  ON 30
eH1_1                -1.538330e-01 1 1  ON 31
eH1_2                -1.066478e-01 1 1  ON 32
eH1_3                -5.190153e-02 1 1  ON 33
eH1_4                -3.323936e-03 1 1  ON 34
eH1_5                 3.228675e-02 1 1  ON 35
eH1_6                 9.352500e-02 1 1  ON 36
eH1_7                 1.549275e-01 1 1  ON 37
eH1_8                 1.945396e-01 1 1  ON 38
eH1_9                 9.526522e-02 1 1  ON 39
eH2_0                -2.525213e-01 1 1  ON 40
eH2_1                -1.512255e-01 1 1  ON 41
eH2_2                -1.038207e-01 1 1  ON 42
eH2_3                -4.918877e-02 1 1  ON 43
eH2_4                -8.991307e-04 1 1  ON 44
eH2_5                 3.398103e-02 1 1  ON 45
eH2_6                 9.531908e-02 1 1  ON 46
eH2_7                 1.555828e-01 1 1  ON 47
eH2_8                 1.975997e-01 1 1  ON 48
eH2_9                 8.848089e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.9019
    reference variance = 0.213337
====================================================
  Execution time = 2.0416e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4214e-01
  Total weights = 2.0000e+06
  Execution time = 1.8885e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342082900328
                                         uncertainty =       0.004025786305

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342082900328
                                         uncertainty =       0.004025786305

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413605359
  error estimate for blocks of size 2^( 2) =       0.000426376749
  error estimate for blocks of size 2^( 3) =       0.000439014120
  error estimate for blocks of size 2^( 4) =       0.000450989131
  error estimate for blocks of size 2^( 5) =       0.000460343185
  error estimate for blocks of size 2^( 6) =       0.000468081575
  error estimate for blocks of size 2^( 7) =       0.000470196098

      target function =                  N/A
              le_mean =     -16.905664272233
             les_mean =     286.143623100926
             stat err =       0.000462402497
             autocorr =       1.249879158990
              std dev =       0.584926308655
             le_variance =       0.342138786557

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342081540410
                                         uncertainty =       0.004025767918

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342081540410
                                         uncertainty =       0.004025767918

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413604539
  error estimate for blocks of size 2^( 2) =       0.000426375983
  error estimate for blocks of size 2^( 3) =       0.000439013382
  error estimate for blocks of size 2^( 4) =       0.000450988373
  error estimate for blocks of size 2^( 5) =       0.000460342360
  error estimate for blocks of size 2^( 6) =       0.000468080781
  error estimate for blocks of size 2^( 7) =       0.000470195461

      target function =                  N/A
              le_mean =     -16.905664298444
             les_mean =     286.143622629227
             stat err =       0.000462401744
             autocorr =       1.249880046849
              std dev =       0.584925147881
             le_variance =       0.342137428623

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342082212094
                                         uncertainty =       0.004025777007

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342082212094
                                         uncertainty =       0.004025777007

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413604944
  error estimate for blocks of size 2^( 2) =       0.000426376361
  error estimate for blocks of size 2^( 3) =       0.000439013746
  error estimate for blocks of size 2^( 4) =       0.000450988747
  error estimate for blocks of size 2^( 5) =       0.000460342768
  error estimate for blocks of size 2^( 6) =       0.000468081173
  error estimate for blocks of size 2^( 7) =       0.000470195775

      target function =                  N/A
              le_mean =     -16.905664285372
             les_mean =     286.143622857937
             stat err =       0.000462402116
             autocorr =       1.249879607995
              std dev =       0.584925721199
             le_variance =       0.342138099320

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342082814028
                                         uncertainty =       0.004025785139

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342082814028
                                         uncertainty =       0.004025785139

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413605307
  error estimate for blocks of size 2^( 2) =       0.000426376700
  error estimate for blocks of size 2^( 3) =       0.000439014073
  error estimate for blocks of size 2^( 4) =       0.000450989083
  error estimate for blocks of size 2^( 5) =       0.000460343132
  error estimate for blocks of size 2^( 6) =       0.000468081525
  error estimate for blocks of size 2^( 7) =       0.000470196057

      target function =                  N/A
              le_mean =     -16.905664273875
             les_mean =     286.143623070276
             stat err =       0.000462402449
             autocorr =       1.249879215277
              std dev =       0.584926234991
             le_variance =       0.342138700381


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905664272233        initial
     3.9062e+01     3.9062e+02             5.5096e-06       -16.905664298444  <--
     1.5625e+02     1.5625e+03             1.3780e-06       -16.905664285372
     6.2500e+02     6.2500e+03             3.4454e-07       -16.905664273875

*****************************************************************************
Applying the update for shift_i =   3.9062e+01     and shift_s =   3.9062e+02
*****************************************************************************

  Execution time = 2.9930e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.095645e-01 1 1  ON 0
 uu_1                 1.425816e-01 1 1  ON 1
 uu_2                 4.076160e-02 1 1  ON 2
 uu_3                -2.194235e-02 1 1  ON 3
 uu_4                -6.790555e-02 1 1  ON 4
 uu_5                -1.032244e-01 1 1  ON 5
 uu_6                -1.316442e-01 1 1  ON 6
 uu_7                -1.461069e-01 1 1  ON 7
 uu_8                -1.390726e-01 1 1  ON 8
 uu_9                -1.111795e-01 1 1  ON 9
 ud_0                 4.545925e-01 1 1  ON 10
 ud_1                 1.880394e-01 1 1  ON 11
 ud_2                 6.647440e-02 1 1  ON 12
 ud_3                -5.681119e-03 1 1  ON 13
 ud_4                -6.330147e-02 1 1  ON 14
 ud_5                -1.055734e-01 1 1  ON 15
 ud_6                -1.337255e-01 1 1  ON 16
 ud_7                -1.515505e-01 1 1  ON 17
 ud_8                -1.531847e-01 1 1  ON 18
 ud_9                -1.455831e-01 1 1  ON 19
 eO_0                -7.642477e-01 1 1  ON 20
 eO_1                -4.409242e-01 1 1  ON 21
 eO_2                -1.729885e-02 1 1  ON 22
 eO_3                 3.069415e-01 1 1  ON 23
 eO_4                 5.353422e-01 1 1  ON 24
 eO_5                 4.992185e-01 1 1  ON 25
 eO_6                 2.694204e-01 1 1  ON 26
 eO_7                -3.697900e-02 1 1  ON 27
 eO_8                -2.392653e-01 1 1  ON 28
 eO_9                -1.073799e-01 1 1  ON 29
eH1_0                -2.555239e-01 1 1  ON 30
eH1_1                -1.538304e-01 1 1  ON 31
eH1_2                -1.066488e-01 1 1  ON 32
eH1_3                -5.190311e-02 1 1  ON 33
eH1_4                -3.323167e-03 1 1  ON 34
eH1_5                 3.228381e-02 1 1  ON 35
eH1_6                 9.352247e-02 1 1  ON 36
eH1_7                 1.549274e-01 1 1  ON 37
eH1_8                 1.945409e-01 1 1  ON 38
eH1_9                 9.526936e-02 1 1  ON 39
eH2_0                -2.525251e-01 1 1  ON 40
eH2_1                -1.512267e-01 1 1  ON 41
eH2_2                -1.038212e-01 1 1  ON 42
eH2_3                -4.919029e-02 1 1  ON 43
eH2_4                -8.983029e-04 1 1  ON 44
eH2_5                 3.398053e-02 1 1  ON 45
eH2_6                 9.531771e-02 1 1  ON 46
eH2_7                 1.555846e-01 1 1  ON 47
eH2_8                 1.976016e-01 1 1  ON 48
eH2_9                 8.848461e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6829e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6898e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.9204
    reference variance = 0.131242
====================================================
  Execution time = 2.2773e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.5158e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5456e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351715627246
                                         uncertainty =       0.015178186556

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351715627246
                                         uncertainty =       0.015178186556

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419274412
  error estimate for blocks of size 2^( 2) =       0.000431834182
  error estimate for blocks of size 2^( 3) =       0.000444654605
  error estimate for blocks of size 2^( 4) =       0.000456264382
  error estimate for blocks of size 2^( 5) =       0.000467269896
  error estimate for blocks of size 2^( 6) =       0.000475298938
  error estimate for blocks of size 2^( 7) =       0.000483386233

      target function =                  N/A
              le_mean =     -16.906703416710
             les_mean =     286.188202310419
             stat err =       0.000470554862
             autocorr =       1.259574364043
              std dev =       0.592943560222
             le_variance =       0.351582065608


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690670341671e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906703416710       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906703516840       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906703493666       residual = 3.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906703460506       residual = 6.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906703464818       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906703472996       residual = 6.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906703458627       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906703463255       residual = 5.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+00 is 1.821914e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906703416710       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906703442116       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906703436517       residual = 4.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906703428174       residual = 7.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906703428599       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906703431296       residual = 6.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906703427612       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906703428632       residual = 5.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+01 is 4.565784e-06

solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906703416710       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906703423085       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906703421699       residual = 4.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906703419615       residual = 7.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906703419674       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906703420385       residual = 6.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906703419462       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906703419709       residual = 5.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+02 is 1.142150e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.139009 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8325e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.095635e-01 1 1  ON 0
 uu_1                 1.425813e-01 1 1  ON 1
 uu_2                 4.076218e-02 1 1  ON 2
 uu_3                -2.194382e-02 1 1  ON 3
 uu_4                -6.790497e-02 1 1  ON 4
 uu_5                -1.032242e-01 1 1  ON 5
 uu_6                -1.316470e-01 1 1  ON 6
 uu_7                -1.461069e-01 1 1  ON 7
 uu_8                -1.390714e-01 1 1  ON 8
 uu_9                -1.111804e-01 1 1  ON 9
 ud_0                 4.545916e-01 1 1  ON 10
 ud_1                 1.880401e-01 1 1  ON 11
 ud_2                 6.647801e-02 1 1  ON 12
 ud_3                -5.680444e-03 1 1  ON 13
 ud_4                -6.330414e-02 1 1  ON 14
 ud_5                -1.055710e-01 1 1  ON 15
 ud_6                -1.337261e-01 1 1  ON 16
 ud_7                -1.515508e-01 1 1  ON 17
 ud_8                -1.531857e-01 1 1  ON 18
 ud_9                -1.455824e-01 1 1  ON 19
 eO_0                -7.642436e-01 1 1  ON 20
 eO_1                -4.409231e-01 1 1  ON 21
 eO_2                -1.730213e-02 1 1  ON 22
 eO_3                 3.069415e-01 1 1  ON 23
 eO_4                 5.353443e-01 1 1  ON 24
 eO_5                 4.992195e-01 1 1  ON 25
 eO_6                 2.694218e-01 1 1  ON 26
 eO_7                -3.697902e-02 1 1  ON 27
 eO_8                -2.392679e-01 1 1  ON 28
 eO_9                -1.073831e-01 1 1  ON 29
eH1_0                -2.555256e-01 1 1  ON 30
eH1_1                -1.538329e-01 1 1  ON 31
eH1_2                -1.066482e-01 1 1  ON 32
eH1_3                -5.190389e-02 1 1  ON 33
eH1_4                -3.322915e-03 1 1  ON 34
eH1_5                 3.228216e-02 1 1  ON 35
eH1_6                 9.352101e-02 1 1  ON 36
eH1_7                 1.549275e-01 1 1  ON 37
eH1_8                 1.945435e-01 1 1  ON 38
eH1_9                 9.527392e-02 1 1  ON 39
eH2_0                -2.525280e-01 1 1  ON 40
eH2_1                -1.512286e-01 1 1  ON 41
eH2_2                -1.038235e-01 1 1  ON 42
eH2_3                -4.919367e-02 1 1  ON 43
eH2_4                -8.967036e-04 1 1  ON 44
eH2_5                 3.398187e-02 1 1  ON 45
eH2_6                 9.531908e-02 1 1  ON 46
eH2_7                 1.555848e-01 1 1  ON 47
eH2_8                 1.976019e-01 1 1  ON 48
eH2_9                 8.848916e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.9593
    reference variance = 0.447928
====================================================
  Execution time = 2.0313e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4120e-01
  Total weights = 2.0000e+06
  Execution time = 1.9227e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340836374765
                                         uncertainty =       0.004329540235

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340836374765
                                         uncertainty =       0.004329540235

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413040220
  error estimate for blocks of size 2^( 2) =       0.000425620472
  error estimate for blocks of size 2^( 3) =       0.000438559994
  error estimate for blocks of size 2^( 4) =       0.000450757092
  error estimate for blocks of size 2^( 5) =       0.000460793193
  error estimate for blocks of size 2^( 6) =       0.000469259644
  error estimate for blocks of size 2^( 7) =       0.000475101712

      target function =                  N/A
              le_mean =     -16.906004298620
             les_mean =     286.154185620249
             stat err =       0.000463977910
             autocorr =       1.261856365864
              std dev =       0.584127080268
             le_variance =       0.341204445902

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340821890040
                                         uncertainty =       0.004329337303

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340821890040
                                         uncertainty =       0.004329337303

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413031459
  error estimate for blocks of size 2^( 2) =       0.000425612240
  error estimate for blocks of size 2^( 3) =       0.000438552191
  error estimate for blocks of size 2^( 4) =       0.000450749523
  error estimate for blocks of size 2^( 5) =       0.000460785814
  error estimate for blocks of size 2^( 6) =       0.000469252482
  error estimate for blocks of size 2^( 7) =       0.000475094668

      target function =                  N/A
              le_mean =     -16.906004327298
             les_mean =     286.154172116212
             stat err =       0.000463970622
             autocorr =       1.261870251048
              std dev =       0.584114690958
             le_variance =       0.341189972193

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340828932379
                                         uncertainty =       0.004329436222

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340828932379
                                         uncertainty =       0.004329436222

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413035718
  error estimate for blocks of size 2^( 2) =       0.000425616244
  error estimate for blocks of size 2^( 3) =       0.000438555988
  error estimate for blocks of size 2^( 4) =       0.000450753207
  error estimate for blocks of size 2^( 5) =       0.000460789405
  error estimate for blocks of size 2^( 6) =       0.000469255968
  error estimate for blocks of size 2^( 7) =       0.000475098098

      target function =                  N/A
              le_mean =     -16.906004313532
             les_mean =     286.154178687785
             stat err =       0.000463974170
             autocorr =       1.261863522606
              std dev =       0.584120714602
             le_variance =       0.341197009227

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340835437803
                                         uncertainty =       0.004329527152

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340835437803
                                         uncertainty =       0.004329527152

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413039653
  error estimate for blocks of size 2^( 2) =       0.000425619940
  error estimate for blocks of size 2^( 3) =       0.000438559490
  error estimate for blocks of size 2^( 4) =       0.000450756603
  error estimate for blocks of size 2^( 5) =       0.000460792716
  error estimate for blocks of size 2^( 6) =       0.000469259181
  error estimate for blocks of size 2^( 7) =       0.000475101257

      target function =                  N/A
              le_mean =     -16.906004300467
             les_mean =     286.154184746468
             stat err =       0.000463977439
             autocorr =       1.261857267275
              std dev =       0.584126278865
             le_variance =       0.341203509661


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906004298620        initial
     9.7656e+00     9.7656e+01             1.8219e-05       -16.906004327298  <--
     3.9062e+01     3.9062e+02             4.5658e-06       -16.906004313532
     1.5625e+02     1.5625e+03             1.1422e-06       -16.906004300467

*****************************************************************************
Applying the update for shift_i =   9.7656e+00     and shift_s =   9.7656e+01
*****************************************************************************

  Execution time = 2.9839e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.095603e-01 1 1  ON 0
 uu_1                 1.425805e-01 1 1  ON 1
 uu_2                 4.076377e-02 1 1  ON 2
 uu_3                -2.194798e-02 1 1  ON 3
 uu_4                -6.790345e-02 1 1  ON 4
 uu_5                -1.032234e-01 1 1  ON 5
 uu_6                -1.316554e-01 1 1  ON 6
 uu_7                -1.461071e-01 1 1  ON 7
 uu_8                -1.390677e-01 1 1  ON 8
 uu_9                -1.111831e-01 1 1  ON 9
 ud_0                 4.545890e-01 1 1  ON 10
 ud_1                 1.880422e-01 1 1  ON 11
 ud_2                 6.648843e-02 1 1  ON 12
 ud_3                -5.678372e-03 1 1  ON 13
 ud_4                -6.331181e-02 1 1  ON 14
 ud_5                -1.055641e-01 1 1  ON 15
 ud_6                -1.337278e-01 1 1  ON 16
 ud_7                -1.515519e-01 1 1  ON 17
 ud_8                -1.531886e-01 1 1  ON 18
 ud_9                -1.455804e-01 1 1  ON 19
 eO_0                -7.642315e-01 1 1  ON 20
 eO_1                -4.409199e-01 1 1  ON 21
 eO_2                -1.731164e-02 1 1  ON 22
 eO_3                 3.069414e-01 1 1  ON 23
 eO_4                 5.353508e-01 1 1  ON 24
 eO_5                 4.992225e-01 1 1  ON 25
 eO_6                 2.694259e-01 1 1  ON 26
 eO_7                -3.697910e-02 1 1  ON 27
 eO_8                -2.392758e-01 1 1  ON 28
 eO_9                -1.073926e-01 1 1  ON 29
eH1_0                -2.555305e-01 1 1  ON 30
eH1_1                -1.538402e-01 1 1  ON 31
eH1_2                -1.066466e-01 1 1  ON 32
eH1_3                -5.190614e-02 1 1  ON 33
eH1_4                -3.322148e-03 1 1  ON 34
eH1_5                 3.227718e-02 1 1  ON 35
eH1_6                 9.351662e-02 1 1  ON 36
eH1_7                 1.549277e-01 1 1  ON 37
eH1_8                 1.945512e-01 1 1  ON 38
eH1_9                 9.528758e-02 1 1  ON 39
eH2_0                -2.525364e-01 1 1  ON 40
eH2_1                -1.512345e-01 1 1  ON 41
eH2_2                -1.038303e-01 1 1  ON 42
eH2_3                -4.920364e-02 1 1  ON 43
eH2_4                -8.920279e-04 1 1  ON 44
eH2_5                 3.398593e-02 1 1  ON 45
eH2_6                 9.532322e-02 1 1  ON 46
eH2_7                 1.555852e-01 1 1  ON 47
eH2_8                 1.976027e-01 1 1  ON 48
eH2_9                 8.850278e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8171e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.8977
    reference variance = 0.349116
====================================================
  Execution time = 2.0659e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4297e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5496e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343051609269
                                         uncertainty =       0.003833969793

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343051609269
                                         uncertainty =       0.003833969793

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414105711
  error estimate for blocks of size 2^( 2) =       0.000426742954
  error estimate for blocks of size 2^( 3) =       0.000439816756
  error estimate for blocks of size 2^( 4) =       0.000452323971
  error estimate for blocks of size 2^( 5) =       0.000463974481
  error estimate for blocks of size 2^( 6) =       0.000471795350
  error estimate for blocks of size 2^( 7) =       0.000476702216

      target function =                  N/A
              le_mean =     -16.906652639520
             les_mean =     286.177870381829
             stat err =       0.000466199005
             autocorr =       1.267419088069
              std dev =       0.585633912892
             le_variance =       0.342967079930


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690665263952e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906652639520       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906652687675       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906652712244       residual = 9.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906652526044       residual = 5.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906652431768       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906652485008       residual = 5.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906652475115       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906652458637       residual = 4.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+00 is 7.250521e-05

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906652639520       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906652652348       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906652659908       residual = 9.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906652611024       residual = 5.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906652580936       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906652593078       residual = 4.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906652591731       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906652586380       residual = 3.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+00 is 1.842629e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906652639520       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906652642780       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906652644770       residual = 9.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906652632390       residual = 5.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906652624426       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906652627352       residual = 3.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906652627061       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906652625643       residual = 3.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+01 is 4.624899e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.141723 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6215e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.095560e-01 1 1  ON 0
 uu_1                 1.425799e-01 1 1  ON 1
 uu_2                 4.076275e-02 1 1  ON 2
 uu_3                -2.195120e-02 1 1  ON 3
 uu_4                -6.790298e-02 1 1  ON 4
 uu_5                -1.032287e-01 1 1  ON 5
 uu_6                -1.316489e-01 1 1  ON 6
 uu_7                -1.461113e-01 1 1  ON 7
 uu_8                -1.390656e-01 1 1  ON 8
 uu_9                -1.111873e-01 1 1  ON 9
 ud_0                 4.545760e-01 1 1  ON 10
 ud_1                 1.880504e-01 1 1  ON 11
 ud_2                 6.649407e-02 1 1  ON 12
 ud_3                -5.666863e-03 1 1  ON 13
 ud_4                -6.330237e-02 1 1  ON 14
 ud_5                -1.055641e-01 1 1  ON 15
 ud_6                -1.337248e-01 1 1  ON 16
 ud_7                -1.515542e-01 1 1  ON 17
 ud_8                -1.531894e-01 1 1  ON 18
 ud_9                -1.455897e-01 1 1  ON 19
 eO_0                -7.642222e-01 1 1  ON 20
 eO_1                -4.409030e-01 1 1  ON 21
 eO_2                -1.731570e-02 1 1  ON 22
 eO_3                 3.069230e-01 1 1  ON 23
 eO_4                 5.353579e-01 1 1  ON 24
 eO_5                 4.992355e-01 1 1  ON 25
 eO_6                 2.694328e-01 1 1  ON 26
 eO_7                -3.698253e-02 1 1  ON 27
 eO_8                -2.392864e-01 1 1  ON 28
 eO_9                -1.074066e-01 1 1  ON 29
eH1_0                -2.555350e-01 1 1  ON 30
eH1_1                -1.538442e-01 1 1  ON 31
eH1_2                -1.066526e-01 1 1  ON 32
eH1_3                -5.191500e-02 1 1  ON 33
eH1_4                -3.317944e-03 1 1  ON 34
eH1_5                 3.226908e-02 1 1  ON 35
eH1_6                 9.351503e-02 1 1  ON 36
eH1_7                 1.549389e-01 1 1  ON 37
eH1_8                 1.945581e-01 1 1  ON 38
eH1_9                 9.529742e-02 1 1  ON 39
eH2_0                -2.525468e-01 1 1  ON 40
eH2_1                -1.512337e-01 1 1  ON 41
eH2_2                -1.038391e-01 1 1  ON 42
eH2_3                -4.921471e-02 1 1  ON 43
eH2_4                -8.851823e-04 1 1  ON 44
eH2_5                 3.399188e-02 1 1  ON 45
eH2_6                 9.532457e-02 1 1  ON 46
eH2_7                 1.555837e-01 1 1  ON 47
eH2_8                 1.976053e-01 1 1  ON 48
eH2_9                 8.851731e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.9164
    reference variance = 0.446295
====================================================
  Execution time = 2.0042e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4564e-01
  Total weights = 2.0000e+06
  Execution time = 1.8904e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345645446048
                                         uncertainty =       0.004807631820

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345645446048
                                         uncertainty =       0.004807631820

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415724992
  error estimate for blocks of size 2^( 2) =       0.000428040972
  error estimate for blocks of size 2^( 3) =       0.000441226749
  error estimate for blocks of size 2^( 4) =       0.000454379242
  error estimate for blocks of size 2^( 5) =       0.000466276094
  error estimate for blocks of size 2^( 6) =       0.000475065398
  error estimate for blocks of size 2^( 7) =       0.000483197266

      target function =                  N/A
              le_mean =     -16.905505666408
             les_mean =     286.141776202021
             stat err =       0.000469729500
             autocorr =       1.276683965454
              std dev =       0.587923921848
             le_variance =       0.345654537881

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345588794304
                                         uncertainty =       0.004807418649

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345588794304
                                         uncertainty =       0.004807418649

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415690941
  error estimate for blocks of size 2^( 2) =       0.000428008230
  error estimate for blocks of size 2^( 3) =       0.000441194989
  error estimate for blocks of size 2^( 4) =       0.000454348496
  error estimate for blocks of size 2^( 5) =       0.000466246947
  error estimate for blocks of size 2^( 6) =       0.000475037253
  error estimate for blocks of size 2^( 7) =       0.000483167796

      target function =                  N/A
              le_mean =     -16.905505797729
             les_mean =     286.141724020597
             stat err =       0.000469700123
             autocorr =       1.276733424432
              std dev =       0.587875766092
             le_variance =       0.345597916358

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345613550798
                                         uncertainty =       0.004807511208

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345613550798
                                         uncertainty =       0.004807511208

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415705822
  error estimate for blocks of size 2^( 2) =       0.000428022546
  error estimate for blocks of size 2^( 3) =       0.000441208875
  error estimate for blocks of size 2^( 4) =       0.000454361950
  error estimate for blocks of size 2^( 5) =       0.000466259696
  error estimate for blocks of size 2^( 6) =       0.000475049558
  error estimate for blocks of size 2^( 7) =       0.000483180674

      target function =                  N/A
              le_mean =     -16.905505735187
             les_mean =     286.141746649991
             stat err =       0.000469712970
             autocorr =       1.276711854269
              std dev =       0.587896810978
             le_variance =       0.345622660358

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345641327087
                                         uncertainty =       0.004807616255

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345641327087
                                         uncertainty =       0.004807616255

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415722516
  error estimate for blocks of size 2^( 2) =       0.000428038592
  error estimate for blocks of size 2^( 3) =       0.000441224441
  error estimate for blocks of size 2^( 4) =       0.000454377009
  error estimate for blocks of size 2^( 5) =       0.000466273976
  error estimate for blocks of size 2^( 6) =       0.000475063352
  error estimate for blocks of size 2^( 7) =       0.000483195123

      target function =                  N/A
              le_mean =     -16.905505674858
             les_mean =     286.141772371059
             stat err =       0.000469727365
             autocorr =       1.276687566305
              std dev =       0.587920420834
             le_variance =       0.345650421234


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905505666408        initial
     2.4414e+00     2.4414e+01             7.2505e-05       -16.905505797729  <--
     9.7656e+00     9.7656e+01             1.8426e-05       -16.905505735187
     3.9062e+01     3.9062e+02             4.6249e-06       -16.905505674858

*****************************************************************************
Applying the update for shift_i =   2.4414e+00     and shift_s =   2.4414e+01
*****************************************************************************

  Execution time = 2.9535e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.095443e-01 1 1  ON 0
 uu_1                 1.425771e-01 1 1  ON 1
 uu_2                 4.075987e-02 1 1  ON 2
 uu_3                -2.195948e-02 1 1  ON 3
 uu_4                -6.790235e-02 1 1  ON 4
 uu_5                -1.032438e-01 1 1  ON 5
 uu_6                -1.316313e-01 1 1  ON 6
 uu_7                -1.461235e-01 1 1  ON 7
 uu_8                -1.390594e-01 1 1  ON 8
 uu_9                -1.112000e-01 1 1  ON 9
 ud_0                 4.545450e-01 1 1  ON 10
 ud_1                 1.880712e-01 1 1  ON 11
 ud_2                 6.651081e-02 1 1  ON 12
 ud_3                -5.634553e-03 1 1  ON 13
 ud_4                -6.327556e-02 1 1  ON 14
 ud_5                -1.055634e-01 1 1  ON 15
 ud_6                -1.337173e-01 1 1  ON 16
 ud_7                -1.515613e-01 1 1  ON 17
 ud_8                -1.531921e-01 1 1  ON 18
 ud_9                -1.456176e-01 1 1  ON 19
 eO_0                -7.641925e-01 1 1  ON 20
 eO_1                -4.408555e-01 1 1  ON 21
 eO_2                -1.732682e-02 1 1  ON 22
 eO_3                 3.068689e-01 1 1  ON 23
 eO_4                 5.353783e-01 1 1  ON 24
 eO_5                 4.992736e-01 1 1  ON 25
 eO_6                 2.694530e-01 1 1  ON 26
 eO_7                -3.699269e-02 1 1  ON 27
 eO_8                -2.393179e-01 1 1  ON 28
 eO_9                -1.074482e-01 1 1  ON 29
eH1_0                -2.555482e-01 1 1  ON 30
eH1_1                -1.538566e-01 1 1  ON 31
eH1_2                -1.066700e-01 1 1  ON 32
eH1_3                -5.194050e-02 1 1  ON 33
eH1_4                -3.305965e-03 1 1  ON 34
eH1_5                 3.224536e-02 1 1  ON 35
eH1_6                 9.351001e-02 1 1  ON 36
eH1_7                 1.549719e-01 1 1  ON 37
eH1_8                 1.945788e-01 1 1  ON 38
eH1_9                 9.532659e-02 1 1  ON 39
eH2_0                -2.525770e-01 1 1  ON 40
eH2_1                -1.512332e-01 1 1  ON 41
eH2_2                -1.038640e-01 1 1  ON 42
eH2_3                -4.924620e-02 1 1  ON 43
eH2_4                -8.660578e-04 1 1  ON 44
eH2_5                 3.400980e-02 1 1  ON 45
eH2_6                 9.532859e-02 1 1  ON 46
eH2_7                 1.555790e-01 1 1  ON 47
eH2_8                 1.976128e-01 1 1  ON 48
eH2_9                 8.856031e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5758e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.9505
    reference variance = 0.507949
====================================================
  Execution time = 2.0947e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3722e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5303e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337174635690
                                         uncertainty =       0.003162784215

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337174635690
                                         uncertainty =       0.003162784215

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410619108
  error estimate for blocks of size 2^( 2) =       0.000423452810
  error estimate for blocks of size 2^( 3) =       0.000436523035
  error estimate for blocks of size 2^( 4) =       0.000448150014
  error estimate for blocks of size 2^( 5) =       0.000459252951
  error estimate for blocks of size 2^( 6) =       0.000467349002
  error estimate for blocks of size 2^( 7) =       0.000474583608

      target function =                  N/A
              le_mean =     -16.905810367779
             les_mean =     286.143640125651
             stat err =       0.000462333894
             autocorr =       1.267748648117
              std dev =       0.580703110862
             le_variance =       0.337216102965


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690581036778e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905810367779       residual = 4.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905810808710       residual = 8.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905810837516       residual = 8.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905810631828       residual = 5.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905810715848       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905810934581       residual = 8.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905810856425       residual = 3.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905811048733       residual = 7.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-01 is 3.031002e-04

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905810367779       residual = 4.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905810504138       residual = 9.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905810542584       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905810474461       residual = 4.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905810420173       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905810508845       residual = 6.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905810503936       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905810532069       residual = 3.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+00 is 7.683353e-05

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905810367779       residual = 4.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905810404016       residual = 9.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905810416589       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905810398699       residual = 3.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905810378488       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905810401236       residual = 5.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905810402516       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905810407886       residual = 2.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+00 is 1.927241e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.144443 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6484e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.095405e-01 1 1  ON 0
 uu_1                 1.426051e-01 1 1  ON 1
 uu_2                 4.076355e-02 1 1  ON 2
 uu_3                -2.196514e-02 1 1  ON 3
 uu_4                -6.791155e-02 1 1  ON 4
 uu_5                -1.032463e-01 1 1  ON 5
 uu_6                -1.316502e-01 1 1  ON 6
 uu_7                -1.461458e-01 1 1  ON 7
 uu_8                -1.390885e-01 1 1  ON 8
 uu_9                -1.112097e-01 1 1  ON 9
 ud_0                 4.545484e-01 1 1  ON 10
 ud_1                 1.880804e-01 1 1  ON 11
 ud_2                 6.653934e-02 1 1  ON 12
 ud_3                -5.638985e-03 1 1  ON 13
 ud_4                -6.327580e-02 1 1  ON 14
 ud_5                -1.055461e-01 1 1  ON 15
 ud_6                -1.337442e-01 1 1  ON 16
 ud_7                -1.515482e-01 1 1  ON 17
 ud_8                -1.531834e-01 1 1  ON 18
 ud_9                -1.456207e-01 1 1  ON 19
 eO_0                -7.641232e-01 1 1  ON 20
 eO_1                -4.408677e-01 1 1  ON 21
 eO_2                -1.734864e-02 1 1  ON 22
 eO_3                 3.068850e-01 1 1  ON 23
 eO_4                 5.353810e-01 1 1  ON 24
 eO_5                 4.993031e-01 1 1  ON 25
 eO_6                 2.694844e-01 1 1  ON 26
 eO_7                -3.700693e-02 1 1  ON 27
 eO_8                -2.393549e-01 1 1  ON 28
 eO_9                -1.074991e-01 1 1  ON 29
eH1_0                -2.555616e-01 1 1  ON 30
eH1_1                -1.538994e-01 1 1  ON 31
eH1_2                -1.067416e-01 1 1  ON 32
eH1_3                -5.197427e-02 1 1  ON 33
eH1_4                -3.308094e-03 1 1  ON 34
eH1_5                 3.226251e-02 1 1  ON 35
eH1_6                 9.352742e-02 1 1  ON 36
eH1_7                 1.549845e-01 1 1  ON 37
eH1_8                 1.946313e-01 1 1  ON 38
eH1_9                 9.538763e-02 1 1  ON 39
eH2_0                -2.526016e-01 1 1  ON 40
eH2_1                -1.512337e-01 1 1  ON 41
eH2_2                -1.039033e-01 1 1  ON 42
eH2_3                -4.924910e-02 1 1  ON 43
eH2_4                -9.062979e-04 1 1  ON 44
eH2_5                 3.402813e-02 1 1  ON 45
eH2_6                 9.531848e-02 1 1  ON 46
eH2_7                 1.555767e-01 1 1  ON 47
eH2_8                 1.976231e-01 1 1  ON 48
eH2_9                 8.863715e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.8942
    reference variance = 0.300105
====================================================
  Execution time = 2.0373e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5495e-01
  Total weights = 2.0000e+06
  Execution time = 1.8957e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354827956809
                                         uncertainty =       0.016878556124

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354827956809
                                         uncertainty =       0.016878556124

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421280924
  error estimate for blocks of size 2^( 2) =       0.000433726791
  error estimate for blocks of size 2^( 3) =       0.000446456553
  error estimate for blocks of size 2^( 4) =       0.000457230624
  error estimate for blocks of size 2^( 5) =       0.000466250442
  error estimate for blocks of size 2^( 6) =       0.000472599414
  error estimate for blocks of size 2^( 7) =       0.000478946194

      target function =                  N/A
              le_mean =     -16.905671849978
             les_mean =     286.156695755106
             stat err =       0.000468756668
             autocorr =       1.238087473305
              std dev =       0.595781195956
             le_variance =       0.354955233454

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354797581000
                                         uncertainty =       0.016870697093

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354797581000
                                         uncertainty =       0.016870697093

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421262888
  error estimate for blocks of size 2^( 2) =       0.000433709360
  error estimate for blocks of size 2^( 3) =       0.000446438348
  error estimate for blocks of size 2^( 4) =       0.000457211654
  error estimate for blocks of size 2^( 5) =       0.000466230259
  error estimate for blocks of size 2^( 6) =       0.000472576374
  error estimate for blocks of size 2^( 7) =       0.000478926772

      target function =                  N/A
              le_mean =     -16.905672294123
             les_mean =     286.156680380617
             stat err =       0.000468736265
             autocorr =       1.238085701436
              std dev =       0.595755689681
             le_variance =       0.354924841787

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354809905905
                                         uncertainty =       0.016873310657

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354809905905
                                         uncertainty =       0.016873310657

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421270209
  error estimate for blocks of size 2^( 2) =       0.000433716522
  error estimate for blocks of size 2^( 3) =       0.000446445841
  error estimate for blocks of size 2^( 4) =       0.000457219441
  error estimate for blocks of size 2^( 5) =       0.000466238453
  error estimate for blocks of size 2^( 6) =       0.000472585317
  error estimate for blocks of size 2^( 7) =       0.000478934247

      target function =                  N/A
              le_mean =     -16.905672186486
             les_mean =     286.156689076883
             stat err =       0.000468744364
             autocorr =       1.238085458651
              std dev =       0.595766042517
             le_variance =       0.354937177417

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354825535423
                                         uncertainty =       0.016877822105

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354825535423
                                         uncertainty =       0.016877822105

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421279487
  error estimate for blocks of size 2^( 2) =       0.000433725418
  error estimate for blocks of size 2^( 3) =       0.000446455122
  error estimate for blocks of size 2^( 4) =       0.000457229130
  error estimate for blocks of size 2^( 5) =       0.000466248836
  error estimate for blocks of size 2^( 6) =       0.000472597510
  error estimate for blocks of size 2^( 7) =       0.000478944569

      target function =                  N/A
              le_mean =     -16.905671894840
             les_mean =     286.156694850158
             stat err =       0.000468755011
             autocorr =       1.238087167925
              std dev =       0.595779163480
             le_variance =       0.354952811637


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905671849978        initial
     6.1035e-01     6.1035e+00             3.0310e-04       -16.905672294123  <--
     2.4414e+00     2.4414e+01             7.6834e-05       -16.905672186486
     9.7656e+00     9.7656e+01             1.9272e-05       -16.905671894840

*****************************************************************************
Applying the update for shift_i =   6.1035e-01     and shift_s =   6.1035e+00
*****************************************************************************

  Execution time = 2.9879e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.095360e-01 1 1  ON 0
 uu_1                 1.426586e-01 1 1  ON 1
 uu_2                 4.078294e-02 1 1  ON 2
 uu_3                -2.197637e-02 1 1  ON 3
 uu_4                -6.793128e-02 1 1  ON 4
 uu_5                -1.032603e-01 1 1  ON 5
 uu_6                -1.317016e-01 1 1  ON 6
 uu_7                -1.462087e-01 1 1  ON 7
 uu_8                -1.391733e-01 1 1  ON 8
 uu_9                -1.112384e-01 1 1  ON 9
 ud_0                 4.545562e-01 1 1  ON 10
 ud_1                 1.881089e-01 1 1  ON 11
 ud_2                 6.659869e-02 1 1  ON 12
 ud_3                -5.631298e-03 1 1  ON 13
 ud_4                -6.326878e-02 1 1  ON 14
 ud_5                -1.055130e-01 1 1  ON 15
 ud_6                -1.338022e-01 1 1  ON 16
 ud_7                -1.515153e-01 1 1  ON 17
 ud_8                -1.531599e-01 1 1  ON 18
 ud_9                -1.456288e-01 1 1  ON 19
 eO_0                -7.639581e-01 1 1  ON 20
 eO_1                -4.408669e-01 1 1  ON 21
 eO_2                -1.739232e-02 1 1  ON 22
 eO_3                 3.069100e-01 1 1  ON 23
 eO_4                 5.353902e-01 1 1  ON 24
 eO_5                 4.993916e-01 1 1  ON 25
 eO_6                 2.695780e-01 1 1  ON 26
 eO_7                -3.704900e-02 1 1  ON 27
 eO_8                -2.394634e-01 1 1  ON 28
 eO_9                -1.076489e-01 1 1  ON 29
eH1_0                -2.556157e-01 1 1  ON 30
eH1_1                -1.540297e-01 1 1  ON 31
eH1_2                -1.069306e-01 1 1  ON 32
eH1_3                -5.207223e-02 1 1  ON 33
eH1_4                -3.328391e-03 1 1  ON 34
eH1_5                 3.231570e-02 1 1  ON 35
eH1_6                 9.358304e-02 1 1  ON 36
eH1_7                 1.550238e-01 1 1  ON 37
eH1_8                 1.947863e-01 1 1  ON 38
eH1_9                 9.556749e-02 1 1  ON 39
eH2_0                -2.526743e-01 1 1  ON 40
eH2_1                -1.512489e-01 1 1  ON 41
eH2_2                -1.040032e-01 1 1  ON 42
eH2_3                -4.926734e-02 1 1  ON 43
eH2_4                -1.010042e-03 1 1  ON 44
eH2_5                 3.407612e-02 1 1  ON 45
eH2_6                 9.528822e-02 1 1  ON 46
eH2_7                 1.555694e-01 1 1  ON 47
eH2_8                 1.976531e-01 1 1  ON 48
eH2_9                 8.886342e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6370e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.8868
    reference variance = 0.249114
====================================================
  Execution time = 2.0540e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4096e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5320e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340864904761
                                         uncertainty =       0.005292731063

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340864904761
                                         uncertainty =       0.005292731063

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412891515
  error estimate for blocks of size 2^( 2) =       0.000425507693
  error estimate for blocks of size 2^( 3) =       0.000438390749
  error estimate for blocks of size 2^( 4) =       0.000450361172
  error estimate for blocks of size 2^( 5) =       0.000461259256
  error estimate for blocks of size 2^( 6) =       0.000469064160
  error estimate for blocks of size 2^( 7) =       0.000474636966

      target function =                  N/A
              le_mean =     -16.905723032582
             les_mean =     286.144429890453
             stat err =       0.000463830389
             autocorr =       1.261962590194
              std dev =       0.583916780512
             le_variance =       0.340958806563


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690572303258e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905723032582       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905723593563       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905724095955       residual = 9.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905724711343       residual = 8.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905724505601       residual = 6.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905725875115       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905724966571       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905725137772       residual = 6.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905725328342       residual = 2.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905725589814       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905725364598       residual = 7.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e-01 is 1.270043e-03

solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905723032582       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905723271307       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905723417971       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905723603145       residual = 5.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905723760104       residual = 3.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905724148307       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905723975522       residual = 2.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905723851234       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905723989902       residual = 3.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-01 is 3.208892e-04

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905723032582       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905723104971       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905723141510       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905723184175       residual = 3.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905723248529       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905723338769       residual = 6.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905723316822       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905723274663       residual = 5.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+00 is 7.899456e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.148526 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6080e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.095797e-01 1 1  ON 0
 uu_1                 1.427362e-01 1 1  ON 1
 uu_2                 4.080204e-02 1 1  ON 2
 uu_3                -2.202844e-02 1 1  ON 3
 uu_4                -6.804940e-02 1 1  ON 4
 uu_5                -1.033012e-01 1 1  ON 5
 uu_6                -1.318385e-01 1 1  ON 6
 uu_7                -1.464370e-01 1 1  ON 7
 uu_8                -1.391292e-01 1 1  ON 8
 uu_9                -1.111757e-01 1 1  ON 9
 ud_0                 4.544713e-01 1 1  ON 10
 ud_1                 1.880262e-01 1 1  ON 11
 ud_2                 6.652549e-02 1 1  ON 12
 ud_3                -5.663584e-03 1 1  ON 13
 ud_4                -6.331716e-02 1 1  ON 14
 ud_5                -1.055397e-01 1 1  ON 15
 ud_6                -1.337517e-01 1 1  ON 16
 ud_7                -1.516015e-01 1 1  ON 17
 ud_8                -1.529970e-01 1 1  ON 18
 ud_9                -1.453809e-01 1 1  ON 19
 eO_0                -7.638908e-01 1 1  ON 20
 eO_1                -4.409030e-01 1 1  ON 21
 eO_2                -1.736077e-02 1 1  ON 22
 eO_3                 3.069261e-01 1 1  ON 23
 eO_4                 5.355042e-01 1 1  ON 24
 eO_5                 4.994394e-01 1 1  ON 25
 eO_6                 2.696293e-01 1 1  ON 26
 eO_7                -3.709851e-02 1 1  ON 27
 eO_8                -2.395129e-01 1 1  ON 28
 eO_9                -1.078177e-01 1 1  ON 29
eH1_0                -2.557118e-01 1 1  ON 30
eH1_1                -1.541612e-01 1 1  ON 31
eH1_2                -1.069566e-01 1 1  ON 32
eH1_3                -5.211733e-02 1 1  ON 33
eH1_4                -3.351993e-03 1 1  ON 34
eH1_5                 3.222265e-02 1 1  ON 35
eH1_6                 9.355970e-02 1 1  ON 36
eH1_7                 1.550669e-01 1 1  ON 37
eH1_8                 1.948735e-01 1 1  ON 38
eH1_9                 9.580888e-02 1 1  ON 39
eH2_0                -2.527595e-01 1 1  ON 40
eH2_1                -1.513513e-01 1 1  ON 41
eH2_2                -1.041988e-01 1 1  ON 42
eH2_3                -4.949775e-02 1 1  ON 43
eH2_4                -1.049606e-03 1 1  ON 44
eH2_5                 3.404614e-02 1 1  ON 45
eH2_6                 9.532748e-02 1 1  ON 46
eH2_7                 1.557077e-01 1 1  ON 47
eH2_8                 1.978228e-01 1 1  ON 48
eH2_9                 8.918430e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.8912
    reference variance = 0.410004
====================================================
  Execution time = 2.0207e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4237e-01
  Total weights = 2.0000e+06
  Execution time = 2.0894e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342401339282
                                         uncertainty =       0.003193770249

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342401339282
                                         uncertainty =       0.003193770249

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413733641
  error estimate for blocks of size 2^( 2) =       0.000426263141
  error estimate for blocks of size 2^( 3) =       0.000438869342
  error estimate for blocks of size 2^( 4) =       0.000451023073
  error estimate for blocks of size 2^( 5) =       0.000460922065
  error estimate for blocks of size 2^( 6) =       0.000469333928
  error estimate for blocks of size 2^( 7) =       0.000473902502

      target function =                  N/A
              le_mean =     -16.906236848944
             les_mean =     286.163195273055
             stat err =       0.000463795392
             autocorr =       1.256640892358
              std dev =       0.585107726528
             le_variance =       0.342351051643

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342478238398
                                         uncertainty =       0.003194658319

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342478238398
                                         uncertainty =       0.003194658319

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413780120
  error estimate for blocks of size 2^( 2) =       0.000426308967
  error estimate for blocks of size 2^( 3) =       0.000438913544
  error estimate for blocks of size 2^( 4) =       0.000451067008
  error estimate for blocks of size 2^( 5) =       0.000460961727
  error estimate for blocks of size 2^( 6) =       0.000469363796
  error estimate for blocks of size 2^( 7) =       0.000473934037

      target function =                  N/A
              le_mean =     -16.906236745724
             les_mean =     286.163268707303
             stat err =       0.000463831642
             autocorr =       1.256554998424
              std dev =       0.585173458097
             le_variance =       0.342427976061

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342443757935
                                         uncertainty =       0.003194290831

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342443757935
                                         uncertainty =       0.003194290831

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413759295
  error estimate for blocks of size 2^( 2) =       0.000426288131
  error estimate for blocks of size 2^( 3) =       0.000438893360
  error estimate for blocks of size 2^( 4) =       0.000451048267
  error estimate for blocks of size 2^( 5) =       0.000460944081
  error estimate for blocks of size 2^( 6) =       0.000469350407
  error estimate for blocks of size 2^( 7) =       0.000473921209

      target function =                  N/A
              le_mean =     -16.906236314764
             les_mean =     286.163219668417
             stat err =       0.000463815991
             autocorr =       1.256596681757
              std dev =       0.585144007046
             le_variance =       0.342393508982

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342409864676
                                         uncertainty =       0.003193866854

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342409864676
                                         uncertainty =       0.003193866854

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413738797
  error estimate for blocks of size 2^( 2) =       0.000426268063
  error estimate for blocks of size 2^( 3) =       0.000438873992
  error estimate for blocks of size 2^( 4) =       0.000451027937
  error estimate for blocks of size 2^( 5) =       0.000460926374
  error estimate for blocks of size 2^( 6) =       0.000469337497
  error estimate for blocks of size 2^( 7) =       0.000473906398

      target function =                  N/A
              le_mean =     -16.906236720874
             les_mean =     286.163199475094
             stat err =       0.000463799551
             autocorr =       1.256632112807
              std dev =       0.585115017781
             le_variance =       0.342359584033


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906236848944        initial  <--
     1.5259e-01     1.5259e+00             1.2700e-03       -16.906236745724
     6.1035e-01     6.1035e+00             3.2089e-04       -16.906236314764
     2.4414e+00     2.4414e+01             7.8995e-05       -16.906236720874

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8890
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.095360e-01 1 1  ON 0
 uu_1                 1.426586e-01 1 1  ON 1
 uu_2                 4.078294e-02 1 1  ON 2
 uu_3                -2.197637e-02 1 1  ON 3
 uu_4                -6.793128e-02 1 1  ON 4
 uu_5                -1.032603e-01 1 1  ON 5
 uu_6                -1.317016e-01 1 1  ON 6
 uu_7                -1.462087e-01 1 1  ON 7
 uu_8                -1.391733e-01 1 1  ON 8
 uu_9                -1.112384e-01 1 1  ON 9
 ud_0                 4.545562e-01 1 1  ON 10
 ud_1                 1.881089e-01 1 1  ON 11
 ud_2                 6.659869e-02 1 1  ON 12
 ud_3                -5.631298e-03 1 1  ON 13
 ud_4                -6.326878e-02 1 1  ON 14
 ud_5                -1.055130e-01 1 1  ON 15
 ud_6                -1.338022e-01 1 1  ON 16
 ud_7                -1.515153e-01 1 1  ON 17
 ud_8                -1.531599e-01 1 1  ON 18
 ud_9                -1.456288e-01 1 1  ON 19
 eO_0                -7.639581e-01 1 1  ON 20
 eO_1                -4.408669e-01 1 1  ON 21
 eO_2                -1.739232e-02 1 1  ON 22
 eO_3                 3.069100e-01 1 1  ON 23
 eO_4                 5.353902e-01 1 1  ON 24
 eO_5                 4.993916e-01 1 1  ON 25
 eO_6                 2.695780e-01 1 1  ON 26
 eO_7                -3.704900e-02 1 1  ON 27
 eO_8                -2.394634e-01 1 1  ON 28
 eO_9                -1.076489e-01 1 1  ON 29
eH1_0                -2.556157e-01 1 1  ON 30
eH1_1                -1.540297e-01 1 1  ON 31
eH1_2                -1.069306e-01 1 1  ON 32
eH1_3                -5.207223e-02 1 1  ON 33
eH1_4                -3.328391e-03 1 1  ON 34
eH1_5                 3.231570e-02 1 1  ON 35
eH1_6                 9.358304e-02 1 1  ON 36
eH1_7                 1.550238e-01 1 1  ON 37
eH1_8                 1.947863e-01 1 1  ON 38
eH1_9                 9.556749e-02 1 1  ON 39
eH2_0                -2.526743e-01 1 1  ON 40
eH2_1                -1.512489e-01 1 1  ON 41
eH2_2                -1.040032e-01 1 1  ON 42
eH2_3                -4.926734e-02 1 1  ON 43
eH2_4                -1.010042e-03 1 1  ON 44
eH2_5                 3.407612e-02 1 1  ON 45
eH2_6                 9.528822e-02 1 1  ON 46
eH2_7                 1.555694e-01 1 1  ON 47
eH2_8                 1.976531e-01 1 1  ON 48
eH2_9                 8.886342e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5985e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.9109
    reference variance = 0.248333
====================================================
  Execution time = 2.0793e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4777e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6426e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347878094941
                                         uncertainty =       0.007512720442

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347878094941
                                         uncertainty =       0.007512720442

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416994619
  error estimate for blocks of size 2^( 2) =       0.000429526540
  error estimate for blocks of size 2^( 3) =       0.000442343375
  error estimate for blocks of size 2^( 4) =       0.000454539541
  error estimate for blocks of size 2^( 5) =       0.000464564443
  error estimate for blocks of size 2^( 6) =       0.000471578381
  error estimate for blocks of size 2^( 7) =       0.000475447708

      target function =                  N/A
              le_mean =     -16.906156110513
             les_mean =     286.165883283753
             stat err =       0.000466532518
             autocorr =       1.251707741999
              std dev =       0.589719445667
             le_variance =       0.347769024598


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690615611051e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906156110513       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906156308550       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906155940965       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906155903897       residual = 3.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906155900677       residual = 2.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906155775852       residual = 6.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906155810637       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906155812437       residual = 5.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+00 is 1.119093e-04

solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906156110513       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906156164262       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906156056214       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906156044084       residual = 3.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906156037008       residual = 2.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906155999289       residual = 5.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906156004659       residual = 9.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+00 is 2.807075e-05

solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906156110513       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906156124244       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906156095992       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906156092738       residual = 3.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906156090372       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906156080391       residual = 5.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906156081358       residual = 8.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+01 is 7.211063e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.150991 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6445e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.095363e-01 1 1  ON 0
 uu_1                 1.426429e-01 1 1  ON 1
 uu_2                 4.079407e-02 1 1  ON 2
 uu_3                -2.198024e-02 1 1  ON 3
 uu_4                -6.793763e-02 1 1  ON 4
 uu_5                -1.032730e-01 1 1  ON 5
 uu_6                -1.317028e-01 1 1  ON 6
 uu_7                -1.462154e-01 1 1  ON 7
 uu_8                -1.391736e-01 1 1  ON 8
 uu_9                -1.112279e-01 1 1  ON 9
 ud_0                 4.545669e-01 1 1  ON 10
 ud_1                 1.881019e-01 1 1  ON 11
 ud_2                 6.661523e-02 1 1  ON 12
 ud_3                -5.624372e-03 1 1  ON 13
 ud_4                -6.326521e-02 1 1  ON 14
 ud_5                -1.055145e-01 1 1  ON 15
 ud_6                -1.337865e-01 1 1  ON 16
 ud_7                -1.515290e-01 1 1  ON 17
 ud_8                -1.531757e-01 1 1  ON 18
 ud_9                -1.456252e-01 1 1  ON 19
 eO_0                -7.639393e-01 1 1  ON 20
 eO_1                -4.408512e-01 1 1  ON 21
 eO_2                -1.740078e-02 1 1  ON 22
 eO_3                 3.069023e-01 1 1  ON 23
 eO_4                 5.353999e-01 1 1  ON 24
 eO_5                 4.994011e-01 1 1  ON 25
 eO_6                 2.695841e-01 1 1  ON 26
 eO_7                -3.706146e-02 1 1  ON 27
 eO_8                -2.394774e-01 1 1  ON 28
 eO_9                -1.076637e-01 1 1  ON 29
eH1_0                -2.556247e-01 1 1  ON 30
eH1_1                -1.540521e-01 1 1  ON 31
eH1_2                -1.069208e-01 1 1  ON 32
eH1_3                -5.210030e-02 1 1  ON 33
eH1_4                -3.325253e-03 1 1  ON 34
eH1_5                 3.231627e-02 1 1  ON 35
eH1_6                 9.358503e-02 1 1  ON 36
eH1_7                 1.550318e-01 1 1  ON 37
eH1_8                 1.947988e-01 1 1  ON 38
eH1_9                 9.558960e-02 1 1  ON 39
eH2_0                -2.526931e-01 1 1  ON 40
eH2_1                -1.512664e-01 1 1  ON 41
eH2_2                -1.040130e-01 1 1  ON 42
eH2_3                -4.927334e-02 1 1  ON 43
eH2_4                -1.005953e-03 1 1  ON 44
eH2_5                 3.408249e-02 1 1  ON 45
eH2_6                 9.528020e-02 1 1  ON 46
eH2_7                 1.555759e-01 1 1  ON 47
eH2_8                 1.976635e-01 1 1  ON 48
eH2_9                 8.889001e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.9057
    reference variance = 0.227939
====================================================
  Execution time = 2.0506e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3896e-01
  Total weights = 2.0000e+06
  Execution time = 1.8952e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338807110374
                                         uncertainty =       0.005157079058

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338807110374
                                         uncertainty =       0.005157079058

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411686640
  error estimate for blocks of size 2^( 2) =       0.000424246796
  error estimate for blocks of size 2^( 3) =       0.000437721136
  error estimate for blocks of size 2^( 4) =       0.000449783733
  error estimate for blocks of size 2^( 5) =       0.000459771999
  error estimate for blocks of size 2^( 6) =       0.000467378579
  error estimate for blocks of size 2^( 7) =       0.000472278027

      target function =                  N/A
              le_mean =     -16.905475341968
             les_mean =     286.134068148172
             stat err =       0.000462303084
             autocorr =       1.261014364497
              std dev =       0.582212830303
             le_variance =       0.338971779769

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338776621134
                                         uncertainty =       0.005156586251

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338776621134
                                         uncertainty =       0.005156586251

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411668135
  error estimate for blocks of size 2^( 2) =       0.000424229715
  error estimate for blocks of size 2^( 3) =       0.000437704833
  error estimate for blocks of size 2^( 4) =       0.000449769057
  error estimate for blocks of size 2^( 5) =       0.000459758579
  error estimate for blocks of size 2^( 6) =       0.000467365722
  error estimate for blocks of size 2^( 7) =       0.000472267708

      target function =                  N/A
              le_mean =     -16.905475821490
             les_mean =     286.134053888256
             stat err =       0.000462290266
             autocorr =       1.261057806117
              std dev =       0.582186659713
             le_variance =       0.338941306748

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338790788518
                                         uncertainty =       0.005156743458

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338790788518
                                         uncertainty =       0.005156743458

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411676736
  error estimate for blocks of size 2^( 2) =       0.000424237692
  error estimate for blocks of size 2^( 3) =       0.000437712445
  error estimate for blocks of size 2^( 4) =       0.000449776009
  error estimate for blocks of size 2^( 5) =       0.000459765040
  error estimate for blocks of size 2^( 6) =       0.000467371957
  error estimate for blocks of size 2^( 7) =       0.000472273050

      target function =                  N/A
              le_mean =     -16.905475620685
             les_mean =     286.134061261625
             stat err =       0.000462296514
             autocorr =       1.261039199053
              std dev =       0.582198823028
             le_variance =       0.338955469535

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338804999679
                                         uncertainty =       0.005157034869

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338804999679
                                         uncertainty =       0.005157034869

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411685360
  error estimate for blocks of size 2^( 2) =       0.000424245620
  error estimate for blocks of size 2^( 3) =       0.000437720013
  error estimate for blocks of size 2^( 4) =       0.000449782737
  error estimate for blocks of size 2^( 5) =       0.000459771104
  error estimate for blocks of size 2^( 6) =       0.000467377727
  error estimate for blocks of size 2^( 7) =       0.000472277391

      target function =                  N/A
              le_mean =     -16.905475375915
             les_mean =     286.134067186692
             stat err =       0.000462302240
             autocorr =       1.261017603043
              std dev =       0.582211018890
             le_variance =       0.338969670517


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905475341968        initial
     1.5259e+00     1.5259e+01             1.1191e-04       -16.905475821490  <--
     6.1035e+00     6.1035e+01             2.8071e-05       -16.905475620685
     2.4414e+01     2.4414e+02             7.2111e-06       -16.905475375915

*****************************************************************************
Applying the update for shift_i =   1.5259e+00     and shift_s =   1.5259e+01
*****************************************************************************

  Execution time = 2.9994e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.095342e-01 1 1  ON 0
 uu_1                 1.426035e-01 1 1  ON 1
 uu_2                 4.081160e-02 1 1  ON 2
 uu_3                -2.198549e-02 1 1  ON 3
 uu_4                -6.795779e-02 1 1  ON 4
 uu_5                -1.033102e-01 1 1  ON 5
 uu_6                -1.317097e-01 1 1  ON 6
 uu_7                -1.462352e-01 1 1  ON 7
 uu_8                -1.391738e-01 1 1  ON 8
 uu_9                -1.111945e-01 1 1  ON 9
 ud_0                 4.545915e-01 1 1  ON 10
 ud_1                 1.880965e-01 1 1  ON 11
 ud_2                 6.665674e-02 1 1  ON 12
 ud_3                -5.604281e-03 1 1  ON 13
 ud_4                -6.325219e-02 1 1  ON 14
 ud_5                -1.055157e-01 1 1  ON 15
 ud_6                -1.337476e-01 1 1  ON 16
 ud_7                -1.515651e-01 1 1  ON 17
 ud_8                -1.532212e-01 1 1  ON 18
 ud_9                -1.456139e-01 1 1  ON 19
 eO_0                -7.638880e-01 1 1  ON 20
 eO_1                -4.408070e-01 1 1  ON 21
 eO_2                -1.741188e-02 1 1  ON 22
 eO_3                 3.068800e-01 1 1  ON 23
 eO_4                 5.354270e-01 1 1  ON 24
 eO_5                 4.994302e-01 1 1  ON 25
 eO_6                 2.696032e-01 1 1  ON 26
 eO_7                -3.709918e-02 1 1  ON 27
 eO_8                -2.395217e-01 1 1  ON 28
 eO_9                -1.077115e-01 1 1  ON 29
eH1_0                -2.556507e-01 1 1  ON 30
eH1_1                -1.541100e-01 1 1  ON 31
eH1_2                -1.069034e-01 1 1  ON 32
eH1_3                -5.217773e-02 1 1  ON 33
eH1_4                -3.328200e-03 1 1  ON 34
eH1_5                 3.231419e-02 1 1  ON 35
eH1_6                 9.359208e-02 1 1  ON 36
eH1_7                 1.550575e-01 1 1  ON 37
eH1_8                 1.948393e-01 1 1  ON 38
eH1_9                 9.566065e-02 1 1  ON 39
eH2_0                -2.527493e-01 1 1  ON 40
eH2_1                -1.513186e-01 1 1  ON 41
eH2_2                -1.040461e-01 1 1  ON 42
eH2_3                -4.929438e-02 1 1  ON 43
eH2_4                -9.964922e-04 1 1  ON 44
eH2_5                 3.410070e-02 1 1  ON 45
eH2_6                 9.525584e-02 1 1  ON 46
eH2_7                 1.555966e-01 1 1  ON 47
eH2_8                 1.976968e-01 1 1  ON 48
eH2_9                 8.897532e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6447e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.9157
    reference variance = 0.207083
====================================================
  Execution time = 2.0655e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3432e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.7259e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334394125152
                                         uncertainty =       0.003199058111

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334394125152
                                         uncertainty =       0.003199058111

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408853948
  error estimate for blocks of size 2^( 2) =       0.000421207981
  error estimate for blocks of size 2^( 3) =       0.000433826406
  error estimate for blocks of size 2^( 4) =       0.000445570107
  error estimate for blocks of size 2^( 5) =       0.000456597138
  error estimate for blocks of size 2^( 6) =       0.000463901389
  error estimate for blocks of size 2^( 7) =       0.000467314237

      target function =                  N/A
              le_mean =     -16.906504560259
             les_mean =     286.164219380402
             stat err =       0.000458345718
             autocorr =       1.256753100423
              std dev =       0.578206798207
             le_variance =       0.334323101493


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690650456026e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906504560259       residual = 5.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906504970719       residual = 4.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906507282536       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906507705039       residual = 6.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906506464160       residual = 3.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906507159790       residual = 1.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906507635587       residual = 4.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906507059279       residual = 3.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906507371278       residual = 9.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-01 is 4.698720e-04

solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906504560259       residual = 5.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906504691857       residual = 3.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906505534505       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906505674561       residual = 6.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906505356192       residual = 2.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906505478966       residual = 8.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906505600193       residual = 1.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906505481521       residual = 8.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+00 is 1.165105e-04

solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906504560259       residual = 5.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906504595658       residual = 3.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906504834009       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906504873749       residual = 6.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906504801273       residual = 2.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906504833002       residual = 5.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906504851642       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906504833699       residual = 5.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+00 is 2.954343e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.153893 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9887e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.094973e-01 1 1  ON 0
 uu_1                 1.425706e-01 1 1  ON 1
 uu_2                 4.076392e-02 1 1  ON 2
 uu_3                -2.200535e-02 1 1  ON 3
 uu_4                -6.791127e-02 1 1  ON 4
 uu_5                -1.033300e-01 1 1  ON 5
 uu_6                -1.316508e-01 1 1  ON 6
 uu_7                -1.461844e-01 1 1  ON 7
 uu_8                -1.391972e-01 1 1  ON 8
 uu_9                -1.112605e-01 1 1  ON 9
 ud_0                 4.545825e-01 1 1  ON 10
 ud_1                 1.881984e-01 1 1  ON 11
 ud_2                 6.671072e-02 1 1  ON 12
 ud_3                -5.540681e-03 1 1  ON 13
 ud_4                -6.326755e-02 1 1  ON 14
 ud_5                -1.054638e-01 1 1  ON 15
 ud_6                -1.338140e-01 1 1  ON 16
 ud_7                -1.516113e-01 1 1  ON 17
 ud_8                -1.532544e-01 1 1  ON 18
 ud_9                -1.456307e-01 1 1  ON 19
 eO_0                -7.638800e-01 1 1  ON 20
 eO_1                -4.407090e-01 1 1  ON 21
 eO_2                -1.741931e-02 1 1  ON 22
 eO_3                 3.068867e-01 1 1  ON 23
 eO_4                 5.354388e-01 1 1  ON 24
 eO_5                 4.994456e-01 1 1  ON 25
 eO_6                 2.696305e-01 1 1  ON 26
 eO_7                -3.709741e-02 1 1  ON 27
 eO_8                -2.395783e-01 1 1  ON 28
 eO_9                -1.077952e-01 1 1  ON 29
eH1_0                -2.556734e-01 1 1  ON 30
eH1_1                -1.542019e-01 1 1  ON 31
eH1_2                -1.069801e-01 1 1  ON 32
eH1_3                -5.215453e-02 1 1  ON 33
eH1_4                -3.298159e-03 1 1  ON 34
eH1_5                 3.235616e-02 1 1  ON 35
eH1_6                 9.356424e-02 1 1  ON 36
eH1_7                 1.550562e-01 1 1  ON 37
eH1_8                 1.948742e-01 1 1  ON 38
eH1_9                 9.573825e-02 1 1  ON 39
eH2_0                -2.528043e-01 1 1  ON 40
eH2_1                -1.513265e-01 1 1  ON 41
eH2_2                -1.039903e-01 1 1  ON 42
eH2_3                -4.932251e-02 1 1  ON 43
eH2_4                -1.035892e-03 1 1  ON 44
eH2_5                 3.407269e-02 1 1  ON 45
eH2_6                 9.522863e-02 1 1  ON 46
eH2_7                 1.555641e-01 1 1  ON 47
eH2_8                 1.977221e-01 1 1  ON 48
eH2_9                 8.909183e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.8978
    reference variance = 0.259271
====================================================
  Execution time = 2.0340e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4551e-01
  Total weights = 2.0000e+06
  Execution time = 1.8861e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345620221342
                                         uncertainty =       0.005608528083

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345620221342
                                         uncertainty =       0.005608528083

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415678293
  error estimate for blocks of size 2^( 2) =       0.000428532725
  error estimate for blocks of size 2^( 3) =       0.000441590304
  error estimate for blocks of size 2^( 4) =       0.000453951682
  error estimate for blocks of size 2^( 5) =       0.000463902572
  error estimate for blocks of size 2^( 6) =       0.000470083291
  error estimate for blocks of size 2^( 7) =       0.000475247442

      target function =                  N/A
              le_mean =     -16.906125896868
             les_mean =     286.162669555341
             stat err =       0.000465796247
             autocorr =       1.255675084355
              std dev =       0.587857880244
             le_variance =       0.345576887365

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345499049980
                                         uncertainty =       0.005603637188

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345499049980
                                         uncertainty =       0.005603637188

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415605331
  error estimate for blocks of size 2^( 2) =       0.000428460648
  error estimate for blocks of size 2^( 3) =       0.000441519895
  error estimate for blocks of size 2^( 4) =       0.000453882723
  error estimate for blocks of size 2^( 5) =       0.000463836068
  error estimate for blocks of size 2^( 6) =       0.000470023016
  error estimate for blocks of size 2^( 7) =       0.000475192275

      target function =                  N/A
              le_mean =     -16.906126290438
             les_mean =     286.162561558032
             stat err =       0.000465733520
             autocorr =       1.255777720378
              std dev =       0.587754695882
             le_variance =       0.345455582532

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345488049849
                                         uncertainty =       0.005605061102

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345488049849
                                         uncertainty =       0.005605061102

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415598736
  error estimate for blocks of size 2^( 2) =       0.000428454999
  error estimate for blocks of size 2^( 3) =       0.000441515096
  error estimate for blocks of size 2^( 4) =       0.000453878839
  error estimate for blocks of size 2^( 5) =       0.000463832020
  error estimate for blocks of size 2^( 6) =       0.000470016726
  error estimate for blocks of size 2^( 7) =       0.000475184886

      target function =                  N/A
              le_mean =     -16.906126193120
             les_mean =     286.162547303792
             stat err =       0.000465728118
             autocorr =       1.255788441319
              std dev =       0.587745369023
             le_variance =       0.345444618808

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345599330861
                                         uncertainty =       0.005608057142

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345599330861
                                         uncertainty =       0.005608057142

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415665722
  error estimate for blocks of size 2^( 2) =       0.000428520446
  error estimate for blocks of size 2^( 3) =       0.000441578426
  error estimate for blocks of size 2^( 4) =       0.000453940197
  error estimate for blocks of size 2^( 5) =       0.000463891442
  error estimate for blocks of size 2^( 6) =       0.000470072711
  error estimate for blocks of size 2^( 7) =       0.000475237452

      target function =                  N/A
              le_mean =     -16.906125919253
             les_mean =     286.162649410148
             stat err =       0.000465785450
             autocorr =       1.255692825672
              std dev =       0.587840101804
             le_variance =       0.345555985289


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906125896868        initial
     3.8147e-01     3.8147e+00             4.6987e-04       -16.906126290438  <--
     1.5259e+00     1.5259e+01             1.1651e-04       -16.906126193120
     6.1035e+00     6.1035e+01             2.9543e-05       -16.906125919253

*****************************************************************************
Applying the update for shift_i =   3.8147e-01     and shift_s =   3.8147e+00
*****************************************************************************

  Execution time = 2.9854e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.094015e-01 1 1  ON 0
 uu_1                 1.424848e-01 1 1  ON 1
 uu_2                 4.065817e-02 1 1  ON 2
 uu_3                -2.204992e-02 1 1  ON 3
 uu_4                -6.783510e-02 1 1  ON 4
 uu_5                -1.033359e-01 1 1  ON 5
 uu_6                -1.315341e-01 1 1  ON 6
 uu_7                -1.460509e-01 1 1  ON 7
 uu_8                -1.392579e-01 1 1  ON 8
 uu_9                -1.114593e-01 1 1  ON 9
 ud_0                 4.546941e-01 1 1  ON 10
 ud_1                 1.884004e-01 1 1  ON 11
 ud_2                 6.686248e-02 1 1  ON 12
 ud_3                -5.402184e-03 1 1  ON 13
 ud_4                -6.325977e-02 1 1  ON 14
 ud_5                -1.053981e-01 1 1  ON 15
 ud_6                -1.339412e-01 1 1  ON 16
 ud_7                -1.517403e-01 1 1  ON 17
 ud_8                -1.533642e-01 1 1  ON 18
 ud_9                -1.456846e-01 1 1  ON 19
 eO_0                -7.637901e-01 1 1  ON 20
 eO_1                -4.405068e-01 1 1  ON 21
 eO_2                -1.738929e-02 1 1  ON 22
 eO_3                 3.068927e-01 1 1  ON 23
 eO_4                 5.354686e-01 1 1  ON 24
 eO_5                 4.994966e-01 1 1  ON 25
 eO_6                 2.697092e-01 1 1  ON 26
 eO_7                -3.709413e-02 1 1  ON 27
 eO_8                -2.397500e-01 1 1  ON 28
 eO_9                -1.080496e-01 1 1  ON 29
eH1_0                -2.557622e-01 1 1  ON 30
eH1_1                -1.544258e-01 1 1  ON 31
eH1_2                -1.071565e-01 1 1  ON 32
eH1_3                -5.214278e-02 1 1  ON 33
eH1_4                -3.222507e-03 1 1  ON 34
eH1_5                 3.246581e-02 1 1  ON 35
eH1_6                 9.348670e-02 1 1  ON 36
eH1_7                 1.550498e-01 1 1  ON 37
eH1_8                 1.949774e-01 1 1  ON 38
eH1_9                 9.597294e-02 1 1  ON 39
eH2_0                -2.529375e-01 1 1  ON 40
eH2_1                -1.513479e-01 1 1  ON 41
eH2_2                -1.039038e-01 1 1  ON 42
eH2_3                -4.937590e-02 1 1  ON 43
eH2_4                -1.129263e-03 1 1  ON 44
eH2_5                 3.397618e-02 1 1  ON 45
eH2_6                 9.514655e-02 1 1  ON 46
eH2_7                 1.554661e-01 1 1  ON 47
eH2_8                 1.977981e-01 1 1  ON 48
eH2_9                 8.944520e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9748e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.8572
    reference variance = 0.508828
====================================================
  Execution time = 2.0780e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4883e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5319e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348913999104
                                         uncertainty =       0.006623237069

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348913999104
                                         uncertainty =       0.006623237069

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417629957
  error estimate for blocks of size 2^( 2) =       0.000430094869
  error estimate for blocks of size 2^( 3) =       0.000442660356
  error estimate for blocks of size 2^( 4) =       0.000455120662
  error estimate for blocks of size 2^( 5) =       0.000465148370
  error estimate for blocks of size 2^( 6) =       0.000472746926
  error estimate for blocks of size 2^( 7) =       0.000476529210

      target function =                  N/A
              le_mean =     -16.905722732622
             les_mean =     286.152290499234
             stat err =       0.000467386292
             autocorr =       1.252473816175
              std dev =       0.590617948725
             le_variance =       0.348829561357


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690572273262e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-02, overlap shift 9.5367e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905722732622       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905722116810       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905724302750       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905723631874       residual = 9.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905723826793       residual = 9.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905722351501       residual = 3.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905722629170       residual = 3.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905723802328       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905724311905       residual = 9.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905724337940       residual = 3.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905724535682       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905724399000       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905724468973       residual = 2.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-02 is 2.261099e-03

solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905722732622       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905722432350       residual = 3.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905723350836       residual = 9.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905723090562       residual = 6.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905723340103       residual = 4.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905722885500       residual = 1.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905722877112       residual = 7.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905723056121       residual = 2.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905723169697       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905723152074       residual = 3.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-01 is 5.611764e-04

solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905722732622       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905722634159       residual = 3.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905722893266       residual = 6.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905722838229       residual = 6.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905722942212       residual = 2.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905722831522       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905722845260       residual = 2.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905722865025       residual = 3.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+00 is 1.444875e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.158586 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6320e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.098512e-01 1 1  ON 0
 uu_1                 1.426898e-01 1 1  ON 1
 uu_2                 4.078498e-02 1 1  ON 2
 uu_3                -2.203420e-02 1 1  ON 3
 uu_4                -6.798650e-02 1 1  ON 4
 uu_5                -1.035418e-01 1 1  ON 5
 uu_6                -1.315291e-01 1 1  ON 6
 uu_7                -1.462997e-01 1 1  ON 7
 uu_8                -1.395010e-01 1 1  ON 8
 uu_9                -1.115931e-01 1 1  ON 9
 ud_0                 4.548087e-01 1 1  ON 10
 ud_1                 1.883851e-01 1 1  ON 11
 ud_2                 6.685266e-02 1 1  ON 12
 ud_3                -5.330138e-03 1 1  ON 13
 ud_4                -6.310215e-02 1 1  ON 14
 ud_5                -1.051924e-01 1 1  ON 15
 ud_6                -1.338309e-01 1 1  ON 16
 ud_7                -1.515427e-01 1 1  ON 17
 ud_8                -1.534406e-01 1 1  ON 18
 ud_9                -1.459277e-01 1 1  ON 19
 eO_0                -7.635908e-01 1 1  ON 20
 eO_1                -4.405446e-01 1 1  ON 21
 eO_2                -1.721010e-02 1 1  ON 22
 eO_3                 3.068541e-01 1 1  ON 23
 eO_4                 5.355671e-01 1 1  ON 24
 eO_5                 4.995740e-01 1 1  ON 25
 eO_6                 2.699631e-01 1 1  ON 26
 eO_7                -3.699935e-02 1 1  ON 27
 eO_8                -2.400474e-01 1 1  ON 28
 eO_9                -1.085068e-01 1 1  ON 29
eH1_0                -2.558782e-01 1 1  ON 30
eH1_1                -1.542578e-01 1 1  ON 31
eH1_2                -1.071360e-01 1 1  ON 32
eH1_3                -5.205091e-02 1 1  ON 33
eH1_4                -3.315377e-03 1 1  ON 34
eH1_5                 3.216232e-02 1 1  ON 35
eH1_6                 9.336493e-02 1 1  ON 36
eH1_7                 1.551773e-01 1 1  ON 37
eH1_8                 1.950057e-01 1 1  ON 38
eH1_9                 9.616870e-02 1 1  ON 39
eH2_0                -2.530689e-01 1 1  ON 40
eH2_1                -1.514497e-01 1 1  ON 41
eH2_2                -1.042547e-01 1 1  ON 42
eH2_3                -4.953995e-02 1 1  ON 43
eH2_4                -1.013729e-03 1 1  ON 44
eH2_5                 3.400832e-02 1 1  ON 45
eH2_6                 9.492551e-02 1 1  ON 46
eH2_7                 1.553541e-01 1 1  ON 47
eH2_8                 1.981236e-01 1 1  ON 48
eH2_9                 9.000637e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.0266
    reference variance = 0.465563
====================================================
  Execution time = 2.0101e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4150e-01
  Total weights = 2.0000e+06
  Execution time = 1.8829e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341312280347
                                         uncertainty =       0.003496922739

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341312280347
                                         uncertainty =       0.003496922739

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413086830
  error estimate for blocks of size 2^( 2) =       0.000425797982
  error estimate for blocks of size 2^( 3) =       0.000438893857
  error estimate for blocks of size 2^( 4) =       0.000450344261
  error estimate for blocks of size 2^( 5) =       0.000460947340
  error estimate for blocks of size 2^( 6) =       0.000469453675
  error estimate for blocks of size 2^( 7) =       0.000474373067

      target function =                  N/A
              le_mean =     -16.906358190845
             les_mean =     286.166228564012
             stat err =       0.000463779586
             autocorr =       1.260493351882
              std dev =       0.584192996788
             le_variance =       0.341281457497

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341664135636
                                         uncertainty =       0.003501650476

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341664135636
                                         uncertainty =       0.003501650476

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413299578
  error estimate for blocks of size 2^( 2) =       0.000425994374
  error estimate for blocks of size 2^( 3) =       0.000439073247
  error estimate for blocks of size 2^( 4) =       0.000450514686
  error estimate for blocks of size 2^( 5) =       0.000461116471
  error estimate for blocks of size 2^( 6) =       0.000469640719
  error estimate for blocks of size 2^( 7) =       0.000474556591

      target function =                  N/A
              le_mean =     -16.906360344984
             les_mean =     286.166653026387
             stat err =       0.000463957117
             autocorr =       1.260160194879
              std dev =       0.584493868867
             le_variance =       0.341633082743

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341761041342
                                         uncertainty =       0.003502553378

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341761041342
                                         uncertainty =       0.003502553378

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413358157
  error estimate for blocks of size 2^( 2) =       0.000426051481
  error estimate for blocks of size 2^( 3) =       0.000439128955
  error estimate for blocks of size 2^( 4) =       0.000450569124
  error estimate for blocks of size 2^( 5) =       0.000461168823
  error estimate for blocks of size 2^( 6) =       0.000469690850
  error estimate for blocks of size 2^( 7) =       0.000474604275

      target function =                  N/A
              le_mean =     -16.906360638501
             les_mean =     286.166759799878
             stat err =       0.000464008268
             autocorr =       1.260080857847
              std dev =       0.584576711562
             le_variance =       0.341729931700

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341402506582
                                         uncertainty =       0.003498050456

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341402506582
                                         uncertainty =       0.003498050456

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413141395
  error estimate for blocks of size 2^( 2) =       0.000425849084
  error estimate for blocks of size 2^( 3) =       0.000438941517
  error estimate for blocks of size 2^( 4) =       0.000450389750
  error estimate for blocks of size 2^( 5) =       0.000460992047
  error estimate for blocks of size 2^( 6) =       0.000469500575
  error estimate for blocks of size 2^( 7) =       0.000474418307

      target function =                  N/A
              le_mean =     -16.906358512509
             les_mean =     286.166329607520
             stat err =       0.000463825170
             autocorr =       1.260408145693
              std dev =       0.584270164155
             le_variance =       0.341371624721


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906358190845        initial
     9.5367e-02     9.5367e-01             2.2611e-03       -16.906360344984
     3.8147e-01     3.8147e+00             5.6118e-04       -16.906360638501  <--
     1.5259e+00     1.5259e+01             1.4449e-04       -16.906358512509

*****************************************************************************
Applying the update for shift_i =   3.8147e-01     and shift_s =   3.8147e+00
*****************************************************************************

  Execution time = 2.9577e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.098512e-01 1 1  ON 0
 uu_1                 1.426898e-01 1 1  ON 1
 uu_2                 4.078498e-02 1 1  ON 2
 uu_3                -2.203420e-02 1 1  ON 3
 uu_4                -6.798650e-02 1 1  ON 4
 uu_5                -1.035418e-01 1 1  ON 5
 uu_6                -1.315291e-01 1 1  ON 6
 uu_7                -1.462997e-01 1 1  ON 7
 uu_8                -1.395010e-01 1 1  ON 8
 uu_9                -1.115931e-01 1 1  ON 9
 ud_0                 4.548087e-01 1 1  ON 10
 ud_1                 1.883851e-01 1 1  ON 11
 ud_2                 6.685266e-02 1 1  ON 12
 ud_3                -5.330138e-03 1 1  ON 13
 ud_4                -6.310215e-02 1 1  ON 14
 ud_5                -1.051924e-01 1 1  ON 15
 ud_6                -1.338309e-01 1 1  ON 16
 ud_7                -1.515427e-01 1 1  ON 17
 ud_8                -1.534406e-01 1 1  ON 18
 ud_9                -1.459277e-01 1 1  ON 19
 eO_0                -7.635908e-01 1 1  ON 20
 eO_1                -4.405446e-01 1 1  ON 21
 eO_2                -1.721010e-02 1 1  ON 22
 eO_3                 3.068541e-01 1 1  ON 23
 eO_4                 5.355671e-01 1 1  ON 24
 eO_5                 4.995740e-01 1 1  ON 25
 eO_6                 2.699631e-01 1 1  ON 26
 eO_7                -3.699935e-02 1 1  ON 27
 eO_8                -2.400474e-01 1 1  ON 28
 eO_9                -1.085068e-01 1 1  ON 29
eH1_0                -2.558782e-01 1 1  ON 30
eH1_1                -1.542578e-01 1 1  ON 31
eH1_2                -1.071360e-01 1 1  ON 32
eH1_3                -5.205091e-02 1 1  ON 33
eH1_4                -3.315377e-03 1 1  ON 34
eH1_5                 3.216232e-02 1 1  ON 35
eH1_6                 9.336493e-02 1 1  ON 36
eH1_7                 1.551773e-01 1 1  ON 37
eH1_8                 1.950057e-01 1 1  ON 38
eH1_9                 9.616870e-02 1 1  ON 39
eH2_0                -2.530689e-01 1 1  ON 40
eH2_1                -1.514497e-01 1 1  ON 41
eH2_2                -1.042547e-01 1 1  ON 42
eH2_3                -4.953995e-02 1 1  ON 43
eH2_4                -1.013729e-03 1 1  ON 44
eH2_5                 3.400832e-02 1 1  ON 45
eH2_6                 9.492551e-02 1 1  ON 46
eH2_7                 1.553541e-01 1 1  ON 47
eH2_8                 1.981236e-01 1 1  ON 48
eH2_9                 9.000637e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5906e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.9096
    reference variance = 0.274002
====================================================
  Execution time = 2.0877e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4103e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5592e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341112726271
                                         uncertainty =       0.004301719945

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341112726271
                                         uncertainty =       0.004301719945

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412934587
  error estimate for blocks of size 2^( 2) =       0.000425572294
  error estimate for blocks of size 2^( 3) =       0.000438453623
  error estimate for blocks of size 2^( 4) =       0.000450664840
  error estimate for blocks of size 2^( 5) =       0.000462084892
  error estimate for blocks of size 2^( 6) =       0.000470218696
  error estimate for blocks of size 2^( 7) =       0.000476978693

      target function =                  N/A
              le_mean =     -16.906041101431
             les_mean =     286.155255499270
             stat err =       0.000464986780
             autocorr =       1.267998355942
              std dev =       0.583977693495
             le_variance =       0.341029946500


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690604110143e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-02, overlap shift 9.5367e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906041101431       residual = 6.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906042844273       residual = 4.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906041987017       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906043333020       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906044610399       residual = 5.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906044399131       residual = 4.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906042462451       residual = 2.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906043498442       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906042968066       residual = 7.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906043348629       residual = 5.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906043328071       residual = 2.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906043506329       residual = 9.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-02 is 1.902104e-03

solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906041101431       residual = 6.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906041918268       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906041333478       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906041317252       residual = 7.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906041588868       residual = 3.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906042212742       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906041367556       residual = 4.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906041363454       residual = 2.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906041516897       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906041518149       residual = 1.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-01 is 4.854609e-04

solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906041101431       residual = 6.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906041362796       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906041123157       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906041030826       residual = 5.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906041056193       residual = 2.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906041238163       residual = 9.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906041056708       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906041077251       residual = 5.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+00 is 1.171254e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.162401 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6444e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.097341e-01 1 1  ON 0
 uu_1                 1.427065e-01 1 1  ON 1
 uu_2                 4.081731e-02 1 1  ON 2
 uu_3                -2.219423e-02 1 1  ON 3
 uu_4                -6.808594e-02 1 1  ON 4
 uu_5                -1.035753e-01 1 1  ON 5
 uu_6                -1.317169e-01 1 1  ON 6
 uu_7                -1.462767e-01 1 1  ON 7
 uu_8                -1.392689e-01 1 1  ON 8
 uu_9                -1.117174e-01 1 1  ON 9
 ud_0                 4.546723e-01 1 1  ON 10
 ud_1                 1.882501e-01 1 1  ON 11
 ud_2                 6.677711e-02 1 1  ON 12
 ud_3                -5.391670e-03 1 1  ON 13
 ud_4                -6.298378e-02 1 1  ON 14
 ud_5                -1.052368e-01 1 1  ON 15
 ud_6                -1.337972e-01 1 1  ON 16
 ud_7                -1.515141e-01 1 1  ON 17
 ud_8                -1.531393e-01 1 1  ON 18
 ud_9                -1.457001e-01 1 1  ON 19
 eO_0                -7.634940e-01 1 1  ON 20
 eO_1                -4.403247e-01 1 1  ON 21
 eO_2                -1.721579e-02 1 1  ON 22
 eO_3                 3.067086e-01 1 1  ON 23
 eO_4                 5.355389e-01 1 1  ON 24
 eO_5                 4.997590e-01 1 1  ON 25
 eO_6                 2.701279e-01 1 1  ON 26
 eO_7                -3.697839e-02 1 1  ON 27
 eO_8                -2.401248e-01 1 1  ON 28
 eO_9                -1.088189e-01 1 1  ON 29
eH1_0                -2.558675e-01 1 1  ON 30
eH1_1                -1.544809e-01 1 1  ON 31
eH1_2                -1.072251e-01 1 1  ON 32
eH1_3                -5.230338e-02 1 1  ON 33
eH1_4                -3.303094e-03 1 1  ON 34
eH1_5                 3.200431e-02 1 1  ON 35
eH1_6                 9.322283e-02 1 1  ON 36
eH1_7                 1.551955e-01 1 1  ON 37
eH1_8                 1.952631e-01 1 1  ON 38
eH1_9                 9.665416e-02 1 1  ON 39
eH2_0                -2.532659e-01 1 1  ON 40
eH2_1                -1.517193e-01 1 1  ON 41
eH2_2                -1.044326e-01 1 1  ON 42
eH2_3                -4.967082e-02 1 1  ON 43
eH2_4                -1.030766e-03 1 1  ON 44
eH2_5                 3.374838e-02 1 1  ON 45
eH2_6                 9.502808e-02 1 1  ON 46
eH2_7                 1.556214e-01 1 1  ON 47
eH2_8                 1.983343e-01 1 1  ON 48
eH2_9                 9.044607e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.9004
    reference variance = 0.243951
====================================================
  Execution time = 2.0347e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5696e-01
  Total weights = 2.0000e+06
  Execution time = 1.8890e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356957776103
                                         uncertainty =       0.018782074909

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356957776103
                                         uncertainty =       0.018782074909

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422503433
  error estimate for blocks of size 2^( 2) =       0.000435348435
  error estimate for blocks of size 2^( 3) =       0.000448238634
  error estimate for blocks of size 2^( 4) =       0.000460393491
  error estimate for blocks of size 2^( 5) =       0.000469797462
  error estimate for blocks of size 2^( 6) =       0.000476417592
  error estimate for blocks of size 2^( 7) =       0.000479019303

      target function =                  N/A
              le_mean =     -16.906031218681
             les_mean =     286.170909690496
             stat err =       0.000471406962
             autocorr =       1.244891495371
              std dev =       0.597510085248
             le_variance =       0.357018301973

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356790882076
                                         uncertainty =       0.018766214122

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356790882076
                                         uncertainty =       0.018766214122

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422404712
  error estimate for blocks of size 2^( 2) =       0.000435254864
  error estimate for blocks of size 2^( 3) =       0.000448149404
  error estimate for blocks of size 2^( 4) =       0.000460313323
  error estimate for blocks of size 2^( 5) =       0.000469722770
  error estimate for blocks of size 2^( 6) =       0.000476351647
  error estimate for blocks of size 2^( 7) =       0.000478953099

      target function =                  N/A
              le_mean =     -16.906031663142
             les_mean =     286.170757898800
             stat err =       0.000471335210
             autocorr =       1.245094338056
              std dev =       0.597370473034
             le_variance =       0.356851482053

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356846225664
                                         uncertainty =       0.018769834001

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356846225664
                                         uncertainty =       0.018769834001

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422437466
  error estimate for blocks of size 2^( 2) =       0.000435285787
  error estimate for blocks of size 2^( 3) =       0.000448176536
  error estimate for blocks of size 2^( 4) =       0.000460337432
  error estimate for blocks of size 2^( 5) =       0.000469745260
  error estimate for blocks of size 2^( 6) =       0.000476372909
  error estimate for blocks of size 2^( 7) =       0.000478975332

      target function =                  N/A
              le_mean =     -16.906031764333
             les_mean =     286.170816662771
             stat err =       0.000471357733
             autocorr =       1.245020254443
              std dev =       0.597416793015
             le_variance =       0.356906824576

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356931910838
                                         uncertainty =       0.018778303693

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356931910838
                                         uncertainty =       0.018778303693

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422488132
  error estimate for blocks of size 2^( 2) =       0.000435333799
  error estimate for blocks of size 2^( 3) =       0.000448223897
  error estimate for blocks of size 2^( 4) =       0.000460379818
  error estimate for blocks of size 2^( 5) =       0.000469784528
  error estimate for blocks of size 2^( 6) =       0.000476405980
  error estimate for blocks of size 2^( 7) =       0.000479007670

      target function =                  N/A
              le_mean =     -16.906031269963
             les_mean =     286.170885566104
             stat err =       0.000471394499
             autocorr =       1.244915838685
              std dev =       0.597488446434
             le_variance =       0.356992443623


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906031218681        initial
     9.5367e-02     9.5367e-01             1.9021e-03       -16.906031663142
     3.8147e-01     3.8147e+00             4.8546e-04       -16.906031764333  <--
     1.5259e+00     1.5259e+01             1.1713e-04       -16.906031269963

*****************************************************************************
Applying the update for shift_i =   3.8147e-01     and shift_s =   3.8147e+00
*****************************************************************************

  Execution time = 2.9888e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.097341e-01 1 1  ON 0
 uu_1                 1.427065e-01 1 1  ON 1
 uu_2                 4.081731e-02 1 1  ON 2
 uu_3                -2.219423e-02 1 1  ON 3
 uu_4                -6.808594e-02 1 1  ON 4
 uu_5                -1.035753e-01 1 1  ON 5
 uu_6                -1.317169e-01 1 1  ON 6
 uu_7                -1.462767e-01 1 1  ON 7
 uu_8                -1.392689e-01 1 1  ON 8
 uu_9                -1.117174e-01 1 1  ON 9
 ud_0                 4.546723e-01 1 1  ON 10
 ud_1                 1.882501e-01 1 1  ON 11
 ud_2                 6.677711e-02 1 1  ON 12
 ud_3                -5.391670e-03 1 1  ON 13
 ud_4                -6.298378e-02 1 1  ON 14
 ud_5                -1.052368e-01 1 1  ON 15
 ud_6                -1.337972e-01 1 1  ON 16
 ud_7                -1.515141e-01 1 1  ON 17
 ud_8                -1.531393e-01 1 1  ON 18
 ud_9                -1.457001e-01 1 1  ON 19
 eO_0                -7.634940e-01 1 1  ON 20
 eO_1                -4.403247e-01 1 1  ON 21
 eO_2                -1.721579e-02 1 1  ON 22
 eO_3                 3.067086e-01 1 1  ON 23
 eO_4                 5.355389e-01 1 1  ON 24
 eO_5                 4.997590e-01 1 1  ON 25
 eO_6                 2.701279e-01 1 1  ON 26
 eO_7                -3.697839e-02 1 1  ON 27
 eO_8                -2.401248e-01 1 1  ON 28
 eO_9                -1.088189e-01 1 1  ON 29
eH1_0                -2.558675e-01 1 1  ON 30
eH1_1                -1.544809e-01 1 1  ON 31
eH1_2                -1.072251e-01 1 1  ON 32
eH1_3                -5.230338e-02 1 1  ON 33
eH1_4                -3.303094e-03 1 1  ON 34
eH1_5                 3.200431e-02 1 1  ON 35
eH1_6                 9.322283e-02 1 1  ON 36
eH1_7                 1.551955e-01 1 1  ON 37
eH1_8                 1.952631e-01 1 1  ON 38
eH1_9                 9.665416e-02 1 1  ON 39
eH2_0                -2.532659e-01 1 1  ON 40
eH2_1                -1.517193e-01 1 1  ON 41
eH2_2                -1.044326e-01 1 1  ON 42
eH2_3                -4.967082e-02 1 1  ON 43
eH2_4                -1.030766e-03 1 1  ON 44
eH2_5                 3.374838e-02 1 1  ON 45
eH2_6                 9.502808e-02 1 1  ON 46
eH2_7                 1.556214e-01 1 1  ON 47
eH2_8                 1.983343e-01 1 1  ON 48
eH2_9                 9.044607e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6339e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.9618
    reference variance = 0.215553
====================================================
  Execution time = 2.0610e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5517e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5117e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355264642673
                                         uncertainty =       0.011285066959

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355264642673
                                         uncertainty =       0.011285066959

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421406976
  error estimate for blocks of size 2^( 2) =       0.000433751972
  error estimate for blocks of size 2^( 3) =       0.000446269379
  error estimate for blocks of size 2^( 4) =       0.000457548354
  error estimate for blocks of size 2^( 5) =       0.000468014052
  error estimate for blocks of size 2^( 6) =       0.000473874379
  error estimate for blocks of size 2^( 7) =       0.000478873000

      target function =                  N/A
              le_mean =     -16.905942638603
             les_mean =     286.166064000406
             stat err =       0.000469577446
             autocorr =       1.241683809832
              std dev =       0.595959460249
             le_variance =       0.355167678261


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690594263860e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-02, overlap shift 9.5367e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905942638603       residual = 3.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905943837321       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905946352018       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905944067944       residual = 6.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905946621796       residual = 3.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905946689334       residual = 3.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905948007320       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905948005916       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905947793100       residual = 6.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905948563201       residual = 2.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905948720103       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905948495016       residual = 5.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-02 is 1.676957e-03

solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905942638603       residual = 3.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905943223692       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905944393599       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905943300462       residual = 4.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905943879354       residual = 2.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905944858436       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905944487923       residual = 4.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905944609996       residual = 2.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905944533420       residual = 7.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-01 is 4.152495e-04

solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905942638603       residual = 3.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905942830585       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905943188318       residual = 7.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905942812481       residual = 3.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905942961266       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905943285414       residual = 7.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905943161770       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905943184494       residual = 4.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+00 is 1.038208e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.166017 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6129e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.095020e-01 1 1  ON 0
 uu_1                 1.426154e-01 1 1  ON 1
 uu_2                 4.074262e-02 1 1  ON 2
 uu_3                -2.223605e-02 1 1  ON 3
 uu_4                -6.808301e-02 1 1  ON 4
 uu_5                -1.033871e-01 1 1  ON 5
 uu_6                -1.316336e-01 1 1  ON 6
 uu_7                -1.462996e-01 1 1  ON 7
 uu_8                -1.393953e-01 1 1  ON 8
 uu_9                -1.117616e-01 1 1  ON 9
 ud_0                 4.548554e-01 1 1  ON 10
 ud_1                 1.885327e-01 1 1  ON 11
 ud_2                 6.689159e-02 1 1  ON 12
 ud_3                -5.287927e-03 1 1  ON 13
 ud_4                -6.305883e-02 1 1  ON 14
 ud_5                -1.052519e-01 1 1  ON 15
 ud_6                -1.338024e-01 1 1  ON 16
 ud_7                -1.516210e-01 1 1  ON 17
 ud_8                -1.532405e-01 1 1  ON 18
 ud_9                -1.457735e-01 1 1  ON 19
 eO_0                -7.633868e-01 1 1  ON 20
 eO_1                -4.402278e-01 1 1  ON 21
 eO_2                -1.702101e-02 1 1  ON 22
 eO_3                 3.066782e-01 1 1  ON 23
 eO_4                 5.355034e-01 1 1  ON 24
 eO_5                 4.998585e-01 1 1  ON 25
 eO_6                 2.704346e-01 1 1  ON 26
 eO_7                -3.713479e-02 1 1  ON 27
 eO_8                -2.403715e-01 1 1  ON 28
 eO_9                -1.091112e-01 1 1  ON 29
eH1_0                -2.561271e-01 1 1  ON 30
eH1_1                -1.546401e-01 1 1  ON 31
eH1_2                -1.073323e-01 1 1  ON 32
eH1_3                -5.252080e-02 1 1  ON 33
eH1_4                -3.175043e-03 1 1  ON 34
eH1_5                 3.180047e-02 1 1  ON 35
eH1_6                 9.310499e-02 1 1  ON 36
eH1_7                 1.554388e-01 1 1  ON 37
eH1_8                 1.955188e-01 1 1  ON 38
eH1_9                 9.706941e-02 1 1  ON 39
eH2_0                -2.533918e-01 1 1  ON 40
eH2_1                -1.517571e-01 1 1  ON 41
eH2_2                -1.045512e-01 1 1  ON 42
eH2_3                -4.985546e-02 1 1  ON 43
eH2_4                -9.537972e-04 1 1  ON 44
eH2_5                 3.383310e-02 1 1  ON 45
eH2_6                 9.505971e-02 1 1  ON 46
eH2_7                 1.554770e-01 1 1  ON 47
eH2_8                 1.982740e-01 1 1  ON 48
eH2_9                 9.081610e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.9078
    reference variance = 0.200224
====================================================
  Execution time = 2.0013e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3694e-01
  Total weights = 2.0000e+06
  Execution time = 1.8747e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337085501024
                                         uncertainty =       0.003877883293

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337085501024
                                         uncertainty =       0.003877883293

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410469331
  error estimate for blocks of size 2^( 2) =       0.000423082131
  error estimate for blocks of size 2^( 3) =       0.000436119385
  error estimate for blocks of size 2^( 4) =       0.000448079965
  error estimate for blocks of size 2^( 5) =       0.000458415344
  error estimate for blocks of size 2^( 6) =       0.000468003673
  error estimate for blocks of size 2^( 7) =       0.000472125772

      target function =                  N/A
              le_mean =     -16.906457663656
             les_mean =     286.165280708571
             stat err =       0.000461656189
             autocorr =       1.264957387407
              std dev =       0.580491295414
             le_variance =       0.336970144051

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337068500296
                                         uncertainty =       0.003875345289

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337068500296
                                         uncertainty =       0.003875345289

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410459024
  error estimate for blocks of size 2^( 2) =       0.000423067846
  error estimate for blocks of size 2^( 3) =       0.000436100122
  error estimate for blocks of size 2^( 4) =       0.000448052890
  error estimate for blocks of size 2^( 5) =       0.000458386417
  error estimate for blocks of size 2^( 6) =       0.000467976242
  error estimate for blocks of size 2^( 7) =       0.000472091945

      target function =                  N/A
              le_mean =     -16.906456076333
             les_mean =     286.165210112459
             stat err =       0.000461626873
             autocorr =       1.264860268023
              std dev =       0.580476717854
             le_variance =       0.336953219970

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337026162325
                                         uncertainty =       0.003874249557

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337026162325
                                         uncertainty =       0.003874249557

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410433256
  error estimate for blocks of size 2^( 2) =       0.000423044129
  error estimate for blocks of size 2^( 3) =       0.000436078521
  error estimate for blocks of size 2^( 4) =       0.000448032766
  error estimate for blocks of size 2^( 5) =       0.000458366827
  error estimate for blocks of size 2^( 6) =       0.000467958702
  error estimate for blocks of size 2^( 7) =       0.000472078079

      target function =                  N/A
              le_mean =     -16.906455439591
             les_mean =     286.165146277467
             stat err =       0.000461609094
             autocorr =       1.264921649725
              std dev =       0.580440276899
             le_variance =       0.336910915047

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337064468940
                                         uncertainty =       0.003877132511

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337064468940
                                         uncertainty =       0.003877132511

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410456535
  error estimate for blocks of size 2^( 2) =       0.000423069338
  error estimate for blocks of size 2^( 3) =       0.000436106394
  error estimate for blocks of size 2^( 4) =       0.000448066076
  error estimate for blocks of size 2^( 5) =       0.000458401220
  error estimate for blocks of size 2^( 6) =       0.000467990308
  error estimate for blocks of size 2^( 7) =       0.000472111705

      target function =                  N/A
              le_mean =     -16.906457082101
             les_mean =     286.165240034185
             stat err =       0.000461642327
             autocorr =       1.264960296157
              std dev =       0.580473198128
             le_variance =       0.336949133745


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906457663656        initial  <--
     9.5367e-02     9.5367e-01             1.6770e-03       -16.906456076333
     3.8147e-01     3.8147e+00             4.1525e-04       -16.906455439591
     1.5259e+00     1.5259e+01             1.0382e-04       -16.906457082101

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5066
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.097341e-01 1 1  ON 0
 uu_1                 1.427065e-01 1 1  ON 1
 uu_2                 4.081731e-02 1 1  ON 2
 uu_3                -2.219423e-02 1 1  ON 3
 uu_4                -6.808594e-02 1 1  ON 4
 uu_5                -1.035753e-01 1 1  ON 5
 uu_6                -1.317169e-01 1 1  ON 6
 uu_7                -1.462767e-01 1 1  ON 7
 uu_8                -1.392689e-01 1 1  ON 8
 uu_9                -1.117174e-01 1 1  ON 9
 ud_0                 4.546723e-01 1 1  ON 10
 ud_1                 1.882501e-01 1 1  ON 11
 ud_2                 6.677711e-02 1 1  ON 12
 ud_3                -5.391670e-03 1 1  ON 13
 ud_4                -6.298378e-02 1 1  ON 14
 ud_5                -1.052368e-01 1 1  ON 15
 ud_6                -1.337972e-01 1 1  ON 16
 ud_7                -1.515141e-01 1 1  ON 17
 ud_8                -1.531393e-01 1 1  ON 18
 ud_9                -1.457001e-01 1 1  ON 19
 eO_0                -7.634940e-01 1 1  ON 20
 eO_1                -4.403247e-01 1 1  ON 21
 eO_2                -1.721579e-02 1 1  ON 22
 eO_3                 3.067086e-01 1 1  ON 23
 eO_4                 5.355389e-01 1 1  ON 24
 eO_5                 4.997590e-01 1 1  ON 25
 eO_6                 2.701279e-01 1 1  ON 26
 eO_7                -3.697839e-02 1 1  ON 27
 eO_8                -2.401248e-01 1 1  ON 28
 eO_9                -1.088189e-01 1 1  ON 29
eH1_0                -2.558675e-01 1 1  ON 30
eH1_1                -1.544809e-01 1 1  ON 31
eH1_2                -1.072251e-01 1 1  ON 32
eH1_3                -5.230338e-02 1 1  ON 33
eH1_4                -3.303094e-03 1 1  ON 34
eH1_5                 3.200431e-02 1 1  ON 35
eH1_6                 9.322283e-02 1 1  ON 36
eH1_7                 1.551955e-01 1 1  ON 37
eH1_8                 1.952631e-01 1 1  ON 38
eH1_9                 9.665416e-02 1 1  ON 39
eH2_0                -2.532659e-01 1 1  ON 40
eH2_1                -1.517193e-01 1 1  ON 41
eH2_2                -1.044326e-01 1 1  ON 42
eH2_3                -4.967082e-02 1 1  ON 43
eH2_4                -1.030766e-03 1 1  ON 44
eH2_5                 3.374838e-02 1 1  ON 45
eH2_6                 9.502808e-02 1 1  ON 46
eH2_7                 1.556214e-01 1 1  ON 47
eH2_8                 1.983343e-01 1 1  ON 48
eH2_9                 9.044607e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5643e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.8941
    reference variance = 0.480442
====================================================
  Execution time = 2.0779e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4234e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4854e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342463253519
                                         uncertainty =       0.004576465562

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342463253519
                                         uncertainty =       0.004576465562

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413727078
  error estimate for blocks of size 2^( 2) =       0.000426562826
  error estimate for blocks of size 2^( 3) =       0.000439596280
  error estimate for blocks of size 2^( 4) =       0.000451940510
  error estimate for blocks of size 2^( 5) =       0.000462897629
  error estimate for blocks of size 2^( 6) =       0.000470314634
  error estimate for blocks of size 2^( 7) =       0.000476105263

      target function =                  N/A
              le_mean =     -16.905309641715
             les_mean =     286.131834101521
             stat err =       0.000465314509
             autocorr =       1.264926518434
              std dev =       0.585098445070
             le_variance =       0.342340190423


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690530964172e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905309641715       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905309624324       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905309608035       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905309461843       residual = 4.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905309424557       residual = 2.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905309682912       residual = 8.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905309591690       residual = 2.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905309623529       residual = 6.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-01 is 2.223623e-04

solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905309641715       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905309636635       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905309633201       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905309591355       residual = 5.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905309559295       residual = 2.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905309631826       residual = 5.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905309608703       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905309617129       residual = 2.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+00 is 5.662788e-05

solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905309641715       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905309640389       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905309639599       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905309628571       residual = 6.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905309619295       residual = 2.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905309637746       residual = 4.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905309631711       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905309633880       residual = 2.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+01 is 1.422629e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.168682 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6271e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.097365e-01 1 1  ON 0
 uu_1                 1.426945e-01 1 1  ON 1
 uu_2                 4.081602e-02 1 1  ON 2
 uu_3                -2.219139e-02 1 1  ON 3
 uu_4                -6.809489e-02 1 1  ON 4
 uu_5                -1.035675e-01 1 1  ON 5
 uu_6                -1.317267e-01 1 1  ON 6
 uu_7                -1.462756e-01 1 1  ON 7
 uu_8                -1.392680e-01 1 1  ON 8
 uu_9                -1.117279e-01 1 1  ON 9
 ud_0                 4.546406e-01 1 1  ON 10
 ud_1                 1.882584e-01 1 1  ON 11
 ud_2                 6.678171e-02 1 1  ON 12
 ud_3                -5.382313e-03 1 1  ON 13
 ud_4                -6.299706e-02 1 1  ON 14
 ud_5                -1.052660e-01 1 1  ON 15
 ud_6                -1.337957e-01 1 1  ON 16
 ud_7                -1.515020e-01 1 1  ON 17
 ud_8                -1.531271e-01 1 1  ON 18
 ud_9                -1.456747e-01 1 1  ON 19
 eO_0                -7.634762e-01 1 1  ON 20
 eO_1                -4.403370e-01 1 1  ON 21
 eO_2                -1.720160e-02 1 1  ON 22
 eO_3                 3.067014e-01 1 1  ON 23
 eO_4                 5.355689e-01 1 1  ON 24
 eO_5                 4.997406e-01 1 1  ON 25
 eO_6                 2.701411e-01 1 1  ON 26
 eO_7                -3.696669e-02 1 1  ON 27
 eO_8                -2.401410e-01 1 1  ON 28
 eO_9                -1.088458e-01 1 1  ON 29
eH1_0                -2.558829e-01 1 1  ON 30
eH1_1                -1.545052e-01 1 1  ON 31
eH1_2                -1.072275e-01 1 1  ON 32
eH1_3                -5.231751e-02 1 1  ON 33
eH1_4                -3.325688e-03 1 1  ON 34
eH1_5                 3.201855e-02 1 1  ON 35
eH1_6                 9.320263e-02 1 1  ON 36
eH1_7                 1.551883e-01 1 1  ON 37
eH1_8                 1.952842e-01 1 1  ON 38
eH1_9                 9.671079e-02 1 1  ON 39
eH2_0                -2.532629e-01 1 1  ON 40
eH2_1                -1.517515e-01 1 1  ON 41
eH2_2                -1.044416e-01 1 1  ON 42
eH2_3                -4.969565e-02 1 1  ON 43
eH2_4                -1.041895e-03 1 1  ON 44
eH2_5                 3.374686e-02 1 1  ON 45
eH2_6                 9.503585e-02 1 1  ON 46
eH2_7                 1.556455e-01 1 1  ON 47
eH2_8                 1.983418e-01 1 1  ON 48
eH2_9                 9.047821e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.8864
    reference variance = 0.296875
====================================================
  Execution time = 2.0305e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3861e-01
  Total weights = 2.0000e+06
  Execution time = 1.8883e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338595092048
                                         uncertainty =       0.003666297140

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338595092048
                                         uncertainty =       0.003666297140

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411488736
  error estimate for blocks of size 2^( 2) =       0.000424099201
  error estimate for blocks of size 2^( 3) =       0.000437029730
  error estimate for blocks of size 2^( 4) =       0.000448581300
  error estimate for blocks of size 2^( 5) =       0.000459211672
  error estimate for blocks of size 2^( 6) =       0.000466999655
  error estimate for blocks of size 2^( 7) =       0.000471461118

      target function =                  N/A
              le_mean =     -16.906390465071
             les_mean =     286.164684347890
             stat err =       0.000461563436
             autocorr =       1.258191922525
              std dev =       0.581932951276
             le_variance =       0.338645959781

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338485474717
                                         uncertainty =       0.003665047714

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338485474717
                                         uncertainty =       0.003665047714

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411422138
  error estimate for blocks of size 2^( 2) =       0.000424036410
  error estimate for blocks of size 2^( 3) =       0.000436970484
  error estimate for blocks of size 2^( 4) =       0.000448524280
  error estimate for blocks of size 2^( 5) =       0.000459156280
  error estimate for blocks of size 2^( 6) =       0.000466944596
  error estimate for blocks of size 2^( 7) =       0.000471409123

      target function =                  N/A
              le_mean =     -16.906390408033
             les_mean =     286.164572810139
             stat err =       0.000461508570
             autocorr =       1.258300087879
              std dev =       0.581838766834
             le_variance =       0.338536350591

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338522842075
                                         uncertainty =       0.003665492058

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338522842075
                                         uncertainty =       0.003665492058

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411444840
  error estimate for blocks of size 2^( 2) =       0.000424057766
  error estimate for blocks of size 2^( 3) =       0.000436990564
  error estimate for blocks of size 2^( 4) =       0.000448543613
  error estimate for blocks of size 2^( 5) =       0.000459175107
  error estimate for blocks of size 2^( 6) =       0.000466963246
  error estimate for blocks of size 2^( 7) =       0.000471426757

      target function =                  N/A
              le_mean =     -16.906390429140
             les_mean =     286.164610886092
             stat err =       0.000461527181
             autocorr =       1.258262708223
              std dev =       0.581870873024
             le_variance =       0.338573712874

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338585302898
                                         uncertainty =       0.003666188872

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338585302898
                                         uncertainty =       0.003666188872

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411482789
  error estimate for blocks of size 2^( 2) =       0.000424093585
  error estimate for blocks of size 2^( 3) =       0.000437024418
  error estimate for blocks of size 2^( 4) =       0.000448576188
  error estimate for blocks of size 2^( 5) =       0.000459206714
  error estimate for blocks of size 2^( 6) =       0.000466994716
  error estimate for blocks of size 2^( 7) =       0.000471456456

      target function =                  N/A
              le_mean =     -16.906390458677
             les_mean =     286.164674342887
             stat err =       0.000461558518
             autocorr =       1.258201480602
              std dev =       0.581924540615
             le_variance =       0.338636170971


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906390465071        initial  <--
     9.5367e-01     9.5367e+00             2.2236e-04       -16.906390408033
     3.8147e+00     3.8147e+01             5.6628e-05       -16.906390429140
     1.5259e+01     1.5259e+02             1.4226e-05       -16.906390458677

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8466
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.097341e-01 1 1  ON 0
 uu_1                 1.427065e-01 1 1  ON 1
 uu_2                 4.081731e-02 1 1  ON 2
 uu_3                -2.219423e-02 1 1  ON 3
 uu_4                -6.808594e-02 1 1  ON 4
 uu_5                -1.035753e-01 1 1  ON 5
 uu_6                -1.317169e-01 1 1  ON 6
 uu_7                -1.462767e-01 1 1  ON 7
 uu_8                -1.392689e-01 1 1  ON 8
 uu_9                -1.117174e-01 1 1  ON 9
 ud_0                 4.546723e-01 1 1  ON 10
 ud_1                 1.882501e-01 1 1  ON 11
 ud_2                 6.677711e-02 1 1  ON 12
 ud_3                -5.391670e-03 1 1  ON 13
 ud_4                -6.298378e-02 1 1  ON 14
 ud_5                -1.052368e-01 1 1  ON 15
 ud_6                -1.337972e-01 1 1  ON 16
 ud_7                -1.515141e-01 1 1  ON 17
 ud_8                -1.531393e-01 1 1  ON 18
 ud_9                -1.457001e-01 1 1  ON 19
 eO_0                -7.634940e-01 1 1  ON 20
 eO_1                -4.403247e-01 1 1  ON 21
 eO_2                -1.721579e-02 1 1  ON 22
 eO_3                 3.067086e-01 1 1  ON 23
 eO_4                 5.355389e-01 1 1  ON 24
 eO_5                 4.997590e-01 1 1  ON 25
 eO_6                 2.701279e-01 1 1  ON 26
 eO_7                -3.697839e-02 1 1  ON 27
 eO_8                -2.401248e-01 1 1  ON 28
 eO_9                -1.088189e-01 1 1  ON 29
eH1_0                -2.558675e-01 1 1  ON 30
eH1_1                -1.544809e-01 1 1  ON 31
eH1_2                -1.072251e-01 1 1  ON 32
eH1_3                -5.230338e-02 1 1  ON 33
eH1_4                -3.303094e-03 1 1  ON 34
eH1_5                 3.200431e-02 1 1  ON 35
eH1_6                 9.322283e-02 1 1  ON 36
eH1_7                 1.551955e-01 1 1  ON 37
eH1_8                 1.952631e-01 1 1  ON 38
eH1_9                 9.665416e-02 1 1  ON 39
eH2_0                -2.532659e-01 1 1  ON 40
eH2_1                -1.517193e-01 1 1  ON 41
eH2_2                -1.044326e-01 1 1  ON 42
eH2_3                -4.967082e-02 1 1  ON 43
eH2_4                -1.030766e-03 1 1  ON 44
eH2_5                 3.374838e-02 1 1  ON 45
eH2_6                 9.502808e-02 1 1  ON 46
eH2_7                 1.556214e-01 1 1  ON 47
eH2_8                 1.983343e-01 1 1  ON 48
eH2_9                 9.044607e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6125e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.925
    reference variance = 0.256015
====================================================
  Execution time = 2.0682e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4909e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5143e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349118145334
                                         uncertainty =       0.007785285319

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349118145334
                                         uncertainty =       0.007785285319

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417786112
  error estimate for blocks of size 2^( 2) =       0.000429978316
  error estimate for blocks of size 2^( 3) =       0.000443276865
  error estimate for blocks of size 2^( 4) =       0.000455711156
  error estimate for blocks of size 2^( 5) =       0.000465414347
  error estimate for blocks of size 2^( 6) =       0.000473884563
  error estimate for blocks of size 2^( 7) =       0.000480009863

      target function =                  N/A
              le_mean =     -16.905639279741
             les_mean =     286.149729752575
             stat err =       0.000468754982
             autocorr =       1.258878438486
              std dev =       0.590838785468
             le_variance =       0.349090470413


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690563927974e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905639279741       residual = 3.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905639334255       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905639381798       residual = 8.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905639415095       residual = 4.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905639457017       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905639464336       residual = 2.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905639459128       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905639450881       residual = 2.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+00 is 1.850713e-05

solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905639279741       residual = 3.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905639293625       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905639305833       residual = 8.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905639314217       residual = 4.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905639324681       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905639326805       residual = 2.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905639325704       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905639323634       residual = 2.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+01 is 4.684458e-06

solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905639279741       residual = 3.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905639283228       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905639286301       residual = 8.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905639288401       residual = 4.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905639291016       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905639291565       residual = 2.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905639291304       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905639290786       residual = 2.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+02 is 1.174789e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.171345 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6203e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.097346e-01 1 1  ON 0
 uu_1                 1.427065e-01 1 1  ON 1
 uu_2                 4.081495e-02 1 1  ON 2
 uu_3                -2.219193e-02 1 1  ON 3
 uu_4                -6.808759e-02 1 1  ON 4
 uu_5                -1.035734e-01 1 1  ON 5
 uu_6                -1.317216e-01 1 1  ON 6
 uu_7                -1.462783e-01 1 1  ON 7
 uu_8                -1.392687e-01 1 1  ON 8
 uu_9                -1.117167e-01 1 1  ON 9
 ud_0                 4.546723e-01 1 1  ON 10
 ud_1                 1.882490e-01 1 1  ON 11
 ud_2                 6.677863e-02 1 1  ON 12
 ud_3                -5.391197e-03 1 1  ON 13
 ud_4                -6.298428e-02 1 1  ON 14
 ud_5                -1.052373e-01 1 1  ON 15
 ud_6                -1.337957e-01 1 1  ON 16
 ud_7                -1.515137e-01 1 1  ON 17
 ud_8                -1.531390e-01 1 1  ON 18
 ud_9                -1.456988e-01 1 1  ON 19
 eO_0                -7.634917e-01 1 1  ON 20
 eO_1                -4.403239e-01 1 1  ON 21
 eO_2                -1.721449e-02 1 1  ON 22
 eO_3                 3.067067e-01 1 1  ON 23
 eO_4                 5.355392e-01 1 1  ON 24
 eO_5                 4.997606e-01 1 1  ON 25
 eO_6                 2.701278e-01 1 1  ON 26
 eO_7                -3.697840e-02 1 1  ON 27
 eO_8                -2.401251e-01 1 1  ON 28
 eO_9                -1.088219e-01 1 1  ON 29
eH1_0                -2.558695e-01 1 1  ON 30
eH1_1                -1.544855e-01 1 1  ON 31
eH1_2                -1.072252e-01 1 1  ON 32
eH1_3                -5.230426e-02 1 1  ON 33
eH1_4                -3.303188e-03 1 1  ON 34
eH1_5                 3.200500e-02 1 1  ON 35
eH1_6                 9.322354e-02 1 1  ON 36
eH1_7                 1.551953e-01 1 1  ON 37
eH1_8                 1.952638e-01 1 1  ON 38
eH1_9                 9.665843e-02 1 1  ON 39
eH2_0                -2.532670e-01 1 1  ON 40
eH2_1                -1.517182e-01 1 1  ON 41
eH2_2                -1.044353e-01 1 1  ON 42
eH2_3                -4.967209e-02 1 1  ON 43
eH2_4                -1.032824e-03 1 1  ON 44
eH2_5                 3.374825e-02 1 1  ON 45
eH2_6                 9.502687e-02 1 1  ON 46
eH2_7                 1.556231e-01 1 1  ON 47
eH2_8                 1.983353e-01 1 1  ON 48
eH2_9                 9.045061e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.84
    reference variance = 0.165477
====================================================
  Execution time = 2.2593e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3332e-01
  Total weights = 2.0000e+06
  Execution time = 1.8825e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332569486578
                                         uncertainty =       0.002470644963

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332569486578
                                         uncertainty =       0.002470644963

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408238186
  error estimate for blocks of size 2^( 2) =       0.000421375848
  error estimate for blocks of size 2^( 3) =       0.000433713302
  error estimate for blocks of size 2^( 4) =       0.000446257101
  error estimate for blocks of size 2^( 5) =       0.000456480975
  error estimate for blocks of size 2^( 6) =       0.000466356790
  error estimate for blocks of size 2^( 7) =       0.000467817107

      target function =                  N/A
              le_mean =     -16.906348012805
             les_mean =     286.157919795658
             stat err =       0.000459227993
             autocorr =       1.265404741412
              std dev =       0.577335978655
             le_variance =       0.333316832249

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332568828977
                                         uncertainty =       0.002470616704

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332568828977
                                         uncertainty =       0.002470616704

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408237792
  error estimate for blocks of size 2^( 2) =       0.000421375671
  error estimate for blocks of size 2^( 3) =       0.000433713330
  error estimate for blocks of size 2^( 4) =       0.000446257329
  error estimate for blocks of size 2^( 5) =       0.000456481218
  error estimate for blocks of size 2^( 6) =       0.000466357008
  error estimate for blocks of size 2^( 7) =       0.000467817007

      target function =                  N/A
              le_mean =     -16.906348026624
             les_mean =     286.157919620558
             stat err =       0.000459228140
             autocorr =       1.265407990150
              std dev =       0.577335422340
             le_variance =       0.333316189889

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332569232371
                                         uncertainty =       0.002470631032

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332569232371
                                         uncertainty =       0.002470631032

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408238035
  error estimate for blocks of size 2^( 2) =       0.000421375806
  error estimate for blocks of size 2^( 3) =       0.000433713364
  error estimate for blocks of size 2^( 4) =       0.000446257264
  error estimate for blocks of size 2^( 5) =       0.000456481146
  error estimate for blocks of size 2^( 6) =       0.000466356948
  error estimate for blocks of size 2^( 7) =       0.000467817098

      target function =                  N/A
              le_mean =     -16.906348019565
             les_mean =     286.157919777828
             stat err =       0.000459228114
             autocorr =       1.265406342229
              std dev =       0.577335765259
             le_variance =       0.333316585848

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332569457097
                                         uncertainty =       0.002470643229

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332569457097
                                         uncertainty =       0.002470643229

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408238168
  error estimate for blocks of size 2^( 2) =       0.000421375844
  error estimate for blocks of size 2^( 3) =       0.000433713311
  error estimate for blocks of size 2^( 4) =       0.000446257123
  error estimate for blocks of size 2^( 5) =       0.000456480998
  error estimate for blocks of size 2^( 6) =       0.000466356812
  error estimate for blocks of size 2^( 7) =       0.000467817107

      target function =                  N/A
              le_mean =     -16.906348013617
             les_mean =     286.157919794631
             stat err =       0.000459228010
             autocorr =       1.265404940710
              std dev =       0.577335953973
             le_variance =       0.333316803750


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906348012805        initial
     9.5367e+00     9.5367e+01             1.8507e-05       -16.906348026624  <--
     3.8147e+01     3.8147e+02             4.6845e-06       -16.906348019565
     1.5259e+02     1.5259e+03             1.1748e-06       -16.906348013617

*****************************************************************************
Applying the update for shift_i =   9.5367e+00     and shift_s =   9.5367e+01
*****************************************************************************

  Execution time = 3.2102e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.097362e-01 1 1  ON 0
 uu_1                 1.427062e-01 1 1  ON 1
 uu_2                 4.080827e-02 1 1  ON 2
 uu_3                -2.218543e-02 1 1  ON 3
 uu_4                -6.809216e-02 1 1  ON 4
 uu_5                -1.035681e-01 1 1  ON 5
 uu_6                -1.317354e-01 1 1  ON 6
 uu_7                -1.462832e-01 1 1  ON 7
 uu_8                -1.392681e-01 1 1  ON 8
 uu_9                -1.117147e-01 1 1  ON 9
 ud_0                 4.546722e-01 1 1  ON 10
 ud_1                 1.882458e-01 1 1  ON 11
 ud_2                 6.678296e-02 1 1  ON 12
 ud_3                -5.389762e-03 1 1  ON 13
 ud_4                -6.298567e-02 1 1  ON 14
 ud_5                -1.052385e-01 1 1  ON 15
 ud_6                -1.337914e-01 1 1  ON 16
 ud_7                -1.515123e-01 1 1  ON 17
 ud_8                -1.531379e-01 1 1  ON 18
 ud_9                -1.456952e-01 1 1  ON 19
 eO_0                -7.634848e-01 1 1  ON 20
 eO_1                -4.403216e-01 1 1  ON 21
 eO_2                -1.721063e-02 1 1  ON 22
 eO_3                 3.067013e-01 1 1  ON 23
 eO_4                 5.355399e-01 1 1  ON 24
 eO_5                 4.997652e-01 1 1  ON 25
 eO_6                 2.701275e-01 1 1  ON 26
 eO_7                -3.697841e-02 1 1  ON 27
 eO_8                -2.401262e-01 1 1  ON 28
 eO_9                -1.088309e-01 1 1  ON 29
eH1_0                -2.558754e-01 1 1  ON 30
eH1_1                -1.544990e-01 1 1  ON 31
eH1_2                -1.072254e-01 1 1  ON 32
eH1_3                -5.230690e-02 1 1  ON 33
eH1_4                -3.303454e-03 1 1  ON 34
eH1_5                 3.200704e-02 1 1  ON 35
eH1_6                 9.322566e-02 1 1  ON 36
eH1_7                 1.551949e-01 1 1  ON 37
eH1_8                 1.952659e-01 1 1  ON 38
eH1_9                 9.667122e-02 1 1  ON 39
eH2_0                -2.532702e-01 1 1  ON 40
eH2_1                -1.517150e-01 1 1  ON 41
eH2_2                -1.044435e-01 1 1  ON 42
eH2_3                -4.967592e-02 1 1  ON 43
eH2_4                -1.038943e-03 1 1  ON 44
eH2_5                 3.374789e-02 1 1  ON 45
eH2_6                 9.502326e-02 1 1  ON 46
eH2_7                 1.556281e-01 1 1  ON 47
eH2_8                 1.983382e-01 1 1  ON 48
eH2_9                 9.046420e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8313e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.9351
    reference variance = 0.347574
====================================================
  Execution time = 2.0503e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4152e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5101e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341534599098
                                         uncertainty =       0.003782344892

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341534599098
                                         uncertainty =       0.003782344892

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413230897
  error estimate for blocks of size 2^( 2) =       0.000426655567
  error estimate for blocks of size 2^( 3) =       0.000439892839
  error estimate for blocks of size 2^( 4) =       0.000452971247
  error estimate for blocks of size 2^( 5) =       0.000464665957
  error estimate for blocks of size 2^( 6) =       0.000473661942
  error estimate for blocks of size 2^( 7) =       0.000478196100

      target function =                  N/A
              le_mean =     -16.905627123644
             les_mean =     286.141747821021
             stat err =       0.000467373811
             autocorr =       1.279213917846
              std dev =       0.584396738606
             le_variance =       0.341519548093


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690562712364e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+00, overlap shift 2.3842e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905627123644       residual = 3.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905627305754       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905627492318       residual = 7.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905627473041       residual = 6.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905627429189       residual = 4.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905627463175       residual = 3.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905627509962       residual = 2.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905627513962       residual = 2.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+00 is 7.542519e-05

solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905627123644       residual = 3.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905627171822       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905627220819       residual = 7.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905627217363       residual = 7.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905627205731       residual = 3.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905627212246       residual = 3.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905627224760       residual = 1.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905627225438       residual = 1.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+00 is 1.905344e-05

solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905627123644       residual = 3.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905627135866       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905627148280       residual = 7.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905627147514       residual = 7.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905627144564       residual = 3.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905627146041       residual = 3.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905627149199       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905627149356       residual = 1.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+01 is 4.774418e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.174040 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6020e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.097335e-01 1 1  ON 0
 uu_1                 1.427064e-01 1 1  ON 1
 uu_2                 4.080657e-02 1 1  ON 2
 uu_3                -2.218289e-02 1 1  ON 3
 uu_4                -6.810132e-02 1 1  ON 4
 uu_5                -1.035684e-01 1 1  ON 5
 uu_6                -1.317329e-01 1 1  ON 6
 uu_7                -1.462926e-01 1 1  ON 7
 uu_8                -1.392701e-01 1 1  ON 8
 uu_9                -1.117127e-01 1 1  ON 9
 ud_0                 4.546653e-01 1 1  ON 10
 ud_1                 1.882438e-01 1 1  ON 11
 ud_2                 6.677812e-02 1 1  ON 12
 ud_3                -5.386767e-03 1 1  ON 13
 ud_4                -6.299237e-02 1 1  ON 14
 ud_5                -1.052466e-01 1 1  ON 15
 ud_6                -1.337875e-01 1 1  ON 16
 ud_7                -1.515172e-01 1 1  ON 17
 ud_8                -1.531193e-01 1 1  ON 18
 ud_9                -1.456766e-01 1 1  ON 19
 eO_0                -7.634791e-01 1 1  ON 20
 eO_1                -4.403258e-01 1 1  ON 21
 eO_2                -1.720354e-02 1 1  ON 22
 eO_3                 3.066980e-01 1 1  ON 23
 eO_4                 5.355441e-01 1 1  ON 24
 eO_5                 4.997709e-01 1 1  ON 25
 eO_6                 2.701296e-01 1 1  ON 26
 eO_7                -3.698308e-02 1 1  ON 27
 eO_8                -2.401256e-01 1 1  ON 28
 eO_9                -1.088417e-01 1 1  ON 29
eH1_0                -2.558813e-01 1 1  ON 30
eH1_1                -1.545164e-01 1 1  ON 31
eH1_2                -1.072385e-01 1 1  ON 32
eH1_3                -5.231530e-02 1 1  ON 33
eH1_4                -3.313941e-03 1 1  ON 34
eH1_5                 3.201150e-02 1 1  ON 35
eH1_6                 9.323736e-02 1 1  ON 36
eH1_7                 1.552088e-01 1 1  ON 37
eH1_8                 1.952765e-01 1 1  ON 38
eH1_9                 9.668665e-02 1 1  ON 39
eH2_0                -2.532775e-01 1 1  ON 40
eH2_1                -1.517153e-01 1 1  ON 41
eH2_2                -1.044478e-01 1 1  ON 42
eH2_3                -4.968453e-02 1 1  ON 43
eH2_4                -1.034832e-03 1 1  ON 44
eH2_5                 3.373056e-02 1 1  ON 45
eH2_6                 9.502661e-02 1 1  ON 46
eH2_7                 1.556315e-01 1 1  ON 47
eH2_8                 1.983426e-01 1 1  ON 48
eH2_9                 9.048326e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.9764
    reference variance = 0.815085
====================================================
  Execution time = 2.0161e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4266e-01
  Total weights = 2.0000e+06
  Execution time = 1.8866e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342650106800
                                         uncertainty =       0.004828374650

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342650106800
                                         uncertainty =       0.004828374650

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413921273
  error estimate for blocks of size 2^( 2) =       0.000426917760
  error estimate for blocks of size 2^( 3) =       0.000440402014
  error estimate for blocks of size 2^( 4) =       0.000453051610
  error estimate for blocks of size 2^( 5) =       0.000464496226
  error estimate for blocks of size 2^( 6) =       0.000472220603
  error estimate for blocks of size 2^( 7) =       0.000476889059

      target function =                  N/A
              le_mean =     -16.905394807228
             les_mean =     286.135035057081
             stat err =       0.000466664374
             autocorr =       1.271082681281
              std dev =       0.585373077753
             le_variance =       0.342661640158

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342638574062
                                         uncertainty =       0.004827979946

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342638574062
                                         uncertainty =       0.004827979946

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413914318
  error estimate for blocks of size 2^( 2) =       0.000426911297
  error estimate for blocks of size 2^( 3) =       0.000440395733
  error estimate for blocks of size 2^( 4) =       0.000453045670
  error estimate for blocks of size 2^( 5) =       0.000464490282
  error estimate for blocks of size 2^( 6) =       0.000472214379
  error estimate for blocks of size 2^( 7) =       0.000476882466

      target function =                  N/A
              le_mean =     -16.905394961719
             les_mean =     286.135028764928
             stat err =       0.000466658199
             autocorr =       1.271091759228
              std dev =       0.585363241527
             le_variance =       0.342650124532

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342643761089
                                         uncertainty =       0.004828155077

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342643761089
                                         uncertainty =       0.004828155077

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413917446
  error estimate for blocks of size 2^( 2) =       0.000426914189
  error estimate for blocks of size 2^( 3) =       0.000440398519
  error estimate for blocks of size 2^( 4) =       0.000453048302
  error estimate for blocks of size 2^( 5) =       0.000464492920
  error estimate for blocks of size 2^( 6) =       0.000472217155
  error estimate for blocks of size 2^( 7) =       0.000476885398

      target function =                  N/A
              le_mean =     -16.905394887988
             les_mean =     286.135031451206
             stat err =       0.000466660944
             autocorr =       1.271087498602
              std dev =       0.585367665421
             le_variance =       0.342655303721

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342649295715
                                         uncertainty =       0.004828346444

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342649295715
                                         uncertainty =       0.004828346444

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413920784
  error estimate for blocks of size 2^( 2) =       0.000426917303
  error estimate for blocks of size 2^( 3) =       0.000440401565
  error estimate for blocks of size 2^( 4) =       0.000453051185
  error estimate for blocks of size 2^( 5) =       0.000464495802
  error estimate for blocks of size 2^( 6) =       0.000472220161
  error estimate for blocks of size 2^( 7) =       0.000476888589

      target function =                  N/A
              le_mean =     -16.905394817141
             les_mean =     286.135034582330
             stat err =       0.000466663934
             autocorr =       1.271083288343
              std dev =       0.585372385971
             le_variance =       0.342660830257


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905394807228        initial
     2.3842e+00     2.3842e+01             7.5425e-05       -16.905394961719  <--
     9.5367e+00     9.5367e+01             1.9053e-05       -16.905394887988
     3.8147e+01     3.8147e+02             4.7744e-06       -16.905394817141

*****************************************************************************
Applying the update for shift_i =   2.3842e+00     and shift_s =   2.3842e+01
*****************************************************************************

  Execution time = 2.9697e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.097250e-01 1 1  ON 0
 uu_1                 1.427063e-01 1 1  ON 1
 uu_2                 4.080265e-02 1 1  ON 2
 uu_3                -2.217724e-02 1 1  ON 3
 uu_4                -6.812465e-02 1 1  ON 4
 uu_5                -1.035712e-01 1 1  ON 5
 uu_6                -1.317263e-01 1 1  ON 6
 uu_7                -1.463197e-01 1 1  ON 7
 uu_8                -1.392763e-01 1 1  ON 8
 uu_9                -1.117067e-01 1 1  ON 9
 ud_0                 4.546466e-01 1 1  ON 10
 ud_1                 1.882367e-01 1 1  ON 11
 ud_2                 6.676477e-02 1 1  ON 12
 ud_3                -5.380635e-03 1 1  ON 13
 ud_4                -6.301128e-02 1 1  ON 14
 ud_5                -1.052698e-01 1 1  ON 15
 ud_6                -1.337776e-01 1 1  ON 16
 ud_7                -1.515312e-01 1 1  ON 17
 ud_8                -1.530647e-01 1 1  ON 18
 ud_9                -1.456212e-01 1 1  ON 19
 eO_0                -7.634629e-01 1 1  ON 20
 eO_1                -4.403365e-01 1 1  ON 21
 eO_2                -1.718432e-02 1 1  ON 22
 eO_3                 3.066901e-01 1 1  ON 23
 eO_4                 5.355554e-01 1 1  ON 24
 eO_5                 4.997873e-01 1 1  ON 25
 eO_6                 2.701359e-01 1 1  ON 26
 eO_7                -3.699683e-02 1 1  ON 27
 eO_8                -2.401241e-01 1 1  ON 28
 eO_9                -1.088737e-01 1 1  ON 29
eH1_0                -2.558998e-01 1 1  ON 30
eH1_1                -1.545670e-01 1 1  ON 31
eH1_2                -1.072775e-01 1 1  ON 32
eH1_3                -5.234102e-02 1 1  ON 33
eH1_4                -3.344944e-03 1 1  ON 34
eH1_5                 3.202446e-02 1 1  ON 35
eH1_6                 9.327247e-02 1 1  ON 36
eH1_7                 1.552503e-01 1 1  ON 37
eH1_8                 1.953081e-01 1 1  ON 38
eH1_9                 9.673229e-02 1 1  ON 39
eH2_0                -2.532983e-01 1 1  ON 40
eH2_1                -1.517166e-01 1 1  ON 41
eH2_2                -1.044603e-01 1 1  ON 42
eH2_3                -4.970869e-02 1 1  ON 43
eH2_4                -1.023878e-03 1 1  ON 44
eH2_5                 3.367987e-02 1 1  ON 45
eH2_6                 9.503571e-02 1 1  ON 46
eH2_7                 1.556411e-01 1 1  ON 47
eH2_8                 1.983557e-01 1 1  ON 48
eH2_9                 9.053963e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5724e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.8722
    reference variance = 0.287097
====================================================
  Execution time = 2.0583e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4599e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5964e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345997008507
                                         uncertainty =       0.004324881951

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345997008507
                                         uncertainty =       0.004324881951

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415929468
  error estimate for blocks of size 2^( 2) =       0.000429225939
  error estimate for blocks of size 2^( 3) =       0.000442944492
  error estimate for blocks of size 2^( 4) =       0.000455869940
  error estimate for blocks of size 2^( 5) =       0.000466674080
  error estimate for blocks of size 2^( 6) =       0.000475917881
  error estimate for blocks of size 2^( 7) =       0.000481677349

      target function =                  N/A
              le_mean =     -16.905223781684
             les_mean =     286.132585580449
             stat err =       0.000470034812
             autocorr =       1.277087541067
              std dev =       0.588213094565
             le_variance =       0.345994644618


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690522378168e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e-01, overlap shift 5.9605e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905223781684       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905225657225       residual = 5.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905225885415       residual = 7.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905224554099       residual = 3.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905224466941       residual = 3.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905225329229       residual = 8.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905225391470       residual = 3.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905225347641       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905225455797       residual = 5.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e-01 is 3.069500e-04

solving harmonic davidson linear method for identity shift 2.3842e+00, overlap shift 2.3842e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905223781684       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905224342828       residual = 5.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905224465580       residual = 5.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905224267737       residual = 2.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905224110913       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905224241091       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905224370637       residual = 1.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905224341426       residual = 6.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+00 is 7.535434e-05

solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905223781684       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905223929228       residual = 5.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905223966573       residual = 5.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905223939749       residual = 2.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905223889806       residual = 8.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905223932238       residual = 8.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905223949342       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905223944890       residual = 3.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+00 is 1.911657e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.177023 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6187e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.097409e-01 1 1  ON 0
 uu_1                 1.426499e-01 1 1  ON 1
 uu_2                 4.080060e-02 1 1  ON 2
 uu_3                -2.220888e-02 1 1  ON 3
 uu_4                -6.813384e-02 1 1  ON 4
 uu_5                -1.036140e-01 1 1  ON 5
 uu_6                -1.317739e-01 1 1  ON 6
 uu_7                -1.463310e-01 1 1  ON 7
 uu_8                -1.392141e-01 1 1  ON 8
 uu_9                -1.116709e-01 1 1  ON 9
 ud_0                 4.546050e-01 1 1  ON 10
 ud_1                 1.882613e-01 1 1  ON 11
 ud_2                 6.674088e-02 1 1  ON 12
 ud_3                -5.374479e-03 1 1  ON 13
 ud_4                -6.304403e-02 1 1  ON 14
 ud_5                -1.052991e-01 1 1  ON 15
 ud_6                -1.338058e-01 1 1  ON 16
 ud_7                -1.515138e-01 1 1  ON 17
 ud_8                -1.529960e-01 1 1  ON 18
 ud_9                -1.455618e-01 1 1  ON 19
 eO_0                -7.634270e-01 1 1  ON 20
 eO_1                -4.403527e-01 1 1  ON 21
 eO_2                -1.720954e-02 1 1  ON 22
 eO_3                 3.067048e-01 1 1  ON 23
 eO_4                 5.355846e-01 1 1  ON 24
 eO_5                 4.997929e-01 1 1  ON 25
 eO_6                 2.701262e-01 1 1  ON 26
 eO_7                -3.699493e-02 1 1  ON 27
 eO_8                -2.401251e-01 1 1  ON 28
 eO_9                -1.089030e-01 1 1  ON 29
eH1_0                -2.559335e-01 1 1  ON 30
eH1_1                -1.545987e-01 1 1  ON 31
eH1_2                -1.072827e-01 1 1  ON 32
eH1_3                -5.231280e-02 1 1  ON 33
eH1_4                -3.400236e-03 1 1  ON 34
eH1_5                 3.201864e-02 1 1  ON 35
eH1_6                 9.323611e-02 1 1  ON 36
eH1_7                 1.552656e-01 1 1  ON 37
eH1_8                 1.953463e-01 1 1  ON 38
eH1_9                 9.680764e-02 1 1  ON 39
eH2_0                -2.533084e-01 1 1  ON 40
eH2_1                -1.517866e-01 1 1  ON 41
eH2_2                -1.045088e-01 1 1  ON 42
eH2_3                -4.972150e-02 1 1  ON 43
eH2_4                -1.021033e-03 1 1  ON 44
eH2_5                 3.369491e-02 1 1  ON 45
eH2_6                 9.504911e-02 1 1  ON 46
eH2_7                 1.556538e-01 1 1  ON 47
eH2_8                 1.983737e-01 1 1  ON 48
eH2_9                 9.060764e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.8831
    reference variance = 0.207847
====================================================
  Execution time = 2.0099e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4837e-01
  Total weights = 2.0000e+06
  Execution time = 1.8901e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348211163904
                                         uncertainty =       0.011365162499

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348211163904
                                         uncertainty =       0.011365162499

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417372305
  error estimate for blocks of size 2^( 2) =       0.000430333485
  error estimate for blocks of size 2^( 3) =       0.000443439554
  error estimate for blocks of size 2^( 4) =       0.000456109497
  error estimate for blocks of size 2^( 5) =       0.000466307498
  error estimate for blocks of size 2^( 6) =       0.000474834269
  error estimate for blocks of size 2^( 7) =       0.000480347336

      target function =                  N/A
              le_mean =     -16.906126995420
             les_mean =     286.165529092739
             stat err =       0.000469399650
             autocorr =       1.264847793806
              std dev =       0.590253574033
             le_variance =       0.348399281659

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348133712022
                                         uncertainty =       0.011355900056

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348133712022
                                         uncertainty =       0.011355900056

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417325834
  error estimate for blocks of size 2^( 2) =       0.000430290312
  error estimate for blocks of size 2^( 3) =       0.000443399035
  error estimate for blocks of size 2^( 4) =       0.000456069650
  error estimate for blocks of size 2^( 5) =       0.000466267335
  error estimate for blocks of size 2^( 6) =       0.000474792643
  error estimate for blocks of size 2^( 7) =       0.000480308844

      target function =                  N/A
              le_mean =     -16.906126665606
             les_mean =     286.165440362423
             stat err =       0.000469359618
             autocorr =       1.264913723122
              std dev =       0.590187854041
             le_variance =       0.348321703058

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348144291106
                                         uncertainty =       0.011357296181

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348144291106
                                         uncertainty =       0.011357296181

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417332216
  error estimate for blocks of size 2^( 2) =       0.000430295716
  error estimate for blocks of size 2^( 3) =       0.000443403767
  error estimate for blocks of size 2^( 4) =       0.000456074179
  error estimate for blocks of size 2^( 5) =       0.000466271902
  error estimate for blocks of size 2^( 6) =       0.000474797941
  error estimate for blocks of size 2^( 7) =       0.000480314422

      target function =                  N/A
              le_mean =     -16.906126594143
             les_mean =     286.165448600254
             stat err =       0.000469364611
             autocorr =       1.264901945412
              std dev =       0.590196880064
             le_variance =       0.348332357237

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348201170294
                                         uncertainty =       0.011363930073

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348201170294
                                         uncertainty =       0.011363930073

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417366316
  error estimate for blocks of size 2^( 2) =       0.000430327814
  error estimate for blocks of size 2^( 3) =       0.000443434159
  error estimate for blocks of size 2^( 4) =       0.000456104153
  error estimate for blocks of size 2^( 5) =       0.000466302102
  error estimate for blocks of size 2^( 6) =       0.000474828777
  error estimate for blocks of size 2^( 7) =       0.000480342387

      target function =                  N/A
              le_mean =     -16.906126917999
             les_mean =     286.165516476967
             stat err =       0.000469394354
             autocorr =       1.264855553024
              std dev =       0.590245104728
             le_variance =       0.348389283656


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906126995420        initial  <--
     5.9605e-01     5.9605e+00             3.0695e-04       -16.906126665606
     2.3842e+00     2.3842e+01             7.5354e-05       -16.906126594143
     9.5367e+00     9.5367e+01             1.9117e-05       -16.906126917999

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6506
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.097250e-01 1 1  ON 0
 uu_1                 1.427063e-01 1 1  ON 1
 uu_2                 4.080265e-02 1 1  ON 2
 uu_3                -2.217724e-02 1 1  ON 3
 uu_4                -6.812465e-02 1 1  ON 4
 uu_5                -1.035712e-01 1 1  ON 5
 uu_6                -1.317263e-01 1 1  ON 6
 uu_7                -1.463197e-01 1 1  ON 7
 uu_8                -1.392763e-01 1 1  ON 8
 uu_9                -1.117067e-01 1 1  ON 9
 ud_0                 4.546466e-01 1 1  ON 10
 ud_1                 1.882367e-01 1 1  ON 11
 ud_2                 6.676477e-02 1 1  ON 12
 ud_3                -5.380635e-03 1 1  ON 13
 ud_4                -6.301128e-02 1 1  ON 14
 ud_5                -1.052698e-01 1 1  ON 15
 ud_6                -1.337776e-01 1 1  ON 16
 ud_7                -1.515312e-01 1 1  ON 17
 ud_8                -1.530647e-01 1 1  ON 18
 ud_9                -1.456212e-01 1 1  ON 19
 eO_0                -7.634629e-01 1 1  ON 20
 eO_1                -4.403365e-01 1 1  ON 21
 eO_2                -1.718432e-02 1 1  ON 22
 eO_3                 3.066901e-01 1 1  ON 23
 eO_4                 5.355554e-01 1 1  ON 24
 eO_5                 4.997873e-01 1 1  ON 25
 eO_6                 2.701359e-01 1 1  ON 26
 eO_7                -3.699683e-02 1 1  ON 27
 eO_8                -2.401241e-01 1 1  ON 28
 eO_9                -1.088737e-01 1 1  ON 29
eH1_0                -2.558998e-01 1 1  ON 30
eH1_1                -1.545670e-01 1 1  ON 31
eH1_2                -1.072775e-01 1 1  ON 32
eH1_3                -5.234102e-02 1 1  ON 33
eH1_4                -3.344944e-03 1 1  ON 34
eH1_5                 3.202446e-02 1 1  ON 35
eH1_6                 9.327247e-02 1 1  ON 36
eH1_7                 1.552503e-01 1 1  ON 37
eH1_8                 1.953081e-01 1 1  ON 38
eH1_9                 9.673229e-02 1 1  ON 39
eH2_0                -2.532983e-01 1 1  ON 40
eH2_1                -1.517166e-01 1 1  ON 41
eH2_2                -1.044603e-01 1 1  ON 42
eH2_3                -4.970869e-02 1 1  ON 43
eH2_4                -1.023878e-03 1 1  ON 44
eH2_5                 3.367987e-02 1 1  ON 45
eH2_6                 9.503571e-02 1 1  ON 46
eH2_7                 1.556411e-01 1 1  ON 47
eH2_8                 1.983557e-01 1 1  ON 48
eH2_9                 9.053963e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5845e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.9194
    reference variance = 0.160629
====================================================
  Execution time = 2.0800e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4011e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6042e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340129350450
                                         uncertainty =       0.003048974653

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340129350450
                                         uncertainty =       0.003048974653

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412379204
  error estimate for blocks of size 2^( 2) =       0.000425476595
  error estimate for blocks of size 2^( 3) =       0.000438337405
  error estimate for blocks of size 2^( 4) =       0.000450482790
  error estimate for blocks of size 2^( 5) =       0.000462062334
  error estimate for blocks of size 2^( 6) =       0.000469250747
  error estimate for blocks of size 2^( 7) =       0.000474916935

      target function =                  N/A
              le_mean =     -16.905701592104
             les_mean =     286.142859366754
             stat err =       0.000464178201
             autocorr =       1.266998122032
              std dev =       0.583192262927
             le_variance =       0.340113215538


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690570159210e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905701592104       residual = 8.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905701630903       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905701649012       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905701686888       residual = 7.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905701707753       residual = 2.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905701716254       residual = 4.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905701728374       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905701720493       residual = 3.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+00 is 2.896516e-05

solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905701592104       residual = 8.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905701601974       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905701606714       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905701616502       residual = 7.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905701621581       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905701623894       residual = 4.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905701627244       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905701625475       residual = 2.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+01 is 7.424994e-06

solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905701592104       residual = 8.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905701594582       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905701595782       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905701598249       residual = 7.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905701599509       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905701600099       residual = 4.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905701600958       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905701600530       residual = 2.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+01 is 1.868142e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.179688 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6411e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.097299e-01 1 1  ON 0
 uu_1                 1.427089e-01 1 1  ON 1
 uu_2                 4.080207e-02 1 1  ON 2
 uu_3                -2.217642e-02 1 1  ON 3
 uu_4                -6.812590e-02 1 1  ON 4
 uu_5                -1.035746e-01 1 1  ON 5
 uu_6                -1.317284e-01 1 1  ON 6
 uu_7                -1.463197e-01 1 1  ON 7
 uu_8                -1.392769e-01 1 1  ON 8
 uu_9                -1.117096e-01 1 1  ON 9
 ud_0                 4.546531e-01 1 1  ON 10
 ud_1                 1.882370e-01 1 1  ON 11
 ud_2                 6.676707e-02 1 1  ON 12
 ud_3                -5.378668e-03 1 1  ON 13
 ud_4                -6.300859e-02 1 1  ON 14
 ud_5                -1.052719e-01 1 1  ON 15
 ud_6                -1.337701e-01 1 1  ON 16
 ud_7                -1.515365e-01 1 1  ON 17
 ud_8                -1.530680e-01 1 1  ON 18
 ud_9                -1.456241e-01 1 1  ON 19
 eO_0                -7.634606e-01 1 1  ON 20
 eO_1                -4.403317e-01 1 1  ON 21
 eO_2                -1.718189e-02 1 1  ON 22
 eO_3                 3.066906e-01 1 1  ON 23
 eO_4                 5.355574e-01 1 1  ON 24
 eO_5                 4.997851e-01 1 1  ON 25
 eO_6                 2.701346e-01 1 1  ON 26
 eO_7                -3.699513e-02 1 1  ON 27
 eO_8                -2.401265e-01 1 1  ON 28
 eO_9                -1.088800e-01 1 1  ON 29
eH1_0                -2.559052e-01 1 1  ON 30
eH1_1                -1.545705e-01 1 1  ON 31
eH1_2                -1.072770e-01 1 1  ON 32
eH1_3                -5.234169e-02 1 1  ON 33
eH1_4                -3.343868e-03 1 1  ON 34
eH1_5                 3.202053e-02 1 1  ON 35
eH1_6                 9.327284e-02 1 1  ON 36
eH1_7                 1.552513e-01 1 1  ON 37
eH1_8                 1.953113e-01 1 1  ON 38
eH1_9                 9.673851e-02 1 1  ON 39
eH2_0                -2.532965e-01 1 1  ON 40
eH2_1                -1.517209e-01 1 1  ON 41
eH2_2                -1.044604e-01 1 1  ON 42
eH2_3                -4.971298e-02 1 1  ON 43
eH2_4                -1.024670e-03 1 1  ON 44
eH2_5                 3.368137e-02 1 1  ON 45
eH2_6                 9.503548e-02 1 1  ON 46
eH2_7                 1.556384e-01 1 1  ON 47
eH2_8                 1.983570e-01 1 1  ON 48
eH2_9                 9.054638e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.8851
    reference variance = 0.199486
====================================================
  Execution time = 1.9950e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3739e-01
  Total weights = 2.0000e+06
  Execution time = 1.8592e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337492457556
                                         uncertainty =       0.003728089208

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337492457556
                                         uncertainty =       0.003728089208

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410723695
  error estimate for blocks of size 2^( 2) =       0.000423372394
  error estimate for blocks of size 2^( 3) =       0.000436937511
  error estimate for blocks of size 2^( 4) =       0.000448842404
  error estimate for blocks of size 2^( 5) =       0.000459369948
  error estimate for blocks of size 2^( 6) =       0.000466284147
  error estimate for blocks of size 2^( 7) =       0.000471745397

      target function =                  N/A
              le_mean =     -16.905792690976
             les_mean =     286.143214249333
             stat err =       0.000461560474
             autocorr =       1.262867259384
              std dev =       0.580851020274
             le_variance =       0.337387907754

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337513167031
                                         uncertainty =       0.003728368803

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337513167031
                                         uncertainty =       0.003728368803

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410736300
  error estimate for blocks of size 2^( 2) =       0.000423384357
  error estimate for blocks of size 2^( 3) =       0.000436948935
  error estimate for blocks of size 2^( 4) =       0.000448853642
  error estimate for blocks of size 2^( 5) =       0.000459381189
  error estimate for blocks of size 2^( 6) =       0.000466295029
  error estimate for blocks of size 2^( 7) =       0.000471756489

      target function =                  N/A
              le_mean =     -16.905792913060
             les_mean =     286.143242466227
             stat err =       0.000461571587
             autocorr =       1.262850562104
              std dev =       0.580868845497
             le_variance =       0.337408615669

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337503375890
                                         uncertainty =       0.003728237198

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337503375890
                                         uncertainty =       0.003728237198

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410730341
  error estimate for blocks of size 2^( 2) =       0.000423378705
  error estimate for blocks of size 2^( 3) =       0.000436943542
  error estimate for blocks of size 2^( 4) =       0.000448848339
  error estimate for blocks of size 2^( 5) =       0.000459375879
  error estimate for blocks of size 2^( 6) =       0.000466289890
  error estimate for blocks of size 2^( 7) =       0.000471751238

      target function =                  N/A
              le_mean =     -16.905792806352
             les_mean =     286.143229067860
             stat err =       0.000461566336
             autocorr =       1.262858474451
              std dev =       0.580860418039
             le_variance =       0.337398825245

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337493840826
                                         uncertainty =       0.003728107982

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337493840826
                                         uncertainty =       0.003728107982

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410724537
  error estimate for blocks of size 2^( 2) =       0.000423373194
  error estimate for blocks of size 2^( 3) =       0.000436938276
  error estimate for blocks of size 2^( 4) =       0.000448843156
  error estimate for blocks of size 2^( 5) =       0.000459370700
  error estimate for blocks of size 2^( 6) =       0.000466284875
  error estimate for blocks of size 2^( 7) =       0.000471746136

      target function =                  N/A
              le_mean =     -16.905792705494
             les_mean =     286.143216123357
             stat err =       0.000461561217
             autocorr =       1.262866146638
              std dev =       0.580852210908
             le_variance =       0.337389290917


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905792690976        initial
     5.9605e+00     5.9605e+01             2.8965e-05       -16.905792913060  <--
     2.3842e+01     2.3842e+02             7.4250e-06       -16.905792806352
     9.5367e+01     9.5367e+02             1.8681e-06       -16.905792705494

*****************************************************************************
Applying the update for shift_i =   5.9605e+00     and shift_s =   5.9605e+01
*****************************************************************************

  Execution time = 2.9338e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.097442e-01 1 1  ON 0
 uu_1                 1.427162e-01 1 1  ON 1
 uu_2                 4.080079e-02 1 1  ON 2
 uu_3                -2.217431e-02 1 1  ON 3
 uu_4                -6.812938e-02 1 1  ON 4
 uu_5                -1.035845e-01 1 1  ON 5
 uu_6                -1.317346e-01 1 1  ON 6
 uu_7                -1.463199e-01 1 1  ON 7
 uu_8                -1.392785e-01 1 1  ON 8
 uu_9                -1.117185e-01 1 1  ON 9
 ud_0                 4.546713e-01 1 1  ON 10
 ud_1                 1.882382e-01 1 1  ON 11
 ud_2                 6.677390e-02 1 1  ON 12
 ud_3                -5.372718e-03 1 1  ON 13
 ud_4                -6.300065e-02 1 1  ON 14
 ud_5                -1.052779e-01 1 1  ON 15
 ud_6                -1.337486e-01 1 1  ON 16
 ud_7                -1.515522e-01 1 1  ON 17
 ud_8                -1.530778e-01 1 1  ON 18
 ud_9                -1.456325e-01 1 1  ON 19
 eO_0                -7.634539e-01 1 1  ON 20
 eO_1                -4.403175e-01 1 1  ON 21
 eO_2                -1.717458e-02 1 1  ON 22
 eO_3                 3.066922e-01 1 1  ON 23
 eO_4                 5.355631e-01 1 1  ON 24
 eO_5                 4.997784e-01 1 1  ON 25
 eO_6                 2.701309e-01 1 1  ON 26
 eO_7                -3.698999e-02 1 1  ON 27
 eO_8                -2.401338e-01 1 1  ON 28
 eO_9                -1.088988e-01 1 1  ON 29
eH1_0                -2.559215e-01 1 1  ON 30
eH1_1                -1.545806e-01 1 1  ON 31
eH1_2                -1.072758e-01 1 1  ON 32
eH1_3                -5.234372e-02 1 1  ON 33
eH1_4                -3.340630e-03 1 1  ON 34
eH1_5                 3.200889e-02 1 1  ON 35
eH1_6                 9.327391e-02 1 1  ON 36
eH1_7                 1.552545e-01 1 1  ON 37
eH1_8                 1.953209e-01 1 1  ON 38
eH1_9                 9.675710e-02 1 1  ON 39
eH2_0                -2.532911e-01 1 1  ON 40
eH2_1                -1.517336e-01 1 1  ON 41
eH2_2                -1.044611e-01 1 1  ON 42
eH2_3                -4.972559e-02 1 1  ON 43
eH2_4                -1.027090e-03 1 1  ON 44
eH2_5                 3.368589e-02 1 1  ON 45
eH2_6                 9.503485e-02 1 1  ON 46
eH2_7                 1.556304e-01 1 1  ON 47
eH2_8                 1.983609e-01 1 1  ON 48
eH2_9                 9.056656e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5756e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.853
    reference variance = 0.266687
====================================================
  Execution time = 2.0434e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4097e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5078e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341013055589
                                         uncertainty =       0.007004109131

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341013055589
                                         uncertainty =       0.007004109131

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412897122
  error estimate for blocks of size 2^( 2) =       0.000426010989
  error estimate for blocks of size 2^( 3) =       0.000439376697
  error estimate for blocks of size 2^( 4) =       0.000452060607
  error estimate for blocks of size 2^( 5) =       0.000462931251
  error estimate for blocks of size 2^( 6) =       0.000471240456
  error estimate for blocks of size 2^( 7) =       0.000473952088

      target function =                  N/A
              le_mean =     -16.905491491986
             les_mean =     286.136610481752
             stat err =       0.000465046101
             autocorr =       1.268552083451
              std dev =       0.583924709733
             le_variance =       0.340968066636


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690549149199e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+00, overlap shift 1.4901e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905491491986       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905491812541       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905491911334       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905492306646       residual = 6.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905492303434       residual = 2.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905492317854       residual = 7.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905492252715       residual = 1.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905492239188       residual = 7.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+00 is 1.699272e-04

solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905491491986       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905491576230       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905491606935       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905491710454       residual = 5.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905491701339       residual = 2.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905491705219       residual = 5.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905491689196       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905491688106       residual = 3.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+00 is 4.311539e-05

solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905491491986       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905491513320       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905491521454       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905491547657       residual = 4.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905491544715       residual = 2.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905491545664       residual = 4.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905491541723       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905491541572       residual = 2.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+01 is 1.081540e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.182369 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5948e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.097552e-01 1 1  ON 0
 uu_1                 1.427103e-01 1 1  ON 1
 uu_2                 4.079775e-02 1 1  ON 2
 uu_3                -2.217652e-02 1 1  ON 3
 uu_4                -6.813097e-02 1 1  ON 4
 uu_5                -1.035873e-01 1 1  ON 5
 uu_6                -1.317587e-01 1 1  ON 6
 uu_7                -1.463383e-01 1 1  ON 7
 uu_8                -1.392765e-01 1 1  ON 8
 uu_9                -1.117042e-01 1 1  ON 9
 ud_0                 4.546711e-01 1 1  ON 10
 ud_1                 1.882458e-01 1 1  ON 11
 ud_2                 6.677519e-02 1 1  ON 12
 ud_3                -5.371612e-03 1 1  ON 13
 ud_4                -6.301309e-02 1 1  ON 14
 ud_5                -1.052896e-01 1 1  ON 15
 ud_6                -1.337507e-01 1 1  ON 16
 ud_7                -1.515477e-01 1 1  ON 17
 ud_8                -1.530581e-01 1 1  ON 18
 ud_9                -1.456272e-01 1 1  ON 19
 eO_0                -7.634484e-01 1 1  ON 20
 eO_1                -4.403257e-01 1 1  ON 21
 eO_2                -1.717595e-02 1 1  ON 22
 eO_3                 3.067018e-01 1 1  ON 23
 eO_4                 5.355915e-01 1 1  ON 24
 eO_5                 4.997726e-01 1 1  ON 25
 eO_6                 2.701283e-01 1 1  ON 26
 eO_7                -3.698777e-02 1 1  ON 27
 eO_8                -2.401339e-01 1 1  ON 28
 eO_9                -1.089211e-01 1 1  ON 29
eH1_0                -2.559303e-01 1 1  ON 30
eH1_1                -1.545912e-01 1 1  ON 31
eH1_2                -1.072706e-01 1 1  ON 32
eH1_3                -5.234570e-02 1 1  ON 33
eH1_4                -3.338245e-03 1 1  ON 34
eH1_5                 3.199920e-02 1 1  ON 35
eH1_6                 9.325844e-02 1 1  ON 36
eH1_7                 1.552563e-01 1 1  ON 37
eH1_8                 1.953294e-01 1 1  ON 38
eH1_9                 9.678338e-02 1 1  ON 39
eH2_0                -2.533024e-01 1 1  ON 40
eH2_1                -1.517471e-01 1 1  ON 41
eH2_2                -1.044876e-01 1 1  ON 42
eH2_3                -4.973825e-02 1 1  ON 43
eH2_4                -1.044793e-03 1 1  ON 44
eH2_5                 3.368628e-02 1 1  ON 45
eH2_6                 9.503532e-02 1 1  ON 46
eH2_7                 1.556402e-01 1 1  ON 47
eH2_8                 1.983797e-01 1 1  ON 48
eH2_9                 9.060968e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.8928
    reference variance = 0.297551
====================================================
  Execution time = 2.0225e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4169e-01
  Total weights = 2.0000e+06
  Execution time = 1.8550e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341756946943
                                         uncertainty =       0.003292345736

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341756946943
                                         uncertainty =       0.003292345736

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413330869
  error estimate for blocks of size 2^( 2) =       0.000425908577
  error estimate for blocks of size 2^( 3) =       0.000438831317
  error estimate for blocks of size 2^( 4) =       0.000450573597
  error estimate for blocks of size 2^( 5) =       0.000461555594
  error estimate for blocks of size 2^( 6) =       0.000468880462
  error estimate for blocks of size 2^( 7) =       0.000474444902

      target function =                  N/A
              le_mean =     -16.906354899431
             les_mean =     286.166520628663
             stat err =       0.000463863639
             autocorr =       1.259461740438
              std dev =       0.584538120209
             le_variance =       0.341684813977

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341766027873
                                         uncertainty =       0.003292518372

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341766027873
                                         uncertainty =       0.003292518372

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413336349
  error estimate for blocks of size 2^( 2) =       0.000425914558
  error estimate for blocks of size 2^( 3) =       0.000438837077
  error estimate for blocks of size 2^( 4) =       0.000450578402
  error estimate for blocks of size 2^( 5) =       0.000461560222
  error estimate for blocks of size 2^( 6) =       0.000468885212
  error estimate for blocks of size 2^( 7) =       0.000474451988

      target function =                  N/A
              le_mean =     -16.906354779529
             les_mean =     286.166525634889
             stat err =       0.000463868956
             autocorr =       1.259457219917
              std dev =       0.584545870245
             le_variance =       0.341693874421

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341760141784
                                         uncertainty =       0.003292422939

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341760141784
                                         uncertainty =       0.003292422939

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413332795
  error estimate for blocks of size 2^( 2) =       0.000425910825
  error estimate for blocks of size 2^( 3) =       0.000438833483
  error estimate for blocks of size 2^( 4) =       0.000450575291
  error estimate for blocks of size 2^( 5) =       0.000461557248
  error estimate for blocks of size 2^( 6) =       0.000468882256
  error estimate for blocks of size 2^( 7) =       0.000474448012

      target function =                  N/A
              le_mean =     -16.906354834364
             les_mean =     286.166521613024
             stat err =       0.000463865701
             autocorr =       1.259461204389
              std dev =       0.584540844113
             le_variance =       0.341687998437

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341757287822
                                         uncertainty =       0.003292354993

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341757287822
                                         uncertainty =       0.003292354993

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413331074
  error estimate for blocks of size 2^( 2) =       0.000425908825
  error estimate for blocks of size 2^( 3) =       0.000438831556
  error estimate for blocks of size 2^( 4) =       0.000450573777
  error estimate for blocks of size 2^( 5) =       0.000461555771
  error estimate for blocks of size 2^( 6) =       0.000468880659
  error estimate for blocks of size 2^( 7) =       0.000474445269

      target function =                  N/A
              le_mean =     -16.906354890592
             les_mean =     286.166520669345
             stat err =       0.000463863869
             autocorr =       1.259461740736
              std dev =       0.584538410672
             le_variance =       0.341685153551


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906354899431        initial  <--
     1.4901e+00     1.4901e+01             1.6993e-04       -16.906354779529
     5.9605e+00     5.9605e+01             4.3115e-05       -16.906354834364
     2.3842e+01     2.3842e+02             1.0815e-05       -16.906354890592

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5910
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.097442e-01 1 1  ON 0
 uu_1                 1.427162e-01 1 1  ON 1
 uu_2                 4.080079e-02 1 1  ON 2
 uu_3                -2.217431e-02 1 1  ON 3
 uu_4                -6.812938e-02 1 1  ON 4
 uu_5                -1.035845e-01 1 1  ON 5
 uu_6                -1.317346e-01 1 1  ON 6
 uu_7                -1.463199e-01 1 1  ON 7
 uu_8                -1.392785e-01 1 1  ON 8
 uu_9                -1.117185e-01 1 1  ON 9
 ud_0                 4.546713e-01 1 1  ON 10
 ud_1                 1.882382e-01 1 1  ON 11
 ud_2                 6.677390e-02 1 1  ON 12
 ud_3                -5.372718e-03 1 1  ON 13
 ud_4                -6.300065e-02 1 1  ON 14
 ud_5                -1.052779e-01 1 1  ON 15
 ud_6                -1.337486e-01 1 1  ON 16
 ud_7                -1.515522e-01 1 1  ON 17
 ud_8                -1.530778e-01 1 1  ON 18
 ud_9                -1.456325e-01 1 1  ON 19
 eO_0                -7.634539e-01 1 1  ON 20
 eO_1                -4.403175e-01 1 1  ON 21
 eO_2                -1.717458e-02 1 1  ON 22
 eO_3                 3.066922e-01 1 1  ON 23
 eO_4                 5.355631e-01 1 1  ON 24
 eO_5                 4.997784e-01 1 1  ON 25
 eO_6                 2.701309e-01 1 1  ON 26
 eO_7                -3.698999e-02 1 1  ON 27
 eO_8                -2.401338e-01 1 1  ON 28
 eO_9                -1.088988e-01 1 1  ON 29
eH1_0                -2.559215e-01 1 1  ON 30
eH1_1                -1.545806e-01 1 1  ON 31
eH1_2                -1.072758e-01 1 1  ON 32
eH1_3                -5.234372e-02 1 1  ON 33
eH1_4                -3.340630e-03 1 1  ON 34
eH1_5                 3.200889e-02 1 1  ON 35
eH1_6                 9.327391e-02 1 1  ON 36
eH1_7                 1.552545e-01 1 1  ON 37
eH1_8                 1.953209e-01 1 1  ON 38
eH1_9                 9.675710e-02 1 1  ON 39
eH2_0                -2.532911e-01 1 1  ON 40
eH2_1                -1.517336e-01 1 1  ON 41
eH2_2                -1.044611e-01 1 1  ON 42
eH2_3                -4.972559e-02 1 1  ON 43
eH2_4                -1.027090e-03 1 1  ON 44
eH2_5                 3.368589e-02 1 1  ON 45
eH2_6                 9.503485e-02 1 1  ON 46
eH2_7                 1.556304e-01 1 1  ON 47
eH2_8                 1.983609e-01 1 1  ON 48
eH2_9                 9.056656e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5546e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.1188
    reference variance = 3.93446
====================================================
  Execution time = 2.0251e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4568e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5534e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345430493915
                                         uncertainty =       0.006378766784

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345430493915
                                         uncertainty =       0.006378766784

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415739762
  error estimate for blocks of size 2^( 2) =       0.000428145171
  error estimate for blocks of size 2^( 3) =       0.000441226694
  error estimate for blocks of size 2^( 4) =       0.000453292857
  error estimate for blocks of size 2^( 5) =       0.000463949750
  error estimate for blocks of size 2^( 6) =       0.000471054794
  error estimate for blocks of size 2^( 7) =       0.000478830575

      target function =                  N/A
              le_mean =     -16.906033348711
             les_mean =     286.159642513599
             stat err =       0.000466781994
             autocorr =       1.260622531295
              std dev =       0.587944809234
             le_variance =       0.345679098705


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690603334871e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+01, overlap shift 1.4901e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906033348711       residual = 8.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906033398990       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906033409985       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906033410534       residual = 4.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906033431446       residual = 2.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906033441905       residual = 6.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906033426819       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906033426585       residual = 3.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+01 is 1.267548e-05

solving harmonic davidson linear method for identity shift 5.9605e+01, overlap shift 5.9605e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906033348711       residual = 8.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906033361350       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906033364163       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906033364310       residual = 4.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906033369545       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906033372222       residual = 6.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906033368442       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906033368397       residual = 3.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+01 is 3.173204e-06

solving harmonic davidson linear method for identity shift 2.3842e+02, overlap shift 2.3842e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906033348711       residual = 8.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906033351875       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906033352582       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906033352620       residual = 4.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906033353929       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906033354602       residual = 6.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906033353657       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906033353646       residual = 3.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+02 is 7.935709e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.185018 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5811e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.097437e-01 1 1  ON 0
 uu_1                 1.427173e-01 1 1  ON 1
 uu_2                 4.080178e-02 1 1  ON 2
 uu_3                -2.217359e-02 1 1  ON 3
 uu_4                -6.812753e-02 1 1  ON 4
 uu_5                -1.035850e-01 1 1  ON 5
 uu_6                -1.317360e-01 1 1  ON 6
 uu_7                -1.463222e-01 1 1  ON 7
 uu_8                -1.392800e-01 1 1  ON 8
 uu_9                -1.117190e-01 1 1  ON 9
 ud_0                 4.546711e-01 1 1  ON 10
 ud_1                 1.882376e-01 1 1  ON 11
 ud_2                 6.677587e-02 1 1  ON 12
 ud_3                -5.372491e-03 1 1  ON 13
 ud_4                -6.300104e-02 1 1  ON 14
 ud_5                -1.052781e-01 1 1  ON 15
 ud_6                -1.337469e-01 1 1  ON 16
 ud_7                -1.515524e-01 1 1  ON 17
 ud_8                -1.530767e-01 1 1  ON 18
 ud_9                -1.456339e-01 1 1  ON 19
 eO_0                -7.634520e-01 1 1  ON 20
 eO_1                -4.403173e-01 1 1  ON 21
 eO_2                -1.717410e-02 1 1  ON 22
 eO_3                 3.066938e-01 1 1  ON 23
 eO_4                 5.355640e-01 1 1  ON 24
 eO_5                 4.997778e-01 1 1  ON 25
 eO_6                 2.701312e-01 1 1  ON 26
 eO_7                -3.699074e-02 1 1  ON 27
 eO_8                -2.401349e-01 1 1  ON 28
 eO_9                -1.089012e-01 1 1  ON 29
eH1_0                -2.559230e-01 1 1  ON 30
eH1_1                -1.545830e-01 1 1  ON 31
eH1_2                -1.072743e-01 1 1  ON 32
eH1_3                -5.234383e-02 1 1  ON 33
eH1_4                -3.343063e-03 1 1  ON 34
eH1_5                 3.200952e-02 1 1  ON 35
eH1_6                 9.327408e-02 1 1  ON 36
eH1_7                 1.552539e-01 1 1  ON 37
eH1_8                 1.953222e-01 1 1  ON 38
eH1_9                 9.676011e-02 1 1  ON 39
eH2_0                -2.532913e-01 1 1  ON 40
eH2_1                -1.517345e-01 1 1  ON 41
eH2_2                -1.044619e-01 1 1  ON 42
eH2_3                -4.972566e-02 1 1  ON 43
eH2_4                -1.027893e-03 1 1  ON 44
eH2_5                 3.368495e-02 1 1  ON 45
eH2_6                 9.503463e-02 1 1  ON 46
eH2_7                 1.556299e-01 1 1  ON 47
eH2_8                 1.983618e-01 1 1  ON 48
eH2_9                 9.056973e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.9271
    reference variance = 0.403238
====================================================
  Execution time = 1.9821e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3506e-01
  Total weights = 2.0000e+06
  Execution time = 1.8636e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335047467663
                                         uncertainty =       0.003368615267

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335047467663
                                         uncertainty =       0.003368615267

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409308515
  error estimate for blocks of size 2^( 2) =       0.000421914812
  error estimate for blocks of size 2^( 3) =       0.000434936441
  error estimate for blocks of size 2^( 4) =       0.000446253726
  error estimate for blocks of size 2^( 5) =       0.000456767701
  error estimate for blocks of size 2^( 6) =       0.000466117907
  error estimate for blocks of size 2^( 7) =       0.000470952642

      target function =                  N/A
              le_mean =     -16.905157066709
             les_mean =     286.119402202823
             stat err =       0.000460022994
             autocorr =       1.263157549056
              std dev =       0.578849652554
             le_variance =       0.335066920262

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335040008233
                                         uncertainty =       0.003368534356

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335040008233
                                         uncertainty =       0.003368534356

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409303960
  error estimate for blocks of size 2^( 2) =       0.000421910484
  error estimate for blocks of size 2^( 3) =       0.000434932401
  error estimate for blocks of size 2^( 4) =       0.000446250038
  error estimate for blocks of size 2^( 5) =       0.000456764379
  error estimate for blocks of size 2^( 6) =       0.000466114826
  error estimate for blocks of size 2^( 7) =       0.000470949888

      target function =                  N/A
              le_mean =     -16.905157092326
             les_mean =     286.119395611950
             stat err =       0.000460019783
             autocorr =       1.263168026007
              std dev =       0.578843211300
             le_variance =       0.335059463268

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335043693339
                                         uncertainty =       0.003368574532

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335043693339
                                         uncertainty =       0.003368574532

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409306210
  error estimate for blocks of size 2^( 2) =       0.000421912623
  error estimate for blocks of size 2^( 3) =       0.000434934398
  error estimate for blocks of size 2^( 4) =       0.000446251861
  error estimate for blocks of size 2^( 5) =       0.000456766022
  error estimate for blocks of size 2^( 6) =       0.000466116350
  error estimate for blocks of size 2^( 7) =       0.000470951253

      target function =                  N/A
              le_mean =     -16.905157080135
             les_mean =     286.119398883689
             stat err =       0.000460021372
             autocorr =       1.263162863810
              std dev =       0.578846393428
             le_variance =       0.335063147184

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335046994381
                                         uncertainty =       0.003368610166

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335046994381
                                         uncertainty =       0.003368610166

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409308226
  error estimate for blocks of size 2^( 2) =       0.000421914538
  error estimate for blocks of size 2^( 3) =       0.000434936185
  error estimate for blocks of size 2^( 4) =       0.000446253492
  error estimate for blocks of size 2^( 5) =       0.000456767490
  error estimate for blocks of size 2^( 6) =       0.000466117711
  error estimate for blocks of size 2^( 7) =       0.000470952468

      target function =                  N/A
              le_mean =     -16.905157068396
             les_mean =     286.119401786736
             stat err =       0.000460022790
             autocorr =       1.263158215827
              std dev =       0.578849243877
             le_variance =       0.335066447137


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905157066709        initial
     1.4901e+01     1.4901e+02             1.2675e-05       -16.905157092326  <--
     5.9605e+01     5.9605e+02             3.1732e-06       -16.905157080135
     2.3842e+02     2.3842e+03             7.9357e-07       -16.905157068396

*****************************************************************************
Applying the update for shift_i =   1.4901e+01     and shift_s =   1.4901e+02
*****************************************************************************

  Execution time = 2.9202e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.097424e-01 1 1  ON 0
 uu_1                 1.427203e-01 1 1  ON 1
 uu_2                 4.080473e-02 1 1  ON 2
 uu_3                -2.217140e-02 1 1  ON 3
 uu_4                -6.812207e-02 1 1  ON 4
 uu_5                -1.035864e-01 1 1  ON 5
 uu_6                -1.317401e-01 1 1  ON 6
 uu_7                -1.463291e-01 1 1  ON 7
 uu_8                -1.392846e-01 1 1  ON 8
 uu_9                -1.117204e-01 1 1  ON 9
 ud_0                 4.546706e-01 1 1  ON 10
 ud_1                 1.882357e-01 1 1  ON 11
 ud_2                 6.678159e-02 1 1  ON 12
 ud_3                -5.371770e-03 1 1  ON 13
 ud_4                -6.300218e-02 1 1  ON 14
 ud_5                -1.052786e-01 1 1  ON 15
 ud_6                -1.337417e-01 1 1  ON 16
 ud_7                -1.515532e-01 1 1  ON 17
 ud_8                -1.530735e-01 1 1  ON 18
 ud_9                -1.456380e-01 1 1  ON 19
 eO_0                -7.634461e-01 1 1  ON 20
 eO_1                -4.403165e-01 1 1  ON 21
 eO_2                -1.717260e-02 1 1  ON 22
 eO_3                 3.066983e-01 1 1  ON 23
 eO_4                 5.355666e-01 1 1  ON 24
 eO_5                 4.997759e-01 1 1  ON 25
 eO_6                 2.701320e-01 1 1  ON 26
 eO_7                -3.699297e-02 1 1  ON 27
 eO_8                -2.401383e-01 1 1  ON 28
 eO_9                -1.089083e-01 1 1  ON 29
eH1_0                -2.559273e-01 1 1  ON 30
eH1_1                -1.545903e-01 1 1  ON 31
eH1_2                -1.072698e-01 1 1  ON 32
eH1_3                -5.234412e-02 1 1  ON 33
eH1_4                -3.350307e-03 1 1  ON 34
eH1_5                 3.201137e-02 1 1  ON 35
eH1_6                 9.327458e-02 1 1  ON 36
eH1_7                 1.552523e-01 1 1  ON 37
eH1_8                 1.953260e-01 1 1  ON 38
eH1_9                 9.676915e-02 1 1  ON 39
eH2_0                -2.532919e-01 1 1  ON 40
eH2_1                -1.517373e-01 1 1  ON 41
eH2_2                -1.044643e-01 1 1  ON 42
eH2_3                -4.972590e-02 1 1  ON 43
eH2_4                -1.030292e-03 1 1  ON 44
eH2_5                 3.368213e-02 1 1  ON 45
eH2_6                 9.503397e-02 1 1  ON 46
eH2_7                 1.556287e-01 1 1  ON 47
eH2_8                 1.983646e-01 1 1  ON 48
eH2_9                 9.057924e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5021e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.8499
    reference variance = 0.217958
====================================================
  Execution time = 2.2723e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3476e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5179e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334861022878
                                         uncertainty =       0.002810333735

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334861022878
                                         uncertainty =       0.002810333735

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409118674
  error estimate for blocks of size 2^( 2) =       0.000421937918
  error estimate for blocks of size 2^( 3) =       0.000434478178
  error estimate for blocks of size 2^( 4) =       0.000445404603
  error estimate for blocks of size 2^( 5) =       0.000455731153
  error estimate for blocks of size 2^( 6) =       0.000462298879
  error estimate for blocks of size 2^( 7) =       0.000468866953

      target function =                  N/A
              le_mean =     -16.905925639526
             les_mean =     286.145077740316
             stat err =       0.000458075397
             autocorr =       1.253647177859
              std dev =       0.578581177105
             le_variance =       0.334756178500


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690592563953e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+00, overlap shift 3.7253e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905925639526       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905925680334       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905925799873       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905925862708       residual = 4.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905925884261       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905925914282       residual = 8.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905925948802       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905925952952       residual = 5.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+00 is 4.910734e-05

solving harmonic davidson linear method for identity shift 1.4901e+01, overlap shift 1.4901e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905925639526       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905925649966       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905925681574       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905925697978       residual = 4.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905925703402       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905925710716       residual = 7.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905925718947       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905925720153       residual = 4.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+01 is 1.230924e-05

solving harmonic davidson linear method for identity shift 5.9605e+01, overlap shift 5.9605e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905925639526       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905925642152       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905925650171       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905925654320       residual = 4.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905925655683       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905925657497       residual = 6.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905925659519       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905925659835       residual = 4.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+01 is 3.081630e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.187683 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8248e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.097460e-01 1 1  ON 0
 uu_1                 1.427201e-01 1 1  ON 1
 uu_2                 4.080005e-02 1 1  ON 2
 uu_3                -2.216566e-02 1 1  ON 3
 uu_4                -6.812199e-02 1 1  ON 4
 uu_5                -1.035898e-01 1 1  ON 5
 uu_6                -1.317354e-01 1 1  ON 6
 uu_7                -1.463312e-01 1 1  ON 7
 uu_8                -1.392927e-01 1 1  ON 8
 uu_9                -1.117235e-01 1 1  ON 9
 ud_0                 4.546800e-01 1 1  ON 10
 ud_1                 1.882364e-01 1 1  ON 11
 ud_2                 6.678604e-02 1 1  ON 12
 ud_3                -5.369775e-03 1 1  ON 13
 ud_4                -6.300543e-02 1 1  ON 14
 ud_5                -1.052760e-01 1 1  ON 15
 ud_6                -1.337439e-01 1 1  ON 16
 ud_7                -1.515570e-01 1 1  ON 17
 ud_8                -1.530786e-01 1 1  ON 18
 ud_9                -1.456375e-01 1 1  ON 19
 eO_0                -7.634382e-01 1 1  ON 20
 eO_1                -4.403101e-01 1 1  ON 21
 eO_2                -1.716746e-02 1 1  ON 22
 eO_3                 3.066928e-01 1 1  ON 23
 eO_4                 5.355659e-01 1 1  ON 24
 eO_5                 4.997792e-01 1 1  ON 25
 eO_6                 2.701360e-01 1 1  ON 26
 eO_7                -3.699696e-02 1 1  ON 27
 eO_8                -2.401464e-01 1 1  ON 28
 eO_9                -1.089160e-01 1 1  ON 29
eH1_0                -2.559347e-01 1 1  ON 30
eH1_1                -1.545993e-01 1 1  ON 31
eH1_2                -1.072737e-01 1 1  ON 32
eH1_3                -5.234823e-02 1 1  ON 33
eH1_4                -3.347064e-03 1 1  ON 34
eH1_5                 3.201198e-02 1 1  ON 35
eH1_6                 9.327357e-02 1 1  ON 36
eH1_7                 1.552519e-01 1 1  ON 37
eH1_8                 1.953318e-01 1 1  ON 38
eH1_9                 9.678146e-02 1 1  ON 39
eH2_0                -2.533022e-01 1 1  ON 40
eH2_1                -1.517403e-01 1 1  ON 41
eH2_2                -1.044609e-01 1 1  ON 42
eH2_3                -4.972231e-02 1 1  ON 43
eH2_4                -1.022727e-03 1 1  ON 44
eH2_5                 3.368762e-02 1 1  ON 45
eH2_6                 9.502445e-02 1 1  ON 46
eH2_7                 1.556245e-01 1 1  ON 47
eH2_8                 1.983628e-01 1 1  ON 48
eH2_9                 9.058779e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.8407
    reference variance = 0.223825
====================================================
  Execution time = 1.9944e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4463e-01
  Total weights = 2.0000e+06
  Execution time = 1.8652e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344620960693
                                         uncertainty =       0.006138067287

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344620960693
                                         uncertainty =       0.006138067287

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415108174
  error estimate for blocks of size 2^( 2) =       0.000428288740
  error estimate for blocks of size 2^( 3) =       0.000441401046
  error estimate for blocks of size 2^( 4) =       0.000453761646
  error estimate for blocks of size 2^( 5) =       0.000464716120
  error estimate for blocks of size 2^( 6) =       0.000471835479
  error estimate for blocks of size 2^( 7) =       0.000478159111

      target function =                  N/A
              le_mean =     -16.905925056579
             les_mean =     286.154931438728
             stat err =       0.000467118089
             autocorr =       1.266283069857
              std dev =       0.587051609626
             le_variance =       0.344629592364

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344639939091
                                         uncertainty =       0.006138019750

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344639939091
                                         uncertainty =       0.006138019750

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415119606
  error estimate for blocks of size 2^( 2) =       0.000428299761
  error estimate for blocks of size 2^( 3) =       0.000441411715
  error estimate for blocks of size 2^( 4) =       0.000453772006
  error estimate for blocks of size 2^( 5) =       0.000464727129
  error estimate for blocks of size 2^( 6) =       0.000471846112
  error estimate for blocks of size 2^( 7) =       0.000478168216

      target function =                  N/A
              le_mean =     -16.905925170845
             les_mean =     286.154954284689
             stat err =       0.000467128366
             autocorr =       1.266269039557
              std dev =       0.587067777013
             le_variance =       0.344648574806

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344631533421
                                         uncertainty =       0.006138067960

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344631533421
                                         uncertainty =       0.006138067960

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415114543
  error estimate for blocks of size 2^( 2) =       0.000428294884
  error estimate for blocks of size 2^( 3) =       0.000441407002
  error estimate for blocks of size 2^( 4) =       0.000453767423
  error estimate for blocks of size 2^( 5) =       0.000464722231
  error estimate for blocks of size 2^( 6) =       0.000471841355
  error estimate for blocks of size 2^( 7) =       0.000478164150

      target function =                  N/A
              le_mean =     -16.905925119176
             les_mean =     286.154944129800
             stat err =       0.000467123790
             autocorr =       1.266275122989
              std dev =       0.587060616077
             le_variance =       0.344640166949

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344622320049
                                         uncertainty =       0.006138068155

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344622320049
                                         uncertainty =       0.006138068155

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415108993
  error estimate for blocks of size 2^( 2) =       0.000428289530
  error estimate for blocks of size 2^( 3) =       0.000441401812
  error estimate for blocks of size 2^( 4) =       0.000453762388
  error estimate for blocks of size 2^( 5) =       0.000464716905
  error estimate for blocks of size 2^( 6) =       0.000471836233
  error estimate for blocks of size 2^( 7) =       0.000478159757

      target function =                  N/A
              le_mean =     -16.905925064440
             les_mean =     286.154933064079
             stat err =       0.000467118821
             autocorr =       1.266282042583
              std dev =       0.587052767600
             le_variance =       0.344630951947


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905925056579        initial
     3.7253e+00     3.7253e+01             4.9107e-05       -16.905925170845  <--
     1.4901e+01     1.4901e+02             1.2309e-05       -16.905925119176
     5.9605e+01     5.9605e+02             3.0816e-06       -16.905925064440

*****************************************************************************
Applying the update for shift_i =   3.7253e+00     and shift_s =   3.7253e+01
*****************************************************************************

  Execution time = 2.9357e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.097558e-01 1 1  ON 0
 uu_1                 1.427190e-01 1 1  ON 1
 uu_2                 4.078809e-02 1 1  ON 2
 uu_3                -2.215078e-02 1 1  ON 3
 uu_4                -6.812062e-02 1 1  ON 4
 uu_5                -1.035993e-01 1 1  ON 5
 uu_6                -1.317220e-01 1 1  ON 6
 uu_7                -1.463370e-01 1 1  ON 7
 uu_8                -1.393167e-01 1 1  ON 8
 uu_9                -1.117329e-01 1 1  ON 9
 ud_0                 4.547062e-01 1 1  ON 10
 ud_1                 1.882396e-01 1 1  ON 11
 ud_2                 6.679875e-02 1 1  ON 12
 ud_3                -5.363654e-03 1 1  ON 13
 ud_4                -6.301375e-02 1 1  ON 14
 ud_5                -1.052695e-01 1 1  ON 15
 ud_6                -1.337499e-01 1 1  ON 16
 ud_7                -1.515679e-01 1 1  ON 17
 ud_8                -1.530939e-01 1 1  ON 18
 ud_9                -1.456359e-01 1 1  ON 19
 eO_0                -7.634149e-01 1 1  ON 20
 eO_1                -4.402909e-01 1 1  ON 21
 eO_2                -1.715245e-02 1 1  ON 22
 eO_3                 3.066773e-01 1 1  ON 23
 eO_4                 5.355638e-01 1 1  ON 24
 eO_5                 4.997891e-01 1 1  ON 25
 eO_6                 2.701481e-01 1 1  ON 26
 eO_7                -3.700877e-02 1 1  ON 27
 eO_8                -2.401708e-01 1 1  ON 28
 eO_9                -1.089388e-01 1 1  ON 29
eH1_0                -2.559566e-01 1 1  ON 30
eH1_1                -1.546256e-01 1 1  ON 31
eH1_2                -1.072856e-01 1 1  ON 32
eH1_3                -5.236057e-02 1 1  ON 33
eH1_4                -3.337858e-03 1 1  ON 34
eH1_5                 3.201395e-02 1 1  ON 35
eH1_6                 9.327064e-02 1 1  ON 36
eH1_7                 1.552508e-01 1 1  ON 37
eH1_8                 1.953492e-01 1 1  ON 38
eH1_9                 9.681826e-02 1 1  ON 39
eH2_0                -2.533327e-01 1 1  ON 40
eH2_1                -1.517489e-01 1 1  ON 41
eH2_2                -1.044513e-01 1 1  ON 42
eH2_3                -4.971135e-02 1 1  ON 43
eH2_4                -1.000585e-03 1 1  ON 44
eH2_5                 3.370385e-02 1 1  ON 45
eH2_6                 9.499615e-02 1 1  ON 46
eH2_7                 1.556119e-01 1 1  ON 47
eH2_8                 1.983573e-01 1 1  ON 48
eH2_9                 9.061333e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7612e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.8841
    reference variance = 0.296549
====================================================
  Execution time = 2.0438e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4133e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5053e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341278378229
                                         uncertainty =       0.003600907175

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341278378229
                                         uncertainty =       0.003600907175

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413117529
  error estimate for blocks of size 2^( 2) =       0.000426035799
  error estimate for blocks of size 2^( 3) =       0.000438612827
  error estimate for blocks of size 2^( 4) =       0.000451013725
  error estimate for blocks of size 2^( 5) =       0.000461153201
  error estimate for blocks of size 2^( 6) =       0.000469013522
  error estimate for blocks of size 2^( 7) =       0.000474755785

      target function =                  N/A
              le_mean =     -16.906033528475
             les_mean =     286.155301679982
             stat err =       0.000463984058
             autocorr =       1.261417563035
              std dev =       0.584236411664
             le_variance =       0.341332184714


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690603352848e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e-01, overlap shift 9.3132e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906033528475       residual = 8.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906033172306       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906033269984       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906033328407       residual = 8.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906033621931       residual = 2.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906033756532       residual = 7.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906033739168       residual = 3.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906033697251       residual = 6.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e-01 is 1.573860e-04

solving harmonic davidson linear method for identity shift 3.7253e+00, overlap shift 3.7253e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906033528475       residual = 8.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906033428969       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906033450237       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906033443462       residual = 7.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906033491052       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906033523922       residual = 4.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906033524948       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906033511009       residual = 3.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+00 is 3.982630e-05

solving harmonic davidson linear method for identity shift 1.4901e+01, overlap shift 1.4901e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906033528475       residual = 8.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906033502846       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906033507835       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906033504461       residual = 7.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906033513620       residual = 2.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906033520920       residual = 3.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906033522083       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906033518425       residual = 2.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+01 is 9.992129e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.190330 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5951e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.097792e-01 1 1  ON 0
 uu_1                 1.427173e-01 1 1  ON 1
 uu_2                 4.077509e-02 1 1  ON 2
 uu_3                -2.213221e-02 1 1  ON 3
 uu_4                -6.811936e-02 1 1  ON 4
 uu_5                -1.035786e-01 1 1  ON 5
 uu_6                -1.317475e-01 1 1  ON 6
 uu_7                -1.463724e-01 1 1  ON 7
 uu_8                -1.393565e-01 1 1  ON 8
 uu_9                -1.117446e-01 1 1  ON 9
 ud_0                 4.547352e-01 1 1  ON 10
 ud_1                 1.882416e-01 1 1  ON 11
 ud_2                 6.681340e-02 1 1  ON 12
 ud_3                -5.359404e-03 1 1  ON 13
 ud_4                -6.299576e-02 1 1  ON 14
 ud_5                -1.052921e-01 1 1  ON 15
 ud_6                -1.337298e-01 1 1  ON 16
 ud_7                -1.515785e-01 1 1  ON 17
 ud_8                -1.531330e-01 1 1  ON 18
 ud_9                -1.456404e-01 1 1  ON 19
 eO_0                -7.634134e-01 1 1  ON 20
 eO_1                -4.402734e-01 1 1  ON 21
 eO_2                -1.713554e-02 1 1  ON 22
 eO_3                 3.067067e-01 1 1  ON 23
 eO_4                 5.355662e-01 1 1  ON 24
 eO_5                 4.997845e-01 1 1  ON 25
 eO_6                 2.701555e-01 1 1  ON 26
 eO_7                -3.702132e-02 1 1  ON 27
 eO_8                -2.401966e-01 1 1  ON 28
 eO_9                -1.089681e-01 1 1  ON 29
eH1_0                -2.559856e-01 1 1  ON 30
eH1_1                -1.546635e-01 1 1  ON 31
eH1_2                -1.072984e-01 1 1  ON 32
eH1_3                -5.237087e-02 1 1  ON 33
eH1_4                -3.348405e-03 1 1  ON 34
eH1_5                 3.204279e-02 1 1  ON 35
eH1_6                 9.329041e-02 1 1  ON 36
eH1_7                 1.552408e-01 1 1  ON 37
eH1_8                 1.953674e-01 1 1  ON 38
eH1_9                 9.685716e-02 1 1  ON 39
eH2_0                -2.533387e-01 1 1  ON 40
eH2_1                -1.517376e-01 1 1  ON 41
eH2_2                -1.044512e-01 1 1  ON 42
eH2_3                -4.973997e-02 1 1  ON 43
eH2_4                -1.018139e-03 1 1  ON 44
eH2_5                 3.369292e-02 1 1  ON 45
eH2_6                 9.500071e-02 1 1  ON 46
eH2_7                 1.556241e-01 1 1  ON 47
eH2_8                 1.983551e-01 1 1  ON 48
eH2_9                 9.064040e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.9349
    reference variance = 0.30918
====================================================
  Execution time = 1.9948e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3789e-01
  Total weights = 2.0000e+06
  Execution time = 1.8510e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337970915881
                                         uncertainty =       0.004938266773

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337970915881
                                         uncertainty =       0.004938266773

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411018646
  error estimate for blocks of size 2^( 2) =       0.000423652615
  error estimate for blocks of size 2^( 3) =       0.000436223072
  error estimate for blocks of size 2^( 4) =       0.000447968068
  error estimate for blocks of size 2^( 5) =       0.000457919712
  error estimate for blocks of size 2^( 6) =       0.000465109442
  error estimate for blocks of size 2^( 7) =       0.000472662663

      target function =                  N/A
              le_mean =     -16.906099785654
             les_mean =     286.154082447682
             stat err =       0.000460914971
             autocorr =       1.257530658825
              std dev =       0.581268143058
             le_variance =       0.337872654134

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338035374832
                                         uncertainty =       0.004938754056

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338035374832
                                         uncertainty =       0.004938754056

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411057838
  error estimate for blocks of size 2^( 2) =       0.000423690556
  error estimate for blocks of size 2^( 3) =       0.000436260269
  error estimate for blocks of size 2^( 4) =       0.000448004064
  error estimate for blocks of size 2^( 5) =       0.000457956245
  error estimate for blocks of size 2^( 6) =       0.000465147862
  error estimate for blocks of size 2^( 7) =       0.000472699323

      target function =                  N/A
              le_mean =     -16.906099151576
             les_mean =     286.154125445701
             stat err =       0.000460951873
             autocorr =       1.257492206702
              std dev =       0.581323568880
             le_variance =       0.337937091735

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338012340830
                                         uncertainty =       0.004938674499

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338012340830
                                         uncertainty =       0.004938674499

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411043834
  error estimate for blocks of size 2^( 2) =       0.000423676993
  error estimate for blocks of size 2^( 3) =       0.000436247039
  error estimate for blocks of size 2^( 4) =       0.000447991452
  error estimate for blocks of size 2^( 5) =       0.000457943524
  error estimate for blocks of size 2^( 6) =       0.000465134176
  error estimate for blocks of size 2^( 7) =       0.000472686279

      target function =                  N/A
              le_mean =     -16.906099327516
             les_mean =     286.154108369353
             stat err =       0.000460938858
             autocorr =       1.257506872977
              std dev =       0.581303764363
             le_variance =       0.337914066462

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337976485177
                                         uncertainty =       0.004938325186

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337976485177
                                         uncertainty =       0.004938325186

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411022032
  error estimate for blocks of size 2^( 2) =       0.000423655891
  error estimate for blocks of size 2^( 3) =       0.000436226294
  error estimate for blocks of size 2^( 4) =       0.000447971217
  error estimate for blocks of size 2^( 5) =       0.000457922922
  error estimate for blocks of size 2^( 6) =       0.000465112767
  error estimate for blocks of size 2^( 7) =       0.000472665839

      target function =                  N/A
              le_mean =     -16.906099719273
             les_mean =     286.154085770827
             stat err =       0.000460918186
             autocorr =       1.257527480642
              std dev =       0.581272932242
             le_variance =       0.337878221757


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906099785654        initial  <--
     9.3132e-01     9.3132e+00             1.5739e-04       -16.906099151576
     3.7253e+00     3.7253e+01             3.9826e-05       -16.906099327516
     1.4901e+01     1.4901e+02             9.9921e-06       -16.906099719273

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.2900
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.097558e-01 1 1  ON 0
 uu_1                 1.427190e-01 1 1  ON 1
 uu_2                 4.078809e-02 1 1  ON 2
 uu_3                -2.215078e-02 1 1  ON 3
 uu_4                -6.812062e-02 1 1  ON 4
 uu_5                -1.035993e-01 1 1  ON 5
 uu_6                -1.317220e-01 1 1  ON 6
 uu_7                -1.463370e-01 1 1  ON 7
 uu_8                -1.393167e-01 1 1  ON 8
 uu_9                -1.117329e-01 1 1  ON 9
 ud_0                 4.547062e-01 1 1  ON 10
 ud_1                 1.882396e-01 1 1  ON 11
 ud_2                 6.679875e-02 1 1  ON 12
 ud_3                -5.363654e-03 1 1  ON 13
 ud_4                -6.301375e-02 1 1  ON 14
 ud_5                -1.052695e-01 1 1  ON 15
 ud_6                -1.337499e-01 1 1  ON 16
 ud_7                -1.515679e-01 1 1  ON 17
 ud_8                -1.530939e-01 1 1  ON 18
 ud_9                -1.456359e-01 1 1  ON 19
 eO_0                -7.634149e-01 1 1  ON 20
 eO_1                -4.402909e-01 1 1  ON 21
 eO_2                -1.715245e-02 1 1  ON 22
 eO_3                 3.066773e-01 1 1  ON 23
 eO_4                 5.355638e-01 1 1  ON 24
 eO_5                 4.997891e-01 1 1  ON 25
 eO_6                 2.701481e-01 1 1  ON 26
 eO_7                -3.700877e-02 1 1  ON 27
 eO_8                -2.401708e-01 1 1  ON 28
 eO_9                -1.089388e-01 1 1  ON 29
eH1_0                -2.559566e-01 1 1  ON 30
eH1_1                -1.546256e-01 1 1  ON 31
eH1_2                -1.072856e-01 1 1  ON 32
eH1_3                -5.236057e-02 1 1  ON 33
eH1_4                -3.337858e-03 1 1  ON 34
eH1_5                 3.201395e-02 1 1  ON 35
eH1_6                 9.327064e-02 1 1  ON 36
eH1_7                 1.552508e-01 1 1  ON 37
eH1_8                 1.953492e-01 1 1  ON 38
eH1_9                 9.681826e-02 1 1  ON 39
eH2_0                -2.533327e-01 1 1  ON 40
eH2_1                -1.517489e-01 1 1  ON 41
eH2_2                -1.044513e-01 1 1  ON 42
eH2_3                -4.971135e-02 1 1  ON 43
eH2_4                -1.000585e-03 1 1  ON 44
eH2_5                 3.370385e-02 1 1  ON 45
eH2_6                 9.499615e-02 1 1  ON 46
eH2_7                 1.556119e-01 1 1  ON 47
eH2_8                 1.983573e-01 1 1  ON 48
eH2_9                 9.061333e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5248e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.9613
    reference variance = 0.204236
====================================================
  Execution time = 2.0218e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4215e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4567e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342272189355
                                         uncertainty =       0.005894958086

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342272189355
                                         uncertainty =       0.005894958086

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413610629
  error estimate for blocks of size 2^( 2) =       0.000426193182
  error estimate for blocks of size 2^( 3) =       0.000438817518
  error estimate for blocks of size 2^( 4) =       0.000450434045
  error estimate for blocks of size 2^( 5) =       0.000460970729
  error estimate for blocks of size 2^( 6) =       0.000470220662
  error estimate for blocks of size 2^( 7) =       0.000474705828

      target function =                  N/A
              le_mean =     -16.906543364514
             les_mean =     286.173355870629
             stat err =       0.000464082816
             autocorr =       1.258947422265
              std dev =       0.584933761637
             le_variance =       0.342147505503


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690654336451e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+00, overlap shift 9.3132e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906543364514       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906543324798       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906543320485       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906543314402       residual = 2.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906543303456       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906543298915       residual = 5.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906543303747       residual = 9.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+00 is 2.100862e-05

solving harmonic davidson linear method for identity shift 3.7253e+01, overlap shift 3.7253e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906543364514       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906543354405       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906543353278       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906543351729       residual = 2.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906543349041       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906543347572       residual = 4.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906543348574       residual = 8.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+01 is 5.364345e-06

solving harmonic davidson linear method for identity shift 1.4901e+02, overlap shift 1.4901e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906543364514       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906543361975       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906543361690       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906543361302       residual = 2.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906543360633       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906543360244       residual = 4.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906543360480       residual = 8.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+02 is 1.348340e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.192600 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5682e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.097561e-01 1 1  ON 0
 uu_1                 1.427168e-01 1 1  ON 1
 uu_2                 4.078893e-02 1 1  ON 2
 uu_3                -2.214948e-02 1 1  ON 3
 uu_4                -6.812055e-02 1 1  ON 4
 uu_5                -1.036005e-01 1 1  ON 5
 uu_6                -1.317268e-01 1 1  ON 6
 uu_7                -1.463372e-01 1 1  ON 7
 uu_8                -1.393163e-01 1 1  ON 8
 uu_9                -1.117329e-01 1 1  ON 9
 ud_0                 4.547009e-01 1 1  ON 10
 ud_1                 1.882392e-01 1 1  ON 11
 ud_2                 6.679880e-02 1 1  ON 12
 ud_3                -5.362712e-03 1 1  ON 13
 ud_4                -6.301407e-02 1 1  ON 14
 ud_5                -1.052698e-01 1 1  ON 15
 ud_6                -1.337489e-01 1 1  ON 16
 ud_7                -1.515664e-01 1 1  ON 17
 ud_8                -1.530943e-01 1 1  ON 18
 ud_9                -1.456348e-01 1 1  ON 19
 eO_0                -7.634143e-01 1 1  ON 20
 eO_1                -4.402870e-01 1 1  ON 21
 eO_2                -1.715535e-02 1 1  ON 22
 eO_3                 3.066773e-01 1 1  ON 23
 eO_4                 5.355640e-01 1 1  ON 24
 eO_5                 4.997891e-01 1 1  ON 25
 eO_6                 2.701508e-01 1 1  ON 26
 eO_7                -3.700829e-02 1 1  ON 27
 eO_8                -2.401725e-01 1 1  ON 28
 eO_9                -1.089416e-01 1 1  ON 29
eH1_0                -2.559597e-01 1 1  ON 30
eH1_1                -1.546299e-01 1 1  ON 31
eH1_2                -1.072849e-01 1 1  ON 32
eH1_3                -5.236156e-02 1 1  ON 33
eH1_4                -3.339307e-03 1 1  ON 34
eH1_5                 3.201416e-02 1 1  ON 35
eH1_6                 9.327168e-02 1 1  ON 36
eH1_7                 1.552514e-01 1 1  ON 37
eH1_8                 1.953510e-01 1 1  ON 38
eH1_9                 9.682277e-02 1 1  ON 39
eH2_0                -2.533349e-01 1 1  ON 40
eH2_1                -1.517515e-01 1 1  ON 41
eH2_2                -1.044524e-01 1 1  ON 42
eH2_3                -4.971343e-02 1 1  ON 43
eH2_4                -1.000569e-03 1 1  ON 44
eH2_5                 3.370372e-02 1 1  ON 45
eH2_6                 9.499362e-02 1 1  ON 46
eH2_7                 1.556147e-01 1 1  ON 47
eH2_8                 1.983591e-01 1 1  ON 48
eH2_9                 9.061833e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.9098
    reference variance = 0.241783
====================================================
  Execution time = 1.9713e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3972e-01
  Total weights = 2.0000e+06
  Execution time = 1.8511e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339751174392
                                         uncertainty =       0.004845435371

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339751174392
                                         uncertainty =       0.004845435371

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412143391
  error estimate for blocks of size 2^( 2) =       0.000424994034
  error estimate for blocks of size 2^( 3) =       0.000438314151
  error estimate for blocks of size 2^( 4) =       0.000451586616
  error estimate for blocks of size 2^( 5) =       0.000463211181
  error estimate for blocks of size 2^( 6) =       0.000471689725
  error estimate for blocks of size 2^( 7) =       0.000479208411

      target function =                  N/A
              le_mean =     -16.905211309755
             les_mean =     286.125893607245
             stat err =       0.000466423983
             autocorr =       1.280752069466
              std dev =       0.582858773314
             le_variance =       0.339724349629

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339728949385
                                         uncertainty =       0.004845059904

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339728949385
                                         uncertainty =       0.004845059904

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412129912
  error estimate for blocks of size 2^( 2) =       0.000424981283
  error estimate for blocks of size 2^( 3) =       0.000438302294
  error estimate for blocks of size 2^( 4) =       0.000451575290
  error estimate for blocks of size 2^( 5) =       0.000463200185
  error estimate for blocks of size 2^( 6) =       0.000471678847
  error estimate for blocks of size 2^( 7) =       0.000479197222

      target function =                  N/A
              le_mean =     -16.905211315254
             les_mean =     286.125871571720
             stat err =       0.000466412886
             autocorr =       1.280774903475
              std dev =       0.582839710533
             le_variance =       0.339702128175

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339739764309
                                         uncertainty =       0.004845244638

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339739764309
                                         uncertainty =       0.004845244638

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412136471
  error estimate for blocks of size 2^( 2) =       0.000424987487
  error estimate for blocks of size 2^( 3) =       0.000438308062
  error estimate for blocks of size 2^( 4) =       0.000451580799
  error estimate for blocks of size 2^( 5) =       0.000463205534
  error estimate for blocks of size 2^( 6) =       0.000471684137
  error estimate for blocks of size 2^( 7) =       0.000479202664

      target function =                  N/A
              le_mean =     -16.905211312484
             les_mean =     286.125882291310
             stat err =       0.000466418283
             autocorr =       1.280763777771
              std dev =       0.582848986806
             le_variance =       0.339712941421

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339749738274
                                         uncertainty =       0.004845411434

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339749738274
                                         uncertainty =       0.004845411434

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412142520
  error estimate for blocks of size 2^( 2) =       0.000424993210
  error estimate for blocks of size 2^( 3) =       0.000438313385
  error estimate for blocks of size 2^( 4) =       0.000451585883
  error estimate for blocks of size 2^( 5) =       0.000463210470
  error estimate for blocks of size 2^( 6) =       0.000471689022
  error estimate for blocks of size 2^( 7) =       0.000479207687

      target function =                  N/A
              le_mean =     -16.905211310072
             les_mean =     286.125892182062
             stat err =       0.000466423266
             autocorr =       1.280753542466
              std dev =       0.582857541556
             le_variance =       0.339722913749


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905211309755        initial
     9.3132e+00     9.3132e+01             2.1009e-05       -16.905211315254  <--
     3.7253e+01     3.7253e+02             5.3643e-06       -16.905211312484
     1.4901e+02     1.4901e+03             1.3483e-06       -16.905211310072

*****************************************************************************
Applying the update for shift_i =   9.3132e+00     and shift_s =   9.3132e+01
*****************************************************************************

  Execution time = 2.9040e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.097569e-01 1 1  ON 0
 uu_1                 1.427107e-01 1 1  ON 1
 uu_2                 4.079130e-02 1 1  ON 2
 uu_3                -2.214562e-02 1 1  ON 3
 uu_4                -6.812037e-02 1 1  ON 4
 uu_5                -1.036043e-01 1 1  ON 5
 uu_6                -1.317413e-01 1 1  ON 6
 uu_7                -1.463379e-01 1 1  ON 7
 uu_8                -1.393151e-01 1 1  ON 8
 uu_9                -1.117332e-01 1 1  ON 9
 ud_0                 4.546852e-01 1 1  ON 10
 ud_1                 1.882380e-01 1 1  ON 11
 ud_2                 6.679885e-02 1 1  ON 12
 ud_3                -5.359979e-03 1 1  ON 13
 ud_4                -6.301503e-02 1 1  ON 14
 ud_5                -1.052705e-01 1 1  ON 15
 ud_6                -1.337460e-01 1 1  ON 16
 ud_7                -1.515621e-01 1 1  ON 17
 ud_8                -1.530954e-01 1 1  ON 18
 ud_9                -1.456317e-01 1 1  ON 19
 eO_0                -7.634122e-01 1 1  ON 20
 eO_1                -4.402755e-01 1 1  ON 21
 eO_2                -1.716375e-02 1 1  ON 22
 eO_3                 3.066773e-01 1 1  ON 23
 eO_4                 5.355646e-01 1 1  ON 24
 eO_5                 4.997891e-01 1 1  ON 25
 eO_6                 2.701587e-01 1 1  ON 26
 eO_7                -3.700685e-02 1 1  ON 27
 eO_8                -2.401776e-01 1 1  ON 28
 eO_9                -1.089500e-01 1 1  ON 29
eH1_0                -2.559691e-01 1 1  ON 30
eH1_1                -1.546426e-01 1 1  ON 31
eH1_2                -1.072830e-01 1 1  ON 32
eH1_3                -5.236450e-02 1 1  ON 33
eH1_4                -3.343570e-03 1 1  ON 34
eH1_5                 3.201474e-02 1 1  ON 35
eH1_6                 9.327478e-02 1 1  ON 36
eH1_7                 1.552532e-01 1 1  ON 37
eH1_8                 1.953564e-01 1 1  ON 38
eH1_9                 9.683623e-02 1 1  ON 39
eH2_0                -2.533415e-01 1 1  ON 40
eH2_1                -1.517592e-01 1 1  ON 41
eH2_2                -1.044557e-01 1 1  ON 42
eH2_3                -4.971958e-02 1 1  ON 43
eH2_4                -1.000540e-03 1 1  ON 44
eH2_5                 3.370331e-02 1 1  ON 45
eH2_6                 9.498607e-02 1 1  ON 46
eH2_7                 1.556230e-01 1 1  ON 47
eH2_8                 1.983645e-01 1 1  ON 48
eH2_9                 9.063326e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4729e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.9075
    reference variance = 0.554411
====================================================
  Execution time = 2.0434e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4044e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4777e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340172398296
                                         uncertainty =       0.003837723583

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340172398296
                                         uncertainty =       0.003837723583

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412577635
  error estimate for blocks of size 2^( 2) =       0.000425427831
  error estimate for blocks of size 2^( 3) =       0.000438059688
  error estimate for blocks of size 2^( 4) =       0.000450926748
  error estimate for blocks of size 2^( 5) =       0.000461090752
  error estimate for blocks of size 2^( 6) =       0.000469394939
  error estimate for blocks of size 2^( 7) =       0.000474649368

      target function =                  N/A
              le_mean =     -16.905382857558
             les_mean =     286.132409999494
             stat err =       0.000464015451
             autocorr =       1.264892221314
              std dev =       0.583472886350
             le_variance =       0.340440609106


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690538285756e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+00, overlap shift 2.3283e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905382857558       residual = 8.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905383142432       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905383258664       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905383313147       residual = 4.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905383289761       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905383305027       residual = 6.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905383370754       residual = 1.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905383391680       residual = 4.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+00 is 9.573172e-05

solving harmonic davidson linear method for identity shift 9.3132e+00, overlap shift 9.3132e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905382857558       residual = 8.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905382931760       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905382962863       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905382980497       residual = 4.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905382970894       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905382984066       residual = 6.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905382992549       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905383000163       residual = 3.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+00 is 2.413156e-05

solving harmonic davidson linear method for identity shift 3.7253e+01, overlap shift 3.7253e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905382857558       residual = 8.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905382876305       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905382884209       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905382888929       residual = 4.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905382886400       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905382889590       residual = 5.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905382892020       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905382893885       residual = 2.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+01 is 6.046016e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.195289 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5919e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.097468e-01 1 1  ON 0
 uu_1                 1.427153e-01 1 1  ON 1
 uu_2                 4.078687e-02 1 1  ON 2
 uu_3                -2.214072e-02 1 1  ON 3
 uu_4                -6.812583e-02 1 1  ON 4
 uu_5                -1.036194e-01 1 1  ON 5
 uu_6                -1.317474e-01 1 1  ON 6
 uu_7                -1.463498e-01 1 1  ON 7
 uu_8                -1.393132e-01 1 1  ON 8
 uu_9                -1.117228e-01 1 1  ON 9
 ud_0                 4.546801e-01 1 1  ON 10
 ud_1                 1.882389e-01 1 1  ON 11
 ud_2                 6.679492e-02 1 1  ON 12
 ud_3                -5.349680e-03 1 1  ON 13
 ud_4                -6.302503e-02 1 1  ON 14
 ud_5                -1.052784e-01 1 1  ON 15
 ud_6                -1.337425e-01 1 1  ON 16
 ud_7                -1.515698e-01 1 1  ON 17
 ud_8                -1.530846e-01 1 1  ON 18
 ud_9                -1.456214e-01 1 1  ON 19
 eO_0                -7.634078e-01 1 1  ON 20
 eO_1                -4.402736e-01 1 1  ON 21
 eO_2                -1.716701e-02 1 1  ON 22
 eO_3                 3.066827e-01 1 1  ON 23
 eO_4                 5.355702e-01 1 1  ON 24
 eO_5                 4.997904e-01 1 1  ON 25
 eO_6                 2.701599e-01 1 1  ON 26
 eO_7                -3.701037e-02 1 1  ON 27
 eO_8                -2.401788e-01 1 1  ON 28
 eO_9                -1.089600e-01 1 1  ON 29
eH1_0                -2.559750e-01 1 1  ON 30
eH1_1                -1.546410e-01 1 1  ON 31
eH1_2                -1.072942e-01 1 1  ON 32
eH1_3                -5.237114e-02 1 1  ON 33
eH1_4                -3.352892e-03 1 1  ON 34
eH1_5                 3.199739e-02 1 1  ON 35
eH1_6                 9.327706e-02 1 1  ON 36
eH1_7                 1.552589e-01 1 1  ON 37
eH1_8                 1.953685e-01 1 1  ON 38
eH1_9                 9.686036e-02 1 1  ON 39
eH2_0                -2.533399e-01 1 1  ON 40
eH2_1                -1.517673e-01 1 1  ON 41
eH2_2                -1.044677e-01 1 1  ON 42
eH2_3                -4.972091e-02 1 1  ON 43
eH2_4                -1.009562e-03 1 1  ON 44
eH2_5                 3.369028e-02 1 1  ON 45
eH2_6                 9.499019e-02 1 1  ON 46
eH2_7                 1.556307e-01 1 1  ON 47
eH2_8                 1.983701e-01 1 1  ON 48
eH2_9                 9.065385e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.8891
    reference variance = 0.264816
====================================================
  Execution time = 1.9997e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3930e-01
  Total weights = 2.0000e+06
  Execution time = 1.8572e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339356934064
                                         uncertainty =       0.003176909841

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339356934064
                                         uncertainty =       0.003176909841

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411888349
  error estimate for blocks of size 2^( 2) =       0.000424703068
  error estimate for blocks of size 2^( 3) =       0.000437652674
  error estimate for blocks of size 2^( 4) =       0.000449663719
  error estimate for blocks of size 2^( 5) =       0.000460033076
  error estimate for blocks of size 2^( 6) =       0.000466422209
  error estimate for blocks of size 2^( 7) =       0.000473669029

      target function =                  N/A
              le_mean =     -16.906735071388
             les_mean =     286.176994628148
             stat err =       0.000462447008
             autocorr =       1.260564099440
              std dev =       0.582498089018
             le_variance =       0.339304023709

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339353463292
                                         uncertainty =       0.003176845440

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339353463292
                                         uncertainty =       0.003176845440

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411886245
  error estimate for blocks of size 2^( 2) =       0.000424701310
  error estimate for blocks of size 2^( 3) =       0.000437650856
  error estimate for blocks of size 2^( 4) =       0.000449662188
  error estimate for blocks of size 2^( 5) =       0.000460031879
  error estimate for blocks of size 2^( 6) =       0.000466420798
  error estimate for blocks of size 2^( 7) =       0.000473669562

      target function =                  N/A
              le_mean =     -16.906734773865
             les_mean =     286.176981101430
             stat err =       0.000462446107
             autocorr =       1.260572063380
              std dev =       0.582495113513
             le_variance =       0.339300557266

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339355966282
                                         uncertainty =       0.003176891679

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339355966282
                                         uncertainty =       0.003176891679

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411887762
  error estimate for blocks of size 2^( 2) =       0.000424702611
  error estimate for blocks of size 2^( 3) =       0.000437652131
  error estimate for blocks of size 2^( 4) =       0.000449663313
  error estimate for blocks of size 2^( 5) =       0.000460032841
  error estimate for blocks of size 2^( 6) =       0.000466421823
  error estimate for blocks of size 2^( 7) =       0.000473669804

      target function =                  N/A
              le_mean =     -16.906734892287
             les_mean =     286.176987605448
             stat err =       0.000462446945
             autocorr =       1.260567344865
              std dev =       0.582497259246
             le_variance =       0.339303057029

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339356848776
                                         uncertainty =       0.003176908299

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339356848776
                                         uncertainty =       0.003176908299

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411888297
  error estimate for blocks of size 2^( 2) =       0.000424703030
  error estimate for blocks of size 2^( 3) =       0.000437652623
  error estimate for blocks of size 2^( 4) =       0.000449663685
  error estimate for blocks of size 2^( 5) =       0.000460033063
  error estimate for blocks of size 2^( 6) =       0.000466422175
  error estimate for blocks of size 2^( 7) =       0.000473669148

      target function =                  N/A
              le_mean =     -16.906735047259
             les_mean =     286.176993727066
             stat err =       0.000462447018
             autocorr =       1.260564467300
              std dev =       0.582498015888
             le_variance =       0.339303938514


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906735071388        initial  <--
     2.3283e+00     2.3283e+01             9.5732e-05       -16.906734773865
     9.3132e+00     9.3132e+01             2.4132e-05       -16.906734892287
     3.7253e+01     3.7253e+02             6.0460e-06       -16.906735047259

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.3700
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.097569e-01 1 1  ON 0
 uu_1                 1.427107e-01 1 1  ON 1
 uu_2                 4.079130e-02 1 1  ON 2
 uu_3                -2.214562e-02 1 1  ON 3
 uu_4                -6.812037e-02 1 1  ON 4
 uu_5                -1.036043e-01 1 1  ON 5
 uu_6                -1.317413e-01 1 1  ON 6
 uu_7                -1.463379e-01 1 1  ON 7
 uu_8                -1.393151e-01 1 1  ON 8
 uu_9                -1.117332e-01 1 1  ON 9
 ud_0                 4.546852e-01 1 1  ON 10
 ud_1                 1.882380e-01 1 1  ON 11
 ud_2                 6.679885e-02 1 1  ON 12
 ud_3                -5.359979e-03 1 1  ON 13
 ud_4                -6.301503e-02 1 1  ON 14
 ud_5                -1.052705e-01 1 1  ON 15
 ud_6                -1.337460e-01 1 1  ON 16
 ud_7                -1.515621e-01 1 1  ON 17
 ud_8                -1.530954e-01 1 1  ON 18
 ud_9                -1.456317e-01 1 1  ON 19
 eO_0                -7.634122e-01 1 1  ON 20
 eO_1                -4.402755e-01 1 1  ON 21
 eO_2                -1.716375e-02 1 1  ON 22
 eO_3                 3.066773e-01 1 1  ON 23
 eO_4                 5.355646e-01 1 1  ON 24
 eO_5                 4.997891e-01 1 1  ON 25
 eO_6                 2.701587e-01 1 1  ON 26
 eO_7                -3.700685e-02 1 1  ON 27
 eO_8                -2.401776e-01 1 1  ON 28
 eO_9                -1.089500e-01 1 1  ON 29
eH1_0                -2.559691e-01 1 1  ON 30
eH1_1                -1.546426e-01 1 1  ON 31
eH1_2                -1.072830e-01 1 1  ON 32
eH1_3                -5.236450e-02 1 1  ON 33
eH1_4                -3.343570e-03 1 1  ON 34
eH1_5                 3.201474e-02 1 1  ON 35
eH1_6                 9.327478e-02 1 1  ON 36
eH1_7                 1.552532e-01 1 1  ON 37
eH1_8                 1.953564e-01 1 1  ON 38
eH1_9                 9.683623e-02 1 1  ON 39
eH2_0                -2.533415e-01 1 1  ON 40
eH2_1                -1.517592e-01 1 1  ON 41
eH2_2                -1.044557e-01 1 1  ON 42
eH2_3                -4.971958e-02 1 1  ON 43
eH2_4                -1.000540e-03 1 1  ON 44
eH2_5                 3.370331e-02 1 1  ON 45
eH2_6                 9.498607e-02 1 1  ON 46
eH2_7                 1.556230e-01 1 1  ON 47
eH2_8                 1.983645e-01 1 1  ON 48
eH2_9                 9.063326e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5313e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.9229
    reference variance = 0.316291
====================================================
  Execution time = 2.0294e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4125e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5740e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341285442188
                                         uncertainty =       0.003227093865

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341285442188
                                         uncertainty =       0.003227093865

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413065624
  error estimate for blocks of size 2^( 2) =       0.000426318541
  error estimate for blocks of size 2^( 3) =       0.000439752506
  error estimate for blocks of size 2^( 4) =       0.000451561124
  error estimate for blocks of size 2^( 5) =       0.000462430034
  error estimate for blocks of size 2^( 6) =       0.000471223277
  error estimate for blocks of size 2^( 7) =       0.000477752036

      target function =                  N/A
              le_mean =     -16.906593621814
             les_mean =     286.174154142781
             stat err =       0.000465741618
             autocorr =       1.271311530133
              std dev =       0.584163008281
             le_variance =       0.341246420243


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690659362181e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+01, overlap shift 2.3283e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906593621814       residual = 3.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906593605136       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906593585367       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906593575401       residual = 3.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906593588913       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906593602023       residual = 6.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906593598553       residual = 7.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+01 is 7.698525e-06

solving harmonic davidson linear method for identity shift 9.3132e+01, overlap shift 9.3132e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906593621814       residual = 3.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906593617612       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906593612607       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906593610049       residual = 3.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906593613384       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906593616726       residual = 6.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906593615910       residual = 7.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+01 is 1.932889e-06

solving harmonic davidson linear method for identity shift 3.7253e+02, overlap shift 3.7253e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906593621814       residual = 3.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906593620761       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906593619506       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906593618862       residual = 3.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906593619693       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906593620532       residual = 6.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906593620332       residual = 7.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+02 is 4.837407e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.197570 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5874e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.097568e-01 1 1  ON 0
 uu_1                 1.427107e-01 1 1  ON 1
 uu_2                 4.079072e-02 1 1  ON 2
 uu_3                -2.214504e-02 1 1  ON 3
 uu_4                -6.812168e-02 1 1  ON 4
 uu_5                -1.036052e-01 1 1  ON 5
 uu_6                -1.317411e-01 1 1  ON 6
 uu_7                -1.463373e-01 1 1  ON 7
 uu_8                -1.393149e-01 1 1  ON 8
 uu_9                -1.117330e-01 1 1  ON 9
 ud_0                 4.546850e-01 1 1  ON 10
 ud_1                 1.882373e-01 1 1  ON 11
 ud_2                 6.680002e-02 1 1  ON 12
 ud_3                -5.359540e-03 1 1  ON 13
 ud_4                -6.301430e-02 1 1  ON 14
 ud_5                -1.052702e-01 1 1  ON 15
 ud_6                -1.337466e-01 1 1  ON 16
 ud_7                -1.515633e-01 1 1  ON 17
 ud_8                -1.530944e-01 1 1  ON 18
 ud_9                -1.456312e-01 1 1  ON 19
 eO_0                -7.634112e-01 1 1  ON 20
 eO_1                -4.402749e-01 1 1  ON 21
 eO_2                -1.716448e-02 1 1  ON 22
 eO_3                 3.066772e-01 1 1  ON 23
 eO_4                 5.355646e-01 1 1  ON 24
 eO_5                 4.997897e-01 1 1  ON 25
 eO_6                 2.701590e-01 1 1  ON 26
 eO_7                -3.700675e-02 1 1  ON 27
 eO_8                -2.401779e-01 1 1  ON 28
 eO_9                -1.089513e-01 1 1  ON 29
eH1_0                -2.559696e-01 1 1  ON 30
eH1_1                -1.546433e-01 1 1  ON 31
eH1_2                -1.072844e-01 1 1  ON 32
eH1_3                -5.236461e-02 1 1  ON 33
eH1_4                -3.344495e-03 1 1  ON 34
eH1_5                 3.201436e-02 1 1  ON 35
eH1_6                 9.327547e-02 1 1  ON 36
eH1_7                 1.552535e-01 1 1  ON 37
eH1_8                 1.953571e-01 1 1  ON 38
eH1_9                 9.683803e-02 1 1  ON 39
eH2_0                -2.533416e-01 1 1  ON 40
eH2_1                -1.517612e-01 1 1  ON 41
eH2_2                -1.044564e-01 1 1  ON 42
eH2_3                -4.971987e-02 1 1  ON 43
eH2_4                -1.001020e-03 1 1  ON 44
eH2_5                 3.370336e-02 1 1  ON 45
eH2_6                 9.498531e-02 1 1  ON 46
eH2_7                 1.556238e-01 1 1  ON 47
eH2_8                 1.983658e-01 1 1  ON 48
eH2_9                 9.063505e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.924
    reference variance = 0.243765
====================================================
  Execution time = 2.0188e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4204e-01
  Total weights = 2.0000e+06
  Execution time = 1.8616e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342041228462
                                         uncertainty =       0.005139154792

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342041228462
                                         uncertainty =       0.005139154792

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413548508
  error estimate for blocks of size 2^( 2) =       0.000426450222
  error estimate for blocks of size 2^( 3) =       0.000438969702
  error estimate for blocks of size 2^( 4) =       0.000451637214
  error estimate for blocks of size 2^( 5) =       0.000462563212
  error estimate for blocks of size 2^( 6) =       0.000469723400
  error estimate for blocks of size 2^( 7) =       0.000474642588

      target function =                  N/A
              le_mean =     -16.906316475420
             les_mean =     286.165581332347
             stat err =       0.000464641603
             autocorr =       1.262360134342
              std dev =       0.584845908180
             le_variance =       0.342044736315

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342038708515
                                         uncertainty =       0.005139137395

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342038708515
                                         uncertainty =       0.005139137395

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413546984
  error estimate for blocks of size 2^( 2) =       0.000426448836
  error estimate for blocks of size 2^( 3) =       0.000438968434
  error estimate for blocks of size 2^( 4) =       0.000451636087
  error estimate for blocks of size 2^( 5) =       0.000462562062
  error estimate for blocks of size 2^( 6) =       0.000469722351
  error estimate for blocks of size 2^( 7) =       0.000474641228

      target function =                  N/A
              le_mean =     -16.906316449451
             les_mean =     286.165577933584
             stat err =       0.000464640432
             autocorr =       1.262363071805
              std dev =       0.584843753162
             le_variance =       0.342042215612

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342039968667
                                         uncertainty =       0.005139145866

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342039968667
                                         uncertainty =       0.005139145866

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413547746
  error estimate for blocks of size 2^( 2) =       0.000426449530
  error estimate for blocks of size 2^( 3) =       0.000438969069
  error estimate for blocks of size 2^( 4) =       0.000451636652
  error estimate for blocks of size 2^( 5) =       0.000462562638
  error estimate for blocks of size 2^( 6) =       0.000469722877
  error estimate for blocks of size 2^( 7) =       0.000474641907

      target function =                  N/A
              le_mean =     -16.906316462189
             les_mean =     286.165579624801
             stat err =       0.000464641018
             autocorr =       1.262361605856
              std dev =       0.584844830817
             le_variance =       0.342043476133

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342041070957
                                         uncertainty =       0.005139153669

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342041070957
                                         uncertainty =       0.005139153669

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413548412
  error estimate for blocks of size 2^( 2) =       0.000426450135
  error estimate for blocks of size 2^( 3) =       0.000438969623
  error estimate for blocks of size 2^( 4) =       0.000451637144
  error estimate for blocks of size 2^( 5) =       0.000462563140
  error estimate for blocks of size 2^( 6) =       0.000469723335
  error estimate for blocks of size 2^( 7) =       0.000474642503

      target function =                  N/A
              le_mean =     -16.906316473754
             les_mean =     286.165581118456
             stat err =       0.000464641530
             autocorr =       1.262360318375
              std dev =       0.584845773484
             le_variance =       0.342044578762


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906316475420        initial  <--
     2.3283e+01     2.3283e+02             7.6985e-06       -16.906316449451
     9.3132e+01     9.3132e+02             1.9329e-06       -16.906316462189
     3.7253e+02     3.7253e+03             4.8374e-07       -16.906316473754

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5374
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.097569e-01 1 1  ON 0
 uu_1                 1.427107e-01 1 1  ON 1
 uu_2                 4.079130e-02 1 1  ON 2
 uu_3                -2.214562e-02 1 1  ON 3
 uu_4                -6.812037e-02 1 1  ON 4
 uu_5                -1.036043e-01 1 1  ON 5
 uu_6                -1.317413e-01 1 1  ON 6
 uu_7                -1.463379e-01 1 1  ON 7
 uu_8                -1.393151e-01 1 1  ON 8
 uu_9                -1.117332e-01 1 1  ON 9
 ud_0                 4.546852e-01 1 1  ON 10
 ud_1                 1.882380e-01 1 1  ON 11
 ud_2                 6.679885e-02 1 1  ON 12
 ud_3                -5.359979e-03 1 1  ON 13
 ud_4                -6.301503e-02 1 1  ON 14
 ud_5                -1.052705e-01 1 1  ON 15
 ud_6                -1.337460e-01 1 1  ON 16
 ud_7                -1.515621e-01 1 1  ON 17
 ud_8                -1.530954e-01 1 1  ON 18
 ud_9                -1.456317e-01 1 1  ON 19
 eO_0                -7.634122e-01 1 1  ON 20
 eO_1                -4.402755e-01 1 1  ON 21
 eO_2                -1.716375e-02 1 1  ON 22
 eO_3                 3.066773e-01 1 1  ON 23
 eO_4                 5.355646e-01 1 1  ON 24
 eO_5                 4.997891e-01 1 1  ON 25
 eO_6                 2.701587e-01 1 1  ON 26
 eO_7                -3.700685e-02 1 1  ON 27
 eO_8                -2.401776e-01 1 1  ON 28
 eO_9                -1.089500e-01 1 1  ON 29
eH1_0                -2.559691e-01 1 1  ON 30
eH1_1                -1.546426e-01 1 1  ON 31
eH1_2                -1.072830e-01 1 1  ON 32
eH1_3                -5.236450e-02 1 1  ON 33
eH1_4                -3.343570e-03 1 1  ON 34
eH1_5                 3.201474e-02 1 1  ON 35
eH1_6                 9.327478e-02 1 1  ON 36
eH1_7                 1.552532e-01 1 1  ON 37
eH1_8                 1.953564e-01 1 1  ON 38
eH1_9                 9.683623e-02 1 1  ON 39
eH2_0                -2.533415e-01 1 1  ON 40
eH2_1                -1.517592e-01 1 1  ON 41
eH2_2                -1.044557e-01 1 1  ON 42
eH2_3                -4.971958e-02 1 1  ON 43
eH2_4                -1.000540e-03 1 1  ON 44
eH2_5                 3.370331e-02 1 1  ON 45
eH2_6                 9.498607e-02 1 1  ON 46
eH2_7                 1.556230e-01 1 1  ON 47
eH2_8                 1.983645e-01 1 1  ON 48
eH2_9                 9.063326e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5419e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.9565
    reference variance = 0.307929
====================================================
  Execution time = 2.0226e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3925e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5278e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339330878334
                                         uncertainty =       0.003126029100

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339330878334
                                         uncertainty =       0.003126029100

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411855190
  error estimate for blocks of size 2^( 2) =       0.000424667674
  error estimate for blocks of size 2^( 3) =       0.000437193876
  error estimate for blocks of size 2^( 4) =       0.000448915542
  error estimate for blocks of size 2^( 5) =       0.000459427062
  error estimate for blocks of size 2^( 6) =       0.000466986596
  error estimate for blocks of size 2^( 7) =       0.000469642894

      target function =                  N/A
              le_mean =     -16.906807803527
             les_mean =     286.179399330553
             stat err =       0.000461243024
             autocorr =       1.254210796542
              std dev =       0.582451195191
             le_variance =       0.339249394779


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690680780353e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+02, overlap shift 2.3283e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906807803527       residual = 9.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906807800909       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906807800807       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906807801114       residual = 5.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906807797821       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906807798430       residual = 6.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906807798323       residual = 1.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906807798474       residual = 4.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+02 is 8.987716e-07

solving harmonic davidson linear method for identity shift 9.3132e+02, overlap shift 9.3132e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906807803527       residual = 9.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906807802872       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906807802846       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906807802922       residual = 5.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906807802098       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906807802251       residual = 6.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906807802224       residual = 1.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906807802261       residual = 4.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+02 is 2.247197e-07

solving harmonic davidson linear method for identity shift 3.7253e+03, overlap shift 3.7253e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906807803527       residual = 9.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906807803363       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906807803357       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906807803376       residual = 5.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906807803173       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906807803207       residual = 6.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906807803200       residual = 1.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906807803217       residual = 4.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+03 is 5.618160e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.200258 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5761e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.097568e-01 1 1  ON 0
 uu_1                 1.427106e-01 1 1  ON 1
 uu_2                 4.079123e-02 1 1  ON 2
 uu_3                -2.214558e-02 1 1  ON 3
 uu_4                -6.812030e-02 1 1  ON 4
 uu_5                -1.036043e-01 1 1  ON 5
 uu_6                -1.317415e-01 1 1  ON 6
 uu_7                -1.463379e-01 1 1  ON 7
 uu_8                -1.393150e-01 1 1  ON 8
 uu_9                -1.117331e-01 1 1  ON 9
 ud_0                 4.546850e-01 1 1  ON 10
 ud_1                 1.882381e-01 1 1  ON 11
 ud_2                 6.679891e-02 1 1  ON 12
 ud_3                -5.359941e-03 1 1  ON 13
 ud_4                -6.301503e-02 1 1  ON 14
 ud_5                -1.052705e-01 1 1  ON 15
 ud_6                -1.337462e-01 1 1  ON 16
 ud_7                -1.515620e-01 1 1  ON 17
 ud_8                -1.530953e-01 1 1  ON 18
 ud_9                -1.456316e-01 1 1  ON 19
 eO_0                -7.634122e-01 1 1  ON 20
 eO_1                -4.402753e-01 1 1  ON 21
 eO_2                -1.716374e-02 1 1  ON 22
 eO_3                 3.066773e-01 1 1  ON 23
 eO_4                 5.355646e-01 1 1  ON 24
 eO_5                 4.997891e-01 1 1  ON 25
 eO_6                 2.701587e-01 1 1  ON 26
 eO_7                -3.700688e-02 1 1  ON 27
 eO_8                -2.401776e-01 1 1  ON 28
 eO_9                -1.089501e-01 1 1  ON 29
eH1_0                -2.559692e-01 1 1  ON 30
eH1_1                -1.546425e-01 1 1  ON 31
eH1_2                -1.072830e-01 1 1  ON 32
eH1_3                -5.236455e-02 1 1  ON 33
eH1_4                -3.343567e-03 1 1  ON 34
eH1_5                 3.201463e-02 1 1  ON 35
eH1_6                 9.327468e-02 1 1  ON 36
eH1_7                 1.552532e-01 1 1  ON 37
eH1_8                 1.953565e-01 1 1  ON 38
eH1_9                 9.683645e-02 1 1  ON 39
eH2_0                -2.533416e-01 1 1  ON 40
eH2_1                -1.517594e-01 1 1  ON 41
eH2_2                -1.044558e-01 1 1  ON 42
eH2_3                -4.971964e-02 1 1  ON 43
eH2_4                -1.000501e-03 1 1  ON 44
eH2_5                 3.370320e-02 1 1  ON 45
eH2_6                 9.498611e-02 1 1  ON 46
eH2_7                 1.556231e-01 1 1  ON 47
eH2_8                 1.983646e-01 1 1  ON 48
eH2_9                 9.063345e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.9678
    reference variance = 0.238481
====================================================
  Execution time = 2.2233e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3445e-01
  Total weights = 2.0000e+06
  Execution time = 1.8895e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334454831288
                                         uncertainty =       0.003795952312

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334454831288
                                         uncertainty =       0.003795952312

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408929949
  error estimate for blocks of size 2^( 2) =       0.000421500600
  error estimate for blocks of size 2^( 3) =       0.000434970269
  error estimate for blocks of size 2^( 4) =       0.000448061840
  error estimate for blocks of size 2^( 5) =       0.000459334790
  error estimate for blocks of size 2^( 6) =       0.000466992506
  error estimate for blocks of size 2^( 7) =       0.000476160078

      target function =                  N/A
              le_mean =     -16.906336350098
             les_mean =     286.158656021150
             stat err =       0.000462637304
             autocorr =       1.279921870805
              std dev =       0.578314279368
             le_variance =       0.334447405721

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334453807558
                                         uncertainty =       0.003795946716

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334453807558
                                         uncertainty =       0.003795946716

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408929323
  error estimate for blocks of size 2^( 2) =       0.000421500016
  error estimate for blocks of size 2^( 3) =       0.000434969723
  error estimate for blocks of size 2^( 4) =       0.000448061313
  error estimate for blocks of size 2^( 5) =       0.000459334277
  error estimate for blocks of size 2^( 6) =       0.000466992000
  error estimate for blocks of size 2^( 7) =       0.000476159577

      target function =                  N/A
              le_mean =     -16.906336352904
             les_mean =     286.158655092302
             stat err =       0.000462636792
             autocorr =       1.279922957200
              std dev =       0.578313394292
             le_variance =       0.334446382017

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334454318678
                                         uncertainty =       0.003795949509

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334454318678
                                         uncertainty =       0.003795949509

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408929635
  error estimate for blocks of size 2^( 2) =       0.000421500307
  error estimate for blocks of size 2^( 3) =       0.000434969996
  error estimate for blocks of size 2^( 4) =       0.000448061576
  error estimate for blocks of size 2^( 5) =       0.000459334534
  error estimate for blocks of size 2^( 6) =       0.000466992252
  error estimate for blocks of size 2^( 7) =       0.000476159827

      target function =                  N/A
              le_mean =     -16.906336351502
             les_mean =     286.158655556025
             stat err =       0.000462637047
             autocorr =       1.279922414786
              std dev =       0.578313836185
             le_variance =       0.334446893124

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334454767188
                                         uncertainty =       0.003795951961

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334454767188
                                         uncertainty =       0.003795951961

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408929909
  error estimate for blocks of size 2^( 2) =       0.000421500563
  error estimate for blocks of size 2^( 3) =       0.000434970235
  error estimate for blocks of size 2^( 4) =       0.000448061807
  error estimate for blocks of size 2^( 5) =       0.000459334758
  error estimate for blocks of size 2^( 6) =       0.000466992474
  error estimate for blocks of size 2^( 7) =       0.000476160047

      target function =                  N/A
              le_mean =     -16.906336350274
             les_mean =     286.158655962985
             stat err =       0.000462637271
             autocorr =       1.279921938818
              std dev =       0.578314223950
             le_variance =       0.334447341623


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906336350098        initial
     2.3283e+02     2.3283e+03             8.9877e-07       -16.906336352904  <--
     9.3132e+02     9.3132e+03             2.2472e-07       -16.906336351502
     3.7253e+03     3.7253e+04             5.6182e-08       -16.906336350274

*****************************************************************************
Applying the update for shift_i =   2.3283e+02     and shift_s =   2.3283e+03
*****************************************************************************

  Execution time = 3.1709e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.097567e-01 1 1  ON 0
 uu_1                 1.427102e-01 1 1  ON 1
 uu_2                 4.079103e-02 1 1  ON 2
 uu_3                -2.214546e-02 1 1  ON 3
 uu_4                -6.812006e-02 1 1  ON 4
 uu_5                -1.036043e-01 1 1  ON 5
 uu_6                -1.317419e-01 1 1  ON 6
 uu_7                -1.463379e-01 1 1  ON 7
 uu_8                -1.393149e-01 1 1  ON 8
 uu_9                -1.117330e-01 1 1  ON 9
 ud_0                 4.546844e-01 1 1  ON 10
 ud_1                 1.882384e-01 1 1  ON 11
 ud_2                 6.679912e-02 1 1  ON 12
 ud_3                -5.359825e-03 1 1  ON 13
 ud_4                -6.301501e-02 1 1  ON 14
 ud_5                -1.052706e-01 1 1  ON 15
 ud_6                -1.337466e-01 1 1  ON 16
 ud_7                -1.515620e-01 1 1  ON 17
 ud_8                -1.530952e-01 1 1  ON 18
 ud_9                -1.456313e-01 1 1  ON 19
 eO_0                -7.634121e-01 1 1  ON 20
 eO_1                -4.402747e-01 1 1  ON 21
 eO_2                -1.716371e-02 1 1  ON 22
 eO_3                 3.066771e-01 1 1  ON 23
 eO_4                 5.355647e-01 1 1  ON 24
 eO_5                 4.997891e-01 1 1  ON 25
 eO_6                 2.701587e-01 1 1  ON 26
 eO_7                -3.700697e-02 1 1  ON 27
 eO_8                -2.401777e-01 1 1  ON 28
 eO_9                -1.089504e-01 1 1  ON 29
eH1_0                -2.559696e-01 1 1  ON 30
eH1_1                -1.546424e-01 1 1  ON 31
eH1_2                -1.072829e-01 1 1  ON 32
eH1_3                -5.236469e-02 1 1  ON 33
eH1_4                -3.343560e-03 1 1  ON 34
eH1_5                 3.201432e-02 1 1  ON 35
eH1_6                 9.327437e-02 1 1  ON 36
eH1_7                 1.552530e-01 1 1  ON 37
eH1_8                 1.953567e-01 1 1  ON 38
eH1_9                 9.683713e-02 1 1  ON 39
eH2_0                -2.533419e-01 1 1  ON 40
eH2_1                -1.517598e-01 1 1  ON 41
eH2_2                -1.044561e-01 1 1  ON 42
eH2_3                -4.971982e-02 1 1  ON 43
eH2_4                -1.000384e-03 1 1  ON 44
eH2_5                 3.370285e-02 1 1  ON 45
eH2_6                 9.498624e-02 1 1  ON 46
eH2_7                 1.556236e-01 1 1  ON 47
eH2_8                 1.983649e-01 1 1  ON 48
eH2_9                 9.063401e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7477e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6911e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.8969
    reference variance = 0.309189
====================================================
  Execution time = 2.1411e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3876e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8714e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338777078987
                                         uncertainty =       0.003098429476

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338777078987
                                         uncertainty =       0.003098429476

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411559410
  error estimate for blocks of size 2^( 2) =       0.000424126200
  error estimate for blocks of size 2^( 3) =       0.000437154595
  error estimate for blocks of size 2^( 4) =       0.000448649260
  error estimate for blocks of size 2^( 5) =       0.000458462325
  error estimate for blocks of size 2^( 6) =       0.000465673323
  error estimate for blocks of size 2^( 7) =       0.000471171544

      target function =                  N/A
              le_mean =     -16.906015610201
             les_mean =     286.152125938172
             stat err =       0.000460989113
             autocorr =       1.254631729467
              std dev =       0.582032898710
             le_variance =       0.338762295180


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690601561020e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+01, overlap shift 5.8208e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906015610201       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906015608020       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906015608142       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906015616688       residual = 3.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906015624123       residual = 4.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906015625469       residual = 3.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906015627691       residual = 7.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+01 is 3.135268e-06

solving harmonic davidson linear method for identity shift 2.3283e+02, overlap shift 2.3283e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906015610201       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906015609655       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906015609684       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906015611825       residual = 3.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906015613702       residual = 4.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906015614024       residual = 3.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906015614584       residual = 7.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+02 is 7.842937e-07

solving harmonic davidson linear method for identity shift 9.3132e+02, overlap shift 9.3132e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906015610201       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906015610065       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906015610072       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906015610607       residual = 3.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906015611078       residual = 4.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906015611158       residual = 3.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906015611298       residual = 7.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+02 is 1.961036e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.202547 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7289e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.097564e-01 1 1  ON 0
 uu_1                 1.427103e-01 1 1  ON 1
 uu_2                 4.079106e-02 1 1  ON 2
 uu_3                -2.214561e-02 1 1  ON 3
 uu_4                -6.812014e-02 1 1  ON 4
 uu_5                -1.036039e-01 1 1  ON 5
 uu_6                -1.317421e-01 1 1  ON 6
 uu_7                -1.463384e-01 1 1  ON 7
 uu_8                -1.393150e-01 1 1  ON 8
 uu_9                -1.117329e-01 1 1  ON 9
 ud_0                 4.546845e-01 1 1  ON 10
 ud_1                 1.882385e-01 1 1  ON 11
 ud_2                 6.679935e-02 1 1  ON 12
 ud_3                -5.359961e-03 1 1  ON 13
 ud_4                -6.301496e-02 1 1  ON 14
 ud_5                -1.052709e-01 1 1  ON 15
 ud_6                -1.337460e-01 1 1  ON 16
 ud_7                -1.515624e-01 1 1  ON 17
 ud_8                -1.530952e-01 1 1  ON 18
 ud_9                -1.456313e-01 1 1  ON 19
 eO_0                -7.634117e-01 1 1  ON 20
 eO_1                -4.402752e-01 1 1  ON 21
 eO_2                -1.716302e-02 1 1  ON 22
 eO_3                 3.066773e-01 1 1  ON 23
 eO_4                 5.355650e-01 1 1  ON 24
 eO_5                 4.997891e-01 1 1  ON 25
 eO_6                 2.701587e-01 1 1  ON 26
 eO_7                -3.700714e-02 1 1  ON 27
 eO_8                -2.401780e-01 1 1  ON 28
 eO_9                -1.089509e-01 1 1  ON 29
eH1_0                -2.559696e-01 1 1  ON 30
eH1_1                -1.546426e-01 1 1  ON 31
eH1_2                -1.072829e-01 1 1  ON 32
eH1_3                -5.236478e-02 1 1  ON 33
eH1_4                -3.343556e-03 1 1  ON 34
eH1_5                 3.201426e-02 1 1  ON 35
eH1_6                 9.327384e-02 1 1  ON 36
eH1_7                 1.552526e-01 1 1  ON 37
eH1_8                 1.953571e-01 1 1  ON 38
eH1_9                 9.683783e-02 1 1  ON 39
eH2_0                -2.533424e-01 1 1  ON 40
eH2_1                -1.517604e-01 1 1  ON 41
eH2_2                -1.044562e-01 1 1  ON 42
eH2_3                -4.971974e-02 1 1  ON 43
eH2_4                -1.000466e-03 1 1  ON 44
eH2_5                 3.370269e-02 1 1  ON 45
eH2_6                 9.498647e-02 1 1  ON 46
eH2_7                 1.556236e-01 1 1  ON 47
eH2_8                 1.983651e-01 1 1  ON 48
eH2_9                 9.063480e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.8729
    reference variance = 0.223677
====================================================
  Execution time = 2.0209e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3964e-01
  Total weights = 2.0000e+06
  Execution time = 1.8844e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339715067220
                                         uncertainty =       0.003890098018

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339715067220
                                         uncertainty =       0.003890098018

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412090893
  error estimate for blocks of size 2^( 2) =       0.000425128263
  error estimate for blocks of size 2^( 3) =       0.000438518473
  error estimate for blocks of size 2^( 4) =       0.000451135130
  error estimate for blocks of size 2^( 5) =       0.000462664178
  error estimate for blocks of size 2^( 6) =       0.000471708454
  error estimate for blocks of size 2^( 7) =       0.000477448926

      target function =                  N/A
              le_mean =     -16.905994831813
             les_mean =     286.152298890923
             stat err =       0.000465739172
             autocorr =       1.277319377405
              std dev =       0.582784529191
             le_variance =       0.339637807464

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339714550134
                                         uncertainty =       0.003890099280

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339714550134
                                         uncertainty =       0.003890099280

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412090579
  error estimate for blocks of size 2^( 2) =       0.000425127967
  error estimate for blocks of size 2^( 3) =       0.000438518171
  error estimate for blocks of size 2^( 4) =       0.000451134816
  error estimate for blocks of size 2^( 5) =       0.000462663858
  error estimate for blocks of size 2^( 6) =       0.000471708107
  error estimate for blocks of size 2^( 7) =       0.000477448602

      target function =                  N/A
              le_mean =     -16.905994832661
             les_mean =     286.152298402824
             stat err =       0.000465738846
             autocorr =       1.277319530781
              std dev =       0.582784085809
             le_variance =       0.339637290672

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339714806620
                                         uncertainty =       0.003890098656

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339714806620
                                         uncertainty =       0.003890098656

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412090735
  error estimate for blocks of size 2^( 2) =       0.000425128114
  error estimate for blocks of size 2^( 3) =       0.000438518321
  error estimate for blocks of size 2^( 4) =       0.000451134972
  error estimate for blocks of size 2^( 5) =       0.000462664017
  error estimate for blocks of size 2^( 6) =       0.000471708279
  error estimate for blocks of size 2^( 7) =       0.000477448763

      target function =                  N/A
              le_mean =     -16.905994832231
             les_mean =     286.152298644614
             stat err =       0.000465739008
             autocorr =       1.277319455697
              std dev =       0.582784305737
             le_variance =       0.339637547013

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339715034577
                                         uncertainty =       0.003890098098

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339715034577
                                         uncertainty =       0.003890098098

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412090873
  error estimate for blocks of size 2^( 2) =       0.000425128244
  error estimate for blocks of size 2^( 3) =       0.000438518454
  error estimate for blocks of size 2^( 4) =       0.000451135110
  error estimate for blocks of size 2^( 5) =       0.000462664158
  error estimate for blocks of size 2^( 6) =       0.000471708432
  error estimate for blocks of size 2^( 7) =       0.000477448906

      target function =                  N/A
              le_mean =     -16.905994831864
             les_mean =     286.152298860046
             stat err =       0.000465739151
             autocorr =       1.277319387242
              std dev =       0.582784501201
             le_variance =       0.339637774841


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905994831813        initial
     5.8208e+01     5.8208e+02             3.1353e-06       -16.905994832661  <--
     2.3283e+02     2.3283e+03             7.8429e-07       -16.905994832231
     9.3132e+02     9.3132e+03             1.9610e-07       -16.905994831864

*****************************************************************************
Applying the update for shift_i =   5.8208e+01     and shift_s =   5.8208e+02
*****************************************************************************

  Execution time = 2.9658e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.097557e-01 1 1  ON 0
 uu_1                 1.427107e-01 1 1  ON 1
 uu_2                 4.079113e-02 1 1  ON 2
 uu_3                -2.214607e-02 1 1  ON 3
 uu_4                -6.812036e-02 1 1  ON 4
 uu_5                -1.036030e-01 1 1  ON 5
 uu_6                -1.317427e-01 1 1  ON 6
 uu_7                -1.463402e-01 1 1  ON 7
 uu_8                -1.393152e-01 1 1  ON 8
 uu_9                -1.117324e-01 1 1  ON 9
 ud_0                 4.546850e-01 1 1  ON 10
 ud_1                 1.882389e-01 1 1  ON 11
 ud_2                 6.680001e-02 1 1  ON 12
 ud_3                -5.360368e-03 1 1  ON 13
 ud_4                -6.301482e-02 1 1  ON 14
 ud_5                -1.052716e-01 1 1  ON 15
 ud_6                -1.337444e-01 1 1  ON 16
 ud_7                -1.515637e-01 1 1  ON 17
 ud_8                -1.530951e-01 1 1  ON 18
 ud_9                -1.456311e-01 1 1  ON 19
 eO_0                -7.634106e-01 1 1  ON 20
 eO_1                -4.402768e-01 1 1  ON 21
 eO_2                -1.716096e-02 1 1  ON 22
 eO_3                 3.066778e-01 1 1  ON 23
 eO_4                 5.355659e-01 1 1  ON 24
 eO_5                 4.997890e-01 1 1  ON 25
 eO_6                 2.701586e-01 1 1  ON 26
 eO_7                -3.700765e-02 1 1  ON 27
 eO_8                -2.401788e-01 1 1  ON 28
 eO_9                -1.089524e-01 1 1  ON 29
eH1_0                -2.559695e-01 1 1  ON 30
eH1_1                -1.546431e-01 1 1  ON 31
eH1_2                -1.072827e-01 1 1  ON 32
eH1_3                -5.236505e-02 1 1  ON 33
eH1_4                -3.343547e-03 1 1  ON 34
eH1_5                 3.201408e-02 1 1  ON 35
eH1_6                 9.327225e-02 1 1  ON 36
eH1_7                 1.552517e-01 1 1  ON 37
eH1_8                 1.953581e-01 1 1  ON 38
eH1_9                 9.683994e-02 1 1  ON 39
eH2_0                -2.533439e-01 1 1  ON 40
eH2_1                -1.517621e-01 1 1  ON 41
eH2_2                -1.044565e-01 1 1  ON 42
eH2_3                -4.971949e-02 1 1  ON 43
eH2_4                -1.000712e-03 1 1  ON 44
eH2_5                 3.370222e-02 1 1  ON 45
eH2_6                 9.498718e-02 1 1  ON 46
eH2_7                 1.556235e-01 1 1  ON 47
eH2_8                 1.983656e-01 1 1  ON 48
eH2_9                 9.063715e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6954e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.8464
    reference variance = 0.244306
====================================================
  Execution time = 2.0580e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3667e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.3943e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336698948079
                                         uncertainty =       0.003063375232

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336698948079
                                         uncertainty =       0.003063375232

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410284569
  error estimate for blocks of size 2^( 2) =       0.000423629154
  error estimate for blocks of size 2^( 3) =       0.000437260629
  error estimate for blocks of size 2^( 4) =       0.000450094904
  error estimate for blocks of size 2^( 5) =       0.000462236900
  error estimate for blocks of size 2^( 6) =       0.000472461246
  error estimate for blocks of size 2^( 7) =       0.000479709817

      target function =                  N/A
              le_mean =     -16.905975134581
             les_mean =     286.148661937525
             stat err =       0.000466125717
             autocorr =       1.290731065630
              std dev =       0.580230001626
             le_variance =       0.336666854787


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690597513458e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+01, overlap shift 1.4552e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905975134581       residual = 6.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905975151105       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905975199094       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905975204608       residual = 7.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905975209869       residual = 1.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905975219644       residual = 5.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905975195822       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905975196794       residual = 3.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+01 is 1.625571e-05

solving harmonic davidson linear method for identity shift 5.8208e+01, overlap shift 5.8208e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905975134581       residual = 6.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905975138746       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905975150830       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905975152177       residual = 7.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905975153544       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905975155954       residual = 5.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905975150031       residual = 9.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+01 is 3.814342e-06

solving harmonic davidson linear method for identity shift 2.3283e+02, overlap shift 2.3283e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905975134581       residual = 6.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905975135624       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905975138651       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905975138986       residual = 7.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905975139331       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905975139931       residual = 5.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905975138453       residual = 9.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+02 is 9.544466e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.205001 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5981e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.097551e-01 1 1  ON 0
 uu_1                 1.427088e-01 1 1  ON 1
 uu_2                 4.079165e-02 1 1  ON 2
 uu_3                -2.214654e-02 1 1  ON 3
 uu_4                -6.812033e-02 1 1  ON 4
 uu_5                -1.036023e-01 1 1  ON 5
 uu_6                -1.317455e-01 1 1  ON 6
 uu_7                -1.463407e-01 1 1  ON 7
 uu_8                -1.393142e-01 1 1  ON 8
 uu_9                -1.117320e-01 1 1  ON 9
 ud_0                 4.546838e-01 1 1  ON 10
 ud_1                 1.882381e-01 1 1  ON 11
 ud_2                 6.679879e-02 1 1  ON 12
 ud_3                -5.360427e-03 1 1  ON 13
 ud_4                -6.301624e-02 1 1  ON 14
 ud_5                -1.052716e-01 1 1  ON 15
 ud_6                -1.337459e-01 1 1  ON 16
 ud_7                -1.515629e-01 1 1  ON 17
 ud_8                -1.530924e-01 1 1  ON 18
 ud_9                -1.456283e-01 1 1  ON 19
 eO_0                -7.634094e-01 1 1  ON 20
 eO_1                -4.402772e-01 1 1  ON 21
 eO_2                -1.716236e-02 1 1  ON 22
 eO_3                 3.066785e-01 1 1  ON 23
 eO_4                 5.355669e-01 1 1  ON 24
 eO_5                 4.997887e-01 1 1  ON 25
 eO_6                 2.701588e-01 1 1  ON 26
 eO_7                -3.700640e-02 1 1  ON 27
 eO_8                -2.401788e-01 1 1  ON 28
 eO_9                -1.089542e-01 1 1  ON 29
eH1_0                -2.559702e-01 1 1  ON 30
eH1_1                -1.546437e-01 1 1  ON 31
eH1_2                -1.072850e-01 1 1  ON 32
eH1_3                -5.236469e-02 1 1  ON 33
eH1_4                -3.346233e-03 1 1  ON 34
eH1_5                 3.201294e-02 1 1  ON 35
eH1_6                 9.327304e-02 1 1  ON 36
eH1_7                 1.552519e-01 1 1  ON 37
eH1_8                 1.953594e-01 1 1  ON 38
eH1_9                 9.684376e-02 1 1  ON 39
eH2_0                -2.533447e-01 1 1  ON 40
eH2_1                -1.517630e-01 1 1  ON 41
eH2_2                -1.044587e-01 1 1  ON 42
eH2_3                -4.972017e-02 1 1  ON 43
eH2_4                -1.002146e-03 1 1  ON 44
eH2_5                 3.370195e-02 1 1  ON 45
eH2_6                 9.498787e-02 1 1  ON 46
eH2_7                 1.556248e-01 1 1  ON 47
eH2_8                 1.983666e-01 1 1  ON 48
eH2_9                 9.064030e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.963
    reference variance = 0.255459
====================================================
  Execution time = 1.9969e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4680e-01
  Total weights = 2.0000e+06
  Execution time = 1.8847e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346804425254
                                         uncertainty =       0.013001759994

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346804425254
                                         uncertainty =       0.013001759994

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416416392
  error estimate for blocks of size 2^( 2) =       0.000428840716
  error estimate for blocks of size 2^( 3) =       0.000441503763
  error estimate for blocks of size 2^( 4) =       0.000453761335
  error estimate for blocks of size 2^( 5) =       0.000463819318
  error estimate for blocks of size 2^( 6) =       0.000471000125
  error estimate for blocks of size 2^( 7) =       0.000475654618

      target function =                  N/A
              le_mean =     -16.905843075248
             les_mean =     286.154335135359
             stat err =       0.000466058849
             autocorr =       1.252638863479
              std dev =       0.588901709840
             le_variance =       0.346805223852

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346802568582
                                         uncertainty =       0.013001052234

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346802568582
                                         uncertainty =       0.013001052234

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416415275
  error estimate for blocks of size 2^( 2) =       0.000428839743
  error estimate for blocks of size 2^( 3) =       0.000441502894
  error estimate for blocks of size 2^( 4) =       0.000453760430
  error estimate for blocks of size 2^( 5) =       0.000463818268
  error estimate for blocks of size 2^( 6) =       0.000470998942
  error estimate for blocks of size 2^( 7) =       0.000475653335

      target function =                  N/A
              le_mean =     -16.905843090937
             les_mean =     286.154333805146
             stat err =       0.000466057744
             autocorr =       1.252639643672
              std dev =       0.588900130034
             le_variance =       0.346803363154

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346803507163
                                         uncertainty =       0.013001385949

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346803507163
                                         uncertainty =       0.013001385949

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416415840
  error estimate for blocks of size 2^( 2) =       0.000428840239
  error estimate for blocks of size 2^( 3) =       0.000441503342
  error estimate for blocks of size 2^( 4) =       0.000453760898
  error estimate for blocks of size 2^( 5) =       0.000463818810
  error estimate for blocks of size 2^( 6) =       0.000470999553
  error estimate for blocks of size 2^( 7) =       0.000475653995

      target function =                  N/A
              le_mean =     -16.905843080856
             les_mean =     286.154334404888
             stat err =       0.000466058314
             autocorr =       1.252639311985
              std dev =       0.588900928643
             le_variance =       0.346804303756

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346804310192
                                         uncertainty =       0.013001713095

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346804310192
                                         uncertainty =       0.013001713095

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416416323
  error estimate for blocks of size 2^( 2) =       0.000428840656
  error estimate for blocks of size 2^( 3) =       0.000441503710
  error estimate for blocks of size 2^( 4) =       0.000453761280
  error estimate for blocks of size 2^( 5) =       0.000463819254
  error estimate for blocks of size 2^( 6) =       0.000471000053
  error estimate for blocks of size 2^( 7) =       0.000475654540

      target function =                  N/A
              le_mean =     -16.905843075937
             les_mean =     286.154335043329
             stat err =       0.000466058782
             autocorr =       1.252638919512
              std dev =       0.588901611934
             le_variance =       0.346805108538


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905843075248        initial
     1.4552e+01     1.4552e+02             1.6256e-05       -16.905843090937  <--
     5.8208e+01     5.8208e+02             3.8143e-06       -16.905843080856
     2.3283e+02     2.3283e+03             9.5445e-07       -16.905843075937

*****************************************************************************
Applying the update for shift_i =   1.4552e+01     and shift_s =   1.4552e+02
*****************************************************************************

  Execution time = 2.9447e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.097533e-01 1 1  ON 0
 uu_1                 1.427039e-01 1 1  ON 1
 uu_2                 4.079266e-02 1 1  ON 2
 uu_3                -2.214821e-02 1 1  ON 3
 uu_4                -6.811993e-02 1 1  ON 4
 uu_5                -1.036005e-01 1 1  ON 5
 uu_6                -1.317534e-01 1 1  ON 6
 uu_7                -1.463422e-01 1 1  ON 7
 uu_8                -1.393117e-01 1 1  ON 8
 uu_9                -1.117309e-01 1 1  ON 9
 ud_0                 4.546802e-01 1 1  ON 10
 ud_1                 1.882360e-01 1 1  ON 11
 ud_2                 6.679541e-02 1 1  ON 12
 ud_3                -5.360406e-03 1 1  ON 13
 ud_4                -6.302030e-02 1 1  ON 14
 ud_5                -1.052721e-01 1 1  ON 15
 ud_6                -1.337498e-01 1 1  ON 16
 ud_7                -1.515605e-01 1 1  ON 17
 ud_8                -1.530846e-01 1 1  ON 18
 ud_9                -1.456196e-01 1 1  ON 19
 eO_0                -7.634059e-01 1 1  ON 20
 eO_1                -4.402783e-01 1 1  ON 21
 eO_2                -1.716606e-02 1 1  ON 22
 eO_3                 3.066804e-01 1 1  ON 23
 eO_4                 5.355696e-01 1 1  ON 24
 eO_5                 4.997880e-01 1 1  ON 25
 eO_6                 2.701599e-01 1 1  ON 26
 eO_7                -3.700264e-02 1 1  ON 27
 eO_8                -2.401790e-01 1 1  ON 28
 eO_9                -1.089602e-01 1 1  ON 29
eH1_0                -2.559727e-01 1 1  ON 30
eH1_1                -1.546463e-01 1 1  ON 31
eH1_2                -1.072918e-01 1 1  ON 32
eH1_3                -5.236363e-02 1 1  ON 33
eH1_4                -3.354260e-03 1 1  ON 34
eH1_5                 3.200918e-02 1 1  ON 35
eH1_6                 9.327531e-02 1 1  ON 36
eH1_7                 1.552527e-01 1 1  ON 37
eH1_8                 1.953634e-01 1 1  ON 38
eH1_9                 9.685620e-02 1 1  ON 39
eH2_0                -2.533476e-01 1 1  ON 40
eH2_1                -1.517655e-01 1 1  ON 41
eH2_2                -1.044659e-01 1 1  ON 42
eH2_3                -4.972243e-02 1 1  ON 43
eH2_4                -1.006004e-03 1 1  ON 44
eH2_5                 3.370108e-02 1 1  ON 45
eH2_6                 9.498983e-02 1 1  ON 46
eH2_7                 1.556286e-01 1 1  ON 47
eH2_8                 1.983696e-01 1 1  ON 48
eH2_9                 9.065060e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5435e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.8675
    reference variance = 0.200093
====================================================
  Execution time = 2.0337e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4072e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5351e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340796977660
                                         uncertainty =       0.003038609472

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340796977660
                                         uncertainty =       0.003038609472

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412744014
  error estimate for blocks of size 2^( 2) =       0.000425684476
  error estimate for blocks of size 2^( 3) =       0.000438532942
  error estimate for blocks of size 2^( 4) =       0.000451405412
  error estimate for blocks of size 2^( 5) =       0.000462033780
  error estimate for blocks of size 2^( 6) =       0.000470203291
  error estimate for blocks of size 2^( 7) =       0.000474888416

      target function =                  N/A
              le_mean =     -16.905120450156
             les_mean =     286.123812506174
             stat err =       0.000464632725
             autocorr =       1.267237518744
              std dev =       0.583708182436
             le_variance =       0.340715242243


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690512045016e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+00, overlap shift 3.6380e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905120450156       residual = 7.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905120608383       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905120701086       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905120639594       residual = 4.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905120660043       residual = 2.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905120745362       residual = 9.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905120793301       residual = 2.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905120777349       residual = 4.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+00 is 5.785872e-05

solving harmonic davidson linear method for identity shift 1.4552e+01, overlap shift 1.4552e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905120450156       residual = 7.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905120490885       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905120515575       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905120499393       residual = 4.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905120500195       residual = 2.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905120520375       residual = 8.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905120535085       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905120531892       residual = 3.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+01 is 1.496884e-05

solving harmonic davidson linear method for identity shift 5.8208e+01, overlap shift 5.8208e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905120450156       residual = 7.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905120460415       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905120466692       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905120462595       residual = 4.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905120462501       residual = 2.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905120467477       residual = 7.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905120471292       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905120470548       residual = 3.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+01 is 3.776025e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.207640 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5879e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.097501e-01 1 1  ON 0
 uu_1                 1.426994e-01 1 1  ON 1
 uu_2                 4.078861e-02 1 1  ON 2
 uu_3                -2.214921e-02 1 1  ON 3
 uu_4                -6.812109e-02 1 1  ON 4
 uu_5                -1.035922e-01 1 1  ON 5
 uu_6                -1.317667e-01 1 1  ON 6
 uu_7                -1.463474e-01 1 1  ON 7
 uu_8                -1.393087e-01 1 1  ON 8
 uu_9                -1.117241e-01 1 1  ON 9
 ud_0                 4.546871e-01 1 1  ON 10
 ud_1                 1.882339e-01 1 1  ON 11
 ud_2                 6.679366e-02 1 1  ON 12
 ud_3                -5.356716e-03 1 1  ON 13
 ud_4                -6.302693e-02 1 1  ON 14
 ud_5                -1.052718e-01 1 1  ON 15
 ud_6                -1.337440e-01 1 1  ON 16
 ud_7                -1.515656e-01 1 1  ON 17
 ud_8                -1.530853e-01 1 1  ON 18
 ud_9                -1.456160e-01 1 1  ON 19
 eO_0                -7.633972e-01 1 1  ON 20
 eO_1                -4.402768e-01 1 1  ON 21
 eO_2                -1.717365e-02 1 1  ON 22
 eO_3                 3.066824e-01 1 1  ON 23
 eO_4                 5.355706e-01 1 1  ON 24
 eO_5                 4.997937e-01 1 1  ON 25
 eO_6                 2.701617e-01 1 1  ON 26
 eO_7                -3.700495e-02 1 1  ON 27
 eO_8                -2.401824e-01 1 1  ON 28
 eO_9                -1.089667e-01 1 1  ON 29
eH1_0                -2.559862e-01 1 1  ON 30
eH1_1                -1.546463e-01 1 1  ON 31
eH1_2                -1.072980e-01 1 1  ON 32
eH1_3                -5.236537e-02 1 1  ON 33
eH1_4                -3.352025e-03 1 1  ON 34
eH1_5                 3.200195e-02 1 1  ON 35
eH1_6                 9.328129e-02 1 1  ON 36
eH1_7                 1.552568e-01 1 1  ON 37
eH1_8                 1.953675e-01 1 1  ON 38
eH1_9                 9.686670e-02 1 1  ON 39
eH2_0                -2.533534e-01 1 1  ON 40
eH2_1                -1.517713e-01 1 1  ON 41
eH2_2                -1.044682e-01 1 1  ON 42
eH2_3                -4.973740e-02 1 1  ON 43
eH2_4                -1.008945e-03 1 1  ON 44
eH2_5                 3.370095e-02 1 1  ON 45
eH2_6                 9.499250e-02 1 1  ON 46
eH2_7                 1.556363e-01 1 1  ON 47
eH2_8                 1.983770e-01 1 1  ON 48
eH2_9                 9.066255e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.9524
    reference variance = 0.319276
====================================================
  Execution time = 2.0192e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4218e-01
  Total weights = 2.0000e+06
  Execution time = 1.8876e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341968117933
                                         uncertainty =       0.003897016708

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341968117933
                                         uncertainty =       0.003897016708

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413624027
  error estimate for blocks of size 2^( 2) =       0.000426556542
  error estimate for blocks of size 2^( 3) =       0.000439869654
  error estimate for blocks of size 2^( 4) =       0.000450766979
  error estimate for blocks of size 2^( 5) =       0.000460918013
  error estimate for blocks of size 2^( 6) =       0.000468031456
  error estimate for blocks of size 2^( 7) =       0.000471954807

      target function =                  N/A
              le_mean =     -16.906473417160
             les_mean =     286.171012905771
             stat err =       0.000462917814
             autocorr =       1.252553455456
              std dev =       0.584952708965
             le_variance =       0.342169671726

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341991231509
                                         uncertainty =       0.003897192630

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341991231509
                                         uncertainty =       0.003897192630

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413638003
  error estimate for blocks of size 2^( 2) =       0.000426570027
  error estimate for blocks of size 2^( 3) =       0.000439882797
  error estimate for blocks of size 2^( 4) =       0.000450779444
  error estimate for blocks of size 2^( 5) =       0.000460929271
  error estimate for blocks of size 2^( 6) =       0.000468042274
  error estimate for blocks of size 2^( 7) =       0.000471966113

      target function =                  N/A
              le_mean =     -16.906473365192
             les_mean =     286.171034272257
             stat err =       0.000462929275
             autocorr =       1.252530835217
              std dev =       0.584972474068
             le_variance =       0.342192795417

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341981202741
                                         uncertainty =       0.003897118569

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341981202741
                                         uncertainty =       0.003897118569

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413631939
  error estimate for blocks of size 2^( 2) =       0.000426564155
  error estimate for blocks of size 2^( 3) =       0.000439877066
  error estimate for blocks of size 2^( 4) =       0.000450774021
  error estimate for blocks of size 2^( 5) =       0.000460924406
  error estimate for blocks of size 2^( 6) =       0.000468037623
  error estimate for blocks of size 2^( 7) =       0.000471961241

      target function =                  N/A
              le_mean =     -16.906473384802
             les_mean =     286.171024902295
             stat err =       0.000462924323
             autocorr =       1.252540758842
              std dev =       0.584963898356
             le_variance =       0.342182762380

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341969806531
                                         uncertainty =       0.003897029917

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341969806531
                                         uncertainty =       0.003897029917

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413625048
  error estimate for blocks of size 2^( 2) =       0.000426557523
  error estimate for blocks of size 2^( 3) =       0.000439870609
  error estimate for blocks of size 2^( 4) =       0.000450767887
  error estimate for blocks of size 2^( 5) =       0.000460918838
  error estimate for blocks of size 2^( 6) =       0.000468032252
  error estimate for blocks of size 2^( 7) =       0.000471955638

      target function =                  N/A
              le_mean =     -16.906473412639
             les_mean =     286.171014442277
             stat err =       0.000462918654
             autocorr =       1.252551818147
              std dev =       0.584954152971
             le_variance =       0.342171361078


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906473417160        initial  <--
     3.6380e+00     3.6380e+01             5.7859e-05       -16.906473365192
     1.4552e+01     1.4552e+02             1.4969e-05       -16.906473384802
     5.8208e+01     5.8208e+02             3.7760e-06       -16.906473412639

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6540
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.097533e-01 1 1  ON 0
 uu_1                 1.427039e-01 1 1  ON 1
 uu_2                 4.079266e-02 1 1  ON 2
 uu_3                -2.214821e-02 1 1  ON 3
 uu_4                -6.811993e-02 1 1  ON 4
 uu_5                -1.036005e-01 1 1  ON 5
 uu_6                -1.317534e-01 1 1  ON 6
 uu_7                -1.463422e-01 1 1  ON 7
 uu_8                -1.393117e-01 1 1  ON 8
 uu_9                -1.117309e-01 1 1  ON 9
 ud_0                 4.546802e-01 1 1  ON 10
 ud_1                 1.882360e-01 1 1  ON 11
 ud_2                 6.679541e-02 1 1  ON 12
 ud_3                -5.360406e-03 1 1  ON 13
 ud_4                -6.302030e-02 1 1  ON 14
 ud_5                -1.052721e-01 1 1  ON 15
 ud_6                -1.337498e-01 1 1  ON 16
 ud_7                -1.515605e-01 1 1  ON 17
 ud_8                -1.530846e-01 1 1  ON 18
 ud_9                -1.456196e-01 1 1  ON 19
 eO_0                -7.634059e-01 1 1  ON 20
 eO_1                -4.402783e-01 1 1  ON 21
 eO_2                -1.716606e-02 1 1  ON 22
 eO_3                 3.066804e-01 1 1  ON 23
 eO_4                 5.355696e-01 1 1  ON 24
 eO_5                 4.997880e-01 1 1  ON 25
 eO_6                 2.701599e-01 1 1  ON 26
 eO_7                -3.700264e-02 1 1  ON 27
 eO_8                -2.401790e-01 1 1  ON 28
 eO_9                -1.089602e-01 1 1  ON 29
eH1_0                -2.559727e-01 1 1  ON 30
eH1_1                -1.546463e-01 1 1  ON 31
eH1_2                -1.072918e-01 1 1  ON 32
eH1_3                -5.236363e-02 1 1  ON 33
eH1_4                -3.354260e-03 1 1  ON 34
eH1_5                 3.200918e-02 1 1  ON 35
eH1_6                 9.327531e-02 1 1  ON 36
eH1_7                 1.552527e-01 1 1  ON 37
eH1_8                 1.953634e-01 1 1  ON 38
eH1_9                 9.685620e-02 1 1  ON 39
eH2_0                -2.533476e-01 1 1  ON 40
eH2_1                -1.517655e-01 1 1  ON 41
eH2_2                -1.044659e-01 1 1  ON 42
eH2_3                -4.972243e-02 1 1  ON 43
eH2_4                -1.006004e-03 1 1  ON 44
eH2_5                 3.370108e-02 1 1  ON 45
eH2_6                 9.498983e-02 1 1  ON 46
eH2_7                 1.556286e-01 1 1  ON 47
eH2_8                 1.983696e-01 1 1  ON 48
eH2_9                 9.065060e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5541e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.8519
    reference variance = 0.168733
====================================================
  Execution time = 2.0521e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3357e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5130e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333617501440
                                         uncertainty =       0.003129986427

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333617501440
                                         uncertainty =       0.003129986427

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408396109
  error estimate for blocks of size 2^( 2) =       0.000421146935
  error estimate for blocks of size 2^( 3) =       0.000433944804
  error estimate for blocks of size 2^( 4) =       0.000446468074
  error estimate for blocks of size 2^( 5) =       0.000457967549
  error estimate for blocks of size 2^( 6) =       0.000466446185
  error estimate for blocks of size 2^( 7) =       0.000469225880

      target function =                  N/A
              le_mean =     -16.905386532643
             les_mean =     286.125668414305
             stat err =       0.000460026922
             autocorr =       1.268829613542
              std dev =       0.577559315590
             le_variance =       0.333574763024


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690538653264e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+01, overlap shift 3.6380e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905386532643       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905386570408       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905386573802       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905386588632       residual = 7.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905386597756       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905386612018       residual = 6.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905386603904       residual = 4.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+01 is 5.885048e-06

solving harmonic davidson linear method for identity shift 1.4552e+02, overlap shift 1.4552e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905386532643       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905386542139       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905386542998       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905386546758       residual = 7.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905386549054       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905386552655       residual = 5.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905386550635       residual = 4.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+02 is 1.473345e-06

solving harmonic davidson linear method for identity shift 5.8208e+02, overlap shift 5.8208e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905386532643       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905386535021       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905386535236       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905386536179       residual = 7.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905386536754       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905386537657       residual = 5.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905386537154       residual = 4.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+02 is 3.684668e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.209916 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6040e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.097528e-01 1 1  ON 0
 uu_1                 1.427030e-01 1 1  ON 1
 uu_2                 4.079274e-02 1 1  ON 2
 uu_3                -2.214841e-02 1 1  ON 3
 uu_4                -6.812000e-02 1 1  ON 4
 uu_5                -1.035999e-01 1 1  ON 5
 uu_6                -1.317542e-01 1 1  ON 6
 uu_7                -1.463429e-01 1 1  ON 7
 uu_8                -1.393112e-01 1 1  ON 8
 uu_9                -1.117302e-01 1 1  ON 9
 ud_0                 4.546811e-01 1 1  ON 10
 ud_1                 1.882357e-01 1 1  ON 11
 ud_2                 6.679552e-02 1 1  ON 12
 ud_3                -5.360736e-03 1 1  ON 13
 ud_4                -6.302034e-02 1 1  ON 14
 ud_5                -1.052734e-01 1 1  ON 15
 ud_6                -1.337493e-01 1 1  ON 16
 ud_7                -1.515604e-01 1 1  ON 17
 ud_8                -1.530840e-01 1 1  ON 18
 ud_9                -1.456192e-01 1 1  ON 19
 eO_0                -7.634064e-01 1 1  ON 20
 eO_1                -4.402780e-01 1 1  ON 21
 eO_2                -1.716555e-02 1 1  ON 22
 eO_3                 3.066804e-01 1 1  ON 23
 eO_4                 5.355698e-01 1 1  ON 24
 eO_5                 4.997881e-01 1 1  ON 25
 eO_6                 2.701603e-01 1 1  ON 26
 eO_7                -3.700288e-02 1 1  ON 27
 eO_8                -2.401792e-01 1 1  ON 28
 eO_9                -1.089608e-01 1 1  ON 29
eH1_0                -2.559734e-01 1 1  ON 30
eH1_1                -1.546473e-01 1 1  ON 31
eH1_2                -1.072919e-01 1 1  ON 32
eH1_3                -5.236440e-02 1 1  ON 33
eH1_4                -3.354998e-03 1 1  ON 34
eH1_5                 3.200951e-02 1 1  ON 35
eH1_6                 9.327561e-02 1 1  ON 36
eH1_7                 1.552531e-01 1 1  ON 37
eH1_8                 1.953640e-01 1 1  ON 38
eH1_9                 9.685767e-02 1 1  ON 39
eH2_0                -2.533480e-01 1 1  ON 40
eH2_1                -1.517660e-01 1 1  ON 41
eH2_2                -1.044656e-01 1 1  ON 42
eH2_3                -4.972250e-02 1 1  ON 43
eH2_4                -1.006266e-03 1 1  ON 44
eH2_5                 3.370122e-02 1 1  ON 45
eH2_6                 9.498974e-02 1 1  ON 46
eH2_7                 1.556282e-01 1 1  ON 47
eH2_8                 1.983697e-01 1 1  ON 48
eH2_9                 9.065157e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.8096
    reference variance = 0.46283
====================================================
  Execution time = 2.0218e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3915e-01
  Total weights = 2.0000e+06
  Execution time = 1.8840e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339235333942
                                         uncertainty =       0.003232858651

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339235333942
                                         uncertainty =       0.003232858651

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411793904
  error estimate for blocks of size 2^( 2) =       0.000424559530
  error estimate for blocks of size 2^( 3) =       0.000437219183
  error estimate for blocks of size 2^( 4) =       0.000449253574
  error estimate for blocks of size 2^( 5) =       0.000459598995
  error estimate for blocks of size 2^( 6) =       0.000465669676
  error estimate for blocks of size 2^( 7) =       0.000470379064

      target function =                  N/A
              le_mean =     -16.905809781276
             les_mean =     286.145552629676
             stat err =       0.000461225327
             autocorr =       1.254487876548
              std dev =       0.582364523772
             le_variance =       0.339148438548

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339237047855
                                         uncertainty =       0.003232904297

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339237047855
                                         uncertainty =       0.003232904297

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411794944
  error estimate for blocks of size 2^( 2) =       0.000424560560
  error estimate for blocks of size 2^( 3) =       0.000437220223
  error estimate for blocks of size 2^( 4) =       0.000449254643
  error estimate for blocks of size 2^( 5) =       0.000459600057
  error estimate for blocks of size 2^( 6) =       0.000465670745
  error estimate for blocks of size 2^( 7) =       0.000470380200

      target function =                  N/A
              le_mean =     -16.905809804212
             les_mean =     286.145555119189
             stat err =       0.000461226411
             autocorr =       1.254487435007
              std dev =       0.582365995389
             le_variance =       0.339150152585

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339236193271
                                         uncertainty =       0.003232881673

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339236193271
                                         uncertainty =       0.003232881673

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411794426
  error estimate for blocks of size 2^( 2) =       0.000424560047
  error estimate for blocks of size 2^( 3) =       0.000437219705
  error estimate for blocks of size 2^( 4) =       0.000449254110
  error estimate for blocks of size 2^( 5) =       0.000459599528
  error estimate for blocks of size 2^( 6) =       0.000465670213
  error estimate for blocks of size 2^( 7) =       0.000470379634

      target function =                  N/A
              le_mean =     -16.905809792820
             les_mean =     286.145553879381
             stat err =       0.000461225871
             autocorr =       1.254487658796
              std dev =       0.582365261622
             le_variance =       0.339149297944

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339235441416
                                         uncertainty =       0.003232861535

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339235441416
                                         uncertainty =       0.003232861535

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411793969
  error estimate for blocks of size 2^( 2) =       0.000424559595
  error estimate for blocks of size 2^( 3) =       0.000437219248
  error estimate for blocks of size 2^( 4) =       0.000449253641
  error estimate for blocks of size 2^( 5) =       0.000459599061
  error estimate for blocks of size 2^( 6) =       0.000465669743
  error estimate for blocks of size 2^( 7) =       0.000470379135

      target function =                  N/A
              le_mean =     -16.905809782720
             les_mean =     286.145552785970
             stat err =       0.000461225395
             autocorr =       1.254487849431
              std dev =       0.582364616053
             le_variance =       0.339148546031


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905809781276        initial
     3.6380e+01     3.6380e+02             5.8850e-06       -16.905809804212  <--
     1.4552e+02     1.4552e+03             1.4733e-06       -16.905809792820
     5.8208e+02     5.8208e+03             3.6847e-07       -16.905809782720

*****************************************************************************
Applying the update for shift_i =   3.6380e+01     and shift_s =   3.6380e+02
*****************************************************************************

  Execution time = 2.9758e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.097514e-01 1 1  ON 0
 uu_1                 1.427004e-01 1 1  ON 1
 uu_2                 4.079299e-02 1 1  ON 2
 uu_3                -2.214901e-02 1 1  ON 3
 uu_4                -6.812022e-02 1 1  ON 4
 uu_5                -1.035982e-01 1 1  ON 5
 uu_6                -1.317566e-01 1 1  ON 6
 uu_7                -1.463451e-01 1 1  ON 7
 uu_8                -1.393095e-01 1 1  ON 8
 uu_9                -1.117280e-01 1 1  ON 9
 ud_0                 4.546837e-01 1 1  ON 10
 ud_1                 1.882348e-01 1 1  ON 11
 ud_2                 6.679585e-02 1 1  ON 12
 ud_3                -5.361712e-03 1 1  ON 13
 ud_4                -6.302050e-02 1 1  ON 14
 ud_5                -1.052772e-01 1 1  ON 15
 ud_6                -1.337478e-01 1 1  ON 16
 ud_7                -1.515601e-01 1 1  ON 17
 ud_8                -1.530823e-01 1 1  ON 18
 ud_9                -1.456179e-01 1 1  ON 19
 eO_0                -7.634078e-01 1 1  ON 20
 eO_1                -4.402771e-01 1 1  ON 21
 eO_2                -1.716400e-02 1 1  ON 22
 eO_3                 3.066803e-01 1 1  ON 23
 eO_4                 5.355706e-01 1 1  ON 24
 eO_5                 4.997884e-01 1 1  ON 25
 eO_6                 2.701615e-01 1 1  ON 26
 eO_7                -3.700358e-02 1 1  ON 27
 eO_8                -2.401797e-01 1 1  ON 28
 eO_9                -1.089625e-01 1 1  ON 29
eH1_0                -2.559756e-01 1 1  ON 30
eH1_1                -1.546505e-01 1 1  ON 31
eH1_2                -1.072923e-01 1 1  ON 32
eH1_3                -5.236672e-02 1 1  ON 33
eH1_4                -3.357208e-03 1 1  ON 34
eH1_5                 3.201053e-02 1 1  ON 35
eH1_6                 9.327650e-02 1 1  ON 36
eH1_7                 1.552540e-01 1 1  ON 37
eH1_8                 1.953656e-01 1 1  ON 38
eH1_9                 9.686209e-02 1 1  ON 39
eH2_0                -2.533493e-01 1 1  ON 40
eH2_1                -1.517675e-01 1 1  ON 41
eH2_2                -1.044647e-01 1 1  ON 42
eH2_3                -4.972270e-02 1 1  ON 43
eH2_4                -1.007052e-03 1 1  ON 44
eH2_5                 3.370164e-02 1 1  ON 45
eH2_6                 9.498948e-02 1 1  ON 46
eH2_7                 1.556271e-01 1 1  ON 47
eH2_8                 1.983700e-01 1 1  ON 48
eH2_9                 9.065448e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5807e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.9314
    reference variance = 0.278317
====================================================
  Execution time = 2.0512e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3900e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4821e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338384087194
                                         uncertainty =       0.002867692179

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338384087194
                                         uncertainty =       0.002867692179

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411705279
  error estimate for blocks of size 2^( 2) =       0.000424724465
  error estimate for blocks of size 2^( 3) =       0.000437719272
  error estimate for blocks of size 2^( 4) =       0.000449751110
  error estimate for blocks of size 2^( 5) =       0.000460462652
  error estimate for blocks of size 2^( 6) =       0.000469484230
  error estimate for blocks of size 2^( 7) =       0.000474722036

      target function =                  N/A
              le_mean =     -16.906619339537
             les_mean =     286.172779795653
             stat err =       0.000463605007
             autocorr =       1.268012004313
              std dev =       0.582239188954
             le_variance =       0.339002473154


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690661933954e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+00, overlap shift 9.0949e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906619339537       residual = 9.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906619348371       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906619362074       residual = 8.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906619374412       residual = 3.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906619382579       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906619390585       residual = 3.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906619403905       residual = 9.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+00 is 2.014424e-05

solving harmonic davidson linear method for identity shift 3.6380e+01, overlap shift 3.6380e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906619339537       residual = 9.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906619341775       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906619345289       residual = 8.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906619348457       residual = 3.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906619350632       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906619352663       residual = 2.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906619355931       residual = 9.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+01 is 5.047852e-06

solving harmonic davidson linear method for identity shift 1.4552e+02, overlap shift 1.4552e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906619339537       residual = 9.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906619340098       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906619340982       residual = 8.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906619341780       residual = 3.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906619342332       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906619342842       residual = 2.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906619343655       residual = 9.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+02 is 1.262679e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.212211 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6001e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.097511e-01 1 1  ON 0
 uu_1                 1.426980e-01 1 1  ON 1
 uu_2                 4.079182e-02 1 1  ON 2
 uu_3                -2.214934e-02 1 1  ON 3
 uu_4                -6.812110e-02 1 1  ON 4
 uu_5                -1.035991e-01 1 1  ON 5
 uu_6                -1.317572e-01 1 1  ON 6
 uu_7                -1.463458e-01 1 1  ON 7
 uu_8                -1.393073e-01 1 1  ON 8
 uu_9                -1.117265e-01 1 1  ON 9
 ud_0                 4.546847e-01 1 1  ON 10
 ud_1                 1.882354e-01 1 1  ON 11
 ud_2                 6.679501e-02 1 1  ON 12
 ud_3                -5.361866e-03 1 1  ON 13
 ud_4                -6.302293e-02 1 1  ON 14
 ud_5                -1.052764e-01 1 1  ON 15
 ud_6                -1.337498e-01 1 1  ON 16
 ud_7                -1.515602e-01 1 1  ON 17
 ud_8                -1.530821e-01 1 1  ON 18
 ud_9                -1.456156e-01 1 1  ON 19
 eO_0                -7.634083e-01 1 1  ON 20
 eO_1                -4.402776e-01 1 1  ON 21
 eO_2                -1.716332e-02 1 1  ON 22
 eO_3                 3.066800e-01 1 1  ON 23
 eO_4                 5.355741e-01 1 1  ON 24
 eO_5                 4.997889e-01 1 1  ON 25
 eO_6                 2.701619e-01 1 1  ON 26
 eO_7                -3.700404e-02 1 1  ON 27
 eO_8                -2.401802e-01 1 1  ON 28
 eO_9                -1.089648e-01 1 1  ON 29
eH1_0                -2.559787e-01 1 1  ON 30
eH1_1                -1.546508e-01 1 1  ON 31
eH1_2                -1.072918e-01 1 1  ON 32
eH1_3                -5.236844e-02 1 1  ON 33
eH1_4                -3.357188e-03 1 1  ON 34
eH1_5                 3.200865e-02 1 1  ON 35
eH1_6                 9.327442e-02 1 1  ON 36
eH1_7                 1.552536e-01 1 1  ON 37
eH1_8                 1.953687e-01 1 1  ON 38
eH1_9                 9.686713e-02 1 1  ON 39
eH2_0                -2.533490e-01 1 1  ON 40
eH2_1                -1.517687e-01 1 1  ON 41
eH2_2                -1.044660e-01 1 1  ON 42
eH2_3                -4.972364e-02 1 1  ON 43
eH2_4                -1.010685e-03 1 1  ON 44
eH2_5                 3.370118e-02 1 1  ON 45
eH2_6                 9.499070e-02 1 1  ON 46
eH2_7                 1.556267e-01 1 1  ON 47
eH2_8                 1.983702e-01 1 1  ON 48
eH2_9                 9.065945e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.8903
    reference variance = 0.170326
====================================================
  Execution time = 2.1008e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3825e-01
  Total weights = 2.0000e+06
  Execution time = 2.3417e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338225049015
                                         uncertainty =       0.003789261217

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338225049015
                                         uncertainty =       0.003789261217

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411248289
  error estimate for blocks of size 2^( 2) =       0.000424023948
  error estimate for blocks of size 2^( 3) =       0.000437592195
  error estimate for blocks of size 2^( 4) =       0.000449867173
  error estimate for blocks of size 2^( 5) =       0.000460402381
  error estimate for blocks of size 2^( 6) =       0.000468164474
  error estimate for blocks of size 2^( 7) =       0.000474040199

      target function =                  N/A
              le_mean =     -16.905479152682
             les_mean =     286.133475522728
             stat err =       0.000463118557
             autocorr =       1.268166153940
              std dev =       0.581592907533
             le_variance =       0.338250310093

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338229577251
                                         uncertainty =       0.003789303604

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338229577251
                                         uncertainty =       0.003789303604

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411251041
  error estimate for blocks of size 2^( 2) =       0.000424026607
  error estimate for blocks of size 2^( 3) =       0.000437594787
  error estimate for blocks of size 2^( 4) =       0.000449869759
  error estimate for blocks of size 2^( 5) =       0.000460404799
  error estimate for blocks of size 2^( 6) =       0.000468166851
  error estimate for blocks of size 2^( 7) =       0.000474042442

      target function =                  N/A
              le_mean =     -16.905479111969
             les_mean =     286.133478673170
             stat err =       0.000463120963
             autocorr =       1.268162358628
              std dev =       0.581596799395
             le_variance =       0.338254837067

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338227364870
                                         uncertainty =       0.003789283505

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338227364870
                                         uncertainty =       0.003789283505

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411249696
  error estimate for blocks of size 2^( 2) =       0.000424025307
  error estimate for blocks of size 2^( 3) =       0.000437593519
  error estimate for blocks of size 2^( 4) =       0.000449868494
  error estimate for blocks of size 2^( 5) =       0.000460403617
  error estimate for blocks of size 2^( 6) =       0.000468165690
  error estimate for blocks of size 2^( 7) =       0.000474041349

      target function =                  N/A
              le_mean =     -16.905479131998
             les_mean =     286.133477138591
             stat err =       0.000463119788
             autocorr =       1.268164216384
              std dev =       0.581594897937
             le_variance =       0.338252625306

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338225340145
                                         uncertainty =       0.003789264040

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338225340145
                                         uncertainty =       0.003789264040

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411248466
  error estimate for blocks of size 2^( 2) =       0.000424024119
  error estimate for blocks of size 2^( 3) =       0.000437592361
  error estimate for blocks of size 2^( 4) =       0.000449867339
  error estimate for blocks of size 2^( 5) =       0.000460402536
  error estimate for blocks of size 2^( 6) =       0.000468164627
  error estimate for blocks of size 2^( 7) =       0.000474040343

      target function =                  N/A
              le_mean =     -16.905479150078
             les_mean =     286.133475725749
             stat err =       0.000463118711
             autocorr =       1.268165910431
              std dev =       0.581593157750
             le_variance =       0.338250601142


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905479152682        initial  <--
     9.0949e+00     9.0949e+01             2.0144e-05       -16.905479111969
     3.6380e+01     3.6380e+02             5.0479e-06       -16.905479131998
     1.4552e+02     1.4552e+03             1.2627e-06       -16.905479150078

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.0486
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.097514e-01 1 1  ON 0
 uu_1                 1.427004e-01 1 1  ON 1
 uu_2                 4.079299e-02 1 1  ON 2
 uu_3                -2.214901e-02 1 1  ON 3
 uu_4                -6.812022e-02 1 1  ON 4
 uu_5                -1.035982e-01 1 1  ON 5
 uu_6                -1.317566e-01 1 1  ON 6
 uu_7                -1.463451e-01 1 1  ON 7
 uu_8                -1.393095e-01 1 1  ON 8
 uu_9                -1.117280e-01 1 1  ON 9
 ud_0                 4.546837e-01 1 1  ON 10
 ud_1                 1.882348e-01 1 1  ON 11
 ud_2                 6.679585e-02 1 1  ON 12
 ud_3                -5.361712e-03 1 1  ON 13
 ud_4                -6.302050e-02 1 1  ON 14
 ud_5                -1.052772e-01 1 1  ON 15
 ud_6                -1.337478e-01 1 1  ON 16
 ud_7                -1.515601e-01 1 1  ON 17
 ud_8                -1.530823e-01 1 1  ON 18
 ud_9                -1.456179e-01 1 1  ON 19
 eO_0                -7.634078e-01 1 1  ON 20
 eO_1                -4.402771e-01 1 1  ON 21
 eO_2                -1.716400e-02 1 1  ON 22
 eO_3                 3.066803e-01 1 1  ON 23
 eO_4                 5.355706e-01 1 1  ON 24
 eO_5                 4.997884e-01 1 1  ON 25
 eO_6                 2.701615e-01 1 1  ON 26
 eO_7                -3.700358e-02 1 1  ON 27
 eO_8                -2.401797e-01 1 1  ON 28
 eO_9                -1.089625e-01 1 1  ON 29
eH1_0                -2.559756e-01 1 1  ON 30
eH1_1                -1.546505e-01 1 1  ON 31
eH1_2                -1.072923e-01 1 1  ON 32
eH1_3                -5.236672e-02 1 1  ON 33
eH1_4                -3.357208e-03 1 1  ON 34
eH1_5                 3.201053e-02 1 1  ON 35
eH1_6                 9.327650e-02 1 1  ON 36
eH1_7                 1.552540e-01 1 1  ON 37
eH1_8                 1.953656e-01 1 1  ON 38
eH1_9                 9.686209e-02 1 1  ON 39
eH2_0                -2.533493e-01 1 1  ON 40
eH2_1                -1.517675e-01 1 1  ON 41
eH2_2                -1.044647e-01 1 1  ON 42
eH2_3                -4.972270e-02 1 1  ON 43
eH2_4                -1.007052e-03 1 1  ON 44
eH2_5                 3.370164e-02 1 1  ON 45
eH2_6                 9.498948e-02 1 1  ON 46
eH2_7                 1.556271e-01 1 1  ON 47
eH2_8                 1.983700e-01 1 1  ON 48
eH2_9                 9.065448e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7057e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.9435
    reference variance = 0.217657
====================================================
  Execution time = 2.0534e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3620e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6700e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336306974842
                                         uncertainty =       0.002995395505

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336306974842
                                         uncertainty =       0.002995395505

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409999475
  error estimate for blocks of size 2^( 2) =       0.000423443703
  error estimate for blocks of size 2^( 3) =       0.000437407428
  error estimate for blocks of size 2^( 4) =       0.000450222029
  error estimate for blocks of size 2^( 5) =       0.000461013178
  error estimate for blocks of size 2^( 6) =       0.000468959752
  error estimate for blocks of size 2^( 7) =       0.000472819561

      target function =                  N/A
              le_mean =     -16.905711255157
             les_mean =     286.139272013834
             stat err =       0.000463253630
             autocorr =       1.276647682688
              std dev =       0.579826818265
             le_variance =       0.336199139179


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690571125516e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+01, overlap shift 9.0949e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905711255157       residual = 7.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905711261786       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905711269370       residual = 8.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905711270819       residual = 7.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905711271737       residual = 3.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905711273863       residual = 6.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905711272024       residual = 1.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905711271269       residual = 3.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+01 is 2.144714e-06

solving harmonic davidson linear method for identity shift 3.6380e+02, overlap shift 3.6380e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905711255157       residual = 7.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905711256817       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905711258717       residual = 8.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905711259079       residual = 7.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905711259309       residual = 3.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905711259840       residual = 6.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905711259383       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905711259193       residual = 3.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+02 is 5.363476e-07

solving harmonic davidson linear method for identity shift 1.4552e+03, overlap shift 1.4552e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905711255157       residual = 7.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905711255572       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905711256048       residual = 8.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905711256138       residual = 7.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905711256196       residual = 3.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905711256329       residual = 6.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905711256214       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905711256165       residual = 3.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+03 is 1.340975e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.214864 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6210e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.097511e-01 1 1  ON 0
 uu_1                 1.427002e-01 1 1  ON 1
 uu_2                 4.079321e-02 1 1  ON 2
 uu_3                -2.214887e-02 1 1  ON 3
 uu_4                -6.812020e-02 1 1  ON 4
 uu_5                -1.035978e-01 1 1  ON 5
 uu_6                -1.317570e-01 1 1  ON 6
 uu_7                -1.463452e-01 1 1  ON 7
 uu_8                -1.393096e-01 1 1  ON 8
 uu_9                -1.117280e-01 1 1  ON 9
 ud_0                 4.546834e-01 1 1  ON 10
 ud_1                 1.882349e-01 1 1  ON 11
 ud_2                 6.679562e-02 1 1  ON 12
 ud_3                -5.361693e-03 1 1  ON 13
 ud_4                -6.302084e-02 1 1  ON 14
 ud_5                -1.052771e-01 1 1  ON 15
 ud_6                -1.337478e-01 1 1  ON 16
 ud_7                -1.515600e-01 1 1  ON 17
 ud_8                -1.530819e-01 1 1  ON 18
 ud_9                -1.456177e-01 1 1  ON 19
 eO_0                -7.634076e-01 1 1  ON 20
 eO_1                -4.402773e-01 1 1  ON 21
 eO_2                -1.716410e-02 1 1  ON 22
 eO_3                 3.066808e-01 1 1  ON 23
 eO_4                 5.355705e-01 1 1  ON 24
 eO_5                 4.997884e-01 1 1  ON 25
 eO_6                 2.701617e-01 1 1  ON 26
 eO_7                -3.700357e-02 1 1  ON 27
 eO_8                -2.401799e-01 1 1  ON 28
 eO_9                -1.089628e-01 1 1  ON 29
eH1_0                -2.559761e-01 1 1  ON 30
eH1_1                -1.546504e-01 1 1  ON 31
eH1_2                -1.072925e-01 1 1  ON 32
eH1_3                -5.236700e-02 1 1  ON 33
eH1_4                -3.357076e-03 1 1  ON 34
eH1_5                 3.201051e-02 1 1  ON 35
eH1_6                 9.327632e-02 1 1  ON 36
eH1_7                 1.552541e-01 1 1  ON 37
eH1_8                 1.953660e-01 1 1  ON 38
eH1_9                 9.686253e-02 1 1  ON 39
eH2_0                -2.533495e-01 1 1  ON 40
eH2_1                -1.517678e-01 1 1  ON 41
eH2_2                -1.044650e-01 1 1  ON 42
eH2_3                -4.972265e-02 1 1  ON 43
eH2_4                -1.007133e-03 1 1  ON 44
eH2_5                 3.370142e-02 1 1  ON 45
eH2_6                 9.498959e-02 1 1  ON 46
eH2_7                 1.556273e-01 1 1  ON 47
eH2_8                 1.983700e-01 1 1  ON 48
eH2_9                 9.065501e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.8024
    reference variance = 0.231677
====================================================
  Execution time = 2.0101e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4267e-01
  Total weights = 2.0000e+06
  Execution time = 1.8780e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342769411705
                                         uncertainty =       0.003448612785

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342769411705
                                         uncertainty =       0.003448612785

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413925927
  error estimate for blocks of size 2^( 2) =       0.000426761836
  error estimate for blocks of size 2^( 3) =       0.000439584246
  error estimate for blocks of size 2^( 4) =       0.000451658469
  error estimate for blocks of size 2^( 5) =       0.000462573690
  error estimate for blocks of size 2^( 6) =       0.000470354510
  error estimate for blocks of size 2^( 7) =       0.000473361012

      target function =                  N/A
              le_mean =     -16.906503919853
             les_mean =     286.172543967146
             stat err =       0.000464486920
             autocorr =       1.259220303151
              std dev =       0.585379660100
             le_variance =       0.342669346459

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342768228490
                                         uncertainty =       0.003448610457

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342768228490
                                         uncertainty =       0.003448610457

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413925213
  error estimate for blocks of size 2^( 2) =       0.000426761164
  error estimate for blocks of size 2^( 3) =       0.000439583609
  error estimate for blocks of size 2^( 4) =       0.000451657856
  error estimate for blocks of size 2^( 5) =       0.000462573099
  error estimate for blocks of size 2^( 6) =       0.000470353928
  error estimate for blocks of size 2^( 7) =       0.000473360436

      target function =                  N/A
              le_mean =     -16.906503925921
             les_mean =     286.172542989400
             stat err =       0.000464486330
             autocorr =       1.259221448300
              std dev =       0.585378649729
             le_variance =       0.342668163558

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342768818055
                                         uncertainty =       0.003448611620

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342768818055
                                         uncertainty =       0.003448611620

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413925569
  error estimate for blocks of size 2^( 2) =       0.000426761498
  error estimate for blocks of size 2^( 3) =       0.000439583926
  error estimate for blocks of size 2^( 4) =       0.000451658161
  error estimate for blocks of size 2^( 5) =       0.000462573393
  error estimate for blocks of size 2^( 6) =       0.000470354218
  error estimate for blocks of size 2^( 7) =       0.000473360723

      target function =                  N/A
              le_mean =     -16.906503922887
             les_mean =     286.172543476211
             stat err =       0.000464486624
             autocorr =       1.259220877233
              std dev =       0.585379153170
             le_variance =       0.342668752966

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342769337432
                                         uncertainty =       0.003448612640

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342769337432
                                         uncertainty =       0.003448612640

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413925882
  error estimate for blocks of size 2^( 2) =       0.000426761794
  error estimate for blocks of size 2^( 3) =       0.000439584206
  error estimate for blocks of size 2^( 4) =       0.000451658430
  error estimate for blocks of size 2^( 5) =       0.000462573653
  error estimate for blocks of size 2^( 6) =       0.000470354474
  error estimate for blocks of size 2^( 7) =       0.000473360976

      target function =                  N/A
              le_mean =     -16.906503920232
             les_mean =     286.172543905699
             stat err =       0.000464486883
             autocorr =       1.259220374955
              std dev =       0.585379596677
             le_variance =       0.342669272205


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906503919853        initial
     9.0949e+01     9.0949e+02             2.1447e-06       -16.906503925921  <--
     3.6380e+02     3.6380e+03             5.3635e-07       -16.906503922887
     1.4552e+03     1.4552e+04             1.3410e-07       -16.906503920232

*****************************************************************************
Applying the update for shift_i =   9.0949e+01     and shift_s =   9.0949e+02
*****************************************************************************

  Execution time = 2.9526e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.097502e-01 1 1  ON 0
 uu_1                 1.426996e-01 1 1  ON 1
 uu_2                 4.079387e-02 1 1  ON 2
 uu_3                -2.214843e-02 1 1  ON 3
 uu_4                -6.812016e-02 1 1  ON 4
 uu_5                -1.035966e-01 1 1  ON 5
 uu_6                -1.317581e-01 1 1  ON 6
 uu_7                -1.463457e-01 1 1  ON 7
 uu_8                -1.393101e-01 1 1  ON 8
 uu_9                -1.117279e-01 1 1  ON 9
 ud_0                 4.546827e-01 1 1  ON 10
 ud_1                 1.882354e-01 1 1  ON 11
 ud_2                 6.679494e-02 1 1  ON 12
 ud_3                -5.361640e-03 1 1  ON 13
 ud_4                -6.302187e-02 1 1  ON 14
 ud_5                -1.052769e-01 1 1  ON 15
 ud_6                -1.337480e-01 1 1  ON 16
 ud_7                -1.515597e-01 1 1  ON 17
 ud_8                -1.530810e-01 1 1  ON 18
 ud_9                -1.456169e-01 1 1  ON 19
 eO_0                -7.634071e-01 1 1  ON 20
 eO_1                -4.402779e-01 1 1  ON 21
 eO_2                -1.716441e-02 1 1  ON 22
 eO_3                 3.066821e-01 1 1  ON 23
 eO_4                 5.355703e-01 1 1  ON 24
 eO_5                 4.997885e-01 1 1  ON 25
 eO_6                 2.701624e-01 1 1  ON 26
 eO_7                -3.700354e-02 1 1  ON 27
 eO_8                -2.401805e-01 1 1  ON 28
 eO_9                -1.089637e-01 1 1  ON 29
eH1_0                -2.559773e-01 1 1  ON 30
eH1_1                -1.546504e-01 1 1  ON 31
eH1_2                -1.072930e-01 1 1  ON 32
eH1_3                -5.236784e-02 1 1  ON 33
eH1_4                -3.356680e-03 1 1  ON 34
eH1_5                 3.201046e-02 1 1  ON 35
eH1_6                 9.327578e-02 1 1  ON 36
eH1_7                 1.552542e-01 1 1  ON 37
eH1_8                 1.953669e-01 1 1  ON 38
eH1_9                 9.686386e-02 1 1  ON 39
eH2_0                -2.533500e-01 1 1  ON 40
eH2_1                -1.517687e-01 1 1  ON 41
eH2_2                -1.044658e-01 1 1  ON 42
eH2_3                -4.972251e-02 1 1  ON 43
eH2_4                -1.007379e-03 1 1  ON 44
eH2_5                 3.370077e-02 1 1  ON 45
eH2_6                 9.498991e-02 1 1  ON 46
eH2_7                 1.556279e-01 1 1  ON 47
eH2_8                 1.983702e-01 1 1  ON 48
eH2_9                 9.065662e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5743e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.8068
    reference variance = 0.293737
====================================================
  Execution time = 2.0462e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5850e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6566e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.358583290403
                                         uncertainty =       0.012134969457

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.358583290403
                                         uncertainty =       0.012134969457

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000423380465
  error estimate for blocks of size 2^( 2) =       0.000435814604
  error estimate for blocks of size 2^( 3) =       0.000449052804
  error estimate for blocks of size 2^( 4) =       0.000461181168
  error estimate for blocks of size 2^( 5) =       0.000472013503
  error estimate for blocks of size 2^( 6) =       0.000480529202
  error estimate for blocks of size 2^( 7) =       0.000485297939

      target function =                  N/A
              le_mean =     -16.905984778145
             les_mean =     286.170823175243
             stat err =       0.000474755453
             autocorr =       1.257414002837
              std dev =       0.598750395086
             le_variance =       0.358502035615


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690598477815e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+01, overlap shift 2.2737e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905984778145       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905984783404       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905984790330       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905984774722       residual = 7.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905984769859       residual = 2.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905984778118       residual = 4.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905984779391       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905984778726       residual = 2.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.2737e+01 is 8.144128e-06

solving harmonic davidson linear method for identity shift 9.0949e+01, overlap shift 9.0949e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905984778145       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905984779469       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905984781215       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905984777261       residual = 8.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905984776006       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905984778088       residual = 4.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905984778439       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905984778231       residual = 2.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+01 is 2.038425e-06

solving harmonic davidson linear method for identity shift 3.6380e+02, overlap shift 3.6380e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905984778145       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905984778477       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905984778914       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905984777922       residual = 8.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905984777606       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905984778128       residual = 4.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905984778218       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905984778163       residual = 2.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+02 is 5.097540e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.217558 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6125e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.097498e-01 1 1  ON 0
 uu_1                 1.426988e-01 1 1  ON 1
 uu_2                 4.079399e-02 1 1  ON 2
 uu_3                -2.214858e-02 1 1  ON 3
 uu_4                -6.812040e-02 1 1  ON 4
 uu_5                -1.035963e-01 1 1  ON 5
 uu_6                -1.317583e-01 1 1  ON 6
 uu_7                -1.463445e-01 1 1  ON 7
 uu_8                -1.393099e-01 1 1  ON 8
 uu_9                -1.117288e-01 1 1  ON 9
 ud_0                 4.546816e-01 1 1  ON 10
 ud_1                 1.882364e-01 1 1  ON 11
 ud_2                 6.679621e-02 1 1  ON 12
 ud_3                -5.361534e-03 1 1  ON 13
 ud_4                -6.302245e-02 1 1  ON 14
 ud_5                -1.052769e-01 1 1  ON 15
 ud_6                -1.337485e-01 1 1  ON 16
 ud_7                -1.515593e-01 1 1  ON 17
 ud_8                -1.530810e-01 1 1  ON 18
 ud_9                -1.456170e-01 1 1  ON 19
 eO_0                -7.634064e-01 1 1  ON 20
 eO_1                -4.402774e-01 1 1  ON 21
 eO_2                -1.716459e-02 1 1  ON 22
 eO_3                 3.066828e-01 1 1  ON 23
 eO_4                 5.355713e-01 1 1  ON 24
 eO_5                 4.997875e-01 1 1  ON 25
 eO_6                 2.701628e-01 1 1  ON 26
 eO_7                -3.700305e-02 1 1  ON 27
 eO_8                -2.401814e-01 1 1  ON 28
 eO_9                -1.089651e-01 1 1  ON 29
eH1_0                -2.559783e-01 1 1  ON 30
eH1_1                -1.546516e-01 1 1  ON 31
eH1_2                -1.072929e-01 1 1  ON 32
eH1_3                -5.236820e-02 1 1  ON 33
eH1_4                -3.356395e-03 1 1  ON 34
eH1_5                 3.201026e-02 1 1  ON 35
eH1_6                 9.327591e-02 1 1  ON 36
eH1_7                 1.552539e-01 1 1  ON 37
eH1_8                 1.953675e-01 1 1  ON 38
eH1_9                 9.686575e-02 1 1  ON 39
eH2_0                -2.533498e-01 1 1  ON 40
eH2_1                -1.517705e-01 1 1  ON 41
eH2_2                -1.044674e-01 1 1  ON 42
eH2_3                -4.972424e-02 1 1  ON 43
eH2_4                -1.007939e-03 1 1  ON 44
eH2_5                 3.370221e-02 1 1  ON 45
eH2_6                 9.499032e-02 1 1  ON 46
eH2_7                 1.556284e-01 1 1  ON 47
eH2_8                 1.983710e-01 1 1  ON 48
eH2_9                 9.065866e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.8992
    reference variance = 0.195802
====================================================
  Execution time = 2.0513e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3982e-01
  Total weights = 2.0000e+06
  Execution time = 1.8899e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339860430033
                                         uncertainty =       0.003554094615

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339860430033
                                         uncertainty =       0.003554094615

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412204208
  error estimate for blocks of size 2^( 2) =       0.000424680339
  error estimate for blocks of size 2^( 3) =       0.000438112857
  error estimate for blocks of size 2^( 4) =       0.000451143757
  error estimate for blocks of size 2^( 5) =       0.000462802971
  error estimate for blocks of size 2^( 6) =       0.000470640170
  error estimate for blocks of size 2^( 7) =       0.000474817464

      target function =                  N/A
              le_mean =     -16.906405589570
             les_mean =     286.166374407042
             stat err =       0.000464851090
             autocorr =       1.271753280060
              std dev =       0.582944781193
             le_variance =       0.339824617921

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339851629383
                                         uncertainty =       0.003554001986

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339851629383
                                         uncertainty =       0.003554001986

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412198871
  error estimate for blocks of size 2^( 2) =       0.000424675296
  error estimate for blocks of size 2^( 3) =       0.000438108091
  error estimate for blocks of size 2^( 4) =       0.000451139150
  error estimate for blocks of size 2^( 5) =       0.000462798551
  error estimate for blocks of size 2^( 6) =       0.000470635828
  error estimate for blocks of size 2^( 7) =       0.000474813089

      target function =                  N/A
              le_mean =     -16.906405542311
             les_mean =     286.166364010067
             stat err =       0.000464846654
             autocorr =       1.271761935908
              std dev =       0.582937234098
             le_variance =       0.339815818898

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339855954131
                                         uncertainty =       0.003554047522

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339855954131
                                         uncertainty =       0.003554047522

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412201494
  error estimate for blocks of size 2^( 2) =       0.000424677774
  error estimate for blocks of size 2^( 3) =       0.000438110433
  error estimate for blocks of size 2^( 4) =       0.000451141415
  error estimate for blocks of size 2^( 5) =       0.000462800723
  error estimate for blocks of size 2^( 6) =       0.000470637962
  error estimate for blocks of size 2^( 7) =       0.000474815240

      target function =                  N/A
              le_mean =     -16.906405565474
             les_mean =     286.166369117218
             stat err =       0.000464848835
             autocorr =       1.271757687172
              std dev =       0.582940942839
             le_variance =       0.339820142838

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339859868107
                                         uncertainty =       0.003554088704

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339859868107
                                         uncertainty =       0.003554088704

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412203867
  error estimate for blocks of size 2^( 2) =       0.000424680017
  error estimate for blocks of size 2^( 3) =       0.000438112552
  error estimate for blocks of size 2^( 4) =       0.000451143463
  error estimate for blocks of size 2^( 5) =       0.000462802688
  error estimate for blocks of size 2^( 6) =       0.000470639893
  error estimate for blocks of size 2^( 7) =       0.000474817185

      target function =                  N/A
              le_mean =     -16.906405586539
             les_mean =     286.166373742739
             stat err =       0.000464850807
             autocorr =       1.271753833471
              std dev =       0.582944299309
             le_variance =       0.339824056097


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906405589570        initial  <--
     2.2737e+01     2.2737e+02             8.1441e-06       -16.906405542311
     9.0949e+01     9.0949e+02             2.0384e-06       -16.906405565474
     3.6380e+02     3.6380e+03             5.0975e-07       -16.906405586539

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9876
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.097502e-01 1 1  ON 0
 uu_1                 1.426996e-01 1 1  ON 1
 uu_2                 4.079387e-02 1 1  ON 2
 uu_3                -2.214843e-02 1 1  ON 3
 uu_4                -6.812016e-02 1 1  ON 4
 uu_5                -1.035966e-01 1 1  ON 5
 uu_6                -1.317581e-01 1 1  ON 6
 uu_7                -1.463457e-01 1 1  ON 7
 uu_8                -1.393101e-01 1 1  ON 8
 uu_9                -1.117279e-01 1 1  ON 9
 ud_0                 4.546827e-01 1 1  ON 10
 ud_1                 1.882354e-01 1 1  ON 11
 ud_2                 6.679494e-02 1 1  ON 12
 ud_3                -5.361640e-03 1 1  ON 13
 ud_4                -6.302187e-02 1 1  ON 14
 ud_5                -1.052769e-01 1 1  ON 15
 ud_6                -1.337480e-01 1 1  ON 16
 ud_7                -1.515597e-01 1 1  ON 17
 ud_8                -1.530810e-01 1 1  ON 18
 ud_9                -1.456169e-01 1 1  ON 19
 eO_0                -7.634071e-01 1 1  ON 20
 eO_1                -4.402779e-01 1 1  ON 21
 eO_2                -1.716441e-02 1 1  ON 22
 eO_3                 3.066821e-01 1 1  ON 23
 eO_4                 5.355703e-01 1 1  ON 24
 eO_5                 4.997885e-01 1 1  ON 25
 eO_6                 2.701624e-01 1 1  ON 26
 eO_7                -3.700354e-02 1 1  ON 27
 eO_8                -2.401805e-01 1 1  ON 28
 eO_9                -1.089637e-01 1 1  ON 29
eH1_0                -2.559773e-01 1 1  ON 30
eH1_1                -1.546504e-01 1 1  ON 31
eH1_2                -1.072930e-01 1 1  ON 32
eH1_3                -5.236784e-02 1 1  ON 33
eH1_4                -3.356680e-03 1 1  ON 34
eH1_5                 3.201046e-02 1 1  ON 35
eH1_6                 9.327578e-02 1 1  ON 36
eH1_7                 1.552542e-01 1 1  ON 37
eH1_8                 1.953669e-01 1 1  ON 38
eH1_9                 9.686386e-02 1 1  ON 39
eH2_0                -2.533500e-01 1 1  ON 40
eH2_1                -1.517687e-01 1 1  ON 41
eH2_2                -1.044658e-01 1 1  ON 42
eH2_3                -4.972251e-02 1 1  ON 43
eH2_4                -1.007379e-03 1 1  ON 44
eH2_5                 3.370077e-02 1 1  ON 45
eH2_6                 9.498991e-02 1 1  ON 46
eH2_7                 1.556279e-01 1 1  ON 47
eH2_8                 1.983702e-01 1 1  ON 48
eH2_9                 9.065662e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6120e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.8445
    reference variance = 0.360779
====================================================
  Execution time = 2.0807e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3921e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6224e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339272900072
                                         uncertainty =       0.003297407728

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339272900072
                                         uncertainty =       0.003297407728

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411833881
  error estimate for blocks of size 2^( 2) =       0.000424527510
  error estimate for blocks of size 2^( 3) =       0.000437464400
  error estimate for blocks of size 2^( 4) =       0.000450102022
  error estimate for blocks of size 2^( 5) =       0.000460736498
  error estimate for blocks of size 2^( 6) =       0.000468206874
  error estimate for blocks of size 2^( 7) =       0.000472477430

      target function =                  N/A
              le_mean =     -16.905904240662
             les_mean =     286.148812316488
             stat err =       0.000462880706
             autocorr =       1.263263685942
              std dev =       0.582421060454
             le_variance =       0.339214291660


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690590424066e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+02, overlap shift 2.2737e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905904240662       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905904239097       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905904238031       residual = 8.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905904237931       residual = 6.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905904236866       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905904238500       residual = 5.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905904238515       residual = 9.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.2737e+02 is 7.105360e-07

solving harmonic davidson linear method for identity shift 9.0949e+02, overlap shift 9.0949e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905904240662       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905904240271       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905904240003       residual = 8.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905904239978       residual = 6.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905904239711       residual = 2.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905904240119       residual = 5.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905904240123       residual = 9.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+02 is 1.776962e-07

solving harmonic davidson linear method for identity shift 3.6380e+03, overlap shift 3.6380e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905904240662       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905904240564       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905904240497       residual = 8.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905904240491       residual = 6.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905904240424       residual = 2.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905904240525       residual = 5.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905904240528       residual = 9.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+03 is 4.442793e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.219837 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6435e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.097502e-01 1 1  ON 0
 uu_1                 1.426997e-01 1 1  ON 1
 uu_2                 4.079391e-02 1 1  ON 2
 uu_3                -2.214836e-02 1 1  ON 3
 uu_4                -6.812018e-02 1 1  ON 4
 uu_5                -1.035964e-01 1 1  ON 5
 uu_6                -1.317581e-01 1 1  ON 6
 uu_7                -1.463459e-01 1 1  ON 7
 uu_8                -1.393102e-01 1 1  ON 8
 uu_9                -1.117280e-01 1 1  ON 9
 ud_0                 4.546827e-01 1 1  ON 10
 ud_1                 1.882354e-01 1 1  ON 11
 ud_2                 6.679485e-02 1 1  ON 12
 ud_3                -5.361548e-03 1 1  ON 13
 ud_4                -6.302195e-02 1 1  ON 14
 ud_5                -1.052769e-01 1 1  ON 15
 ud_6                -1.337479e-01 1 1  ON 16
 ud_7                -1.515596e-01 1 1  ON 17
 ud_8                -1.530810e-01 1 1  ON 18
 ud_9                -1.456169e-01 1 1  ON 19
 eO_0                -7.634071e-01 1 1  ON 20
 eO_1                -4.402778e-01 1 1  ON 21
 eO_2                -1.716437e-02 1 1  ON 22
 eO_3                 3.066820e-01 1 1  ON 23
 eO_4                 5.355704e-01 1 1  ON 24
 eO_5                 4.997887e-01 1 1  ON 25
 eO_6                 2.701625e-01 1 1  ON 26
 eO_7                -3.700359e-02 1 1  ON 27
 eO_8                -2.401806e-01 1 1  ON 28
 eO_9                -1.089639e-01 1 1  ON 29
eH1_0                -2.559774e-01 1 1  ON 30
eH1_1                -1.546505e-01 1 1  ON 31
eH1_2                -1.072930e-01 1 1  ON 32
eH1_3                -5.236784e-02 1 1  ON 33
eH1_4                -3.356661e-03 1 1  ON 34
eH1_5                 3.201043e-02 1 1  ON 35
eH1_6                 9.327575e-02 1 1  ON 36
eH1_7                 1.552543e-01 1 1  ON 37
eH1_8                 1.953670e-01 1 1  ON 38
eH1_9                 9.686403e-02 1 1  ON 39
eH2_0                -2.533502e-01 1 1  ON 40
eH2_1                -1.517687e-01 1 1  ON 41
eH2_2                -1.044659e-01 1 1  ON 42
eH2_3                -4.972256e-02 1 1  ON 43
eH2_4                -1.007226e-03 1 1  ON 44
eH2_5                 3.370063e-02 1 1  ON 45
eH2_6                 9.498993e-02 1 1  ON 46
eH2_7                 1.556280e-01 1 1  ON 47
eH2_8                 1.983702e-01 1 1  ON 48
eH2_9                 9.065675e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.905
    reference variance = 0.221426
====================================================
  Execution time = 2.0046e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3199e-01
  Total weights = 2.0000e+06
  Execution time = 1.8808e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331847711927
                                         uncertainty =       0.002309701297

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331847711927
                                         uncertainty =       0.002309701297

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407424569
  error estimate for blocks of size 2^( 2) =       0.000420566174
  error estimate for blocks of size 2^( 3) =       0.000433547315
  error estimate for blocks of size 2^( 4) =       0.000446574334
  error estimate for blocks of size 2^( 5) =       0.000459853220
  error estimate for blocks of size 2^( 6) =       0.000467632750
  error estimate for blocks of size 2^( 7) =       0.000474756034

      target function =                  N/A
              le_mean =     -16.905415007725
             les_mean =     286.125045976676
             stat err =       0.000462204084
             autocorr =       1.286983940667
              std dev =       0.576185351469
             le_variance =       0.331989559247

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331847810347
                                         uncertainty =       0.002309701571

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331847810347
                                         uncertainty =       0.002309701571

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407424630
  error estimate for blocks of size 2^( 2) =       0.000420566222
  error estimate for blocks of size 2^( 3) =       0.000433547351
  error estimate for blocks of size 2^( 4) =       0.000446574357
  error estimate for blocks of size 2^( 5) =       0.000459853236
  error estimate for blocks of size 2^( 6) =       0.000467632777
  error estimate for blocks of size 2^( 7) =       0.000474756066

      target function =                  N/A
              le_mean =     -16.905415007251
             les_mean =     286.125046058942
             stat err =       0.000462204109
             autocorr =       1.286983696128
              std dev =       0.576185436771
             le_variance =       0.331989657547

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331847761273
                                         uncertainty =       0.002309701435

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331847761273
                                         uncertainty =       0.002309701435

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407424599
  error estimate for blocks of size 2^( 2) =       0.000420566198
  error estimate for blocks of size 2^( 3) =       0.000433547333
  error estimate for blocks of size 2^( 4) =       0.000446574345
  error estimate for blocks of size 2^( 5) =       0.000459853228
  error estimate for blocks of size 2^( 6) =       0.000467632763
  error estimate for blocks of size 2^( 7) =       0.000474756050

      target function =                  N/A
              le_mean =     -16.905415007488
             les_mean =     286.125046017923
             stat err =       0.000462204097
             autocorr =       1.286983818089
              std dev =       0.576185394238
             le_variance =       0.331989608533

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331847718099
                                         uncertainty =       0.002309701315

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331847718099
                                         uncertainty =       0.002309701315

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407424573
  error estimate for blocks of size 2^( 2) =       0.000420566177
  error estimate for blocks of size 2^( 3) =       0.000433547318
  error estimate for blocks of size 2^( 4) =       0.000446574335
  error estimate for blocks of size 2^( 5) =       0.000459853221
  error estimate for blocks of size 2^( 6) =       0.000467632751
  error estimate for blocks of size 2^( 7) =       0.000474756036

      target function =                  N/A
              le_mean =     -16.905415007696
             les_mean =     286.125045981834
             stat err =       0.000462204086
             autocorr =       1.286983925342
              std dev =       0.576185356818
             le_variance =       0.331989565412


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905415007725        initial  <--
     2.2737e+02     2.2737e+03             7.1054e-07       -16.905415007251
     9.0949e+02     9.0949e+03             1.7770e-07       -16.905415007488
     3.6380e+03     3.6380e+04             4.4428e-08       -16.905415007696

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.4779
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.097502e-01 1 1  ON 0
 uu_1                 1.426996e-01 1 1  ON 1
 uu_2                 4.079387e-02 1 1  ON 2
 uu_3                -2.214843e-02 1 1  ON 3
 uu_4                -6.812016e-02 1 1  ON 4
 uu_5                -1.035966e-01 1 1  ON 5
 uu_6                -1.317581e-01 1 1  ON 6
 uu_7                -1.463457e-01 1 1  ON 7
 uu_8                -1.393101e-01 1 1  ON 8
 uu_9                -1.117279e-01 1 1  ON 9
 ud_0                 4.546827e-01 1 1  ON 10
 ud_1                 1.882354e-01 1 1  ON 11
 ud_2                 6.679494e-02 1 1  ON 12
 ud_3                -5.361640e-03 1 1  ON 13
 ud_4                -6.302187e-02 1 1  ON 14
 ud_5                -1.052769e-01 1 1  ON 15
 ud_6                -1.337480e-01 1 1  ON 16
 ud_7                -1.515597e-01 1 1  ON 17
 ud_8                -1.530810e-01 1 1  ON 18
 ud_9                -1.456169e-01 1 1  ON 19
 eO_0                -7.634071e-01 1 1  ON 20
 eO_1                -4.402779e-01 1 1  ON 21
 eO_2                -1.716441e-02 1 1  ON 22
 eO_3                 3.066821e-01 1 1  ON 23
 eO_4                 5.355703e-01 1 1  ON 24
 eO_5                 4.997885e-01 1 1  ON 25
 eO_6                 2.701624e-01 1 1  ON 26
 eO_7                -3.700354e-02 1 1  ON 27
 eO_8                -2.401805e-01 1 1  ON 28
 eO_9                -1.089637e-01 1 1  ON 29
eH1_0                -2.559773e-01 1 1  ON 30
eH1_1                -1.546504e-01 1 1  ON 31
eH1_2                -1.072930e-01 1 1  ON 32
eH1_3                -5.236784e-02 1 1  ON 33
eH1_4                -3.356680e-03 1 1  ON 34
eH1_5                 3.201046e-02 1 1  ON 35
eH1_6                 9.327578e-02 1 1  ON 36
eH1_7                 1.552542e-01 1 1  ON 37
eH1_8                 1.953669e-01 1 1  ON 38
eH1_9                 9.686386e-02 1 1  ON 39
eH2_0                -2.533500e-01 1 1  ON 40
eH2_1                -1.517687e-01 1 1  ON 41
eH2_2                -1.044658e-01 1 1  ON 42
eH2_3                -4.972251e-02 1 1  ON 43
eH2_4                -1.007379e-03 1 1  ON 44
eH2_5                 3.370077e-02 1 1  ON 45
eH2_6                 9.498991e-02 1 1  ON 46
eH2_7                 1.556279e-01 1 1  ON 47
eH2_8                 1.983702e-01 1 1  ON 48
eH2_9                 9.065662e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5921e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.8586
    reference variance = 0.303581
====================================================
  Execution time = 2.0905e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5643e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5245e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356568072803
                                         uncertainty =       0.019324708205

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356568072803
                                         uncertainty =       0.019324708205

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422157364
  error estimate for blocks of size 2^( 2) =       0.000434739634
  error estimate for blocks of size 2^( 3) =       0.000447556053
  error estimate for blocks of size 2^( 4) =       0.000459910199
  error estimate for blocks of size 2^( 5) =       0.000470390946
  error estimate for blocks of size 2^( 6) =       0.000478513239
  error estimate for blocks of size 2^( 7) =       0.000484601939

      target function =                  N/A
              le_mean =     -16.905892444819
             les_mean =     286.165632858032
             stat err =       0.000473354081
             autocorr =       1.257255406895
              std dev =       0.597020670042
             le_variance =       0.356433680457


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690589244482e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+03, overlap shift 2.2737e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905892444819       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905892444981       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905892444970       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905892445123       residual = 4.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905892445129       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905892445263       residual = 5.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905892445185       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905892445174       residual = 3.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.2737e+03 is 8.513121e-08

solving harmonic davidson linear method for identity shift 9.0949e+03, overlap shift 9.0949e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905892444819       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905892444860       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905892444857       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905892444895       residual = 4.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905892444899       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905892444930       residual = 5.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905892444909       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905892444908       residual = 3.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+03 is 2.128301e-08

solving harmonic davidson linear method for identity shift 3.6380e+04, overlap shift 3.6380e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905892444819       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905892444829       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905892444829       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905892444838       residual = 4.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905892444858       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905892444843       residual = 5.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905892444837       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905892444840       residual = 3.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+04 is 5.320767e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.222459 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6436e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.097502e-01 1 1  ON 0
 uu_1                 1.426996e-01 1 1  ON 1
 uu_2                 4.079386e-02 1 1  ON 2
 uu_3                -2.214843e-02 1 1  ON 3
 uu_4                -6.812017e-02 1 1  ON 4
 uu_5                -1.035966e-01 1 1  ON 5
 uu_6                -1.317581e-01 1 1  ON 6
 uu_7                -1.463457e-01 1 1  ON 7
 uu_8                -1.393100e-01 1 1  ON 8
 uu_9                -1.117279e-01 1 1  ON 9
 ud_0                 4.546827e-01 1 1  ON 10
 ud_1                 1.882354e-01 1 1  ON 11
 ud_2                 6.679494e-02 1 1  ON 12
 ud_3                -5.361641e-03 1 1  ON 13
 ud_4                -6.302188e-02 1 1  ON 14
 ud_5                -1.052769e-01 1 1  ON 15
 ud_6                -1.337480e-01 1 1  ON 16
 ud_7                -1.515597e-01 1 1  ON 17
 ud_8                -1.530810e-01 1 1  ON 18
 ud_9                -1.456169e-01 1 1  ON 19
 eO_0                -7.634071e-01 1 1  ON 20
 eO_1                -4.402779e-01 1 1  ON 21
 eO_2                -1.716441e-02 1 1  ON 22
 eO_3                 3.066821e-01 1 1  ON 23
 eO_4                 5.355703e-01 1 1  ON 24
 eO_5                 4.997886e-01 1 1  ON 25
 eO_6                 2.701624e-01 1 1  ON 26
 eO_7                -3.700354e-02 1 1  ON 27
 eO_8                -2.401805e-01 1 1  ON 28
 eO_9                -1.089637e-01 1 1  ON 29
eH1_0                -2.559773e-01 1 1  ON 30
eH1_1                -1.546504e-01 1 1  ON 31
eH1_2                -1.072930e-01 1 1  ON 32
eH1_3                -5.236784e-02 1 1  ON 33
eH1_4                -3.356675e-03 1 1  ON 34
eH1_5                 3.201045e-02 1 1  ON 35
eH1_6                 9.327578e-02 1 1  ON 36
eH1_7                 1.552542e-01 1 1  ON 37
eH1_8                 1.953669e-01 1 1  ON 38
eH1_9                 9.686387e-02 1 1  ON 39
eH2_0                -2.533500e-01 1 1  ON 40
eH2_1                -1.517687e-01 1 1  ON 41
eH2_2                -1.044658e-01 1 1  ON 42
eH2_3                -4.972252e-02 1 1  ON 43
eH2_4                -1.007370e-03 1 1  ON 44
eH2_5                 3.370077e-02 1 1  ON 45
eH2_6                 9.498992e-02 1 1  ON 46
eH2_7                 1.556279e-01 1 1  ON 47
eH2_8                 1.983702e-01 1 1  ON 48
eH2_9                 9.065664e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.9861
    reference variance = 0.463792
====================================================
  Execution time = 2.0601e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4656e-01
  Total weights = 2.0000e+06
  Execution time = 1.8837e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346588146558
                                         uncertainty =       0.004168401847

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346588146558
                                         uncertainty =       0.004168401847

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416267926
  error estimate for blocks of size 2^( 2) =       0.000428521963
  error estimate for blocks of size 2^( 3) =       0.000441346315
  error estimate for blocks of size 2^( 4) =       0.000453497198
  error estimate for blocks of size 2^( 5) =       0.000464013526
  error estimate for blocks of size 2^( 6) =       0.000470435735
  error estimate for blocks of size 2^( 7) =       0.000475450836

      target function =                  N/A
              le_mean =     -16.906544565386
             les_mean =     286.177806940720
             stat err =       0.000465849324
             autocorr =       1.252405714049
              std dev =       0.588691746690
             le_variance =       0.346557972621

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346588171703
                                         uncertainty =       0.004168402228

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346588171703
                                         uncertainty =       0.004168402228

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416267941
  error estimate for blocks of size 2^( 2) =       0.000428521977
  error estimate for blocks of size 2^( 3) =       0.000441346329
  error estimate for blocks of size 2^( 4) =       0.000453497212
  error estimate for blocks of size 2^( 5) =       0.000464013541
  error estimate for blocks of size 2^( 6) =       0.000470435748
  error estimate for blocks of size 2^( 7) =       0.000475450850

      target function =                  N/A
              le_mean =     -16.906544565086
             les_mean =     286.177806955736
             stat err =       0.000465849338
             autocorr =       1.252405698117
              std dev =       0.588691768066
             le_variance =       0.346557997789

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346588159131
                                         uncertainty =       0.004168402037

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346588159131
                                         uncertainty =       0.004168402037

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416267934
  error estimate for blocks of size 2^( 2) =       0.000428521970
  error estimate for blocks of size 2^( 3) =       0.000441346322
  error estimate for blocks of size 2^( 4) =       0.000453497205
  error estimate for blocks of size 2^( 5) =       0.000464013534
  error estimate for blocks of size 2^( 6) =       0.000470435741
  error estimate for blocks of size 2^( 7) =       0.000475450843

      target function =                  N/A
              le_mean =     -16.906544565236
             les_mean =     286.177806948228
             stat err =       0.000465849331
             autocorr =       1.252405706090
              std dev =       0.588691757379
             le_variance =       0.346557985205

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346588148130
                                         uncertainty =       0.004168401871

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346588148130
                                         uncertainty =       0.004168401871

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416267927
  error estimate for blocks of size 2^( 2) =       0.000428521964
  error estimate for blocks of size 2^( 3) =       0.000441346316
  error estimate for blocks of size 2^( 4) =       0.000453497199
  error estimate for blocks of size 2^( 5) =       0.000464013527
  error estimate for blocks of size 2^( 6) =       0.000470435735
  error estimate for blocks of size 2^( 7) =       0.000475450837

      target function =                  N/A
              le_mean =     -16.906544565367
             les_mean =     286.177806941659
             stat err =       0.000465849325
             autocorr =       1.252405713052
              std dev =       0.588691748026
             le_variance =       0.346557974194


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906544565386        initial  <--
     2.2737e+03     2.2737e+04             8.5131e-08       -16.906544565086
     9.0949e+03     9.0949e+04             2.1283e-08       -16.906544565236
     3.6380e+04     3.6380e+05             5.3208e-09       -16.906544565367

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.0496
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.097502e-01 1 1  ON 0
 uu_1                 1.426996e-01 1 1  ON 1
 uu_2                 4.079387e-02 1 1  ON 2
 uu_3                -2.214843e-02 1 1  ON 3
 uu_4                -6.812016e-02 1 1  ON 4
 uu_5                -1.035966e-01 1 1  ON 5
 uu_6                -1.317581e-01 1 1  ON 6
 uu_7                -1.463457e-01 1 1  ON 7
 uu_8                -1.393101e-01 1 1  ON 8
 uu_9                -1.117279e-01 1 1  ON 9
 ud_0                 4.546827e-01 1 1  ON 10
 ud_1                 1.882354e-01 1 1  ON 11
 ud_2                 6.679494e-02 1 1  ON 12
 ud_3                -5.361640e-03 1 1  ON 13
 ud_4                -6.302187e-02 1 1  ON 14
 ud_5                -1.052769e-01 1 1  ON 15
 ud_6                -1.337480e-01 1 1  ON 16
 ud_7                -1.515597e-01 1 1  ON 17
 ud_8                -1.530810e-01 1 1  ON 18
 ud_9                -1.456169e-01 1 1  ON 19
 eO_0                -7.634071e-01 1 1  ON 20
 eO_1                -4.402779e-01 1 1  ON 21
 eO_2                -1.716441e-02 1 1  ON 22
 eO_3                 3.066821e-01 1 1  ON 23
 eO_4                 5.355703e-01 1 1  ON 24
 eO_5                 4.997885e-01 1 1  ON 25
 eO_6                 2.701624e-01 1 1  ON 26
 eO_7                -3.700354e-02 1 1  ON 27
 eO_8                -2.401805e-01 1 1  ON 28
 eO_9                -1.089637e-01 1 1  ON 29
eH1_0                -2.559773e-01 1 1  ON 30
eH1_1                -1.546504e-01 1 1  ON 31
eH1_2                -1.072930e-01 1 1  ON 32
eH1_3                -5.236784e-02 1 1  ON 33
eH1_4                -3.356680e-03 1 1  ON 34
eH1_5                 3.201046e-02 1 1  ON 35
eH1_6                 9.327578e-02 1 1  ON 36
eH1_7                 1.552542e-01 1 1  ON 37
eH1_8                 1.953669e-01 1 1  ON 38
eH1_9                 9.686386e-02 1 1  ON 39
eH2_0                -2.533500e-01 1 1  ON 40
eH2_1                -1.517687e-01 1 1  ON 41
eH2_2                -1.044658e-01 1 1  ON 42
eH2_3                -4.972251e-02 1 1  ON 43
eH2_4                -1.007379e-03 1 1  ON 44
eH2_5                 3.370077e-02 1 1  ON 45
eH2_6                 9.498991e-02 1 1  ON 46
eH2_7                 1.556279e-01 1 1  ON 47
eH2_8                 1.983702e-01 1 1  ON 48
eH2_9                 9.065662e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6495e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.8735
    reference variance = 0.202041
====================================================
  Execution time = 2.0592e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3844e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6043e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338591742181
                                         uncertainty =       0.003567665577

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338591742181
                                         uncertainty =       0.003567665577

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411365825
  error estimate for blocks of size 2^( 2) =       0.000424102690
  error estimate for blocks of size 2^( 3) =       0.000436346418
  error estimate for blocks of size 2^( 4) =       0.000447919004
  error estimate for blocks of size 2^( 5) =       0.000457364981
  error estimate for blocks of size 2^( 6) =       0.000463282720
  error estimate for blocks of size 2^( 7) =       0.000464258126

      target function =                  N/A
              le_mean =     -16.906912179472
             les_mean =     286.182122958648
             stat err =       0.000458206208
             autocorr =       1.240696394473
              std dev =       0.581759128417
             le_variance =       0.338443683497


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690691217947e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+04, overlap shift 2.2737e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906912179472       residual = 7.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906912179514       residual = 7.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906912179539       residual = 3.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906912179545       residual = 5.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906912179549       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906912179538       residual = 3.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906912179551       residual = 5.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.2737e+04 is 7.293687e-09

solving harmonic davidson linear method for identity shift 9.0949e+04, overlap shift 9.0949e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906912179472       residual = 7.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906912179482       residual = 7.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906912179489       residual = 3.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906912179486       residual = 5.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906912179587       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906912179491       residual = 3.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906912179491       residual = 5.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+04 is 1.823424e-09

solving harmonic davidson linear method for identity shift 3.6380e+05, overlap shift 3.6380e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906912179472       residual = 7.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906912179474       residual = 7.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906912179476       residual = 3.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906912179476       residual = 5.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906912179375       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906912179582       residual = 3.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906912179467       residual = 5.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+05 is 4.558561e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.224742 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6203e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.097502e-01 1 1  ON 0
 uu_1                 1.426996e-01 1 1  ON 1
 uu_2                 4.079387e-02 1 1  ON 2
 uu_3                -2.214843e-02 1 1  ON 3
 uu_4                -6.812016e-02 1 1  ON 4
 uu_5                -1.035966e-01 1 1  ON 5
 uu_6                -1.317581e-01 1 1  ON 6
 uu_7                -1.463457e-01 1 1  ON 7
 uu_8                -1.393101e-01 1 1  ON 8
 uu_9                -1.117279e-01 1 1  ON 9
 ud_0                 4.546827e-01 1 1  ON 10
 ud_1                 1.882354e-01 1 1  ON 11
 ud_2                 6.679494e-02 1 1  ON 12
 ud_3                -5.361639e-03 1 1  ON 13
 ud_4                -6.302187e-02 1 1  ON 14
 ud_5                -1.052769e-01 1 1  ON 15
 ud_6                -1.337480e-01 1 1  ON 16
 ud_7                -1.515597e-01 1 1  ON 17
 ud_8                -1.530810e-01 1 1  ON 18
 ud_9                -1.456169e-01 1 1  ON 19
 eO_0                -7.634071e-01 1 1  ON 20
 eO_1                -4.402779e-01 1 1  ON 21
 eO_2                -1.716441e-02 1 1  ON 22
 eO_3                 3.066821e-01 1 1  ON 23
 eO_4                 5.355703e-01 1 1  ON 24
 eO_5                 4.997885e-01 1 1  ON 25
 eO_6                 2.701624e-01 1 1  ON 26
 eO_7                -3.700354e-02 1 1  ON 27
 eO_8                -2.401805e-01 1 1  ON 28
 eO_9                -1.089637e-01 1 1  ON 29
eH1_0                -2.559773e-01 1 1  ON 30
eH1_1                -1.546504e-01 1 1  ON 31
eH1_2                -1.072930e-01 1 1  ON 32
eH1_3                -5.236784e-02 1 1  ON 33
eH1_4                -3.356680e-03 1 1  ON 34
eH1_5                 3.201046e-02 1 1  ON 35
eH1_6                 9.327578e-02 1 1  ON 36
eH1_7                 1.552542e-01 1 1  ON 37
eH1_8                 1.953669e-01 1 1  ON 38
eH1_9                 9.686386e-02 1 1  ON 39
eH2_0                -2.533500e-01 1 1  ON 40
eH2_1                -1.517687e-01 1 1  ON 41
eH2_2                -1.044658e-01 1 1  ON 42
eH2_3                -4.972251e-02 1 1  ON 43
eH2_4                -1.007378e-03 1 1  ON 44
eH2_5                 3.370077e-02 1 1  ON 45
eH2_6                 9.498991e-02 1 1  ON 46
eH2_7                 1.556279e-01 1 1  ON 47
eH2_8                 1.983702e-01 1 1  ON 48
eH2_9                 9.065662e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.8299
    reference variance = 0.344512
====================================================
  Execution time = 2.0167e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3953e-01
  Total weights = 2.0000e+06
  Execution time = 1.8911e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339436747601
                                         uncertainty =       0.003567394841

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339436747601
                                         uncertainty =       0.003567394841

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412024501
  error estimate for blocks of size 2^( 2) =       0.000424828564
  error estimate for blocks of size 2^( 3) =       0.000438210935
  error estimate for blocks of size 2^( 4) =       0.000450159622
  error estimate for blocks of size 2^( 5) =       0.000460990536
  error estimate for blocks of size 2^( 6) =       0.000466857451
  error estimate for blocks of size 2^( 7) =       0.000472974154

      target function =                  N/A
              le_mean =     -16.906338050581
             les_mean =     286.163794490076
             stat err =       0.000462745441
             autocorr =       1.261357553746
              std dev =       0.582690637740
             le_variance =       0.339528379310

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339436739328
                                         uncertainty =       0.003567394753

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339436739328
                                         uncertainty =       0.003567394753

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412024496
  error estimate for blocks of size 2^( 2) =       0.000424828559
  error estimate for blocks of size 2^( 3) =       0.000438210930
  error estimate for blocks of size 2^( 4) =       0.000450159618
  error estimate for blocks of size 2^( 5) =       0.000460990532
  error estimate for blocks of size 2^( 6) =       0.000466857447
  error estimate for blocks of size 2^( 7) =       0.000472974150

      target function =                  N/A
              le_mean =     -16.906338050580
             les_mean =     286.163794481760
             stat err =       0.000462745437
             autocorr =       1.261357562068
              std dev =       0.582690630639
             le_variance =       0.339528371035

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339436743464
                                         uncertainty =       0.003567394797

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339436743464
                                         uncertainty =       0.003567394797

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412024499
  error estimate for blocks of size 2^( 2) =       0.000424828562
  error estimate for blocks of size 2^( 3) =       0.000438210932
  error estimate for blocks of size 2^( 4) =       0.000450159620
  error estimate for blocks of size 2^( 5) =       0.000460990534
  error estimate for blocks of size 2^( 6) =       0.000466857449
  error estimate for blocks of size 2^( 7) =       0.000472974152

      target function =                  N/A
              le_mean =     -16.906338050581
             les_mean =     286.163794485918
             stat err =       0.000462745439
             autocorr =       1.261357557908
              std dev =       0.582690634190
             le_variance =       0.339528375172

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339436747084
                                         uncertainty =       0.003567394836

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339436747084
                                         uncertainty =       0.003567394836

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412024501
  error estimate for blocks of size 2^( 2) =       0.000424828564
  error estimate for blocks of size 2^( 3) =       0.000438210934
  error estimate for blocks of size 2^( 4) =       0.000450159622
  error estimate for blocks of size 2^( 5) =       0.000460990536
  error estimate for blocks of size 2^( 6) =       0.000466857451
  error estimate for blocks of size 2^( 7) =       0.000472974154

      target function =                  N/A
              le_mean =     -16.906338050581
             les_mean =     286.163794489556
             stat err =       0.000462745441
             autocorr =       1.261357554271
              std dev =       0.582690637296
             le_variance =       0.339528378793


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906338050581        initial  <--
     2.2737e+04     2.2737e+05             7.2937e-09       -16.906338050580
     9.0949e+04     9.0949e+05             1.8234e-09       -16.906338050581
     3.6380e+05     3.6380e+06             4.5586e-10       -16.906338050581

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6509
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.097502e-01 1 1  ON 0
 uu_1                 1.426996e-01 1 1  ON 1
 uu_2                 4.079387e-02 1 1  ON 2
 uu_3                -2.214843e-02 1 1  ON 3
 uu_4                -6.812016e-02 1 1  ON 4
 uu_5                -1.035966e-01 1 1  ON 5
 uu_6                -1.317581e-01 1 1  ON 6
 uu_7                -1.463457e-01 1 1  ON 7
 uu_8                -1.393101e-01 1 1  ON 8
 uu_9                -1.117279e-01 1 1  ON 9
 ud_0                 4.546827e-01 1 1  ON 10
 ud_1                 1.882354e-01 1 1  ON 11
 ud_2                 6.679494e-02 1 1  ON 12
 ud_3                -5.361640e-03 1 1  ON 13
 ud_4                -6.302187e-02 1 1  ON 14
 ud_5                -1.052769e-01 1 1  ON 15
 ud_6                -1.337480e-01 1 1  ON 16
 ud_7                -1.515597e-01 1 1  ON 17
 ud_8                -1.530810e-01 1 1  ON 18
 ud_9                -1.456169e-01 1 1  ON 19
 eO_0                -7.634071e-01 1 1  ON 20
 eO_1                -4.402779e-01 1 1  ON 21
 eO_2                -1.716441e-02 1 1  ON 22
 eO_3                 3.066821e-01 1 1  ON 23
 eO_4                 5.355703e-01 1 1  ON 24
 eO_5                 4.997885e-01 1 1  ON 25
 eO_6                 2.701624e-01 1 1  ON 26
 eO_7                -3.700354e-02 1 1  ON 27
 eO_8                -2.401805e-01 1 1  ON 28
 eO_9                -1.089637e-01 1 1  ON 29
eH1_0                -2.559773e-01 1 1  ON 30
eH1_1                -1.546504e-01 1 1  ON 31
eH1_2                -1.072930e-01 1 1  ON 32
eH1_3                -5.236784e-02 1 1  ON 33
eH1_4                -3.356680e-03 1 1  ON 34
eH1_5                 3.201046e-02 1 1  ON 35
eH1_6                 9.327578e-02 1 1  ON 36
eH1_7                 1.552542e-01 1 1  ON 37
eH1_8                 1.953669e-01 1 1  ON 38
eH1_9                 9.686386e-02 1 1  ON 39
eH2_0                -2.533500e-01 1 1  ON 40
eH2_1                -1.517687e-01 1 1  ON 41
eH2_2                -1.044658e-01 1 1  ON 42
eH2_3                -4.972251e-02 1 1  ON 43
eH2_4                -1.007379e-03 1 1  ON 44
eH2_5                 3.370077e-02 1 1  ON 45
eH2_6                 9.498991e-02 1 1  ON 46
eH2_7                 1.556279e-01 1 1  ON 47
eH2_8                 1.983702e-01 1 1  ON 48
eH2_9                 9.065662e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5861e+01 secs
  Total Execution time = 2.2494e+03 secs

=========================================================
  A new xml input file : H2O.s039.cont.xml
