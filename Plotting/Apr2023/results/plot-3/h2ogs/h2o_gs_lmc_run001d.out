Rank =    0  Free Memory = 89419 MB
Rank =    1  Free Memory = 89419 MB
Rank =    2  Free Memory = 89419 MB
Rank =    3  Free Memory = 89419 MB
Rank =    4  Free Memory = 89419 MB
Rank =    5  Free Memory = 89419 MB
Rank =    6  Free Memory = 89419 MB
Rank =    7  Free Memory = 89418 MB
Rank =    8  Free Memory = 89418 MB
Rank =    9  Free Memory = 89418 MB
Rank =   10  Free Memory = 89418 MB
Rank =   11  Free Memory = 89418 MB
Rank =   12  Free Memory = 89418 MB
Rank =   13  Free Memory = 89418 MB
Rank =   14  Free Memory = 89417 MB
Rank =   15  Free Memory = 89403 MB
Rank =   16  Free Memory = 89403 MB
Rank =   17  Free Memory = 89403 MB
Rank =   18  Free Memory = 89403 MB
Rank =   19  Free Memory = 89403 MB
Rank =   20  Free Memory = 89403 MB
Rank =   21  Free Memory = 89403 MB
Rank =   22  Free Memory = 89403 MB
Rank =   23  Free Memory = 89403 MB
Rank =   24  Free Memory = 89403 MB
Rank =   25  Free Memory = 89403 MB
Rank =   26  Free Memory = 89403 MB
Rank =   27  Free Memory = 89403 MB
Rank =   28  Free Memory = 89403 MB
Rank =   29  Free Memory = 89403 MB
Rank =   30  Free Memory = 89403 MB
Rank =   31  Free Memory = 89403 MB
Rank =   32  Free Memory = 90685 MB
Rank =   33  Free Memory = 90685 MB
Rank =   34  Free Memory = 90685 MB
Rank =   35  Free Memory = 90685 MB
Rank =   36  Free Memory = 90685 MB
Rank =   37  Free Memory = 90685 MB
Rank =   38  Free Memory = 90685 MB
Rank =   39  Free Memory = 90685 MB
Rank =   40  Free Memory = 90685 MB
Rank =   41  Free Memory = 90685 MB
Rank =   42  Free Memory = 90685 MB
Rank =   43  Free Memory = 90685 MB
Rank =   44  Free Memory = 90685 MB
Rank =   45  Free Memory = 90685 MB
Rank =   46  Free Memory = 90685 MB
Rank =   47  Free Memory = 90685 MB
Rank =   48  Free Memory = 90685 MB
Rank =   49  Free Memory = 90685 MB
Rank =   50  Free Memory = 90685 MB
Rank =   51  Free Memory = 90685 MB
Rank =   52  Free Memory = 90684 MB
Rank =   53  Free Memory = 90684 MB
Rank =   54  Free Memory = 90684 MB
Rank =   55  Free Memory = 90684 MB
Rank =   56  Free Memory = 90684 MB
Rank =   57  Free Memory = 90684 MB
Rank =   58  Free Memory = 90684 MB
Rank =   59  Free Memory = 90684 MB
Rank =   60  Free Memory = 90684 MB
Rank =   61  Free Memory = 90684 MB
Rank =   62  Free Memory = 90684 MB
Rank =   63  Free Memory = 90684 MB
Rank =   64  Free Memory = 90260 MB
Rank =   65  Free Memory = 90260 MB
Rank =   66  Free Memory = 90260 MB
Rank =   67  Free Memory = 90260 MB
Rank =   68  Free Memory = 90260 MB
Rank =   69  Free Memory = 90260 MB
Rank =   70  Free Memory = 90260 MB
Rank =   71  Free Memory = 90260 MB
Rank =   72  Free Memory = 90260 MB
Rank =   73  Free Memory = 90260 MB
Rank =   74  Free Memory = 90260 MB
Rank =   75  Free Memory = 90260 MB
Rank =   76  Free Memory = 90260 MB
Rank =   77  Free Memory = 90260 MB
Rank =   78  Free Memory = 90260 MB
Rank =   79  Free Memory = 90260 MB
Rank =   80  Free Memory = 90260 MB
Rank =   81  Free Memory = 90260 MB
Rank =   82  Free Memory = 90260 MB
Rank =   83  Free Memory = 90260 MB
Rank =   84  Free Memory = 90260 MB
Rank =   85  Free Memory = 90260 MB
Rank =   86  Free Memory = 90260 MB
Rank =   87  Free Memory = 90260 MB
Rank =   88  Free Memory = 90260 MB
Rank =   89  Free Memory = 90260 MB
Rank =   90  Free Memory = 90260 MB
Rank =   91  Free Memory = 90260 MB
Rank =   92  Free Memory = 90260 MB
Rank =   93  Free Memory = 90260 MB
Rank =   94  Free Memory = 90260 MB
Rank =   95  Free Memory = 90260 MB
Rank =   96  Free Memory = 69947 MB
Rank =   97  Free Memory = 69947 MB
Rank =   98  Free Memory = 69947 MB
Rank =   99  Free Memory = 69947 MB
Rank =  100  Free Memory = 69947 MB
Rank =  101  Free Memory = 69947 MB
Rank =  102  Free Memory = 69947 MB
Rank =  103  Free Memory = 69947 MB
Rank =  104  Free Memory = 69947 MB
Rank =  105  Free Memory = 69947 MB
Rank =  106  Free Memory = 69947 MB
Rank =  107  Free Memory = 69947 MB
Rank =  108  Free Memory = 69947 MB
Rank =  109  Free Memory = 69947 MB
Rank =  110  Free Memory = 69947 MB
Rank =  111  Free Memory = 69947 MB
Rank =  112  Free Memory = 69947 MB
Rank =  113  Free Memory = 69947 MB
Rank =  114  Free Memory = 69947 MB
Rank =  115  Free Memory = 69947 MB
Rank =  116  Free Memory = 69947 MB
Rank =  117  Free Memory = 69947 MB
Rank =  118  Free Memory = 69947 MB
Rank =  119  Free Memory = 69947 MB
Rank =  120  Free Memory = 69947 MB
Rank =  121  Free Memory = 69947 MB
Rank =  122  Free Memory = 69947 MB
Rank =  123  Free Memory = 69947 MB
Rank =  124  Free Memory = 69947 MB
Rank =  125  Free Memory = 69947 MB
Rank =  126  Free Memory = 69947 MB
Rank =  127  Free Memory = 69947 MB
  Input file(s): opt_h2o_gs_lmc_run001d.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: a1d851bbe8d902a0d3168a885b757a378aeaab54-dirty
  Last git commit date: Mon Feb 13 11:52:39 2023 -0800
  Last git commit subject: Print param update magnitude and largest update
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_gs_lmc_run001d.xml

  Project = H2O
  date    = 2023-03-03 17:35:01 PST
  host    = n0024.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 69

  Range of prime numbers to use as seeds over processors and threads = 353-1217


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 2.052136e-01    1         1  ON     0
     uu_1                 4.496582e-02    1         1  ON     1
     uu_2                -4.694820e-02    1         1  ON     2
     uu_3                -9.928724e-02    1         1  ON     3
     uu_4                -1.300218e-01    1         1  ON     4
     uu_5                -1.354295e-01    1         1  ON     5
     uu_6                -1.124488e-01    1         1  ON     6
     uu_7                -3.914577e-02    1         1  ON     7
     uu_8                 1.001571e-01    1         1  ON     8
     uu_9                 1.206276e-01    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 3.487459e-01    1         1  ON     0
     ud_1                 9.116411e-02    1         1  ON     1
     ud_2                -1.671341e-02    1         1  ON     2
     ud_3                -7.581002e-02    1         1  ON     3
     ud_4                -1.214661e-01    1         1  ON     4
     ud_5                -1.518192e-01    1         1  ON     5
     ud_6                -1.542888e-01    1         1  ON     6
     ud_7                -1.096708e-01    1         1  ON     7
     ud_8                 4.959319e-03    1         1  ON     8
     ud_9                 9.253544e-02    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -7.473680e-01    1         1  ON     0
     eO_1                -4.334710e-01    1         1  ON     1
     eO_2                -3.549295e-02    1         1  ON     2
     eO_3                 2.067973e-01    1         1  ON     3
     eO_4                 2.862830e-01    1         1  ON     4
     eO_5                 3.046199e-01    1         1  ON     5
     eO_6                 2.500150e-01    1         1  ON     6
     eO_7                 1.117584e-01    1         1  ON     7
     eO_8                 2.784044e-02    1         1  ON     8
     eO_9                 1.841217e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -1.820127e-01    1         1  ON     0
     eH1_1                -1.025653e-01    1         1  ON     1
     eH1_2                -6.218795e-02    1         1  ON     2
     eH1_3                -2.596953e-02    1         1  ON     3
     eH1_4                 1.934744e-02    1         1  ON     4
     eH1_5                 3.564688e-02    1         1  ON     5
     eH1_6                 7.727447e-02    1         1  ON     6
     eH1_7                 1.104605e-01    1         1  ON     7
     eH1_8                 9.054904e-02    1         1  ON     8
     eH1_9                 2.423150e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -1.832679e-01    1         1  ON     0
     eH2_1                -1.036076e-01    1         1  ON     1
     eH2_2                -6.357570e-02    1         1  ON     2
     eH2_3                -2.732766e-02    1         1  ON     3
     eH2_4                 1.829809e-02    1         1  ON     4
     eH2_5                 3.518885e-02    1         1  ON     5
     eH2_6                 7.840011e-02    1         1  ON     6
     eH2_7                 1.136377e-01    1         1  ON     7
     eH2_8                 9.374952e-02    1         1  ON     8
     eH2_9                 2.630206e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 70 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 9.708665e-01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 26 unique up determinants.
Found 26 unique down determinants.
Number of terms in pairs array: 22
Number of terms in pairs array: 22
CI coefficients are optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 1.8897e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u -2.1647635618e-01 -6.7439216895e-01  1.9880537318e-01
    u -8.6004520714e-01 -3.1964226924e-01  6.9171823675e-02
    u -1.1165451895e+00 -5.3850544216e-01 -4.9152162246e-01
    u -4.0992137844e-01  2.3431241626e+00  1.4534834924e+00
    d -6.4716027047e-02 -8.0296334917e-01 -7.3676750950e-01
    d -4.9793133381e-01 -5.0450915047e-01 -7.6892777308e-01
    d  1.5908260425e-01  3.7531282770e-01 -1.4289189837e-01
    d -1.4507602779e-01 -1.2740118097e+00  2.0922709319e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 100
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 119
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.2913
    reference variance = 0.401684
====================================================
  Execution time = 3.8663e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5267e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1282e-01
  Total weights = 1.956641933e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1008e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298421057160
                                         uncertainty =       0.002294029033

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298421057160
                                         uncertainty =       0.002294029033

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386262925
  error estimate for blocks of size 2^( 2) =       0.000396344830
  error estimate for blocks of size 2^( 3) =       0.000405663122
  error estimate for blocks of size 2^( 4) =       0.000413322949
  error estimate for blocks of size 2^( 5) =       0.000417587599
  error estimate for blocks of size 2^( 6) =       0.000418864132
  error estimate for blocks of size 2^( 7) =       0.000422157729

      target function =                  N/A
              le_mean =     -17.216852137993
             les_mean =     296.732818198187
             stat err =       0.000417983102
             autocorr =       1.170985181298
              std dev =       0.546258267498
             le_variance =       0.298398094810


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.721685213799e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216852138009       residual = 9.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216860370444       residual = 8.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216860117834       residual = 7.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216859021132       residual = 5.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216864267612       residual = 9.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216865312091       residual = 3.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216865800771       residual = 6.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216865976289       residual = 2.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216865567762       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216865535049       residual = 8.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216866023212       residual = 3.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216865928663       residual = 1.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216866068179       residual = 5.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.5000e-01 is 3.053701e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216852138009       residual = 9.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216855510163       residual = 8.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216855485381       residual = 4.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216854760522       residual = 5.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216856326440       residual = 4.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216856781802       residual = 7.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216856768493       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216856603903       residual = 5.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216856609530       residual = 2.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216856587903       residual = 8.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.0000e+00 is 8.403526e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216852138009       residual = 9.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216853141169       residual = 9.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216853142741       residual = 4.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216852974962       residual = 4.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216853317506       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216853395675       residual = 4.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216853430605       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216853390633       residual = 3.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216853369871       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216853376221       residual = 3.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 4.0000e+00 is 2.155682e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.135271 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.9816e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0   2.055214e-01                 1 1 ON  0
uu_1   4.505924e-02                 1 1 ON  1
uu_2   -4.693946e-02                1 1 ON  2
uu_3   -9.930273e-02                1 1 ON  3
uu_4   -1.301612e-01                1 1 ON  4
uu_5   -1.354369e-01                1 1 ON  5
uu_6   -1.126231e-01                1 1 ON  6
uu_7   -3.929957e-02                1 1 ON  7
uu_8   1.000895e-01                 1 1 ON  8
uu_9   1.206938e-01                 1 1 ON  9
ud_0   3.490050e-01                 1 1 ON  10
ud_1   9.134795e-02                 1 1 ON  11
ud_2   -1.666125e-02                1 1 ON  12
ud_3   -7.588007e-02                1 1 ON  13
ud_4   -1.215411e-01                1 1 ON  14
ud_5   -1.519664e-01                1 1 ON  15
ud_6   -1.543409e-01                1 1 ON  16
ud_7   -1.097612e-01                1 1 ON  17
ud_8   4.833749e-03                 1 1 ON  18
ud_9   9.254686e-02                 1 1 ON  19
eO_0   -7.482084e-01                1 1 ON  20
eO_1   -4.339982e-01                1 1 ON  21
eO_2   -3.557662e-02                1 1 ON  22
eO_3   2.072011e-01                 1 1 ON  23
eO_4   2.870255e-01                 1 1 ON  24
eO_5   3.047579e-01                 1 1 ON  25
eO_6   2.500327e-01                 1 1 ON  26
eO_7   1.118638e-01                 1 1 ON  27
eO_8   2.786287e-02                 1 1 ON  28
eO_9   1.842614e-02                 1 1 ON  29
eH1_0  -1.820076e-01                1 1 ON  30
eH1_1  -1.026085e-01                1 1 ON  31
eH1_2  -6.213196e-02                1 1 ON  32
eH1_3  -2.597764e-02                1 1 ON  33
eH1_4  1.933734e-02                 1 1 ON  34
eH1_5  3.562944e-02                 1 1 ON  35
eH1_6  7.727020e-02                 1 1 ON  36
eH1_7  1.104179e-01                 1 1 ON  37
eH1_8  9.059552e-02                 1 1 ON  38
eH1_9  2.424546e-02                 1 1 ON  39
eH2_0  -1.833487e-01                1 1 ON  40
eH2_1  -1.036846e-01                1 1 ON  41
eH2_2  -6.355310e-02                1 1 ON  42
eH2_3  -2.723822e-02                1 1 ON  43
eH2_4  1.838277e-02                 1 1 ON  44
eH2_5  3.515498e-02                 1 1 ON  45
eH2_6  7.836293e-02                 1 1 ON  46
eH2_7  1.135780e-01                 1 1 ON  47
eH2_8  9.380492e-02                 1 1 ON  48
eH2_9  2.632460e-02                 1 1 ON  49
ci_001 -4.030649e-02                3 1 ON  50
ci_002 -2.998565e-02                3 1 ON  51
ci_003 -2.518649e-02                3 1 ON  52
ci_004 2.105157e-02                 3 1 ON  53
ci_005 2.131752e-02                 3 1 ON  54
ci_006 -1.929968e-02                3 1 ON  55
ci_007 -1.899423e-02                3 1 ON  56
ci_008 -1.770611e-02                3 1 ON  57
ci_009 -1.811957e-02                3 1 ON  58
ci_010 -1.741991e-02                3 1 ON  59
ci_011 -1.632060e-02                3 1 ON  60
ci_012 -1.627072e-02                3 1 ON  61
ci_013 -1.927021e-02                3 1 ON  62
ci_014 1.392453e-02                 3 1 ON  63
ci_015 1.365147e-02                 3 1 ON  64
ci_016 1.640554e-02                 3 1 ON  65
ci_017 1.645557e-02                 3 1 ON  66
ci_018 1.277566e-02                 3 1 ON  67
ci_019 1.316449e-02                 3 1 ON  68
ci_020 1.344198e-02                 3 1 ON  69
ci_021 1.338207e-02                 3 1 ON  70
ci_022 1.109666e-02                 3 1 ON  71
ci_023 1.102035e-02                 3 1 ON  72
ci_024 1.209218e-02                 3 1 ON  73
ci_025 1.153382e-02                 3 1 ON  74
ci_026 1.095625e-02                 3 1 ON  75
ci_027 1.148900e-02                 3 1 ON  76
ci_028 -1.446517e-02                3 1 ON  77
ci_029 -1.483010e-02                3 1 ON  78
ci_030 -1.116579e-02                3 1 ON  79
ci_031 -1.145282e-02                3 1 ON  80
ci_032 -1.351455e-02                3 1 ON  81
ci_033 1.077278e-02                 3 1 ON  82
ci_034 1.042118e-02                 3 1 ON  83
ci_035 -4.700122e-03                3 1 ON  84
ci_036 -1.037820e-02                3 1 ON  85
ci_037 -1.003396e-02                3 1 ON  86
ci_038 1.729169e-03                 3 1 ON  87
ci_039 1.487477e-03                 3 1 ON  88
ci_040 -4.126078e-03                3 1 ON  89
ci_041 9.833875e-03                 3 1 ON  90
ci_042 1.003105e-02                 3 1 ON  91
ci_043 -3.018819e-03                3 1 ON  92
ci_044 -1.550566e-02                3 1 ON  93
ci_045 -1.793113e-03                3 1 ON  94
ci_046 5.587677e-03                 3 1 ON  95
ci_047 5.599460e-03                 3 1 ON  96
ci_048 -1.185232e-02                3 1 ON  97
ci_049 -1.194531e-02                3 1 ON  98
ci_050 7.409231e-03                 3 1 ON  99
ci_051 7.701267e-03                 3 1 ON  100
ci_052 -6.562261e-03                3 1 ON  101
ci_053 -6.467566e-03                3 1 ON  102
ci_054 -3.270122e-03                3 1 ON  103
ci_055 -3.140168e-03                3 1 ON  104
ci_056 4.849616e-03                 3 1 ON  105
ci_057 4.384085e-03                 3 1 ON  106
ci_058 -6.796410e-03                3 1 ON  107
ci_059 -6.415694e-03                3 1 ON  108
ci_060 8.296622e-03                 3 1 ON  109
ci_061 8.255668e-03                 3 1 ON  110
ci_062 -3.126280e-03                3 1 ON  111
ci_063 -3.062098e-03                3 1 ON  112
ci_064 -3.025977e-03                3 1 ON  113
ci_065 -4.190982e-03                3 1 ON  114
ci_066 5.685113e-03                 3 1 ON  115
ci_067 5.847618e-03                 3 1 ON  116
ci_068 -4.814892e-03                3 1 ON  117
ci_069 -4.625975e-03                3 1 ON  118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.1851
    reference variance = 0.170165
====================================================
  Execution time = 3.7571e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1386e-01
  Total weights = 1.9567e+06
  Execution time = 3.3787e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300643894668
                                         uncertainty =       0.001680491964

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300643894668
                                         uncertainty =       0.001680491964

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387656381
  error estimate for blocks of size 2^( 2) =       0.000397786972
  error estimate for blocks of size 2^( 3) =       0.000406340822
  error estimate for blocks of size 2^( 4) =       0.000412503372
  error estimate for blocks of size 2^( 5) =       0.000416411665
  error estimate for blocks of size 2^( 6) =       0.000420016908
  error estimate for blocks of size 2^( 7) =       0.000421771172

      target function =                  N/A
              le_mean =     -17.216403258646
             les_mean =     296.718618650439
             stat err =       0.000417675779
             autocorr =       1.160872998187
              std dev =       0.548228911384
             le_variance =       0.300554939278

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300881062637
                                         uncertainty =       0.001665137592

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300881062637
                                         uncertainty =       0.001665137592

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387809105
  error estimate for blocks of size 2^( 2) =       0.000397937498
  error estimate for blocks of size 2^( 3) =       0.000406480760
  error estimate for blocks of size 2^( 4) =       0.000412643744
  error estimate for blocks of size 2^( 5) =       0.000416532293
  error estimate for blocks of size 2^( 6) =       0.000420131368
  error estimate for blocks of size 2^( 7) =       0.000421906515

      target function =                  N/A
              le_mean =     -17.216406978089
             les_mean =     296.733251948545
             stat err =       0.000417803480
             autocorr =       1.160668246711
              std dev =       0.548444895891
             le_variance =       0.300791803829

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300764901654
                                         uncertainty =       0.001667305482

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300764901654
                                         uncertainty =       0.001667305482

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387734261
  error estimate for blocks of size 2^( 2) =       0.000397866937
  error estimate for blocks of size 2^( 3) =       0.000406416255
  error estimate for blocks of size 2^( 4) =       0.000412584657
  error estimate for blocks of size 2^( 5) =       0.000416475645
  error estimate for blocks of size 2^( 6) =       0.000420077783
  error estimate for blocks of size 2^( 7) =       0.000421849198

      target function =                  N/A
              le_mean =     -17.216406009451
             les_mean =     296.723903759387
             stat err =       0.000417746821
             autocorr =       1.160801471285
              std dev =       0.548339051136
             le_variance =       0.300675715000

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300653584572
                                         uncertainty =       0.001678430001

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300653584572
                                         uncertainty =       0.001678430001

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387662604
  error estimate for blocks of size 2^( 2) =       0.000397793005
  error estimate for blocks of size 2^( 3) =       0.000406346248
  error estimate for blocks of size 2^( 4) =       0.000412508958
  error estimate for blocks of size 2^( 5) =       0.000416415781
  error estimate for blocks of size 2^( 6) =       0.000420021713
  error estimate for blocks of size 2^( 7) =       0.000421785913

      target function =                  N/A
              le_mean =     -17.216401284653
             les_mean =     296.775924463743
             stat err =       0.000417683091
             autocorr =       1.160876367207
              std dev =       0.548237712855
             le_variance =       0.300564589796


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216403258646        initial
     2.5000e-01     2.5000e+00             3.0537e-03       -17.216406978089  <--
     1.0000e+00     1.0000e+01             8.4035e-04       -17.216406009451
     4.0000e+00     4.0000e+01             2.1557e-04       -17.216401284653

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 5.4618e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
  uu_0                 2.061924e-01 1 1  ON 0
  uu_1                 4.539034e-02 1 1  ON 1
  uu_2                -4.680642e-02 1 1  ON 2
  uu_3                -9.936286e-02 1 1  ON 3
  uu_4                -1.304423e-01 1 1  ON 4
  uu_5                -1.356400e-01 1 1  ON 5
  uu_6                -1.130351e-01 1 1  ON 6
  uu_7                -3.972131e-02 1 1  ON 7
  uu_8                 9.988805e-02 1 1  ON 8
  uu_9                 1.208921e-01 1 1  ON 9
  ud_0                 3.495752e-01 1 1  ON 10
  ud_1                 9.178402e-02 1 1  ON 11
  ud_2                -1.648723e-02 1 1  ON 12
  ud_3                -7.596219e-02 1 1  ON 13
  ud_4                -1.217488e-01 1 1  ON 14
  ud_5                -1.523202e-01 1 1  ON 15
  ud_6                -1.544630e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.465296e-03 1 1  ON 18
  ud_9                 9.258153e-02 1 1  ON 19
  eO_0                -7.504217e-01 1 1  ON 20
  eO_1                -4.354879e-01 1 1  ON 21
  eO_2                -3.597947e-02 1 1  ON 22
  eO_3                 2.081559e-01 1 1  ON 23
  eO_4                 2.891363e-01 1 1  ON 24
  eO_5                 3.052682e-01 1 1  ON 25
  eO_6                 2.501135e-01 1 1  ON 26
  eO_7                 1.121817e-01 1 1  ON 27
  eO_8                 2.793026e-02 1 1  ON 28
  eO_9                 1.846806e-02 1 1  ON 29
 eH1_0                -1.820099e-01 1 1  ON 30
 eH1_1                -1.027121e-01 1 1  ON 31
 eH1_2                -6.202845e-02 1 1  ON 32
 eH1_3                -2.594564e-02 1 1  ON 33
 eH1_4                 1.931531e-02 1 1  ON 34
 eH1_5                 3.552815e-02 1 1  ON 35
 eH1_6                 7.727968e-02 1 1  ON 36
 eH1_7                 1.103064e-01 1 1  ON 37
 eH1_8                 9.073677e-02 1 1  ON 38
 eH1_9                 2.428737e-02 1 1  ON 39
 eH2_0                -1.835292e-01 1 1  ON 40
 eH2_1                -1.038361e-01 1 1  ON 41
 eH2_2                -6.350512e-02 1 1  ON 42
 eH2_3                -2.706152e-02 1 1  ON 43
 eH2_4                 1.856819e-02 1 1  ON 44
 eH2_5                 3.504984e-02 1 1  ON 45
 eH2_6                 7.827829e-02 1 1  ON 46
 eH2_7                 1.134126e-01 1 1  ON 47
 eH2_8                 9.397251e-02 1 1  ON 48
 eH2_9                 2.639235e-02 1 1  ON 49
ci_001                -3.996448e-02 3 1  ON 50
ci_002                -3.016664e-02 3 1  ON 51
ci_003                -2.507372e-02 3 1  ON 52
ci_004                 2.111264e-02 3 1  ON 53
ci_005                 2.113621e-02 3 1  ON 54
ci_006                -1.943413e-02 3 1  ON 55
ci_007                -1.880484e-02 3 1  ON 56
ci_008                -1.774309e-02 3 1  ON 57
ci_009                -1.805847e-02 3 1  ON 58
ci_010                -1.730296e-02 3 1  ON 59
ci_011                -1.626631e-02 3 1  ON 60
ci_012                -1.614682e-02 3 1  ON 61
ci_013                -1.921743e-02 3 1  ON 62
ci_014                 1.385261e-02 3 1  ON 63
ci_015                 1.356378e-02 3 1  ON 64
ci_016                 1.626098e-02 3 1  ON 65
ci_017                 1.653381e-02 3 1  ON 66
ci_018                 1.263148e-02 3 1  ON 67
ci_019                 1.309195e-02 3 1  ON 68
ci_020                 1.328260e-02 3 1  ON 69
ci_021                 1.336547e-02 3 1  ON 70
ci_022                 1.114451e-02 3 1  ON 71
ci_023                 1.122755e-02 3 1  ON 72
ci_024                 1.228130e-02 3 1  ON 73
ci_025                 1.155413e-02 3 1  ON 74
ci_026                 1.090539e-02 3 1  ON 75
ci_027                 1.132774e-02 3 1  ON 76
ci_028                -1.425990e-02 3 1  ON 77
ci_029                -1.490948e-02 3 1  ON 78
ci_030                -1.110520e-02 3 1  ON 79
ci_031                -1.141201e-02 3 1  ON 80
ci_032                -1.349034e-02 3 1  ON 81
ci_033                 1.065685e-02 3 1  ON 82
ci_034                 1.063557e-02 3 1  ON 83
ci_035                -4.703756e-03 3 1  ON 84
ci_036                -1.040529e-02 3 1  ON 85
ci_037                -1.005869e-02 3 1  ON 86
ci_038                 1.874278e-03 3 1  ON 87
ci_039                 1.470835e-03 3 1  ON 88
ci_040                -4.065331e-03 3 1  ON 89
ci_041                 9.805730e-03 3 1  ON 90
ci_042                 9.855049e-03 3 1  ON 91
ci_043                -2.929300e-03 3 1  ON 92
ci_044                -1.514693e-02 3 1  ON 93
ci_045                -1.826432e-03 3 1  ON 94
ci_046                 5.708497e-03 3 1  ON 95
ci_047                 5.452312e-03 3 1  ON 96
ci_048                -1.169122e-02 3 1  ON 97
ci_049                -1.200964e-02 3 1  ON 98
ci_050                 7.414107e-03 3 1  ON 99
ci_051                 7.765179e-03 3 1  ON 100
ci_052                -6.441412e-03 3 1  ON 101
ci_053                -6.307683e-03 3 1  ON 102
ci_054                -3.220440e-03 3 1  ON 103
ci_055                -3.043033e-03 3 1  ON 104
ci_056                 4.495783e-03 3 1  ON 105
ci_057                 4.396771e-03 3 1  ON 106
ci_058                -6.793640e-03 3 1  ON 107
ci_059                -6.375615e-03 3 1  ON 108
ci_060                 8.241980e-03 3 1  ON 109
ci_061                 7.905547e-03 3 1  ON 110
ci_062                -3.257553e-03 3 1  ON 111
ci_063                -2.907691e-03 3 1  ON 112
ci_064                -3.133848e-03 3 1  ON 113
ci_065                -4.351688e-03 3 1  ON 114
ci_066                 5.563454e-03 3 1  ON 115
ci_067                 5.751489e-03 3 1  ON 116
ci_068                -4.597707e-03 3 1  ON 117
ci_069                -4.608499e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0444e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7238e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.1997
    reference variance = 0.207169
====================================================
  Execution time = 3.8151e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5270e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1220e-01
  Total weights = 1.956573165e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1183e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297012266637
                                         uncertainty =       0.002174811303

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297012266637
                                         uncertainty =       0.002174811303

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385291563
  error estimate for blocks of size 2^( 2) =       0.000395495286
  error estimate for blocks of size 2^( 3) =       0.000404705874
  error estimate for blocks of size 2^( 4) =       0.000412707180
  error estimate for blocks of size 2^( 5) =       0.000417258852
  error estimate for blocks of size 2^( 6) =       0.000419247766
  error estimate for blocks of size 2^( 7) =       0.000420416013

      target function =                  N/A
              le_mean =     -17.215935922765
             les_mean =     296.700649682738
             stat err =       0.000417407453
             autocorr =       1.173657554980
              std dev =       0.544884554339
             le_variance =       0.296899177557


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721593592276e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215935922799       residual = 9.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215936042312       residual = 7.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215934690369       residual = 6.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215935337835       residual = 7.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215933508724       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215946284813       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215944342884       residual = 4.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215947820178       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215950466175       residual = 9.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215949580007       residual = 5.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.215948586447       residual = 3.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.215948894379       residual = 2.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.215949326626       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.215949594020       residual = 8.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.215950068184       residual = 9.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.215950407763       residual = 6.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.215950582611       residual = 4.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.215950194338       residual = 3.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.215950049376       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.215949770146       residual = 6.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         19 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.2500e-02 is 9.024139e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215935922799       residual = 9.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215935997951       residual = 5.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215935371583       residual = 8.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215935651859       residual = 5.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215933455714       residual = 7.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215938168514       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215938405613       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215939816312       residual = 3.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215940117092       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215939511795       residual = 4.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.215939435887       residual = 2.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.215939563700       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.215939512062       residual = 6.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.5000e-01 is 2.902437e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215935922799       residual = 9.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215935953044       residual = 4.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215935804308       residual = 8.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215935965444       residual = 4.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215934950493       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215936034662       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215936413592       residual = 4.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215936728519       residual = 7.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215936697463       residual = 2.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215936641042       residual = 6.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.0000e+00 is 7.753763e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.144321 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.9352e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
  uu_0                 2.071029e-01 1 1  ON 0
  uu_1                 4.606394e-02 1 1  ON 1
  uu_2                -4.648842e-02 1 1  ON 2
  uu_3                -9.952008e-02 1 1  ON 3
  uu_4                -1.310513e-01 1 1  ON 4
  uu_5                -1.362568e-01 1 1  ON 5
  uu_6                -1.133246e-01 1 1  ON 6
  uu_7                -4.020866e-02 1 1  ON 7
  uu_8                 9.963184e-02 1 1  ON 8
  uu_9                 1.211188e-01 1 1  ON 9
  ud_0                 3.499461e-01 1 1  ON 10
  ud_1                 9.197899e-02 1 1  ON 11
  ud_2                -1.623669e-02 1 1  ON 12
  ud_3                -7.580757e-02 1 1  ON 13
  ud_4                -1.219032e-01 1 1  ON 14
  ud_5                -1.526095e-01 1 1  ON 15
  ud_6                -1.546867e-01 1 1  ON 16
  ud_7                -1.101371e-01 1 1  ON 17
  ud_8                 4.056501e-03 1 1  ON 18
  ud_9                 9.257263e-02 1 1  ON 19
  eO_0                -7.528172e-01 1 1  ON 20
  eO_1                -4.375298e-01 1 1  ON 21
  eO_2                -3.679207e-02 1 1  ON 22
  eO_3                 2.090911e-01 1 1  ON 23
  eO_4                 2.920387e-01 1 1  ON 24
  eO_5                 3.058401e-01 1 1  ON 25
  eO_6                 2.503265e-01 1 1  ON 26
  eO_7                 1.126588e-01 1 1  ON 27
  eO_8                 2.802208e-02 1 1  ON 28
  eO_9                 1.848991e-02 1 1  ON 29
 eH1_0                -1.822454e-01 1 1  ON 30
 eH1_1                -1.028215e-01 1 1  ON 31
 eH1_2                -6.207708e-02 1 1  ON 32
 eH1_3                -2.593252e-02 1 1  ON 33
 eH1_4                 1.938756e-02 1 1  ON 34
 eH1_5                 3.527800e-02 1 1  ON 35
 eH1_6                 7.755616e-02 1 1  ON 36
 eH1_7                 1.102251e-01 1 1  ON 37
 eH1_8                 9.098052e-02 1 1  ON 38
 eH1_9                 2.435844e-02 1 1  ON 39
 eH2_0                -1.836686e-01 1 1  ON 40
 eH2_1                -1.038060e-01 1 1  ON 41
 eH2_2                -6.345497e-02 1 1  ON 42
 eH2_3                -2.719042e-02 1 1  ON 43
 eH2_4                 1.846751e-02 1 1  ON 44
 eH2_5                 3.498574e-02 1 1  ON 45
 eH2_6                 7.834387e-02 1 1  ON 46
 eH2_7                 1.132982e-01 1 1  ON 47
 eH2_8                 9.426412e-02 1 1  ON 48
 eH2_9                 2.648808e-02 1 1  ON 49
ci_001                -3.996324e-02 3 1  ON 50
ci_002                -3.037139e-02 3 1  ON 51
ci_003                -2.517107e-02 3 1  ON 52
ci_004                 2.113272e-02 3 1  ON 53
ci_005                 2.131844e-02 3 1  ON 54
ci_006                -1.954195e-02 3 1  ON 55
ci_007                -1.911451e-02 3 1  ON 56
ci_008                -1.816712e-02 3 1  ON 57
ci_009                -1.835322e-02 3 1  ON 58
ci_010                -1.740895e-02 3 1  ON 59
ci_011                -1.622046e-02 3 1  ON 60
ci_012                -1.612027e-02 3 1  ON 61
ci_013                -1.922669e-02 3 1  ON 62
ci_014                 1.412159e-02 3 1  ON 63
ci_015                 1.363682e-02 3 1  ON 64
ci_016                 1.621550e-02 3 1  ON 65
ci_017                 1.672142e-02 3 1  ON 66
ci_018                 1.254608e-02 3 1  ON 67
ci_019                 1.323797e-02 3 1  ON 68
ci_020                 1.305139e-02 3 1  ON 69
ci_021                 1.324502e-02 3 1  ON 70
ci_022                 1.128437e-02 3 1  ON 71
ci_023                 1.097107e-02 3 1  ON 72
ci_024                 1.141630e-02 3 1  ON 73
ci_025                 1.153618e-02 3 1  ON 74
ci_026                 1.089030e-02 3 1  ON 75
ci_027                 1.154104e-02 3 1  ON 76
ci_028                -1.432978e-02 3 1  ON 77
ci_029                -1.488976e-02 3 1  ON 78
ci_030                -1.109957e-02 3 1  ON 79
ci_031                -1.103516e-02 3 1  ON 80
ci_032                -1.316465e-02 3 1  ON 81
ci_033                 1.047408e-02 3 1  ON 82
ci_034                 1.098724e-02 3 1  ON 83
ci_035                -4.514164e-03 3 1  ON 84
ci_036                -1.059702e-02 3 1  ON 85
ci_037                -1.008044e-02 3 1  ON 86
ci_038                 1.543936e-03 3 1  ON 87
ci_039                 1.372295e-03 3 1  ON 88
ci_040                -4.167616e-03 3 1  ON 89
ci_041                 9.540333e-03 3 1  ON 90
ci_042                 9.886904e-03 3 1  ON 91
ci_043                -2.959105e-03 3 1  ON 92
ci_044                -1.520633e-02 3 1  ON 93
ci_045                -1.898682e-03 3 1  ON 94
ci_046                 5.453982e-03 3 1  ON 95
ci_047                 5.353355e-03 3 1  ON 96
ci_048                -1.153059e-02 3 1  ON 97
ci_049                -1.236148e-02 3 1  ON 98
ci_050                 7.411492e-03 3 1  ON 99
ci_051                 7.535604e-03 3 1  ON 100
ci_052                -6.433230e-03 3 1  ON 101
ci_053                -6.150840e-03 3 1  ON 102
ci_054                -3.009596e-03 3 1  ON 103
ci_055                -3.344626e-03 3 1  ON 104
ci_056                 4.840404e-03 3 1  ON 105
ci_057                 4.489445e-03 3 1  ON 106
ci_058                -6.540426e-03 3 1  ON 107
ci_059                -6.097075e-03 3 1  ON 108
ci_060                 8.164467e-03 3 1  ON 109
ci_061                 8.184030e-03 3 1  ON 110
ci_062                -3.406976e-03 3 1  ON 111
ci_063                -3.027092e-03 3 1  ON 112
ci_064                -3.221349e-03 3 1  ON 113
ci_065                -4.204383e-03 3 1  ON 114
ci_066                 5.502810e-03 3 1  ON 115
ci_067                 6.208423e-03 3 1  ON 116
ci_068                -4.802629e-03 3 1  ON 117
ci_069                -4.303713e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.2638
    reference variance = 0.459998
====================================================
  Execution time = 3.7513e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1433e-01
  Total weights = 1.9569e+06
  Execution time = 3.3702e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299704191149
                                         uncertainty =       0.001750821449

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299704191149
                                         uncertainty =       0.001750821449

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387125141
  error estimate for blocks of size 2^( 2) =       0.000397700163
  error estimate for blocks of size 2^( 3) =       0.000406501984
  error estimate for blocks of size 2^( 4) =       0.000412793291
  error estimate for blocks of size 2^( 5) =       0.000416420811
  error estimate for blocks of size 2^( 6) =       0.000419330962
  error estimate for blocks of size 2^( 7) =       0.000419285200

      target function =                  N/A
              le_mean =     -17.215799069794
             les_mean =     296.698066088418
             stat err =       0.000416957566
             autocorr =       1.160061366903
              std dev =       0.547477625032
             le_variance =       0.299731749910

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301149659066
                                         uncertainty =       0.001743316468

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301149659066
                                         uncertainty =       0.001743316468

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388057896
  error estimate for blocks of size 2^( 2) =       0.000398586499
  error estimate for blocks of size 2^( 3) =       0.000407335330
  error estimate for blocks of size 2^( 4) =       0.000413583928
  error estimate for blocks of size 2^( 5) =       0.000417218130
  error estimate for blocks of size 2^( 6) =       0.000420086978
  error estimate for blocks of size 2^( 7) =       0.000420068690

      target function =                  N/A
              le_mean =     -17.215776126347
             les_mean =     296.983218573570
             stat err =       0.000417739432
             autocorr =       1.158825098233
              std dev =       0.548796739983
             le_variance =       0.301177861815

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301021171804
                                         uncertainty =       0.001732641331

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301021171804
                                         uncertainty =       0.001732641331

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387975519
  error estimate for blocks of size 2^( 2) =       0.000398512995
  error estimate for blocks of size 2^( 3) =       0.000407273593
  error estimate for blocks of size 2^( 4) =       0.000413542001
  error estimate for blocks of size 2^( 5) =       0.000417190233
  error estimate for blocks of size 2^( 6) =       0.000420077281
  error estimate for blocks of size 2^( 7) =       0.000420058176

      target function =                  N/A
              le_mean =     -17.215787743159
             les_mean =     296.954305941679
             stat err =       0.000417716923
             autocorr =       1.159192318129
              std dev =       0.548680240746
             le_variance =       0.301050006585

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299831191027
                                         uncertainty =       0.001746405177

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299831191027
                                         uncertainty =       0.001746405177

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387207521
  error estimate for blocks of size 2^( 2) =       0.000397777359
  error estimate for blocks of size 2^( 3) =       0.000406574069
  error estimate for blocks of size 2^( 4) =       0.000412863633
  error estimate for blocks of size 2^( 5) =       0.000416495966
  error estimate for blocks of size 2^( 6) =       0.000419413456
  error estimate for blocks of size 2^( 7) =       0.000419368945

      target function =                  N/A
              le_mean =     -17.215792818335
             les_mean =     296.699158510561
             stat err =       0.000417035500
             autocorr =       1.160001318588
              std dev =       0.547594127354
             le_variance =       0.299859328313


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215799069794        initial  <--
     6.2500e-02     6.2500e-01             9.0241e-03       -17.215776126347
     2.5000e-01     2.5000e+00             2.9024e-03       -17.215787743159
     1.0000e+00     1.0000e+01             7.7538e-04       -17.215792818335

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 54.5726
  </log>
  <optVariables href="H2O.s001.opt.xml">
  uu_0                 2.061924e-01 1 1  ON 0
  uu_1                 4.539034e-02 1 1  ON 1
  uu_2                -4.680642e-02 1 1  ON 2
  uu_3                -9.936286e-02 1 1  ON 3
  uu_4                -1.304423e-01 1 1  ON 4
  uu_5                -1.356400e-01 1 1  ON 5
  uu_6                -1.130351e-01 1 1  ON 6
  uu_7                -3.972131e-02 1 1  ON 7
  uu_8                 9.988805e-02 1 1  ON 8
  uu_9                 1.208921e-01 1 1  ON 9
  ud_0                 3.495752e-01 1 1  ON 10
  ud_1                 9.178402e-02 1 1  ON 11
  ud_2                -1.648723e-02 1 1  ON 12
  ud_3                -7.596219e-02 1 1  ON 13
  ud_4                -1.217488e-01 1 1  ON 14
  ud_5                -1.523202e-01 1 1  ON 15
  ud_6                -1.544630e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.465296e-03 1 1  ON 18
  ud_9                 9.258153e-02 1 1  ON 19
  eO_0                -7.504217e-01 1 1  ON 20
  eO_1                -4.354879e-01 1 1  ON 21
  eO_2                -3.597947e-02 1 1  ON 22
  eO_3                 2.081559e-01 1 1  ON 23
  eO_4                 2.891363e-01 1 1  ON 24
  eO_5                 3.052682e-01 1 1  ON 25
  eO_6                 2.501135e-01 1 1  ON 26
  eO_7                 1.121817e-01 1 1  ON 27
  eO_8                 2.793026e-02 1 1  ON 28
  eO_9                 1.846806e-02 1 1  ON 29
 eH1_0                -1.820099e-01 1 1  ON 30
 eH1_1                -1.027121e-01 1 1  ON 31
 eH1_2                -6.202845e-02 1 1  ON 32
 eH1_3                -2.594564e-02 1 1  ON 33
 eH1_4                 1.931531e-02 1 1  ON 34
 eH1_5                 3.552815e-02 1 1  ON 35
 eH1_6                 7.727968e-02 1 1  ON 36
 eH1_7                 1.103064e-01 1 1  ON 37
 eH1_8                 9.073677e-02 1 1  ON 38
 eH1_9                 2.428737e-02 1 1  ON 39
 eH2_0                -1.835292e-01 1 1  ON 40
 eH2_1                -1.038361e-01 1 1  ON 41
 eH2_2                -6.350512e-02 1 1  ON 42
 eH2_3                -2.706152e-02 1 1  ON 43
 eH2_4                 1.856819e-02 1 1  ON 44
 eH2_5                 3.504984e-02 1 1  ON 45
 eH2_6                 7.827829e-02 1 1  ON 46
 eH2_7                 1.134126e-01 1 1  ON 47
 eH2_8                 9.397251e-02 1 1  ON 48
 eH2_9                 2.639235e-02 1 1  ON 49
ci_001                -3.996448e-02 3 1  ON 50
ci_002                -3.016664e-02 3 1  ON 51
ci_003                -2.507372e-02 3 1  ON 52
ci_004                 2.111264e-02 3 1  ON 53
ci_005                 2.113621e-02 3 1  ON 54
ci_006                -1.943413e-02 3 1  ON 55
ci_007                -1.880484e-02 3 1  ON 56
ci_008                -1.774309e-02 3 1  ON 57
ci_009                -1.805847e-02 3 1  ON 58
ci_010                -1.730296e-02 3 1  ON 59
ci_011                -1.626631e-02 3 1  ON 60
ci_012                -1.614682e-02 3 1  ON 61
ci_013                -1.921743e-02 3 1  ON 62
ci_014                 1.385261e-02 3 1  ON 63
ci_015                 1.356378e-02 3 1  ON 64
ci_016                 1.626098e-02 3 1  ON 65
ci_017                 1.653381e-02 3 1  ON 66
ci_018                 1.263148e-02 3 1  ON 67
ci_019                 1.309195e-02 3 1  ON 68
ci_020                 1.328260e-02 3 1  ON 69
ci_021                 1.336547e-02 3 1  ON 70
ci_022                 1.114451e-02 3 1  ON 71
ci_023                 1.122755e-02 3 1  ON 72
ci_024                 1.228130e-02 3 1  ON 73
ci_025                 1.155413e-02 3 1  ON 74
ci_026                 1.090539e-02 3 1  ON 75
ci_027                 1.132774e-02 3 1  ON 76
ci_028                -1.425990e-02 3 1  ON 77
ci_029                -1.490948e-02 3 1  ON 78
ci_030                -1.110520e-02 3 1  ON 79
ci_031                -1.141201e-02 3 1  ON 80
ci_032                -1.349034e-02 3 1  ON 81
ci_033                 1.065685e-02 3 1  ON 82
ci_034                 1.063557e-02 3 1  ON 83
ci_035                -4.703756e-03 3 1  ON 84
ci_036                -1.040529e-02 3 1  ON 85
ci_037                -1.005869e-02 3 1  ON 86
ci_038                 1.874278e-03 3 1  ON 87
ci_039                 1.470835e-03 3 1  ON 88
ci_040                -4.065331e-03 3 1  ON 89
ci_041                 9.805730e-03 3 1  ON 90
ci_042                 9.855049e-03 3 1  ON 91
ci_043                -2.929300e-03 3 1  ON 92
ci_044                -1.514693e-02 3 1  ON 93
ci_045                -1.826432e-03 3 1  ON 94
ci_046                 5.708497e-03 3 1  ON 95
ci_047                 5.452312e-03 3 1  ON 96
ci_048                -1.169122e-02 3 1  ON 97
ci_049                -1.200964e-02 3 1  ON 98
ci_050                 7.414107e-03 3 1  ON 99
ci_051                 7.765179e-03 3 1  ON 100
ci_052                -6.441412e-03 3 1  ON 101
ci_053                -6.307683e-03 3 1  ON 102
ci_054                -3.220440e-03 3 1  ON 103
ci_055                -3.043033e-03 3 1  ON 104
ci_056                 4.495783e-03 3 1  ON 105
ci_057                 4.396771e-03 3 1  ON 106
ci_058                -6.793640e-03 3 1  ON 107
ci_059                -6.375615e-03 3 1  ON 108
ci_060                 8.241980e-03 3 1  ON 109
ci_061                 7.905547e-03 3 1  ON 110
ci_062                -3.257553e-03 3 1  ON 111
ci_063                -2.907691e-03 3 1  ON 112
ci_064                -3.133848e-03 3 1  ON 113
ci_065                -4.351688e-03 3 1  ON 114
ci_066                 5.563454e-03 3 1  ON 115
ci_067                 5.751489e-03 3 1  ON 116
ci_068                -4.597707e-03 3 1  ON 117
ci_069                -4.608499e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0394e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7235e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.2774
    reference variance = 0.300518
====================================================
  Execution time = 3.8123e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5290e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1221e-01
  Total weights = 1.956426973e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1341e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297682384661
                                         uncertainty =       0.002396328079

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297682384661
                                         uncertainty =       0.002396328079

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385759093
  error estimate for blocks of size 2^( 2) =       0.000395448441
  error estimate for blocks of size 2^( 3) =       0.000404652523
  error estimate for blocks of size 2^( 4) =       0.000410940538
  error estimate for blocks of size 2^( 5) =       0.000415334204
  error estimate for blocks of size 2^( 6) =       0.000417078203
  error estimate for blocks of size 2^( 7) =       0.000416944158

      target function =                  N/A
              le_mean =     -17.216288199544
             les_mean =     296.712792872627
             stat err =       0.000415074276
             autocorr =       1.157762007441
              std dev =       0.545545741269
             le_variance =       0.297620155817


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721628819954e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216288199592       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216288049331       residual = 6.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216288356591       residual = 3.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216289929102       residual = 4.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216289007183       residual = 4.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216290897453       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216291220770       residual = 5.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216291483951       residual = 7.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216291642491       residual = 3.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216291604472       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216291621870       residual = 4.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.2500e-01 is 1.087743e-03

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216288199592       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216288152343       residual = 7.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216288294002       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216288888734       residual = 3.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216288562814       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216288994243       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216289046908       residual = 3.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216289113774       residual = 4.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216289124779       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216289153436       residual = 5.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.5000e+00 is 2.724259e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216288199592       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216288186966       residual = 7.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216288228660       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216288390295       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216288304342       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216288414737       residual = 8.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216288421286       residual = 2.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216288438696       residual = 3.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216288438786       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216288447803       residual = 4.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.0000e+01 is 6.790598e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.148700 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.9476e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
  uu_0                 2.062796e-01 1 1  ON 0
  uu_1                 4.544761e-02 1 1  ON 1
  uu_2                -4.678208e-02 1 1  ON 2
  uu_3                -9.937119e-02 1 1  ON 3
  uu_4                -1.305125e-01 1 1  ON 4
  uu_5                -1.356604e-01 1 1  ON 5
  uu_6                -1.130775e-01 1 1  ON 6
  uu_7                -3.978158e-02 1 1  ON 7
  uu_8                 9.985750e-02 1 1  ON 8
  uu_9                 1.209166e-01 1 1  ON 9
  ud_0                 3.496560e-01 1 1  ON 10
  ud_1                 9.181460e-02 1 1  ON 11
  ud_2                -1.650007e-02 1 1  ON 12
  ud_3                -7.595231e-02 1 1  ON 13
  ud_4                -1.218051e-01 1 1  ON 14
  ud_5                -1.523503e-01 1 1  ON 15
  ud_6                -1.544571e-01 1 1  ON 16
  ud_7                -1.100310e-01 1 1  ON 17
  ud_8                 4.421130e-03 1 1  ON 18
  ud_9                 9.258993e-02 1 1  ON 19
  eO_0                -7.506942e-01 1 1  ON 20
  eO_1                -4.357241e-01 1 1  ON 21
  eO_2                -3.603401e-02 1 1  ON 22
  eO_3                 2.083200e-01 1 1  ON 23
  eO_4                 2.893838e-01 1 1  ON 24
  eO_5                 3.053270e-01 1 1  ON 25
  eO_6                 2.501378e-01 1 1  ON 26
  eO_7                 1.122296e-01 1 1  ON 27
  eO_8                 2.794028e-02 1 1  ON 28
  eO_9                 1.847433e-02 1 1  ON 29
 eH1_0                -1.820629e-01 1 1  ON 30
 eH1_1                -1.027084e-01 1 1  ON 31
 eH1_2                -6.203315e-02 1 1  ON 32
 eH1_3                -2.595032e-02 1 1  ON 33
 eH1_4                 1.935784e-02 1 1  ON 34
 eH1_5                 3.551380e-02 1 1  ON 35
 eH1_6                 7.727640e-02 1 1  ON 36
 eH1_7                 1.103003e-01 1 1  ON 37
 eH1_8                 9.076208e-02 1 1  ON 38
 eH1_9                 2.429692e-02 1 1  ON 39
 eH2_0                -1.835181e-01 1 1  ON 40
 eH2_1                -1.038590e-01 1 1  ON 41
 eH2_2                -6.347177e-02 1 1  ON 42
 eH2_3                -2.706793e-02 1 1  ON 43
 eH2_4                 1.853414e-02 1 1  ON 44
 eH2_5                 3.501042e-02 1 1  ON 45
 eH2_6                 7.829167e-02 1 1  ON 46
 eH2_7                 1.134152e-01 1 1  ON 47
 eH2_8                 9.400287e-02 1 1  ON 48
 eH2_9                 2.640045e-02 1 1  ON 49
ci_001                -3.998625e-02 3 1  ON 50
ci_002                -3.019458e-02 3 1  ON 51
ci_003                -2.507233e-02 3 1  ON 52
ci_004                 2.109553e-02 3 1  ON 53
ci_005                 2.120238e-02 3 1  ON 54
ci_006                -1.943255e-02 3 1  ON 55
ci_007                -1.883675e-02 3 1  ON 56
ci_008                -1.772837e-02 3 1  ON 57
ci_009                -1.807655e-02 3 1  ON 58
ci_010                -1.729205e-02 3 1  ON 59
ci_011                -1.628677e-02 3 1  ON 60
ci_012                -1.612806e-02 3 1  ON 61
ci_013                -1.918273e-02 3 1  ON 62
ci_014                 1.384130e-02 3 1  ON 63
ci_015                 1.353552e-02 3 1  ON 64
ci_016                 1.629260e-02 3 1  ON 65
ci_017                 1.647951e-02 3 1  ON 66
ci_018                 1.258515e-02 3 1  ON 67
ci_019                 1.302822e-02 3 1  ON 68
ci_020                 1.325899e-02 3 1  ON 69
ci_021                 1.337976e-02 3 1  ON 70
ci_022                 1.120892e-02 3 1  ON 71
ci_023                 1.127902e-02 3 1  ON 72
ci_024                 1.229341e-02 3 1  ON 73
ci_025                 1.147369e-02 3 1  ON 74
ci_026                 1.092225e-02 3 1  ON 75
ci_027                 1.126224e-02 3 1  ON 76
ci_028                -1.427243e-02 3 1  ON 77
ci_029                -1.493264e-02 3 1  ON 78
ci_030                -1.113717e-02 3 1  ON 79
ci_031                -1.132432e-02 3 1  ON 80
ci_032                -1.344060e-02 3 1  ON 81
ci_033                 1.064509e-02 3 1  ON 82
ci_034                 1.058747e-02 3 1  ON 83
ci_035                -4.718370e-03 3 1  ON 84
ci_036                -1.045168e-02 3 1  ON 85
ci_037                -1.014828e-02 3 1  ON 86
ci_038                 1.817340e-03 3 1  ON 87
ci_039                 1.481425e-03 3 1  ON 88
ci_040                -4.071520e-03 3 1  ON 89
ci_041                 9.749272e-03 3 1  ON 90
ci_042                 9.777523e-03 3 1  ON 91
ci_043                -2.930773e-03 3 1  ON 92
ci_044                -1.517473e-02 3 1  ON 93
ci_045                -1.808209e-03 3 1  ON 94
ci_046                 5.742138e-03 3 1  ON 95
ci_047                 5.467240e-03 3 1  ON 96
ci_048                -1.176034e-02 3 1  ON 97
ci_049                -1.196829e-02 3 1  ON 98
ci_050                 7.437720e-03 3 1  ON 99
ci_051                 7.719031e-03 3 1  ON 100
ci_052                -6.505088e-03 3 1  ON 101
ci_053                -6.298695e-03 3 1  ON 102
ci_054                -3.115555e-03 3 1  ON 103
ci_055                -3.089570e-03 3 1  ON 104
ci_056                 4.478981e-03 3 1  ON 105
ci_057                 4.386159e-03 3 1  ON 106
ci_058                -6.783012e-03 3 1  ON 107
ci_059                -6.295191e-03 3 1  ON 108
ci_060                 8.197599e-03 3 1  ON 109
ci_061                 7.944295e-03 3 1  ON 110
ci_062                -3.313589e-03 3 1  ON 111
ci_063                -2.971221e-03 3 1  ON 112
ci_064                -3.086099e-03 3 1  ON 113
ci_065                -4.365472e-03 3 1  ON 114
ci_066                 5.634459e-03 3 1  ON 115
ci_067                 5.756380e-03 3 1  ON 116
ci_068                -4.665513e-03 3 1  ON 117
ci_069                -4.679137e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.2107
    reference variance = 0.136624
====================================================
  Execution time = 3.6969e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1393e-01
  Total weights = 1.9565e+06
  Execution time = 3.3841e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298406743584
                                         uncertainty =       0.002151549792

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298406743584
                                         uncertainty =       0.002151549792

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386250229
  error estimate for blocks of size 2^( 2) =       0.000396150741
  error estimate for blocks of size 2^( 3) =       0.000405248490
  error estimate for blocks of size 2^( 4) =       0.000412637793
  error estimate for blocks of size 2^( 5) =       0.000419017067
  error estimate for blocks of size 2^( 6) =       0.000421587878
  error estimate for blocks of size 2^( 7) =       0.000423547807

      target function =                  N/A
              le_mean =     -17.216339778053
             les_mean =     296.719993873646
             stat err =       0.000419197636
             autocorr =       1.177877566658
              std dev =       0.546240312307
             le_variance =       0.298378478789

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298444706415
                                         uncertainty =       0.002157907012

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298444706415
                                         uncertainty =       0.002157907012

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386274442
  error estimate for blocks of size 2^( 2) =       0.000396172700
  error estimate for blocks of size 2^( 3) =       0.000405264940
  error estimate for blocks of size 2^( 4) =       0.000412651782
  error estimate for blocks of size 2^( 5) =       0.000419038399
  error estimate for blocks of size 2^( 6) =       0.000421615045
  error estimate for blocks of size 2^( 7) =       0.000423555847

      target function =                  N/A
              le_mean =     -17.216338950199
             les_mean =     296.716978942034
             stat err =       0.000419215269
             autocorr =       1.177828983519
              std dev =       0.546274554244
             le_variance =       0.298415888614

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298420524410
                                         uncertainty =       0.002155048589

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298420524410
                                         uncertainty =       0.002155048589

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386258915
  error estimate for blocks of size 2^( 2) =       0.000396157973
  error estimate for blocks of size 2^( 3) =       0.000405252459
  error estimate for blocks of size 2^( 4) =       0.000412640949
  error estimate for blocks of size 2^( 5) =       0.000419025457
  error estimate for blocks of size 2^( 6) =       0.000421599856
  error estimate for blocks of size 2^( 7) =       0.000423547742

      target function =                  N/A
              le_mean =     -17.216338153448
             les_mean =     296.724432689253
             stat err =       0.000419203501
             autocorr =       1.177857546518
              std dev =       0.546252596600
             le_variance =       0.298391899292

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298407133375
                                         uncertainty =       0.002151953722

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298407133375
                                         uncertainty =       0.002151953722

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386250450
  error estimate for blocks of size 2^( 2) =       0.000396150701
  error estimate for blocks of size 2^( 3) =       0.000405247568
  error estimate for blocks of size 2^( 4) =       0.000412636872
  error estimate for blocks of size 2^( 5) =       0.000419017192
  error estimate for blocks of size 2^( 6) =       0.000421587902
  error estimate for blocks of size 2^( 7) =       0.000423546295

      target function =                  N/A
              le_mean =     -17.216339194353
             les_mean =     296.716269006642
             stat err =       0.000419197065
             autocorr =       1.177873008302
              std dev =       0.546240625175
             le_variance =       0.298378820592


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216339778053        initial  <--
     6.2500e-01     6.2500e+00             1.0877e-03       -17.216338950199
     2.5000e+00     2.5000e+01             2.7243e-04       -17.216338153448
     1.0000e+01     1.0000e+02             6.7906e-05       -17.216339194353

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 54.0414
  </log>
  <optVariables href="H2O.s002.opt.xml">
  uu_0                 2.061924e-01 1 1  ON 0
  uu_1                 4.539034e-02 1 1  ON 1
  uu_2                -4.680642e-02 1 1  ON 2
  uu_3                -9.936286e-02 1 1  ON 3
  uu_4                -1.304423e-01 1 1  ON 4
  uu_5                -1.356400e-01 1 1  ON 5
  uu_6                -1.130351e-01 1 1  ON 6
  uu_7                -3.972131e-02 1 1  ON 7
  uu_8                 9.988805e-02 1 1  ON 8
  uu_9                 1.208921e-01 1 1  ON 9
  ud_0                 3.495752e-01 1 1  ON 10
  ud_1                 9.178402e-02 1 1  ON 11
  ud_2                -1.648723e-02 1 1  ON 12
  ud_3                -7.596219e-02 1 1  ON 13
  ud_4                -1.217488e-01 1 1  ON 14
  ud_5                -1.523202e-01 1 1  ON 15
  ud_6                -1.544630e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.465296e-03 1 1  ON 18
  ud_9                 9.258153e-02 1 1  ON 19
  eO_0                -7.504217e-01 1 1  ON 20
  eO_1                -4.354879e-01 1 1  ON 21
  eO_2                -3.597947e-02 1 1  ON 22
  eO_3                 2.081559e-01 1 1  ON 23
  eO_4                 2.891363e-01 1 1  ON 24
  eO_5                 3.052682e-01 1 1  ON 25
  eO_6                 2.501135e-01 1 1  ON 26
  eO_7                 1.121817e-01 1 1  ON 27
  eO_8                 2.793026e-02 1 1  ON 28
  eO_9                 1.846806e-02 1 1  ON 29
 eH1_0                -1.820099e-01 1 1  ON 30
 eH1_1                -1.027121e-01 1 1  ON 31
 eH1_2                -6.202845e-02 1 1  ON 32
 eH1_3                -2.594564e-02 1 1  ON 33
 eH1_4                 1.931531e-02 1 1  ON 34
 eH1_5                 3.552815e-02 1 1  ON 35
 eH1_6                 7.727968e-02 1 1  ON 36
 eH1_7                 1.103064e-01 1 1  ON 37
 eH1_8                 9.073677e-02 1 1  ON 38
 eH1_9                 2.428737e-02 1 1  ON 39
 eH2_0                -1.835292e-01 1 1  ON 40
 eH2_1                -1.038361e-01 1 1  ON 41
 eH2_2                -6.350512e-02 1 1  ON 42
 eH2_3                -2.706152e-02 1 1  ON 43
 eH2_4                 1.856819e-02 1 1  ON 44
 eH2_5                 3.504984e-02 1 1  ON 45
 eH2_6                 7.827829e-02 1 1  ON 46
 eH2_7                 1.134126e-01 1 1  ON 47
 eH2_8                 9.397251e-02 1 1  ON 48
 eH2_9                 2.639235e-02 1 1  ON 49
ci_001                -3.996448e-02 3 1  ON 50
ci_002                -3.016664e-02 3 1  ON 51
ci_003                -2.507372e-02 3 1  ON 52
ci_004                 2.111264e-02 3 1  ON 53
ci_005                 2.113621e-02 3 1  ON 54
ci_006                -1.943413e-02 3 1  ON 55
ci_007                -1.880484e-02 3 1  ON 56
ci_008                -1.774309e-02 3 1  ON 57
ci_009                -1.805847e-02 3 1  ON 58
ci_010                -1.730296e-02 3 1  ON 59
ci_011                -1.626631e-02 3 1  ON 60
ci_012                -1.614682e-02 3 1  ON 61
ci_013                -1.921743e-02 3 1  ON 62
ci_014                 1.385261e-02 3 1  ON 63
ci_015                 1.356378e-02 3 1  ON 64
ci_016                 1.626098e-02 3 1  ON 65
ci_017                 1.653381e-02 3 1  ON 66
ci_018                 1.263148e-02 3 1  ON 67
ci_019                 1.309195e-02 3 1  ON 68
ci_020                 1.328260e-02 3 1  ON 69
ci_021                 1.336547e-02 3 1  ON 70
ci_022                 1.114451e-02 3 1  ON 71
ci_023                 1.122755e-02 3 1  ON 72
ci_024                 1.228130e-02 3 1  ON 73
ci_025                 1.155413e-02 3 1  ON 74
ci_026                 1.090539e-02 3 1  ON 75
ci_027                 1.132774e-02 3 1  ON 76
ci_028                -1.425990e-02 3 1  ON 77
ci_029                -1.490948e-02 3 1  ON 78
ci_030                -1.110520e-02 3 1  ON 79
ci_031                -1.141201e-02 3 1  ON 80
ci_032                -1.349034e-02 3 1  ON 81
ci_033                 1.065685e-02 3 1  ON 82
ci_034                 1.063557e-02 3 1  ON 83
ci_035                -4.703756e-03 3 1  ON 84
ci_036                -1.040529e-02 3 1  ON 85
ci_037                -1.005869e-02 3 1  ON 86
ci_038                 1.874278e-03 3 1  ON 87
ci_039                 1.470835e-03 3 1  ON 88
ci_040                -4.065331e-03 3 1  ON 89
ci_041                 9.805730e-03 3 1  ON 90
ci_042                 9.855049e-03 3 1  ON 91
ci_043                -2.929300e-03 3 1  ON 92
ci_044                -1.514693e-02 3 1  ON 93
ci_045                -1.826432e-03 3 1  ON 94
ci_046                 5.708497e-03 3 1  ON 95
ci_047                 5.452312e-03 3 1  ON 96
ci_048                -1.169122e-02 3 1  ON 97
ci_049                -1.200964e-02 3 1  ON 98
ci_050                 7.414107e-03 3 1  ON 99
ci_051                 7.765179e-03 3 1  ON 100
ci_052                -6.441412e-03 3 1  ON 101
ci_053                -6.307683e-03 3 1  ON 102
ci_054                -3.220440e-03 3 1  ON 103
ci_055                -3.043033e-03 3 1  ON 104
ci_056                 4.495783e-03 3 1  ON 105
ci_057                 4.396771e-03 3 1  ON 106
ci_058                -6.793640e-03 3 1  ON 107
ci_059                -6.375615e-03 3 1  ON 108
ci_060                 8.241980e-03 3 1  ON 109
ci_061                 7.905547e-03 3 1  ON 110
ci_062                -3.257553e-03 3 1  ON 111
ci_063                -2.907691e-03 3 1  ON 112
ci_064                -3.133848e-03 3 1  ON 113
ci_065                -4.351688e-03 3 1  ON 114
ci_066                 5.563454e-03 3 1  ON 115
ci_067                 5.751489e-03 3 1  ON 116
ci_068                -4.597707e-03 3 1  ON 117
ci_069                -4.608499e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0354e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7238e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.1863
    reference variance = 0.276728
====================================================
  Execution time = 3.7910e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5303e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1602e-01
  Total weights = 1.956694622e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0952e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300777913430
                                         uncertainty =       0.002400266497

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300777913430
                                         uncertainty =       0.002400266497

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388180983
  error estimate for blocks of size 2^( 2) =       0.000397980100
  error estimate for blocks of size 2^( 3) =       0.000406772462
  error estimate for blocks of size 2^( 4) =       0.000413268304
  error estimate for blocks of size 2^( 5) =       0.000416668700
  error estimate for blocks of size 2^( 6) =       0.000418970257
  error estimate for blocks of size 2^( 7) =       0.000422687662

      target function =                  N/A
              le_mean =     -17.216531083119
             les_mean =     296.724967364024
             stat err =       0.000417898731
             autocorr =       1.158973733055
              std dev =       0.548970810991
             le_variance =       0.301368951320


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721653108312e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216531083168       residual = 3.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216532061011       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216532132984       residual = 8.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216532067253       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216532277051       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216532142020       residual = 9.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216532236424       residual = 3.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216532267626       residual = 7.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216532293979       residual = 2.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216532275695       residual = 7.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.2500e+00 is 1.099791e-04

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216531083168       residual = 3.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216531335229       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216531353564       residual = 8.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216531335530       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216531387977       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216531353594       residual = 9.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216531377476       residual = 2.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216531386013       residual = 6.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216531392491       residual = 1.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216531388277       residual = 7.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.5000e+01 is 2.756785e-05

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216531083168       residual = 3.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216531146677       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216531151284       residual = 8.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216531146670       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216531159774       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216531151138       residual = 9.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216531157130       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216531159314       residual = 6.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216531160926       residual = 1.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216531159895       residual = 7.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.0000e+02 is 6.935188e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.152815 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8875e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
  uu_0                 2.062035e-01 1 1  ON 0
  uu_1                 4.539758e-02 1 1  ON 1
  uu_2                -4.680417e-02 1 1  ON 2
  uu_3                -9.936370e-02 1 1  ON 3
  uu_4                -1.304473e-01 1 1  ON 4
  uu_5                -1.356457e-01 1 1  ON 5
  uu_6                -1.130393e-01 1 1  ON 6
  uu_7                -3.972747e-02 1 1  ON 7
  uu_8                 9.988478e-02 1 1  ON 8
  uu_9                 1.208943e-01 1 1  ON 9
  ud_0                 3.495794e-01 1 1  ON 10
  ud_1                 9.178698e-02 1 1  ON 11
  ud_2                -1.648439e-02 1 1  ON 12
  ud_3                -7.595636e-02 1 1  ON 13
  ud_4                -1.217534e-01 1 1  ON 14
  ud_5                -1.523200e-01 1 1  ON 15
  ud_6                -1.544654e-01 1 1  ON 16
  ud_7                -1.100074e-01 1 1  ON 17
  ud_8                 4.459317e-03 1 1  ON 18
  ud_9                 9.258066e-02 1 1  ON 19
  eO_0                -7.504478e-01 1 1  ON 20
  eO_1                -4.355043e-01 1 1  ON 21
  eO_2                -3.598858e-02 1 1  ON 22
  eO_3                 2.081667e-01 1 1  ON 23
  eO_4                 2.891638e-01 1 1  ON 24
  eO_5                 3.052736e-01 1 1  ON 25
  eO_6                 2.501160e-01 1 1  ON 26
  eO_7                 1.121860e-01 1 1  ON 27
  eO_8                 2.793099e-02 1 1  ON 28
  eO_9                 1.846817e-02 1 1  ON 29
 eH1_0                -1.820096e-01 1 1  ON 30
 eH1_1                -1.027127e-01 1 1  ON 31
 eH1_2                -6.203337e-02 1 1  ON 32
 eH1_3                -2.594181e-02 1 1  ON 33
 eH1_4                 1.931471e-02 1 1  ON 34
 eH1_5                 3.552942e-02 1 1  ON 35
 eH1_6                 7.727954e-02 1 1  ON 36
 eH1_7                 1.103042e-01 1 1  ON 37
 eH1_8                 9.073897e-02 1 1  ON 38
 eH1_9                 2.428800e-02 1 1  ON 39
 eH2_0                -1.835261e-01 1 1  ON 40
 eH2_1                -1.038403e-01 1 1  ON 41
 eH2_2                -6.350362e-02 1 1  ON 42
 eH2_3                -2.706589e-02 1 1  ON 43
 eH2_4                 1.856750e-02 1 1  ON 44
 eH2_5                 3.505260e-02 1 1  ON 45
 eH2_6                 7.827946e-02 1 1  ON 46
 eH2_7                 1.134103e-01 1 1  ON 47
 eH2_8                 9.397458e-02 1 1  ON 48
 eH2_9                 2.639315e-02 1 1  ON 49
ci_001                -3.997155e-02 3 1  ON 50
ci_002                -3.017158e-02 3 1  ON 51
ci_003                -2.506589e-02 3 1  ON 52
ci_004                 2.111157e-02 3 1  ON 53
ci_005                 2.112797e-02 3 1  ON 54
ci_006                -1.943521e-02 3 1  ON 55
ci_007                -1.880959e-02 3 1  ON 56
ci_008                -1.774927e-02 3 1  ON 57
ci_009                -1.805640e-02 3 1  ON 58
ci_010                -1.730410e-02 3 1  ON 59
ci_011                -1.626060e-02 3 1  ON 60
ci_012                -1.615585e-02 3 1  ON 61
ci_013                -1.922392e-02 3 1  ON 62
ci_014                 1.384633e-02 3 1  ON 63
ci_015                 1.358831e-02 3 1  ON 64
ci_016                 1.626003e-02 3 1  ON 65
ci_017                 1.654106e-02 3 1  ON 66
ci_018                 1.262518e-02 3 1  ON 67
ci_019                 1.308217e-02 3 1  ON 68
ci_020                 1.328403e-02 3 1  ON 69
ci_021                 1.335401e-02 3 1  ON 70
ci_022                 1.115355e-02 3 1  ON 71
ci_023                 1.121922e-02 3 1  ON 72
ci_024                 1.228435e-02 3 1  ON 73
ci_025                 1.155434e-02 3 1  ON 74
ci_026                 1.091354e-02 3 1  ON 75
ci_027                 1.132689e-02 3 1  ON 76
ci_028                -1.425561e-02 3 1  ON 77
ci_029                -1.491097e-02 3 1  ON 78
ci_030                -1.110370e-02 3 1  ON 79
ci_031                -1.141278e-02 3 1  ON 80
ci_032                -1.350659e-02 3 1  ON 81
ci_033                 1.064370e-02 3 1  ON 82
ci_034                 1.062255e-02 3 1  ON 83
ci_035                -4.699319e-03 3 1  ON 84
ci_036                -1.040555e-02 3 1  ON 85
ci_037                -1.006841e-02 3 1  ON 86
ci_038                 1.874369e-03 3 1  ON 87
ci_039                 1.469066e-03 3 1  ON 88
ci_040                -4.069144e-03 3 1  ON 89
ci_041                 9.802393e-03 3 1  ON 90
ci_042                 9.860867e-03 3 1  ON 91
ci_043                -2.933998e-03 3 1  ON 92
ci_044                -1.514352e-02 3 1  ON 93
ci_045                -1.829273e-03 3 1  ON 94
ci_046                 5.693865e-03 3 1  ON 95
ci_047                 5.448229e-03 3 1  ON 96
ci_048                -1.168514e-02 3 1  ON 97
ci_049                -1.200990e-02 3 1  ON 98
ci_050                 7.417842e-03 3 1  ON 99
ci_051                 7.778690e-03 3 1  ON 100
ci_052                -6.445490e-03 3 1  ON 101
ci_053                -6.316219e-03 3 1  ON 102
ci_054                -3.215281e-03 3 1  ON 103
ci_055                -3.046973e-03 3 1  ON 104
ci_056                 4.500503e-03 3 1  ON 105
ci_057                 4.424245e-03 3 1  ON 106
ci_058                -6.784136e-03 3 1  ON 107
ci_059                -6.377031e-03 3 1  ON 108
ci_060                 8.242683e-03 3 1  ON 109
ci_061                 7.918232e-03 3 1  ON 110
ci_062                -3.265477e-03 3 1  ON 111
ci_063                -2.912753e-03 3 1  ON 112
ci_064                -3.134749e-03 3 1  ON 113
ci_065                -4.346379e-03 3 1  ON 114
ci_066                 5.570079e-03 3 1  ON 115
ci_067                 5.741573e-03 3 1  ON 116
ci_068                -4.598006e-03 3 1  ON 117
ci_069                -4.613557e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.1996
    reference variance = 0.453841
====================================================
  Execution time = 3.6967e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2974e-01
  Total weights = 1.9566e+06
  Execution time = 3.3666e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312053188727
                                         uncertainty =       0.008718392024

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312053188727
                                         uncertainty =       0.008718392024

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395139582
  error estimate for blocks of size 2^( 2) =       0.000405059452
  error estimate for blocks of size 2^( 3) =       0.000413968736
  error estimate for blocks of size 2^( 4) =       0.000420738197
  error estimate for blocks of size 2^( 5) =       0.000425180736
  error estimate for blocks of size 2^( 6) =       0.000426879686
  error estimate for blocks of size 2^( 7) =       0.000428730249

      target function =                  N/A
              le_mean =     -17.216643282215
             les_mean =     296.742519371390
             stat err =       0.000425382217
             autocorr =       1.158931025138
              std dev =       0.558811755309
             le_variance =       0.312270577871

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312188975540
                                         uncertainty =       0.008803911831

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312188975540
                                         uncertainty =       0.008803911831

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395225626
  error estimate for blocks of size 2^( 2) =       0.000405142097
  error estimate for blocks of size 2^( 3) =       0.000414049115
  error estimate for blocks of size 2^( 4) =       0.000420815947
  error estimate for blocks of size 2^( 5) =       0.000425259038
  error estimate for blocks of size 2^( 6) =       0.000426956293
  error estimate for blocks of size 2^( 7) =       0.000428807136

      target function =                  N/A
              le_mean =     -17.216642768295
             les_mean =     296.742604079302
             stat err =       0.000425459603
             autocorr =       1.158847984832
              std dev =       0.558933440409
             le_variance =       0.312406590807

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312122355929
                                         uncertainty =       0.008761746931

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312122355929
                                         uncertainty =       0.008761746931

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395183415
  error estimate for blocks of size 2^( 2) =       0.000405101541
  error estimate for blocks of size 2^( 3) =       0.000414009662
  error estimate for blocks of size 2^( 4) =       0.000420777770
  error estimate for blocks of size 2^( 5) =       0.000425220606
  error estimate for blocks of size 2^( 6) =       0.000426918707
  error estimate for blocks of size 2^( 7) =       0.000428769409

      target function =                  N/A
              le_mean =     -17.216642968279
             les_mean =     296.742553091359
             stat err =       0.000425421623
             autocorr =       1.158888625746
              std dev =       0.558873745530
             le_variance =       0.312339863443

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312061834014
                                         uncertainty =       0.008723817847

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312061834014
                                         uncertainty =       0.008723817847

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395145061
  error estimate for blocks of size 2^( 2) =       0.000405064712
  error estimate for blocks of size 2^( 3) =       0.000413973850
  error estimate for blocks of size 2^( 4) =       0.000420743141
  error estimate for blocks of size 2^( 5) =       0.000425185718
  error estimate for blocks of size 2^( 6) =       0.000426884563
  error estimate for blocks of size 2^( 7) =       0.000428735143

      target function =                  N/A
              le_mean =     -17.216643237392
             les_mean =     296.742522452332
             stat err =       0.000425387141
             autocorr =       1.158925716130
              std dev =       0.558819504084
             le_variance =       0.312279238145


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216643282215        initial  <--
     6.2500e+00     6.2500e+01             1.0998e-04       -17.216642768295
     2.5000e+01     2.5000e+02             2.7568e-05       -17.216642968279
     1.0000e+02     1.0000e+03             6.9352e-06       -17.216643237392

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.9726
  </log>
  <optVariables href="H2O.s003.opt.xml">
  uu_0                 2.061924e-01 1 1  ON 0
  uu_1                 4.539034e-02 1 1  ON 1
  uu_2                -4.680642e-02 1 1  ON 2
  uu_3                -9.936286e-02 1 1  ON 3
  uu_4                -1.304423e-01 1 1  ON 4
  uu_5                -1.356400e-01 1 1  ON 5
  uu_6                -1.130351e-01 1 1  ON 6
  uu_7                -3.972131e-02 1 1  ON 7
  uu_8                 9.988805e-02 1 1  ON 8
  uu_9                 1.208921e-01 1 1  ON 9
  ud_0                 3.495752e-01 1 1  ON 10
  ud_1                 9.178402e-02 1 1  ON 11
  ud_2                -1.648723e-02 1 1  ON 12
  ud_3                -7.596219e-02 1 1  ON 13
  ud_4                -1.217488e-01 1 1  ON 14
  ud_5                -1.523202e-01 1 1  ON 15
  ud_6                -1.544630e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.465296e-03 1 1  ON 18
  ud_9                 9.258153e-02 1 1  ON 19
  eO_0                -7.504217e-01 1 1  ON 20
  eO_1                -4.354879e-01 1 1  ON 21
  eO_2                -3.597947e-02 1 1  ON 22
  eO_3                 2.081559e-01 1 1  ON 23
  eO_4                 2.891363e-01 1 1  ON 24
  eO_5                 3.052682e-01 1 1  ON 25
  eO_6                 2.501135e-01 1 1  ON 26
  eO_7                 1.121817e-01 1 1  ON 27
  eO_8                 2.793026e-02 1 1  ON 28
  eO_9                 1.846806e-02 1 1  ON 29
 eH1_0                -1.820099e-01 1 1  ON 30
 eH1_1                -1.027121e-01 1 1  ON 31
 eH1_2                -6.202845e-02 1 1  ON 32
 eH1_3                -2.594564e-02 1 1  ON 33
 eH1_4                 1.931531e-02 1 1  ON 34
 eH1_5                 3.552815e-02 1 1  ON 35
 eH1_6                 7.727968e-02 1 1  ON 36
 eH1_7                 1.103064e-01 1 1  ON 37
 eH1_8                 9.073677e-02 1 1  ON 38
 eH1_9                 2.428737e-02 1 1  ON 39
 eH2_0                -1.835292e-01 1 1  ON 40
 eH2_1                -1.038361e-01 1 1  ON 41
 eH2_2                -6.350512e-02 1 1  ON 42
 eH2_3                -2.706152e-02 1 1  ON 43
 eH2_4                 1.856819e-02 1 1  ON 44
 eH2_5                 3.504984e-02 1 1  ON 45
 eH2_6                 7.827829e-02 1 1  ON 46
 eH2_7                 1.134126e-01 1 1  ON 47
 eH2_8                 9.397251e-02 1 1  ON 48
 eH2_9                 2.639235e-02 1 1  ON 49
ci_001                -3.996448e-02 3 1  ON 50
ci_002                -3.016664e-02 3 1  ON 51
ci_003                -2.507372e-02 3 1  ON 52
ci_004                 2.111264e-02 3 1  ON 53
ci_005                 2.113621e-02 3 1  ON 54
ci_006                -1.943413e-02 3 1  ON 55
ci_007                -1.880484e-02 3 1  ON 56
ci_008                -1.774309e-02 3 1  ON 57
ci_009                -1.805847e-02 3 1  ON 58
ci_010                -1.730296e-02 3 1  ON 59
ci_011                -1.626631e-02 3 1  ON 60
ci_012                -1.614682e-02 3 1  ON 61
ci_013                -1.921743e-02 3 1  ON 62
ci_014                 1.385261e-02 3 1  ON 63
ci_015                 1.356378e-02 3 1  ON 64
ci_016                 1.626098e-02 3 1  ON 65
ci_017                 1.653381e-02 3 1  ON 66
ci_018                 1.263148e-02 3 1  ON 67
ci_019                 1.309195e-02 3 1  ON 68
ci_020                 1.328260e-02 3 1  ON 69
ci_021                 1.336547e-02 3 1  ON 70
ci_022                 1.114451e-02 3 1  ON 71
ci_023                 1.122755e-02 3 1  ON 72
ci_024                 1.228130e-02 3 1  ON 73
ci_025                 1.155413e-02 3 1  ON 74
ci_026                 1.090539e-02 3 1  ON 75
ci_027                 1.132774e-02 3 1  ON 76
ci_028                -1.425990e-02 3 1  ON 77
ci_029                -1.490948e-02 3 1  ON 78
ci_030                -1.110520e-02 3 1  ON 79
ci_031                -1.141201e-02 3 1  ON 80
ci_032                -1.349034e-02 3 1  ON 81
ci_033                 1.065685e-02 3 1  ON 82
ci_034                 1.063557e-02 3 1  ON 83
ci_035                -4.703756e-03 3 1  ON 84
ci_036                -1.040529e-02 3 1  ON 85
ci_037                -1.005869e-02 3 1  ON 86
ci_038                 1.874278e-03 3 1  ON 87
ci_039                 1.470835e-03 3 1  ON 88
ci_040                -4.065331e-03 3 1  ON 89
ci_041                 9.805730e-03 3 1  ON 90
ci_042                 9.855049e-03 3 1  ON 91
ci_043                -2.929300e-03 3 1  ON 92
ci_044                -1.514693e-02 3 1  ON 93
ci_045                -1.826432e-03 3 1  ON 94
ci_046                 5.708497e-03 3 1  ON 95
ci_047                 5.452312e-03 3 1  ON 96
ci_048                -1.169122e-02 3 1  ON 97
ci_049                -1.200964e-02 3 1  ON 98
ci_050                 7.414107e-03 3 1  ON 99
ci_051                 7.765179e-03 3 1  ON 100
ci_052                -6.441412e-03 3 1  ON 101
ci_053                -6.307683e-03 3 1  ON 102
ci_054                -3.220440e-03 3 1  ON 103
ci_055                -3.043033e-03 3 1  ON 104
ci_056                 4.495783e-03 3 1  ON 105
ci_057                 4.396771e-03 3 1  ON 106
ci_058                -6.793640e-03 3 1  ON 107
ci_059                -6.375615e-03 3 1  ON 108
ci_060                 8.241980e-03 3 1  ON 109
ci_061                 7.905547e-03 3 1  ON 110
ci_062                -3.257553e-03 3 1  ON 111
ci_063                -2.907691e-03 3 1  ON 112
ci_064                -3.133848e-03 3 1  ON 113
ci_065                -4.351688e-03 3 1  ON 114
ci_066                 5.563454e-03 3 1  ON 115
ci_067                 5.751489e-03 3 1  ON 116
ci_068                -4.597707e-03 3 1  ON 117
ci_069                -4.608499e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0285e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7227e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.158
    reference variance = 0.225111
====================================================
  Execution time = 3.7980e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5295e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1203e-01
  Total weights = 1.956763603e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1146e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297925136516
                                         uncertainty =       0.001846918247

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297925136516
                                         uncertainty =       0.001846918247

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385884088
  error estimate for blocks of size 2^( 2) =       0.000395416866
  error estimate for blocks of size 2^( 3) =       0.000404494913
  error estimate for blocks of size 2^( 4) =       0.000411095787
  error estimate for blocks of size 2^( 5) =       0.000413806078
  error estimate for blocks of size 2^( 6) =       0.000415940917
  error estimate for blocks of size 2^( 7) =       0.000416389229

      target function =                  N/A
              le_mean =     -17.216581623887
             les_mean =     296.722714521358
             stat err =       0.000414308003
             autocorr =       1.152744083582
              std dev =       0.545722511355
             le_variance =       0.297813059400


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721658162389e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216581623931       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216581703989       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216581699626       residual = 4.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216581677924       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216581699430       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216581701175       residual = 9.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216581700744       residual = 2.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216581703768       residual = 2.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216581701870       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216581701161       residual = 3.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.2500e+01 is 1.086149e-05

solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216581623931       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216581644005       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216581642915       residual = 4.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216581637494       residual = 3.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216581642880       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216581643293       residual = 9.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216581643183       residual = 2.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216581643945       residual = 2.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216581643475       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216581643294       residual = 3.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.5000e+02 is 2.716066e-06

solving harmonic davidson linear method for identity shift 1.0000e+03, overlap shift 1.0000e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216581623931       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216581628954       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216581628681       residual = 4.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216581627326       residual = 3.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216581628674       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216581628775       residual = 9.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216581628748       residual = 2.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216581628937       residual = 2.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216581628818       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216581628776       residual = 3.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.0000e+03 is 6.790600e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.156787 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.9139e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
  uu_0                 2.061930e-01 1 1  ON 0
  uu_1                 4.539081e-02 1 1  ON 1
  uu_2                -4.680589e-02 1 1  ON 2
  uu_3                -9.936310e-02 1 1  ON 3
  uu_4                -1.304428e-01 1 1  ON 4
  uu_5                -1.356406e-01 1 1  ON 5
  uu_6                -1.130355e-01 1 1  ON 6
  uu_7                -3.972163e-02 1 1  ON 7
  uu_8                 9.988791e-02 1 1  ON 8
  uu_9                 1.208924e-01 1 1  ON 9
  ud_0                 3.495756e-01 1 1  ON 10
  ud_1                 9.178435e-02 1 1  ON 11
  ud_2                -1.648701e-02 1 1  ON 12
  ud_3                -7.596181e-02 1 1  ON 13
  ud_4                -1.217494e-01 1 1  ON 14
  ud_5                -1.523203e-01 1 1  ON 15
  ud_6                -1.544633e-01 1 1  ON 16
  ud_7                -1.100037e-01 1 1  ON 17
  ud_8                 4.464840e-03 1 1  ON 18
  ud_9                 9.258158e-02 1 1  ON 19
  eO_0                -7.504243e-01 1 1  ON 20
  eO_1                -4.354899e-01 1 1  ON 21
  eO_2                -3.598022e-02 1 1  ON 22
  eO_3                 2.081573e-01 1 1  ON 23
  eO_4                 2.891390e-01 1 1  ON 24
  eO_5                 3.052686e-01 1 1  ON 25
  eO_6                 2.501137e-01 1 1  ON 26
  eO_7                 1.121822e-01 1 1  ON 27
  eO_8                 2.793035e-02 1 1  ON 28
  eO_9                 1.846810e-02 1 1  ON 29
 eH1_0                -1.820106e-01 1 1  ON 30
 eH1_1                -1.027119e-01 1 1  ON 31
 eH1_2                -6.202885e-02 1 1  ON 32
 eH1_3                -2.594548e-02 1 1  ON 33
 eH1_4                 1.931546e-02 1 1  ON 34
 eH1_5                 3.552821e-02 1 1  ON 35
 eH1_6                 7.727995e-02 1 1  ON 36
 eH1_7                 1.103063e-01 1 1  ON 37
 eH1_8                 9.073701e-02 1 1  ON 38
 eH1_9                 2.428745e-02 1 1  ON 39
 eH2_0                -1.835294e-01 1 1  ON 40
 eH2_1                -1.038361e-01 1 1  ON 41
 eH2_2                -6.350460e-02 1 1  ON 42
 eH2_3                -2.706178e-02 1 1  ON 43
 eH2_4                 1.856808e-02 1 1  ON 44
 eH2_5                 3.504958e-02 1 1  ON 45
 eH2_6                 7.827821e-02 1 1  ON 46
 eH2_7                 1.134125e-01 1 1  ON 47
 eH2_8                 9.397280e-02 1 1  ON 48
 eH2_9                 2.639245e-02 1 1  ON 49
ci_001                -3.996540e-02 3 1  ON 50
ci_002                -3.016711e-02 3 1  ON 51
ci_003                -2.507435e-02 3 1  ON 52
ci_004                 2.111273e-02 3 1  ON 53
ci_005                 2.113696e-02 3 1  ON 54
ci_006                -1.943279e-02 3 1  ON 55
ci_007                -1.880458e-02 3 1  ON 56
ci_008                -1.774241e-02 3 1  ON 57
ci_009                -1.805875e-02 3 1  ON 58
ci_010                -1.730223e-02 3 1  ON 59
ci_011                -1.626524e-02 3 1  ON 60
ci_012                -1.614672e-02 3 1  ON 61
ci_013                -1.921727e-02 3 1  ON 62
ci_014                 1.385213e-02 3 1  ON 63
ci_015                 1.356410e-02 3 1  ON 64
ci_016                 1.626094e-02 3 1  ON 65
ci_017                 1.653369e-02 3 1  ON 66
ci_018                 1.263211e-02 3 1  ON 67
ci_019                 1.309178e-02 3 1  ON 68
ci_020                 1.328335e-02 3 1  ON 69
ci_021                 1.336522e-02 3 1  ON 70
ci_022                 1.114497e-02 3 1  ON 71
ci_023                 1.122808e-02 3 1  ON 72
ci_024                 1.228147e-02 3 1  ON 73
ci_025                 1.155326e-02 3 1  ON 74
ci_026                 1.090602e-02 3 1  ON 75
ci_027                 1.132831e-02 3 1  ON 76
ci_028                -1.426003e-02 3 1  ON 77
ci_029                -1.490958e-02 3 1  ON 78
ci_030                -1.110555e-02 3 1  ON 79
ci_031                -1.141202e-02 3 1  ON 80
ci_032                -1.348990e-02 3 1  ON 81
ci_033                 1.065712e-02 3 1  ON 82
ci_034                 1.063486e-02 3 1  ON 83
ci_035                -4.703742e-03 3 1  ON 84
ci_036                -1.040516e-02 3 1  ON 85
ci_037                -1.005891e-02 3 1  ON 86
ci_038                 1.873893e-03 3 1  ON 87
ci_039                 1.471417e-03 3 1  ON 88
ci_040                -4.064977e-03 3 1  ON 89
ci_041                 9.805489e-03 3 1  ON 90
ci_042                 9.855017e-03 3 1  ON 91
ci_043                -2.929445e-03 3 1  ON 92
ci_044                -1.514654e-02 3 1  ON 93
ci_045                -1.826518e-03 3 1  ON 94
ci_046                 5.707756e-03 3 1  ON 95
ci_047                 5.452131e-03 3 1  ON 96
ci_048                -1.169179e-02 3 1  ON 97
ci_049                -1.200923e-02 3 1  ON 98
ci_050                 7.414216e-03 3 1  ON 99
ci_051                 7.764059e-03 3 1  ON 100
ci_052                -6.441027e-03 3 1  ON 101
ci_053                -6.308041e-03 3 1  ON 102
ci_054                -3.220498e-03 3 1  ON 103
ci_055                -3.042771e-03 3 1  ON 104
ci_056                 4.496558e-03 3 1  ON 105
ci_057                 4.397283e-03 3 1  ON 106
ci_058                -6.793365e-03 3 1  ON 107
ci_059                -6.377032e-03 3 1  ON 108
ci_060                 8.242929e-03 3 1  ON 109
ci_061                 7.906200e-03 3 1  ON 110
ci_062                -3.256432e-03 3 1  ON 111
ci_063                -2.907722e-03 3 1  ON 112
ci_064                -3.134248e-03 3 1  ON 113
ci_065                -4.351342e-03 3 1  ON 114
ci_066                 5.563301e-03 3 1  ON 115
ci_067                 5.752107e-03 3 1  ON 116
ci_068                -4.597751e-03 3 1  ON 117
ci_069                -4.608060e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.2275
    reference variance = 0.162648
====================================================
  Execution time = 3.7101e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1330e-01
  Total weights = 1.9567e+06
  Execution time = 3.3552e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299591455071
                                         uncertainty =       0.002393751044

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299591455071
                                         uncertainty =       0.002393751044

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387099735
  error estimate for blocks of size 2^( 2) =       0.000397137582
  error estimate for blocks of size 2^( 3) =       0.000406340279
  error estimate for blocks of size 2^( 4) =       0.000413574647
  error estimate for blocks of size 2^( 5) =       0.000417418820
  error estimate for blocks of size 2^( 6) =       0.000418412667
  error estimate for blocks of size 2^( 7) =       0.000420525804

      target function =                  N/A
              le_mean =     -17.215697077182
             les_mean =     296.693523398339
             stat err =       0.000417482984
             autocorr =       1.163139516890
              std dev =       0.547441695042
             le_variance =       0.299692409470

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299588947935
                                         uncertainty =       0.002393778389

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299588947935
                                         uncertainty =       0.002393778389

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387098108
  error estimate for blocks of size 2^( 2) =       0.000397135947
  error estimate for blocks of size 2^( 3) =       0.000406338707
  error estimate for blocks of size 2^( 4) =       0.000413573123
  error estimate for blocks of size 2^( 5) =       0.000417417186
  error estimate for blocks of size 2^( 6) =       0.000418411024
  error estimate for blocks of size 2^( 7) =       0.000420524068

      target function =                  N/A
              le_mean =     -17.215697068603
             les_mean =     296.693520309850
             stat err =       0.000417481350
             autocorr =       1.163140190149
              std dev =       0.547439393801
             le_variance =       0.299689889885

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299590194527
                                         uncertainty =       0.002393764727

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299590194527
                                         uncertainty =       0.002393764727

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387098917
  error estimate for blocks of size 2^( 2) =       0.000397136760
  error estimate for blocks of size 2^( 3) =       0.000406339489
  error estimate for blocks of size 2^( 4) =       0.000413573880
  error estimate for blocks of size 2^( 5) =       0.000417417998
  error estimate for blocks of size 2^( 6) =       0.000418411841
  error estimate for blocks of size 2^( 7) =       0.000420524932

      target function =                  N/A
              le_mean =     -17.215697072759
             les_mean =     296.693521258800
             stat err =       0.000417482163
             autocorr =       1.163139856390
              std dev =       0.547440538027
             le_variance =       0.299691142675

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299591297144
                                         uncertainty =       0.002393752751

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299591297144
                                         uncertainty =       0.002393752751

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387099632
  error estimate for blocks of size 2^( 2) =       0.000397137479
  error estimate for blocks of size 2^( 3) =       0.000406340180
  error estimate for blocks of size 2^( 4) =       0.000413574551
  error estimate for blocks of size 2^( 5) =       0.000417418717
  error estimate for blocks of size 2^( 6) =       0.000418412564
  error estimate for blocks of size 2^( 7) =       0.000420525695

      target function =                  N/A
              le_mean =     -17.215697076616
             les_mean =     296.693523018053
             stat err =       0.000417482881
             autocorr =       1.163139559524
              std dev =       0.547441550086
             le_variance =       0.299692250761


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215697077182        initial  <--
     6.2500e+01     6.2500e+02             1.0861e-05       -17.215697068603
     2.5000e+02     2.5000e+03             2.7161e-06       -17.215697072759
     1.0000e+03     1.0000e+04             6.7906e-07       -17.215697076616

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 56.3912
  </log>
  <optVariables href="H2O.s004.opt.xml">
  uu_0                 2.061924e-01 1 1  ON 0
  uu_1                 4.539034e-02 1 1  ON 1
  uu_2                -4.680642e-02 1 1  ON 2
  uu_3                -9.936286e-02 1 1  ON 3
  uu_4                -1.304423e-01 1 1  ON 4
  uu_5                -1.356400e-01 1 1  ON 5
  uu_6                -1.130351e-01 1 1  ON 6
  uu_7                -3.972131e-02 1 1  ON 7
  uu_8                 9.988805e-02 1 1  ON 8
  uu_9                 1.208921e-01 1 1  ON 9
  ud_0                 3.495752e-01 1 1  ON 10
  ud_1                 9.178402e-02 1 1  ON 11
  ud_2                -1.648723e-02 1 1  ON 12
  ud_3                -7.596219e-02 1 1  ON 13
  ud_4                -1.217488e-01 1 1  ON 14
  ud_5                -1.523202e-01 1 1  ON 15
  ud_6                -1.544630e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.465296e-03 1 1  ON 18
  ud_9                 9.258153e-02 1 1  ON 19
  eO_0                -7.504217e-01 1 1  ON 20
  eO_1                -4.354879e-01 1 1  ON 21
  eO_2                -3.597947e-02 1 1  ON 22
  eO_3                 2.081559e-01 1 1  ON 23
  eO_4                 2.891363e-01 1 1  ON 24
  eO_5                 3.052682e-01 1 1  ON 25
  eO_6                 2.501135e-01 1 1  ON 26
  eO_7                 1.121817e-01 1 1  ON 27
  eO_8                 2.793026e-02 1 1  ON 28
  eO_9                 1.846806e-02 1 1  ON 29
 eH1_0                -1.820099e-01 1 1  ON 30
 eH1_1                -1.027121e-01 1 1  ON 31
 eH1_2                -6.202845e-02 1 1  ON 32
 eH1_3                -2.594564e-02 1 1  ON 33
 eH1_4                 1.931531e-02 1 1  ON 34
 eH1_5                 3.552815e-02 1 1  ON 35
 eH1_6                 7.727968e-02 1 1  ON 36
 eH1_7                 1.103064e-01 1 1  ON 37
 eH1_8                 9.073677e-02 1 1  ON 38
 eH1_9                 2.428737e-02 1 1  ON 39
 eH2_0                -1.835292e-01 1 1  ON 40
 eH2_1                -1.038361e-01 1 1  ON 41
 eH2_2                -6.350512e-02 1 1  ON 42
 eH2_3                -2.706152e-02 1 1  ON 43
 eH2_4                 1.856819e-02 1 1  ON 44
 eH2_5                 3.504984e-02 1 1  ON 45
 eH2_6                 7.827829e-02 1 1  ON 46
 eH2_7                 1.134126e-01 1 1  ON 47
 eH2_8                 9.397251e-02 1 1  ON 48
 eH2_9                 2.639235e-02 1 1  ON 49
ci_001                -3.996448e-02 3 1  ON 50
ci_002                -3.016664e-02 3 1  ON 51
ci_003                -2.507372e-02 3 1  ON 52
ci_004                 2.111264e-02 3 1  ON 53
ci_005                 2.113621e-02 3 1  ON 54
ci_006                -1.943413e-02 3 1  ON 55
ci_007                -1.880484e-02 3 1  ON 56
ci_008                -1.774309e-02 3 1  ON 57
ci_009                -1.805847e-02 3 1  ON 58
ci_010                -1.730296e-02 3 1  ON 59
ci_011                -1.626631e-02 3 1  ON 60
ci_012                -1.614682e-02 3 1  ON 61
ci_013                -1.921743e-02 3 1  ON 62
ci_014                 1.385261e-02 3 1  ON 63
ci_015                 1.356378e-02 3 1  ON 64
ci_016                 1.626098e-02 3 1  ON 65
ci_017                 1.653381e-02 3 1  ON 66
ci_018                 1.263148e-02 3 1  ON 67
ci_019                 1.309195e-02 3 1  ON 68
ci_020                 1.328260e-02 3 1  ON 69
ci_021                 1.336547e-02 3 1  ON 70
ci_022                 1.114451e-02 3 1  ON 71
ci_023                 1.122755e-02 3 1  ON 72
ci_024                 1.228130e-02 3 1  ON 73
ci_025                 1.155413e-02 3 1  ON 74
ci_026                 1.090539e-02 3 1  ON 75
ci_027                 1.132774e-02 3 1  ON 76
ci_028                -1.425990e-02 3 1  ON 77
ci_029                -1.490948e-02 3 1  ON 78
ci_030                -1.110520e-02 3 1  ON 79
ci_031                -1.141201e-02 3 1  ON 80
ci_032                -1.349034e-02 3 1  ON 81
ci_033                 1.065685e-02 3 1  ON 82
ci_034                 1.063557e-02 3 1  ON 83
ci_035                -4.703756e-03 3 1  ON 84
ci_036                -1.040529e-02 3 1  ON 85
ci_037                -1.005869e-02 3 1  ON 86
ci_038                 1.874278e-03 3 1  ON 87
ci_039                 1.470835e-03 3 1  ON 88
ci_040                -4.065331e-03 3 1  ON 89
ci_041                 9.805730e-03 3 1  ON 90
ci_042                 9.855049e-03 3 1  ON 91
ci_043                -2.929300e-03 3 1  ON 92
ci_044                -1.514693e-02 3 1  ON 93
ci_045                -1.826432e-03 3 1  ON 94
ci_046                 5.708497e-03 3 1  ON 95
ci_047                 5.452312e-03 3 1  ON 96
ci_048                -1.169122e-02 3 1  ON 97
ci_049                -1.200964e-02 3 1  ON 98
ci_050                 7.414107e-03 3 1  ON 99
ci_051                 7.765179e-03 3 1  ON 100
ci_052                -6.441412e-03 3 1  ON 101
ci_053                -6.307683e-03 3 1  ON 102
ci_054                -3.220440e-03 3 1  ON 103
ci_055                -3.043033e-03 3 1  ON 104
ci_056                 4.495783e-03 3 1  ON 105
ci_057                 4.396771e-03 3 1  ON 106
ci_058                -6.793640e-03 3 1  ON 107
ci_059                -6.375615e-03 3 1  ON 108
ci_060                 8.241980e-03 3 1  ON 109
ci_061                 7.905547e-03 3 1  ON 110
ci_062                -3.257553e-03 3 1  ON 111
ci_063                -2.907691e-03 3 1  ON 112
ci_064                -3.133848e-03 3 1  ON 113
ci_065                -4.351688e-03 3 1  ON 114
ci_066                 5.563454e-03 3 1  ON 115
ci_067                 5.751489e-03 3 1  ON 116
ci_068                -4.597707e-03 3 1  ON 117
ci_069                -4.608499e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0554e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.2406
    reference variance = 0.263042
====================================================
  Execution time = 3.7665e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5298e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1853e-01
  Total weights = 1.956530692e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1190e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304392616994
                                         uncertainty =       0.002155874401

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304392616994
                                         uncertainty =       0.002155874401

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390051308
  error estimate for blocks of size 2^( 2) =       0.000400551553
  error estimate for blocks of size 2^( 3) =       0.000409414805
  error estimate for blocks of size 2^( 4) =       0.000416256674
  error estimate for blocks of size 2^( 5) =       0.000420578686
  error estimate for blocks of size 2^( 6) =       0.000421696902
  error estimate for blocks of size 2^( 7) =       0.000422186111

      target function =                  N/A
              le_mean =     -17.217049164719
             les_mean =     296.745314392666
             stat err =       0.000420179593
             autocorr =       1.160450007683
              std dev =       0.551615849759
             le_variance =       0.304280045705


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721704916472e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217049164770       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217049173709       residual = 7.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217049173250       residual = 3.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217049174449       residual = 3.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217049173746       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217049175673       residual = 3.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217049174916       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217049175159       residual = 3.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217049175036       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217049175020       residual = 2.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.2500e+02 is 1.221595e-06

solving harmonic davidson linear method for identity shift 2.5000e+03, overlap shift 2.5000e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217049164770       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217049167005       residual = 7.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217049166890       residual = 3.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217049167190       residual = 3.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217049167013       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217049167494       residual = 3.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217049167306       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217049167358       residual = 3.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217049167336       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217049167336       residual = 2.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.5000e+03 is 3.054212e-07

solving harmonic davidson linear method for identity shift 1.0000e+04, overlap shift 1.0000e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217049164770       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217049165328       residual = 7.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217049165300       residual = 3.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217049165378       residual = 3.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217049165330       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217049165459       residual = 3.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217049165414       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217049165405       residual = 3.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217049165414       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217049165426       residual = 2.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.0000e+04 is 7.635670e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.160740 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8867e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
  uu_0                 2.061924e-01 1 1  ON 0
  uu_1                 4.539038e-02 1 1  ON 1
  uu_2                -4.680640e-02 1 1  ON 2
  uu_3                -9.936288e-02 1 1  ON 3
  uu_4                -1.304424e-01 1 1  ON 4
  uu_5                -1.356400e-01 1 1  ON 5
  uu_6                -1.130351e-01 1 1  ON 6
  uu_7                -3.972135e-02 1 1  ON 7
  uu_8                 9.988803e-02 1 1  ON 8
  uu_9                 1.208921e-01 1 1  ON 9
  ud_0                 3.495753e-01 1 1  ON 10
  ud_1                 9.178406e-02 1 1  ON 11
  ud_2                -1.648722e-02 1 1  ON 12
  ud_3                -7.596221e-02 1 1  ON 13
  ud_4                -1.217489e-01 1 1  ON 14
  ud_5                -1.523202e-01 1 1  ON 15
  ud_6                -1.544630e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.465255e-03 1 1  ON 18
  ud_9                 9.258154e-02 1 1  ON 19
  eO_0                -7.504220e-01 1 1  ON 20
  eO_1                -4.354880e-01 1 1  ON 21
  eO_2                -3.597955e-02 1 1  ON 22
  eO_3                 2.081560e-01 1 1  ON 23
  eO_4                 2.891366e-01 1 1  ON 24
  eO_5                 3.052683e-01 1 1  ON 25
  eO_6                 2.501135e-01 1 1  ON 26
  eO_7                 1.121817e-01 1 1  ON 27
  eO_8                 2.793027e-02 1 1  ON 28
  eO_9                 1.846806e-02 1 1  ON 29
 eH1_0                -1.820099e-01 1 1  ON 30
 eH1_1                -1.027121e-01 1 1  ON 31
 eH1_2                -6.202847e-02 1 1  ON 32
 eH1_3                -2.594564e-02 1 1  ON 33
 eH1_4                 1.931533e-02 1 1  ON 34
 eH1_5                 3.552815e-02 1 1  ON 35
 eH1_6                 7.727970e-02 1 1  ON 36
 eH1_7                 1.103064e-01 1 1  ON 37
 eH1_8                 9.073680e-02 1 1  ON 38
 eH1_9                 2.428738e-02 1 1  ON 39
 eH2_0                -1.835292e-01 1 1  ON 40
 eH2_1                -1.038361e-01 1 1  ON 41
 eH2_2                -6.350514e-02 1 1  ON 42
 eH2_3                -2.706152e-02 1 1  ON 43
 eH2_4                 1.856817e-02 1 1  ON 44
 eH2_5                 3.504986e-02 1 1  ON 45
 eH2_6                 7.827828e-02 1 1  ON 46
 eH2_7                 1.134126e-01 1 1  ON 47
 eH2_8                 9.397254e-02 1 1  ON 48
 eH2_9                 2.639236e-02 1 1  ON 49
ci_001                -3.996450e-02 3 1  ON 50
ci_002                -3.016659e-02 3 1  ON 51
ci_003                -2.507368e-02 3 1  ON 52
ci_004                 2.111262e-02 3 1  ON 53
ci_005                 2.113615e-02 3 1  ON 54
ci_006                -1.943415e-02 3 1  ON 55
ci_007                -1.880476e-02 3 1  ON 56
ci_008                -1.774307e-02 3 1  ON 57
ci_009                -1.805847e-02 3 1  ON 58
ci_010                -1.730295e-02 3 1  ON 59
ci_011                -1.626633e-02 3 1  ON 60
ci_012                -1.614686e-02 3 1  ON 61
ci_013                -1.921750e-02 3 1  ON 62
ci_014                 1.385265e-02 3 1  ON 63
ci_015                 1.356373e-02 3 1  ON 64
ci_016                 1.626100e-02 3 1  ON 65
ci_017                 1.653389e-02 3 1  ON 66
ci_018                 1.263145e-02 3 1  ON 67
ci_019                 1.309194e-02 3 1  ON 68
ci_020                 1.328257e-02 3 1  ON 69
ci_021                 1.336546e-02 3 1  ON 70
ci_022                 1.114448e-02 3 1  ON 71
ci_023                 1.122757e-02 3 1  ON 72
ci_024                 1.228122e-02 3 1  ON 73
ci_025                 1.155416e-02 3 1  ON 74
ci_026                 1.090542e-02 3 1  ON 75
ci_027                 1.132763e-02 3 1  ON 76
ci_028                -1.425986e-02 3 1  ON 77
ci_029                -1.490940e-02 3 1  ON 78
ci_030                -1.110529e-02 3 1  ON 79
ci_031                -1.141194e-02 3 1  ON 80
ci_032                -1.349039e-02 3 1  ON 81
ci_033                 1.065686e-02 3 1  ON 82
ci_034                 1.063550e-02 3 1  ON 83
ci_035                -4.703743e-03 3 1  ON 84
ci_036                -1.040525e-02 3 1  ON 85
ci_037                -1.005866e-02 3 1  ON 86
ci_038                 1.874211e-03 3 1  ON 87
ci_039                 1.470860e-03 3 1  ON 88
ci_040                -4.065344e-03 3 1  ON 89
ci_041                 9.805687e-03 3 1  ON 90
ci_042                 9.855108e-03 3 1  ON 91
ci_043                -2.929226e-03 3 1  ON 92
ci_044                -1.514687e-02 3 1  ON 93
ci_045                -1.826409e-03 3 1  ON 94
ci_046                 5.708490e-03 3 1  ON 95
ci_047                 5.452376e-03 3 1  ON 96
ci_048                -1.169121e-02 3 1  ON 97
ci_049                -1.200961e-02 3 1  ON 98
ci_050                 7.414127e-03 3 1  ON 99
ci_051                 7.765204e-03 3 1  ON 100
ci_052                -6.441463e-03 3 1  ON 101
ci_053                -6.307718e-03 3 1  ON 102
ci_054                -3.220408e-03 3 1  ON 103
ci_055                -3.043093e-03 3 1  ON 104
ci_056                 4.495650e-03 3 1  ON 105
ci_057                 4.396793e-03 3 1  ON 106
ci_058                -6.793756e-03 3 1  ON 107
ci_059                -6.375664e-03 3 1  ON 108
ci_060                 8.242000e-03 3 1  ON 109
ci_061                 7.905664e-03 3 1  ON 110
ci_062                -3.257561e-03 3 1  ON 111
ci_063                -2.907689e-03 3 1  ON 112
ci_064                -3.133819e-03 3 1  ON 113
ci_065                -4.351664e-03 3 1  ON 114
ci_066                 5.563459e-03 3 1  ON 115
ci_067                 5.751459e-03 3 1  ON 116
ci_068                -4.597650e-03 3 1  ON 117
ci_069                -4.608498e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.2612
    reference variance = 0.148282
====================================================
  Execution time = 3.7072e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1547e-01
  Total weights = 1.9567e+06
  Execution time = 3.3417e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299593821387
                                         uncertainty =       0.002216654602

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299593821387
                                         uncertainty =       0.002216654602

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387049455
  error estimate for blocks of size 2^( 2) =       0.000396903410
  error estimate for blocks of size 2^( 3) =       0.000405967465
  error estimate for blocks of size 2^( 4) =       0.000412748162
  error estimate for blocks of size 2^( 5) =       0.000416294428
  error estimate for blocks of size 2^( 6) =       0.000418368338
  error estimate for blocks of size 2^( 7) =       0.000419236309

      target function =                  N/A
              le_mean =     -17.216966610436
             les_mean =     296.739404295540
             stat err =       0.000416661809
             autocorr =       1.158869334680
              std dev =       0.547370587954
             le_variance =       0.299614560557

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299594298603
                                         uncertainty =       0.002216672583

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299594298603
                                         uncertainty =       0.002216672583

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387049763
  error estimate for blocks of size 2^( 2) =       0.000396903699
  error estimate for blocks of size 2^( 3) =       0.000405967745
  error estimate for blocks of size 2^( 4) =       0.000412748441
  error estimate for blocks of size 2^( 5) =       0.000416294709
  error estimate for blocks of size 2^( 6) =       0.000418368618
  error estimate for blocks of size 2^( 7) =       0.000419236590

      target function =                  N/A
              le_mean =     -17.216966612366
             les_mean =     296.739405841970
             stat err =       0.000416662089
             autocorr =       1.158869048711
              std dev =       0.547371023680
             le_variance =       0.299615037564

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299594060051
                                         uncertainty =       0.002216663595

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299594060051
                                         uncertainty =       0.002216663595

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387049609
  error estimate for blocks of size 2^( 2) =       0.000396903554
  error estimate for blocks of size 2^( 3) =       0.000405967605
  error estimate for blocks of size 2^( 4) =       0.000412748302
  error estimate for blocks of size 2^( 5) =       0.000416294569
  error estimate for blocks of size 2^( 6) =       0.000418368478
  error estimate for blocks of size 2^( 7) =       0.000419236449

      target function =                  N/A
              le_mean =     -17.216966611400
             les_mean =     296.739405068073
             stat err =       0.000416661949
             autocorr =       1.158869191668
              std dev =       0.547370805868
             le_variance =       0.299614799116

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299593851221
                                         uncertainty =       0.002216655726

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299593851221
                                         uncertainty =       0.002216655726

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387049474
  error estimate for blocks of size 2^( 2) =       0.000396903428
  error estimate for blocks of size 2^( 3) =       0.000405967483
  error estimate for blocks of size 2^( 4) =       0.000412748179
  error estimate for blocks of size 2^( 5) =       0.000416294445
  error estimate for blocks of size 2^( 6) =       0.000418368356
  error estimate for blocks of size 2^( 7) =       0.000419236326

      target function =                  N/A
              le_mean =     -17.216966610556
             les_mean =     296.739404392005
             stat err =       0.000416661827
             autocorr =       1.158869316801
              std dev =       0.547370615194
             le_variance =       0.299614590377


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216966610436        initial
     6.2500e+02     6.2500e+03             1.2216e-06       -17.216966612366  <--
     2.5000e+03     2.5000e+04             3.0542e-07       -17.216966611400
     1.0000e+04     1.0000e+05             7.6357e-08       -17.216966610556

*****************************************************************************
Applying the update for shift_i =   6.2500e+02     and shift_s =   6.2500e+03
*****************************************************************************

  Execution time = 5.3994e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
  uu_0                 2.061925e-01 1 1  ON 0
  uu_1                 4.539047e-02 1 1  ON 1
  uu_2                -4.680633e-02 1 1  ON 2
  uu_3                -9.936293e-02 1 1  ON 3
  uu_4                -1.304425e-01 1 1  ON 4
  uu_5                -1.356401e-01 1 1  ON 5
  uu_6                -1.130351e-01 1 1  ON 6
  uu_7                -3.972146e-02 1 1  ON 7
  uu_8                 9.988797e-02 1 1  ON 8
  uu_9                 1.208922e-01 1 1  ON 9
  ud_0                 3.495756e-01 1 1  ON 10
  ud_1                 9.178416e-02 1 1  ON 11
  ud_2                -1.648719e-02 1 1  ON 12
  ud_3                -7.596226e-02 1 1  ON 13
  ud_4                -1.217492e-01 1 1  ON 14
  ud_5                -1.523202e-01 1 1  ON 15
  ud_6                -1.544630e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.465130e-03 1 1  ON 18
  ud_9                 9.258155e-02 1 1  ON 19
  eO_0                -7.504230e-01 1 1  ON 20
  eO_1                -4.354885e-01 1 1  ON 21
  eO_2                -3.597982e-02 1 1  ON 22
  eO_3                 2.081564e-01 1 1  ON 23
  eO_4                 2.891374e-01 1 1  ON 24
  eO_5                 3.052684e-01 1 1  ON 25
  eO_6                 2.501135e-01 1 1  ON 26
  eO_7                 1.121819e-01 1 1  ON 27
  eO_8                 2.793031e-02 1 1  ON 28
  eO_9                 1.846808e-02 1 1  ON 29
 eH1_0                -1.820101e-01 1 1  ON 30
 eH1_1                -1.027121e-01 1 1  ON 31
 eH1_2                -6.202855e-02 1 1  ON 32
 eH1_3                -2.594562e-02 1 1  ON 33
 eH1_4                 1.931540e-02 1 1  ON 34
 eH1_5                 3.552815e-02 1 1  ON 35
 eH1_6                 7.727976e-02 1 1  ON 36
 eH1_7                 1.103063e-01 1 1  ON 37
 eH1_8                 9.073689e-02 1 1  ON 38
 eH1_9                 2.428741e-02 1 1  ON 39
 eH2_0                -1.835292e-01 1 1  ON 40
 eH2_1                -1.038362e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706150e-02 1 1  ON 43
 eH2_4                 1.856810e-02 1 1  ON 44
 eH2_5                 3.504993e-02 1 1  ON 45
 eH2_6                 7.827828e-02 1 1  ON 46
 eH2_7                 1.134126e-01 1 1  ON 47
 eH2_8                 9.397263e-02 1 1  ON 48
 eH2_9                 2.639240e-02 1 1  ON 49
ci_001                -3.996455e-02 3 1  ON 50
ci_002                -3.016643e-02 3 1  ON 51
ci_003                -2.507358e-02 3 1  ON 52
ci_004                 2.111255e-02 3 1  ON 53
ci_005                 2.113598e-02 3 1  ON 54
ci_006                -1.943419e-02 3 1  ON 55
ci_007                -1.880453e-02 3 1  ON 56
ci_008                -1.774302e-02 3 1  ON 57
ci_009                -1.805845e-02 3 1  ON 58
ci_010                -1.730291e-02 3 1  ON 59
ci_011                -1.626641e-02 3 1  ON 60
ci_012                -1.614699e-02 3 1  ON 61
ci_013                -1.921769e-02 3 1  ON 62
ci_014                 1.385280e-02 3 1  ON 63
ci_015                 1.356356e-02 3 1  ON 64
ci_016                 1.626104e-02 3 1  ON 65
ci_017                 1.653413e-02 3 1  ON 66
ci_018                 1.263137e-02 3 1  ON 67
ci_019                 1.309190e-02 3 1  ON 68
ci_020                 1.328248e-02 3 1  ON 69
ci_021                 1.336545e-02 3 1  ON 70
ci_022                 1.114437e-02 3 1  ON 71
ci_023                 1.122764e-02 3 1  ON 72
ci_024                 1.228100e-02 3 1  ON 73
ci_025                 1.155424e-02 3 1  ON 74
ci_026                 1.090552e-02 3 1  ON 75
ci_027                 1.132731e-02 3 1  ON 76
ci_028                -1.425973e-02 3 1  ON 77
ci_029                -1.490913e-02 3 1  ON 78
ci_030                -1.110554e-02 3 1  ON 79
ci_031                -1.141173e-02 3 1  ON 80
ci_032                -1.349054e-02 3 1  ON 81
ci_033                 1.065691e-02 3 1  ON 82
ci_034                 1.063531e-02 3 1  ON 83
ci_035                -4.703706e-03 3 1  ON 84
ci_036                -1.040515e-02 3 1  ON 85
ci_037                -1.005858e-02 3 1  ON 86
ci_038                 1.874013e-03 3 1  ON 87
ci_039                 1.470936e-03 3 1  ON 88
ci_040                -4.065382e-03 3 1  ON 89
ci_041                 9.805558e-03 3 1  ON 90
ci_042                 9.855283e-03 3 1  ON 91
ci_043                -2.929003e-03 3 1  ON 92
ci_044                -1.514670e-02 3 1  ON 93
ci_045                -1.826340e-03 3 1  ON 94
ci_046                 5.708470e-03 3 1  ON 95
ci_047                 5.452569e-03 3 1  ON 96
ci_048                -1.169118e-02 3 1  ON 97
ci_049                -1.200953e-02 3 1  ON 98
ci_050                 7.414189e-03 3 1  ON 99
ci_051                 7.765281e-03 3 1  ON 100
ci_052                -6.441614e-03 3 1  ON 101
ci_053                -6.307823e-03 3 1  ON 102
ci_054                -3.220310e-03 3 1  ON 103
ci_055                -3.043274e-03 3 1  ON 104
ci_056                 4.495252e-03 3 1  ON 105
ci_057                 4.396860e-03 3 1  ON 106
ci_058                -6.794104e-03 3 1  ON 107
ci_059                -6.375810e-03 3 1  ON 108
ci_060                 8.242062e-03 3 1  ON 109
ci_061                 7.906014e-03 3 1  ON 110
ci_062                -3.257586e-03 3 1  ON 111
ci_063                -2.907684e-03 3 1  ON 112
ci_064                -3.133731e-03 3 1  ON 113
ci_065                -4.351591e-03 3 1  ON 114
ci_066                 5.563475e-03 3 1  ON 115
ci_067                 5.751371e-03 3 1  ON 116
ci_068                -4.597480e-03 3 1  ON 117
ci_069                -4.608496e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0287e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7225e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.2307
    reference variance = 0.234657
====================================================
  Execution time = 3.7621e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5278e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1558e-01
  Total weights = 1.956406160e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0990e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299143109650
                                         uncertainty =       0.002186442143

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299143109650
                                         uncertainty =       0.002186442143

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386670793
  error estimate for blocks of size 2^( 2) =       0.000397006424
  error estimate for blocks of size 2^( 3) =       0.000405407054
  error estimate for blocks of size 2^( 4) =       0.000412376641
  error estimate for blocks of size 2^( 5) =       0.000416386906
  error estimate for blocks of size 2^( 6) =       0.000418812242
  error estimate for blocks of size 2^( 7) =       0.000419529507

      target function =                  N/A
              le_mean =     -17.215736766275
             les_mean =     296.697169255883
             stat err =       0.000416776324
             autocorr =       1.161778516284
              std dev =       0.546835079625
             le_variance =       0.299028604309


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721573676627e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215736766315       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215736773437       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215736778752       residual = 3.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215736787953       residual = 3.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215736784443       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215736784404       residual = 4.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215736785458       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215736787826       residual = 3.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215736787549       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215736787914       residual = 3.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5625e+02 is 4.165137e-06

solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215736766315       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215736768098       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215736769428       residual = 4.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215736771730       residual = 3.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215736770851       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215736770840       residual = 4.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215736771104       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215736771694       residual = 3.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215736771624       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215736771717       residual = 3.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.2500e+02 is 1.041186e-06

solving harmonic davidson linear method for identity shift 2.5000e+03, overlap shift 2.5000e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215736766315       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215736766761       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215736767094       residual = 4.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215736767669       residual = 3.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215736767449       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215736767447       residual = 4.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215736767512       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215736767654       residual = 3.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215736767642       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215736767660       residual = 3.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.5000e+03 is 2.602903e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.164738 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8623e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
  uu_0                 2.061928e-01 1 1  ON 0
  uu_1                 4.539069e-02 1 1  ON 1
  uu_2                -4.680636e-02 1 1  ON 2
  uu_3                -9.936292e-02 1 1  ON 3
  uu_4                -1.304428e-01 1 1  ON 4
  uu_5                -1.356403e-01 1 1  ON 5
  uu_6                -1.130350e-01 1 1  ON 6
  uu_7                -3.972159e-02 1 1  ON 7
  uu_8                 9.988785e-02 1 1  ON 8
  uu_9                 1.208923e-01 1 1  ON 9
  ud_0                 3.495760e-01 1 1  ON 10
  ud_1                 9.178444e-02 1 1  ON 11
  ud_2                -1.648719e-02 1 1  ON 12
  ud_3                -7.596243e-02 1 1  ON 13
  ud_4                -1.217494e-01 1 1  ON 14
  ud_5                -1.523203e-01 1 1  ON 15
  ud_6                -1.544631e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.464976e-03 1 1  ON 18
  ud_9                 9.258155e-02 1 1  ON 19
  eO_0                -7.504240e-01 1 1  ON 20
  eO_1                -4.354895e-01 1 1  ON 21
  eO_2                -3.597997e-02 1 1  ON 22
  eO_3                 2.081571e-01 1 1  ON 23
  eO_4                 2.891384e-01 1 1  ON 24
  eO_5                 3.052686e-01 1 1  ON 25
  eO_6                 2.501137e-01 1 1  ON 26
  eO_7                 1.121821e-01 1 1  ON 27
  eO_8                 2.793034e-02 1 1  ON 28
  eO_9                 1.846808e-02 1 1  ON 29
 eH1_0                -1.820101e-01 1 1  ON 30
 eH1_1                -1.027120e-01 1 1  ON 31
 eH1_2                -6.202864e-02 1 1  ON 32
 eH1_3                -2.594561e-02 1 1  ON 33
 eH1_4                 1.931536e-02 1 1  ON 34
 eH1_5                 3.552801e-02 1 1  ON 35
 eH1_6                 7.727986e-02 1 1  ON 36
 eH1_7                 1.103063e-01 1 1  ON 37
 eH1_8                 9.073698e-02 1 1  ON 38
 eH1_9                 2.428743e-02 1 1  ON 39
 eH2_0                -1.835293e-01 1 1  ON 40
 eH2_1                -1.038364e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706150e-02 1 1  ON 43
 eH2_4                 1.856804e-02 1 1  ON 44
 eH2_5                 3.504999e-02 1 1  ON 45
 eH2_6                 7.827829e-02 1 1  ON 46
 eH2_7                 1.134126e-01 1 1  ON 47
 eH2_8                 9.397277e-02 1 1  ON 48
 eH2_9                 2.639245e-02 1 1  ON 49
ci_001                -3.996448e-02 3 1  ON 50
ci_002                -3.016639e-02 3 1  ON 51
ci_003                -2.507375e-02 3 1  ON 52
ci_004                 2.111256e-02 3 1  ON 53
ci_005                 2.113591e-02 3 1  ON 54
ci_006                -1.943414e-02 3 1  ON 55
ci_007                -1.880481e-02 3 1  ON 56
ci_008                -1.774303e-02 3 1  ON 57
ci_009                -1.805818e-02 3 1  ON 58
ci_010                -1.730310e-02 3 1  ON 59
ci_011                -1.626605e-02 3 1  ON 60
ci_012                -1.614700e-02 3 1  ON 61
ci_013                -1.921747e-02 3 1  ON 62
ci_014                 1.385256e-02 3 1  ON 63
ci_015                 1.356380e-02 3 1  ON 64
ci_016                 1.626138e-02 3 1  ON 65
ci_017                 1.653381e-02 3 1  ON 66
ci_018                 1.263167e-02 3 1  ON 67
ci_019                 1.309181e-02 3 1  ON 68
ci_020                 1.328226e-02 3 1  ON 69
ci_021                 1.336558e-02 3 1  ON 70
ci_022                 1.114415e-02 3 1  ON 71
ci_023                 1.122765e-02 3 1  ON 72
ci_024                 1.228072e-02 3 1  ON 73
ci_025                 1.155425e-02 3 1  ON 74
ci_026                 1.090540e-02 3 1  ON 75
ci_027                 1.132724e-02 3 1  ON 76
ci_028                -1.425971e-02 3 1  ON 77
ci_029                -1.490915e-02 3 1  ON 78
ci_030                -1.110556e-02 3 1  ON 79
ci_031                -1.141156e-02 3 1  ON 80
ci_032                -1.349110e-02 3 1  ON 81
ci_033                 1.065685e-02 3 1  ON 82
ci_034                 1.063491e-02 3 1  ON 83
ci_035                -4.703341e-03 3 1  ON 84
ci_036                -1.040501e-02 3 1  ON 85
ci_037                -1.005879e-02 3 1  ON 86
ci_038                 1.873982e-03 3 1  ON 87
ci_039                 1.471105e-03 3 1  ON 88
ci_040                -4.065294e-03 3 1  ON 89
ci_041                 9.805554e-03 3 1  ON 90
ci_042                 9.855420e-03 3 1  ON 91
ci_043                -2.928867e-03 3 1  ON 92
ci_044                -1.514669e-02 3 1  ON 93
ci_045                -1.826210e-03 3 1  ON 94
ci_046                 5.708387e-03 3 1  ON 95
ci_047                 5.452543e-03 3 1  ON 96
ci_048                -1.169109e-02 3 1  ON 97
ci_049                -1.200948e-02 3 1  ON 98
ci_050                 7.414177e-03 3 1  ON 99
ci_051                 7.765132e-03 3 1  ON 100
ci_052                -6.441527e-03 3 1  ON 101
ci_053                -6.307912e-03 3 1  ON 102
ci_054                -3.220486e-03 3 1  ON 103
ci_055                -3.042824e-03 3 1  ON 104
ci_056                 4.495241e-03 3 1  ON 105
ci_057                 4.396664e-03 3 1  ON 106
ci_058                -6.793949e-03 3 1  ON 107
ci_059                -6.376262e-03 3 1  ON 108
ci_060                 8.242328e-03 3 1  ON 109
ci_061                 7.905757e-03 3 1  ON 110
ci_062                -3.257324e-03 3 1  ON 111
ci_063                -2.907702e-03 3 1  ON 112
ci_064                -3.133958e-03 3 1  ON 113
ci_065                -4.351330e-03 3 1  ON 114
ci_066                 5.563409e-03 3 1  ON 115
ci_067                 5.751583e-03 3 1  ON 116
ci_068                -4.597737e-03 3 1  ON 117
ci_069                -4.608725e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.1857
    reference variance = 0.247574
====================================================
  Execution time = 3.7458e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1779e-01
  Total weights = 1.9565e+06
  Execution time = 3.3566e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301250079630
                                         uncertainty =       0.002183852023

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301250079630
                                         uncertainty =       0.002183852023

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388032800
  error estimate for blocks of size 2^( 2) =       0.000397862013
  error estimate for blocks of size 2^( 3) =       0.000406993755
  error estimate for blocks of size 2^( 4) =       0.000413700784
  error estimate for blocks of size 2^( 5) =       0.000416432287
  error estimate for blocks of size 2^( 6) =       0.000419026448
  error estimate for blocks of size 2^( 7) =       0.000420254488

      target function =                  N/A
              le_mean =     -17.216684453334
             les_mean =     296.732014124871
             stat err =       0.000417353502
             autocorr =       1.156834543439
              std dev =       0.548761248292
             le_variance =       0.301138907627

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301250717137
                                         uncertainty =       0.002183881290

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301250717137
                                         uncertainty =       0.002183881290

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388033214
  error estimate for blocks of size 2^( 2) =       0.000397862384
  error estimate for blocks of size 2^( 3) =       0.000406994083
  error estimate for blocks of size 2^( 4) =       0.000413701144
  error estimate for blocks of size 2^( 5) =       0.000416432651
  error estimate for blocks of size 2^( 6) =       0.000419026784
  error estimate for blocks of size 2^( 7) =       0.000420254861

      target function =                  N/A
              le_mean =     -17.216684438680
             les_mean =     296.732030592720
             stat err =       0.000417353860
             autocorr =       1.156834061408
              std dev =       0.548761833629
             le_variance =       0.301139550048

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301250398231
                                         uncertainty =       0.002183866679

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301250398231
                                         uncertainty =       0.002183866679

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388033007
  error estimate for blocks of size 2^( 2) =       0.000397862199
  error estimate for blocks of size 2^( 3) =       0.000406993919
  error estimate for blocks of size 2^( 4) =       0.000413700964
  error estimate for blocks of size 2^( 5) =       0.000416432469
  error estimate for blocks of size 2^( 6) =       0.000419026616
  error estimate for blocks of size 2^( 7) =       0.000420254674

      target function =                  N/A
              le_mean =     -17.216684446180
             les_mean =     296.732027685183
             stat err =       0.000417353681
             autocorr =       1.156834301827
              std dev =       0.548761540825
             le_variance =       0.301139228688

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301250119431
                                         uncertainty =       0.002183853855

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301250119431
                                         uncertainty =       0.002183853855

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388032826
  error estimate for blocks of size 2^( 2) =       0.000397862037
  error estimate for blocks of size 2^( 3) =       0.000406993776
  error estimate for blocks of size 2^( 4) =       0.000413700807
  error estimate for blocks of size 2^( 5) =       0.000416432309
  error estimate for blocks of size 2^( 6) =       0.000419026469
  error estimate for blocks of size 2^( 7) =       0.000420254511

      target function =                  N/A
              le_mean =     -17.216684452428
             les_mean =     296.732014428887
             stat err =       0.000417353524
             autocorr =       1.156834513274
              std dev =       0.548761284837
             le_variance =       0.301138947736


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216684453334        initial  <--
     1.5625e+02     1.5625e+03             4.1651e-06       -17.216684438680
     6.2500e+02     6.2500e+03             1.0412e-06       -17.216684446180
     2.5000e+03     2.5000e+04             2.6029e-07       -17.216684452428

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 54.4626
  </log>
  <optVariables href="H2O.s006.opt.xml">
  uu_0                 2.061925e-01 1 1  ON 0
  uu_1                 4.539047e-02 1 1  ON 1
  uu_2                -4.680633e-02 1 1  ON 2
  uu_3                -9.936293e-02 1 1  ON 3
  uu_4                -1.304425e-01 1 1  ON 4
  uu_5                -1.356401e-01 1 1  ON 5
  uu_6                -1.130351e-01 1 1  ON 6
  uu_7                -3.972146e-02 1 1  ON 7
  uu_8                 9.988797e-02 1 1  ON 8
  uu_9                 1.208922e-01 1 1  ON 9
  ud_0                 3.495756e-01 1 1  ON 10
  ud_1                 9.178416e-02 1 1  ON 11
  ud_2                -1.648719e-02 1 1  ON 12
  ud_3                -7.596226e-02 1 1  ON 13
  ud_4                -1.217492e-01 1 1  ON 14
  ud_5                -1.523202e-01 1 1  ON 15
  ud_6                -1.544630e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.465130e-03 1 1  ON 18
  ud_9                 9.258155e-02 1 1  ON 19
  eO_0                -7.504230e-01 1 1  ON 20
  eO_1                -4.354885e-01 1 1  ON 21
  eO_2                -3.597982e-02 1 1  ON 22
  eO_3                 2.081564e-01 1 1  ON 23
  eO_4                 2.891374e-01 1 1  ON 24
  eO_5                 3.052684e-01 1 1  ON 25
  eO_6                 2.501135e-01 1 1  ON 26
  eO_7                 1.121819e-01 1 1  ON 27
  eO_8                 2.793031e-02 1 1  ON 28
  eO_9                 1.846808e-02 1 1  ON 29
 eH1_0                -1.820101e-01 1 1  ON 30
 eH1_1                -1.027121e-01 1 1  ON 31
 eH1_2                -6.202855e-02 1 1  ON 32
 eH1_3                -2.594562e-02 1 1  ON 33
 eH1_4                 1.931540e-02 1 1  ON 34
 eH1_5                 3.552815e-02 1 1  ON 35
 eH1_6                 7.727976e-02 1 1  ON 36
 eH1_7                 1.103063e-01 1 1  ON 37
 eH1_8                 9.073689e-02 1 1  ON 38
 eH1_9                 2.428741e-02 1 1  ON 39
 eH2_0                -1.835292e-01 1 1  ON 40
 eH2_1                -1.038362e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706150e-02 1 1  ON 43
 eH2_4                 1.856810e-02 1 1  ON 44
 eH2_5                 3.504993e-02 1 1  ON 45
 eH2_6                 7.827828e-02 1 1  ON 46
 eH2_7                 1.134126e-01 1 1  ON 47
 eH2_8                 9.397263e-02 1 1  ON 48
 eH2_9                 2.639240e-02 1 1  ON 49
ci_001                -3.996455e-02 3 1  ON 50
ci_002                -3.016643e-02 3 1  ON 51
ci_003                -2.507358e-02 3 1  ON 52
ci_004                 2.111255e-02 3 1  ON 53
ci_005                 2.113598e-02 3 1  ON 54
ci_006                -1.943419e-02 3 1  ON 55
ci_007                -1.880453e-02 3 1  ON 56
ci_008                -1.774302e-02 3 1  ON 57
ci_009                -1.805845e-02 3 1  ON 58
ci_010                -1.730291e-02 3 1  ON 59
ci_011                -1.626641e-02 3 1  ON 60
ci_012                -1.614699e-02 3 1  ON 61
ci_013                -1.921769e-02 3 1  ON 62
ci_014                 1.385280e-02 3 1  ON 63
ci_015                 1.356356e-02 3 1  ON 64
ci_016                 1.626104e-02 3 1  ON 65
ci_017                 1.653413e-02 3 1  ON 66
ci_018                 1.263137e-02 3 1  ON 67
ci_019                 1.309190e-02 3 1  ON 68
ci_020                 1.328248e-02 3 1  ON 69
ci_021                 1.336545e-02 3 1  ON 70
ci_022                 1.114437e-02 3 1  ON 71
ci_023                 1.122764e-02 3 1  ON 72
ci_024                 1.228100e-02 3 1  ON 73
ci_025                 1.155424e-02 3 1  ON 74
ci_026                 1.090552e-02 3 1  ON 75
ci_027                 1.132731e-02 3 1  ON 76
ci_028                -1.425973e-02 3 1  ON 77
ci_029                -1.490913e-02 3 1  ON 78
ci_030                -1.110554e-02 3 1  ON 79
ci_031                -1.141173e-02 3 1  ON 80
ci_032                -1.349054e-02 3 1  ON 81
ci_033                 1.065691e-02 3 1  ON 82
ci_034                 1.063531e-02 3 1  ON 83
ci_035                -4.703706e-03 3 1  ON 84
ci_036                -1.040515e-02 3 1  ON 85
ci_037                -1.005858e-02 3 1  ON 86
ci_038                 1.874013e-03 3 1  ON 87
ci_039                 1.470936e-03 3 1  ON 88
ci_040                -4.065382e-03 3 1  ON 89
ci_041                 9.805558e-03 3 1  ON 90
ci_042                 9.855283e-03 3 1  ON 91
ci_043                -2.929003e-03 3 1  ON 92
ci_044                -1.514670e-02 3 1  ON 93
ci_045                -1.826340e-03 3 1  ON 94
ci_046                 5.708470e-03 3 1  ON 95
ci_047                 5.452569e-03 3 1  ON 96
ci_048                -1.169118e-02 3 1  ON 97
ci_049                -1.200953e-02 3 1  ON 98
ci_050                 7.414189e-03 3 1  ON 99
ci_051                 7.765281e-03 3 1  ON 100
ci_052                -6.441614e-03 3 1  ON 101
ci_053                -6.307823e-03 3 1  ON 102
ci_054                -3.220310e-03 3 1  ON 103
ci_055                -3.043274e-03 3 1  ON 104
ci_056                 4.495252e-03 3 1  ON 105
ci_057                 4.396860e-03 3 1  ON 106
ci_058                -6.794104e-03 3 1  ON 107
ci_059                -6.375810e-03 3 1  ON 108
ci_060                 8.242062e-03 3 1  ON 109
ci_061                 7.906014e-03 3 1  ON 110
ci_062                -3.257586e-03 3 1  ON 111
ci_063                -2.907684e-03 3 1  ON 112
ci_064                -3.133731e-03 3 1  ON 113
ci_065                -4.351591e-03 3 1  ON 114
ci_066                 5.563475e-03 3 1  ON 115
ci_067                 5.751371e-03 3 1  ON 116
ci_068                -4.597480e-03 3 1  ON 117
ci_069                -4.608496e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0309e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7223e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.1779
    reference variance = 0.532599
====================================================
  Execution time = 3.7459e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5295e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1560e-01
  Total weights = 1.956723975e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1187e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301480923280
                                         uncertainty =       0.002040476385

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301480923280
                                         uncertainty =       0.002040476385

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388224488
  error estimate for blocks of size 2^( 2) =       0.000398147849
  error estimate for blocks of size 2^( 3) =       0.000407410510
  error estimate for blocks of size 2^( 4) =       0.000414507349
  error estimate for blocks of size 2^( 5) =       0.000418829225
  error estimate for blocks of size 2^( 6) =       0.000422554557
  error estimate for blocks of size 2^( 7) =       0.000422715866

      target function =                  N/A
              le_mean =     -17.216792159106
             les_mean =     296.733536127746
             stat err =       0.000419651749
             autocorr =       1.168455624588
              std dev =       0.549032336577
             le_variance =       0.301436506607


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721679215911e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216792159162       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216792162159       residual = 9.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216792161749       residual = 4.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216792162327       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216792162600       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216792162724       residual = 9.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216792162603       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216792162691       residual = 3.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216792162697       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216792162698       residual = 5.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5625e+03 is 4.519767e-07

solving harmonic davidson linear method for identity shift 6.2500e+03, overlap shift 6.2500e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216792159162       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216792159911       residual = 9.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216792159809       residual = 4.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216792159954       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216792160021       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216792160052       residual = 9.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216792160026       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216792160031       residual = 3.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216792160047       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216792160023       residual = 5.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.2500e+03 is 1.129960e-07

solving harmonic davidson linear method for identity shift 2.5000e+04, overlap shift 2.5000e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216792159162       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216792159349       residual = 9.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216792159323       residual = 4.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216792159359       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216792159393       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216792159386       residual = 9.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216792159382       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216792159380       residual = 3.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216792159378       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216792159361       residual = 5.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.5000e+04 is 2.824912e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.168730 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8658e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
  uu_0                 2.061926e-01 1 1  ON 0
  uu_1                 4.539048e-02 1 1  ON 1
  uu_2                -4.680632e-02 1 1  ON 2
  uu_3                -9.936293e-02 1 1  ON 3
  uu_4                -1.304426e-01 1 1  ON 4
  uu_5                -1.356402e-01 1 1  ON 5
  uu_6                -1.130351e-01 1 1  ON 6
  uu_7                -3.972147e-02 1 1  ON 7
  uu_8                 9.988796e-02 1 1  ON 8
  uu_9                 1.208922e-01 1 1  ON 9
  ud_0                 3.495756e-01 1 1  ON 10
  ud_1                 9.178417e-02 1 1  ON 11
  ud_2                -1.648718e-02 1 1  ON 12
  ud_3                -7.596227e-02 1 1  ON 13
  ud_4                -1.217492e-01 1 1  ON 14
  ud_5                -1.523202e-01 1 1  ON 15
  ud_6                -1.544630e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.465109e-03 1 1  ON 18
  ud_9                 9.258155e-02 1 1  ON 19
  eO_0                -7.504231e-01 1 1  ON 20
  eO_1                -4.354886e-01 1 1  ON 21
  eO_2                -3.597984e-02 1 1  ON 22
  eO_3                 2.081565e-01 1 1  ON 23
  eO_4                 2.891375e-01 1 1  ON 24
  eO_5                 3.052684e-01 1 1  ON 25
  eO_6                 2.501136e-01 1 1  ON 26
  eO_7                 1.121819e-01 1 1  ON 27
  eO_8                 2.793031e-02 1 1  ON 28
  eO_9                 1.846808e-02 1 1  ON 29
 eH1_0                -1.820101e-01 1 1  ON 30
 eH1_1                -1.027121e-01 1 1  ON 31
 eH1_2                -6.202856e-02 1 1  ON 32
 eH1_3                -2.594562e-02 1 1  ON 33
 eH1_4                 1.931539e-02 1 1  ON 34
 eH1_5                 3.552816e-02 1 1  ON 35
 eH1_6                 7.727977e-02 1 1  ON 36
 eH1_7                 1.103063e-01 1 1  ON 37
 eH1_8                 9.073690e-02 1 1  ON 38
 eH1_9                 2.428741e-02 1 1  ON 39
 eH2_0                -1.835292e-01 1 1  ON 40
 eH2_1                -1.038362e-01 1 1  ON 41
 eH2_2                -6.350520e-02 1 1  ON 42
 eH2_3                -2.706150e-02 1 1  ON 43
 eH2_4                 1.856809e-02 1 1  ON 44
 eH2_5                 3.504992e-02 1 1  ON 45
 eH2_6                 7.827827e-02 1 1  ON 46
 eH2_7                 1.134126e-01 1 1  ON 47
 eH2_8                 9.397265e-02 1 1  ON 48
 eH2_9                 2.639240e-02 1 1  ON 49
ci_001                -3.996460e-02 3 1  ON 50
ci_002                -3.016644e-02 3 1  ON 51
ci_003                -2.507356e-02 3 1  ON 52
ci_004                 2.111252e-02 3 1  ON 53
ci_005                 2.113595e-02 3 1  ON 54
ci_006                -1.943418e-02 3 1  ON 55
ci_007                -1.880455e-02 3 1  ON 56
ci_008                -1.774301e-02 3 1  ON 57
ci_009                -1.805844e-02 3 1  ON 58
ci_010                -1.730290e-02 3 1  ON 59
ci_011                -1.626643e-02 3 1  ON 60
ci_012                -1.614696e-02 3 1  ON 61
ci_013                -1.921771e-02 3 1  ON 62
ci_014                 1.385274e-02 3 1  ON 63
ci_015                 1.356356e-02 3 1  ON 64
ci_016                 1.626105e-02 3 1  ON 65
ci_017                 1.653417e-02 3 1  ON 66
ci_018                 1.263139e-02 3 1  ON 67
ci_019                 1.309189e-02 3 1  ON 68
ci_020                 1.328250e-02 3 1  ON 69
ci_021                 1.336545e-02 3 1  ON 70
ci_022                 1.114435e-02 3 1  ON 71
ci_023                 1.122762e-02 3 1  ON 72
ci_024                 1.228098e-02 3 1  ON 73
ci_025                 1.155424e-02 3 1  ON 74
ci_026                 1.090551e-02 3 1  ON 75
ci_027                 1.132728e-02 3 1  ON 76
ci_028                -1.425975e-02 3 1  ON 77
ci_029                -1.490912e-02 3 1  ON 78
ci_030                -1.110555e-02 3 1  ON 79
ci_031                -1.141171e-02 3 1  ON 80
ci_032                -1.349055e-02 3 1  ON 81
ci_033                 1.065693e-02 3 1  ON 82
ci_034                 1.063528e-02 3 1  ON 83
ci_035                -4.703682e-03 3 1  ON 84
ci_036                -1.040513e-02 3 1  ON 85
ci_037                -1.005852e-02 3 1  ON 86
ci_038                 1.873992e-03 3 1  ON 87
ci_039                 1.470967e-03 3 1  ON 88
ci_040                -4.065367e-03 3 1  ON 89
ci_041                 9.805533e-03 3 1  ON 90
ci_042                 9.855312e-03 3 1  ON 91
ci_043                -2.928998e-03 3 1  ON 92
ci_044                -1.514673e-02 3 1  ON 93
ci_045                -1.826353e-03 3 1  ON 94
ci_046                 5.708448e-03 3 1  ON 95
ci_047                 5.452571e-03 3 1  ON 96
ci_048                -1.169117e-02 3 1  ON 97
ci_049                -1.200952e-02 3 1  ON 98
ci_050                 7.414190e-03 3 1  ON 99
ci_051                 7.765272e-03 3 1  ON 100
ci_052                -6.441656e-03 3 1  ON 101
ci_053                -6.307856e-03 3 1  ON 102
ci_054                -3.220292e-03 3 1  ON 103
ci_055                -3.043279e-03 3 1  ON 104
ci_056                 4.495207e-03 3 1  ON 105
ci_057                 4.396842e-03 3 1  ON 106
ci_058                -6.794122e-03 3 1  ON 107
ci_059                -6.375832e-03 3 1  ON 108
ci_060                 8.242044e-03 3 1  ON 109
ci_061                 7.906030e-03 3 1  ON 110
ci_062                -3.257580e-03 3 1  ON 111
ci_063                -2.907688e-03 3 1  ON 112
ci_064                -3.133712e-03 3 1  ON 113
ci_065                -4.351587e-03 3 1  ON 114
ci_066                 5.563488e-03 3 1  ON 115
ci_067                 5.751367e-03 3 1  ON 116
ci_068                -4.597449e-03 3 1  ON 117
ci_069                -4.608497e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.267
    reference variance = 0.430719
====================================================
  Execution time = 3.7467e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1323e-01
  Total weights = 1.9565e+06
  Execution time = 3.3456e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298691642732
                                         uncertainty =       0.002133182058

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298691642732
                                         uncertainty =       0.002133182058

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386438425
  error estimate for blocks of size 2^( 2) =       0.000396327489
  error estimate for blocks of size 2^( 3) =       0.000405373959
  error estimate for blocks of size 2^( 4) =       0.000411283469
  error estimate for blocks of size 2^( 5) =       0.000414950396
  error estimate for blocks of size 2^( 6) =       0.000417439468
  error estimate for blocks of size 2^( 7) =       0.000418171216

      target function =                  N/A
              le_mean =     -17.216770803039
             les_mean =     296.730427364217
             stat err =       0.000415461137
             autocorr =       1.155846612880
              std dev =       0.546506461331
             le_variance =       0.298669312277

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298691844441
                                         uncertainty =       0.002133202727

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298691844441
                                         uncertainty =       0.002133202727

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386438555
  error estimate for blocks of size 2^( 2) =       0.000396327614
  error estimate for blocks of size 2^( 3) =       0.000405374084
  error estimate for blocks of size 2^( 4) =       0.000411283590
  error estimate for blocks of size 2^( 5) =       0.000414950513
  error estimate for blocks of size 2^( 6) =       0.000417439589
  error estimate for blocks of size 2^( 7) =       0.000418171335

      target function =                  N/A
              le_mean =     -17.216770806230
             les_mean =     296.730427960082
             stat err =       0.000415461257
             autocorr =       1.155846497136
              std dev =       0.546506646164
             le_variance =       0.298669514301

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298691743596
                                         uncertainty =       0.002133192394

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298691743596
                                         uncertainty =       0.002133192394

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386438490
  error estimate for blocks of size 2^( 2) =       0.000396327551
  error estimate for blocks of size 2^( 3) =       0.000405374021
  error estimate for blocks of size 2^( 4) =       0.000411283530
  error estimate for blocks of size 2^( 5) =       0.000414950455
  error estimate for blocks of size 2^( 6) =       0.000417439528
  error estimate for blocks of size 2^( 7) =       0.000418171275

      target function =                  N/A
              le_mean =     -17.216770804634
             les_mean =     296.730427661171
             stat err =       0.000415461197
             autocorr =       1.155846555007
              std dev =       0.546506553756
             le_variance =       0.298669413299

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298691655340
                                         uncertainty =       0.002133183350

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298691655340
                                         uncertainty =       0.002133183350

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386438433
  error estimate for blocks of size 2^( 2) =       0.000396327497
  error estimate for blocks of size 2^( 3) =       0.000405373967
  error estimate for blocks of size 2^( 4) =       0.000411283476
  error estimate for blocks of size 2^( 5) =       0.000414950403
  error estimate for blocks of size 2^( 6) =       0.000417439476
  error estimate for blocks of size 2^( 7) =       0.000418171223

      target function =                  N/A
              le_mean =     -17.216770803239
             les_mean =     296.730427401231
             stat err =       0.000415461145
             autocorr =       1.155846605644
              std dev =       0.546506472885
             le_variance =       0.298669324905


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216770803039        initial
     1.5625e+03     1.5625e+04             4.5198e-07       -17.216770806230  <--
     6.2500e+03     6.2500e+04             1.1300e-07       -17.216770804634
     2.5000e+04     2.5000e+05             2.8249e-08       -17.216770803239

*****************************************************************************
Applying the update for shift_i =   1.5625e+03     and shift_s =   1.5625e+04
*****************************************************************************

  Execution time = 5.5644e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
  uu_0                 2.061926e-01 1 1  ON 0
  uu_1                 4.539049e-02 1 1  ON 1
  uu_2                -4.680630e-02 1 1  ON 2
  uu_3                -9.936291e-02 1 1  ON 3
  uu_4                -1.304426e-01 1 1  ON 4
  uu_5                -1.356403e-01 1 1  ON 5
  uu_6                -1.130350e-01 1 1  ON 6
  uu_7                -3.972152e-02 1 1  ON 7
  uu_8                 9.988792e-02 1 1  ON 8
  uu_9                 1.208923e-01 1 1  ON 9
  ud_0                 3.495757e-01 1 1  ON 10
  ud_1                 9.178421e-02 1 1  ON 11
  ud_2                -1.648718e-02 1 1  ON 12
  ud_3                -7.596230e-02 1 1  ON 13
  ud_4                -1.217493e-01 1 1  ON 14
  ud_5                -1.523202e-01 1 1  ON 15
  ud_6                -1.544630e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.465047e-03 1 1  ON 18
  ud_9                 9.258155e-02 1 1  ON 19
  eO_0                -7.504234e-01 1 1  ON 20
  eO_1                -4.354888e-01 1 1  ON 21
  eO_2                -3.597992e-02 1 1  ON 22
  eO_3                 2.081566e-01 1 1  ON 23
  eO_4                 2.891378e-01 1 1  ON 24
  eO_5                 3.052685e-01 1 1  ON 25
  eO_6                 2.501136e-01 1 1  ON 26
  eO_7                 1.121819e-01 1 1  ON 27
  eO_8                 2.793032e-02 1 1  ON 28
  eO_9                 1.846808e-02 1 1  ON 29
 eH1_0                -1.820102e-01 1 1  ON 30
 eH1_1                -1.027121e-01 1 1  ON 31
 eH1_2                -6.202859e-02 1 1  ON 32
 eH1_3                -2.594562e-02 1 1  ON 33
 eH1_4                 1.931537e-02 1 1  ON 34
 eH1_5                 3.552821e-02 1 1  ON 35
 eH1_6                 7.727978e-02 1 1  ON 36
 eH1_7                 1.103063e-01 1 1  ON 37
 eH1_8                 9.073694e-02 1 1  ON 38
 eH1_9                 2.428742e-02 1 1  ON 39
 eH2_0                -1.835292e-01 1 1  ON 40
 eH2_1                -1.038362e-01 1 1  ON 41
 eH2_2                -6.350520e-02 1 1  ON 42
 eH2_3                -2.706150e-02 1 1  ON 43
 eH2_4                 1.856807e-02 1 1  ON 44
 eH2_5                 3.504992e-02 1 1  ON 45
 eH2_6                 7.827825e-02 1 1  ON 46
 eH2_7                 1.134126e-01 1 1  ON 47
 eH2_8                 9.397268e-02 1 1  ON 48
 eH2_9                 2.639241e-02 1 1  ON 49
ci_001                -3.996473e-02 3 1  ON 50
ci_002                -3.016647e-02 3 1  ON 51
ci_003                -2.507350e-02 3 1  ON 52
ci_004                 2.111242e-02 3 1  ON 53
ci_005                 2.113585e-02 3 1  ON 54
ci_006                -1.943417e-02 3 1  ON 55
ci_007                -1.880460e-02 3 1  ON 56
ci_008                -1.774300e-02 3 1  ON 57
ci_009                -1.805843e-02 3 1  ON 58
ci_010                -1.730287e-02 3 1  ON 59
ci_011                -1.626648e-02 3 1  ON 60
ci_012                -1.614687e-02 3 1  ON 61
ci_013                -1.921777e-02 3 1  ON 62
ci_014                 1.385257e-02 3 1  ON 63
ci_015                 1.356355e-02 3 1  ON 64
ci_016                 1.626109e-02 3 1  ON 65
ci_017                 1.653428e-02 3 1  ON 66
ci_018                 1.263145e-02 3 1  ON 67
ci_019                 1.309184e-02 3 1  ON 68
ci_020                 1.328259e-02 3 1  ON 69
ci_021                 1.336546e-02 3 1  ON 70
ci_022                 1.114426e-02 3 1  ON 71
ci_023                 1.122756e-02 3 1  ON 72
ci_024                 1.228089e-02 3 1  ON 73
ci_025                 1.155423e-02 3 1  ON 74
ci_026                 1.090550e-02 3 1  ON 75
ci_027                 1.132716e-02 3 1  ON 76
ci_028                -1.425982e-02 3 1  ON 77
ci_029                -1.490909e-02 3 1  ON 78
ci_030                -1.110557e-02 3 1  ON 79
ci_031                -1.141168e-02 3 1  ON 80
ci_032                -1.349057e-02 3 1  ON 81
ci_033                 1.065699e-02 3 1  ON 82
ci_034                 1.063520e-02 3 1  ON 83
ci_035                -4.703609e-03 3 1  ON 84
ci_036                -1.040507e-02 3 1  ON 85
ci_037                -1.005834e-02 3 1  ON 86
ci_038                 1.873928e-03 3 1  ON 87
ci_039                 1.471061e-03 3 1  ON 88
ci_040                -4.065323e-03 3 1  ON 89
ci_041                 9.805460e-03 3 1  ON 90
ci_042                 9.855398e-03 3 1  ON 91
ci_043                -2.928981e-03 3 1  ON 92
ci_044                -1.514680e-02 3 1  ON 93
ci_045                -1.826392e-03 3 1  ON 94
ci_046                 5.708382e-03 3 1  ON 95
ci_047                 5.452580e-03 3 1  ON 96
ci_048                -1.169114e-02 3 1  ON 97
ci_049                -1.200949e-02 3 1  ON 98
ci_050                 7.414194e-03 3 1  ON 99
ci_051                 7.765242e-03 3 1  ON 100
ci_052                -6.441783e-03 3 1  ON 101
ci_053                -6.307955e-03 3 1  ON 102
ci_054                -3.220238e-03 3 1  ON 103
ci_055                -3.043294e-03 3 1  ON 104
ci_056                 4.495072e-03 3 1  ON 105
ci_057                 4.396790e-03 3 1  ON 106
ci_058                -6.794176e-03 3 1  ON 107
ci_059                -6.375896e-03 3 1  ON 108
ci_060                 8.241989e-03 3 1  ON 109
ci_061                 7.906076e-03 3 1  ON 110
ci_062                -3.257561e-03 3 1  ON 111
ci_063                -2.907700e-03 3 1  ON 112
ci_064                -3.133656e-03 3 1  ON 113
ci_065                -4.351572e-03 3 1  ON 114
ci_066                 5.563527e-03 3 1  ON 115
ci_067                 5.751353e-03 3 1  ON 116
ci_068                -4.597358e-03 3 1  ON 117
ci_069                -4.608501e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0431e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7223e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.1072
    reference variance = 0.661371
====================================================
  Execution time = 3.7626e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5312e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.1270e-01
  Total weights = 1.956703029e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0852e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296614548387
                                         uncertainty =       0.002047655181

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296614548387
                                         uncertainty =       0.002047655181

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385160869
  error estimate for blocks of size 2^( 2) =       0.000395525433
  error estimate for blocks of size 2^( 3) =       0.000403827672
  error estimate for blocks of size 2^( 4) =       0.000410809439
  error estimate for blocks of size 2^( 5) =       0.000414002252
  error estimate for blocks of size 2^( 6) =       0.000416052380
  error estimate for blocks of size 2^( 7) =       0.000416865240

      target function =                  N/A
              le_mean =     -17.215358180274
             les_mean =     296.681260917637
             stat err =       0.000414432328
             autocorr =       1.157771713712
              std dev =       0.544699724244
             le_variance =       0.296697789592


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721535818027e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215358180260       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215358187035       residual = 3.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215358186879       residual = 4.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215358188540       residual = 4.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215358184248       residual = 3.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215358183639       residual = 6.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215358184052       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215358184668       residual = 7.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215358185384       residual = 2.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215358185747       residual = 4.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.9062e+02 is 1.835962e-06

solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215358180260       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215358181955       residual = 3.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215358181916       residual = 4.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215358182332       residual = 4.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215358181257       residual = 3.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215358181105       residual = 6.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215358181211       residual = 2.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215358181356       residual = 7.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215358181541       residual = 2.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215358181627       residual = 4.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5625e+03 is 4.591315e-07

solving harmonic davidson linear method for identity shift 6.2500e+03, overlap shift 6.2500e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215358180260       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215358180684       residual = 3.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215358180674       residual = 4.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215358180778       residual = 4.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215358180510       residual = 3.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215358180472       residual = 6.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215358180497       residual = 2.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215358180535       residual = 7.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215358180585       residual = 2.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215358180595       residual = 4.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.2500e+03 is 1.147917e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.172721 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8491e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
  uu_0                 2.061928e-01 1 1  ON 0
  uu_1                 4.539059e-02 1 1  ON 1
  uu_2                -4.680622e-02 1 1  ON 2
  uu_3                -9.936292e-02 1 1  ON 3
  uu_4                -1.304427e-01 1 1  ON 4
  uu_5                -1.356404e-01 1 1  ON 5
  uu_6                -1.130351e-01 1 1  ON 6
  uu_7                -3.972162e-02 1 1  ON 7
  uu_8                 9.988786e-02 1 1  ON 8
  uu_9                 1.208923e-01 1 1  ON 9
  ud_0                 3.495760e-01 1 1  ON 10
  ud_1                 9.178430e-02 1 1  ON 11
  ud_2                -1.648725e-02 1 1  ON 12
  ud_3                -7.596232e-02 1 1  ON 13
  ud_4                -1.217494e-01 1 1  ON 14
  ud_5                -1.523202e-01 1 1  ON 15
  ud_6                -1.544630e-01 1 1  ON 16
  ud_7                -1.100035e-01 1 1  ON 17
  ud_8                 4.464949e-03 1 1  ON 18
  ud_9                 9.258155e-02 1 1  ON 19
  eO_0                -7.504238e-01 1 1  ON 20
  eO_1                -4.354893e-01 1 1  ON 21
  eO_2                -3.597998e-02 1 1  ON 22
  eO_3                 2.081569e-01 1 1  ON 23
  eO_4                 2.891382e-01 1 1  ON 24
  eO_5                 3.052686e-01 1 1  ON 25
  eO_6                 2.501136e-01 1 1  ON 26
  eO_7                 1.121820e-01 1 1  ON 27
  eO_8                 2.793033e-02 1 1  ON 28
  eO_9                 1.846808e-02 1 1  ON 29
 eH1_0                -1.820101e-01 1 1  ON 30
 eH1_1                -1.027122e-01 1 1  ON 31
 eH1_2                -6.202861e-02 1 1  ON 32
 eH1_3                -2.594565e-02 1 1  ON 33
 eH1_4                 1.931541e-02 1 1  ON 34
 eH1_5                 3.552823e-02 1 1  ON 35
 eH1_6                 7.727979e-02 1 1  ON 36
 eH1_7                 1.103063e-01 1 1  ON 37
 eH1_8                 9.073697e-02 1 1  ON 38
 eH1_9                 2.428743e-02 1 1  ON 39
 eH2_0                -1.835293e-01 1 1  ON 40
 eH2_1                -1.038363e-01 1 1  ON 41
 eH2_2                -6.350518e-02 1 1  ON 42
 eH2_3                -2.706144e-02 1 1  ON 43
 eH2_4                 1.856806e-02 1 1  ON 44
 eH2_5                 3.504992e-02 1 1  ON 45
 eH2_6                 7.827826e-02 1 1  ON 46
 eH2_7                 1.134125e-01 1 1  ON 47
 eH2_8                 9.397272e-02 1 1  ON 48
 eH2_9                 2.639242e-02 1 1  ON 49
ci_001                -3.996486e-02 3 1  ON 50
ci_002                -3.016644e-02 3 1  ON 51
ci_003                -2.507352e-02 3 1  ON 52
ci_004                 2.111237e-02 3 1  ON 53
ci_005                 2.113573e-02 3 1  ON 54
ci_006                -1.943392e-02 3 1  ON 55
ci_007                -1.880449e-02 3 1  ON 56
ci_008                -1.774308e-02 3 1  ON 57
ci_009                -1.805829e-02 3 1  ON 58
ci_010                -1.730270e-02 3 1  ON 59
ci_011                -1.626645e-02 3 1  ON 60
ci_012                -1.614670e-02 3 1  ON 61
ci_013                -1.921779e-02 3 1  ON 62
ci_014                 1.385271e-02 3 1  ON 63
ci_015                 1.356349e-02 3 1  ON 64
ci_016                 1.626108e-02 3 1  ON 65
ci_017                 1.653438e-02 3 1  ON 66
ci_018                 1.263144e-02 3 1  ON 67
ci_019                 1.309180e-02 3 1  ON 68
ci_020                 1.328261e-02 3 1  ON 69
ci_021                 1.336559e-02 3 1  ON 70
ci_022                 1.114437e-02 3 1  ON 71
ci_023                 1.122763e-02 3 1  ON 72
ci_024                 1.228092e-02 3 1  ON 73
ci_025                 1.155434e-02 3 1  ON 74
ci_026                 1.090545e-02 3 1  ON 75
ci_027                 1.132706e-02 3 1  ON 76
ci_028                -1.425978e-02 3 1  ON 77
ci_029                -1.490909e-02 3 1  ON 78
ci_030                -1.110545e-02 3 1  ON 79
ci_031                -1.141155e-02 3 1  ON 80
ci_032                -1.349061e-02 3 1  ON 81
ci_033                 1.065702e-02 3 1  ON 82
ci_034                 1.063498e-02 3 1  ON 83
ci_035                -4.703514e-03 3 1  ON 84
ci_036                -1.040516e-02 3 1  ON 85
ci_037                -1.005844e-02 3 1  ON 86
ci_038                 1.873877e-03 3 1  ON 87
ci_039                 1.471096e-03 3 1  ON 88
ci_040                -4.065295e-03 3 1  ON 89
ci_041                 9.805565e-03 3 1  ON 90
ci_042                 9.855491e-03 3 1  ON 91
ci_043                -2.928955e-03 3 1  ON 92
ci_044                -1.514663e-02 3 1  ON 93
ci_045                -1.826338e-03 3 1  ON 94
ci_046                 5.708240e-03 3 1  ON 95
ci_047                 5.452613e-03 3 1  ON 96
ci_048                -1.169106e-02 3 1  ON 97
ci_049                -1.200945e-02 3 1  ON 98
ci_050                 7.414234e-03 3 1  ON 99
ci_051                 7.765243e-03 3 1  ON 100
ci_052                -6.441921e-03 3 1  ON 101
ci_053                -6.308122e-03 3 1  ON 102
ci_054                -3.220172e-03 3 1  ON 103
ci_055                -3.043281e-03 3 1  ON 104
ci_056                 4.495158e-03 3 1  ON 105
ci_057                 4.396768e-03 3 1  ON 106
ci_058                -6.794086e-03 3 1  ON 107
ci_059                -6.375928e-03 3 1  ON 108
ci_060                 8.242001e-03 3 1  ON 109
ci_061                 7.906234e-03 3 1  ON 110
ci_062                -3.257497e-03 3 1  ON 111
ci_063                -2.907595e-03 3 1  ON 112
ci_064                -3.133589e-03 3 1  ON 113
ci_065                -4.351525e-03 3 1  ON 114
ci_066                 5.563497e-03 3 1  ON 115
ci_067                 5.751236e-03 3 1  ON 116
ci_068                -4.597502e-03 3 1  ON 117
ci_069                -4.608592e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.2623
    reference variance = 0.426412
====================================================
  Execution time = 3.7427e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1368e-01
  Total weights = 1.9569e+06
  Execution time = 3.3525e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300718524555
                                         uncertainty =       0.002179924668

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300718524555
                                         uncertainty =       0.002179924668

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387731267
  error estimate for blocks of size 2^( 2) =       0.000397814440
  error estimate for blocks of size 2^( 3) =       0.000406901582
  error estimate for blocks of size 2^( 4) =       0.000413636157
  error estimate for blocks of size 2^( 5) =       0.000417219575
  error estimate for blocks of size 2^( 6) =       0.000419467639
  error estimate for blocks of size 2^( 7) =       0.000420122227

      target function =                  N/A
              le_mean =     -17.216968010428
             les_mean =     296.737664993251
             stat err =       0.000417611399
             autocorr =       1.160066918372
              std dev =       0.548334815782
             le_variance =       0.300671070198

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300719275222
                                         uncertainty =       0.002179966414

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300719275222
                                         uncertainty =       0.002179966414

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387731751
  error estimate for blocks of size 2^( 2) =       0.000397814882
  error estimate for blocks of size 2^( 3) =       0.000406901981
  error estimate for blocks of size 2^( 4) =       0.000413636559
  error estimate for blocks of size 2^( 5) =       0.000417219970
  error estimate for blocks of size 2^( 6) =       0.000419468003
  error estimate for blocks of size 2^( 7) =       0.000420122554

      target function =                  N/A
              le_mean =     -17.216968001365
             les_mean =     296.737665734630
             stat err =       0.000417611771
             autocorr =       1.160066086976
              std dev =       0.548335500624
             le_variance =       0.300671821244

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300718900061
                                         uncertainty =       0.002179945547

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300718900061
                                         uncertainty =       0.002179945547

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387731509
  error estimate for blocks of size 2^( 2) =       0.000397814662
  error estimate for blocks of size 2^( 3) =       0.000406901782
  error estimate for blocks of size 2^( 4) =       0.000413636358
  error estimate for blocks of size 2^( 5) =       0.000417219772
  error estimate for blocks of size 2^( 6) =       0.000419467821
  error estimate for blocks of size 2^( 7) =       0.000420122390

      target function =                  N/A
              le_mean =     -17.216968005887
             les_mean =     296.737665361654
             stat err =       0.000417611585
             autocorr =       1.160066502454
              std dev =       0.548335158360
             le_variance =       0.300671445894

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300718571494
                                         uncertainty =       0.002179927277

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300718571494
                                         uncertainty =       0.002179927277

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387731297
  error estimate for blocks of size 2^( 2) =       0.000397814468
  error estimate for blocks of size 2^( 3) =       0.000406901607
  error estimate for blocks of size 2^( 4) =       0.000413636182
  error estimate for blocks of size 2^( 5) =       0.000417219600
  error estimate for blocks of size 2^( 6) =       0.000419467662
  error estimate for blocks of size 2^( 7) =       0.000420122247

      target function =                  N/A
              le_mean =     -17.216968009859
             les_mean =     296.737665039040
             stat err =       0.000417611423
             autocorr =       1.160066866377
              std dev =       0.548334858605
             le_variance =       0.300671117161


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216968010428        initial  <--
     3.9062e+02     3.9062e+03             1.8360e-06       -17.216968001365
     1.5625e+03     1.5625e+04             4.5913e-07       -17.216968005887
     6.2500e+03     6.2500e+04             1.1479e-07       -17.216968009859

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 54.4144
  </log>
  <optVariables href="H2O.s008.opt.xml">
  uu_0                 2.061926e-01 1 1  ON 0
  uu_1                 4.539049e-02 1 1  ON 1
  uu_2                -4.680630e-02 1 1  ON 2
  uu_3                -9.936291e-02 1 1  ON 3
  uu_4                -1.304426e-01 1 1  ON 4
  uu_5                -1.356403e-01 1 1  ON 5
  uu_6                -1.130350e-01 1 1  ON 6
  uu_7                -3.972152e-02 1 1  ON 7
  uu_8                 9.988792e-02 1 1  ON 8
  uu_9                 1.208923e-01 1 1  ON 9
  ud_0                 3.495757e-01 1 1  ON 10
  ud_1                 9.178421e-02 1 1  ON 11
  ud_2                -1.648718e-02 1 1  ON 12
  ud_3                -7.596230e-02 1 1  ON 13
  ud_4                -1.217493e-01 1 1  ON 14
  ud_5                -1.523202e-01 1 1  ON 15
  ud_6                -1.544630e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.465047e-03 1 1  ON 18
  ud_9                 9.258155e-02 1 1  ON 19
  eO_0                -7.504234e-01 1 1  ON 20
  eO_1                -4.354888e-01 1 1  ON 21
  eO_2                -3.597992e-02 1 1  ON 22
  eO_3                 2.081566e-01 1 1  ON 23
  eO_4                 2.891378e-01 1 1  ON 24
  eO_5                 3.052685e-01 1 1  ON 25
  eO_6                 2.501136e-01 1 1  ON 26
  eO_7                 1.121819e-01 1 1  ON 27
  eO_8                 2.793032e-02 1 1  ON 28
  eO_9                 1.846808e-02 1 1  ON 29
 eH1_0                -1.820102e-01 1 1  ON 30
 eH1_1                -1.027121e-01 1 1  ON 31
 eH1_2                -6.202859e-02 1 1  ON 32
 eH1_3                -2.594562e-02 1 1  ON 33
 eH1_4                 1.931537e-02 1 1  ON 34
 eH1_5                 3.552821e-02 1 1  ON 35
 eH1_6                 7.727978e-02 1 1  ON 36
 eH1_7                 1.103063e-01 1 1  ON 37
 eH1_8                 9.073694e-02 1 1  ON 38
 eH1_9                 2.428742e-02 1 1  ON 39
 eH2_0                -1.835292e-01 1 1  ON 40
 eH2_1                -1.038362e-01 1 1  ON 41
 eH2_2                -6.350520e-02 1 1  ON 42
 eH2_3                -2.706150e-02 1 1  ON 43
 eH2_4                 1.856807e-02 1 1  ON 44
 eH2_5                 3.504992e-02 1 1  ON 45
 eH2_6                 7.827825e-02 1 1  ON 46
 eH2_7                 1.134126e-01 1 1  ON 47
 eH2_8                 9.397268e-02 1 1  ON 48
 eH2_9                 2.639241e-02 1 1  ON 49
ci_001                -3.996473e-02 3 1  ON 50
ci_002                -3.016647e-02 3 1  ON 51
ci_003                -2.507350e-02 3 1  ON 52
ci_004                 2.111242e-02 3 1  ON 53
ci_005                 2.113585e-02 3 1  ON 54
ci_006                -1.943417e-02 3 1  ON 55
ci_007                -1.880460e-02 3 1  ON 56
ci_008                -1.774300e-02 3 1  ON 57
ci_009                -1.805843e-02 3 1  ON 58
ci_010                -1.730287e-02 3 1  ON 59
ci_011                -1.626648e-02 3 1  ON 60
ci_012                -1.614687e-02 3 1  ON 61
ci_013                -1.921777e-02 3 1  ON 62
ci_014                 1.385257e-02 3 1  ON 63
ci_015                 1.356355e-02 3 1  ON 64
ci_016                 1.626109e-02 3 1  ON 65
ci_017                 1.653428e-02 3 1  ON 66
ci_018                 1.263145e-02 3 1  ON 67
ci_019                 1.309184e-02 3 1  ON 68
ci_020                 1.328259e-02 3 1  ON 69
ci_021                 1.336546e-02 3 1  ON 70
ci_022                 1.114426e-02 3 1  ON 71
ci_023                 1.122756e-02 3 1  ON 72
ci_024                 1.228089e-02 3 1  ON 73
ci_025                 1.155423e-02 3 1  ON 74
ci_026                 1.090550e-02 3 1  ON 75
ci_027                 1.132716e-02 3 1  ON 76
ci_028                -1.425982e-02 3 1  ON 77
ci_029                -1.490909e-02 3 1  ON 78
ci_030                -1.110557e-02 3 1  ON 79
ci_031                -1.141168e-02 3 1  ON 80
ci_032                -1.349057e-02 3 1  ON 81
ci_033                 1.065699e-02 3 1  ON 82
ci_034                 1.063520e-02 3 1  ON 83
ci_035                -4.703609e-03 3 1  ON 84
ci_036                -1.040507e-02 3 1  ON 85
ci_037                -1.005834e-02 3 1  ON 86
ci_038                 1.873928e-03 3 1  ON 87
ci_039                 1.471061e-03 3 1  ON 88
ci_040                -4.065323e-03 3 1  ON 89
ci_041                 9.805460e-03 3 1  ON 90
ci_042                 9.855398e-03 3 1  ON 91
ci_043                -2.928981e-03 3 1  ON 92
ci_044                -1.514680e-02 3 1  ON 93
ci_045                -1.826392e-03 3 1  ON 94
ci_046                 5.708382e-03 3 1  ON 95
ci_047                 5.452580e-03 3 1  ON 96
ci_048                -1.169114e-02 3 1  ON 97
ci_049                -1.200949e-02 3 1  ON 98
ci_050                 7.414194e-03 3 1  ON 99
ci_051                 7.765242e-03 3 1  ON 100
ci_052                -6.441783e-03 3 1  ON 101
ci_053                -6.307955e-03 3 1  ON 102
ci_054                -3.220238e-03 3 1  ON 103
ci_055                -3.043294e-03 3 1  ON 104
ci_056                 4.495072e-03 3 1  ON 105
ci_057                 4.396790e-03 3 1  ON 106
ci_058                -6.794176e-03 3 1  ON 107
ci_059                -6.375896e-03 3 1  ON 108
ci_060                 8.241989e-03 3 1  ON 109
ci_061                 7.906076e-03 3 1  ON 110
ci_062                -3.257561e-03 3 1  ON 111
ci_063                -2.907700e-03 3 1  ON 112
ci_064                -3.133656e-03 3 1  ON 113
ci_065                -4.351572e-03 3 1  ON 114
ci_066                 5.563527e-03 3 1  ON 115
ci_067                 5.751353e-03 3 1  ON 116
ci_068                -4.597358e-03 3 1  ON 117
ci_069                -4.608501e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0291e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.2373
    reference variance = 0.186199
====================================================
  Execution time = 3.7604e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5286e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1367e-01
  Total weights = 1.956695299e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1013e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301164686297
                                         uncertainty =       0.001935445870

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301164686297
                                         uncertainty =       0.001935445870

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388075239
  error estimate for blocks of size 2^( 2) =       0.000398133381
  error estimate for blocks of size 2^( 3) =       0.000407254369
  error estimate for blocks of size 2^( 4) =       0.000413473952
  error estimate for blocks of size 2^( 5) =       0.000417872659
  error estimate for blocks of size 2^( 6) =       0.000420283701
  error estimate for blocks of size 2^( 7) =       0.000421878070

      target function =                  N/A
              le_mean =     -17.216002324521
             les_mean =     296.704407856265
             stat err =       0.000418377096
             autocorr =       1.162261717653
              std dev =       0.548821266627
             le_variance =       0.301204782702


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721600232452e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+03, overlap shift 3.9062e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216002324538       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216002325445       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216002325448       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216002325628       residual = 3.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216002325759       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216002325761       residual = 4.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216002325808       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216002325788       residual = 4.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216002325837       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216002325824       residual = 3.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.9062e+03 is 2.035879e-07

solving harmonic davidson linear method for identity shift 1.5625e+04, overlap shift 1.5625e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216002324538       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216002324765       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216002324765       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216002324808       residual = 3.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216002324863       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216002324856       residual = 4.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216002324860       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216002324820       residual = 4.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216002324866       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216002324809       residual = 3.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5625e+04 is 5.089736e-08

solving harmonic davidson linear method for identity shift 6.2500e+04, overlap shift 6.2500e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216002324538       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216002324594       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216002324595       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216002324607       residual = 3.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216002324617       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216002324620       residual = 4.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216002324609       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216002324603       residual = 4.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216002324625       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216002324721       residual = 3.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.2500e+04 is 1.272436e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.176754 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8630e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
  uu_0                 2.061926e-01 1 1  ON 0
  uu_1                 4.539051e-02 1 1  ON 1
  uu_2                -4.680630e-02 1 1  ON 2
  uu_3                -9.936292e-02 1 1  ON 3
  uu_4                -1.304426e-01 1 1  ON 4
  uu_5                -1.356403e-01 1 1  ON 5
  uu_6                -1.130350e-01 1 1  ON 6
  uu_7                -3.972152e-02 1 1  ON 7
  uu_8                 9.988792e-02 1 1  ON 8
  uu_9                 1.208923e-01 1 1  ON 9
  ud_0                 3.495757e-01 1 1  ON 10
  ud_1                 9.178422e-02 1 1  ON 11
  ud_2                -1.648718e-02 1 1  ON 12
  ud_3                -7.596230e-02 1 1  ON 13
  ud_4                -1.217493e-01 1 1  ON 14
  ud_5                -1.523202e-01 1 1  ON 15
  ud_6                -1.544630e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.465040e-03 1 1  ON 18
  ud_9                 9.258155e-02 1 1  ON 19
  eO_0                -7.504235e-01 1 1  ON 20
  eO_1                -4.354888e-01 1 1  ON 21
  eO_2                -3.597992e-02 1 1  ON 22
  eO_3                 2.081566e-01 1 1  ON 23
  eO_4                 2.891379e-01 1 1  ON 24
  eO_5                 3.052685e-01 1 1  ON 25
  eO_6                 2.501136e-01 1 1  ON 26
  eO_7                 1.121819e-01 1 1  ON 27
  eO_8                 2.793032e-02 1 1  ON 28
  eO_9                 1.846808e-02 1 1  ON 29
 eH1_0                -1.820102e-01 1 1  ON 30
 eH1_1                -1.027121e-01 1 1  ON 31
 eH1_2                -6.202859e-02 1 1  ON 32
 eH1_3                -2.594561e-02 1 1  ON 33
 eH1_4                 1.931537e-02 1 1  ON 34
 eH1_5                 3.552821e-02 1 1  ON 35
 eH1_6                 7.727979e-02 1 1  ON 36
 eH1_7                 1.103063e-01 1 1  ON 37
 eH1_8                 9.073694e-02 1 1  ON 38
 eH1_9                 2.428742e-02 1 1  ON 39
 eH2_0                -1.835292e-01 1 1  ON 40
 eH2_1                -1.038362e-01 1 1  ON 41
 eH2_2                -6.350520e-02 1 1  ON 42
 eH2_3                -2.706150e-02 1 1  ON 43
 eH2_4                 1.856807e-02 1 1  ON 44
 eH2_5                 3.504992e-02 1 1  ON 45
 eH2_6                 7.827825e-02 1 1  ON 46
 eH2_7                 1.134126e-01 1 1  ON 47
 eH2_8                 9.397269e-02 1 1  ON 48
 eH2_9                 2.639242e-02 1 1  ON 49
ci_001                -3.996472e-02 3 1  ON 50
ci_002                -3.016645e-02 3 1  ON 51
ci_003                -2.507350e-02 3 1  ON 52
ci_004                 2.111243e-02 3 1  ON 53
ci_005                 2.113586e-02 3 1  ON 54
ci_006                -1.943416e-02 3 1  ON 55
ci_007                -1.880460e-02 3 1  ON 56
ci_008                -1.774301e-02 3 1  ON 57
ci_009                -1.805842e-02 3 1  ON 58
ci_010                -1.730288e-02 3 1  ON 59
ci_011                -1.626648e-02 3 1  ON 60
ci_012                -1.614687e-02 3 1  ON 61
ci_013                -1.921777e-02 3 1  ON 62
ci_014                 1.385257e-02 3 1  ON 63
ci_015                 1.356356e-02 3 1  ON 64
ci_016                 1.626109e-02 3 1  ON 65
ci_017                 1.653429e-02 3 1  ON 66
ci_018                 1.263146e-02 3 1  ON 67
ci_019                 1.309183e-02 3 1  ON 68
ci_020                 1.328259e-02 3 1  ON 69
ci_021                 1.336546e-02 3 1  ON 70
ci_022                 1.114428e-02 3 1  ON 71
ci_023                 1.122756e-02 3 1  ON 72
ci_024                 1.228089e-02 3 1  ON 73
ci_025                 1.155423e-02 3 1  ON 74
ci_026                 1.090550e-02 3 1  ON 75
ci_027                 1.132716e-02 3 1  ON 76
ci_028                -1.425982e-02 3 1  ON 77
ci_029                -1.490909e-02 3 1  ON 78
ci_030                -1.110556e-02 3 1  ON 79
ci_031                -1.141167e-02 3 1  ON 80
ci_032                -1.349058e-02 3 1  ON 81
ci_033                 1.065700e-02 3 1  ON 82
ci_034                 1.063520e-02 3 1  ON 83
ci_035                -4.703609e-03 3 1  ON 84
ci_036                -1.040508e-02 3 1  ON 85
ci_037                -1.005834e-02 3 1  ON 86
ci_038                 1.873921e-03 3 1  ON 87
ci_039                 1.471057e-03 3 1  ON 88
ci_040                -4.065327e-03 3 1  ON 89
ci_041                 9.805454e-03 3 1  ON 90
ci_042                 9.855394e-03 3 1  ON 91
ci_043                -2.928976e-03 3 1  ON 92
ci_044                -1.514680e-02 3 1  ON 93
ci_045                -1.826391e-03 3 1  ON 94
ci_046                 5.708366e-03 3 1  ON 95
ci_047                 5.452591e-03 3 1  ON 96
ci_048                -1.169113e-02 3 1  ON 97
ci_049                -1.200948e-02 3 1  ON 98
ci_050                 7.414190e-03 3 1  ON 99
ci_051                 7.765233e-03 3 1  ON 100
ci_052                -6.441789e-03 3 1  ON 101
ci_053                -6.307947e-03 3 1  ON 102
ci_054                -3.220228e-03 3 1  ON 103
ci_055                -3.043296e-03 3 1  ON 104
ci_056                 4.495067e-03 3 1  ON 105
ci_057                 4.396785e-03 3 1  ON 106
ci_058                -6.794176e-03 3 1  ON 107
ci_059                -6.375893e-03 3 1  ON 108
ci_060                 8.241982e-03 3 1  ON 109
ci_061                 7.906080e-03 3 1  ON 110
ci_062                -3.257563e-03 3 1  ON 111
ci_063                -2.907694e-03 3 1  ON 112
ci_064                -3.133650e-03 3 1  ON 113
ci_065                -4.351558e-03 3 1  ON 114
ci_066                 5.563538e-03 3 1  ON 115
ci_067                 5.751332e-03 3 1  ON 116
ci_068                -4.597359e-03 3 1  ON 117
ci_069                -4.608507e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.1531
    reference variance = 0.266505
====================================================
  Execution time = 3.7566e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1608e-01
  Total weights = 1.9563e+06
  Execution time = 3.3447e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300006484478
                                         uncertainty =       0.001902853724

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300006484478
                                         uncertainty =       0.001902853724

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387331573
  error estimate for blocks of size 2^( 2) =       0.000397215577
  error estimate for blocks of size 2^( 3) =       0.000406238390
  error estimate for blocks of size 2^( 4) =       0.000412752368
  error estimate for blocks of size 2^( 5) =       0.000416445048
  error estimate for blocks of size 2^( 6) =       0.000418548386
  error estimate for blocks of size 2^( 7) =       0.000422454408

      target function =                  N/A
              le_mean =     -17.215796595422
             les_mean =     296.699734142902
             stat err =       0.000417550053
             autocorr =       1.162120831709
              std dev =       0.547769563612
             le_variance =       0.300051494820

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300006521476
                                         uncertainty =       0.001902854514

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300006521476
                                         uncertainty =       0.001902854514

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387331597
  error estimate for blocks of size 2^( 2) =       0.000397215601
  error estimate for blocks of size 2^( 3) =       0.000406238412
  error estimate for blocks of size 2^( 4) =       0.000412752391
  error estimate for blocks of size 2^( 5) =       0.000416445066
  error estimate for blocks of size 2^( 6) =       0.000418548406
  error estimate for blocks of size 2^( 7) =       0.000422454425

      target function =                  N/A
              le_mean =     -17.215796595863
             les_mean =     296.699734142383
             stat err =       0.000417550072
             autocorr =       1.162120795229
              std dev =       0.547769597446
             le_variance =       0.300051531886

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300006502977
                                         uncertainty =       0.001902854119

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300006502977
                                         uncertainty =       0.001902854119

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387331585
  error estimate for blocks of size 2^( 2) =       0.000397215589
  error estimate for blocks of size 2^( 3) =       0.000406238401
  error estimate for blocks of size 2^( 4) =       0.000412752379
  error estimate for blocks of size 2^( 5) =       0.000416445057
  error estimate for blocks of size 2^( 6) =       0.000418548396
  error estimate for blocks of size 2^( 7) =       0.000422454416

      target function =                  N/A
              le_mean =     -17.215796595643
             les_mean =     296.699734142557
             stat err =       0.000417550062
             autocorr =       1.162120813463
              std dev =       0.547769580529
             le_variance =       0.300051513353

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300006486790
                                         uncertainty =       0.001902853774

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300006486790
                                         uncertainty =       0.001902853774

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387331574
  error estimate for blocks of size 2^( 2) =       0.000397215579
  error estimate for blocks of size 2^( 3) =       0.000406238391
  error estimate for blocks of size 2^( 4) =       0.000412752370
  error estimate for blocks of size 2^( 5) =       0.000416445049
  error estimate for blocks of size 2^( 6) =       0.000418548388
  error estimate for blocks of size 2^( 7) =       0.000422454409

      target function =                  N/A
              le_mean =     -17.215796595450
             les_mean =     296.699734142850
             stat err =       0.000417550054
             autocorr =       1.162120829432
              std dev =       0.547769565727
             le_variance =       0.300051497136


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215796595422        initial
     3.9062e+03     3.9062e+04             2.0359e-07       -17.215796595863  <--
     1.5625e+04     1.5625e+05             5.0897e-08       -17.215796595643
     6.2500e+04     6.2500e+05             1.2724e-08       -17.215796595450

*****************************************************************************
Applying the update for shift_i =   3.9062e+03     and shift_s =   3.9062e+04
*****************************************************************************

  Execution time = 5.4477e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
  uu_0                 2.061927e-01 1 1  ON 0
  uu_1                 4.539055e-02 1 1  ON 1
  uu_2                -4.680629e-02 1 1  ON 2
  uu_3                -9.936294e-02 1 1  ON 3
  uu_4                -1.304426e-01 1 1  ON 4
  uu_5                -1.356403e-01 1 1  ON 5
  uu_6                -1.130350e-01 1 1  ON 6
  uu_7                -3.972154e-02 1 1  ON 7
  uu_8                 9.988791e-02 1 1  ON 8
  uu_9                 1.208923e-01 1 1  ON 9
  ud_0                 3.495758e-01 1 1  ON 10
  ud_1                 9.178423e-02 1 1  ON 11
  ud_2                -1.648719e-02 1 1  ON 12
  ud_3                -7.596232e-02 1 1  ON 13
  ud_4                -1.217493e-01 1 1  ON 14
  ud_5                -1.523202e-01 1 1  ON 15
  ud_6                -1.544630e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.465018e-03 1 1  ON 18
  ud_9                 9.258156e-02 1 1  ON 19
  eO_0                -7.504236e-01 1 1  ON 20
  eO_1                -4.354889e-01 1 1  ON 21
  eO_2                -3.597992e-02 1 1  ON 22
  eO_3                 2.081567e-01 1 1  ON 23
  eO_4                 2.891380e-01 1 1  ON 24
  eO_5                 3.052686e-01 1 1  ON 25
  eO_6                 2.501136e-01 1 1  ON 26
  eO_7                 1.121820e-01 1 1  ON 27
  eO_8                 2.793033e-02 1 1  ON 28
  eO_9                 1.846808e-02 1 1  ON 29
 eH1_0                -1.820102e-01 1 1  ON 30
 eH1_1                -1.027121e-01 1 1  ON 31
 eH1_2                -6.202862e-02 1 1  ON 32
 eH1_3                -2.594561e-02 1 1  ON 33
 eH1_4                 1.931537e-02 1 1  ON 34
 eH1_5                 3.552821e-02 1 1  ON 35
 eH1_6                 7.727980e-02 1 1  ON 36
 eH1_7                 1.103063e-01 1 1  ON 37
 eH1_8                 9.073695e-02 1 1  ON 38
 eH1_9                 2.428742e-02 1 1  ON 39
 eH2_0                -1.835292e-01 1 1  ON 40
 eH2_1                -1.038362e-01 1 1  ON 41
 eH2_2                -6.350520e-02 1 1  ON 42
 eH2_3                -2.706150e-02 1 1  ON 43
 eH2_4                 1.856807e-02 1 1  ON 44
 eH2_5                 3.504994e-02 1 1  ON 45
 eH2_6                 7.827825e-02 1 1  ON 46
 eH2_7                 1.134126e-01 1 1  ON 47
 eH2_8                 9.397270e-02 1 1  ON 48
 eH2_9                 2.639242e-02 1 1  ON 49
ci_001                -3.996471e-02 3 1  ON 50
ci_002                -3.016640e-02 3 1  ON 51
ci_003                -2.507349e-02 3 1  ON 52
ci_004                 2.111243e-02 3 1  ON 53
ci_005                 2.113587e-02 3 1  ON 54
ci_006                -1.943414e-02 3 1  ON 55
ci_007                -1.880461e-02 3 1  ON 56
ci_008                -1.774303e-02 3 1  ON 57
ci_009                -1.805839e-02 3 1  ON 58
ci_010                -1.730291e-02 3 1  ON 59
ci_011                -1.626647e-02 3 1  ON 60
ci_012                -1.614686e-02 3 1  ON 61
ci_013                -1.921775e-02 3 1  ON 62
ci_014                 1.385257e-02 3 1  ON 63
ci_015                 1.356360e-02 3 1  ON 64
ci_016                 1.626109e-02 3 1  ON 65
ci_017                 1.653430e-02 3 1  ON 66
ci_018                 1.263150e-02 3 1  ON 67
ci_019                 1.309179e-02 3 1  ON 68
ci_020                 1.328260e-02 3 1  ON 69
ci_021                 1.336545e-02 3 1  ON 70
ci_022                 1.114433e-02 3 1  ON 71
ci_023                 1.122755e-02 3 1  ON 72
ci_024                 1.228087e-02 3 1  ON 73
ci_025                 1.155424e-02 3 1  ON 74
ci_026                 1.090550e-02 3 1  ON 75
ci_027                 1.132717e-02 3 1  ON 76
ci_028                -1.425983e-02 3 1  ON 77
ci_029                -1.490909e-02 3 1  ON 78
ci_030                -1.110553e-02 3 1  ON 79
ci_031                -1.141166e-02 3 1  ON 80
ci_032                -1.349058e-02 3 1  ON 81
ci_033                 1.065703e-02 3 1  ON 82
ci_034                 1.063519e-02 3 1  ON 83
ci_035                -4.703609e-03 3 1  ON 84
ci_036                -1.040510e-02 3 1  ON 85
ci_037                -1.005837e-02 3 1  ON 86
ci_038                 1.873900e-03 3 1  ON 87
ci_039                 1.471045e-03 3 1  ON 88
ci_040                -4.065339e-03 3 1  ON 89
ci_041                 9.805439e-03 3 1  ON 90
ci_042                 9.855381e-03 3 1  ON 91
ci_043                -2.928964e-03 3 1  ON 92
ci_044                -1.514678e-02 3 1  ON 93
ci_045                -1.826389e-03 3 1  ON 94
ci_046                 5.708318e-03 3 1  ON 95
ci_047                 5.452626e-03 3 1  ON 96
ci_048                -1.169110e-02 3 1  ON 97
ci_049                -1.200947e-02 3 1  ON 98
ci_050                 7.414180e-03 3 1  ON 99
ci_051                 7.765205e-03 3 1  ON 100
ci_052                -6.441807e-03 3 1  ON 101
ci_053                -6.307923e-03 3 1  ON 102
ci_054                -3.220197e-03 3 1  ON 103
ci_055                -3.043302e-03 3 1  ON 104
ci_056                 4.495052e-03 3 1  ON 105
ci_057                 4.396773e-03 3 1  ON 106
ci_058                -6.794174e-03 3 1  ON 107
ci_059                -6.375885e-03 3 1  ON 108
ci_060                 8.241962e-03 3 1  ON 109
ci_061                 7.906093e-03 3 1  ON 110
ci_062                -3.257570e-03 3 1  ON 111
ci_063                -2.907675e-03 3 1  ON 112
ci_064                -3.133635e-03 3 1  ON 113
ci_065                -4.351515e-03 3 1  ON 114
ci_066                 5.563570e-03 3 1  ON 115
ci_067                 5.751269e-03 3 1  ON 116
ci_068                -4.597361e-03 3 1  ON 117
ci_069                -4.608527e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0311e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7216e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.1898
    reference variance = 0.348277
====================================================
  Execution time = 3.7936e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5283e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1355e-01
  Total weights = 1.956756055e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1059e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299929338091
                                         uncertainty =       0.001694104261

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299929338091
                                         uncertainty =       0.001694104261

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387241912
  error estimate for blocks of size 2^( 2) =       0.000396974674
  error estimate for blocks of size 2^( 3) =       0.000405934477
  error estimate for blocks of size 2^( 4) =       0.000412049888
  error estimate for blocks of size 2^( 5) =       0.000415876416
  error estimate for blocks of size 2^( 6) =       0.000418027788
  error estimate for blocks of size 2^( 7) =       0.000419751583

      target function =                  N/A
              le_mean =     -17.216583479027
             les_mean =     296.724296396960
             stat err =       0.000416426419
             autocorr =       1.156409991614
              std dev =       0.547642764482
             le_variance =       0.299912597489


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721658347903e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216583479070       residual = 9.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216583484949       residual = 5.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216583485380       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216583486305       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216583486806       residual = 9.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216583487157       residual = 4.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216583487259       residual = 8.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216583487288       residual = 2.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216583487283       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216583487286       residual = 2.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.7656e+02 is 7.232781e-07

solving harmonic davidson linear method for identity shift 3.9062e+03, overlap shift 3.9062e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216583479070       residual = 9.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216583480540       residual = 5.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216583480647       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216583480881       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216583481004       residual = 9.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216583481091       residual = 4.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216583481118       residual = 8.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216583481131       residual = 2.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216583481118       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216583481138       residual = 2.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.9062e+03 is 1.808248e-07

solving harmonic davidson linear method for identity shift 1.5625e+04, overlap shift 1.5625e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216583479070       residual = 9.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216583479437       residual = 5.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216583479464       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216583479527       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216583479556       residual = 9.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216583479602       residual = 4.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216583479583       residual = 8.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216583479564       residual = 2.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216583479582       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216583479610       residual = 2.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5625e+04 is 4.520653e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.180846 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.9009e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
  uu_0                 2.061927e-01 1 1  ON 0
  uu_1                 4.539061e-02 1 1  ON 1
  uu_2                -4.680626e-02 1 1  ON 2
  uu_3                -9.936296e-02 1 1  ON 3
  uu_4                -1.304427e-01 1 1  ON 4
  uu_5                -1.356403e-01 1 1  ON 5
  uu_6                -1.130350e-01 1 1  ON 6
  uu_7                -3.972158e-02 1 1  ON 7
  uu_8                 9.988788e-02 1 1  ON 8
  uu_9                 1.208923e-01 1 1  ON 9
  ud_0                 3.495758e-01 1 1  ON 10
  ud_1                 9.178425e-02 1 1  ON 11
  ud_2                -1.648719e-02 1 1  ON 12
  ud_3                -7.596232e-02 1 1  ON 13
  ud_4                -1.217494e-01 1 1  ON 14
  ud_5                -1.523202e-01 1 1  ON 15
  ud_6                -1.544630e-01 1 1  ON 16
  ud_7                -1.100035e-01 1 1  ON 17
  ud_8                 4.464979e-03 1 1  ON 18
  ud_9                 9.258156e-02 1 1  ON 19
  eO_0                -7.504238e-01 1 1  ON 20
  eO_1                -4.354891e-01 1 1  ON 21
  eO_2                -3.597996e-02 1 1  ON 22
  eO_3                 2.081568e-01 1 1  ON 23
  eO_4                 2.891382e-01 1 1  ON 24
  eO_5                 3.052686e-01 1 1  ON 25
  eO_6                 2.501136e-01 1 1  ON 26
  eO_7                 1.121820e-01 1 1  ON 27
  eO_8                 2.793033e-02 1 1  ON 28
  eO_9                 1.846809e-02 1 1  ON 29
 eH1_0                -1.820102e-01 1 1  ON 30
 eH1_1                -1.027122e-01 1 1  ON 31
 eH1_2                -6.202865e-02 1 1  ON 32
 eH1_3                -2.594561e-02 1 1  ON 33
 eH1_4                 1.931538e-02 1 1  ON 34
 eH1_5                 3.552822e-02 1 1  ON 35
 eH1_6                 7.727981e-02 1 1  ON 36
 eH1_7                 1.103063e-01 1 1  ON 37
 eH1_8                 9.073697e-02 1 1  ON 38
 eH1_9                 2.428743e-02 1 1  ON 39
 eH2_0                -1.835292e-01 1 1  ON 40
 eH2_1                -1.038363e-01 1 1  ON 41
 eH2_2                -6.350519e-02 1 1  ON 42
 eH2_3                -2.706150e-02 1 1  ON 43
 eH2_4                 1.856807e-02 1 1  ON 44
 eH2_5                 3.504996e-02 1 1  ON 45
 eH2_6                 7.827826e-02 1 1  ON 46
 eH2_7                 1.134125e-01 1 1  ON 47
 eH2_8                 9.397272e-02 1 1  ON 48
 eH2_9                 2.639243e-02 1 1  ON 49
ci_001                -3.996474e-02 3 1  ON 50
ci_002                -3.016641e-02 3 1  ON 51
ci_003                -2.507347e-02 3 1  ON 52
ci_004                 2.111243e-02 3 1  ON 53
ci_005                 2.113588e-02 3 1  ON 54
ci_006                -1.943418e-02 3 1  ON 55
ci_007                -1.880463e-02 3 1  ON 56
ci_008                -1.774299e-02 3 1  ON 57
ci_009                -1.805834e-02 3 1  ON 58
ci_010                -1.730294e-02 3 1  ON 59
ci_011                -1.626647e-02 3 1  ON 60
ci_012                -1.614696e-02 3 1  ON 61
ci_013                -1.921779e-02 3 1  ON 62
ci_014                 1.385255e-02 3 1  ON 63
ci_015                 1.356359e-02 3 1  ON 64
ci_016                 1.626112e-02 3 1  ON 65
ci_017                 1.653431e-02 3 1  ON 66
ci_018                 1.263148e-02 3 1  ON 67
ci_019                 1.309177e-02 3 1  ON 68
ci_020                 1.328257e-02 3 1  ON 69
ci_021                 1.336542e-02 3 1  ON 70
ci_022                 1.114434e-02 3 1  ON 71
ci_023                 1.122756e-02 3 1  ON 72
ci_024                 1.228083e-02 3 1  ON 73
ci_025                 1.155425e-02 3 1  ON 74
ci_026                 1.090551e-02 3 1  ON 75
ci_027                 1.132715e-02 3 1  ON 76
ci_028                -1.425988e-02 3 1  ON 77
ci_029                -1.490905e-02 3 1  ON 78
ci_030                -1.110554e-02 3 1  ON 79
ci_031                -1.141163e-02 3 1  ON 80
ci_032                -1.349060e-02 3 1  ON 81
ci_033                 1.065701e-02 3 1  ON 82
ci_034                 1.063517e-02 3 1  ON 83
ci_035                -4.703597e-03 3 1  ON 84
ci_036                -1.040507e-02 3 1  ON 85
ci_037                -1.005840e-02 3 1  ON 86
ci_038                 1.873836e-03 3 1  ON 87
ci_039                 1.471035e-03 3 1  ON 88
ci_040                -4.065349e-03 3 1  ON 89
ci_041                 9.805416e-03 3 1  ON 90
ci_042                 9.855358e-03 3 1  ON 91
ci_043                -2.928986e-03 3 1  ON 92
ci_044                -1.514680e-02 3 1  ON 93
ci_045                -1.826399e-03 3 1  ON 94
ci_046                 5.708287e-03 3 1  ON 95
ci_047                 5.452661e-03 3 1  ON 96
ci_048                -1.169111e-02 3 1  ON 97
ci_049                -1.200950e-02 3 1  ON 98
ci_050                 7.414203e-03 3 1  ON 99
ci_051                 7.765162e-03 3 1  ON 100
ci_052                -6.441805e-03 3 1  ON 101
ci_053                -6.307912e-03 3 1  ON 102
ci_054                -3.220141e-03 3 1  ON 103
ci_055                -3.043299e-03 3 1  ON 104
ci_056                 4.494989e-03 3 1  ON 105
ci_057                 4.396824e-03 3 1  ON 106
ci_058                -6.794218e-03 3 1  ON 107
ci_059                -6.375925e-03 3 1  ON 108
ci_060                 8.241955e-03 3 1  ON 109
ci_061                 7.906085e-03 3 1  ON 110
ci_062                -3.257551e-03 3 1  ON 111
ci_063                -2.907688e-03 3 1  ON 112
ci_064                -3.133615e-03 3 1  ON 113
ci_065                -4.351471e-03 3 1  ON 114
ci_066                 5.563594e-03 3 1  ON 115
ci_067                 5.751281e-03 3 1  ON 116
ci_068                -4.597355e-03 3 1  ON 117
ci_069                -4.608520e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.2621
    reference variance = 0.129616
====================================================
  Execution time = 3.7746e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1460e-01
  Total weights = 1.9564e+06
  Execution time = 3.3478e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300638877227
                                         uncertainty =       0.002490661551

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300638877227
                                         uncertainty =       0.002490661551

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387703257
  error estimate for blocks of size 2^( 2) =       0.000397590067
  error estimate for blocks of size 2^( 3) =       0.000406460860
  error estimate for blocks of size 2^( 4) =       0.000413906610
  error estimate for blocks of size 2^( 5) =       0.000418174682
  error estimate for blocks of size 2^( 6) =       0.000419942087
  error estimate for blocks of size 2^( 7) =       0.000421736036

      target function =                  N/A
              le_mean =     -17.216743928534
             les_mean =     296.730875868202
             stat err =       0.000418439854
             autocorr =       1.164842439637
              std dev =       0.548295203748
             le_variance =       0.300627630453

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300638928380
                                         uncertainty =       0.002490656971

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300638928380
                                         uncertainty =       0.002490656971

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387703289
  error estimate for blocks of size 2^( 2) =       0.000397590097
  error estimate for blocks of size 2^( 3) =       0.000406460886
  error estimate for blocks of size 2^( 4) =       0.000413906634
  error estimate for blocks of size 2^( 5) =       0.000418174705
  error estimate for blocks of size 2^( 6) =       0.000419942097
  error estimate for blocks of size 2^( 7) =       0.000421736052

      target function =                  N/A
              le_mean =     -17.216743936556
             les_mean =     296.730875312573
             stat err =       0.000418439872
             autocorr =       1.164842346502
              std dev =       0.548295249945
             le_variance =       0.300627681112

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300638902797
                                         uncertainty =       0.002490659261

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300638902797
                                         uncertainty =       0.002490659261

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387703273
  error estimate for blocks of size 2^( 2) =       0.000397590082
  error estimate for blocks of size 2^( 3) =       0.000406460873
  error estimate for blocks of size 2^( 4) =       0.000413906622
  error estimate for blocks of size 2^( 5) =       0.000418174693
  error estimate for blocks of size 2^( 6) =       0.000419942092
  error estimate for blocks of size 2^( 7) =       0.000421736044

      target function =                  N/A
              le_mean =     -17.216743932546
             les_mean =     296.730875588760
             stat err =       0.000418439863
             autocorr =       1.164842393069
              std dev =       0.548295226840
             le_variance =       0.300627655775

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300638880423
                                         uncertainty =       0.002490661265

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300638880423
                                         uncertainty =       0.002490661265

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387703259
  error estimate for blocks of size 2^( 2) =       0.000397590069
  error estimate for blocks of size 2^( 3) =       0.000406460862
  error estimate for blocks of size 2^( 4) =       0.000413906612
  error estimate for blocks of size 2^( 5) =       0.000418174683
  error estimate for blocks of size 2^( 6) =       0.000419942088
  error estimate for blocks of size 2^( 7) =       0.000421736037

      target function =                  N/A
              le_mean =     -17.216743929036
             les_mean =     296.730875833098
             stat err =       0.000418439855
             autocorr =       1.164842433803
              std dev =       0.548295206634
             le_variance =       0.300627633618


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216743928534        initial
     9.7656e+02     9.7656e+03             7.2328e-07       -17.216743936556  <--
     3.9062e+03     3.9062e+04             1.8082e-07       -17.216743932546
     1.5625e+04     1.5625e+05             4.5207e-08       -17.216743929036

*****************************************************************************
Applying the update for shift_i =   9.7656e+02     and shift_s =   9.7656e+03
*****************************************************************************

  Execution time = 5.4666e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
  uu_0                 2.061929e-01 1 1  ON 0
  uu_1                 4.539078e-02 1 1  ON 1
  uu_2                -4.680618e-02 1 1  ON 2
  uu_3                -9.936300e-02 1 1  ON 3
  uu_4                -1.304428e-01 1 1  ON 4
  uu_5                -1.356405e-01 1 1  ON 5
  uu_6                -1.130350e-01 1 1  ON 6
  uu_7                -3.972170e-02 1 1  ON 7
  uu_8                 9.988780e-02 1 1  ON 8
  uu_9                 1.208923e-01 1 1  ON 9
  ud_0                 3.495759e-01 1 1  ON 10
  ud_1                 9.178430e-02 1 1  ON 11
  ud_2                -1.648717e-02 1 1  ON 12
  ud_3                -7.596231e-02 1 1  ON 13
  ud_4                -1.217494e-01 1 1  ON 14
  ud_5                -1.523203e-01 1 1  ON 15
  ud_6                -1.544629e-01 1 1  ON 16
  ud_7                -1.100035e-01 1 1  ON 17
  ud_8                 4.464862e-03 1 1  ON 18
  ud_9                 9.258156e-02 1 1  ON 19
  eO_0                -7.504243e-01 1 1  ON 20
  eO_1                -4.354894e-01 1 1  ON 21
  eO_2                -3.598007e-02 1 1  ON 22
  eO_3                 2.081571e-01 1 1  ON 23
  eO_4                 2.891386e-01 1 1  ON 24
  eO_5                 3.052687e-01 1 1  ON 25
  eO_6                 2.501137e-01 1 1  ON 26
  eO_7                 1.121821e-01 1 1  ON 27
  eO_8                 2.793035e-02 1 1  ON 28
  eO_9                 1.846810e-02 1 1  ON 29
 eH1_0                -1.820102e-01 1 1  ON 30
 eH1_1                -1.027122e-01 1 1  ON 31
 eH1_2                -6.202874e-02 1 1  ON 32
 eH1_3                -2.594560e-02 1 1  ON 33
 eH1_4                 1.931541e-02 1 1  ON 34
 eH1_5                 3.552824e-02 1 1  ON 35
 eH1_6                 7.727985e-02 1 1  ON 36
 eH1_7                 1.103063e-01 1 1  ON 37
 eH1_8                 9.073702e-02 1 1  ON 38
 eH1_9                 2.428745e-02 1 1  ON 39
 eH2_0                -1.835293e-01 1 1  ON 40
 eH2_1                -1.038364e-01 1 1  ON 41
 eH2_2                -6.350516e-02 1 1  ON 42
 eH2_3                -2.706149e-02 1 1  ON 43
 eH2_4                 1.856805e-02 1 1  ON 44
 eH2_5                 3.505003e-02 1 1  ON 45
 eH2_6                 7.827829e-02 1 1  ON 46
 eH2_7                 1.134125e-01 1 1  ON 47
 eH2_8                 9.397277e-02 1 1  ON 48
 eH2_9                 2.639244e-02 1 1  ON 49
ci_001                -3.996482e-02 3 1  ON 50
ci_002                -3.016644e-02 3 1  ON 51
ci_003                -2.507341e-02 3 1  ON 52
ci_004                 2.111243e-02 3 1  ON 53
ci_005                 2.113588e-02 3 1  ON 54
ci_006                -1.943429e-02 3 1  ON 55
ci_007                -1.880470e-02 3 1  ON 56
ci_008                -1.774288e-02 3 1  ON 57
ci_009                -1.805820e-02 3 1  ON 58
ci_010                -1.730303e-02 3 1  ON 59
ci_011                -1.626648e-02 3 1  ON 60
ci_012                -1.614726e-02 3 1  ON 61
ci_013                -1.921792e-02 3 1  ON 62
ci_014                 1.385250e-02 3 1  ON 63
ci_015                 1.356358e-02 3 1  ON 64
ci_016                 1.626122e-02 3 1  ON 65
ci_017                 1.653435e-02 3 1  ON 66
ci_018                 1.263145e-02 3 1  ON 67
ci_019                 1.309169e-02 3 1  ON 68
ci_020                 1.328249e-02 3 1  ON 69
ci_021                 1.336534e-02 3 1  ON 70
ci_022                 1.114438e-02 3 1  ON 71
ci_023                 1.122758e-02 3 1  ON 72
ci_024                 1.228072e-02 3 1  ON 73
ci_025                 1.155427e-02 3 1  ON 74
ci_026                 1.090554e-02 3 1  ON 75
ci_027                 1.132709e-02 3 1  ON 76
ci_028                -1.426000e-02 3 1  ON 77
ci_029                -1.490894e-02 3 1  ON 78
ci_030                -1.110557e-02 3 1  ON 79
ci_031                -1.141153e-02 3 1  ON 80
ci_032                -1.349066e-02 3 1  ON 81
ci_033                 1.065698e-02 3 1  ON 82
ci_034                 1.063513e-02 3 1  ON 83
ci_035                -4.703559e-03 3 1  ON 84
ci_036                -1.040499e-02 3 1  ON 85
ci_037                -1.005852e-02 3 1  ON 86
ci_038                 1.873646e-03 3 1  ON 87
ci_039                 1.471005e-03 3 1  ON 88
ci_040                -4.065381e-03 3 1  ON 89
ci_041                 9.805348e-03 3 1  ON 90
ci_042                 9.855290e-03 3 1  ON 91
ci_043                -2.929054e-03 3 1  ON 92
ci_044                -1.514685e-02 3 1  ON 93
ci_045                -1.826430e-03 3 1  ON 94
ci_046                 5.708193e-03 3 1  ON 95
ci_047                 5.452764e-03 3 1  ON 96
ci_048                -1.169115e-02 3 1  ON 97
ci_049                -1.200958e-02 3 1  ON 98
ci_050                 7.414272e-03 3 1  ON 99
ci_051                 7.765030e-03 3 1  ON 100
ci_052                -6.441799e-03 3 1  ON 101
ci_053                -6.307879e-03 3 1  ON 102
ci_054                -3.219974e-03 3 1  ON 103
ci_055                -3.043289e-03 3 1  ON 104
ci_056                 4.494801e-03 3 1  ON 105
ci_057                 4.396977e-03 3 1  ON 106
ci_058                -6.794351e-03 3 1  ON 107
ci_059                -6.376047e-03 3 1  ON 108
ci_060                 8.241935e-03 3 1  ON 109
ci_061                 7.906062e-03 3 1  ON 110
ci_062                -3.257495e-03 3 1  ON 111
ci_063                -2.907727e-03 3 1  ON 112
ci_064                -3.133556e-03 3 1  ON 113
ci_065                -4.351341e-03 3 1  ON 114
ci_066                 5.563668e-03 3 1  ON 115
ci_067                 5.751315e-03 3 1  ON 116
ci_068                -4.597337e-03 3 1  ON 117
ci_069                -4.608501e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0368e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.1768
    reference variance = 0.226807
====================================================
  Execution time = 3.7837e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5285e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1390e-01
  Total weights = 1.956234781e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0930e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299813607274
                                         uncertainty =       0.002350360316

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299813607274
                                         uncertainty =       0.002350360316

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387148750
  error estimate for blocks of size 2^( 2) =       0.000397152445
  error estimate for blocks of size 2^( 3) =       0.000406619333
  error estimate for blocks of size 2^( 4) =       0.000414412960
  error estimate for blocks of size 2^( 5) =       0.000417801503
  error estimate for blocks of size 2^( 6) =       0.000419337783
  error estimate for blocks of size 2^( 7) =       0.000419400008

      target function =                  N/A
              le_mean =     -17.216720661981
             les_mean =     296.729370039435
             stat err =       0.000417738064
             autocorr =       1.164266432273
              std dev =       0.547511012521
             le_variance =       0.299768308832


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721672066198e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216720662006       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216720674683       residual = 3.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216720678058       residual = 4.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216720679237       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216720679156       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216720677830       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216720680733       residual = 4.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216720681899       residual = 7.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216720681658       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216720681678       residual = 4.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.4414e+02 is 2.920903e-06

solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216720662006       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216720665178       residual = 3.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216720666022       residual = 4.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216720666317       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216720666296       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216720665964       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216720666690       residual = 4.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216720666980       residual = 7.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216720666922       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216720666922       residual = 4.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.7656e+02 is 7.303090e-07

solving harmonic davidson linear method for identity shift 3.9062e+03, overlap shift 3.9062e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216720662006       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216720662799       residual = 3.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216720663010       residual = 4.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216720663084       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216720663079       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216720662995       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216720663174       residual = 4.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216720663256       residual = 7.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216720663228       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216720663225       residual = 4.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.9062e+03 is 1.825825e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.184846 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8780e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
  uu_0                 2.061931e-01 1 1  ON 0
  uu_1                 4.539075e-02 1 1  ON 1
  uu_2                -4.680605e-02 1 1  ON 2
  uu_3                -9.936299e-02 1 1  ON 3
  uu_4                -1.304431e-01 1 1  ON 4
  uu_5                -1.356405e-01 1 1  ON 5
  uu_6                -1.130351e-01 1 1  ON 6
  uu_7                -3.972179e-02 1 1  ON 7
  uu_8                 9.988776e-02 1 1  ON 8
  uu_9                 1.208924e-01 1 1  ON 9
  ud_0                 3.495762e-01 1 1  ON 10
  ud_1                 9.178433e-02 1 1  ON 11
  ud_2                -1.648719e-02 1 1  ON 12
  ud_3                -7.596232e-02 1 1  ON 13
  ud_4                -1.217496e-01 1 1  ON 14
  ud_5                -1.523205e-01 1 1  ON 15
  ud_6                -1.544629e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.464757e-03 1 1  ON 18
  ud_9                 9.258156e-02 1 1  ON 19
  eO_0                -7.504250e-01 1 1  ON 20
  eO_1                -4.354900e-01 1 1  ON 21
  eO_2                -3.598031e-02 1 1  ON 22
  eO_3                 2.081574e-01 1 1  ON 23
  eO_4                 2.891394e-01 1 1  ON 24
  eO_5                 3.052689e-01 1 1  ON 25
  eO_6                 2.501138e-01 1 1  ON 26
  eO_7                 1.121822e-01 1 1  ON 27
  eO_8                 2.793037e-02 1 1  ON 28
  eO_9                 1.846810e-02 1 1  ON 29
 eH1_0                -1.820103e-01 1 1  ON 30
 eH1_1                -1.027121e-01 1 1  ON 31
 eH1_2                -6.202883e-02 1 1  ON 32
 eH1_3                -2.594578e-02 1 1  ON 33
 eH1_4                 1.931540e-02 1 1  ON 34
 eH1_5                 3.552836e-02 1 1  ON 35
 eH1_6                 7.727996e-02 1 1  ON 36
 eH1_7                 1.103063e-01 1 1  ON 37
 eH1_8                 9.073709e-02 1 1  ON 38
 eH1_9                 2.428747e-02 1 1  ON 39
 eH2_0                -1.835293e-01 1 1  ON 40
 eH2_1                -1.038365e-01 1 1  ON 41
 eH2_2                -6.350512e-02 1 1  ON 42
 eH2_3                -2.706149e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.505003e-02 1 1  ON 45
 eH2_6                 7.827828e-02 1 1  ON 46
 eH2_7                 1.134125e-01 1 1  ON 47
 eH2_8                 9.397284e-02 1 1  ON 48
 eH2_9                 2.639247e-02 1 1  ON 49
ci_001                -3.996494e-02 3 1  ON 50
ci_002                -3.016634e-02 3 1  ON 51
ci_003                -2.507314e-02 3 1  ON 52
ci_004                 2.111226e-02 3 1  ON 53
ci_005                 2.113580e-02 3 1  ON 54
ci_006                -1.943432e-02 3 1  ON 55
ci_007                -1.880475e-02 3 1  ON 56
ci_008                -1.774291e-02 3 1  ON 57
ci_009                -1.805791e-02 3 1  ON 58
ci_010                -1.730297e-02 3 1  ON 59
ci_011                -1.626649e-02 3 1  ON 60
ci_012                -1.614756e-02 3 1  ON 61
ci_013                -1.921766e-02 3 1  ON 62
ci_014                 1.385257e-02 3 1  ON 63
ci_015                 1.356376e-02 3 1  ON 64
ci_016                 1.626138e-02 3 1  ON 65
ci_017                 1.653443e-02 3 1  ON 66
ci_018                 1.263140e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328250e-02 3 1  ON 69
ci_021                 1.336535e-02 3 1  ON 70
ci_022                 1.114428e-02 3 1  ON 71
ci_023                 1.122736e-02 3 1  ON 72
ci_024                 1.228091e-02 3 1  ON 73
ci_025                 1.155401e-02 3 1  ON 74
ci_026                 1.090568e-02 3 1  ON 75
ci_027                 1.132691e-02 3 1  ON 76
ci_028                -1.426004e-02 3 1  ON 77
ci_029                -1.490888e-02 3 1  ON 78
ci_030                -1.110573e-02 3 1  ON 79
ci_031                -1.141164e-02 3 1  ON 80
ci_032                -1.349058e-02 3 1  ON 81
ci_033                 1.065686e-02 3 1  ON 82
ci_034                 1.063510e-02 3 1  ON 83
ci_035                -4.703492e-03 3 1  ON 84
ci_036                -1.040488e-02 3 1  ON 85
ci_037                -1.005838e-02 3 1  ON 86
ci_038                 1.873602e-03 3 1  ON 87
ci_039                 1.471056e-03 3 1  ON 88
ci_040                -4.065245e-03 3 1  ON 89
ci_041                 9.805310e-03 3 1  ON 90
ci_042                 9.855238e-03 3 1  ON 91
ci_043                -2.929199e-03 3 1  ON 92
ci_044                -1.514689e-02 3 1  ON 93
ci_045                -1.826158e-03 3 1  ON 94
ci_046                 5.708134e-03 3 1  ON 95
ci_047                 5.452677e-03 3 1  ON 96
ci_048                -1.169136e-02 3 1  ON 97
ci_049                -1.200954e-02 3 1  ON 98
ci_050                 7.414056e-03 3 1  ON 99
ci_051                 7.764911e-03 3 1  ON 100
ci_052                -6.441675e-03 3 1  ON 101
ci_053                -6.307820e-03 3 1  ON 102
ci_054                -3.219563e-03 3 1  ON 103
ci_055                -3.043250e-03 3 1  ON 104
ci_056                 4.494926e-03 3 1  ON 105
ci_057                 4.397122e-03 3 1  ON 106
ci_058                -6.794566e-03 3 1  ON 107
ci_059                -6.376285e-03 3 1  ON 108
ci_060                 8.242122e-03 3 1  ON 109
ci_061                 7.906327e-03 3 1  ON 110
ci_062                -3.257388e-03 3 1  ON 111
ci_063                -2.907790e-03 3 1  ON 112
ci_064                -3.133513e-03 3 1  ON 113
ci_065                -4.351257e-03 3 1  ON 114
ci_066                 5.563868e-03 3 1  ON 115
ci_067                 5.751243e-03 3 1  ON 116
ci_068                -4.597236e-03 3 1  ON 117
ci_069                -4.608608e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.1905
    reference variance = 0.212739
====================================================
  Execution time = 3.7277e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1286e-01
  Total weights = 1.9567e+06
  Execution time = 3.3459e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298412903968
                                         uncertainty =       0.001995014120

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298412903968
                                         uncertainty =       0.001995014120

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386271521
  error estimate for blocks of size 2^( 2) =       0.000396526742
  error estimate for blocks of size 2^( 3) =       0.000405640682
  error estimate for blocks of size 2^( 4) =       0.000413425659
  error estimate for blocks of size 2^( 5) =       0.000416986216
  error estimate for blocks of size 2^( 6) =       0.000419702220
  error estimate for blocks of size 2^( 7) =       0.000418945646

      target function =                  N/A
              le_mean =     -17.216950260481
             les_mean =     296.736236533098
             stat err =       0.000417264935
             autocorr =       1.166912797050
              std dev =       0.546270423174
             le_variance =       0.298411375235

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298413595405
                                         uncertainty =       0.001995070456

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298413595405
                                         uncertainty =       0.001995070456

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386271967
  error estimate for blocks of size 2^( 2) =       0.000396527158
  error estimate for blocks of size 2^( 3) =       0.000405641088
  error estimate for blocks of size 2^( 4) =       0.000413426024
  error estimate for blocks of size 2^( 5) =       0.000416986588
  error estimate for blocks of size 2^( 6) =       0.000419702602
  error estimate for blocks of size 2^( 7) =       0.000418946008

      target function =                  N/A
              le_mean =     -17.216950274556
             les_mean =     296.736241716893
             stat err =       0.000417265306
             autocorr =       1.166912170617
              std dev =       0.546271054447
             le_variance =       0.298412064926

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298413249761
                                         uncertainty =       0.001995042305

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298413249761
                                         uncertainty =       0.001995042305

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386271744
  error estimate for blocks of size 2^( 2) =       0.000396526950
  error estimate for blocks of size 2^( 3) =       0.000405640886
  error estimate for blocks of size 2^( 4) =       0.000413425842
  error estimate for blocks of size 2^( 5) =       0.000416986402
  error estimate for blocks of size 2^( 6) =       0.000419702411
  error estimate for blocks of size 2^( 7) =       0.000418945827

      target function =                  N/A
              le_mean =     -17.216950267514
             les_mean =     296.736239106708
             stat err =       0.000417265120
             autocorr =       1.166912483694
              std dev =       0.546270738878
             le_variance =       0.298411720154

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298412947183
                                         uncertainty =       0.001995017644

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298412947183
                                         uncertainty =       0.001995017644

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386271548
  error estimate for blocks of size 2^( 2) =       0.000396526768
  error estimate for blocks of size 2^( 3) =       0.000405640708
  error estimate for blocks of size 2^( 4) =       0.000413425682
  error estimate for blocks of size 2^( 5) =       0.000416986240
  error estimate for blocks of size 2^( 6) =       0.000419702244
  error estimate for blocks of size 2^( 7) =       0.000418945668

      target function =                  N/A
              le_mean =     -17.216950261358
             les_mean =     296.736236852591
             stat err =       0.000417264958
             autocorr =       1.166912757879
              std dev =       0.546270462628
             le_variance =       0.298411418340


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216950260481        initial
     2.4414e+02     2.4414e+03             2.9209e-06       -17.216950274556  <--
     9.7656e+02     9.7656e+03             7.3031e-07       -17.216950267514
     3.9062e+03     3.9062e+04             1.8258e-07       -17.216950261358

*****************************************************************************
Applying the update for shift_i =   2.4414e+02     and shift_s =   2.4414e+03
*****************************************************************************

  Execution time = 5.4197e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
  uu_0                 2.061936e-01 1 1  ON 0
  uu_1                 4.539068e-02 1 1  ON 1
  uu_2                -4.680564e-02 1 1  ON 2
  uu_3                -9.936295e-02 1 1  ON 3
  uu_4                -1.304441e-01 1 1  ON 4
  uu_5                -1.356404e-01 1 1  ON 5
  uu_6                -1.130352e-01 1 1  ON 6
  uu_7                -3.972205e-02 1 1  ON 7
  uu_8                 9.988765e-02 1 1  ON 8
  uu_9                 1.208926e-01 1 1  ON 9
  ud_0                 3.495769e-01 1 1  ON 10
  ud_1                 9.178444e-02 1 1  ON 11
  ud_2                -1.648723e-02 1 1  ON 12
  ud_3                -7.596235e-02 1 1  ON 13
  ud_4                -1.217503e-01 1 1  ON 14
  ud_5                -1.523209e-01 1 1  ON 15
  ud_6                -1.544626e-01 1 1  ON 16
  ud_7                -1.100032e-01 1 1  ON 17
  ud_8                 4.464441e-03 1 1  ON 18
  ud_9                 9.258156e-02 1 1  ON 19
  eO_0                -7.504271e-01 1 1  ON 20
  eO_1                -4.354917e-01 1 1  ON 21
  eO_2                -3.598103e-02 1 1  ON 22
  eO_3                 2.081583e-01 1 1  ON 23
  eO_4                 2.891416e-01 1 1  ON 24
  eO_5                 3.052694e-01 1 1  ON 25
  eO_6                 2.501141e-01 1 1  ON 26
  eO_7                 1.121826e-01 1 1  ON 27
  eO_8                 2.793044e-02 1 1  ON 28
  eO_9                 1.846812e-02 1 1  ON 29
 eH1_0                -1.820106e-01 1 1  ON 30
 eH1_1                -1.027121e-01 1 1  ON 31
 eH1_2                -6.202908e-02 1 1  ON 32
 eH1_3                -2.594633e-02 1 1  ON 33
 eH1_4                 1.931537e-02 1 1  ON 34
 eH1_5                 3.552872e-02 1 1  ON 35
 eH1_6                 7.728030e-02 1 1  ON 36
 eH1_7                 1.103063e-01 1 1  ON 37
 eH1_8                 9.073732e-02 1 1  ON 38
 eH1_9                 2.428755e-02 1 1  ON 39
 eH2_0                -1.835291e-01 1 1  ON 40
 eH2_1                -1.038368e-01 1 1  ON 41
 eH2_2                -6.350502e-02 1 1  ON 42
 eH2_3                -2.706147e-02 1 1  ON 43
 eH2_4                 1.856787e-02 1 1  ON 44
 eH2_5                 3.505004e-02 1 1  ON 45
 eH2_6                 7.827826e-02 1 1  ON 46
 eH2_7                 1.134123e-01 1 1  ON 47
 eH2_8                 9.397305e-02 1 1  ON 48
 eH2_9                 2.639256e-02 1 1  ON 49
ci_001                -3.996528e-02 3 1  ON 50
ci_002                -3.016603e-02 3 1  ON 51
ci_003                -2.507234e-02 3 1  ON 52
ci_004                 2.111172e-02 3 1  ON 53
ci_005                 2.113558e-02 3 1  ON 54
ci_006                -1.943442e-02 3 1  ON 55
ci_007                -1.880492e-02 3 1  ON 56
ci_008                -1.774297e-02 3 1  ON 57
ci_009                -1.805702e-02 3 1  ON 58
ci_010                -1.730281e-02 3 1  ON 59
ci_011                -1.626652e-02 3 1  ON 60
ci_012                -1.614846e-02 3 1  ON 61
ci_013                -1.921690e-02 3 1  ON 62
ci_014                 1.385278e-02 3 1  ON 63
ci_015                 1.356431e-02 3 1  ON 64
ci_016                 1.626185e-02 3 1  ON 65
ci_017                 1.653466e-02 3 1  ON 66
ci_018                 1.263124e-02 3 1  ON 67
ci_019                 1.309178e-02 3 1  ON 68
ci_020                 1.328253e-02 3 1  ON 69
ci_021                 1.336537e-02 3 1  ON 70
ci_022                 1.114399e-02 3 1  ON 71
ci_023                 1.122672e-02 3 1  ON 72
ci_024                 1.228147e-02 3 1  ON 73
ci_025                 1.155325e-02 3 1  ON 74
ci_026                 1.090611e-02 3 1  ON 75
ci_027                 1.132638e-02 3 1  ON 76
ci_028                -1.426018e-02 3 1  ON 77
ci_029                -1.490872e-02 3 1  ON 78
ci_030                -1.110621e-02 3 1  ON 79
ci_031                -1.141197e-02 3 1  ON 80
ci_032                -1.349034e-02 3 1  ON 81
ci_033                 1.065652e-02 3 1  ON 82
ci_034                 1.063503e-02 3 1  ON 83
ci_035                -4.703291e-03 3 1  ON 84
ci_036                -1.040456e-02 3 1  ON 85
ci_037                -1.005798e-02 3 1  ON 86
ci_038                 1.873469e-03 3 1  ON 87
ci_039                 1.471208e-03 3 1  ON 88
ci_040                -4.064837e-03 3 1  ON 89
ci_041                 9.805198e-03 3 1  ON 90
ci_042                 9.855082e-03 3 1  ON 91
ci_043                -2.929633e-03 3 1  ON 92
ci_044                -1.514702e-02 3 1  ON 93
ci_045                -1.825345e-03 3 1  ON 94
ci_046                 5.707956e-03 3 1  ON 95
ci_047                 5.452414e-03 3 1  ON 96
ci_048                -1.169200e-02 3 1  ON 97
ci_049                -1.200942e-02 3 1  ON 98
ci_050                 7.413410e-03 3 1  ON 99
ci_051                 7.764555e-03 3 1  ON 100
ci_052                -6.441304e-03 3 1  ON 101
ci_053                -6.307644e-03 3 1  ON 102
ci_054                -3.218333e-03 3 1  ON 103
ci_055                -3.043131e-03 3 1  ON 104
ci_056                 4.495301e-03 3 1  ON 105
ci_057                 4.397555e-03 3 1  ON 106
ci_058                -6.795211e-03 3 1  ON 107
ci_059                -6.376998e-03 3 1  ON 108
ci_060                 8.242682e-03 3 1  ON 109
ci_061                 7.907122e-03 3 1  ON 110
ci_062                -3.257068e-03 3 1  ON 111
ci_063                -2.907979e-03 3 1  ON 112
ci_064                -3.133385e-03 3 1  ON 113
ci_065                -4.351004e-03 3 1  ON 114
ci_066                 5.564467e-03 3 1  ON 115
ci_067                 5.751028e-03 3 1  ON 116
ci_068                -4.596932e-03 3 1  ON 117
ci_069                -4.608931e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0298e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.2906
    reference variance = 0.107983
====================================================
  Execution time = 3.7714e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5287e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1069e-01
  Total weights = 1.956838290e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1004e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298973372463
                                         uncertainty =       0.003126633331

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298973372463
                                         uncertainty =       0.003126633331

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386616383
  error estimate for blocks of size 2^( 2) =       0.000396679761
  error estimate for blocks of size 2^( 3) =       0.000405878968
  error estimate for blocks of size 2^( 4) =       0.000413022786
  error estimate for blocks of size 2^( 5) =       0.000416482337
  error estimate for blocks of size 2^( 6) =       0.000420085638
  error estimate for blocks of size 2^( 7) =       0.000420982472

      target function =                  N/A
              le_mean =     -17.216972384257
             les_mean =     296.734827230266
             stat err =       0.000417643309
             autocorr =       1.166945428690
              std dev =       0.546758132950
             le_variance =       0.298944455947


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721697238426e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216972384316       residual = 8.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216972465540       residual = 2.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216972449793       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216972482147       residual = 4.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216972521018       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216972511902       residual = 3.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216972505012       residual = 6.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216972504310       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216972504168       residual = 8.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.1035e+01 is 1.317476e-05

solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216972384316       residual = 8.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216972404683       residual = 2.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216972400741       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216972408840       residual = 4.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216972418605       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216972416338       residual = 3.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216972414605       residual = 6.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216972414430       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216972414396       residual = 8.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.4414e+02 is 3.296807e-06

solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216972384316       residual = 8.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216972389412       residual = 2.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216972388425       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216972390451       residual = 4.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216972392895       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216972392329       residual = 3.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216972391895       residual = 6.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216972391851       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216972391844       residual = 8.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.7656e+02 is 8.243972e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.188306 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8730e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
  uu_0                 2.061944e-01 1 1  ON 0
  uu_1                 4.539159e-02 1 1  ON 1
  uu_2                -4.680549e-02 1 1  ON 2
  uu_3                -9.936254e-02 1 1  ON 3
  uu_4                -1.304447e-01 1 1  ON 4
  uu_5                -1.356411e-01 1 1  ON 5
  uu_6                -1.130354e-01 1 1  ON 6
  uu_7                -3.972284e-02 1 1  ON 7
  uu_8                 9.988717e-02 1 1  ON 8
  uu_9                 1.208928e-01 1 1  ON 9
  ud_0                 3.495776e-01 1 1  ON 10
  ud_1                 9.178529e-02 1 1  ON 11
  ud_2                -1.648746e-02 1 1  ON 12
  ud_3                -7.596228e-02 1 1  ON 13
  ud_4                -1.217505e-01 1 1  ON 14
  ud_5                -1.523212e-01 1 1  ON 15
  ud_6                -1.544627e-01 1 1  ON 16
  ud_7                -1.100036e-01 1 1  ON 17
  ud_8                 4.463759e-03 1 1  ON 18
  ud_9                 9.258149e-02 1 1  ON 19
  eO_0                -7.504304e-01 1 1  ON 20
  eO_1                -4.354936e-01 1 1  ON 21
  eO_2                -3.598134e-02 1 1  ON 22
  eO_3                 2.081598e-01 1 1  ON 23
  eO_4                 2.891444e-01 1 1  ON 24
  eO_5                 3.052698e-01 1 1  ON 25
  eO_6                 2.501143e-01 1 1  ON 26
  eO_7                 1.121830e-01 1 1  ON 27
  eO_8                 2.793049e-02 1 1  ON 28
  eO_9                 1.846814e-02 1 1  ON 29
 eH1_0                -1.820109e-01 1 1  ON 30
 eH1_1                -1.027122e-01 1 1  ON 31
 eH1_2                -6.202920e-02 1 1  ON 32
 eH1_3                -2.594601e-02 1 1  ON 33
 eH1_4                 1.931534e-02 1 1  ON 34
 eH1_5                 3.552869e-02 1 1  ON 35
 eH1_6                 7.728043e-02 1 1  ON 36
 eH1_7                 1.103062e-01 1 1  ON 37
 eH1_8                 9.073752e-02 1 1  ON 38
 eH1_9                 2.428764e-02 1 1  ON 39
 eH2_0                -1.835294e-01 1 1  ON 40
 eH2_1                -1.038368e-01 1 1  ON 41
 eH2_2                -6.350515e-02 1 1  ON 42
 eH2_3                -2.706126e-02 1 1  ON 43
 eH2_4                 1.856759e-02 1 1  ON 44
 eH2_5                 3.505046e-02 1 1  ON 45
 eH2_6                 7.827829e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397327e-02 1 1  ON 48
 eH2_9                 2.639263e-02 1 1  ON 49
ci_001                -3.996453e-02 3 1  ON 50
ci_002                -3.016565e-02 3 1  ON 51
ci_003                -2.507193e-02 3 1  ON 52
ci_004                 2.111171e-02 3 1  ON 53
ci_005                 2.113590e-02 3 1  ON 54
ci_006                -1.943419e-02 3 1  ON 55
ci_007                -1.880524e-02 3 1  ON 56
ci_008                -1.774308e-02 3 1  ON 57
ci_009                -1.805669e-02 3 1  ON 58
ci_010                -1.730330e-02 3 1  ON 59
ci_011                -1.626650e-02 3 1  ON 60
ci_012                -1.614884e-02 3 1  ON 61
ci_013                -1.921737e-02 3 1  ON 62
ci_014                 1.385343e-02 3 1  ON 63
ci_015                 1.356457e-02 3 1  ON 64
ci_016                 1.626152e-02 3 1  ON 65
ci_017                 1.653446e-02 3 1  ON 66
ci_018                 1.263109e-02 3 1  ON 67
ci_019                 1.309150e-02 3 1  ON 68
ci_020                 1.328237e-02 3 1  ON 69
ci_021                 1.336581e-02 3 1  ON 70
ci_022                 1.114341e-02 3 1  ON 71
ci_023                 1.122641e-02 3 1  ON 72
ci_024                 1.228176e-02 3 1  ON 73
ci_025                 1.155300e-02 3 1  ON 74
ci_026                 1.090652e-02 3 1  ON 75
ci_027                 1.132611e-02 3 1  ON 76
ci_028                -1.426052e-02 3 1  ON 77
ci_029                -1.490752e-02 3 1  ON 78
ci_030                -1.110697e-02 3 1  ON 79
ci_031                -1.141271e-02 3 1  ON 80
ci_032                -1.349003e-02 3 1  ON 81
ci_033                 1.065735e-02 3 1  ON 82
ci_034                 1.063486e-02 3 1  ON 83
ci_035                -4.703045e-03 3 1  ON 84
ci_036                -1.040469e-02 3 1  ON 85
ci_037                -1.005812e-02 3 1  ON 86
ci_038                 1.873476e-03 3 1  ON 87
ci_039                 1.471586e-03 3 1  ON 88
ci_040                -4.065398e-03 3 1  ON 89
ci_041                 9.805337e-03 3 1  ON 90
ci_042                 9.854776e-03 3 1  ON 91
ci_043                -2.929642e-03 3 1  ON 92
ci_044                -1.514685e-02 3 1  ON 93
ci_045                -1.825057e-03 3 1  ON 94
ci_046                 5.707787e-03 3 1  ON 95
ci_047                 5.452053e-03 3 1  ON 96
ci_048                -1.169203e-02 3 1  ON 97
ci_049                -1.200916e-02 3 1  ON 98
ci_050                 7.413062e-03 3 1  ON 99
ci_051                 7.764683e-03 3 1  ON 100
ci_052                -6.441389e-03 3 1  ON 101
ci_053                -6.308127e-03 3 1  ON 102
ci_054                -3.217576e-03 3 1  ON 103
ci_055                -3.042924e-03 3 1  ON 104
ci_056                 4.495323e-03 3 1  ON 105
ci_057                 4.397043e-03 3 1  ON 106
ci_058                -6.795979e-03 3 1  ON 107
ci_059                -6.377445e-03 3 1  ON 108
ci_060                 8.243051e-03 3 1  ON 109
ci_061                 7.907364e-03 3 1  ON 110
ci_062                -3.257391e-03 3 1  ON 111
ci_063                -2.908486e-03 3 1  ON 112
ci_064                -3.133550e-03 3 1  ON 113
ci_065                -4.350283e-03 3 1  ON 114
ci_066                 5.563355e-03 3 1  ON 115
ci_067                 5.750494e-03 3 1  ON 116
ci_068                -4.597233e-03 3 1  ON 117
ci_069                -4.609407e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.1483
    reference variance = 0.294953
====================================================
  Execution time = 3.7481e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1567e-01
  Total weights = 1.9562e+06
  Execution time = 3.3423e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300136332285
                                         uncertainty =       0.002297214008

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300136332285
                                         uncertainty =       0.002297214008

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387361470
  error estimate for blocks of size 2^( 2) =       0.000397671839
  error estimate for blocks of size 2^( 3) =       0.000406939623
  error estimate for blocks of size 2^( 4) =       0.000413638683
  error estimate for blocks of size 2^( 5) =       0.000417671850
  error estimate for blocks of size 2^( 6) =       0.000417755354
  error estimate for blocks of size 2^( 7) =       0.000419672966

      target function =                  N/A
              le_mean =     -17.217025536208
             les_mean =     296.741632711740
             stat err =       0.000417184713
             autocorr =       1.159909040101
              std dev =       0.547811843825
             le_variance =       0.300097816235

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300140986731
                                         uncertainty =       0.002297221028

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300140986731
                                         uncertainty =       0.002297221028

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387364470
  error estimate for blocks of size 2^( 2) =       0.000397674667
  error estimate for blocks of size 2^( 3) =       0.000406942286
  error estimate for blocks of size 2^( 4) =       0.000413641267
  error estimate for blocks of size 2^( 5) =       0.000417674238
  error estimate for blocks of size 2^( 6) =       0.000417757642
  error estimate for blocks of size 2^( 7) =       0.000419674776

      target function =                  N/A
              le_mean =     -17.217025525727
             les_mean =     296.741654308102
             stat err =       0.000417186981
             autocorr =       1.159903677959
              std dev =       0.547816087675
             le_variance =       0.300102465915

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300138663030
                                         uncertainty =       0.002297217570

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300138663030
                                         uncertainty =       0.002297217570

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387362972
  error estimate for blocks of size 2^( 2) =       0.000397673255
  error estimate for blocks of size 2^( 3) =       0.000406940956
  error estimate for blocks of size 2^( 4) =       0.000413639977
  error estimate for blocks of size 2^( 5) =       0.000417673046
  error estimate for blocks of size 2^( 6) =       0.000417756499
  error estimate for blocks of size 2^( 7) =       0.000419673871

      target function =                  N/A
              le_mean =     -17.217025530725
             les_mean =     296.741642881956
             stat err =       0.000417185848
             autocorr =       1.159906352390
              std dev =       0.547813968959
             le_variance =       0.300100144586

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300136623628
                                         uncertainty =       0.002297214452

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300136623628
                                         uncertainty =       0.002297214452

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387361657
  error estimate for blocks of size 2^( 2) =       0.000397672016
  error estimate for blocks of size 2^( 3) =       0.000406939790
  error estimate for blocks of size 2^( 4) =       0.000413638845
  error estimate for blocks of size 2^( 5) =       0.000417672000
  error estimate for blocks of size 2^( 6) =       0.000417755497
  error estimate for blocks of size 2^( 7) =       0.000419673079

      target function =                  N/A
              le_mean =     -17.217025535501
             les_mean =     296.741633924841
             stat err =       0.000417184855
             autocorr =       1.159908703906
              std dev =       0.547812109467
             le_variance =       0.300098107279


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217025536208        initial  <--
     6.1035e+01     6.1035e+02             1.3175e-05       -17.217025525727
     2.4414e+02     2.4414e+03             3.2968e-06       -17.217025530725
     9.7656e+02     9.7656e+03             8.2440e-07       -17.217025535501

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 54.3966
  </log>
  <optVariables href="H2O.s012.opt.xml">
  uu_0                 2.061936e-01 1 1  ON 0
  uu_1                 4.539068e-02 1 1  ON 1
  uu_2                -4.680564e-02 1 1  ON 2
  uu_3                -9.936295e-02 1 1  ON 3
  uu_4                -1.304441e-01 1 1  ON 4
  uu_5                -1.356404e-01 1 1  ON 5
  uu_6                -1.130352e-01 1 1  ON 6
  uu_7                -3.972205e-02 1 1  ON 7
  uu_8                 9.988765e-02 1 1  ON 8
  uu_9                 1.208926e-01 1 1  ON 9
  ud_0                 3.495769e-01 1 1  ON 10
  ud_1                 9.178444e-02 1 1  ON 11
  ud_2                -1.648723e-02 1 1  ON 12
  ud_3                -7.596235e-02 1 1  ON 13
  ud_4                -1.217503e-01 1 1  ON 14
  ud_5                -1.523209e-01 1 1  ON 15
  ud_6                -1.544626e-01 1 1  ON 16
  ud_7                -1.100032e-01 1 1  ON 17
  ud_8                 4.464441e-03 1 1  ON 18
  ud_9                 9.258156e-02 1 1  ON 19
  eO_0                -7.504271e-01 1 1  ON 20
  eO_1                -4.354917e-01 1 1  ON 21
  eO_2                -3.598103e-02 1 1  ON 22
  eO_3                 2.081583e-01 1 1  ON 23
  eO_4                 2.891416e-01 1 1  ON 24
  eO_5                 3.052694e-01 1 1  ON 25
  eO_6                 2.501141e-01 1 1  ON 26
  eO_7                 1.121826e-01 1 1  ON 27
  eO_8                 2.793044e-02 1 1  ON 28
  eO_9                 1.846812e-02 1 1  ON 29
 eH1_0                -1.820106e-01 1 1  ON 30
 eH1_1                -1.027121e-01 1 1  ON 31
 eH1_2                -6.202908e-02 1 1  ON 32
 eH1_3                -2.594633e-02 1 1  ON 33
 eH1_4                 1.931537e-02 1 1  ON 34
 eH1_5                 3.552872e-02 1 1  ON 35
 eH1_6                 7.728030e-02 1 1  ON 36
 eH1_7                 1.103063e-01 1 1  ON 37
 eH1_8                 9.073732e-02 1 1  ON 38
 eH1_9                 2.428755e-02 1 1  ON 39
 eH2_0                -1.835291e-01 1 1  ON 40
 eH2_1                -1.038368e-01 1 1  ON 41
 eH2_2                -6.350502e-02 1 1  ON 42
 eH2_3                -2.706147e-02 1 1  ON 43
 eH2_4                 1.856787e-02 1 1  ON 44
 eH2_5                 3.505004e-02 1 1  ON 45
 eH2_6                 7.827826e-02 1 1  ON 46
 eH2_7                 1.134123e-01 1 1  ON 47
 eH2_8                 9.397305e-02 1 1  ON 48
 eH2_9                 2.639256e-02 1 1  ON 49
ci_001                -3.996528e-02 3 1  ON 50
ci_002                -3.016603e-02 3 1  ON 51
ci_003                -2.507234e-02 3 1  ON 52
ci_004                 2.111172e-02 3 1  ON 53
ci_005                 2.113558e-02 3 1  ON 54
ci_006                -1.943442e-02 3 1  ON 55
ci_007                -1.880492e-02 3 1  ON 56
ci_008                -1.774297e-02 3 1  ON 57
ci_009                -1.805702e-02 3 1  ON 58
ci_010                -1.730281e-02 3 1  ON 59
ci_011                -1.626652e-02 3 1  ON 60
ci_012                -1.614846e-02 3 1  ON 61
ci_013                -1.921690e-02 3 1  ON 62
ci_014                 1.385278e-02 3 1  ON 63
ci_015                 1.356431e-02 3 1  ON 64
ci_016                 1.626185e-02 3 1  ON 65
ci_017                 1.653466e-02 3 1  ON 66
ci_018                 1.263124e-02 3 1  ON 67
ci_019                 1.309178e-02 3 1  ON 68
ci_020                 1.328253e-02 3 1  ON 69
ci_021                 1.336537e-02 3 1  ON 70
ci_022                 1.114399e-02 3 1  ON 71
ci_023                 1.122672e-02 3 1  ON 72
ci_024                 1.228147e-02 3 1  ON 73
ci_025                 1.155325e-02 3 1  ON 74
ci_026                 1.090611e-02 3 1  ON 75
ci_027                 1.132638e-02 3 1  ON 76
ci_028                -1.426018e-02 3 1  ON 77
ci_029                -1.490872e-02 3 1  ON 78
ci_030                -1.110621e-02 3 1  ON 79
ci_031                -1.141197e-02 3 1  ON 80
ci_032                -1.349034e-02 3 1  ON 81
ci_033                 1.065652e-02 3 1  ON 82
ci_034                 1.063503e-02 3 1  ON 83
ci_035                -4.703291e-03 3 1  ON 84
ci_036                -1.040456e-02 3 1  ON 85
ci_037                -1.005798e-02 3 1  ON 86
ci_038                 1.873469e-03 3 1  ON 87
ci_039                 1.471208e-03 3 1  ON 88
ci_040                -4.064837e-03 3 1  ON 89
ci_041                 9.805198e-03 3 1  ON 90
ci_042                 9.855082e-03 3 1  ON 91
ci_043                -2.929633e-03 3 1  ON 92
ci_044                -1.514702e-02 3 1  ON 93
ci_045                -1.825345e-03 3 1  ON 94
ci_046                 5.707956e-03 3 1  ON 95
ci_047                 5.452414e-03 3 1  ON 96
ci_048                -1.169200e-02 3 1  ON 97
ci_049                -1.200942e-02 3 1  ON 98
ci_050                 7.413410e-03 3 1  ON 99
ci_051                 7.764555e-03 3 1  ON 100
ci_052                -6.441304e-03 3 1  ON 101
ci_053                -6.307644e-03 3 1  ON 102
ci_054                -3.218333e-03 3 1  ON 103
ci_055                -3.043131e-03 3 1  ON 104
ci_056                 4.495301e-03 3 1  ON 105
ci_057                 4.397555e-03 3 1  ON 106
ci_058                -6.795211e-03 3 1  ON 107
ci_059                -6.376998e-03 3 1  ON 108
ci_060                 8.242682e-03 3 1  ON 109
ci_061                 7.907122e-03 3 1  ON 110
ci_062                -3.257068e-03 3 1  ON 111
ci_063                -2.907979e-03 3 1  ON 112
ci_064                -3.133385e-03 3 1  ON 113
ci_065                -4.351004e-03 3 1  ON 114
ci_066                 5.564467e-03 3 1  ON 115
ci_067                 5.751028e-03 3 1  ON 116
ci_068                -4.596932e-03 3 1  ON 117
ci_069                -4.608931e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0313e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7215e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.2404
    reference variance = 0.224244
====================================================
  Execution time = 3.8247e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5292e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.3700e-01
  Total weights = 1.956816318e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1167e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298427819642
                                         uncertainty =       0.003384186750

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298427819642
                                         uncertainty =       0.003384186750

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386275224
  error estimate for blocks of size 2^( 2) =       0.000395947881
  error estimate for blocks of size 2^( 3) =       0.000405096323
  error estimate for blocks of size 2^( 4) =       0.000411995420
  error estimate for blocks of size 2^( 5) =       0.000415512553
  error estimate for blocks of size 2^( 6) =       0.000416742197
  error estimate for blocks of size 2^( 7) =       0.000419567692

      target function =                  N/A
              le_mean =     -17.216520678587
             les_mean =     296.745581169175
             stat err =       0.000415954465
             autocorr =       1.159572414072
              std dev =       0.546275661045
             le_variance =       0.298417097850


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721652067859e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216520678675       residual = 8.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216520708248       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216520709412       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216520711329       residual = 6.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216520713511       residual = 3.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216520716960       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216520716395       residual = 7.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216520716293       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216520716375       residual = 5.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216520715869       residual = 8.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.1035e+02 is 2.105111e-06

solving harmonic davidson linear method for identity shift 2.4414e+03, overlap shift 2.4414e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216520678675       residual = 8.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216520686071       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216520686362       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216520686841       residual = 6.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216520687386       residual = 3.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216520688249       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216520688107       residual = 7.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216520688085       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216520688105       residual = 5.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216520687975       residual = 8.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.4414e+03 is 5.264029e-07

solving harmonic davidson linear method for identity shift 9.7656e+03, overlap shift 9.7656e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216520678675       residual = 8.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216520680524       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216520680597       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216520680726       residual = 6.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216520680851       residual = 3.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216520681081       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216520681032       residual = 7.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216520681039       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216520681054       residual = 5.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216520680997       residual = 8.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.7656e+03 is 1.316085e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.192268 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.9427e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
  uu_0                 2.061936e-01 1 1  ON 0
  uu_1                 4.539071e-02 1 1  ON 1
  uu_2                -4.680559e-02 1 1  ON 2
  uu_3                -9.936291e-02 1 1  ON 3
  uu_4                -1.304441e-01 1 1  ON 4
  uu_5                -1.356404e-01 1 1  ON 5
  uu_6                -1.130352e-01 1 1  ON 6
  uu_7                -3.972211e-02 1 1  ON 7
  uu_8                 9.988761e-02 1 1  ON 8
  uu_9                 1.208927e-01 1 1  ON 9
  ud_0                 3.495770e-01 1 1  ON 10
  ud_1                 9.178459e-02 1 1  ON 11
  ud_2                -1.648729e-02 1 1  ON 12
  ud_3                -7.596245e-02 1 1  ON 13
  ud_4                -1.217504e-01 1 1  ON 14
  ud_5                -1.523209e-01 1 1  ON 15
  ud_6                -1.544626e-01 1 1  ON 16
  ud_7                -1.100033e-01 1 1  ON 17
  ud_8                 4.464400e-03 1 1  ON 18
  ud_9                 9.258157e-02 1 1  ON 19
  eO_0                -7.504274e-01 1 1  ON 20
  eO_1                -4.354919e-01 1 1  ON 21
  eO_2                -3.598108e-02 1 1  ON 22
  eO_3                 2.081585e-01 1 1  ON 23
  eO_4                 2.891418e-01 1 1  ON 24
  eO_5                 3.052694e-01 1 1  ON 25
  eO_6                 2.501141e-01 1 1  ON 26
  eO_7                 1.121827e-01 1 1  ON 27
  eO_8                 2.793045e-02 1 1  ON 28
  eO_9                 1.846812e-02 1 1  ON 29
 eH1_0                -1.820106e-01 1 1  ON 30
 eH1_1                -1.027121e-01 1 1  ON 31
 eH1_2                -6.202909e-02 1 1  ON 32
 eH1_3                -2.594629e-02 1 1  ON 33
 eH1_4                 1.931539e-02 1 1  ON 34
 eH1_5                 3.552872e-02 1 1  ON 35
 eH1_6                 7.728032e-02 1 1  ON 36
 eH1_7                 1.103063e-01 1 1  ON 37
 eH1_8                 9.073735e-02 1 1  ON 38
 eH1_9                 2.428756e-02 1 1  ON 39
 eH2_0                -1.835292e-01 1 1  ON 40
 eH2_1                -1.038368e-01 1 1  ON 41
 eH2_2                -6.350505e-02 1 1  ON 42
 eH2_3                -2.706145e-02 1 1  ON 43
 eH2_4                 1.856794e-02 1 1  ON 44
 eH2_5                 3.505005e-02 1 1  ON 45
 eH2_6                 7.827826e-02 1 1  ON 46
 eH2_7                 1.134123e-01 1 1  ON 47
 eH2_8                 9.397308e-02 1 1  ON 48
 eH2_9                 2.639256e-02 1 1  ON 49
ci_001                -3.996500e-02 3 1  ON 50
ci_002                -3.016595e-02 3 1  ON 51
ci_003                -2.507241e-02 3 1  ON 52
ci_004                 2.111176e-02 3 1  ON 53
ci_005                 2.113533e-02 3 1  ON 54
ci_006                -1.943419e-02 3 1  ON 55
ci_007                -1.880486e-02 3 1  ON 56
ci_008                -1.774304e-02 3 1  ON 57
ci_009                -1.805715e-02 3 1  ON 58
ci_010                -1.730282e-02 3 1  ON 59
ci_011                -1.626675e-02 3 1  ON 60
ci_012                -1.614840e-02 3 1  ON 61
ci_013                -1.921692e-02 3 1  ON 62
ci_014                 1.385306e-02 3 1  ON 63
ci_015                 1.356415e-02 3 1  ON 64
ci_016                 1.626238e-02 3 1  ON 65
ci_017                 1.653458e-02 3 1  ON 66
ci_018                 1.263122e-02 3 1  ON 67
ci_019                 1.309174e-02 3 1  ON 68
ci_020                 1.328246e-02 3 1  ON 69
ci_021                 1.336536e-02 3 1  ON 70
ci_022                 1.114427e-02 3 1  ON 71
ci_023                 1.122674e-02 3 1  ON 72
ci_024                 1.228145e-02 3 1  ON 73
ci_025                 1.155319e-02 3 1  ON 74
ci_026                 1.090623e-02 3 1  ON 75
ci_027                 1.132604e-02 3 1  ON 76
ci_028                -1.426022e-02 3 1  ON 77
ci_029                -1.490867e-02 3 1  ON 78
ci_030                -1.110623e-02 3 1  ON 79
ci_031                -1.141206e-02 3 1  ON 80
ci_032                -1.349041e-02 3 1  ON 81
ci_033                 1.065646e-02 3 1  ON 82
ci_034                 1.063502e-02 3 1  ON 83
ci_035                -4.703189e-03 3 1  ON 84
ci_036                -1.040463e-02 3 1  ON 85
ci_037                -1.005803e-02 3 1  ON 86
ci_038                 1.873489e-03 3 1  ON 87
ci_039                 1.471227e-03 3 1  ON 88
ci_040                -4.064798e-03 3 1  ON 89
ci_041                 9.805166e-03 3 1  ON 90
ci_042                 9.855101e-03 3 1  ON 91
ci_043                -2.929531e-03 3 1  ON 92
ci_044                -1.514701e-02 3 1  ON 93
ci_045                -1.825387e-03 3 1  ON 94
ci_046                 5.707972e-03 3 1  ON 95
ci_047                 5.452418e-03 3 1  ON 96
ci_048                -1.169195e-02 3 1  ON 97
ci_049                -1.200937e-02 3 1  ON 98
ci_050                 7.413180e-03 3 1  ON 99
ci_051                 7.764513e-03 3 1  ON 100
ci_052                -6.441292e-03 3 1  ON 101
ci_053                -6.307463e-03 3 1  ON 102
ci_054                -3.218107e-03 3 1  ON 103
ci_055                -3.043098e-03 3 1  ON 104
ci_056                 4.495342e-03 3 1  ON 105
ci_057                 4.397585e-03 3 1  ON 106
ci_058                -6.795083e-03 3 1  ON 107
ci_059                -6.376746e-03 3 1  ON 108
ci_060                 8.242615e-03 3 1  ON 109
ci_061                 7.907238e-03 3 1  ON 110
ci_062                -3.256992e-03 3 1  ON 111
ci_063                -2.907992e-03 3 1  ON 112
ci_064                -3.133244e-03 3 1  ON 113
ci_065                -4.350959e-03 3 1  ON 114
ci_066                 5.564500e-03 3 1  ON 115
ci_067                 5.750984e-03 3 1  ON 116
ci_068                -4.596956e-03 3 1  ON 117
ci_069                -4.608598e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.2134
    reference variance = 0.324858
====================================================
  Execution time = 3.7309e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1338e-01
  Total weights = 1.9565e+06
  Execution time = 3.3539e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299837155880
                                         uncertainty =       0.002140938482

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299837155880
                                         uncertainty =       0.002140938482

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387157149
  error estimate for blocks of size 2^( 2) =       0.000397317029
  error estimate for blocks of size 2^( 3) =       0.000406118750
  error estimate for blocks of size 2^( 4) =       0.000413234402
  error estimate for blocks of size 2^( 5) =       0.000417744246
  error estimate for blocks of size 2^( 6) =       0.000420302036
  error estimate for blocks of size 2^( 7) =       0.000421363923

      target function =                  N/A
              le_mean =     -17.217204615230
             les_mean =     296.745511785584
             stat err =       0.000418161152
             autocorr =       1.166575361325
              std dev =       0.547522891323
             le_variance =       0.299781316523

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299836719321
                                         uncertainty =       0.002140878748

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299836719321
                                         uncertainty =       0.002140878748

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387156869
  error estimate for blocks of size 2^( 2) =       0.000397316739
  error estimate for blocks of size 2^( 3) =       0.000406118466
  error estimate for blocks of size 2^( 4) =       0.000413234117
  error estimate for blocks of size 2^( 5) =       0.000417743961
  error estimate for blocks of size 2^( 6) =       0.000420301772
  error estimate for blocks of size 2^( 7) =       0.000421363684

      target function =                  N/A
              le_mean =     -17.217204639468
             les_mean =     296.745514811589
             stat err =       0.000418160883
             autocorr =       1.166575556551
              std dev =       0.547522494286
             le_variance =       0.299780881749

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299836937301
                                         uncertainty =       0.002140908600

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299836937301
                                         uncertainty =       0.002140908600

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387157009
  error estimate for blocks of size 2^( 2) =       0.000397316884
  error estimate for blocks of size 2^( 3) =       0.000406118608
  error estimate for blocks of size 2^( 4) =       0.000413234259
  error estimate for blocks of size 2^( 5) =       0.000417744103
  error estimate for blocks of size 2^( 6) =       0.000420301904
  error estimate for blocks of size 2^( 7) =       0.000421363803

      target function =                  N/A
              le_mean =     -17.217204627337
             les_mean =     296.745513287531
             stat err =       0.000418161017
             autocorr =       1.166575459066
              std dev =       0.547522692532
             le_variance =       0.299781098837

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299837128539
                                         uncertainty =       0.002140934745

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299837128539
                                         uncertainty =       0.002140934745

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387157132
  error estimate for blocks of size 2^( 2) =       0.000397317011
  error estimate for blocks of size 2^( 3) =       0.000406118732
  error estimate for blocks of size 2^( 4) =       0.000413234384
  error estimate for blocks of size 2^( 5) =       0.000417744228
  error estimate for blocks of size 2^( 6) =       0.000420302020
  error estimate for blocks of size 2^( 7) =       0.000421363908

      target function =                  N/A
              le_mean =     -17.217204616742
             les_mean =     296.745511972119
             stat err =       0.000418161135
             autocorr =       1.166575373552
              std dev =       0.547522866458
             le_variance =       0.299781289294


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217204615230        initial
     6.1035e+02     6.1035e+03             2.1051e-06       -17.217204639468  <--
     2.4414e+03     2.4414e+04             5.2640e-07       -17.217204627337
     9.7656e+03     9.7656e+04             1.3161e-07       -17.217204616742

*****************************************************************************
Applying the update for shift_i =   6.1035e+02     and shift_s =   6.1035e+03
*****************************************************************************

  Execution time = 5.4257e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
  uu_0                 2.061936e-01 1 1  ON 0
  uu_1                 4.539079e-02 1 1  ON 1
  uu_2                -4.680545e-02 1 1  ON 2
  uu_3                -9.936277e-02 1 1  ON 3
  uu_4                -1.304440e-01 1 1  ON 4
  uu_5                -1.356405e-01 1 1  ON 5
  uu_6                -1.130354e-01 1 1  ON 6
  uu_7                -3.972231e-02 1 1  ON 7
  uu_8                 9.988751e-02 1 1  ON 8
  uu_9                 1.208927e-01 1 1  ON 9
  ud_0                 3.495774e-01 1 1  ON 10
  ud_1                 9.178502e-02 1 1  ON 11
  ud_2                -1.648747e-02 1 1  ON 12
  ud_3                -7.596277e-02 1 1  ON 13
  ud_4                -1.217508e-01 1 1  ON 14
  ud_5                -1.523208e-01 1 1  ON 15
  ud_6                -1.544625e-01 1 1  ON 16
  ud_7                -1.100033e-01 1 1  ON 17
  ud_8                 4.464275e-03 1 1  ON 18
  ud_9                 9.258158e-02 1 1  ON 19
  eO_0                -7.504284e-01 1 1  ON 20
  eO_1                -4.354926e-01 1 1  ON 21
  eO_2                -3.598123e-02 1 1  ON 22
  eO_3                 2.081590e-01 1 1  ON 23
  eO_4                 2.891427e-01 1 1  ON 24
  eO_5                 3.052696e-01 1 1  ON 25
  eO_6                 2.501142e-01 1 1  ON 26
  eO_7                 1.121828e-01 1 1  ON 27
  eO_8                 2.793047e-02 1 1  ON 28
  eO_9                 1.846813e-02 1 1  ON 29
 eH1_0                -1.820108e-01 1 1  ON 30
 eH1_1                -1.027123e-01 1 1  ON 31
 eH1_2                -6.202914e-02 1 1  ON 32
 eH1_3                -2.594618e-02 1 1  ON 33
 eH1_4                 1.931543e-02 1 1  ON 34
 eH1_5                 3.552873e-02 1 1  ON 35
 eH1_6                 7.728036e-02 1 1  ON 36
 eH1_7                 1.103063e-01 1 1  ON 37
 eH1_8                 9.073744e-02 1 1  ON 38
 eH1_9                 2.428758e-02 1 1  ON 39
 eH2_0                -1.835293e-01 1 1  ON 40
 eH2_1                -1.038369e-01 1 1  ON 41
 eH2_2                -6.350513e-02 1 1  ON 42
 eH2_3                -2.706139e-02 1 1  ON 43
 eH2_4                 1.856814e-02 1 1  ON 44
 eH2_5                 3.505009e-02 1 1  ON 45
 eH2_6                 7.827827e-02 1 1  ON 46
 eH2_7                 1.134122e-01 1 1  ON 47
 eH2_8                 9.397315e-02 1 1  ON 48
 eH2_9                 2.639259e-02 1 1  ON 49
ci_001                -3.996417e-02 3 1  ON 50
ci_002                -3.016572e-02 3 1  ON 51
ci_003                -2.507264e-02 3 1  ON 52
ci_004                 2.111188e-02 3 1  ON 53
ci_005                 2.113458e-02 3 1  ON 54
ci_006                -1.943349e-02 3 1  ON 55
ci_007                -1.880471e-02 3 1  ON 56
ci_008                -1.774324e-02 3 1  ON 57
ci_009                -1.805752e-02 3 1  ON 58
ci_010                -1.730285e-02 3 1  ON 59
ci_011                -1.626744e-02 3 1  ON 60
ci_012                -1.614823e-02 3 1  ON 61
ci_013                -1.921699e-02 3 1  ON 62
ci_014                 1.385391e-02 3 1  ON 63
ci_015                 1.356367e-02 3 1  ON 64
ci_016                 1.626396e-02 3 1  ON 65
ci_017                 1.653434e-02 3 1  ON 66
ci_018                 1.263118e-02 3 1  ON 67
ci_019                 1.309161e-02 3 1  ON 68
ci_020                 1.328225e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114513e-02 3 1  ON 71
ci_023                 1.122681e-02 3 1  ON 72
ci_024                 1.228139e-02 3 1  ON 73
ci_025                 1.155301e-02 3 1  ON 74
ci_026                 1.090658e-02 3 1  ON 75
ci_027                 1.132505e-02 3 1  ON 76
ci_028                -1.426032e-02 3 1  ON 77
ci_029                -1.490853e-02 3 1  ON 78
ci_030                -1.110629e-02 3 1  ON 79
ci_031                -1.141234e-02 3 1  ON 80
ci_032                -1.349064e-02 3 1  ON 81
ci_033                 1.065631e-02 3 1  ON 82
ci_034                 1.063497e-02 3 1  ON 83
ci_035                -4.702884e-03 3 1  ON 84
ci_036                -1.040483e-02 3 1  ON 85
ci_037                -1.005818e-02 3 1  ON 86
ci_038                 1.873549e-03 3 1  ON 87
ci_039                 1.471281e-03 3 1  ON 88
ci_040                -4.064682e-03 3 1  ON 89
ci_041                 9.805070e-03 3 1  ON 90
ci_042                 9.855158e-03 3 1  ON 91
ci_043                -2.929225e-03 3 1  ON 92
ci_044                -1.514700e-02 3 1  ON 93
ci_045                -1.825511e-03 3 1  ON 94
ci_046                 5.708020e-03 3 1  ON 95
ci_047                 5.452431e-03 3 1  ON 96
ci_048                -1.169180e-02 3 1  ON 97
ci_049                -1.200921e-02 3 1  ON 98
ci_050                 7.412490e-03 3 1  ON 99
ci_051                 7.764386e-03 3 1  ON 100
ci_052                -6.441255e-03 3 1  ON 101
ci_053                -6.306921e-03 3 1  ON 102
ci_054                -3.217428e-03 3 1  ON 103
ci_055                -3.042999e-03 3 1  ON 104
ci_056                 4.495466e-03 3 1  ON 105
ci_057                 4.397675e-03 3 1  ON 106
ci_058                -6.794699e-03 3 1  ON 107
ci_059                -6.375990e-03 3 1  ON 108
ci_060                 8.242414e-03 3 1  ON 109
ci_061                 7.907586e-03 3 1  ON 110
ci_062                -3.256763e-03 3 1  ON 111
ci_063                -2.908031e-03 3 1  ON 112
ci_064                -3.132824e-03 3 1  ON 113
ci_065                -4.350822e-03 3 1  ON 114
ci_066                 5.564600e-03 3 1  ON 115
ci_067                 5.750851e-03 3 1  ON 116
ci_068                -4.597028e-03 3 1  ON 117
ci_069                -4.607600e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0369e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7216e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.2276
    reference variance = 0.263211
====================================================
  Execution time = 3.7909e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5276e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1739e-01
  Total weights = 1.956607158e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0994e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298194156977
                                         uncertainty =       0.001655428173

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298194156977
                                         uncertainty =       0.001655428173

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386084902
  error estimate for blocks of size 2^( 2) =       0.000396156817
  error estimate for blocks of size 2^( 3) =       0.000405293409
  error estimate for blocks of size 2^( 4) =       0.000412214420
  error estimate for blocks of size 2^( 5) =       0.000416552524
  error estimate for blocks of size 2^( 6) =       0.000417986820
  error estimate for blocks of size 2^( 7) =       0.000419439676

      target function =                  N/A
              le_mean =     -17.215952815478
             les_mean =     296.706426221821
             stat err =       0.000416548360
             autocorr =       1.164032806791
              std dev =       0.546006504415
             le_variance =       0.298123102863


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721595281548e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215952815557       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215952842560       residual = 5.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215952838866       residual = 5.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215952840598       residual = 4.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215952835450       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215952834909       residual = 3.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215952833879       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215952836210       residual = 4.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215952836932       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215952837635       residual = 3.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5259e+02 is 4.638579e-06

solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215952815557       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215952822317       residual = 5.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215952821392       residual = 5.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215952821826       residual = 4.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215952820541       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215952820402       residual = 3.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215952820141       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215952820721       residual = 4.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215952820902       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215952821077       residual = 3.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.1035e+02 is 1.159747e-06

solving harmonic davidson linear method for identity shift 2.4414e+03, overlap shift 2.4414e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215952815557       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215952817247       residual = 5.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215952817016       residual = 5.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215952817125       residual = 4.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215952816803       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215952816772       residual = 3.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215952816707       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215952816851       residual = 4.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215952816892       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215952816928       residual = 3.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.4414e+03 is 2.899430e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.196263 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8916e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
  uu_0                 2.061939e-01 1 1  ON 0
  uu_1                 4.539083e-02 1 1  ON 1
  uu_2                -4.680531e-02 1 1  ON 2
  uu_3                -9.936277e-02 1 1  ON 3
  uu_4                -1.304442e-01 1 1  ON 4
  uu_5                -1.356407e-01 1 1  ON 5
  uu_6                -1.130355e-01 1 1  ON 6
  uu_7                -3.972254e-02 1 1  ON 7
  uu_8                 9.988740e-02 1 1  ON 8
  uu_9                 1.208929e-01 1 1  ON 9
  ud_0                 3.495780e-01 1 1  ON 10
  ud_1                 9.178515e-02 1 1  ON 11
  ud_2                -1.648750e-02 1 1  ON 12
  ud_3                -7.596291e-02 1 1  ON 13
  ud_4                -1.217511e-01 1 1  ON 14
  ud_5                -1.523209e-01 1 1  ON 15
  ud_6                -1.544625e-01 1 1  ON 16
  ud_7                -1.100033e-01 1 1  ON 17
  ud_8                 4.464045e-03 1 1  ON 18
  ud_9                 9.258158e-02 1 1  ON 19
  eO_0                -7.504294e-01 1 1  ON 20
  eO_1                -4.354934e-01 1 1  ON 21
  eO_2                -3.598160e-02 1 1  ON 22
  eO_3                 2.081595e-01 1 1  ON 23
  eO_4                 2.891438e-01 1 1  ON 24
  eO_5                 3.052698e-01 1 1  ON 25
  eO_6                 2.501143e-01 1 1  ON 26
  eO_7                 1.121830e-01 1 1  ON 27
  eO_8                 2.793050e-02 1 1  ON 28
  eO_9                 1.846816e-02 1 1  ON 29
 eH1_0                -1.820109e-01 1 1  ON 30
 eH1_1                -1.027124e-01 1 1  ON 31
 eH1_2                -6.202924e-02 1 1  ON 32
 eH1_3                -2.594622e-02 1 1  ON 33
 eH1_4                 1.931553e-02 1 1  ON 34
 eH1_5                 3.552880e-02 1 1  ON 35
 eH1_6                 7.728043e-02 1 1  ON 36
 eH1_7                 1.103063e-01 1 1  ON 37
 eH1_8                 9.073756e-02 1 1  ON 38
 eH1_9                 2.428762e-02 1 1  ON 39
 eH2_0                -1.835292e-01 1 1  ON 40
 eH2_1                -1.038372e-01 1 1  ON 41
 eH2_2                -6.350517e-02 1 1  ON 42
 eH2_3                -2.706131e-02 1 1  ON 43
 eH2_4                 1.856810e-02 1 1  ON 44
 eH2_5                 3.505003e-02 1 1  ON 45
 eH2_6                 7.827827e-02 1 1  ON 46
 eH2_7                 1.134122e-01 1 1  ON 47
 eH2_8                 9.397326e-02 1 1  ON 48
 eH2_9                 2.639263e-02 1 1  ON 49
ci_001                -3.996379e-02 3 1  ON 50
ci_002                -3.016552e-02 3 1  ON 51
ci_003                -2.507275e-02 3 1  ON 52
ci_004                 2.111196e-02 3 1  ON 53
ci_005                 2.113454e-02 3 1  ON 54
ci_006                -1.943354e-02 3 1  ON 55
ci_007                -1.880496e-02 3 1  ON 56
ci_008                -1.774323e-02 3 1  ON 57
ci_009                -1.805706e-02 3 1  ON 58
ci_010                -1.730284e-02 3 1  ON 59
ci_011                -1.626708e-02 3 1  ON 60
ci_012                -1.614798e-02 3 1  ON 61
ci_013                -1.921679e-02 3 1  ON 62
ci_014                 1.385411e-02 3 1  ON 63
ci_015                 1.356400e-02 3 1  ON 64
ci_016                 1.626411e-02 3 1  ON 65
ci_017                 1.653427e-02 3 1  ON 66
ci_018                 1.263097e-02 3 1  ON 67
ci_019                 1.309168e-02 3 1  ON 68
ci_020                 1.328206e-02 3 1  ON 69
ci_021                 1.336535e-02 3 1  ON 70
ci_022                 1.114516e-02 3 1  ON 71
ci_023                 1.122679e-02 3 1  ON 72
ci_024                 1.228151e-02 3 1  ON 73
ci_025                 1.155291e-02 3 1  ON 74
ci_026                 1.090662e-02 3 1  ON 75
ci_027                 1.132496e-02 3 1  ON 76
ci_028                -1.426074e-02 3 1  ON 77
ci_029                -1.490836e-02 3 1  ON 78
ci_030                -1.110656e-02 3 1  ON 79
ci_031                -1.141222e-02 3 1  ON 80
ci_032                -1.349010e-02 3 1  ON 81
ci_033                 1.065676e-02 3 1  ON 82
ci_034                 1.063493e-02 3 1  ON 83
ci_035                -4.703167e-03 3 1  ON 84
ci_036                -1.040457e-02 3 1  ON 85
ci_037                -1.005817e-02 3 1  ON 86
ci_038                 1.873270e-03 3 1  ON 87
ci_039                 1.471761e-03 3 1  ON 88
ci_040                -4.065050e-03 3 1  ON 89
ci_041                 9.804823e-03 3 1  ON 90
ci_042                 9.855462e-03 3 1  ON 91
ci_043                -2.929309e-03 3 1  ON 92
ci_044                -1.514700e-02 3 1  ON 93
ci_045                -1.825431e-03 3 1  ON 94
ci_046                 5.708040e-03 3 1  ON 95
ci_047                 5.452542e-03 3 1  ON 96
ci_048                -1.169158e-02 3 1  ON 97
ci_049                -1.200898e-02 3 1  ON 98
ci_050                 7.412530e-03 3 1  ON 99
ci_051                 7.764667e-03 3 1  ON 100
ci_052                -6.441192e-03 3 1  ON 101
ci_053                -6.306947e-03 3 1  ON 102
ci_054                -3.217320e-03 3 1  ON 103
ci_055                -3.042887e-03 3 1  ON 104
ci_056                 4.495537e-03 3 1  ON 105
ci_057                 4.397724e-03 3 1  ON 106
ci_058                -6.794871e-03 3 1  ON 107
ci_059                -6.376401e-03 3 1  ON 108
ci_060                 8.242508e-03 3 1  ON 109
ci_061                 7.907773e-03 3 1  ON 110
ci_062                -3.256616e-03 3 1  ON 111
ci_063                -2.908048e-03 3 1  ON 112
ci_064                -3.132990e-03 3 1  ON 113
ci_065                -4.350709e-03 3 1  ON 114
ci_066                 5.564695e-03 3 1  ON 115
ci_067                 5.750540e-03 3 1  ON 116
ci_068                -4.597103e-03 3 1  ON 117
ci_069                -4.607800e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.2249
    reference variance = 0.251695
====================================================
  Execution time = 3.7460e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1492e-01
  Total weights = 1.9566e+06
  Execution time = 3.3477e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301196248248
                                         uncertainty =       0.001944855768

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301196248248
                                         uncertainty =       0.001944855768

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388056188
  error estimate for blocks of size 2^( 2) =       0.000398096339
  error estimate for blocks of size 2^( 3) =       0.000406919949
  error estimate for blocks of size 2^( 4) =       0.000413207085
  error estimate for blocks of size 2^( 5) =       0.000416593698
  error estimate for blocks of size 2^( 6) =       0.000418331796
  error estimate for blocks of size 2^( 7) =       0.000420343681

      target function =                  N/A
              le_mean =     -17.217037741700
             les_mean =     296.741304543592
             stat err =       0.000417119065
             autocorr =       1.155395985299
              std dev =       0.548794324332
             le_variance =       0.301175210419

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301199492459
                                         uncertainty =       0.001944919078

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301199492459
                                         uncertainty =       0.001944919078

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388058274
  error estimate for blocks of size 2^( 2) =       0.000398098323
  error estimate for blocks of size 2^( 3) =       0.000406921831
  error estimate for blocks of size 2^( 4) =       0.000413208831
  error estimate for blocks of size 2^( 5) =       0.000416595373
  error estimate for blocks of size 2^( 6) =       0.000418333485
  error estimate for blocks of size 2^( 7) =       0.000420345371

      target function =                  N/A
              le_mean =     -17.217037782795
             les_mean =     296.741312778926
             stat err =       0.000417120765
             autocorr =       1.155392980347
              std dev =       0.548797274431
             le_variance =       0.301178448423

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301197872737
                                         uncertainty =       0.001944887471

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301197872737
                                         uncertainty =       0.001944887471

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388057233
  error estimate for blocks of size 2^( 2) =       0.000398097332
  error estimate for blocks of size 2^( 3) =       0.000406920892
  error estimate for blocks of size 2^( 4) =       0.000413207959
  error estimate for blocks of size 2^( 5) =       0.000416594537
  error estimate for blocks of size 2^( 6) =       0.000418332642
  error estimate for blocks of size 2^( 7) =       0.000420344528

      target function =                  N/A
              le_mean =     -17.217037762232
             les_mean =     296.741308525650
             stat err =       0.000417119916
             autocorr =       1.155394480448
              std dev =       0.548795801549
             le_variance =       0.301176831798

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301196451358
                                         uncertainty =       0.001944859732

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301196451358
                                         uncertainty =       0.001944859732

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388056319
  error estimate for blocks of size 2^( 2) =       0.000398096463
  error estimate for blocks of size 2^( 3) =       0.000406920067
  error estimate for blocks of size 2^( 4) =       0.000413207194
  error estimate for blocks of size 2^( 5) =       0.000416593803
  error estimate for blocks of size 2^( 6) =       0.000418331902
  error estimate for blocks of size 2^( 7) =       0.000420343787

      target function =                  N/A
              le_mean =     -17.217037744262
             les_mean =     296.741305027595
             stat err =       0.000417119172
             autocorr =       1.155395797131
              std dev =       0.548794509028
             le_variance =       0.301175413139


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217037741700        initial
     1.5259e+02     1.5259e+03             4.6386e-06       -17.217037782795  <--
     6.1035e+02     6.1035e+03             1.1597e-06       -17.217037762232
     2.4414e+03     2.4414e+04             2.8994e-07       -17.217037744262

*****************************************************************************
Applying the update for shift_i =   1.5259e+02     and shift_s =   1.5259e+03
*****************************************************************************

  Execution time = 5.4382e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
  uu_0                 2.061948e-01 1 1  ON 0
  uu_1                 4.539097e-02 1 1  ON 1
  uu_2                -4.680488e-02 1 1  ON 2
  uu_3                -9.936275e-02 1 1  ON 3
  uu_4                -1.304446e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972324e-02 1 1  ON 7
  uu_8                 9.988709e-02 1 1  ON 8
  uu_9                 1.208932e-01 1 1  ON 9
  ud_0                 3.495797e-01 1 1  ON 10
  ud_1                 9.178555e-02 1 1  ON 11
  ud_2                -1.648760e-02 1 1  ON 12
  ud_3                -7.596333e-02 1 1  ON 13
  ud_4                -1.217523e-01 1 1  ON 14
  ud_5                -1.523213e-01 1 1  ON 15
  ud_6                -1.544623e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463355e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504323e-01 1 1  ON 20
  eO_1                -4.354959e-01 1 1  ON 21
  eO_2                -3.598272e-02 1 1  ON 22
  eO_3                 2.081608e-01 1 1  ON 23
  eO_4                 2.891473e-01 1 1  ON 24
  eO_5                 3.052705e-01 1 1  ON 25
  eO_6                 2.501147e-01 1 1  ON 26
  eO_7                 1.121835e-01 1 1  ON 27
  eO_8                 2.793058e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027127e-01 1 1  ON 31
 eH1_2                -6.202954e-02 1 1  ON 32
 eH1_3                -2.594631e-02 1 1  ON 33
 eH1_4                 1.931584e-02 1 1  ON 34
 eH1_5                 3.552899e-02 1 1  ON 35
 eH1_6                 7.728064e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073791e-02 1 1  ON 38
 eH1_9                 2.428773e-02 1 1  ON 39
 eH2_0                -1.835287e-01 1 1  ON 40
 eH2_1                -1.038379e-01 1 1  ON 41
 eH2_2                -6.350531e-02 1 1  ON 42
 eH2_3                -2.706105e-02 1 1  ON 43
 eH2_4                 1.856796e-02 1 1  ON 44
 eH2_5                 3.504983e-02 1 1  ON 45
 eH2_6                 7.827827e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397359e-02 1 1  ON 48
 eH2_9                 2.639276e-02 1 1  ON 49
ci_001                -3.996264e-02 3 1  ON 50
ci_002                -3.016492e-02 3 1  ON 51
ci_003                -2.507309e-02 3 1  ON 52
ci_004                 2.111218e-02 3 1  ON 53
ci_005                 2.113445e-02 3 1  ON 54
ci_006                -1.943370e-02 3 1  ON 55
ci_007                -1.880571e-02 3 1  ON 56
ci_008                -1.774318e-02 3 1  ON 57
ci_009                -1.805569e-02 3 1  ON 58
ci_010                -1.730281e-02 3 1  ON 59
ci_011                -1.626600e-02 3 1  ON 60
ci_012                -1.614723e-02 3 1  ON 61
ci_013                -1.921622e-02 3 1  ON 62
ci_014                 1.385471e-02 3 1  ON 63
ci_015                 1.356501e-02 3 1  ON 64
ci_016                 1.626456e-02 3 1  ON 65
ci_017                 1.653407e-02 3 1  ON 66
ci_018                 1.263034e-02 3 1  ON 67
ci_019                 1.309190e-02 3 1  ON 68
ci_020                 1.328148e-02 3 1  ON 69
ci_021                 1.336539e-02 3 1  ON 70
ci_022                 1.114526e-02 3 1  ON 71
ci_023                 1.122676e-02 3 1  ON 72
ci_024                 1.228186e-02 3 1  ON 73
ci_025                 1.155260e-02 3 1  ON 74
ci_026                 1.090673e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426197e-02 3 1  ON 77
ci_029                -1.490785e-02 3 1  ON 78
ci_030                -1.110737e-02 3 1  ON 79
ci_031                -1.141187e-02 3 1  ON 80
ci_032                -1.348849e-02 3 1  ON 81
ci_033                 1.065813e-02 3 1  ON 82
ci_034                 1.063481e-02 3 1  ON 83
ci_035                -4.704016e-03 3 1  ON 84
ci_036                -1.040378e-02 3 1  ON 85
ci_037                -1.005813e-02 3 1  ON 86
ci_038                 1.872436e-03 3 1  ON 87
ci_039                 1.473197e-03 3 1  ON 88
ci_040                -4.066152e-03 3 1  ON 89
ci_041                 9.804084e-03 3 1  ON 90
ci_042                 9.856372e-03 3 1  ON 91
ci_043                -2.929563e-03 3 1  ON 92
ci_044                -1.514701e-02 3 1  ON 93
ci_045                -1.825194e-03 3 1  ON 94
ci_046                 5.708102e-03 3 1  ON 95
ci_047                 5.452875e-03 3 1  ON 96
ci_048                -1.169093e-02 3 1  ON 97
ci_049                -1.200828e-02 3 1  ON 98
ci_050                 7.412650e-03 3 1  ON 99
ci_051                 7.765506e-03 3 1  ON 100
ci_052                -6.441002e-03 3 1  ON 101
ci_053                -6.307024e-03 3 1  ON 102
ci_054                -3.216995e-03 3 1  ON 103
ci_055                -3.042553e-03 3 1  ON 104
ci_056                 4.495750e-03 3 1  ON 105
ci_057                 4.397870e-03 3 1  ON 106
ci_058                -6.795387e-03 3 1  ON 107
ci_059                -6.377630e-03 3 1  ON 108
ci_060                 8.242788e-03 3 1  ON 109
ci_061                 7.908332e-03 3 1  ON 110
ci_062                -3.256178e-03 3 1  ON 111
ci_063                -2.908096e-03 3 1  ON 112
ci_064                -3.133487e-03 3 1  ON 113
ci_065                -4.350369e-03 3 1  ON 114
ci_066                 5.564977e-03 3 1  ON 115
ci_067                 5.749608e-03 3 1  ON 116
ci_068                -4.597325e-03 3 1  ON 117
ci_069                -4.608400e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0331e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7216e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.3543
    reference variance = 0.623171
====================================================
  Execution time = 3.7869e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5312e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0984e-01
  Total weights = 1.956849680e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1157e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296424288795
                                         uncertainty =       0.001701006732

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296424288795
                                         uncertainty =       0.001701006732

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384989861
  error estimate for blocks of size 2^( 2) =       0.000395047101
  error estimate for blocks of size 2^( 3) =       0.000404156590
  error estimate for blocks of size 2^( 4) =       0.000410487937
  error estimate for blocks of size 2^( 5) =       0.000414516169
  error estimate for blocks of size 2^( 6) =       0.000415617370
  error estimate for blocks of size 2^( 7) =       0.000418028475

      target function =                  N/A
              le_mean =     -17.216019591403
             les_mean =     296.701169636670
             stat err =       0.000414662488
             autocorr =       1.160087946697
              std dev =       0.544457882188
             le_variance =       0.296434385477


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721601959140e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216019591426       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216019640247       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216019653764       residual = 8.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216019680595       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216019678261       residual = 4.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216019717676       residual = 8.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216019706339       residual = 2.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216019707721       residual = 6.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216019705106       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216019704939       residual = 6.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.8147e+01 is 1.916711e-05

solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216019591426       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216019603687       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216019607080       residual = 8.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216019613854       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216019613296       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216019623124       residual = 8.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216019620263       residual = 2.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216019620616       residual = 6.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216019619972       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216019619930       residual = 6.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5259e+02 is 4.792776e-06

solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216019591426       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216019594495       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216019595344       residual = 8.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216019597042       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216019596903       residual = 4.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216019599359       residual = 8.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216019598642       residual = 2.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216019598729       residual = 6.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216019598569       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216019598561       residual = 6.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.1035e+02 is 1.198256e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.200327 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.9038e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
  uu_0                 2.061963e-01 1 1  ON 0
  uu_1                 4.539207e-02 1 1  ON 1
  uu_2                -4.680392e-02 1 1  ON 2
  uu_3                -9.936302e-02 1 1  ON 3
  uu_4                -1.304451e-01 1 1  ON 4
  uu_5                -1.356425e-01 1 1  ON 5
  uu_6                -1.130362e-01 1 1  ON 6
  uu_7                -3.972449e-02 1 1  ON 7
  uu_8                 9.988636e-02 1 1  ON 8
  uu_9                 1.208935e-01 1 1  ON 9
  ud_0                 3.495818e-01 1 1  ON 10
  ud_1                 9.178600e-02 1 1  ON 11
  ud_2                -1.648783e-02 1 1  ON 12
  ud_3                -7.596351e-02 1 1  ON 13
  ud_4                -1.217527e-01 1 1  ON 14
  ud_5                -1.523215e-01 1 1  ON 15
  ud_6                -1.544622e-01 1 1  ON 16
  ud_7                -1.100039e-01 1 1  ON 17
  ud_8                 4.462178e-03 1 1  ON 18
  ud_9                 9.258149e-02 1 1  ON 19
  eO_0                -7.504363e-01 1 1  ON 20
  eO_1                -4.354999e-01 1 1  ON 21
  eO_2                -3.598350e-02 1 1  ON 22
  eO_3                 2.081627e-01 1 1  ON 23
  eO_4                 2.891521e-01 1 1  ON 24
  eO_5                 3.052716e-01 1 1  ON 25
  eO_6                 2.501149e-01 1 1  ON 26
  eO_7                 1.121841e-01 1 1  ON 27
  eO_8                 2.793064e-02 1 1  ON 28
  eO_9                 1.846826e-02 1 1  ON 29
 eH1_0                -1.820114e-01 1 1  ON 30
 eH1_1                -1.027125e-01 1 1  ON 31
 eH1_2                -6.202959e-02 1 1  ON 32
 eH1_3                -2.594690e-02 1 1  ON 33
 eH1_4                 1.931588e-02 1 1  ON 34
 eH1_5                 3.552908e-02 1 1  ON 35
 eH1_6                 7.728081e-02 1 1  ON 36
 eH1_7                 1.103059e-01 1 1  ON 37
 eH1_8                 9.073828e-02 1 1  ON 38
 eH1_9                 2.428786e-02 1 1  ON 39
 eH2_0                -1.835286e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350499e-02 1 1  ON 42
 eH2_3                -2.706106e-02 1 1  ON 43
 eH2_4                 1.856747e-02 1 1  ON 44
 eH2_5                 3.504978e-02 1 1  ON 45
 eH2_6                 7.827862e-02 1 1  ON 46
 eH2_7                 1.134117e-01 1 1  ON 47
 eH2_8                 9.397381e-02 1 1  ON 48
 eH2_9                 2.639284e-02 1 1  ON 49
ci_001                -3.996336e-02 3 1  ON 50
ci_002                -3.016427e-02 3 1  ON 51
ci_003                -2.507262e-02 3 1  ON 52
ci_004                 2.111083e-02 3 1  ON 53
ci_005                 2.113403e-02 3 1  ON 54
ci_006                -1.943318e-02 3 1  ON 55
ci_007                -1.880451e-02 3 1  ON 56
ci_008                -1.774461e-02 3 1  ON 57
ci_009                -1.805650e-02 3 1  ON 58
ci_010                -1.730379e-02 3 1  ON 59
ci_011                -1.626691e-02 3 1  ON 60
ci_012                -1.614626e-02 3 1  ON 61
ci_013                -1.921809e-02 3 1  ON 62
ci_014                 1.385480e-02 3 1  ON 63
ci_015                 1.356595e-02 3 1  ON 64
ci_016                 1.626507e-02 3 1  ON 65
ci_017                 1.653458e-02 3 1  ON 66
ci_018                 1.263068e-02 3 1  ON 67
ci_019                 1.309134e-02 3 1  ON 68
ci_020                 1.328212e-02 3 1  ON 69
ci_021                 1.336605e-02 3 1  ON 70
ci_022                 1.114542e-02 3 1  ON 71
ci_023                 1.122734e-02 3 1  ON 72
ci_024                 1.228119e-02 3 1  ON 73
ci_025                 1.155134e-02 3 1  ON 74
ci_026                 1.090658e-02 3 1  ON 75
ci_027                 1.132484e-02 3 1  ON 76
ci_028                -1.426143e-02 3 1  ON 77
ci_029                -1.490738e-02 3 1  ON 78
ci_030                -1.110759e-02 3 1  ON 79
ci_031                -1.141055e-02 3 1  ON 80
ci_032                -1.348861e-02 3 1  ON 81
ci_033                 1.065752e-02 3 1  ON 82
ci_034                 1.063429e-02 3 1  ON 83
ci_035                -4.703394e-03 3 1  ON 84
ci_036                -1.040207e-02 3 1  ON 85
ci_037                -1.005803e-02 3 1  ON 86
ci_038                 1.871730e-03 3 1  ON 87
ci_039                 1.474506e-03 3 1  ON 88
ci_040                -4.065583e-03 3 1  ON 89
ci_041                 9.803618e-03 3 1  ON 90
ci_042                 9.855882e-03 3 1  ON 91
ci_043                -2.930052e-03 3 1  ON 92
ci_044                -1.514790e-02 3 1  ON 93
ci_045                -1.825299e-03 3 1  ON 94
ci_046                 5.707420e-03 3 1  ON 95
ci_047                 5.452243e-03 3 1  ON 96
ci_048                -1.169103e-02 3 1  ON 97
ci_049                -1.200951e-02 3 1  ON 98
ci_050                 7.412032e-03 3 1  ON 99
ci_051                 7.764010e-03 3 1  ON 100
ci_052                -6.441280e-03 3 1  ON 101
ci_053                -6.306135e-03 3 1  ON 102
ci_054                -3.215768e-03 3 1  ON 103
ci_055                -3.042979e-03 3 1  ON 104
ci_056                 4.496195e-03 3 1  ON 105
ci_057                 4.398731e-03 3 1  ON 106
ci_058                -6.795000e-03 3 1  ON 107
ci_059                -6.377491e-03 3 1  ON 108
ci_060                 8.241836e-03 3 1  ON 109
ci_061                 7.908694e-03 3 1  ON 110
ci_062                -3.256240e-03 3 1  ON 111
ci_063                -2.908451e-03 3 1  ON 112
ci_064                -3.133030e-03 3 1  ON 113
ci_065                -4.350106e-03 3 1  ON 114
ci_066                 5.564071e-03 3 1  ON 115
ci_067                 5.748885e-03 3 1  ON 116
ci_068                -4.598360e-03 3 1  ON 117
ci_069                -4.608811e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.2599
    reference variance = 0.285673
====================================================
  Execution time = 3.7393e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1257e-01
  Total weights = 1.9568e+06
  Execution time = 3.3517e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298628074409
                                         uncertainty =       0.001924199976

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298628074409
                                         uncertainty =       0.001924199976

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386392851
  error estimate for blocks of size 2^( 2) =       0.000396483690
  error estimate for blocks of size 2^( 3) =       0.000405485947
  error estimate for blocks of size 2^( 4) =       0.000411847282
  error estimate for blocks of size 2^( 5) =       0.000416319353
  error estimate for blocks of size 2^( 6) =       0.000418671508
  error estimate for blocks of size 2^( 7) =       0.000420274242

      target function =                  N/A
              le_mean =     -17.216441063293
             les_mean =     296.718414407089
             stat err =       0.000416778096
             autocorr =       1.163460406196
              std dev =       0.546442009881
             le_variance =       0.298598870163

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298635017807
                                         uncertainty =       0.001924251438

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298635017807
                                         uncertainty =       0.001924251438

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386397330
  error estimate for blocks of size 2^( 2) =       0.000396487924
  error estimate for blocks of size 2^( 3) =       0.000405489868
  error estimate for blocks of size 2^( 4) =       0.000411850982
  error estimate for blocks of size 2^( 5) =       0.000416322699
  error estimate for blocks of size 2^( 6) =       0.000418675183
  error estimate for blocks of size 2^( 7) =       0.000420278233

      target function =                  N/A
              le_mean =     -17.216440997135
             les_mean =     296.718418534722
             stat err =       0.000416781774
             autocorr =       1.163453966850
              std dev =       0.546448344826
             le_variance =       0.298605793564

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298631561519
                                         uncertainty =       0.001924225780

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298631561519
                                         uncertainty =       0.001924225780

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386395100
  error estimate for blocks of size 2^( 2) =       0.000396485816
  error estimate for blocks of size 2^( 3) =       0.000405487916
  error estimate for blocks of size 2^( 4) =       0.000411849140
  error estimate for blocks of size 2^( 5) =       0.000416321034
  error estimate for blocks of size 2^( 6) =       0.000418673353
  error estimate for blocks of size 2^( 7) =       0.000420276246

      target function =                  N/A
              le_mean =     -17.216441029605
             les_mean =     296.718416009542
             stat err =       0.000416779943
             autocorr =       1.163457171886
              std dev =       0.546445191423
             le_variance =       0.298602347229

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298628510484
                                         uncertainty =       0.001924203199

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298628510484
                                         uncertainty =       0.001924203199

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386393132
  error estimate for blocks of size 2^( 2) =       0.000396483956
  error estimate for blocks of size 2^( 3) =       0.000405486193
  error estimate for blocks of size 2^( 4) =       0.000411847514
  error estimate for blocks of size 2^( 5) =       0.000416319563
  error estimate for blocks of size 2^( 6) =       0.000418671738
  error estimate for blocks of size 2^( 7) =       0.000420274493

      target function =                  N/A
              le_mean =     -17.216441059030
             les_mean =     296.718414567680
             stat err =       0.000416778327
             autocorr =       1.163460001532
              std dev =       0.546442407744
             le_variance =       0.298599304981


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216441063293        initial  <--
     3.8147e+01     3.8147e+02             1.9167e-05       -17.216440997135
     1.5259e+02     1.5259e+03             4.7928e-06       -17.216441029605
     6.1035e+02     6.1035e+03             1.1983e-06       -17.216441059030

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 54.3512
  </log>
  <optVariables href="H2O.s015.opt.xml">
  uu_0                 2.061948e-01 1 1  ON 0
  uu_1                 4.539097e-02 1 1  ON 1
  uu_2                -4.680488e-02 1 1  ON 2
  uu_3                -9.936275e-02 1 1  ON 3
  uu_4                -1.304446e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972324e-02 1 1  ON 7
  uu_8                 9.988709e-02 1 1  ON 8
  uu_9                 1.208932e-01 1 1  ON 9
  ud_0                 3.495797e-01 1 1  ON 10
  ud_1                 9.178555e-02 1 1  ON 11
  ud_2                -1.648760e-02 1 1  ON 12
  ud_3                -7.596333e-02 1 1  ON 13
  ud_4                -1.217523e-01 1 1  ON 14
  ud_5                -1.523213e-01 1 1  ON 15
  ud_6                -1.544623e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463355e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504323e-01 1 1  ON 20
  eO_1                -4.354959e-01 1 1  ON 21
  eO_2                -3.598272e-02 1 1  ON 22
  eO_3                 2.081608e-01 1 1  ON 23
  eO_4                 2.891473e-01 1 1  ON 24
  eO_5                 3.052705e-01 1 1  ON 25
  eO_6                 2.501147e-01 1 1  ON 26
  eO_7                 1.121835e-01 1 1  ON 27
  eO_8                 2.793058e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027127e-01 1 1  ON 31
 eH1_2                -6.202954e-02 1 1  ON 32
 eH1_3                -2.594631e-02 1 1  ON 33
 eH1_4                 1.931584e-02 1 1  ON 34
 eH1_5                 3.552899e-02 1 1  ON 35
 eH1_6                 7.728064e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073791e-02 1 1  ON 38
 eH1_9                 2.428773e-02 1 1  ON 39
 eH2_0                -1.835287e-01 1 1  ON 40
 eH2_1                -1.038379e-01 1 1  ON 41
 eH2_2                -6.350531e-02 1 1  ON 42
 eH2_3                -2.706105e-02 1 1  ON 43
 eH2_4                 1.856796e-02 1 1  ON 44
 eH2_5                 3.504983e-02 1 1  ON 45
 eH2_6                 7.827827e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397359e-02 1 1  ON 48
 eH2_9                 2.639276e-02 1 1  ON 49
ci_001                -3.996264e-02 3 1  ON 50
ci_002                -3.016492e-02 3 1  ON 51
ci_003                -2.507309e-02 3 1  ON 52
ci_004                 2.111218e-02 3 1  ON 53
ci_005                 2.113445e-02 3 1  ON 54
ci_006                -1.943370e-02 3 1  ON 55
ci_007                -1.880571e-02 3 1  ON 56
ci_008                -1.774318e-02 3 1  ON 57
ci_009                -1.805569e-02 3 1  ON 58
ci_010                -1.730281e-02 3 1  ON 59
ci_011                -1.626600e-02 3 1  ON 60
ci_012                -1.614723e-02 3 1  ON 61
ci_013                -1.921622e-02 3 1  ON 62
ci_014                 1.385471e-02 3 1  ON 63
ci_015                 1.356501e-02 3 1  ON 64
ci_016                 1.626456e-02 3 1  ON 65
ci_017                 1.653407e-02 3 1  ON 66
ci_018                 1.263034e-02 3 1  ON 67
ci_019                 1.309190e-02 3 1  ON 68
ci_020                 1.328148e-02 3 1  ON 69
ci_021                 1.336539e-02 3 1  ON 70
ci_022                 1.114526e-02 3 1  ON 71
ci_023                 1.122676e-02 3 1  ON 72
ci_024                 1.228186e-02 3 1  ON 73
ci_025                 1.155260e-02 3 1  ON 74
ci_026                 1.090673e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426197e-02 3 1  ON 77
ci_029                -1.490785e-02 3 1  ON 78
ci_030                -1.110737e-02 3 1  ON 79
ci_031                -1.141187e-02 3 1  ON 80
ci_032                -1.348849e-02 3 1  ON 81
ci_033                 1.065813e-02 3 1  ON 82
ci_034                 1.063481e-02 3 1  ON 83
ci_035                -4.704016e-03 3 1  ON 84
ci_036                -1.040378e-02 3 1  ON 85
ci_037                -1.005813e-02 3 1  ON 86
ci_038                 1.872436e-03 3 1  ON 87
ci_039                 1.473197e-03 3 1  ON 88
ci_040                -4.066152e-03 3 1  ON 89
ci_041                 9.804084e-03 3 1  ON 90
ci_042                 9.856372e-03 3 1  ON 91
ci_043                -2.929563e-03 3 1  ON 92
ci_044                -1.514701e-02 3 1  ON 93
ci_045                -1.825194e-03 3 1  ON 94
ci_046                 5.708102e-03 3 1  ON 95
ci_047                 5.452875e-03 3 1  ON 96
ci_048                -1.169093e-02 3 1  ON 97
ci_049                -1.200828e-02 3 1  ON 98
ci_050                 7.412650e-03 3 1  ON 99
ci_051                 7.765506e-03 3 1  ON 100
ci_052                -6.441002e-03 3 1  ON 101
ci_053                -6.307024e-03 3 1  ON 102
ci_054                -3.216995e-03 3 1  ON 103
ci_055                -3.042553e-03 3 1  ON 104
ci_056                 4.495750e-03 3 1  ON 105
ci_057                 4.397870e-03 3 1  ON 106
ci_058                -6.795387e-03 3 1  ON 107
ci_059                -6.377630e-03 3 1  ON 108
ci_060                 8.242788e-03 3 1  ON 109
ci_061                 7.908332e-03 3 1  ON 110
ci_062                -3.256178e-03 3 1  ON 111
ci_063                -2.908096e-03 3 1  ON 112
ci_064                -3.133487e-03 3 1  ON 113
ci_065                -4.350369e-03 3 1  ON 114
ci_066                 5.564977e-03 3 1  ON 115
ci_067                 5.749608e-03 3 1  ON 116
ci_068                -4.597325e-03 3 1  ON 117
ci_069                -4.608400e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0341e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7222e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.2523
    reference variance = 0.190436
====================================================
  Execution time = 3.7720e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5315e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1538e-01
  Total weights = 1.956643423e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1037e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299986908993
                                         uncertainty =       0.001919149884

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299986908993
                                         uncertainty =       0.001919149884

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387258587
  error estimate for blocks of size 2^( 2) =       0.000397239346
  error estimate for blocks of size 2^( 3) =       0.000406122317
  error estimate for blocks of size 2^( 4) =       0.000412401859
  error estimate for blocks of size 2^( 5) =       0.000416700777
  error estimate for blocks of size 2^( 6) =       0.000419616377
  error estimate for blocks of size 2^( 7) =       0.000419531705

      target function =                  N/A
              le_mean =     -17.217176245837
             les_mean =     296.746542231534
             stat err =       0.000417062680
             autocorr =       1.159846577944
              std dev =       0.547666346065
             le_variance =       0.299938426612


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721717624584e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217176245840       residual = 1.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217176260293       residual = 3.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217176262460       residual = 4.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217176263428       residual = 3.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217176263631       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217176263869       residual = 7.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217176262842       residual = 2.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217176262975       residual = 4.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217176263172       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217176263385       residual = 4.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.8147e+02 is 1.665156e-06

solving harmonic davidson linear method for identity shift 1.5259e+03, overlap shift 1.5259e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217176245840       residual = 1.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217176249455       residual = 3.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217176249998       residual = 4.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217176250240       residual = 3.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217176250291       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217176250351       residual = 7.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217176250093       residual = 2.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217176250125       residual = 4.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217176250173       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217176250228       residual = 4.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5259e+03 is 4.163066e-07

solving harmonic davidson linear method for identity shift 6.1035e+03, overlap shift 6.1035e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217176245840       residual = 1.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217176246744       residual = 3.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217176246880       residual = 4.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217176246940       residual = 3.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217176246955       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217176246968       residual = 7.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217176246907       residual = 2.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217176246923       residual = 4.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217176246916       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217176246928       residual = 4.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.1035e+03 is 1.040777e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.204364 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8770e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539102e-02 1 1  ON 1
  uu_2                -4.680475e-02 1 1  ON 2
  uu_3                -9.936282e-02 1 1  ON 3
  uu_4                -1.304448e-01 1 1  ON 4
  uu_5                -1.356414e-01 1 1  ON 5
  uu_6                -1.130358e-01 1 1  ON 6
  uu_7                -3.972330e-02 1 1  ON 7
  uu_8                 9.988706e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495798e-01 1 1  ON 10
  ud_1                 9.178553e-02 1 1  ON 11
  ud_2                -1.648763e-02 1 1  ON 12
  ud_3                -7.596333e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523213e-01 1 1  ON 15
  ud_6                -1.544623e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463296e-03 1 1  ON 18
  ud_9                 9.258160e-02 1 1  ON 19
  eO_0                -7.504327e-01 1 1  ON 20
  eO_1                -4.354963e-01 1 1  ON 21
  eO_2                -3.598287e-02 1 1  ON 22
  eO_3                 2.081610e-01 1 1  ON 23
  eO_4                 2.891477e-01 1 1  ON 24
  eO_5                 3.052706e-01 1 1  ON 25
  eO_6                 2.501147e-01 1 1  ON 26
  eO_7                 1.121836e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846824e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027127e-01 1 1  ON 31
 eH1_2                -6.202962e-02 1 1  ON 32
 eH1_3                -2.594638e-02 1 1  ON 33
 eH1_4                 1.931585e-02 1 1  ON 34
 eH1_5                 3.552904e-02 1 1  ON 35
 eH1_6                 7.728066e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073797e-02 1 1  ON 38
 eH1_9                 2.428775e-02 1 1  ON 39
 eH2_0                -1.835287e-01 1 1  ON 40
 eH2_1                -1.038379e-01 1 1  ON 41
 eH2_2                -6.350524e-02 1 1  ON 42
 eH2_3                -2.706110e-02 1 1  ON 43
 eH2_4                 1.856795e-02 1 1  ON 44
 eH2_5                 3.504981e-02 1 1  ON 45
 eH2_6                 7.827827e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397363e-02 1 1  ON 48
 eH2_9                 2.639278e-02 1 1  ON 49
ci_001                -3.996265e-02 3 1  ON 50
ci_002                -3.016484e-02 3 1  ON 51
ci_003                -2.507318e-02 3 1  ON 52
ci_004                 2.111205e-02 3 1  ON 53
ci_005                 2.113448e-02 3 1  ON 54
ci_006                -1.943356e-02 3 1  ON 55
ci_007                -1.880573e-02 3 1  ON 56
ci_008                -1.774333e-02 3 1  ON 57
ci_009                -1.805554e-02 3 1  ON 58
ci_010                -1.730281e-02 3 1  ON 59
ci_011                -1.626603e-02 3 1  ON 60
ci_012                -1.614736e-02 3 1  ON 61
ci_013                -1.921637e-02 3 1  ON 62
ci_014                 1.385482e-02 3 1  ON 63
ci_015                 1.356516e-02 3 1  ON 64
ci_016                 1.626464e-02 3 1  ON 65
ci_017                 1.653410e-02 3 1  ON 66
ci_018                 1.263037e-02 3 1  ON 67
ci_019                 1.309180e-02 3 1  ON 68
ci_020                 1.328159e-02 3 1  ON 69
ci_021                 1.336525e-02 3 1  ON 70
ci_022                 1.114532e-02 3 1  ON 71
ci_023                 1.122679e-02 3 1  ON 72
ci_024                 1.228175e-02 3 1  ON 73
ci_025                 1.155267e-02 3 1  ON 74
ci_026                 1.090682e-02 3 1  ON 75
ci_027                 1.132477e-02 3 1  ON 76
ci_028                -1.426217e-02 3 1  ON 77
ci_029                -1.490784e-02 3 1  ON 78
ci_030                -1.110732e-02 3 1  ON 79
ci_031                -1.141184e-02 3 1  ON 80
ci_032                -1.348860e-02 3 1  ON 81
ci_033                 1.065808e-02 3 1  ON 82
ci_034                 1.063473e-02 3 1  ON 83
ci_035                -4.703969e-03 3 1  ON 84
ci_036                -1.040372e-02 3 1  ON 85
ci_037                -1.005822e-02 3 1  ON 86
ci_038                 1.872313e-03 3 1  ON 87
ci_039                 1.473266e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.804009e-03 3 1  ON 90
ci_042                 9.856375e-03 3 1  ON 91
ci_043                -2.929649e-03 3 1  ON 92
ci_044                -1.514685e-02 3 1  ON 93
ci_045                -1.825041e-03 3 1  ON 94
ci_046                 5.708088e-03 3 1  ON 95
ci_047                 5.453010e-03 3 1  ON 96
ci_048                -1.169105e-02 3 1  ON 97
ci_049                -1.200817e-02 3 1  ON 98
ci_050                 7.412645e-03 3 1  ON 99
ci_051                 7.765302e-03 3 1  ON 100
ci_052                -6.440952e-03 3 1  ON 101
ci_053                -6.307090e-03 3 1  ON 102
ci_054                -3.216779e-03 3 1  ON 103
ci_055                -3.042657e-03 3 1  ON 104
ci_056                 4.495690e-03 3 1  ON 105
ci_057                 4.397889e-03 3 1  ON 106
ci_058                -6.795276e-03 3 1  ON 107
ci_059                -6.377705e-03 3 1  ON 108
ci_060                 8.242892e-03 3 1  ON 109
ci_061                 7.908448e-03 3 1  ON 110
ci_062                -3.256246e-03 3 1  ON 111
ci_063                -2.908154e-03 3 1  ON 112
ci_064                -3.133510e-03 3 1  ON 113
ci_065                -4.350227e-03 3 1  ON 114
ci_066                 5.564986e-03 3 1  ON 115
ci_067                 5.749652e-03 3 1  ON 116
ci_068                -4.597273e-03 3 1  ON 117
ci_069                -4.608396e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.1674
    reference variance = 0.192953
====================================================
  Execution time = 3.7901e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1341e-01
  Total weights = 1.9563e+06
  Execution time = 3.3751e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299089210474
                                         uncertainty =       0.002352979878

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299089210474
                                         uncertainty =       0.002352979878

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386671556
  error estimate for blocks of size 2^( 2) =       0.000397001469
  error estimate for blocks of size 2^( 3) =       0.000406122209
  error estimate for blocks of size 2^( 4) =       0.000412920836
  error estimate for blocks of size 2^( 5) =       0.000416677626
  error estimate for blocks of size 2^( 6) =       0.000418255198
  error estimate for blocks of size 2^( 7) =       0.000418679822

      target function =                  N/A
              le_mean =     -17.216690821339
             les_mean =     296.727853582050
             stat err =       0.000416633370
             autocorr =       1.160977097750
              std dev =       0.546836158316
             le_variance =       0.299029784041

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299089723540
                                         uncertainty =       0.002352964305

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299089723540
                                         uncertainty =       0.002352964305

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386671887
  error estimate for blocks of size 2^( 2) =       0.000397001789
  error estimate for blocks of size 2^( 3) =       0.000406122497
  error estimate for blocks of size 2^( 4) =       0.000412921099
  error estimate for blocks of size 2^( 5) =       0.000416677899
  error estimate for blocks of size 2^( 6) =       0.000418255471
  error estimate for blocks of size 2^( 7) =       0.000418680160

      target function =                  N/A
              le_mean =     -17.216690819153
             les_mean =     296.727855929523
             stat err =       0.000416633657
             autocorr =       1.160976709193
              std dev =       0.546836626109
             le_variance =       0.299030295654

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299089467076
                                         uncertainty =       0.002352972083

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299089467076
                                         uncertainty =       0.002352972083

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386671721
  error estimate for blocks of size 2^( 2) =       0.000397001629
  error estimate for blocks of size 2^( 3) =       0.000406122353
  error estimate for blocks of size 2^( 4) =       0.000412920967
  error estimate for blocks of size 2^( 5) =       0.000416677763
  error estimate for blocks of size 2^( 6) =       0.000418255335
  error estimate for blocks of size 2^( 7) =       0.000418679991

      target function =                  N/A
              le_mean =     -17.216690820239
             les_mean =     296.727854730238
             stat err =       0.000416633514
             autocorr =       1.160976903406
              std dev =       0.546836392275
             le_variance =       0.299030039917

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299089242547
                                         uncertainty =       0.002352978903

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299089242547
                                         uncertainty =       0.002352978903

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386671576
  error estimate for blocks of size 2^( 2) =       0.000397001489
  error estimate for blocks of size 2^( 3) =       0.000406122227
  error estimate for blocks of size 2^( 4) =       0.000412920852
  error estimate for blocks of size 2^( 5) =       0.000416677643
  error estimate for blocks of size 2^( 6) =       0.000418255215
  error estimate for blocks of size 2^( 7) =       0.000418679843

      target function =                  N/A
              le_mean =     -17.216690821201
             les_mean =     296.727853721905
             stat err =       0.000416633388
             autocorr =       1.160977073460
              std dev =       0.546836187558
             le_variance =       0.299029816023


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216690821339        initial  <--
     3.8147e+02     3.8147e+03             1.6652e-06       -17.216690819153
     1.5259e+03     1.5259e+04             4.1631e-07       -17.216690820239
     6.1035e+03     6.1035e+04             1.0408e-07       -17.216690821201

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 54.9135
  </log>
  <optVariables href="H2O.s016.opt.xml">
  uu_0                 2.061948e-01 1 1  ON 0
  uu_1                 4.539097e-02 1 1  ON 1
  uu_2                -4.680488e-02 1 1  ON 2
  uu_3                -9.936275e-02 1 1  ON 3
  uu_4                -1.304446e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972324e-02 1 1  ON 7
  uu_8                 9.988709e-02 1 1  ON 8
  uu_9                 1.208932e-01 1 1  ON 9
  ud_0                 3.495797e-01 1 1  ON 10
  ud_1                 9.178555e-02 1 1  ON 11
  ud_2                -1.648760e-02 1 1  ON 12
  ud_3                -7.596333e-02 1 1  ON 13
  ud_4                -1.217523e-01 1 1  ON 14
  ud_5                -1.523213e-01 1 1  ON 15
  ud_6                -1.544623e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463355e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504323e-01 1 1  ON 20
  eO_1                -4.354959e-01 1 1  ON 21
  eO_2                -3.598272e-02 1 1  ON 22
  eO_3                 2.081608e-01 1 1  ON 23
  eO_4                 2.891473e-01 1 1  ON 24
  eO_5                 3.052705e-01 1 1  ON 25
  eO_6                 2.501147e-01 1 1  ON 26
  eO_7                 1.121835e-01 1 1  ON 27
  eO_8                 2.793058e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027127e-01 1 1  ON 31
 eH1_2                -6.202954e-02 1 1  ON 32
 eH1_3                -2.594631e-02 1 1  ON 33
 eH1_4                 1.931584e-02 1 1  ON 34
 eH1_5                 3.552899e-02 1 1  ON 35
 eH1_6                 7.728064e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073791e-02 1 1  ON 38
 eH1_9                 2.428773e-02 1 1  ON 39
 eH2_0                -1.835287e-01 1 1  ON 40
 eH2_1                -1.038379e-01 1 1  ON 41
 eH2_2                -6.350531e-02 1 1  ON 42
 eH2_3                -2.706105e-02 1 1  ON 43
 eH2_4                 1.856796e-02 1 1  ON 44
 eH2_5                 3.504983e-02 1 1  ON 45
 eH2_6                 7.827827e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397359e-02 1 1  ON 48
 eH2_9                 2.639276e-02 1 1  ON 49
ci_001                -3.996264e-02 3 1  ON 50
ci_002                -3.016492e-02 3 1  ON 51
ci_003                -2.507309e-02 3 1  ON 52
ci_004                 2.111218e-02 3 1  ON 53
ci_005                 2.113445e-02 3 1  ON 54
ci_006                -1.943370e-02 3 1  ON 55
ci_007                -1.880571e-02 3 1  ON 56
ci_008                -1.774318e-02 3 1  ON 57
ci_009                -1.805569e-02 3 1  ON 58
ci_010                -1.730281e-02 3 1  ON 59
ci_011                -1.626600e-02 3 1  ON 60
ci_012                -1.614723e-02 3 1  ON 61
ci_013                -1.921622e-02 3 1  ON 62
ci_014                 1.385471e-02 3 1  ON 63
ci_015                 1.356501e-02 3 1  ON 64
ci_016                 1.626456e-02 3 1  ON 65
ci_017                 1.653407e-02 3 1  ON 66
ci_018                 1.263034e-02 3 1  ON 67
ci_019                 1.309190e-02 3 1  ON 68
ci_020                 1.328148e-02 3 1  ON 69
ci_021                 1.336539e-02 3 1  ON 70
ci_022                 1.114526e-02 3 1  ON 71
ci_023                 1.122676e-02 3 1  ON 72
ci_024                 1.228186e-02 3 1  ON 73
ci_025                 1.155260e-02 3 1  ON 74
ci_026                 1.090673e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426197e-02 3 1  ON 77
ci_029                -1.490785e-02 3 1  ON 78
ci_030                -1.110737e-02 3 1  ON 79
ci_031                -1.141187e-02 3 1  ON 80
ci_032                -1.348849e-02 3 1  ON 81
ci_033                 1.065813e-02 3 1  ON 82
ci_034                 1.063481e-02 3 1  ON 83
ci_035                -4.704016e-03 3 1  ON 84
ci_036                -1.040378e-02 3 1  ON 85
ci_037                -1.005813e-02 3 1  ON 86
ci_038                 1.872436e-03 3 1  ON 87
ci_039                 1.473197e-03 3 1  ON 88
ci_040                -4.066152e-03 3 1  ON 89
ci_041                 9.804084e-03 3 1  ON 90
ci_042                 9.856372e-03 3 1  ON 91
ci_043                -2.929563e-03 3 1  ON 92
ci_044                -1.514701e-02 3 1  ON 93
ci_045                -1.825194e-03 3 1  ON 94
ci_046                 5.708102e-03 3 1  ON 95
ci_047                 5.452875e-03 3 1  ON 96
ci_048                -1.169093e-02 3 1  ON 97
ci_049                -1.200828e-02 3 1  ON 98
ci_050                 7.412650e-03 3 1  ON 99
ci_051                 7.765506e-03 3 1  ON 100
ci_052                -6.441002e-03 3 1  ON 101
ci_053                -6.307024e-03 3 1  ON 102
ci_054                -3.216995e-03 3 1  ON 103
ci_055                -3.042553e-03 3 1  ON 104
ci_056                 4.495750e-03 3 1  ON 105
ci_057                 4.397870e-03 3 1  ON 106
ci_058                -6.795387e-03 3 1  ON 107
ci_059                -6.377630e-03 3 1  ON 108
ci_060                 8.242788e-03 3 1  ON 109
ci_061                 7.908332e-03 3 1  ON 110
ci_062                -3.256178e-03 3 1  ON 111
ci_063                -2.908096e-03 3 1  ON 112
ci_064                -3.133487e-03 3 1  ON 113
ci_065                -4.350369e-03 3 1  ON 114
ci_066                 5.564977e-03 3 1  ON 115
ci_067                 5.749608e-03 3 1  ON 116
ci_068                -4.597325e-03 3 1  ON 117
ci_069                -4.608400e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0369e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.2281
    reference variance = 0.188831
====================================================
  Execution time = 3.7974e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5301e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1519e-01
  Total weights = 1.956535073e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1083e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298457530389
                                         uncertainty =       0.001823898624

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298457530389
                                         uncertainty =       0.001823898624

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386264875
  error estimate for blocks of size 2^( 2) =       0.000396867767
  error estimate for blocks of size 2^( 3) =       0.000405894106
  error estimate for blocks of size 2^( 4) =       0.000412126868
  error estimate for blocks of size 2^( 5) =       0.000415771011
  error estimate for blocks of size 2^( 6) =       0.000418022903
  error estimate for blocks of size 2^( 7) =       0.000419526748

      target function =                  N/A
              le_mean =     -17.216505391029
             les_mean =     296.723243156349
             stat err =       0.000416361883
             autocorr =       1.161907330615
              std dev =       0.546261025270
             le_variance =       0.298401107730


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721650539103e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+03, overlap shift 3.8147e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216505391052       residual = 1.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216505392496       residual = 2.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216505392717       residual = 3.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216505393103       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216505392998       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216505393322       residual = 5.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216505393256       residual = 8.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216505393215       residual = 2.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216505393201       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216505393180       residual = 2.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.8147e+03 is 2.020406e-07

solving harmonic davidson linear method for identity shift 1.5259e+04, overlap shift 1.5259e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216505391052       residual = 1.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216505391413       residual = 2.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216505391468       residual = 3.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216505391564       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216505391534       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216505391620       residual = 5.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216505391624       residual = 8.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216505391636       residual = 2.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216505391592       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216505391585       residual = 2.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5259e+04 is 5.051073e-08

solving harmonic davidson linear method for identity shift 6.1035e+04, overlap shift 6.1035e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216505391052       residual = 1.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216505391142       residual = 2.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216505391156       residual = 3.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216505391180       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216505391194       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216505391206       residual = 5.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216505391103       residual = 8.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216505391132       residual = 2.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216505391157       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216505391180       residual = 2.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.1035e+04 is 1.262772e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.208379 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.9069e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
  uu_0                 2.061948e-01 1 1  ON 0
  uu_1                 4.539098e-02 1 1  ON 1
  uu_2                -4.680487e-02 1 1  ON 2
  uu_3                -9.936276e-02 1 1  ON 3
  uu_4                -1.304446e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972324e-02 1 1  ON 7
  uu_8                 9.988709e-02 1 1  ON 8
  uu_9                 1.208932e-01 1 1  ON 9
  ud_0                 3.495797e-01 1 1  ON 10
  ud_1                 9.178555e-02 1 1  ON 11
  ud_2                -1.648761e-02 1 1  ON 12
  ud_3                -7.596333e-02 1 1  ON 13
  ud_4                -1.217523e-01 1 1  ON 14
  ud_5                -1.523213e-01 1 1  ON 15
  ud_6                -1.544623e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463350e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504324e-01 1 1  ON 20
  eO_1                -4.354960e-01 1 1  ON 21
  eO_2                -3.598273e-02 1 1  ON 22
  eO_3                 2.081608e-01 1 1  ON 23
  eO_4                 2.891474e-01 1 1  ON 24
  eO_5                 3.052705e-01 1 1  ON 25
  eO_6                 2.501147e-01 1 1  ON 26
  eO_7                 1.121835e-01 1 1  ON 27
  eO_8                 2.793058e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027127e-01 1 1  ON 31
 eH1_2                -6.202954e-02 1 1  ON 32
 eH1_3                -2.594632e-02 1 1  ON 33
 eH1_4                 1.931585e-02 1 1  ON 34
 eH1_5                 3.552900e-02 1 1  ON 35
 eH1_6                 7.728064e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073792e-02 1 1  ON 38
 eH1_9                 2.428773e-02 1 1  ON 39
 eH2_0                -1.835287e-01 1 1  ON 40
 eH2_1                -1.038379e-01 1 1  ON 41
 eH2_2                -6.350531e-02 1 1  ON 42
 eH2_3                -2.706105e-02 1 1  ON 43
 eH2_4                 1.856796e-02 1 1  ON 44
 eH2_5                 3.504982e-02 1 1  ON 45
 eH2_6                 7.827827e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397360e-02 1 1  ON 48
 eH2_9                 2.639276e-02 1 1  ON 49
ci_001                -3.996264e-02 3 1  ON 50
ci_002                -3.016491e-02 3 1  ON 51
ci_003                -2.507311e-02 3 1  ON 52
ci_004                 2.111220e-02 3 1  ON 53
ci_005                 2.113445e-02 3 1  ON 54
ci_006                -1.943370e-02 3 1  ON 55
ci_007                -1.880570e-02 3 1  ON 56
ci_008                -1.774318e-02 3 1  ON 57
ci_009                -1.805569e-02 3 1  ON 58
ci_010                -1.730281e-02 3 1  ON 59
ci_011                -1.626600e-02 3 1  ON 60
ci_012                -1.614721e-02 3 1  ON 61
ci_013                -1.921622e-02 3 1  ON 62
ci_014                 1.385472e-02 3 1  ON 63
ci_015                 1.356502e-02 3 1  ON 64
ci_016                 1.626456e-02 3 1  ON 65
ci_017                 1.653408e-02 3 1  ON 66
ci_018                 1.263035e-02 3 1  ON 67
ci_019                 1.309185e-02 3 1  ON 68
ci_020                 1.328148e-02 3 1  ON 69
ci_021                 1.336538e-02 3 1  ON 70
ci_022                 1.114526e-02 3 1  ON 71
ci_023                 1.122677e-02 3 1  ON 72
ci_024                 1.228186e-02 3 1  ON 73
ci_025                 1.155259e-02 3 1  ON 74
ci_026                 1.090673e-02 3 1  ON 75
ci_027                 1.132472e-02 3 1  ON 76
ci_028                -1.426197e-02 3 1  ON 77
ci_029                -1.490783e-02 3 1  ON 78
ci_030                -1.110736e-02 3 1  ON 79
ci_031                -1.141187e-02 3 1  ON 80
ci_032                -1.348848e-02 3 1  ON 81
ci_033                 1.065813e-02 3 1  ON 82
ci_034                 1.063480e-02 3 1  ON 83
ci_035                -4.704007e-03 3 1  ON 84
ci_036                -1.040379e-02 3 1  ON 85
ci_037                -1.005815e-02 3 1  ON 86
ci_038                 1.872432e-03 3 1  ON 87
ci_039                 1.473198e-03 3 1  ON 88
ci_040                -4.066144e-03 3 1  ON 89
ci_041                 9.804073e-03 3 1  ON 90
ci_042                 9.856361e-03 3 1  ON 91
ci_043                -2.929561e-03 3 1  ON 92
ci_044                -1.514700e-02 3 1  ON 93
ci_045                -1.825193e-03 3 1  ON 94
ci_046                 5.708096e-03 3 1  ON 95
ci_047                 5.452872e-03 3 1  ON 96
ci_048                -1.169093e-02 3 1  ON 97
ci_049                -1.200828e-02 3 1  ON 98
ci_050                 7.412652e-03 3 1  ON 99
ci_051                 7.765491e-03 3 1  ON 100
ci_052                -6.441008e-03 3 1  ON 101
ci_053                -6.307036e-03 3 1  ON 102
ci_054                -3.216982e-03 3 1  ON 103
ci_055                -3.042553e-03 3 1  ON 104
ci_056                 4.495752e-03 3 1  ON 105
ci_057                 4.397863e-03 3 1  ON 106
ci_058                -6.795388e-03 3 1  ON 107
ci_059                -6.377627e-03 3 1  ON 108
ci_060                 8.242786e-03 3 1  ON 109
ci_061                 7.908348e-03 3 1  ON 110
ci_062                -3.256174e-03 3 1  ON 111
ci_063                -2.908101e-03 3 1  ON 112
ci_064                -3.133488e-03 3 1  ON 113
ci_065                -4.350354e-03 3 1  ON 114
ci_066                 5.564982e-03 3 1  ON 115
ci_067                 5.749605e-03 3 1  ON 116
ci_068                -4.597324e-03 3 1  ON 117
ci_069                -4.608413e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.1814
    reference variance = 0.267566
====================================================
  Execution time = 3.7054e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1531e-01
  Total weights = 1.9562e+06
  Execution time = 3.3526e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300391454964
                                         uncertainty =       0.002205494822

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300391454964
                                         uncertainty =       0.002205494822

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387678585
  error estimate for blocks of size 2^( 2) =       0.000397624858
  error estimate for blocks of size 2^( 3) =       0.000406627714
  error estimate for blocks of size 2^( 4) =       0.000412928951
  error estimate for blocks of size 2^( 5) =       0.000416688733
  error estimate for blocks of size 2^( 6) =       0.000418058058
  error estimate for blocks of size 2^( 7) =       0.000418572174

      target function =                  N/A
              le_mean =     -17.216572524872
             les_mean =     296.725678344921
             stat err =       0.000416561979
             autocorr =       1.154557677804
              std dev =       0.548260312154
             le_variance =       0.300589369883

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300391451307
                                         uncertainty =       0.002205495221

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300391451307
                                         uncertainty =       0.002205495221

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387678582
  error estimate for blocks of size 2^( 2) =       0.000397624854
  error estimate for blocks of size 2^( 3) =       0.000406627710
  error estimate for blocks of size 2^( 4) =       0.000412928946
  error estimate for blocks of size 2^( 5) =       0.000416688730
  error estimate for blocks of size 2^( 6) =       0.000418058053
  error estimate for blocks of size 2^( 7) =       0.000418572169

      target function =                  N/A
              le_mean =     -17.216572525807
             les_mean =     296.725678066372
             stat err =       0.000416561975
             autocorr =       1.154557671746
              std dev =       0.548260307847
             le_variance =       0.300589365161

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300391453134
                                         uncertainty =       0.002205495021

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300391453134
                                         uncertainty =       0.002205495021

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387678583
  error estimate for blocks of size 2^( 2) =       0.000397624856
  error estimate for blocks of size 2^( 3) =       0.000406627712
  error estimate for blocks of size 2^( 4) =       0.000412928949
  error estimate for blocks of size 2^( 5) =       0.000416688731
  error estimate for blocks of size 2^( 6) =       0.000418058056
  error estimate for blocks of size 2^( 7) =       0.000418572172

      target function =                  N/A
              le_mean =     -17.216572525339
             les_mean =     296.725678205088
             stat err =       0.000416561977
             autocorr =       1.154557674785
              std dev =       0.548260310000
             le_variance =       0.300589367521

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300391454735
                                         uncertainty =       0.002205494847

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300391454735
                                         uncertainty =       0.002205494847

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387678584
  error estimate for blocks of size 2^( 2) =       0.000397624858
  error estimate for blocks of size 2^( 3) =       0.000406627714
  error estimate for blocks of size 2^( 4) =       0.000412928951
  error estimate for blocks of size 2^( 5) =       0.000416688733
  error estimate for blocks of size 2^( 6) =       0.000418058058
  error estimate for blocks of size 2^( 7) =       0.000418572174

      target function =                  N/A
              le_mean =     -17.216572524930
             les_mean =     296.725678327382
             stat err =       0.000416561979
             autocorr =       1.154557677427
              std dev =       0.548260311885
             le_variance =       0.300589369588


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216572524872        initial
     3.8147e+03     3.8147e+04             2.0204e-07       -17.216572525807  <--
     1.5259e+04     1.5259e+05             5.0511e-08       -17.216572525339
     6.1035e+04     6.1035e+05             1.2628e-08       -17.216572524930

*****************************************************************************
Applying the update for shift_i =   3.8147e+03     and shift_s =   3.8147e+04
*****************************************************************************

  Execution time = 5.4015e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
  uu_0                 2.061948e-01 1 1  ON 0
  uu_1                 4.539102e-02 1 1  ON 1
  uu_2                -4.680485e-02 1 1  ON 2
  uu_3                -9.936277e-02 1 1  ON 3
  uu_4                -1.304446e-01 1 1  ON 4
  uu_5                -1.356414e-01 1 1  ON 5
  uu_6                -1.130358e-01 1 1  ON 6
  uu_7                -3.972326e-02 1 1  ON 7
  uu_8                 9.988708e-02 1 1  ON 8
  uu_9                 1.208932e-01 1 1  ON 9
  ud_0                 3.495798e-01 1 1  ON 10
  ud_1                 9.178556e-02 1 1  ON 11
  ud_2                -1.648762e-02 1 1  ON 12
  ud_3                -7.596333e-02 1 1  ON 13
  ud_4                -1.217523e-01 1 1  ON 14
  ud_5                -1.523213e-01 1 1  ON 15
  ud_6                -1.544623e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463335e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504325e-01 1 1  ON 20
  eO_1                -4.354960e-01 1 1  ON 21
  eO_2                -3.598276e-02 1 1  ON 22
  eO_3                 2.081609e-01 1 1  ON 23
  eO_4                 2.891475e-01 1 1  ON 24
  eO_5                 3.052705e-01 1 1  ON 25
  eO_6                 2.501147e-01 1 1  ON 26
  eO_7                 1.121836e-01 1 1  ON 27
  eO_8                 2.793059e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027127e-01 1 1  ON 31
 eH1_2                -6.202953e-02 1 1  ON 32
 eH1_3                -2.594632e-02 1 1  ON 33
 eH1_4                 1.931585e-02 1 1  ON 34
 eH1_5                 3.552901e-02 1 1  ON 35
 eH1_6                 7.728063e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073794e-02 1 1  ON 38
 eH1_9                 2.428774e-02 1 1  ON 39
 eH2_0                -1.835287e-01 1 1  ON 40
 eH2_1                -1.038379e-01 1 1  ON 41
 eH2_2                -6.350530e-02 1 1  ON 42
 eH2_3                -2.706104e-02 1 1  ON 43
 eH2_4                 1.856795e-02 1 1  ON 44
 eH2_5                 3.504981e-02 1 1  ON 45
 eH2_6                 7.827827e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397361e-02 1 1  ON 48
 eH2_9                 2.639277e-02 1 1  ON 49
ci_001                -3.996263e-02 3 1  ON 50
ci_002                -3.016489e-02 3 1  ON 51
ci_003                -2.507315e-02 3 1  ON 52
ci_004                 2.111225e-02 3 1  ON 53
ci_005                 2.113444e-02 3 1  ON 54
ci_006                -1.943369e-02 3 1  ON 55
ci_007                -1.880567e-02 3 1  ON 56
ci_008                -1.774318e-02 3 1  ON 57
ci_009                -1.805570e-02 3 1  ON 58
ci_010                -1.730279e-02 3 1  ON 59
ci_011                -1.626598e-02 3 1  ON 60
ci_012                -1.614715e-02 3 1  ON 61
ci_013                -1.921622e-02 3 1  ON 62
ci_014                 1.385476e-02 3 1  ON 63
ci_015                 1.356506e-02 3 1  ON 64
ci_016                 1.626455e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263038e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328145e-02 3 1  ON 69
ci_021                 1.336536e-02 3 1  ON 70
ci_022                 1.114527e-02 3 1  ON 71
ci_023                 1.122682e-02 3 1  ON 72
ci_024                 1.228187e-02 3 1  ON 73
ci_025                 1.155257e-02 3 1  ON 74
ci_026                 1.090671e-02 3 1  ON 75
ci_027                 1.132476e-02 3 1  ON 76
ci_028                -1.426197e-02 3 1  ON 77
ci_029                -1.490779e-02 3 1  ON 78
ci_030                -1.110734e-02 3 1  ON 79
ci_031                -1.141187e-02 3 1  ON 80
ci_032                -1.348846e-02 3 1  ON 81
ci_033                 1.065813e-02 3 1  ON 82
ci_034                 1.063475e-02 3 1  ON 83
ci_035                -4.703981e-03 3 1  ON 84
ci_036                -1.040382e-02 3 1  ON 85
ci_037                -1.005818e-02 3 1  ON 86
ci_038                 1.872420e-03 3 1  ON 87
ci_039                 1.473201e-03 3 1  ON 88
ci_040                -4.066119e-03 3 1  ON 89
ci_041                 9.804041e-03 3 1  ON 90
ci_042                 9.856327e-03 3 1  ON 91
ci_043                -2.929556e-03 3 1  ON 92
ci_044                -1.514696e-02 3 1  ON 93
ci_045                -1.825188e-03 3 1  ON 94
ci_046                 5.708076e-03 3 1  ON 95
ci_047                 5.452861e-03 3 1  ON 96
ci_048                -1.169096e-02 3 1  ON 97
ci_049                -1.200831e-02 3 1  ON 98
ci_050                 7.412659e-03 3 1  ON 99
ci_051                 7.765447e-03 3 1  ON 100
ci_052                -6.441025e-03 3 1  ON 101
ci_053                -6.307073e-03 3 1  ON 102
ci_054                -3.216943e-03 3 1  ON 103
ci_055                -3.042556e-03 3 1  ON 104
ci_056                 4.495758e-03 3 1  ON 105
ci_057                 4.397841e-03 3 1  ON 106
ci_058                -6.795389e-03 3 1  ON 107
ci_059                -6.377617e-03 3 1  ON 108
ci_060                 8.242781e-03 3 1  ON 109
ci_061                 7.908395e-03 3 1  ON 110
ci_062                -3.256161e-03 3 1  ON 111
ci_063                -2.908114e-03 3 1  ON 112
ci_064                -3.133489e-03 3 1  ON 113
ci_065                -4.350308e-03 3 1  ON 114
ci_066                 5.564996e-03 3 1  ON 115
ci_067                 5.749596e-03 3 1  ON 116
ci_068                -4.597320e-03 3 1  ON 117
ci_069                -4.608453e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0309e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.1802
    reference variance = 0.270457
====================================================
  Execution time = 3.7636e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5271e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1219e-01
  Total weights = 1.956543316e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1011e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297487325043
                                         uncertainty =       0.001625665002

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297487325043
                                         uncertainty =       0.001625665002

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385671800
  error estimate for blocks of size 2^( 2) =       0.000395259118
  error estimate for blocks of size 2^( 3) =       0.000404390481
  error estimate for blocks of size 2^( 4) =       0.000411187752
  error estimate for blocks of size 2^( 5) =       0.000414964228
  error estimate for blocks of size 2^( 6) =       0.000418401388
  error estimate for blocks of size 2^( 7) =       0.000419584162

      target function =                  N/A
              le_mean =     -17.216792026849
             les_mean =     296.730122119402
             stat err =       0.000416034382
             autocorr =       1.163650811448
              std dev =       0.545422290776
             le_variance =       0.297485475275


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721679202685e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+02, overlap shift 9.5367e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216792026897       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216792032419       residual = 7.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216792032834       residual = 3.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216792033240       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216792033866       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216792034592       residual = 6.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216792034500       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216792034930       residual = 6.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216792034965       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216792034930       residual = 4.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+02 is 6.803990e-07

solving harmonic davidson linear method for identity shift 3.8147e+03, overlap shift 3.8147e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216792026897       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216792028278       residual = 7.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216792028382       residual = 3.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216792028483       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216792028639       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216792028822       residual = 6.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216792028791       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216792028908       residual = 6.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216792028923       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216792028910       residual = 4.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.8147e+03 is 1.701028e-07

solving harmonic davidson linear method for identity shift 1.5259e+04, overlap shift 1.5259e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216792026897       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216792027242       residual = 7.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216792027268       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216792027294       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216792027330       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216792027303       residual = 6.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216792027313       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216792027394       residual = 6.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216792027427       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216792027359       residual = 4.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5259e+04 is 4.252588e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.212354 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8659e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
  uu_0                 2.061948e-01 1 1  ON 0
  uu_1                 4.539105e-02 1 1  ON 1
  uu_2                -4.680484e-02 1 1  ON 2
  uu_3                -9.936276e-02 1 1  ON 3
  uu_4                -1.304447e-01 1 1  ON 4
  uu_5                -1.356414e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972330e-02 1 1  ON 7
  uu_8                 9.988705e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495799e-01 1 1  ON 10
  ud_1                 9.178559e-02 1 1  ON 11
  ud_2                -1.648761e-02 1 1  ON 12
  ud_3                -7.596334e-02 1 1  ON 13
  ud_4                -1.217523e-01 1 1  ON 14
  ud_5                -1.523213e-01 1 1  ON 15
  ud_6                -1.544623e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463299e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504327e-01 1 1  ON 20
  eO_1                -4.354962e-01 1 1  ON 21
  eO_2                -3.598282e-02 1 1  ON 22
  eO_3                 2.081610e-01 1 1  ON 23
  eO_4                 2.891476e-01 1 1  ON 24
  eO_5                 3.052706e-01 1 1  ON 25
  eO_6                 2.501147e-01 1 1  ON 26
  eO_7                 1.121836e-01 1 1  ON 27
  eO_8                 2.793059e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027127e-01 1 1  ON 31
 eH1_2                -6.202959e-02 1 1  ON 32
 eH1_3                -2.594630e-02 1 1  ON 33
 eH1_4                 1.931585e-02 1 1  ON 34
 eH1_5                 3.552901e-02 1 1  ON 35
 eH1_6                 7.728064e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073795e-02 1 1  ON 38
 eH1_9                 2.428775e-02 1 1  ON 39
 eH2_0                -1.835288e-01 1 1  ON 40
 eH2_1                -1.038379e-01 1 1  ON 41
 eH2_2                -6.350528e-02 1 1  ON 42
 eH2_3                -2.706105e-02 1 1  ON 43
 eH2_4                 1.856797e-02 1 1  ON 44
 eH2_5                 3.504983e-02 1 1  ON 45
 eH2_6                 7.827828e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397362e-02 1 1  ON 48
 eH2_9                 2.639277e-02 1 1  ON 49
ci_001                -3.996260e-02 3 1  ON 50
ci_002                -3.016484e-02 3 1  ON 51
ci_003                -2.507309e-02 3 1  ON 52
ci_004                 2.111226e-02 3 1  ON 53
ci_005                 2.113444e-02 3 1  ON 54
ci_006                -1.943370e-02 3 1  ON 55
ci_007                -1.880568e-02 3 1  ON 56
ci_008                -1.774323e-02 3 1  ON 57
ci_009                -1.805560e-02 3 1  ON 58
ci_010                -1.730276e-02 3 1  ON 59
ci_011                -1.626602e-02 3 1  ON 60
ci_012                -1.614712e-02 3 1  ON 61
ci_013                -1.921617e-02 3 1  ON 62
ci_014                 1.385478e-02 3 1  ON 63
ci_015                 1.356501e-02 3 1  ON 64
ci_016                 1.626461e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263036e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328141e-02 3 1  ON 69
ci_021                 1.336535e-02 3 1  ON 70
ci_022                 1.114533e-02 3 1  ON 71
ci_023                 1.122683e-02 3 1  ON 72
ci_024                 1.228181e-02 3 1  ON 73
ci_025                 1.155258e-02 3 1  ON 74
ci_026                 1.090676e-02 3 1  ON 75
ci_027                 1.132475e-02 3 1  ON 76
ci_028                -1.426200e-02 3 1  ON 77
ci_029                -1.490779e-02 3 1  ON 78
ci_030                -1.110727e-02 3 1  ON 79
ci_031                -1.141189e-02 3 1  ON 80
ci_032                -1.348843e-02 3 1  ON 81
ci_033                 1.065817e-02 3 1  ON 82
ci_034                 1.063472e-02 3 1  ON 83
ci_035                -4.703997e-03 3 1  ON 84
ci_036                -1.040377e-02 3 1  ON 85
ci_037                -1.005819e-02 3 1  ON 86
ci_038                 1.872369e-03 3 1  ON 87
ci_039                 1.473233e-03 3 1  ON 88
ci_040                -4.066122e-03 3 1  ON 89
ci_041                 9.804017e-03 3 1  ON 90
ci_042                 9.856373e-03 3 1  ON 91
ci_043                -2.929550e-03 3 1  ON 92
ci_044                -1.514692e-02 3 1  ON 93
ci_045                -1.825131e-03 3 1  ON 94
ci_046                 5.708039e-03 3 1  ON 95
ci_047                 5.452871e-03 3 1  ON 96
ci_048                -1.169096e-02 3 1  ON 97
ci_049                -1.200826e-02 3 1  ON 98
ci_050                 7.412652e-03 3 1  ON 99
ci_051                 7.765490e-03 3 1  ON 100
ci_052                -6.441067e-03 3 1  ON 101
ci_053                -6.307075e-03 3 1  ON 102
ci_054                -3.216916e-03 3 1  ON 103
ci_055                -3.042589e-03 3 1  ON 104
ci_056                 4.495741e-03 3 1  ON 105
ci_057                 4.397818e-03 3 1  ON 106
ci_058                -6.795377e-03 3 1  ON 107
ci_059                -6.377634e-03 3 1  ON 108
ci_060                 8.242739e-03 3 1  ON 109
ci_061                 7.908511e-03 3 1  ON 110
ci_062                -3.256146e-03 3 1  ON 111
ci_063                -2.908127e-03 3 1  ON 112
ci_064                -3.133425e-03 3 1  ON 113
ci_065                -4.350266e-03 3 1  ON 114
ci_066                 5.564987e-03 3 1  ON 115
ci_067                 5.749569e-03 3 1  ON 116
ci_068                -4.597332e-03 3 1  ON 117
ci_069                -4.608453e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.2194
    reference variance = 0.15438
====================================================
  Execution time = 3.7256e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.0911e-01
  Total weights = 1.9565e+06
  Execution time = 3.3394e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296263320506
                                         uncertainty =       0.001969016503

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296263320506
                                         uncertainty =       0.001969016503

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384827055
  error estimate for blocks of size 2^( 2) =       0.000394710766
  error estimate for blocks of size 2^( 3) =       0.000403774976
  error estimate for blocks of size 2^( 4) =       0.000410000138
  error estimate for blocks of size 2^( 5) =       0.000413404588
  error estimate for blocks of size 2^( 6) =       0.000416180862
  error estimate for blocks of size 2^( 7) =       0.000419611818

      target function =                  N/A
              le_mean =     -17.216611622732
             les_mean =     296.720825350501
             stat err =       0.000414799351
             autocorr =       1.161836302977
              std dev =       0.544227640596
             le_variance =       0.296183724788

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296263582902
                                         uncertainty =       0.001969016369

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296263582902
                                         uncertainty =       0.001969016369

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384827226
  error estimate for blocks of size 2^( 2) =       0.000394710928
  error estimate for blocks of size 2^( 3) =       0.000403775133
  error estimate for blocks of size 2^( 4) =       0.000410000297
  error estimate for blocks of size 2^( 5) =       0.000413404740
  error estimate for blocks of size 2^( 6) =       0.000416181016
  error estimate for blocks of size 2^( 7) =       0.000419611980

      target function =                  N/A
              le_mean =     -17.216611625036
             les_mean =     296.720826516665
             stat err =       0.000414799508
             autocorr =       1.161836152835
              std dev =       0.544227881533
             le_variance =       0.296183987038

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296263451727
                                         uncertainty =       0.001969016436

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296263451727
                                         uncertainty =       0.001969016436

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384827140
  error estimate for blocks of size 2^( 2) =       0.000394710847
  error estimate for blocks of size 2^( 3) =       0.000403775054
  error estimate for blocks of size 2^( 4) =       0.000410000218
  error estimate for blocks of size 2^( 5) =       0.000413404664
  error estimate for blocks of size 2^( 6) =       0.000416180939
  error estimate for blocks of size 2^( 7) =       0.000419611899

      target function =                  N/A
              le_mean =     -17.216611623884
             les_mean =     296.720825929593
             stat err =       0.000414799430
             autocorr =       1.161836227900
              std dev =       0.544227761085
             le_variance =       0.296183855936

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296263336909
                                         uncertainty =       0.001969016494

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296263336909
                                         uncertainty =       0.001969016494

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384827066
  error estimate for blocks of size 2^( 2) =       0.000394710776
  error estimate for blocks of size 2^( 3) =       0.000403774985
  error estimate for blocks of size 2^( 4) =       0.000410000148
  error estimate for blocks of size 2^( 5) =       0.000413404597
  error estimate for blocks of size 2^( 6) =       0.000416180872
  error estimate for blocks of size 2^( 7) =       0.000419611828

      target function =                  N/A
              le_mean =     -17.216611622876
             les_mean =     296.720825422430
             stat err =       0.000414799361
             autocorr =       1.161836293590
              std dev =       0.544227655657
             le_variance =       0.296183741182


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216611622732        initial
     9.5367e+02     9.5367e+03             6.8040e-07       -17.216611625036  <--
     3.8147e+03     3.8147e+04             1.7010e-07       -17.216611623884
     1.5259e+04     1.5259e+05             4.2526e-08       -17.216611622876

*****************************************************************************
Applying the update for shift_i =   9.5367e+02     and shift_s =   9.5367e+03
*****************************************************************************

  Execution time = 5.4153e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539116e-02 1 1  ON 1
  uu_2                -4.680482e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988697e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495800e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596334e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463191e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052707e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202977e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931584e-02 1 1  ON 34
 eH1_5                 3.552904e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350522e-02 1 1  ON 42
 eH2_3                -2.706108e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996250e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507291e-02 3 1  ON 52
ci_004                 2.111231e-02 3 1  ON 53
ci_005                 2.113443e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880570e-02 3 1  ON 56
ci_008                -1.774338e-02 3 1  ON 57
ci_009                -1.805529e-02 3 1  ON 58
ci_010                -1.730268e-02 3 1  ON 59
ci_011                -1.626616e-02 3 1  ON 60
ci_012                -1.614702e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385482e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626480e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309170e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155262e-02 3 1  ON 74
ci_026                 1.090692e-02 3 1  ON 75
ci_027                 1.132472e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110704e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704044e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872214e-03 3 1  ON 87
ci_039                 1.473327e-03 3 1  ON 88
ci_040                -4.066131e-03 3 1  ON 89
ci_041                 9.803945e-03 3 1  ON 90
ci_042                 9.856510e-03 3 1  ON 91
ci_043                -2.929531e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824961e-03 3 1  ON 94
ci_046                 5.707929e-03 3 1  ON 95
ci_047                 5.452902e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200811e-02 3 1  ON 98
ci_050                 7.412630e-03 3 1  ON 99
ci_051                 7.765617e-03 3 1  ON 100
ci_052                -6.441193e-03 3 1  ON 101
ci_053                -6.307081e-03 3 1  ON 102
ci_054                -3.216836e-03 3 1  ON 103
ci_055                -3.042690e-03 3 1  ON 104
ci_056                 4.495689e-03 3 1  ON 105
ci_057                 4.397749e-03 3 1  ON 106
ci_058                -6.795340e-03 3 1  ON 107
ci_059                -6.377684e-03 3 1  ON 108
ci_060                 8.242615e-03 3 1  ON 109
ci_061                 7.908858e-03 3 1  ON 110
ci_062                -3.256100e-03 3 1  ON 111
ci_063                -2.908165e-03 3 1  ON 112
ci_064                -3.133232e-03 3 1  ON 113
ci_065                -4.350140e-03 3 1  ON 114
ci_066                 5.564959e-03 3 1  ON 115
ci_067                 5.749490e-03 3 1  ON 116
ci_068                -4.597366e-03 3 1  ON 117
ci_069                -4.608454e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0282e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.2301
    reference variance = 0.164773
====================================================
  Execution time = 3.7802e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5298e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.0982e-01
  Total weights = 1.956464083e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0960e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296397110614
                                         uncertainty =       0.001813101893

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296397110614
                                         uncertainty =       0.001813101893

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385003919
  error estimate for blocks of size 2^( 2) =       0.000394654903
  error estimate for blocks of size 2^( 3) =       0.000404226519
  error estimate for blocks of size 2^( 4) =       0.000409818672
  error estimate for blocks of size 2^( 5) =       0.000413410998
  error estimate for blocks of size 2^( 6) =       0.000415228803
  error estimate for blocks of size 2^( 7) =       0.000415859284

      target function =                  N/A
              le_mean =     -17.216605922299
             les_mean =     296.721340559156
             stat err =       0.000413579439
             autocorr =       1.153951560444
              std dev =       0.544477764251
             le_variance =       0.296456035764


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721660592230e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+02, overlap shift 2.3842e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216605922339       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216605953507       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216605957258       residual = 3.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216605959793       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216605958658       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216605957817       residual = 5.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216605958196       residual = 9.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216605958640       residual = 2.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216605958747       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216605958542       residual = 4.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3842e+02 is 2.945631e-06

solving harmonic davidson linear method for identity shift 9.5367e+02, overlap shift 9.5367e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216605922339       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216605930136       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216605931075       residual = 3.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216605931709       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216605931424       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216605931213       residual = 5.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216605931308       residual = 9.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216605931418       residual = 2.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216605931444       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216605931397       residual = 4.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+02 is 7.364282e-07

solving harmonic davidson linear method for identity shift 3.8147e+03, overlap shift 3.8147e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216605922339       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216605924288       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216605924523       residual = 3.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216605924682       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216605924611       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216605924556       residual = 5.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216605924582       residual = 9.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216605924617       residual = 2.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216605924604       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216605924597       residual = 4.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.8147e+03 is 1.841083e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.216288 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8775e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
  uu_0                 2.061952e-01 1 1  ON 0
  uu_1                 4.539132e-02 1 1  ON 1
  uu_2                -4.680480e-02 1 1  ON 2
  uu_3                -9.936271e-02 1 1  ON 3
  uu_4                -1.304450e-01 1 1  ON 4
  uu_5                -1.356414e-01 1 1  ON 5
  uu_6                -1.130358e-01 1 1  ON 6
  uu_7                -3.972364e-02 1 1  ON 7
  uu_8                 9.988686e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495804e-01 1 1  ON 10
  ud_1                 9.178575e-02 1 1  ON 11
  ud_2                -1.648752e-02 1 1  ON 12
  ud_3                -7.596328e-02 1 1  ON 13
  ud_4                -1.217526e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544625e-01 1 1  ON 16
  ud_7                -1.100036e-01 1 1  ON 17
  ud_8                 4.463038e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504339e-01 1 1  ON 20
  eO_1                -4.354971e-01 1 1  ON 21
  eO_2                -3.598318e-02 1 1  ON 22
  eO_3                 2.081616e-01 1 1  ON 23
  eO_4                 2.891488e-01 1 1  ON 24
  eO_5                 3.052709e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121838e-01 1 1  ON 27
  eO_8                 2.793061e-02 1 1  ON 28
  eO_9                 1.846824e-02 1 1  ON 29
 eH1_0                -1.820115e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202979e-02 1 1  ON 32
 eH1_3                -2.594623e-02 1 1  ON 33
 eH1_4                 1.931587e-02 1 1  ON 34
 eH1_5                 3.552910e-02 1 1  ON 35
 eH1_6                 7.728067e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073807e-02 1 1  ON 38
 eH1_9                 2.428778e-02 1 1  ON 39
 eH2_0                -1.835288e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350517e-02 1 1  ON 42
 eH2_3                -2.706112e-02 1 1  ON 43
 eH2_4                 1.856798e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827828e-02 1 1  ON 46
 eH2_7                 1.134120e-01 1 1  ON 47
 eH2_8                 9.397372e-02 1 1  ON 48
 eH2_9                 2.639281e-02 1 1  ON 49
ci_001                -3.996262e-02 3 1  ON 50
ci_002                -3.016481e-02 3 1  ON 51
ci_003                -2.507278e-02 3 1  ON 52
ci_004                 2.111228e-02 3 1  ON 53
ci_005                 2.113440e-02 3 1  ON 54
ci_006                -1.943346e-02 3 1  ON 55
ci_007                -1.880581e-02 3 1  ON 56
ci_008                -1.774346e-02 3 1  ON 57
ci_009                -1.805504e-02 3 1  ON 58
ci_010                -1.730261e-02 3 1  ON 59
ci_011                -1.626599e-02 3 1  ON 60
ci_012                -1.614717e-02 3 1  ON 61
ci_013                -1.921582e-02 3 1  ON 62
ci_014                 1.385463e-02 3 1  ON 63
ci_015                 1.356512e-02 3 1  ON 64
ci_016                 1.626489e-02 3 1  ON 65
ci_017                 1.653424e-02 3 1  ON 66
ci_018                 1.263022e-02 3 1  ON 67
ci_019                 1.309164e-02 3 1  ON 68
ci_020                 1.328120e-02 3 1  ON 69
ci_021                 1.336512e-02 3 1  ON 70
ci_022                 1.114558e-02 3 1  ON 71
ci_023                 1.122700e-02 3 1  ON 72
ci_024                 1.228214e-02 3 1  ON 73
ci_025                 1.155250e-02 3 1  ON 74
ci_026                 1.090695e-02 3 1  ON 75
ci_027                 1.132506e-02 3 1  ON 76
ci_028                -1.426204e-02 3 1  ON 77
ci_029                -1.490774e-02 3 1  ON 78
ci_030                -1.110696e-02 3 1  ON 79
ci_031                -1.141186e-02 3 1  ON 80
ci_032                -1.348842e-02 3 1  ON 81
ci_033                 1.065817e-02 3 1  ON 82
ci_034                 1.063482e-02 3 1  ON 83
ci_035                -4.704033e-03 3 1  ON 84
ci_036                -1.040365e-02 3 1  ON 85
ci_037                -1.005835e-02 3 1  ON 86
ci_038                 1.872084e-03 3 1  ON 87
ci_039                 1.473187e-03 3 1  ON 88
ci_040                -4.066124e-03 3 1  ON 89
ci_041                 9.803680e-03 3 1  ON 90
ci_042                 9.856645e-03 3 1  ON 91
ci_043                -2.929557e-03 3 1  ON 92
ci_044                -1.514669e-02 3 1  ON 93
ci_045                -1.824983e-03 3 1  ON 94
ci_046                 5.707982e-03 3 1  ON 95
ci_047                 5.452900e-03 3 1  ON 96
ci_048                -1.169068e-02 3 1  ON 97
ci_049                -1.200805e-02 3 1  ON 98
ci_050                 7.412877e-03 3 1  ON 99
ci_051                 7.765458e-03 3 1  ON 100
ci_052                -6.441126e-03 3 1  ON 101
ci_053                -6.307131e-03 3 1  ON 102
ci_054                -3.216779e-03 3 1  ON 103
ci_055                -3.042708e-03 3 1  ON 104
ci_056                 4.495607e-03 3 1  ON 105
ci_057                 4.397824e-03 3 1  ON 106
ci_058                -6.795334e-03 3 1  ON 107
ci_059                -6.377945e-03 3 1  ON 108
ci_060                 8.242875e-03 3 1  ON 109
ci_061                 7.908931e-03 3 1  ON 110
ci_062                -3.255818e-03 3 1  ON 111
ci_063                -2.908041e-03 3 1  ON 112
ci_064                -3.133270e-03 3 1  ON 113
ci_065                -4.350005e-03 3 1  ON 114
ci_066                 5.564773e-03 3 1  ON 115
ci_067                 5.749427e-03 3 1  ON 116
ci_068                -4.597510e-03 3 1  ON 117
ci_069                -4.608620e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.2322
    reference variance = 0.264935
====================================================
  Execution time = 3.7643e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1673e-01
  Total weights = 1.9567e+06
  Execution time = 3.3685e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298856650564
                                         uncertainty =       0.001940529231

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298856650564
                                         uncertainty =       0.001940529231

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386567480
  error estimate for blocks of size 2^( 2) =       0.000396476148
  error estimate for blocks of size 2^( 3) =       0.000404935868
  error estimate for blocks of size 2^( 4) =       0.000412306421
  error estimate for blocks of size 2^( 5) =       0.000416738858
  error estimate for blocks of size 2^( 6) =       0.000419768700
  error estimate for blocks of size 2^( 7) =       0.000420864713

      target function =                  N/A
              le_mean =     -17.216904159415
             les_mean =     296.738516111063
             stat err =       0.000417419673
             autocorr =       1.165990988067
              std dev =       0.546688973316
             le_variance =       0.298868833545

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298858223133
                                         uncertainty =       0.001940557275

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298858223133
                                         uncertainty =       0.001940557275

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386568499
  error estimate for blocks of size 2^( 2) =       0.000396477117
  error estimate for blocks of size 2^( 3) =       0.000404936768
  error estimate for blocks of size 2^( 4) =       0.000412307270
  error estimate for blocks of size 2^( 5) =       0.000416739630
  error estimate for blocks of size 2^( 6) =       0.000419769461
  error estimate for blocks of size 2^( 7) =       0.000420865460

      target function =                  N/A
              le_mean =     -17.216904147946
             les_mean =     296.738518382439
             stat err =       0.000417420455
             autocorr =       1.165989212931
              std dev =       0.546690414069
             le_variance =       0.298870408835

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298857437419
                                         uncertainty =       0.001940543247

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298857437419
                                         uncertainty =       0.001940543247

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386567990
  error estimate for blocks of size 2^( 2) =       0.000396476633
  error estimate for blocks of size 2^( 3) =       0.000404936318
  error estimate for blocks of size 2^( 4) =       0.000412306846
  error estimate for blocks of size 2^( 5) =       0.000416739244
  error estimate for blocks of size 2^( 6) =       0.000419769081
  error estimate for blocks of size 2^( 7) =       0.000420865087

      target function =                  N/A
              le_mean =     -17.216904153656
             les_mean =     296.738517238493
             stat err =       0.000417420064
             autocorr =       1.165990099747
              std dev =       0.546689694216
             le_variance =       0.298869621762

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298856748924
                                         uncertainty =       0.001940530981

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298856748924
                                         uncertainty =       0.001940530981

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386567544
  error estimate for blocks of size 2^( 2) =       0.000396476209
  error estimate for blocks of size 2^( 3) =       0.000404935924
  error estimate for blocks of size 2^( 4) =       0.000412306474
  error estimate for blocks of size 2^( 5) =       0.000416738906
  error estimate for blocks of size 2^( 6) =       0.000419768747
  error estimate for blocks of size 2^( 7) =       0.000420864760

      target function =                  N/A
              le_mean =     -17.216904158693
             les_mean =     296.738516250999
             stat err =       0.000417419722
             autocorr =       1.165990877008
              std dev =       0.546689063431
             le_variance =       0.298868932075


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216904159415        initial  <--
     2.3842e+02     2.3842e+03             2.9456e-06       -17.216904147946
     9.5367e+02     9.5367e+03             7.3643e-07       -17.216904153656
     3.8147e+03     3.8147e+04             1.8411e-07       -17.216904158693

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 54.6772
  </log>
  <optVariables href="H2O.s019.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539116e-02 1 1  ON 1
  uu_2                -4.680482e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988697e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495800e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596334e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463191e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052707e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202977e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931584e-02 1 1  ON 34
 eH1_5                 3.552904e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350522e-02 1 1  ON 42
 eH2_3                -2.706108e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996250e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507291e-02 3 1  ON 52
ci_004                 2.111231e-02 3 1  ON 53
ci_005                 2.113443e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880570e-02 3 1  ON 56
ci_008                -1.774338e-02 3 1  ON 57
ci_009                -1.805529e-02 3 1  ON 58
ci_010                -1.730268e-02 3 1  ON 59
ci_011                -1.626616e-02 3 1  ON 60
ci_012                -1.614702e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385482e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626480e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309170e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155262e-02 3 1  ON 74
ci_026                 1.090692e-02 3 1  ON 75
ci_027                 1.132472e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110704e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704044e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872214e-03 3 1  ON 87
ci_039                 1.473327e-03 3 1  ON 88
ci_040                -4.066131e-03 3 1  ON 89
ci_041                 9.803945e-03 3 1  ON 90
ci_042                 9.856510e-03 3 1  ON 91
ci_043                -2.929531e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824961e-03 3 1  ON 94
ci_046                 5.707929e-03 3 1  ON 95
ci_047                 5.452902e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200811e-02 3 1  ON 98
ci_050                 7.412630e-03 3 1  ON 99
ci_051                 7.765617e-03 3 1  ON 100
ci_052                -6.441193e-03 3 1  ON 101
ci_053                -6.307081e-03 3 1  ON 102
ci_054                -3.216836e-03 3 1  ON 103
ci_055                -3.042690e-03 3 1  ON 104
ci_056                 4.495689e-03 3 1  ON 105
ci_057                 4.397749e-03 3 1  ON 106
ci_058                -6.795340e-03 3 1  ON 107
ci_059                -6.377684e-03 3 1  ON 108
ci_060                 8.242615e-03 3 1  ON 109
ci_061                 7.908858e-03 3 1  ON 110
ci_062                -3.256100e-03 3 1  ON 111
ci_063                -2.908165e-03 3 1  ON 112
ci_064                -3.133232e-03 3 1  ON 113
ci_065                -4.350140e-03 3 1  ON 114
ci_066                 5.564959e-03 3 1  ON 115
ci_067                 5.749490e-03 3 1  ON 116
ci_068                -4.597366e-03 3 1  ON 117
ci_069                -4.608454e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0346e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.2991
    reference variance = 0.193935
====================================================
  Execution time = 3.7801e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5298e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1744e-01
  Total weights = 1.956501719e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1118e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302759285517
                                         uncertainty =       0.002418710960

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302759285517
                                         uncertainty =       0.002418710960

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389063015
  error estimate for blocks of size 2^( 2) =       0.000399417918
  error estimate for blocks of size 2^( 3) =       0.000408363161
  error estimate for blocks of size 2^( 4) =       0.000414410517
  error estimate for blocks of size 2^( 5) =       0.000420027224
  error estimate for blocks of size 2^( 6) =       0.000421238118
  error estimate for blocks of size 2^( 7) =       0.000421737419

      target function =                  N/A
              le_mean =     -17.216050083572
             les_mean =     296.709822550345
             stat err =       0.000419353320
             autocorr =       1.161770312379
              std dev =       0.550218192586
             le_variance =       0.302740059452


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721605008357e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+03, overlap shift 2.3842e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216050083590       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216050085198       residual = 9.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216050085396       residual = 4.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216050085685       residual = 3.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216050085494       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216050086131       residual = 6.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216050086133       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216050086187       residual = 5.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216050086155       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216050086163       residual = 3.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3842e+03 is 2.986524e-07

solving harmonic davidson linear method for identity shift 9.5367e+03, overlap shift 9.5367e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216050083590       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216050083992       residual = 9.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216050084041       residual = 4.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216050084113       residual = 3.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216050084066       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216050084223       residual = 6.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216050084233       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216050084249       residual = 5.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216050084240       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216050084236       residual = 3.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+03 is 7.466342e-08

solving harmonic davidson linear method for identity shift 3.8147e+04, overlap shift 3.8147e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216050083590       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216050083690       residual = 9.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216050083703       residual = 4.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216050083721       residual = 3.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216050083722       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216050083719       residual = 6.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216050083766       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216050083760       residual = 5.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216050083732       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216050083703       residual = 3.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.8147e+04 is 1.866587e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.220243 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8932e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972345e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178566e-02 1 1  ON 11
  ud_2                -1.648759e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217525e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463176e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504333e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598303e-02 1 1  ON 22
  eO_3                 2.081613e-01 1 1  ON 23
  eO_4                 2.891482e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202979e-02 1 1  ON 32
 eH1_3                -2.594623e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728066e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073802e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350520e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504987e-02 1 1  ON 45
 eH2_6                 7.827830e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397368e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996252e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507291e-02 3 1  ON 52
ci_004                 2.111229e-02 3 1  ON 53
ci_005                 2.113444e-02 3 1  ON 54
ci_006                -1.943371e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774335e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730269e-02 3 1  ON 59
ci_011                -1.626614e-02 3 1  ON 60
ci_012                -1.614703e-02 3 1  ON 61
ci_013                -1.921605e-02 3 1  ON 62
ci_014                 1.385481e-02 3 1  ON 63
ci_015                 1.356486e-02 3 1  ON 64
ci_016                 1.626480e-02 3 1  ON 65
ci_017                 1.653410e-02 3 1  ON 66
ci_018                 1.263031e-02 3 1  ON 67
ci_019                 1.309169e-02 3 1  ON 68
ci_020                 1.328127e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114554e-02 3 1  ON 71
ci_023                 1.122688e-02 3 1  ON 72
ci_024                 1.228161e-02 3 1  ON 73
ci_025                 1.155262e-02 3 1  ON 74
ci_026                 1.090691e-02 3 1  ON 75
ci_027                 1.132473e-02 3 1  ON 76
ci_028                -1.426210e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110704e-02 3 1  ON 79
ci_031                -1.141190e-02 3 1  ON 80
ci_032                -1.348835e-02 3 1  ON 81
ci_033                 1.065832e-02 3 1  ON 82
ci_034                 1.063467e-02 3 1  ON 83
ci_035                -4.704026e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005822e-02 3 1  ON 86
ci_038                 1.872204e-03 3 1  ON 87
ci_039                 1.473334e-03 3 1  ON 88
ci_040                -4.066146e-03 3 1  ON 89
ci_041                 9.803931e-03 3 1  ON 90
ci_042                 9.856524e-03 3 1  ON 91
ci_043                -2.929529e-03 3 1  ON 92
ci_044                -1.514678e-02 3 1  ON 93
ci_045                -1.824965e-03 3 1  ON 94
ci_046                 5.707905e-03 3 1  ON 95
ci_047                 5.452900e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412629e-03 3 1  ON 99
ci_051                 7.765602e-03 3 1  ON 100
ci_052                -6.441219e-03 3 1  ON 101
ci_053                -6.307103e-03 3 1  ON 102
ci_054                -3.216834e-03 3 1  ON 103
ci_055                -3.042674e-03 3 1  ON 104
ci_056                 4.495678e-03 3 1  ON 105
ci_057                 4.397762e-03 3 1  ON 106
ci_058                -6.795331e-03 3 1  ON 107
ci_059                -6.377712e-03 3 1  ON 108
ci_060                 8.242614e-03 3 1  ON 109
ci_061                 7.908860e-03 3 1  ON 110
ci_062                -3.256087e-03 3 1  ON 111
ci_063                -2.908177e-03 3 1  ON 112
ci_064                -3.133231e-03 3 1  ON 113
ci_065                -4.350123e-03 3 1  ON 114
ci_066                 5.564960e-03 3 1  ON 115
ci_067                 5.749468e-03 3 1  ON 116
ci_068                -4.597378e-03 3 1  ON 117
ci_069                -4.608458e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.2685
    reference variance = 0.206419
====================================================
  Execution time = 3.6927e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1584e-01
  Total weights = 1.9566e+06
  Execution time = 3.3571e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299193916253
                                         uncertainty =       0.002054221558

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299193916253
                                         uncertainty =       0.002054221558

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386779865
  error estimate for blocks of size 2^( 2) =       0.000396750555
  error estimate for blocks of size 2^( 3) =       0.000405769693
  error estimate for blocks of size 2^( 4) =       0.000411899071
  error estimate for blocks of size 2^( 5) =       0.000417031962
  error estimate for blocks of size 2^( 6) =       0.000419648382
  error estimate for blocks of size 2^( 7) =       0.000420813483

      target function =                  N/A
              le_mean =     -17.216055566891
             les_mean =     296.708407742541
             stat err =       0.000417348225
             autocorr =       1.164312140488
              std dev =       0.546989330671
             le_variance =       0.299197327867

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299193951125
                                         uncertainty =       0.002054220493

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299193951125
                                         uncertainty =       0.002054220493

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386779888
  error estimate for blocks of size 2^( 2) =       0.000396750577
  error estimate for blocks of size 2^( 3) =       0.000405769713
  error estimate for blocks of size 2^( 4) =       0.000411899091
  error estimate for blocks of size 2^( 5) =       0.000417031984
  error estimate for blocks of size 2^( 6) =       0.000419648405
  error estimate for blocks of size 2^( 7) =       0.000420813501

      target function =                  N/A
              le_mean =     -17.216055564413
             les_mean =     296.708408472984
             stat err =       0.000417348245
             autocorr =       1.164312118578
              std dev =       0.546989362721
             le_variance =       0.299197362930

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299193933690
                                         uncertainty =       0.002054221025

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299193933690
                                         uncertainty =       0.002054221025

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386779876
  error estimate for blocks of size 2^( 2) =       0.000396750566
  error estimate for blocks of size 2^( 3) =       0.000405769703
  error estimate for blocks of size 2^( 4) =       0.000411899081
  error estimate for blocks of size 2^( 5) =       0.000417031973
  error estimate for blocks of size 2^( 6) =       0.000419648394
  error estimate for blocks of size 2^( 7) =       0.000420813492

      target function =                  N/A
              le_mean =     -17.216055565652
             les_mean =     296.708408107262
             stat err =       0.000417348235
             autocorr =       1.164312129528
              std dev =       0.546989346697
             le_variance =       0.299197345400

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299193918433
                                         uncertainty =       0.002054221491

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299193918433
                                         uncertainty =       0.002054221491

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386779866
  error estimate for blocks of size 2^( 2) =       0.000396750557
  error estimate for blocks of size 2^( 3) =       0.000405769694
  error estimate for blocks of size 2^( 4) =       0.000411899073
  error estimate for blocks of size 2^( 5) =       0.000417031963
  error estimate for blocks of size 2^( 6) =       0.000419648384
  error estimate for blocks of size 2^( 7) =       0.000420813484

      target function =                  N/A
              le_mean =     -17.216055566737
             les_mean =     296.708407788073
             stat err =       0.000417348226
             autocorr =       1.164312139116
              std dev =       0.546989332674
             le_variance =       0.299197330059


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216055566891        initial  <--
     2.3842e+03     2.3842e+04             2.9865e-07       -17.216055564413
     9.5367e+03     9.5367e+04             7.4663e-08       -17.216055565652
     3.8147e+04     3.8147e+05             1.8666e-08       -17.216055566737

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.8887
  </log>
  <optVariables href="H2O.s020.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539116e-02 1 1  ON 1
  uu_2                -4.680482e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988697e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495800e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596334e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463191e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052707e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202977e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931584e-02 1 1  ON 34
 eH1_5                 3.552904e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350522e-02 1 1  ON 42
 eH2_3                -2.706108e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996250e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507291e-02 3 1  ON 52
ci_004                 2.111231e-02 3 1  ON 53
ci_005                 2.113443e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880570e-02 3 1  ON 56
ci_008                -1.774338e-02 3 1  ON 57
ci_009                -1.805529e-02 3 1  ON 58
ci_010                -1.730268e-02 3 1  ON 59
ci_011                -1.626616e-02 3 1  ON 60
ci_012                -1.614702e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385482e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626480e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309170e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155262e-02 3 1  ON 74
ci_026                 1.090692e-02 3 1  ON 75
ci_027                 1.132472e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110704e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704044e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872214e-03 3 1  ON 87
ci_039                 1.473327e-03 3 1  ON 88
ci_040                -4.066131e-03 3 1  ON 89
ci_041                 9.803945e-03 3 1  ON 90
ci_042                 9.856510e-03 3 1  ON 91
ci_043                -2.929531e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824961e-03 3 1  ON 94
ci_046                 5.707929e-03 3 1  ON 95
ci_047                 5.452902e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200811e-02 3 1  ON 98
ci_050                 7.412630e-03 3 1  ON 99
ci_051                 7.765617e-03 3 1  ON 100
ci_052                -6.441193e-03 3 1  ON 101
ci_053                -6.307081e-03 3 1  ON 102
ci_054                -3.216836e-03 3 1  ON 103
ci_055                -3.042690e-03 3 1  ON 104
ci_056                 4.495689e-03 3 1  ON 105
ci_057                 4.397749e-03 3 1  ON 106
ci_058                -6.795340e-03 3 1  ON 107
ci_059                -6.377684e-03 3 1  ON 108
ci_060                 8.242615e-03 3 1  ON 109
ci_061                 7.908858e-03 3 1  ON 110
ci_062                -3.256100e-03 3 1  ON 111
ci_063                -2.908165e-03 3 1  ON 112
ci_064                -3.133232e-03 3 1  ON 113
ci_065                -4.350140e-03 3 1  ON 114
ci_066                 5.564959e-03 3 1  ON 115
ci_067                 5.749490e-03 3 1  ON 116
ci_068                -4.597366e-03 3 1  ON 117
ci_069                -4.608454e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0283e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7223e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.2385
    reference variance = 0.200687
====================================================
  Execution time = 3.7917e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5312e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1585e-01
  Total weights = 1.956760371e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0980e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300006340793
                                         uncertainty =       0.002515259247

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300006340793
                                         uncertainty =       0.002515259247

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387295962
  error estimate for blocks of size 2^( 2) =       0.000397145794
  error estimate for blocks of size 2^( 3) =       0.000406806876
  error estimate for blocks of size 2^( 4) =       0.000413771153
  error estimate for blocks of size 2^( 5) =       0.000417655984
  error estimate for blocks of size 2^( 6) =       0.000418855941
  error estimate for blocks of size 2^( 7) =       0.000420736422

      target function =                  N/A
              le_mean =     -17.216400121526
             les_mean =     296.720281976769
             stat err =       0.000417754875
             autocorr =       1.163475160874
              std dev =       0.547719201698
             le_variance =       0.299996323909


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721640012153e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+04, overlap shift 2.3842e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216400121553       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216400121698       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216400121700       residual = 4.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216400121750       residual = 4.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216400121728       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216400121715       residual = 5.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216400121697       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216400121717       residual = 2.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216400121670       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216400121792       residual = 4.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3842e+04 is 3.069839e-08

solving harmonic davidson linear method for identity shift 9.5367e+04, overlap shift 9.5367e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216400121553       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216400121589       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216400121590       residual = 4.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216400121620       residual = 4.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216400121649       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216400121532       residual = 5.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216400121549       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216400121628       residual = 2.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216400121650       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216400121443       residual = 4.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+04 is 7.674598e-09

solving harmonic davidson linear method for identity shift 3.8147e+05, overlap shift 3.8147e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216400121553       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216400121562       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216400121562       residual = 4.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216400121565       residual = 4.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216400121571       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216400121608       residual = 5.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216400121545       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216400121733       residual = 2.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216400121673       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216400120341       residual = 4.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.8147e+05 is 1.918649e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.224213 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8910e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539116e-02 1 1  ON 1
  uu_2                -4.680482e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988697e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596334e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463190e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202977e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931584e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706108e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996250e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507291e-02 3 1  ON 52
ci_004                 2.111231e-02 3 1  ON 53
ci_005                 2.113443e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880570e-02 3 1  ON 56
ci_008                -1.774338e-02 3 1  ON 57
ci_009                -1.805529e-02 3 1  ON 58
ci_010                -1.730268e-02 3 1  ON 59
ci_011                -1.626616e-02 3 1  ON 60
ci_012                -1.614702e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309170e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155262e-02 3 1  ON 74
ci_026                 1.090692e-02 3 1  ON 75
ci_027                 1.132472e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110704e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704044e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872213e-03 3 1  ON 87
ci_039                 1.473329e-03 3 1  ON 88
ci_040                -4.066130e-03 3 1  ON 89
ci_041                 9.803944e-03 3 1  ON 90
ci_042                 9.856508e-03 3 1  ON 91
ci_043                -2.929531e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824960e-03 3 1  ON 94
ci_046                 5.707928e-03 3 1  ON 95
ci_047                 5.452906e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200811e-02 3 1  ON 98
ci_050                 7.412631e-03 3 1  ON 99
ci_051                 7.765617e-03 3 1  ON 100
ci_052                -6.441192e-03 3 1  ON 101
ci_053                -6.307081e-03 3 1  ON 102
ci_054                -3.216833e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495687e-03 3 1  ON 105
ci_057                 4.397750e-03 3 1  ON 106
ci_058                -6.795342e-03 3 1  ON 107
ci_059                -6.377683e-03 3 1  ON 108
ci_060                 8.242617e-03 3 1  ON 109
ci_061                 7.908861e-03 3 1  ON 110
ci_062                -3.256100e-03 3 1  ON 111
ci_063                -2.908164e-03 3 1  ON 112
ci_064                -3.133230e-03 3 1  ON 113
ci_065                -4.350139e-03 3 1  ON 114
ci_066                 5.564960e-03 3 1  ON 115
ci_067                 5.749490e-03 3 1  ON 116
ci_068                -4.597366e-03 3 1  ON 117
ci_069                -4.608455e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.301
    reference variance = 0.291446
====================================================
  Execution time = 3.7045e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1374e-01
  Total weights = 1.9567e+06
  Execution time = 3.3495e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299751731640
                                         uncertainty =       0.002067522876

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299751731640
                                         uncertainty =       0.002067522876

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387134728
  error estimate for blocks of size 2^( 2) =       0.000397107732
  error estimate for blocks of size 2^( 3) =       0.000406199972
  error estimate for blocks of size 2^( 4) =       0.000412640203
  error estimate for blocks of size 2^( 5) =       0.000417314457
  error estimate for blocks of size 2^( 6) =       0.000419245871
  error estimate for blocks of size 2^( 7) =       0.000419084253

      target function =                  N/A
              le_mean =     -17.216913904148
             les_mean =     296.735859645043
             stat err =       0.000417071196
             autocorr =       1.160636252455
              std dev =       0.547491182781
             le_variance =       0.299746595223

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299751737139
                                         uncertainty =       0.002067523072

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299751737139
                                         uncertainty =       0.002067523072

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387134732
  error estimate for blocks of size 2^( 2) =       0.000397107735
  error estimate for blocks of size 2^( 3) =       0.000406199976
  error estimate for blocks of size 2^( 4) =       0.000412640206
  error estimate for blocks of size 2^( 5) =       0.000417314460
  error estimate for blocks of size 2^( 6) =       0.000419245873
  error estimate for blocks of size 2^( 7) =       0.000419084255

      target function =                  N/A
              le_mean =     -17.216913904329
             les_mean =     296.735859624555
             stat err =       0.000417071198
             autocorr =       1.160636245057
              std dev =       0.547491187790
             le_variance =       0.299746600708

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299751734390
                                         uncertainty =       0.002067522974

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299751734390
                                         uncertainty =       0.002067522974

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387134730
  error estimate for blocks of size 2^( 2) =       0.000397107734
  error estimate for blocks of size 2^( 3) =       0.000406199974
  error estimate for blocks of size 2^( 4) =       0.000412640204
  error estimate for blocks of size 2^( 5) =       0.000417314458
  error estimate for blocks of size 2^( 6) =       0.000419245872
  error estimate for blocks of size 2^( 7) =       0.000419084254

      target function =                  N/A
              le_mean =     -17.216913904238
             les_mean =     296.735859634798
             stat err =       0.000417071197
             autocorr =       1.160636248757
              std dev =       0.547491185286
             le_variance =       0.299746597966

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299751731984
                                         uncertainty =       0.002067522889

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299751731984
                                         uncertainty =       0.002067522889

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387134728
  error estimate for blocks of size 2^( 2) =       0.000397107732
  error estimate for blocks of size 2^( 3) =       0.000406199973
  error estimate for blocks of size 2^( 4) =       0.000412640203
  error estimate for blocks of size 2^( 5) =       0.000417314457
  error estimate for blocks of size 2^( 6) =       0.000419245871
  error estimate for blocks of size 2^( 7) =       0.000419084253

      target function =                  N/A
              le_mean =     -17.216913904159
             les_mean =     296.735859643762
             stat err =       0.000417071196
             autocorr =       1.160636252000
              std dev =       0.547491183094
             le_variance =       0.299746595566


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216913904148        initial
     2.3842e+04     2.3842e+05             3.0698e-08       -17.216913904329  <--
     9.5367e+04     9.5367e+05             7.6746e-09       -17.216913904238
     3.8147e+05     3.8147e+06             1.9186e-09       -17.216913904159

*****************************************************************************
Applying the update for shift_i =   2.3842e+04     and shift_s =   2.3842e+05
*****************************************************************************

  Execution time = 5.3986e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216823e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397753e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377679e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0290e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7225e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.266
    reference variance = 0.312135
====================================================
  Execution time = 3.7716e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5295e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1392e-01
  Total weights = 1.956701177e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1191e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299019439360
                                         uncertainty =       0.001642628891

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299019439360
                                         uncertainty =       0.001642628891

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387016582
  error estimate for blocks of size 2^( 2) =       0.000396740884
  error estimate for blocks of size 2^( 3) =       0.000406102376
  error estimate for blocks of size 2^( 4) =       0.000412561722
  error estimate for blocks of size 2^( 5) =       0.000415813078
  error estimate for blocks of size 2^( 6) =       0.000417975092
  error estimate for blocks of size 2^( 7) =       0.000419643357

      target function =                  N/A
              le_mean =     -17.216629520049
             les_mean =     296.726253396086
             stat err =       0.000416498312
             autocorr =       1.158156756010
              std dev =       0.547324099756
             le_variance =       0.299563670173


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721662952005e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+03, overlap shift 5.9605e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216629520092       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216629520416       residual = 7.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216629520455       residual = 3.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216629520642       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216629520650       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216629520634       residual = 4.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216629520662       residual = 9.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216629520696       residual = 3.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216629520696       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216629520722       residual = 4.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.9605e+03 is 1.102106e-07

solving harmonic davidson linear method for identity shift 2.3842e+04, overlap shift 2.3842e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216629520092       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216629520173       residual = 7.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216629520183       residual = 3.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216629520229       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216629520230       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216629520206       residual = 4.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216629520227       residual = 9.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216629520247       residual = 3.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216629520302       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216629520199       residual = 4.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3842e+04 is 2.755270e-08

solving harmonic davidson linear method for identity shift 9.5367e+04, overlap shift 9.5367e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216629520092       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216629520112       residual = 7.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216629520115       residual = 3.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216629520126       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216629520127       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216629520089       residual = 4.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216629520063       residual = 9.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216629520135       residual = 3.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216629520061       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216629520121       residual = 4.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+04 is 6.888177e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.228244 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8920e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972345e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648759e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463182e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504333e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598302e-02 1 1  ON 22
  eO_3                 2.081613e-01 1 1  ON 23
  eO_4                 2.891482e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073802e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856800e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397368e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113443e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880570e-02 3 1  ON 56
ci_008                -1.774338e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626616e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626482e-02 3 1  ON 65
ci_017                 1.653412e-02 3 1  ON 66
ci_018                 1.263029e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328127e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426209e-02 3 1  ON 77
ci_029                -1.490779e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065830e-02 3 1  ON 82
ci_034                 1.063464e-02 3 1  ON 83
ci_035                -4.704043e-03 3 1  ON 84
ci_036                -1.040362e-02 3 1  ON 85
ci_037                -1.005822e-02 3 1  ON 86
ci_038                 1.872200e-03 3 1  ON 87
ci_039                 1.473342e-03 3 1  ON 88
ci_040                -4.066128e-03 3 1  ON 89
ci_041                 9.803938e-03 3 1  ON 90
ci_042                 9.856502e-03 3 1  ON 91
ci_043                -2.929538e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824954e-03 3 1  ON 94
ci_046                 5.707917e-03 3 1  ON 95
ci_047                 5.452919e-03 3 1  ON 96
ci_048                -1.169099e-02 3 1  ON 97
ci_049                -1.200809e-02 3 1  ON 98
ci_050                 7.412641e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441191e-03 3 1  ON 101
ci_053                -6.307086e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042679e-03 3 1  ON 104
ci_056                 4.495685e-03 3 1  ON 105
ci_057                 4.397759e-03 3 1  ON 106
ci_058                -6.795339e-03 3 1  ON 107
ci_059                -6.377690e-03 3 1  ON 108
ci_060                 8.242626e-03 3 1  ON 109
ci_061                 7.908874e-03 3 1  ON 110
ci_062                -3.256100e-03 3 1  ON 111
ci_063                -2.908156e-03 3 1  ON 112
ci_064                -3.133224e-03 3 1  ON 113
ci_065                -4.350137e-03 3 1  ON 114
ci_066                 5.564957e-03 3 1  ON 115
ci_067                 5.749490e-03 3 1  ON 116
ci_068                -4.597365e-03 3 1  ON 117
ci_069                -4.608456e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.2416
    reference variance = 0.300774
====================================================
  Execution time = 3.7362e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1700e-01
  Total weights = 1.9569e+06
  Execution time = 3.3577e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304333560842
                                         uncertainty =       0.003878210521

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304333560842
                                         uncertainty =       0.003878210521

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390046664
  error estimate for blocks of size 2^( 2) =       0.000399912362
  error estimate for blocks of size 2^( 3) =       0.000408947213
  error estimate for blocks of size 2^( 4) =       0.000415595243
  error estimate for blocks of size 2^( 5) =       0.000419470386
  error estimate for blocks of size 2^( 6) =       0.000420903104
  error estimate for blocks of size 2^( 7) =       0.000421476256

      target function =                  N/A
              le_mean =     -17.215935248455
             les_mean =     296.705424735289
             stat err =       0.000419361247
             autocorr =       1.155961725578
              std dev =       0.551609282367
             le_variance =       0.304272800393

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304333619961
                                         uncertainty =       0.003878211761

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304333619961
                                         uncertainty =       0.003878211761

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390046702
  error estimate for blocks of size 2^( 2) =       0.000399912397
  error estimate for blocks of size 2^( 3) =       0.000408947244
  error estimate for blocks of size 2^( 4) =       0.000415595271
  error estimate for blocks of size 2^( 5) =       0.000419470413
  error estimate for blocks of size 2^( 6) =       0.000420903131
  error estimate for blocks of size 2^( 7) =       0.000421476284

      target function =                  N/A
              le_mean =     -17.215935248234
             les_mean =     296.705424837170
             stat err =       0.000419361275
             autocorr =       1.155961652388
              std dev =       0.551609335934
             le_variance =       0.304272859489

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304333590403
                                         uncertainty =       0.003878211141

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304333590403
                                         uncertainty =       0.003878211141

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390046683
  error estimate for blocks of size 2^( 2) =       0.000399912379
  error estimate for blocks of size 2^( 3) =       0.000408947228
  error estimate for blocks of size 2^( 4) =       0.000415595257
  error estimate for blocks of size 2^( 5) =       0.000419470400
  error estimate for blocks of size 2^( 6) =       0.000420903117
  error estimate for blocks of size 2^( 7) =       0.000421476270

      target function =                  N/A
              le_mean =     -17.215935248344
             les_mean =     296.705424786226
             stat err =       0.000419361261
             autocorr =       1.155961688978
              std dev =       0.551609309151
             le_variance =       0.304272829942

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304333564537
                                         uncertainty =       0.003878210598

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304333564537
                                         uncertainty =       0.003878210598

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390046666
  error estimate for blocks of size 2^( 2) =       0.000399912364
  error estimate for blocks of size 2^( 3) =       0.000408947215
  error estimate for blocks of size 2^( 4) =       0.000415595245
  error estimate for blocks of size 2^( 5) =       0.000419470387
  error estimate for blocks of size 2^( 6) =       0.000420903106
  error estimate for blocks of size 2^( 7) =       0.000421476258

      target function =                  N/A
              le_mean =     -17.215935248441
             les_mean =     296.705424741656
             stat err =       0.000419361249
             autocorr =       1.155961721003
              std dev =       0.551609285715
             le_variance =       0.304272804087


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215935248455        initial  <--
     5.9605e+03     5.9605e+04             1.1021e-07       -17.215935248234
     2.3842e+04     2.3842e+05             2.7553e-08       -17.215935248344
     9.5367e+04     9.5367e+05             6.8882e-09       -17.215935248441

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 54.3513
  </log>
  <optVariables href="H2O.s022.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216823e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397753e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377679e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0328e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7226e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.2667
    reference variance = 0.174704
====================================================
  Execution time = 3.7623e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5294e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.0871e-01
  Total weights = 1.956774072e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1028e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296232055339
                                         uncertainty =       0.001886316606

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296232055339
                                         uncertainty =       0.001886316606

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384832476
  error estimate for blocks of size 2^( 2) =       0.000394686050
  error estimate for blocks of size 2^( 3) =       0.000404361262
  error estimate for blocks of size 2^( 4) =       0.000411154238
  error estimate for blocks of size 2^( 5) =       0.000415087167
  error estimate for blocks of size 2^( 6) =       0.000416934263
  error estimate for blocks of size 2^( 7) =       0.000416184158

      target function =                  N/A
              le_mean =     -17.216714674057
             les_mean =     296.723973698904
             stat err =       0.000414839957
             autocorr =       1.162031043906
              std dev =       0.544235306566
             le_variance =       0.296192068913


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721671467406e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+04, overlap shift 5.9605e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216714674085       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216714674104       residual = 6.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216714674095       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216714674124       residual = 3.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216714674093       residual = 3.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216714674084       residual = 6.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216714674100       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216714674105       residual = 3.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216714674183       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216714674092       residual = 2.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.9605e+04 is 1.212259e-08

solving harmonic davidson linear method for identity shift 2.3842e+05, overlap shift 2.3842e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216714674085       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216714674089       residual = 6.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216714674087       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216714674094       residual = 3.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216714674185       residual = 3.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216714674098       residual = 6.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216714674389       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216714674343       residual = 3.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216714673907       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216714673854       residual = 2.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3842e+05 is 3.030648e-09

solving harmonic davidson linear method for identity shift 9.5367e+05, overlap shift 9.5367e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216714674085       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216714674086       residual = 6.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216714674085       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216714674087       residual = 3.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216714673888       residual = 3.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216714673529       residual = 6.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216714674716       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216714673581       residual = 3.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216714674065       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216714674701       residual = 2.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+05 is 7.576623e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.232238 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8664e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648759e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463186e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891482e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704042e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872211e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066128e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514678e-02 3 1  ON 93
ci_045                -1.824957e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765614e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307084e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795346e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350137e-03 3 1  ON 114
ci_066                 5.564962e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.2163
    reference variance = 0.190339
====================================================
  Execution time = 3.7032e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1751e-01
  Total weights = 1.9567e+06
  Execution time = 3.3407e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302477683031
                                         uncertainty =       0.002367116410

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302477683031
                                         uncertainty =       0.002367116410

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388911155
  error estimate for blocks of size 2^( 2) =       0.000399104856
  error estimate for blocks of size 2^( 3) =       0.000407737556
  error estimate for blocks of size 2^( 4) =       0.000414165965
  error estimate for blocks of size 2^( 5) =       0.000419195947
  error estimate for blocks of size 2^( 6) =       0.000421443884
  error estimate for blocks of size 2^( 7) =       0.000421123569

      target function =                  N/A
              le_mean =     -17.216800964755
             les_mean =     296.735745410383
             stat err =       0.000418982341
             autocorr =       1.160621575098
              std dev =       0.550003429373
             le_variance =       0.302503772322

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302477685710
                                         uncertainty =       0.002367116315

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302477685710
                                         uncertainty =       0.002367116315

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388911156
  error estimate for blocks of size 2^( 2) =       0.000399104858
  error estimate for blocks of size 2^( 3) =       0.000407737557
  error estimate for blocks of size 2^( 4) =       0.000414165967
  error estimate for blocks of size 2^( 5) =       0.000419195949
  error estimate for blocks of size 2^( 6) =       0.000421443885
  error estimate for blocks of size 2^( 7) =       0.000421123571

      target function =                  N/A
              le_mean =     -17.216800964727
             les_mean =     296.735753056254
             stat err =       0.000418982343
             autocorr =       1.160621573842
              std dev =       0.550003431816
             le_variance =       0.302503775009

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302477684370
                                         uncertainty =       0.002367116362

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302477684370
                                         uncertainty =       0.002367116362

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388911155
  error estimate for blocks of size 2^( 2) =       0.000399104857
  error estimate for blocks of size 2^( 3) =       0.000407737556
  error estimate for blocks of size 2^( 4) =       0.000414165966
  error estimate for blocks of size 2^( 5) =       0.000419195948
  error estimate for blocks of size 2^( 6) =       0.000421443885
  error estimate for blocks of size 2^( 7) =       0.000421123570

      target function =                  N/A
              le_mean =     -17.216800964741
             les_mean =     296.735748907842
             stat err =       0.000418982342
             autocorr =       1.160621574476
              std dev =       0.550003430594
             le_variance =       0.302503773665

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302477683198
                                         uncertainty =       0.002367116404

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302477683198
                                         uncertainty =       0.002367116404

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388911155
  error estimate for blocks of size 2^( 2) =       0.000399104856
  error estimate for blocks of size 2^( 3) =       0.000407737556
  error estimate for blocks of size 2^( 4) =       0.000414165965
  error estimate for blocks of size 2^( 5) =       0.000419195948
  error estimate for blocks of size 2^( 6) =       0.000421443884
  error estimate for blocks of size 2^( 7) =       0.000421123569

      target function =                  N/A
              le_mean =     -17.216800964754
             les_mean =     296.735745816730
             stat err =       0.000418982341
             autocorr =       1.160621575016
              std dev =       0.550003429525
             le_variance =       0.302503772490


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216800964755        initial  <--
     5.9605e+04     5.9605e+05             1.2123e-08       -17.216800964727
     2.3842e+05     2.3842e+06             3.0306e-09       -17.216800964741
     9.5367e+05     9.5367e+06             7.5766e-10       -17.216800964754

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.9335
  </log>
  <optVariables href="H2O.s023.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216823e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397753e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377679e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0260e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7227e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.2229
    reference variance = 0.617541
====================================================
  Execution time = 3.7510e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5291e+04
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.1083e-01
  Total weights = 1.956808297e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0948e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297126341405
                                         uncertainty =       0.001910797274

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297126341405
                                         uncertainty =       0.001910797274

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385580024
  error estimate for blocks of size 2^( 2) =       0.000395643308
  error estimate for blocks of size 2^( 3) =       0.000404217406
  error estimate for blocks of size 2^( 4) =       0.000410951974
  error estimate for blocks of size 2^( 5) =       0.000415381293
  error estimate for blocks of size 2^( 6) =       0.000418018671
  error estimate for blocks of size 2^( 7) =       0.000419186979

      target function =                  N/A
              le_mean =     -17.217552502517
             les_mean =     296.754942711406
             stat err =       0.000415884729
             autocorr =       1.163367416236
              std dev =       0.545292499102
             le_variance =       0.297343909576


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721755250252e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+05, overlap shift 5.9605e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217552502582       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217552502589       residual = 2.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217552502588       residual = 3.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217552502589       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217552502418       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217552502987       residual = 6.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217552502786       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217552502667       residual = 4.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217552502795       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217552501349       residual = 6.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.9605e+05 is 1.150912e-09

solving harmonic davidson linear method for identity shift 2.3842e+06, overlap shift 2.3842e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217552502582       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217552502583       residual = 2.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217552502583       residual = 3.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217552502939       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217552501660       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217552501977       residual = 6.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217552503399       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217552503192       residual = 4.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217552501975       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217552505374       residual = 6.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3842e+06 is 2.877283e-10

solving harmonic davidson linear method for identity shift 9.5367e+06, overlap shift 9.5367e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217552502582       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217552502582       residual = 2.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217552502582       residual = 3.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217552502415       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217552503432       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217552499367       residual = 6.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217552502220       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217552503989       residual = 4.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217552502013       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217552503729       residual = 6.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+06 is 7.193204e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.236200 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8471e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307083e-03 3 1  ON 102
ci_054                -3.216823e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795346e-03 3 1  ON 107
ci_059                -6.377679e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.2433
    reference variance = 0.466458
====================================================
  Execution time = 3.7647e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1079e-01
  Total weights = 1.9567e+06
  Execution time = 3.3620e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298029186822
                                         uncertainty =       0.001875336032

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298029186822
                                         uncertainty =       0.001875336032

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386015380
  error estimate for blocks of size 2^( 2) =       0.000395672297
  error estimate for blocks of size 2^( 3) =       0.000405015049
  error estimate for blocks of size 2^( 4) =       0.000412556212
  error estimate for blocks of size 2^( 5) =       0.000416149979
  error estimate for blocks of size 2^( 6) =       0.000418449305
  error estimate for blocks of size 2^( 7) =       0.000421273058

      target function =                  N/A
              le_mean =     -17.216238059563
             les_mean =     296.709640899457
             stat err =       0.000417107138
             autocorr =       1.167578333418
              std dev =       0.545908185999
             le_variance =       0.298015747541

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298029187077
                                         uncertainty =       0.001875336015

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298029187077
                                         uncertainty =       0.001875336015

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386015380
  error estimate for blocks of size 2^( 2) =       0.000395672297
  error estimate for blocks of size 2^( 3) =       0.000405015050
  error estimate for blocks of size 2^( 4) =       0.000412556212
  error estimate for blocks of size 2^( 5) =       0.000416149979
  error estimate for blocks of size 2^( 6) =       0.000418449305
  error estimate for blocks of size 2^( 7) =       0.000421273058

      target function =                  N/A
              le_mean =     -17.216238059563
             les_mean =     296.709640899559
             stat err =       0.000417107139
             autocorr =       1.167578333140
              std dev =       0.545908186234
             le_variance =       0.298015747797

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298029186950
                                         uncertainty =       0.001875336023

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298029186950
                                         uncertainty =       0.001875336023

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386015380
  error estimate for blocks of size 2^( 2) =       0.000395672297
  error estimate for blocks of size 2^( 3) =       0.000405015049
  error estimate for blocks of size 2^( 4) =       0.000412556212
  error estimate for blocks of size 2^( 5) =       0.000416149979
  error estimate for blocks of size 2^( 6) =       0.000418449305
  error estimate for blocks of size 2^( 7) =       0.000421273058

      target function =                  N/A
              le_mean =     -17.216238059563
             les_mean =     296.709640899508
             stat err =       0.000417107138
             autocorr =       1.167578333273
              std dev =       0.545908186117
             le_variance =       0.298015747669

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298029186838
                                         uncertainty =       0.001875336031

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298029186838
                                         uncertainty =       0.001875336031

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386015380
  error estimate for blocks of size 2^( 2) =       0.000395672297
  error estimate for blocks of size 2^( 3) =       0.000405015049
  error estimate for blocks of size 2^( 4) =       0.000412556212
  error estimate for blocks of size 2^( 5) =       0.000416149979
  error estimate for blocks of size 2^( 6) =       0.000418449305
  error estimate for blocks of size 2^( 7) =       0.000421273058

      target function =                  N/A
              le_mean =     -17.216238059563
             les_mean =     296.709640899464
             stat err =       0.000417107138
             autocorr =       1.167578333404
              std dev =       0.545908186014
             le_variance =       0.298015747557


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216238059563        initial  <--
     5.9605e+05     5.9605e+06             1.1509e-09       -17.216238059563
     2.3842e+06     2.3842e+07             2.8773e-10       -17.216238059563
     9.5367e+06     9.5367e+07             7.1932e-11       -17.216238059563

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 54.6986
  </log>
  <optVariables href="H2O.s024.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216823e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397753e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377679e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0318e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7227e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.1534
    reference variance = 0.340205
====================================================
  Execution time = 3.7833e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5275e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.0902e-01
  Total weights = 1.956801100e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0914e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296977751560
                                         uncertainty =       0.002180849174

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296977751560
                                         uncertainty =       0.002180849174

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385351381
  error estimate for blocks of size 2^( 2) =       0.000395522605
  error estimate for blocks of size 2^( 3) =       0.000404450612
  error estimate for blocks of size 2^( 4) =       0.000410786550
  error estimate for blocks of size 2^( 5) =       0.000414565591
  error estimate for blocks of size 2^( 6) =       0.000416896443
  error estimate for blocks of size 2^( 7) =       0.000418050424

      target function =                  N/A
              le_mean =     -17.217099468870
             les_mean =     296.737536395531
             stat err =       0.000415074752
             autocorr =       1.160215850807
              std dev =       0.544969149464
             le_variance =       0.296991373868


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721709946887e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+06, overlap shift 5.9605e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217099468943       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217099468943       residual = 7.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217099468943       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217099468943       residual = 4.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217099468983       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217099470152       residual = 4.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217099473267       residual = 8.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217099471553       residual = 2.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217099467256       residual = 6.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.9605e+06 is 1.283385e-10

solving harmonic davidson linear method for identity shift 2.3842e+07, overlap shift 2.3842e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217099468943       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217099468943       residual = 7.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217099468943       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217099488916       residual = 4.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217099468925       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217099480423       residual = 4.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217099467208       residual = 8.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217099466595       residual = 2.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217099452500       residual = 6.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3842e+07 is 3.208457e-11

solving harmonic davidson linear method for identity shift 9.5367e+07, overlap shift 9.5367e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217099468943       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217099468943       residual = 7.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217099468943       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217099468943       residual = 4.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217098840874       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217099689636       residual = 4.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217099482130       residual = 8.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217099547111       residual = 2.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217099852140       residual = 6.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+07 is 8.021254e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.239646 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8759e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216823e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397753e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377679e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.2583
    reference variance = 0.139642
====================================================
  Execution time = 3.7040e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1502e-01
  Total weights = 1.9565e+06
  Execution time = 3.3416e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300866755194
                                         uncertainty =       0.002905479175

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300866755194
                                         uncertainty =       0.002905479175

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387831675
  error estimate for blocks of size 2^( 2) =       0.000397592878
  error estimate for blocks of size 2^( 3) =       0.000406355852
  error estimate for blocks of size 2^( 4) =       0.000413070239
  error estimate for blocks of size 2^( 5) =       0.000417404667
  error estimate for blocks of size 2^( 6) =       0.000419433440
  error estimate for blocks of size 2^( 7) =       0.000419596573

      target function =                  N/A
              le_mean =     -17.215890073449
             les_mean =     296.701889229986
             stat err =       0.000417376230
             autocorr =       1.158160830252
              std dev =       0.548476814166
             le_variance =       0.300826815678

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300866755177
                                         uncertainty =       0.002905479169

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300866755177
                                         uncertainty =       0.002905479169

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387831675
  error estimate for blocks of size 2^( 2) =       0.000397592878
  error estimate for blocks of size 2^( 3) =       0.000406355852
  error estimate for blocks of size 2^( 4) =       0.000413070239
  error estimate for blocks of size 2^( 5) =       0.000417404667
  error estimate for blocks of size 2^( 6) =       0.000419433440
  error estimate for blocks of size 2^( 7) =       0.000419596573

      target function =                  N/A
              le_mean =     -17.215890073448
             les_mean =     296.701889229749
             stat err =       0.000417376230
             autocorr =       1.158160830255
              std dev =       0.548476814151
             le_variance =       0.300826815661

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300866755185
                                         uncertainty =       0.002905479172

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300866755185
                                         uncertainty =       0.002905479172

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387831675
  error estimate for blocks of size 2^( 2) =       0.000397592878
  error estimate for blocks of size 2^( 3) =       0.000406355852
  error estimate for blocks of size 2^( 4) =       0.000413070239
  error estimate for blocks of size 2^( 5) =       0.000417404667
  error estimate for blocks of size 2^( 6) =       0.000419433440
  error estimate for blocks of size 2^( 7) =       0.000419596573

      target function =                  N/A
              le_mean =     -17.215890073448
             les_mean =     296.701889229868
             stat err =       0.000417376230
             autocorr =       1.158160830260
              std dev =       0.548476814159
             le_variance =       0.300826815670

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300866755193
                                         uncertainty =       0.002905479175

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300866755193
                                         uncertainty =       0.002905479175

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387831675
  error estimate for blocks of size 2^( 2) =       0.000397592878
  error estimate for blocks of size 2^( 3) =       0.000406355852
  error estimate for blocks of size 2^( 4) =       0.000413070239
  error estimate for blocks of size 2^( 5) =       0.000417404667
  error estimate for blocks of size 2^( 6) =       0.000419433440
  error estimate for blocks of size 2^( 7) =       0.000419596573

      target function =                  N/A
              le_mean =     -17.215890073449
             les_mean =     296.701889229972
             stat err =       0.000417376230
             autocorr =       1.158160830254
              std dev =       0.548476814165
             le_variance =       0.300826815677


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215890073449        initial  <--
     5.9605e+06     5.9605e+07             1.2834e-10       -17.215890073448
     2.3842e+07     2.3842e+08             3.2085e-11       -17.215890073448
     9.5367e+07     9.5367e+08             8.0213e-12       -17.215890073449

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.9519
  </log>
  <optVariables href="H2O.s025.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216823e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397753e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377679e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0272e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7226e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.2505
    reference variance = 0.18976
====================================================
  Execution time = 3.7697e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5265e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2246e-01
  Total weights = 1.956902845e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1129e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306151689273
                                         uncertainty =       0.002641890087

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306151689273
                                         uncertainty =       0.002641890087

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391180557
  error estimate for blocks of size 2^( 2) =       0.000401270825
  error estimate for blocks of size 2^( 3) =       0.000410422949
  error estimate for blocks of size 2^( 4) =       0.000416329687
  error estimate for blocks of size 2^( 5) =       0.000420038792
  error estimate for blocks of size 2^( 6) =       0.000423697005
  error estimate for blocks of size 2^( 7) =       0.000425729478

      target function =                  N/A
              le_mean =     -17.217171336225
             les_mean =     296.753450471984
             stat err =       0.000421448741
             autocorr =       1.160740132582
              std dev =       0.553212848401
             le_variance =       0.306044455636


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721717133623e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+07, overlap shift 5.9605e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217171336289       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217171336289       residual = 3.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217171336289       residual = 5.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217171336289       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217171342932       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217171336289       residual = 7.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217171334019       residual = 9.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217171360137       residual = 4.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217171312974       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217171340937       residual = 3.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.9605e+07 is 1.213191e-11

solving harmonic davidson linear method for identity shift 2.3842e+08, overlap shift 2.3842e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217171336289       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217171336289       residual = 3.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217171336289       residual = 5.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217171336289       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217171324774       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217171384314       residual = 7.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217171392907       residual = 9.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217171202894       residual = 4.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217171376487       residual = 2.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217171319060       residual = 3.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3842e+08 is 3.032906e-12

solving harmonic davidson linear method for identity shift 9.5367e+08, overlap shift 9.5367e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217171336289       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217171336289       residual = 3.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217171336289       residual = 5.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217171344106       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217171336289       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217171307813       residual = 7.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217172337911       residual = 9.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217171046950       residual = 4.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217170870386       residual = 2.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217171146206       residual = 3.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+08 is 7.583750e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.243608 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8839e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216823e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397753e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377679e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.2127
    reference variance = 0.18729
====================================================
  Execution time = 3.6971e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2357e-01
  Total weights = 1.9565e+06
  Execution time = 3.3435e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303253470095
                                         uncertainty =       0.002270320796

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303253470095
                                         uncertainty =       0.002270320796

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389409571
  error estimate for blocks of size 2^( 2) =       0.000399453457
  error estimate for blocks of size 2^( 3) =       0.000408369329
  error estimate for blocks of size 2^( 4) =       0.000415402114
  error estimate for blocks of size 2^( 5) =       0.000419509803
  error estimate for blocks of size 2^( 6) =       0.000420871205
  error estimate for blocks of size 2^( 7) =       0.000423110720

      target function =                  N/A
              le_mean =     -17.216011147771
             les_mean =     296.714610601241
             stat err =       0.000419723461
             autocorr =       1.161751515926
              std dev =       0.550708296026
             le_variance =       0.303279627312

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303253470098
                                         uncertainty =       0.002270320795

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303253470098
                                         uncertainty =       0.002270320795

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389409571
  error estimate for blocks of size 2^( 2) =       0.000399453457
  error estimate for blocks of size 2^( 3) =       0.000408369329
  error estimate for blocks of size 2^( 4) =       0.000415402114
  error estimate for blocks of size 2^( 5) =       0.000419509803
  error estimate for blocks of size 2^( 6) =       0.000420871205
  error estimate for blocks of size 2^( 7) =       0.000423110720

      target function =                  N/A
              le_mean =     -17.216011147771
             les_mean =     296.714610600813
             stat err =       0.000419723461
             autocorr =       1.161751515931
              std dev =       0.550708296028
             le_variance =       0.303279627315

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303253470097
                                         uncertainty =       0.002270320795

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303253470097
                                         uncertainty =       0.002270320795

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389409571
  error estimate for blocks of size 2^( 2) =       0.000399453457
  error estimate for blocks of size 2^( 3) =       0.000408369329
  error estimate for blocks of size 2^( 4) =       0.000415402114
  error estimate for blocks of size 2^( 5) =       0.000419509803
  error estimate for blocks of size 2^( 6) =       0.000420871205
  error estimate for blocks of size 2^( 7) =       0.000423110720

      target function =                  N/A
              le_mean =     -17.216011147771
             les_mean =     296.714610601027
             stat err =       0.000419723461
             autocorr =       1.161751515925
              std dev =       0.550708296027
             le_variance =       0.303279627313

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303253470096
                                         uncertainty =       0.002270320796

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303253470096
                                         uncertainty =       0.002270320796

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389409571
  error estimate for blocks of size 2^( 2) =       0.000399453457
  error estimate for blocks of size 2^( 3) =       0.000408369329
  error estimate for blocks of size 2^( 4) =       0.000415402114
  error estimate for blocks of size 2^( 5) =       0.000419509803
  error estimate for blocks of size 2^( 6) =       0.000420871205
  error estimate for blocks of size 2^( 7) =       0.000423110720

      target function =                  N/A
              le_mean =     -17.216011147771
             les_mean =     296.714610601214
             stat err =       0.000419723461
             autocorr =       1.161751515932
              std dev =       0.550708296026
             le_variance =       0.303279627312


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216011147771        initial
     5.9605e+07     5.9605e+08             1.2132e-11       -17.216011147771  <--
     2.3842e+08     2.3842e+09             3.0329e-12       -17.216011147771
     9.5367e+08     9.5367e+09             7.5838e-13       -17.216011147771

*****************************************************************************
Applying the update for shift_i =   5.9605e+07     and shift_s =   5.9605e+08
*****************************************************************************

  Execution time = 5.3881e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216823e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397753e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377679e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0273e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7227e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.2046
    reference variance = 0.261451
====================================================
  Execution time = 3.7634e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5301e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1618e-01
  Total weights = 1.956875527e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1043e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300914812576
                                         uncertainty =       0.002281199147

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300914812576
                                         uncertainty =       0.002281199147

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387874707
  error estimate for blocks of size 2^( 2) =       0.000397923667
  error estimate for blocks of size 2^( 3) =       0.000407316089
  error estimate for blocks of size 2^( 4) =       0.000413827279
  error estimate for blocks of size 2^( 5) =       0.000417300171
  error estimate for blocks of size 2^( 6) =       0.000419763336
  error estimate for blocks of size 2^( 7) =       0.000420564468

      target function =                  N/A
              le_mean =     -17.216433413343
             les_mean =     296.721760645764
             stat err =       0.000417863813
             autocorr =       1.160610794617
              std dev =       0.548537671182
             le_variance =       0.300893576706


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721643341334e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+07, overlap shift 1.4901e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216433413403       residual = 2.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216433413403       residual = 5.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216433413403       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216433413403       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216433413403       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216433410930       residual = 3.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216433416090       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216433407928       residual = 3.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216433399232       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216433440513       residual = 7.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.4901e+07 is 5.083661e-11

solving harmonic davidson linear method for identity shift 5.9605e+07, overlap shift 5.9605e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216433413403       residual = 2.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216433413403       residual = 5.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216433413403       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216433413403       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216433413403       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216433430675       residual = 3.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216433404634       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216433413377       residual = 3.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216433448335       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216433416208       residual = 7.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.9605e+07 is 1.270893e-11

solving harmonic davidson linear method for identity shift 2.3842e+08, overlap shift 2.3842e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216433413403       residual = 2.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216433413403       residual = 5.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216433413403       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216433413403       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216433596725       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216433355031       residual = 3.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216433438341       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216433154012       residual = 3.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216433369658       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216433332488       residual = 6.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3842e+08 is 3.178623e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.247543 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8689e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216823e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397753e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377679e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.1739
    reference variance = 0.10416
====================================================
  Execution time = 3.7298e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1964e-01
  Total weights = 1.9569e+06
  Execution time = 3.3638e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302710828315
                                         uncertainty =       0.004645696782

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302710828315
                                         uncertainty =       0.004645696782

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389030345
  error estimate for blocks of size 2^( 2) =       0.000398597303
  error estimate for blocks of size 2^( 3) =       0.000407450902
  error estimate for blocks of size 2^( 4) =       0.000414560924
  error estimate for blocks of size 2^( 5) =       0.000417889157
  error estimate for blocks of size 2^( 6) =       0.000419447790
  error estimate for blocks of size 2^( 7) =       0.000421155946

      target function =                  N/A
              le_mean =     -17.216571774024
             les_mean =     296.729983487590
             stat err =       0.000418263454
             autocorr =       1.155933587980
              std dev =       0.550171989759
             le_variance =       0.302689218316

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302710828304
                                         uncertainty =       0.004645696781

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302710828304
                                         uncertainty =       0.004645696781

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389030345
  error estimate for blocks of size 2^( 2) =       0.000398597303
  error estimate for blocks of size 2^( 3) =       0.000407450902
  error estimate for blocks of size 2^( 4) =       0.000414560924
  error estimate for blocks of size 2^( 5) =       0.000417889157
  error estimate for blocks of size 2^( 6) =       0.000419447790
  error estimate for blocks of size 2^( 7) =       0.000421155946

      target function =                  N/A
              le_mean =     -17.216571774024
             les_mean =     296.729983487583
             stat err =       0.000418263454
             autocorr =       1.155933587984
              std dev =       0.550171989749
             le_variance =       0.302689218305

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302710828309
                                         uncertainty =       0.004645696781

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302710828309
                                         uncertainty =       0.004645696781

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389030345
  error estimate for blocks of size 2^( 2) =       0.000398597303
  error estimate for blocks of size 2^( 3) =       0.000407450902
  error estimate for blocks of size 2^( 4) =       0.000414560924
  error estimate for blocks of size 2^( 5) =       0.000417889157
  error estimate for blocks of size 2^( 6) =       0.000419447790
  error estimate for blocks of size 2^( 7) =       0.000421155946

      target function =                  N/A
              le_mean =     -17.216571774024
             les_mean =     296.729983487586
             stat err =       0.000418263454
             autocorr =       1.155933587984
              std dev =       0.550171989754
             le_variance =       0.302689218310

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302710828314
                                         uncertainty =       0.004645696782

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302710828314
                                         uncertainty =       0.004645696782

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389030345
  error estimate for blocks of size 2^( 2) =       0.000398597303
  error estimate for blocks of size 2^( 3) =       0.000407450902
  error estimate for blocks of size 2^( 4) =       0.000414560924
  error estimate for blocks of size 2^( 5) =       0.000417889157
  error estimate for blocks of size 2^( 6) =       0.000419447790
  error estimate for blocks of size 2^( 7) =       0.000421155946

      target function =                  N/A
              le_mean =     -17.216571774024
             les_mean =     296.729983487589
             stat err =       0.000418263454
             autocorr =       1.155933587975
              std dev =       0.550171989759
             le_variance =       0.302689218315


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216571774024        initial  <--
     1.4901e+07     1.4901e+08             5.0837e-11       -17.216571774024
     5.9605e+07     5.9605e+08             1.2709e-11       -17.216571774024
     2.3842e+08     2.3842e+09             3.1786e-12       -17.216571774024

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 54.3124
  </log>
  <optVariables href="H2O.s027.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216823e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397753e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377679e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0301e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7225e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.0882
    reference variance = 5.29937
====================================================
  Execution time = 3.8004e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5288e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1882e-01
  Total weights = 1.956478948e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0877e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302731697578
                                         uncertainty =       0.002608510129

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302731697578
                                         uncertainty =       0.002608510129

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389226048
  error estimate for blocks of size 2^( 2) =       0.000399212838
  error estimate for blocks of size 2^( 3) =       0.000408400087
  error estimate for blocks of size 2^( 4) =       0.000414477858
  error estimate for blocks of size 2^( 5) =       0.000418995645
  error estimate for blocks of size 2^( 6) =       0.000421645896
  error estimate for blocks of size 2^( 7) =       0.000422229219

      target function =                  N/A
              le_mean =     -17.216302255545
             les_mean =     296.719887449833
             stat err =       0.000419337155
             autocorr =       1.160707775608
              std dev =       0.550448756359
             le_variance =       0.302993833377


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721630225555e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+08, overlap shift 1.4901e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216302255586       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216302255586       residual = 4.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216302255586       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216302261537       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216302255071       residual = 3.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216302221607       residual = 4.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216302311631       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216302203546       residual = 5.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216302128161       residual = 8.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.4901e+08 is 4.878551e-12

solving harmonic davidson linear method for identity shift 5.9605e+08, overlap shift 5.9605e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216302255586       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216302255586       residual = 4.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216302255586       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216302015483       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216302255586       residual = 3.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216302647891       residual = 4.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216302321907       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216302210229       residual = 5.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216301956642       residual = 8.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.9605e+08 is 1.219696e-12

solving harmonic davidson linear method for identity shift 2.3842e+09, overlap shift 2.3842e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216302255586       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216302255586       residual = 4.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216302255586       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216302255586       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216301975366       residual = 3.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216302922060       residual = 4.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216306098631       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216301554671       residual = 5.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216301649344       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216303338042       residual = 4.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3842e+09 is 3.065251e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.251156 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8893e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216823e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397753e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377679e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.1394
    reference variance = 0.166345
====================================================
  Execution time = 3.6988e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1111e-01
  Total weights = 1.9569e+06
  Execution time = 3.3277e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298181877244
                                         uncertainty =       0.001693923311

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298181877244
                                         uncertainty =       0.001693923311

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386091499
  error estimate for blocks of size 2^( 2) =       0.000396145544
  error estimate for blocks of size 2^( 3) =       0.000405270188
  error estimate for blocks of size 2^( 4) =       0.000412328454
  error estimate for blocks of size 2^( 5) =       0.000415907368
  error estimate for blocks of size 2^( 6) =       0.000416970545
  error estimate for blocks of size 2^( 7) =       0.000418946457

      target function =                  N/A
              le_mean =     -17.215940695549
             les_mean =     296.699727491065
             stat err =       0.000416038206
             autocorr =       1.161143649100
              std dev =       0.546015834398
             le_variance =       0.298133291414

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298181877246
                                         uncertainty =       0.001693923311

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298181877246
                                         uncertainty =       0.001693923311

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386091499
  error estimate for blocks of size 2^( 2) =       0.000396145544
  error estimate for blocks of size 2^( 3) =       0.000405270188
  error estimate for blocks of size 2^( 4) =       0.000412328454
  error estimate for blocks of size 2^( 5) =       0.000415907368
  error estimate for blocks of size 2^( 6) =       0.000416970545
  error estimate for blocks of size 2^( 7) =       0.000418946457

      target function =                  N/A
              le_mean =     -17.215940695549
             les_mean =     296.699727491068
             stat err =       0.000416038206
             autocorr =       1.161143649101
              std dev =       0.546015834400
             le_variance =       0.298133291416

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298181877245
                                         uncertainty =       0.001693923311

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298181877245
                                         uncertainty =       0.001693923311

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386091499
  error estimate for blocks of size 2^( 2) =       0.000396145544
  error estimate for blocks of size 2^( 3) =       0.000405270188
  error estimate for blocks of size 2^( 4) =       0.000412328454
  error estimate for blocks of size 2^( 5) =       0.000415907368
  error estimate for blocks of size 2^( 6) =       0.000416970545
  error estimate for blocks of size 2^( 7) =       0.000418946457

      target function =                  N/A
              le_mean =     -17.215940695549
             les_mean =     296.699727491067
             stat err =       0.000416038206
             autocorr =       1.161143649101
              std dev =       0.546015834399
             le_variance =       0.298133291415

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298181877244
                                         uncertainty =       0.001693923311

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298181877244
                                         uncertainty =       0.001693923311

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386091499
  error estimate for blocks of size 2^( 2) =       0.000396145544
  error estimate for blocks of size 2^( 3) =       0.000405270188
  error estimate for blocks of size 2^( 4) =       0.000412328454
  error estimate for blocks of size 2^( 5) =       0.000415907368
  error estimate for blocks of size 2^( 6) =       0.000416970545
  error estimate for blocks of size 2^( 7) =       0.000418946457

      target function =                  N/A
              le_mean =     -17.215940695549
             les_mean =     296.699727491066
             stat err =       0.000416038206
             autocorr =       1.161143649103
              std dev =       0.546015834399
             le_variance =       0.298133291414


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215940695549        initial
     1.4901e+08     1.4901e+09             4.8786e-12       -17.215940695549  <--
     5.9605e+08     5.9605e+09             1.2197e-12       -17.215940695549
     2.3842e+09     2.3842e+10             3.0653e-13       -17.215940695549

*****************************************************************************
Applying the update for shift_i =   1.4901e+08     and shift_s =   1.4901e+09
*****************************************************************************

  Execution time = 5.3843e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216823e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397753e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377679e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0274e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.2297
    reference variance = 0.278202
====================================================
  Execution time = 3.7482e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5280e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1518e-01
  Total weights = 1.956546803e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1071e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299435695806
                                         uncertainty =       0.002088325586

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299435695806
                                         uncertainty =       0.002088325586

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386890456
  error estimate for blocks of size 2^( 2) =       0.000396852985
  error estimate for blocks of size 2^( 3) =       0.000405746824
  error estimate for blocks of size 2^( 4) =       0.000412560234
  error estimate for blocks of size 2^( 5) =       0.000416890606
  error estimate for blocks of size 2^( 6) =       0.000419934229
  error estimate for blocks of size 2^( 7) =       0.000422543214

      target function =                  N/A
              le_mean =     -17.215964706301
             les_mean =     296.704622157295
             stat err =       0.000417982071
             autocorr =       1.167183860812
              std dev =       0.547145729919
             le_variance =       0.299368449769


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721596470630e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+07, overlap shift 3.7253e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215964706395       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215964706395       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215964706395       residual = 3.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215964706395       residual = 4.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215964694188       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215964699987       residual = 4.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215964711746       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215964708662       residual = 3.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215964714567       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215964682214       residual = 2.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.7253e+07 is 2.068719e-11

solving harmonic davidson linear method for identity shift 1.4901e+08, overlap shift 1.4901e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215964706395       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215964706395       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215964706395       residual = 3.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215964706395       residual = 4.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215964740128       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215964697203       residual = 4.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215964758570       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215964706627       residual = 3.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215964632284       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215964731471       residual = 2.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.4901e+08 is 5.171797e-12

solving harmonic davidson linear method for identity shift 5.9605e+08, overlap shift 5.9605e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215964706395       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215964706395       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215964706395       residual = 3.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215964742218       residual = 4.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215964655074       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215964848879       residual = 4.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215965062236       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215964509182       residual = 3.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215964728863       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215964469971       residual = 2.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.9605e+08 is 1.292919e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.255151 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8565e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216823e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397753e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377679e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.2106
    reference variance = 0.370443
====================================================
  Execution time = 3.7018e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1915e-01
  Total weights = 1.9569e+06
  Execution time = 3.3541e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300840678643
                                         uncertainty =       0.002469092304

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300840678643
                                         uncertainty =       0.002469092304

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387841778
  error estimate for blocks of size 2^( 2) =       0.000397924218
  error estimate for blocks of size 2^( 3) =       0.000406714936
  error estimate for blocks of size 2^( 4) =       0.000414056629
  error estimate for blocks of size 2^( 5) =       0.000418800729
  error estimate for blocks of size 2^( 6) =       0.000421080231
  error estimate for blocks of size 2^( 7) =       0.000422099090

      target function =                  N/A
              le_mean =     -17.216415160729
             les_mean =     296.724103072174
             stat err =       0.000419009170
             autocorr =       1.167180106840
              std dev =       0.548491102057
             le_variance =       0.300842489036

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300840678648
                                         uncertainty =       0.002469092304

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300840678648
                                         uncertainty =       0.002469092304

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387841778
  error estimate for blocks of size 2^( 2) =       0.000397924218
  error estimate for blocks of size 2^( 3) =       0.000406714936
  error estimate for blocks of size 2^( 4) =       0.000414056629
  error estimate for blocks of size 2^( 5) =       0.000418800729
  error estimate for blocks of size 2^( 6) =       0.000421080231
  error estimate for blocks of size 2^( 7) =       0.000422099090

      target function =                  N/A
              le_mean =     -17.216415160729
             les_mean =     296.724103072197
             stat err =       0.000419009170
             autocorr =       1.167180106833
              std dev =       0.548491102062
             le_variance =       0.300842489041

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300840678645
                                         uncertainty =       0.002469092304

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300840678645
                                         uncertainty =       0.002469092304

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387841778
  error estimate for blocks of size 2^( 2) =       0.000397924218
  error estimate for blocks of size 2^( 3) =       0.000406714936
  error estimate for blocks of size 2^( 4) =       0.000414056629
  error estimate for blocks of size 2^( 5) =       0.000418800729
  error estimate for blocks of size 2^( 6) =       0.000421080231
  error estimate for blocks of size 2^( 7) =       0.000422099090

      target function =                  N/A
              le_mean =     -17.216415160729
             les_mean =     296.724103072186
             stat err =       0.000419009170
             autocorr =       1.167180106846
              std dev =       0.548491102060
             le_variance =       0.300842489039

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300840678643
                                         uncertainty =       0.002469092304

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300840678643
                                         uncertainty =       0.002469092304

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387841778
  error estimate for blocks of size 2^( 2) =       0.000397924218
  error estimate for blocks of size 2^( 3) =       0.000406714936
  error estimate for blocks of size 2^( 4) =       0.000414056629
  error estimate for blocks of size 2^( 5) =       0.000418800729
  error estimate for blocks of size 2^( 6) =       0.000421080231
  error estimate for blocks of size 2^( 7) =       0.000422099090

      target function =                  N/A
              le_mean =     -17.216415160729
             les_mean =     296.724103072176
             stat err =       0.000419009170
             autocorr =       1.167180106840
              std dev =       0.548491102058
             le_variance =       0.300842489036


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216415160729        initial
     3.7253e+07     3.7253e+08             2.0687e-11       -17.216415160729  <--
     1.4901e+08     1.4901e+09             5.1718e-12       -17.216415160729
     5.9605e+08     5.9605e+09             1.2929e-12       -17.216415160729

*****************************************************************************
Applying the update for shift_i =   3.7253e+07     and shift_s =   3.7253e+08
*****************************************************************************

  Execution time = 5.4011e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216823e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397753e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377679e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0258e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.2243
    reference variance = 0.215569
====================================================
  Execution time = 3.7503e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5309e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1228e-01
  Total weights = 1.956565428e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0847e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297550381296
                                         uncertainty =       0.001861507994

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297550381296
                                         uncertainty =       0.001861507994

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385739251
  error estimate for blocks of size 2^( 2) =       0.000395369994
  error estimate for blocks of size 2^( 3) =       0.000404424461
  error estimate for blocks of size 2^( 4) =       0.000410797690
  error estimate for blocks of size 2^( 5) =       0.000416232993
  error estimate for blocks of size 2^( 6) =       0.000419330666
  error estimate for blocks of size 2^( 7) =       0.000422604280

      target function =                  N/A
              le_mean =     -17.216374881132
             les_mean =     296.715842914912
             stat err =       0.000417241407
             autocorr =       1.170003434199
              std dev =       0.545517680918
             le_variance =       0.297589540194


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721637488113e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+06, overlap shift 9.3132e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216374881156       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216374881156       residual = 6.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216374881156       residual = 6.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216374881156       residual = 3.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216374878328       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216374877670       residual = 7.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216374888896       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216374875165       residual = 4.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216374877176       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216374868124       residual = 4.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+06 is 7.308976e-11

solving harmonic davidson linear method for identity shift 3.7253e+07, overlap shift 3.7253e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216374881156       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216374881156       residual = 6.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216374881156       residual = 6.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216374889335       residual = 3.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216374881156       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216374814983       residual = 7.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216374882708       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216374864761       residual = 4.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216374906756       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216374894150       residual = 4.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.7253e+07 is 1.827234e-11

solving harmonic davidson linear method for identity shift 1.4901e+08, overlap shift 1.4901e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216374881156       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216374881156       residual = 6.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216374881156       residual = 6.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216374882139       residual = 3.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216374881156       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216374442512       residual = 7.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216375153512       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216374999719       residual = 4.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216375149732       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216375110003       residual = 4.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.4901e+08 is 4.569732e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.273712 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8377e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216823e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397753e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377679e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.1852
    reference variance = 0.223158
====================================================
  Execution time = 3.7322e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2374e-01
  Total weights = 1.9569e+06
  Execution time = 3.3522e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305893408982
                                         uncertainty =       0.002317837223

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305893408982
                                         uncertainty =       0.002317837223

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391083350
  error estimate for blocks of size 2^( 2) =       0.000401315125
  error estimate for blocks of size 2^( 3) =       0.000410581614
  error estimate for blocks of size 2^( 4) =       0.000416976204
  error estimate for blocks of size 2^( 5) =       0.000420933593
  error estimate for blocks of size 2^( 6) =       0.000421790160
  error estimate for blocks of size 2^( 7) =       0.000425451608

      target function =                  N/A
              le_mean =     -17.216542933932
             les_mean =     296.733093255657
             stat err =       0.000421287891
             autocorr =       1.160430942953
              std dev =       0.553075377166
             le_variance =       0.305892372827

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305893409016
                                         uncertainty =       0.002317837223

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305893409016
                                         uncertainty =       0.002317837223

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391083350
  error estimate for blocks of size 2^( 2) =       0.000401315125
  error estimate for blocks of size 2^( 3) =       0.000410581614
  error estimate for blocks of size 2^( 4) =       0.000416976204
  error estimate for blocks of size 2^( 5) =       0.000420933593
  error estimate for blocks of size 2^( 6) =       0.000421790160
  error estimate for blocks of size 2^( 7) =       0.000425451608

      target function =                  N/A
              le_mean =     -17.216542933932
             les_mean =     296.733093255671
             stat err =       0.000421287891
             autocorr =       1.160430942918
              std dev =       0.553075377196
             le_variance =       0.305892372860

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305893408999
                                         uncertainty =       0.002317837223

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305893408999
                                         uncertainty =       0.002317837223

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391083350
  error estimate for blocks of size 2^( 2) =       0.000401315125
  error estimate for blocks of size 2^( 3) =       0.000410581614
  error estimate for blocks of size 2^( 4) =       0.000416976204
  error estimate for blocks of size 2^( 5) =       0.000420933593
  error estimate for blocks of size 2^( 6) =       0.000421790160
  error estimate for blocks of size 2^( 7) =       0.000425451608

      target function =                  N/A
              le_mean =     -17.216542933932
             les_mean =     296.733093255664
             stat err =       0.000421287891
             autocorr =       1.160430942933
              std dev =       0.553075377181
             le_variance =       0.305892372844

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305893408984
                                         uncertainty =       0.002317837223

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305893408984
                                         uncertainty =       0.002317837223

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391083350
  error estimate for blocks of size 2^( 2) =       0.000401315125
  error estimate for blocks of size 2^( 3) =       0.000410581614
  error estimate for blocks of size 2^( 4) =       0.000416976204
  error estimate for blocks of size 2^( 5) =       0.000420933593
  error estimate for blocks of size 2^( 6) =       0.000421790160
  error estimate for blocks of size 2^( 7) =       0.000425451608

      target function =                  N/A
              le_mean =     -17.216542933932
             les_mean =     296.733093255658
             stat err =       0.000421287891
             autocorr =       1.160430942946
              std dev =       0.553075377168
             le_variance =       0.305892372829


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216542933932        initial
     9.3132e+06     9.3132e+07             7.3090e-11       -17.216542933932  <--
     3.7253e+07     3.7253e+08             1.8272e-11       -17.216542933932
     1.4901e+08     1.4901e+09             4.5697e-12       -17.216542933932

*****************************************************************************
Applying the update for shift_i =   9.3132e+06     and shift_s =   9.3132e+07
*****************************************************************************

  Execution time = 5.4283e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216823e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397753e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377679e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256099e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0267e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.1886
    reference variance = 0.201049
====================================================
  Execution time = 3.7915e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5307e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.1132e-01
  Total weights = 1.956446006e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0928e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297069340299
                                         uncertainty =       0.001785577535

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297069340299
                                         uncertainty =       0.001785577535

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385396853
  error estimate for blocks of size 2^( 2) =       0.000395402369
  error estimate for blocks of size 2^( 3) =       0.000404332286
  error estimate for blocks of size 2^( 4) =       0.000411591248
  error estimate for blocks of size 2^( 5) =       0.000415197042
  error estimate for blocks of size 2^( 6) =       0.000417463878
  error estimate for blocks of size 2^( 7) =       0.000416920236

      target function =                  N/A
              le_mean =     -17.215342064787
             les_mean =     296.679321450905
             stat err =       0.000415293101
             autocorr =       1.161162778918
              std dev =       0.545033455807
             le_variance =       0.297061467949


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721534206479e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+06, overlap shift 2.3283e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215342064829       residual = 2.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215342064829       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215342064829       residual = 6.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215342064829       residual = 3.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215342064864       residual = 4.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215342064149       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215342064735       residual = 3.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215342064441       residual = 5.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215342061508       residual = 2.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215342064781       residual = 8.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+06 is 3.160788e-10

solving harmonic davidson linear method for identity shift 9.3132e+06, overlap shift 9.3132e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215342064829       residual = 2.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215342064829       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215342064829       residual = 6.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215342064829       residual = 3.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215342065000       residual = 4.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215342069532       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215342068930       residual = 3.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215342079034       residual = 5.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215342062761       residual = 2.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215342059120       residual = 8.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+06 is 7.902003e-11

solving harmonic davidson linear method for identity shift 3.7253e+07, overlap shift 3.7253e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215342064829       residual = 2.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215342064829       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215342064829       residual = 6.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215342064829       residual = 3.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215342060638       residual = 4.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215342021177       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215342064457       residual = 3.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215342056132       residual = 5.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215342058727       residual = 2.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215342075042       residual = 8.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.7253e+07 is 1.975462e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.277668 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8856e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216823e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397753e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377679e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.2764
    reference variance = 0.277513
====================================================
  Execution time = 3.7008e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1452e-01
  Total weights = 1.9568e+06
  Execution time = 3.3599e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299009836825
                                         uncertainty =       0.002634360366

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299009836825
                                         uncertainty =       0.002634360366

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386747223
  error estimate for blocks of size 2^( 2) =       0.000396546151
  error estimate for blocks of size 2^( 3) =       0.000405534982
  error estimate for blocks of size 2^( 4) =       0.000412320530
  error estimate for blocks of size 2^( 5) =       0.000416223617
  error estimate for blocks of size 2^( 6) =       0.000418034777
  error estimate for blocks of size 2^( 7) =       0.000418848414

      target function =                  N/A
              le_mean =     -17.216464576493
             les_mean =     296.721168939983
             stat err =       0.000416356834
             autocorr =       1.158982791076
              std dev =       0.546943168313
             le_variance =       0.299146829364

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299009836930
                                         uncertainty =       0.002634360367

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299009836930
                                         uncertainty =       0.002634360367

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386747223
  error estimate for blocks of size 2^( 2) =       0.000396546151
  error estimate for blocks of size 2^( 3) =       0.000405534982
  error estimate for blocks of size 2^( 4) =       0.000412320530
  error estimate for blocks of size 2^( 5) =       0.000416223617
  error estimate for blocks of size 2^( 6) =       0.000418034777
  error estimate for blocks of size 2^( 7) =       0.000418848414

      target function =                  N/A
              le_mean =     -17.216464576495
             les_mean =     296.721168939411
             stat err =       0.000416356835
             autocorr =       1.158982790941
              std dev =       0.546943168410
             le_variance =       0.299146829471

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299009836878
                                         uncertainty =       0.002634360367

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299009836878
                                         uncertainty =       0.002634360367

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386747223
  error estimate for blocks of size 2^( 2) =       0.000396546151
  error estimate for blocks of size 2^( 3) =       0.000405534982
  error estimate for blocks of size 2^( 4) =       0.000412320530
  error estimate for blocks of size 2^( 5) =       0.000416223617
  error estimate for blocks of size 2^( 6) =       0.000418034777
  error estimate for blocks of size 2^( 7) =       0.000418848414

      target function =                  N/A
              le_mean =     -17.216464576494
             les_mean =     296.721168939697
             stat err =       0.000416356835
             autocorr =       1.158982791004
              std dev =       0.546943168362
             le_variance =       0.299146829417

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299009836832
                                         uncertainty =       0.002634360366

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299009836832
                                         uncertainty =       0.002634360366

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386747223
  error estimate for blocks of size 2^( 2) =       0.000396546151
  error estimate for blocks of size 2^( 3) =       0.000405534982
  error estimate for blocks of size 2^( 4) =       0.000412320530
  error estimate for blocks of size 2^( 5) =       0.000416223617
  error estimate for blocks of size 2^( 6) =       0.000418034777
  error estimate for blocks of size 2^( 7) =       0.000418848414

      target function =                  N/A
              le_mean =     -17.216464576493
             les_mean =     296.721168939947
             stat err =       0.000416356834
             autocorr =       1.158982791066
              std dev =       0.546943168319
             le_variance =       0.299146829371


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216464576493        initial
     2.3283e+06     2.3283e+07             3.1608e-10       -17.216464576495  <--
     9.3132e+06     9.3132e+07             7.9020e-11       -17.216464576494
     3.7253e+07     3.7253e+08             1.9755e-11       -17.216464576493

*****************************************************************************
Applying the update for shift_i =   2.3283e+06     and shift_s =   2.3283e+07
*****************************************************************************

  Execution time = 5.3974e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0284e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.1926
    reference variance = 0.242122
====================================================
  Execution time = 3.7669e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5274e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1365e-01
  Total weights = 1.956590863e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0843e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299012972049
                                         uncertainty =       0.001836153667

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299012972049
                                         uncertainty =       0.001836153667

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386628905
  error estimate for blocks of size 2^( 2) =       0.000397029931
  error estimate for blocks of size 2^( 3) =       0.000405875462
  error estimate for blocks of size 2^( 4) =       0.000413674182
  error estimate for blocks of size 2^( 5) =       0.000418487292
  error estimate for blocks of size 2^( 6) =       0.000420518807
  error estimate for blocks of size 2^( 7) =       0.000420877221

      target function =                  N/A
              le_mean =     -17.216349179912
             les_mean =     296.716328415470
             stat err =       0.000418389375
             autocorr =       1.171042495534
              std dev =       0.546775841459
             le_variance =       0.298963820803


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721634917991e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+05, overlap shift 5.8208e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216349179962       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216349179964       residual = 7.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216349179964       residual = 5.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216349179967       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216349179881       residual = 3.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216349179968       residual = 8.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216349179173       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216349180264       residual = 3.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216349179859       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216349179743       residual = 2.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.8208e+05 is 1.158201e-09

solving harmonic davidson linear method for identity shift 2.3283e+06, overlap shift 2.3283e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216349179962       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216349179963       residual = 7.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216349179963       residual = 5.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216349179963       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216349179963       residual = 3.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216349182598       residual = 8.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216349179785       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216349181174       residual = 3.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216349180097       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216349172103       residual = 2.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+06 is 2.895503e-10

solving harmonic davidson linear method for identity shift 9.3132e+06, overlap shift 9.3132e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216349179962       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216349179962       residual = 7.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216349179962       residual = 5.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216349179962       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216349180340       residual = 3.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216349179099       residual = 8.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216349189677       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216349182239       residual = 3.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216349180617       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216349173782       residual = 2.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+06 is 7.238766e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.281675 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8525e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564962e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608456e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.2267
    reference variance = 0.296899
====================================================
  Execution time = 3.7139e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1783e-01
  Total weights = 1.9566e+06
  Execution time = 3.3574e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301013298878
                                         uncertainty =       0.003057606119

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301013298878
                                         uncertainty =       0.003057606119

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387937790
  error estimate for blocks of size 2^( 2) =       0.000397758032
  error estimate for blocks of size 2^( 3) =       0.000406432294
  error estimate for blocks of size 2^( 4) =       0.000413023118
  error estimate for blocks of size 2^( 5) =       0.000417390883
  error estimate for blocks of size 2^( 6) =       0.000419469664
  error estimate for blocks of size 2^( 7) =       0.000421480903

      target function =                  N/A
              le_mean =     -17.216111332339
             les_mean =     296.712319701524
             stat err =       0.000417841142
             autocorr =       1.160107475605
              std dev =       0.548626883408
             le_variance =       0.300991457198

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301013299236
                                         uncertainty =       0.003057606132

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301013299236
                                         uncertainty =       0.003057606132

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387937790
  error estimate for blocks of size 2^( 2) =       0.000397758032
  error estimate for blocks of size 2^( 3) =       0.000406432294
  error estimate for blocks of size 2^( 4) =       0.000413023118
  error estimate for blocks of size 2^( 5) =       0.000417390883
  error estimate for blocks of size 2^( 6) =       0.000419469664
  error estimate for blocks of size 2^( 7) =       0.000421480903

      target function =                  N/A
              le_mean =     -17.216111332327
             les_mean =     296.712319702046
             stat err =       0.000417841142
             autocorr =       1.160107475309
              std dev =       0.548626883734
             le_variance =       0.300991457556

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301013299057
                                         uncertainty =       0.003057606125

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301013299057
                                         uncertainty =       0.003057606125

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387937790
  error estimate for blocks of size 2^( 2) =       0.000397758032
  error estimate for blocks of size 2^( 3) =       0.000406432294
  error estimate for blocks of size 2^( 4) =       0.000413023118
  error estimate for blocks of size 2^( 5) =       0.000417390883
  error estimate for blocks of size 2^( 6) =       0.000419469664
  error estimate for blocks of size 2^( 7) =       0.000421480903

      target function =                  N/A
              le_mean =     -17.216111332333
             les_mean =     296.712319701785
             stat err =       0.000417841142
             autocorr =       1.160107475468
              std dev =       0.548626883571
             le_variance =       0.300991457377

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301013298901
                                         uncertainty =       0.003057606119

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301013298901
                                         uncertainty =       0.003057606119

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387937790
  error estimate for blocks of size 2^( 2) =       0.000397758032
  error estimate for blocks of size 2^( 3) =       0.000406432294
  error estimate for blocks of size 2^( 4) =       0.000413023118
  error estimate for blocks of size 2^( 5) =       0.000417390883
  error estimate for blocks of size 2^( 6) =       0.000419469664
  error estimate for blocks of size 2^( 7) =       0.000421480903

      target function =                  N/A
              le_mean =     -17.216111332338
             les_mean =     296.712319701556
             stat err =       0.000417841142
             autocorr =       1.160107475583
              std dev =       0.548626883428
             le_variance =       0.300991457220


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216111332339        initial  <--
     5.8208e+05     5.8208e+06             1.1582e-09       -17.216111332327
     2.3283e+06     2.3283e+07             2.8955e-10       -17.216111332333
     9.3132e+06     9.3132e+07             7.2388e-11       -17.216111332338

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 54.1334
  </log>
  <optVariables href="H2O.s032.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0267e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.2161
    reference variance = 0.219702
====================================================
  Execution time = 3.7446e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5281e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1368e-01
  Total weights = 1.956701673e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0868e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298731376947
                                         uncertainty =       0.001742447100

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298731376947
                                         uncertainty =       0.001742447100

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386466434
  error estimate for blocks of size 2^( 2) =       0.000396450478
  error estimate for blocks of size 2^( 3) =       0.000405460624
  error estimate for blocks of size 2^( 4) =       0.000412682751
  error estimate for blocks of size 2^( 5) =       0.000417567953
  error estimate for blocks of size 2^( 6) =       0.000421401856
  error estimate for blocks of size 2^( 7) =       0.000422038842

      target function =                  N/A
              le_mean =     -17.216885038720
             les_mean =     296.734809456477
             stat err =       0.000418422850
             autocorr =       1.172214872877
              std dev =       0.546546072660
             le_variance =       0.298712609540


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721688503872e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+06, overlap shift 5.8208e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216885038800       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216885038801       residual = 9.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216885038801       residual = 6.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216885038677       residual = 3.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216885036912       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216885038497       residual = 5.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216885037785       residual = 2.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216885035809       residual = 3.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216885038739       residual = 8.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.8208e+06 is 1.279941e-10

solving harmonic davidson linear method for identity shift 2.3283e+07, overlap shift 2.3283e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216885038800       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216885038800       residual = 9.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216885038800       residual = 6.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216885038731       residual = 3.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216885039607       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216885035755       residual = 5.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216885020152       residual = 2.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216885060208       residual = 3.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216885023391       residual = 8.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+07 is 3.199849e-11

solving harmonic davidson linear method for identity shift 9.3132e+07, overlap shift 9.3132e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216885038800       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216885038800       residual = 9.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216885038800       residual = 6.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216885038800       residual = 3.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216885038753       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216885060563       residual = 5.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216885014746       residual = 2.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216885050851       residual = 3.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216885054471       residual = 8.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+07 is 7.999618e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.285061 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8327e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.2778
    reference variance = 0.654882
====================================================
  Execution time = 3.7456e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1905e-01
  Total weights = 1.9568e+06
  Execution time = 3.3641e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301656050103
                                         uncertainty =       0.002105776305

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301656050103
                                         uncertainty =       0.002105776305

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388474054
  error estimate for blocks of size 2^( 2) =       0.000398581271
  error estimate for blocks of size 2^( 3) =       0.000408031949
  error estimate for blocks of size 2^( 4) =       0.000414729557
  error estimate for blocks of size 2^( 5) =       0.000417867665
  error estimate for blocks of size 2^( 6) =       0.000419051811
  error estimate for blocks of size 2^( 7) =       0.000420728894

      target function =                  N/A
              le_mean =     -17.216938988923
             les_mean =     296.742040696418
             stat err =       0.000418094482
             autocorr =       1.158310076732
              std dev =       0.549385276388
             le_variance =       0.301824181912

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301656050142
                                         uncertainty =       0.002105776306

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301656050142
                                         uncertainty =       0.002105776306

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388474054
  error estimate for blocks of size 2^( 2) =       0.000398581272
  error estimate for blocks of size 2^( 3) =       0.000408031949
  error estimate for blocks of size 2^( 4) =       0.000414729557
  error estimate for blocks of size 2^( 5) =       0.000417867665
  error estimate for blocks of size 2^( 6) =       0.000419051811
  error estimate for blocks of size 2^( 7) =       0.000420728894

      target function =                  N/A
              le_mean =     -17.216938988922
             les_mean =     296.742040696358
             stat err =       0.000418094482
             autocorr =       1.158310076699
              std dev =       0.549385276423
             le_variance =       0.301824181951

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301656050123
                                         uncertainty =       0.002105776305

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301656050123
                                         uncertainty =       0.002105776305

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388474054
  error estimate for blocks of size 2^( 2) =       0.000398581271
  error estimate for blocks of size 2^( 3) =       0.000408031949
  error estimate for blocks of size 2^( 4) =       0.000414729557
  error estimate for blocks of size 2^( 5) =       0.000417867665
  error estimate for blocks of size 2^( 6) =       0.000419051811
  error estimate for blocks of size 2^( 7) =       0.000420728894

      target function =                  N/A
              le_mean =     -17.216938988923
             les_mean =     296.742040696388
             stat err =       0.000418094482
             autocorr =       1.158310076714
              std dev =       0.549385276405
             le_variance =       0.301824181931

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301656050106
                                         uncertainty =       0.002105776305

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301656050106
                                         uncertainty =       0.002105776305

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388474054
  error estimate for blocks of size 2^( 2) =       0.000398581271
  error estimate for blocks of size 2^( 3) =       0.000408031949
  error estimate for blocks of size 2^( 4) =       0.000414729557
  error estimate for blocks of size 2^( 5) =       0.000417867665
  error estimate for blocks of size 2^( 6) =       0.000419051811
  error estimate for blocks of size 2^( 7) =       0.000420728894

      target function =                  N/A
              le_mean =     -17.216938988923
             les_mean =     296.742040696414
             stat err =       0.000418094482
             autocorr =       1.158310076733
              std dev =       0.549385276390
             le_variance =       0.301824181914


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216938988923        initial  <--
     5.8208e+06     5.8208e+07             1.2799e-10       -17.216938988922
     2.3283e+07     2.3283e+08             3.1998e-11       -17.216938988923
     9.3132e+07     9.3132e+08             7.9996e-12       -17.216938988923

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 54.4476
  </log>
  <optVariables href="H2O.s033.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0278e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7222e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.2626
    reference variance = 0.280301
====================================================
  Execution time = 3.7695e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5303e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1468e-01
  Total weights = 1.956531869e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0880e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299706833832
                                         uncertainty =       0.002416780234

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299706833832
                                         uncertainty =       0.002416780234

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387088914
  error estimate for blocks of size 2^( 2) =       0.000396712205
  error estimate for blocks of size 2^( 3) =       0.000405556100
  error estimate for blocks of size 2^( 4) =       0.000411990236
  error estimate for blocks of size 2^( 5) =       0.000414896300
  error estimate for blocks of size 2^( 6) =       0.000417021428
  error estimate for blocks of size 2^( 7) =       0.000417859939

      target function =                  N/A
              le_mean =     -17.215698102498
             les_mean =     296.694941990906
             stat err =       0.000415441976
             autocorr =       1.151858903730
              std dev =       0.547426391519
             le_variance =       0.299675654132


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721569810250e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+07, overlap shift 5.8208e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215698102541       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215698102541       residual = 6.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215698102541       residual = 8.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215698098520       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215698099328       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215698102541       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215698088375       residual = 2.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215698098269       residual = 6.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215698122825       residual = 1.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215698077815       residual = 7.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.8208e+07 is 1.247646e-11

solving harmonic davidson linear method for identity shift 2.3283e+08, overlap shift 2.3283e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215698102541       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215698102541       residual = 6.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215698102541       residual = 8.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215698090530       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215698000243       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215697995815       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215698190131       residual = 2.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215698021480       residual = 6.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215698543516       residual = 1.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215698132342       residual = 7.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+08 is 3.119597e-12

solving harmonic davidson linear method for identity shift 9.3132e+08, overlap shift 9.3132e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215698102541       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215698102541       residual = 6.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215698102541       residual = 8.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215697880476       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215698275270       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215698193634       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215697734882       residual = 2.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215698710749       residual = 6.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215697935834       residual = 1.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215697373319       residual = 7.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+08 is 7.798157e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.288958 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8590e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.2344
    reference variance = 0.220544
====================================================
  Execution time = 3.7141e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1562e-01
  Total weights = 1.9566e+06
  Execution time = 3.3462e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302182300713
                                         uncertainty =       0.002512111456

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302182300713
                                         uncertainty =       0.002512111456

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388649101
  error estimate for blocks of size 2^( 2) =       0.000398452856
  error estimate for blocks of size 2^( 3) =       0.000407099715
  error estimate for blocks of size 2^( 4) =       0.000414112387
  error estimate for blocks of size 2^( 5) =       0.000417590555
  error estimate for blocks of size 2^( 6) =       0.000419503338
  error estimate for blocks of size 2^( 7) =       0.000418728492

      target function =                  N/A
              le_mean =     -17.217115085132
             les_mean =     296.744667801909
             stat err =       0.000417483693
             autocorr =       1.153888108721
              std dev =       0.549632829846
             le_variance =       0.302096247645

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302182300715
                                         uncertainty =       0.002512111456

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302182300715
                                         uncertainty =       0.002512111456

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388649101
  error estimate for blocks of size 2^( 2) =       0.000398452856
  error estimate for blocks of size 2^( 3) =       0.000407099715
  error estimate for blocks of size 2^( 4) =       0.000414112387
  error estimate for blocks of size 2^( 5) =       0.000417590555
  error estimate for blocks of size 2^( 6) =       0.000419503338
  error estimate for blocks of size 2^( 7) =       0.000418728492

      target function =                  N/A
              le_mean =     -17.217115085132
             les_mean =     296.744667801922
             stat err =       0.000417483693
             autocorr =       1.153888108717
              std dev =       0.549632829849
             le_variance =       0.302096247647

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302182300714
                                         uncertainty =       0.002512111456

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302182300714
                                         uncertainty =       0.002512111456

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388649101
  error estimate for blocks of size 2^( 2) =       0.000398452856
  error estimate for blocks of size 2^( 3) =       0.000407099715
  error estimate for blocks of size 2^( 4) =       0.000414112387
  error estimate for blocks of size 2^( 5) =       0.000417590555
  error estimate for blocks of size 2^( 6) =       0.000419503338
  error estimate for blocks of size 2^( 7) =       0.000418728492

      target function =                  N/A
              le_mean =     -17.217115085132
             les_mean =     296.744667801915
             stat err =       0.000417483693
             autocorr =       1.153888108715
              std dev =       0.549632829847
             le_variance =       0.302096247646

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302182300713
                                         uncertainty =       0.002512111456

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302182300713
                                         uncertainty =       0.002512111456

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388649101
  error estimate for blocks of size 2^( 2) =       0.000398452856
  error estimate for blocks of size 2^( 3) =       0.000407099715
  error estimate for blocks of size 2^( 4) =       0.000414112387
  error estimate for blocks of size 2^( 5) =       0.000417590555
  error estimate for blocks of size 2^( 6) =       0.000419503338
  error estimate for blocks of size 2^( 7) =       0.000418728492

      target function =                  N/A
              le_mean =     -17.217115085132
             les_mean =     296.744667801910
             stat err =       0.000417483693
             autocorr =       1.153888108723
              std dev =       0.549632829846
             le_variance =       0.302096247645


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217115085132        initial  <--
     5.8208e+07     5.8208e+08             1.2476e-11       -17.217115085132
     2.3283e+08     2.3283e+09             3.1196e-12       -17.217115085132
     9.3132e+08     9.3132e+09             7.7982e-13       -17.217115085132

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 54.0595
  </log>
  <optVariables href="H2O.s034.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0266e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7222e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.1753
    reference variance = 0.153937
====================================================
  Execution time = 3.7575e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5280e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1068e-01
  Total weights = 1.956901712e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1034e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296026302789
                                         uncertainty =       0.001710161373

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296026302789
                                         uncertainty =       0.001710161373

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384959654
  error estimate for blocks of size 2^( 2) =       0.000395656750
  error estimate for blocks of size 2^( 3) =       0.000404416271
  error estimate for blocks of size 2^( 4) =       0.000411029802
  error estimate for blocks of size 2^( 5) =       0.000414848501
  error estimate for blocks of size 2^( 6) =       0.000417266737
  error estimate for blocks of size 2^( 7) =       0.000416632149

      target function =                  N/A
              le_mean =     -17.216548834029
             les_mean =     296.720237701788
             stat err =       0.000414944297
             autocorr =       1.161847612813
              std dev =       0.544415163172
             le_variance =       0.296387869892


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721654883403e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+08, overlap shift 5.8208e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216548834077       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216548834077       residual = 3.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216548834077       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216548834077       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216548672385       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216549034108       residual = 4.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216548892481       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216548575512       residual = 4.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216548730942       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216548540667       residual = 3.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.8208e+08 is 1.163115e-12

solving harmonic davidson linear method for identity shift 2.3283e+09, overlap shift 2.3283e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216548834077       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216548834077       residual = 3.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216548834077       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216548834077       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216548834077       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216548834077       residual = 4.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216548407583       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216551348306       residual = 5.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216547559862       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216548793671       residual = 3.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+09 is 2.909053e-13

solving harmonic davidson linear method for identity shift 9.3132e+09, overlap shift 9.3132e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216548834077       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216548834077       residual = 3.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216548834077       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216548834077       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216555450806       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216543573248       residual = 4.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216567498188       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216542411112       residual = 5.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216553084446       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216536399102       residual = 3.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216552725247       residual = 6.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+09 is 7.223310e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.293142 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8621e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.1856
    reference variance = 0.176863
====================================================
  Execution time = 3.7256e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1195e-01
  Total weights = 1.9565e+06
  Execution time = 3.3389e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299067545577
                                         uncertainty =       0.002143434931

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299067545577
                                         uncertainty =       0.002143434931

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386659011
  error estimate for blocks of size 2^( 2) =       0.000396821855
  error estimate for blocks of size 2^( 3) =       0.000406141338
  error estimate for blocks of size 2^( 4) =       0.000412813361
  error estimate for blocks of size 2^( 5) =       0.000417013588
  error estimate for blocks of size 2^( 6) =       0.000418646683
  error estimate for blocks of size 2^( 7) =       0.000420206333

      target function =                  N/A
              le_mean =     -17.216467545390
             les_mean =     296.718707684233
             stat err =       0.000417169991
             autocorr =       1.164045212185
              std dev =       0.546818417445
             le_variance =       0.299010381657

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299067545577
                                         uncertainty =       0.002143434931

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299067545577
                                         uncertainty =       0.002143434931

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386659011
  error estimate for blocks of size 2^( 2) =       0.000396821855
  error estimate for blocks of size 2^( 3) =       0.000406141338
  error estimate for blocks of size 2^( 4) =       0.000412813361
  error estimate for blocks of size 2^( 5) =       0.000417013588
  error estimate for blocks of size 2^( 6) =       0.000418646683
  error estimate for blocks of size 2^( 7) =       0.000420206333

      target function =                  N/A
              le_mean =     -17.216467545390
             les_mean =     296.718707684233
             stat err =       0.000417169991
             autocorr =       1.164045212184
              std dev =       0.546818417445
             le_variance =       0.299010381657

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299067545577
                                         uncertainty =       0.002143434931

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299067545577
                                         uncertainty =       0.002143434931

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386659011
  error estimate for blocks of size 2^( 2) =       0.000396821855
  error estimate for blocks of size 2^( 3) =       0.000406141338
  error estimate for blocks of size 2^( 4) =       0.000412813361
  error estimate for blocks of size 2^( 5) =       0.000417013588
  error estimate for blocks of size 2^( 6) =       0.000418646683
  error estimate for blocks of size 2^( 7) =       0.000420206333

      target function =                  N/A
              le_mean =     -17.216467545390
             les_mean =     296.718707684233
             stat err =       0.000417169991
             autocorr =       1.164045212185
              std dev =       0.546818417445
             le_variance =       0.299010381657

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299067545577
                                         uncertainty =       0.002143434931

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299067545577
                                         uncertainty =       0.002143434931

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386659011
  error estimate for blocks of size 2^( 2) =       0.000396821855
  error estimate for blocks of size 2^( 3) =       0.000406141338
  error estimate for blocks of size 2^( 4) =       0.000412813361
  error estimate for blocks of size 2^( 5) =       0.000417013588
  error estimate for blocks of size 2^( 6) =       0.000418646683
  error estimate for blocks of size 2^( 7) =       0.000420206333

      target function =                  N/A
              le_mean =     -17.216467545390
             les_mean =     296.718707684233
             stat err =       0.000417169991
             autocorr =       1.164045212186
              std dev =       0.546818417445
             le_variance =       0.299010381657


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216467545390        initial  <--
     5.8208e+08     5.8208e+09             1.1631e-12       -17.216467545390
     2.3283e+09     2.3283e+10             2.9091e-13       -17.216467545390
     9.3132e+09     9.3132e+10             7.2233e-14       -17.216467545390

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 54.1286
  </log>
  <optVariables href="H2O.s035.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0276e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.2523
    reference variance = 0.185295
====================================================
  Execution time = 3.7500e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5282e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1933e-01
  Total weights = 1.957008911e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1106e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304656575618
                                         uncertainty =       0.003411461578

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304656575618
                                         uncertainty =       0.003411461578

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390323691
  error estimate for blocks of size 2^( 2) =       0.000400474578
  error estimate for blocks of size 2^( 3) =       0.000409939508
  error estimate for blocks of size 2^( 4) =       0.000416784740
  error estimate for blocks of size 2^( 5) =       0.000419954432
  error estimate for blocks of size 2^( 6) =       0.000419903364
  error estimate for blocks of size 2^( 7) =       0.000420265270

      target function =                  N/A
              le_mean =     -17.217038450804
             les_mean =     296.745743630739
             stat err =       0.000419226951
             autocorr =       1.153582254452
              std dev =       0.552001057240
             le_variance =       0.304705167194


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721703845080e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+09, overlap shift 5.8208e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217038450859       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217038450859       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217038450859       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217038450859       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217039250078       residual = 3.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217037089994       residual = 7.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217036657353       residual = 2.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217037376381       residual = 4.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217040397032       residual = 1.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217039284669       residual = 4.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.8208e+09 is 1.238749e-13

solving harmonic davidson linear method for identity shift 2.3283e+10, overlap shift 2.3283e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217038450859       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217038450859       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217038450859       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217038450859       residual = 4.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217055964679       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217017602853       residual = 6.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217024132781       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217037888461       residual = 5.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217120774108       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216958102854       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.217130557828       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216952892694       residual = 9.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216997036031       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.217321795821       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.217230512920       residual = 5.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.216818266491       residual = 7.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.217683275288       residual = 6.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.217150106567       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.217010443462       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.216469730840       residual = 5.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.216768129926       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.217309724642       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.217446309623       residual = 2.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.216290984612       residual = 9.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.216810382873       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.216645975782       residual = 2.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.217546652655       residual = 4.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.215942895746       residual = 1.95e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -17.217092762044       residual = 9.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -17.216644343835       residual = 2.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -17.218783513361       residual = 4.49e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -17.218737174292       residual = 4.54e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -17.218668857671       residual = 4.28e-04           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -17.216489857086       residual = 5.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -17.218251027011       residual = 2.45e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   energy =     -17.216981395022       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   energy =     -17.217033903717       residual = 7.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   energy =     -17.218104881366       residual = 2.35e-04           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   energy =     -17.222177946536       residual = 4.21e-03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   energy =     -17.214080187650       residual = 1.40e-03           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   energy =     -17.216621139792       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   energy =     -17.210552026425       residual = 6.60e-03           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   energy =     -17.209931953815       residual = 7.80e-03           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   energy =     -17.214824130061       residual = 8.26e-04           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   energy =     -17.212534419773       residual = 3.26e-03           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   energy =     -17.213943320206       residual = 1.53e-03           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   energy =     -17.216146360979       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   energy =     -17.216919814988       residual = 2.83e-04           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   energy =     -17.213110601210       residual = 2.43e-03           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   energy =     -17.226286848985       residual = 1.32e-02           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   energy =     -17.211133612947       residual = 5.84e-03           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   energy =     -17.219147072045       residual = 9.26e-04           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   energy =     -17.217187971966       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   energy =     -17.226552272736       residual = 1.44e-02           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   energy =     -17.220860225250       residual = 2.69e-03           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   energy =     -17.220818575213       residual = 2.44e-03           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   energy =     -17.211368198317       residual = 5.20e-03           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   energy =     -17.200176905461       residual = 4.44e-02           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   energy =     -17.210713736310       residual = 6.64e-03           smallest_sin_value = 9.99e-01
davidson iteration   59:   krylov dim =  60   energy =     -17.202851677467       residual = 3.18e-02           smallest_sin_value = 9.98e-01
davidson iteration   60:   krylov dim =  61   energy =     -17.205363387801       residual = 2.39e-02           smallest_sin_value = 9.98e-01
davidson iteration   61:   krylov dim =  62   energy =     -17.209549689331       residual = 8.90e-03           smallest_sin_value = 9.92e-01
davidson iteration   62 stopping due to small subspace S singular value of 9.84e-01
davidson solver did not converge after         62 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+10 is 2.988450e-14

solving harmonic davidson linear method for identity shift 9.3132e+10, overlap shift 9.3132e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217038450859       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217038450859       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217038450859       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217038450859       residual = 4.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217028353458       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217033405079       residual = 6.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217039460262       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217013124723       residual = 2.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217037174102       residual = 7.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217066927668       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.217224954795       residual = 6.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216622640108       residual = 2.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.217650661737       residual = 5.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.218652074820       residual = 4.04e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.218423624262       residual = 2.80e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.215515721876       residual = 3.74e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.217726859796       residual = 7.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.215012732625       residual = 6.61e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.216445967501       residual = 5.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.216685529290       residual = 3.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.217579395556       residual = 5.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.220620065351       residual = 1.99e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.217641890338       residual = 5.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.218170662371       residual = 2.05e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.215831003239       residual = 2.65e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.219632790515       residual = 1.08e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.215628836848       residual = 3.62e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.215217628388       residual = 5.57e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -17.213845840920       residual = 1.61e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -17.212736202422       residual = 2.81e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -17.215490338321       residual = 4.08e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -17.221473904919       residual = 3.02e-03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -17.212393333944       residual = 3.56e-03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -17.216007521183       residual = 2.35e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -17.211481745054       residual = 4.80e-03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   energy =     -17.218470482951       residual = 4.22e-04           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   energy =     -17.221385651414       residual = 3.00e-03           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   energy =     -17.221612828973       residual = 3.36e-03           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   energy =     -17.216962856576       residual = 3.75e-04           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   energy =     -17.205884157953       residual = 1.93e-02           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   energy =     -17.218114813819       residual = 3.24e-04           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   energy =     -17.220888003343       residual = 2.20e-03           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   energy =     -17.216252695299       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   energy =     -17.214646910592       residual = 9.83e-04           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   energy =     -17.213816628242       residual = 2.04e-03           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   energy =     -17.222692678647       residual = 5.55e-03           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   energy =     -17.219392054306       residual = 1.58e-03           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   energy =     -17.215455310305       residual = 9.59e-04           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   energy =     -17.231590890417       residual = 3.30e-02           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   energy =     -17.201152138103       residual = 4.00e-02           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   energy =     -17.211383364390       residual = 5.61e-03           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   energy =     -17.237243570363       residual = 6.44e-02           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   energy =     -17.220282696812       residual = 3.22e-03           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   energy =     -17.228396925726       residual = 2.04e-02           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   energy =     -17.215113977716       residual = 1.12e-03           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   energy =     -17.219169267046       residual = 2.62e-03           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   energy =     -17.228225812266       residual = 2.03e-02           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   energy =     -17.173882522320       residual = 2.91e-01           smallest_sin_value = 9.99e-01
davidson iteration   58:   krylov dim =  59   energy =     -17.238086109484       residual = 7.81e-02           smallest_sin_value = 9.98e-01
davidson iteration   59:   krylov dim =  60   energy =     -17.184689076203       residual = 1.73e-01           smallest_sin_value = 9.95e-01
davidson iteration   60:   krylov dim =  61   energy =     -17.225009544990       residual = 1.15e-01           smallest_sin_value = 9.94e-01
davidson iteration   61 stopping due to small subspace S singular value of 9.75e-01
davidson solver did not converge after         61 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+10 is 7.587659e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.489068 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8811e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.2981
    reference variance = 0.1817
====================================================
  Execution time = 3.7129e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1906e-01
  Total weights = 1.9565e+06
  Execution time = 3.3475e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303340136717
                                         uncertainty =       0.003079210245

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303340136717
                                         uncertainty =       0.003079210245

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389453564
  error estimate for blocks of size 2^( 2) =       0.000399409057
  error estimate for blocks of size 2^( 3) =       0.000408107205
  error estimate for blocks of size 2^( 4) =       0.000414974924
  error estimate for blocks of size 2^( 5) =       0.000418979088
  error estimate for blocks of size 2^( 6) =       0.000421220710
  error estimate for blocks of size 2^( 7) =       0.000422070320

      target function =                  N/A
              le_mean =     -17.216656830776
             les_mean =     296.732331777891
             stat err =       0.000419311261
             autocorr =       1.159208845696
              std dev =       0.550770511714
             le_variance =       0.303348156574

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303340136717
                                         uncertainty =       0.003079210245

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303340136717
                                         uncertainty =       0.003079210245

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389453564
  error estimate for blocks of size 2^( 2) =       0.000399409057
  error estimate for blocks of size 2^( 3) =       0.000408107205
  error estimate for blocks of size 2^( 4) =       0.000414974924
  error estimate for blocks of size 2^( 5) =       0.000418979088
  error estimate for blocks of size 2^( 6) =       0.000421220710
  error estimate for blocks of size 2^( 7) =       0.000422070320

      target function =                  N/A
              le_mean =     -17.216656830776
             les_mean =     296.732331777891
             stat err =       0.000419311261
             autocorr =       1.159208845694
              std dev =       0.550770511715
             le_variance =       0.303348156574

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303340136717
                                         uncertainty =       0.003079210245

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303340136717
                                         uncertainty =       0.003079210245

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389453564
  error estimate for blocks of size 2^( 2) =       0.000399409057
  error estimate for blocks of size 2^( 3) =       0.000408107205
  error estimate for blocks of size 2^( 4) =       0.000414974924
  error estimate for blocks of size 2^( 5) =       0.000418979088
  error estimate for blocks of size 2^( 6) =       0.000421220710
  error estimate for blocks of size 2^( 7) =       0.000422070320

      target function =                  N/A
              le_mean =     -17.216656830776
             les_mean =     296.732331777891
             stat err =       0.000419311261
             autocorr =       1.159208845691
              std dev =       0.550770511715
             le_variance =       0.303348156574

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303340136717
                                         uncertainty =       0.003079210245

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303340136717
                                         uncertainty =       0.003079210245

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389453564
  error estimate for blocks of size 2^( 2) =       0.000399409057
  error estimate for blocks of size 2^( 3) =       0.000408107205
  error estimate for blocks of size 2^( 4) =       0.000414974924
  error estimate for blocks of size 2^( 5) =       0.000418979088
  error estimate for blocks of size 2^( 6) =       0.000421220710
  error estimate for blocks of size 2^( 7) =       0.000422070320

      target function =                  N/A
              le_mean =     -17.216656830776
             les_mean =     296.732331777891
             stat err =       0.000419311261
             autocorr =       1.159208845687
              std dev =       0.550770511714
             le_variance =       0.303348156574


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216656830776        initial  <--
     5.8208e+09     5.8208e+10             1.2387e-13       -17.216656830776
     2.3283e+10     2.3283e+11             2.9885e-14       -17.216656830776
     9.3132e+10     9.3132e+11             7.5877e-15       -17.216656830776

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 56.0400
  </log>
  <optVariables href="H2O.s036.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0486e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7223e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.2158
    reference variance = 0.276948
====================================================
  Execution time = 3.7436e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5270e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1640e-01
  Total weights = 1.956646405e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1249e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300829798905
                                         uncertainty =       0.001823628273

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300829798905
                                         uncertainty =       0.001823628273

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387887615
  error estimate for blocks of size 2^( 2) =       0.000398184084
  error estimate for blocks of size 2^( 3) =       0.000406773872
  error estimate for blocks of size 2^( 4) =       0.000412839353
  error estimate for blocks of size 2^( 5) =       0.000417067089
  error estimate for blocks of size 2^( 6) =       0.000418840361
  error estimate for blocks of size 2^( 7) =       0.000420050105

      target function =                  N/A
              le_mean =     -17.216665618198
             les_mean =     296.729970198585
             stat err =       0.000417199227
             autocorr =       1.156844973464
              std dev =       0.548555925593
             le_variance =       0.300913603503


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721666561820e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+10, overlap shift 5.8208e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216665618214       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216665618214       residual = 3.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216665618214       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216685417559       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216660237341       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216656366032       residual = 5.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216608836272       residual = 7.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216672209994       residual = 7.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216665992403       residual = 2.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216665066126       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.217004392448       residual = 1.74e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216430798568       residual = 8.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216683271965       residual = 2.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216374073892       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.217090343910       residual = 2.91e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.217756718354       residual = 1.92e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.218274907128       residual = 4.01e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.217043620185       residual = 2.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.215830390418       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.211760557347       residual = 3.82e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.219532868313       residual = 1.29e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.214266989475       residual = 8.57e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.214432177590       residual = 7.45e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.216541312547       residual = 5.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.218845533840       residual = 7.54e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.217539360017       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.218053224044       residual = 3.09e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.219775669237       residual = 1.53e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -17.217612719941       residual = 2.23e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -17.212354763595       residual = 3.49e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -17.217844594703       residual = 4.83e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -17.210653423533       residual = 6.35e-03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -17.210712825297       residual = 5.63e-03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -17.226577137486       residual = 1.69e-02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -17.239317938297       residual = 8.71e-02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   energy =     -17.215223960244       residual = 7.49e-04           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   energy =     -17.203092160791       residual = 2.95e-02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   energy =     -17.210451879791       residual = 6.65e-03           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   energy =     -17.203235122889       residual = 2.82e-02           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   energy =     -17.221055371252       residual = 3.19e-03           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   energy =     -17.217238510892       residual = 2.01e-03           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   energy =     -17.216285154610       residual = 9.32e-04           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   energy =     -17.214072054077       residual = 9.08e-03           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   energy =     -17.212248064426       residual = 3.51e-03           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   energy =     -17.226285479751       residual = 1.73e-02           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   energy =     -17.215794620687       residual = 1.36e-03           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   energy =     -17.218468375518       residual = 5.69e-04           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   energy =     -17.209504570989       residual = 1.01e-02           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   energy =     -17.215658671851       residual = 4.31e-03           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   energy =     -17.208806279545       residual = 1.23e-02           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   energy =     -17.220186444329       residual = 4.40e-03           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   energy =     -17.216582810090       residual = 3.28e-03           smallest_sin_value = 9.99e-01
davidson iteration   52:   krylov dim =  53   energy =     -17.211061351488       residual = 4.99e-03           smallest_sin_value = 9.99e-01
davidson iteration   53:   krylov dim =  54   energy =     -17.220753123292       residual = 3.27e-03           smallest_sin_value = 9.99e-01
davidson iteration   54:   krylov dim =  55   energy =     -17.211130258933       residual = 8.97e-03           smallest_sin_value = 9.99e-01
davidson iteration   55:   krylov dim =  56   energy =     -17.234038389041       residual = 4.87e-02           smallest_sin_value = 9.99e-01
davidson iteration   56:   krylov dim =  57   energy =     -17.184501241873       residual = 1.60e-01           smallest_sin_value = 9.99e-01
davidson iteration   57:   krylov dim =  58   energy =     -17.232474348503       residual = 6.05e-02           smallest_sin_value = 9.98e-01
davidson iteration   58:   krylov dim =  59   energy =     -17.202516162551       residual = 3.65e-02           smallest_sin_value = 9.92e-01
davidson iteration   59 stopping due to small subspace S singular value of 9.63e-01
davidson solver did not converge after         59 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.8208e+10 is 1.216144e-14

solving harmonic davidson linear method for identity shift 2.3283e+11, overlap shift 2.3283e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216665618214       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216665618214       residual = 3.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216665618214       residual = 6.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216729646916       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215155131673       residual = 3.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216922858226       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216751919708       residual = 6.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217302791010       residual = 5.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216278187418       residual = 1.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216159566830       residual = 3.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.217403362526       residual = 8.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.215469028283       residual = 2.50e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.213657763172       residual = 1.59e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.218385535498       residual = 5.03e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.214400083896       residual = 8.47e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.218998141148       residual = 9.48e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.214473721968       residual = 6.91e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.209472667112       residual = 7.68e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.210721745876       residual = 5.60e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.198753390896       residual = 4.96e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.234008994417       residual = 4.79e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.207715992815       residual = 1.30e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.211591969348       residual = 4.56e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.237612076555       residual = 6.91e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.219785564976       residual = 1.73e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.212075959964       residual = 3.21e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.211276967829       residual = 4.38e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.209859095060       residual = 7.64e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -17.197088372454       residual = 5.83e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -17.195843213927       residual = 6.56e-02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -17.158744851343       residual = 5.37e-01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -17.224341398535       residual = 9.43e-03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -17.222989343582       residual = 1.06e-02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -17.221860423585       residual = 3.68e-03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -17.204091402205       residual = 2.40e-02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   energy =     -17.175690325394       residual = 2.45e-01           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   energy =     -17.193515935474       residual = 7.72e-02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   energy =     -17.161565413008       residual = 5.00e-01           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   energy =     -17.257298963216       residual = 2.37e-01           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   energy =     -17.192730000306       residual = 9.99e-02           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   energy =     -17.195557113644       residual = 8.54e-02           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   energy =     -17.248190273332       residual = 1.51e-01           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   energy =     -17.171936624687       residual = 2.89e-01           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   energy =     -17.267572129316       residual = 4.46e-01           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   energy =     -17.150759292338       residual = 6.47e-01           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   energy =     -17.238896682601       residual = 7.65e-02           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   energy =     -17.233353333842       residual = 4.68e-02           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   energy =     -17.195088954986       residual = 7.31e-02           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   energy =     -17.166055115843       residual = 4.07e-01           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   energy =     -17.205382406415       residual = 2.98e-02           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   energy =     -17.182661784180       residual = 2.17e-01           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   energy =     -17.188268231080       residual = 1.43e-01           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   energy =     -17.004842596709       residual = 7.13e+00           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   energy =     -17.220553936241       residual = 9.18e-02           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   energy =     -17.112422241666       residual = 1.78e+00           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   energy =     -17.192617823596       residual = 2.56e-01           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   energy =     -17.104871838251       residual = 1.83e+00           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   energy =     -17.182548232162       residual = 4.51e-01           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   energy =     -17.324110458388       residual = 1.90e+00           smallest_sin_value = 9.99e-01
davidson iteration   59:   krylov dim =  60   energy =     -17.184515532875       residual = 1.51e-01           smallest_sin_value = 9.97e-01
davidson iteration   60:   krylov dim =  61   energy =     -17.091239071539       residual = 2.76e+00           smallest_sin_value = 9.90e-01
davidson iteration   61 stopping due to small subspace S singular value of 9.86e-01
davidson solver did not converge after         61 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+11 is 1.311843e-15

solving harmonic davidson linear method for identity shift 9.3132e+11, overlap shift 9.3132e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216665618214       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216665618214       residual = 3.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216665618214       residual = 6.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216665618214       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216749364027       residual = 4.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.223853937826       residual = 7.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214904955567       residual = 4.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215588663862       residual = 2.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.226014877314       residual = 1.49e-02           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.205862568343       residual = 1.71e-02           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.211988172255       residual = 3.23e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.218565863291       residual = 3.69e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.210122692284       residual = 6.49e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216182319561       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.205148272977       residual = 2.26e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.205132880999       residual = 2.58e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.199559026920       residual = 4.48e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.233098489760       residual = 4.29e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.331449235424       residual = 2.04e+00           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.195235118685       residual = 6.76e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.236636452136       residual = 6.05e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.174025082971       residual = 2.73e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.217970391668       residual = 5.31e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.218743972789       residual = 4.19e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.138939596198       residual = 9.53e-01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.526034493200       residual = 1.48e+01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.205314930174       residual = 3.09e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.153809018770       residual = 6.18e-01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -17.096474327667       residual = 2.51e+00           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -17.138083397062       residual = 1.01e+00           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -17.302956081798       residual = 1.33e+00           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -17.391856878623       residual = 4.84e+00           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -17.100647577732       residual = 2.11e+00           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -17.251488502677       residual = 2.24e-01           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -17.075506654424       residual = 3.16e+00           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   energy =     -17.640121834646       residual = 2.83e+01           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   energy =     -17.346356465213       residual = 3.07e+00           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   energy =     -17.090844019857       residual = 2.51e+00           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   energy =     -17.357473479908       residual = 3.45e+00           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   energy =     -17.273725368005       residual = 5.13e-01           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   energy =     -17.137810287402       residual = 9.95e-01           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   energy =     -17.198531447293       residual = 2.82e-01           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   energy =     -17.076879703734       residual = 2.83e+00           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   energy =     -17.497768188729       residual = 1.22e+01           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   energy =     -17.131332776135       residual = 1.23e+00           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   energy =     -16.763564292382       residual = 3.30e+01           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   energy =     -17.163950950923       residual = 6.20e-01           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   energy =     -17.154563270342       residual = 1.43e+00           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   energy =     -17.298313648885       residual = 1.13e+00           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   energy =     -17.477071490239       residual = 1.05e+01           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   energy =     -17.177096810749       residual = 5.00e-01           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   energy =     -17.277895588219       residual = 1.29e+00           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   energy =     -17.067893407283       residual = 3.45e+00           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   energy =     -17.406545070630       residual = 5.47e+00           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   energy =     -17.481115071773       residual = 1.05e+01           smallest_sin_value = 9.99e-01
davidson iteration   55:   krylov dim =  56   energy =     -17.085800301853       residual = 7.45e+00           smallest_sin_value = 9.99e-01
davidson iteration   56:   krylov dim =  57   energy =     -17.373368436406       residual = 5.26e+00           smallest_sin_value = 9.98e-01
davidson iteration   57:   krylov dim =  58   energy =     -17.289834964646       residual = 4.40e+00           smallest_sin_value = 9.96e-01
davidson iteration   58:   krylov dim =  59   energy =     -17.101873422614       residual = 3.59e+00           smallest_sin_value = 9.95e-01
davidson iteration   59 stopping due to small subspace S singular value of 9.54e-01
davidson solver did not converge after         59 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+11 is 3.418159e-16

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.746195 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8950e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.2398
    reference variance = 0.381223
====================================================
  Execution time = 3.7852e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1258e-01
  Total weights = 1.9568e+06
  Execution time = 3.3554e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299662858592
                                         uncertainty =       0.001943836705

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299662858592
                                         uncertainty =       0.001943836705

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387117204
  error estimate for blocks of size 2^( 2) =       0.000397111010
  error estimate for blocks of size 2^( 3) =       0.000406332560
  error estimate for blocks of size 2^( 4) =       0.000412933380
  error estimate for blocks of size 2^( 5) =       0.000416911573
  error estimate for blocks of size 2^( 6) =       0.000419623550
  error estimate for blocks of size 2^( 7) =       0.000421084981

      target function =                  N/A
              le_mean =     -17.216798176817
             les_mean =     296.730718999493
             stat err =       0.000417638371
             autocorr =       1.163900465704
              std dev =       0.547466399681
             le_variance =       0.299719458779

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299662858592
                                         uncertainty =       0.001943836705

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299662858592
                                         uncertainty =       0.001943836705

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387117204
  error estimate for blocks of size 2^( 2) =       0.000397111010
  error estimate for blocks of size 2^( 3) =       0.000406332560
  error estimate for blocks of size 2^( 4) =       0.000412933380
  error estimate for blocks of size 2^( 5) =       0.000416911573
  error estimate for blocks of size 2^( 6) =       0.000419623550
  error estimate for blocks of size 2^( 7) =       0.000421084981

      target function =                  N/A
              le_mean =     -17.216798176817
             les_mean =     296.730718999493
             stat err =       0.000417638371
             autocorr =       1.163900465704
              std dev =       0.547466399681
             le_variance =       0.299719458779

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299662858592
                                         uncertainty =       0.001943836705

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299662858592
                                         uncertainty =       0.001943836705

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387117204
  error estimate for blocks of size 2^( 2) =       0.000397111010
  error estimate for blocks of size 2^( 3) =       0.000406332560
  error estimate for blocks of size 2^( 4) =       0.000412933380
  error estimate for blocks of size 2^( 5) =       0.000416911573
  error estimate for blocks of size 2^( 6) =       0.000419623550
  error estimate for blocks of size 2^( 7) =       0.000421084981

      target function =                  N/A
              le_mean =     -17.216798176817
             les_mean =     296.730718999493
             stat err =       0.000417638371
             autocorr =       1.163900465704
              std dev =       0.547466399681
             le_variance =       0.299719458779

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299662858592
                                         uncertainty =       0.001943836705

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299662858592
                                         uncertainty =       0.001943836705

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387117204
  error estimate for blocks of size 2^( 2) =       0.000397111010
  error estimate for blocks of size 2^( 3) =       0.000406332560
  error estimate for blocks of size 2^( 4) =       0.000412933380
  error estimate for blocks of size 2^( 5) =       0.000416911573
  error estimate for blocks of size 2^( 6) =       0.000419623550
  error estimate for blocks of size 2^( 7) =       0.000421084981

      target function =                  N/A
              le_mean =     -17.216798176817
             les_mean =     296.730718999493
             stat err =       0.000417638371
             autocorr =       1.163900465704
              std dev =       0.547466399681
             le_variance =       0.299719458779


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216798176817        initial  <--
     5.8208e+10     5.8208e+11             1.2161e-14       -17.216798176817
     2.3283e+11     2.3283e+12             1.3118e-15       -17.216798176817
     9.3132e+11     9.3132e+12             3.4182e-16       -17.216798176817

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 54.8227
  </log>
  <optVariables href="H2O.s037.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0378e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7223e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.2533
    reference variance = 0.302357
====================================================
  Execution time = 3.7724e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5276e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1904e-01
  Total weights = 1.956543475e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1075e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303549067605
                                         uncertainty =       0.002326211332

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303549067605
                                         uncertainty =       0.002326211332

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389565558
  error estimate for blocks of size 2^( 2) =       0.000399576902
  error estimate for blocks of size 2^( 3) =       0.000408515397
  error estimate for blocks of size 2^( 4) =       0.000414587762
  error estimate for blocks of size 2^( 5) =       0.000419028109
  error estimate for blocks of size 2^( 6) =       0.000421580048
  error estimate for blocks of size 2^( 7) =       0.000421910460

      target function =                  N/A
              le_mean =     -17.217168575995
             les_mean =     296.749931384343
             stat err =       0.000419276595
             autocorr =       1.158350876718
              std dev =       0.550928895675
             le_variance =       0.303522648090


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721716857600e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+11, overlap shift 5.8208e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217168576023       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217168576023       residual = 3.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217168576023       residual = 3.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217168576023       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217025488801       residual = 7.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217168576023       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217168882361       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216972709317       residual = 8.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.220457471955       residual = 1.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216967571316       residual = 2.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.218156732086       residual = 1.76e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.221330041695       residual = 2.58e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.232780399622       residual = 3.70e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.226529839607       residual = 1.41e-02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.215607494731       residual = 4.14e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.211669251250       residual = 4.69e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.222825406624       residual = 4.76e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.214124499955       residual = 1.51e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.235080316677       residual = 5.06e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.205111201959       residual = 2.24e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.231544059961       residual = 3.21e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.238390067527       residual = 7.03e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.230988481666       residual = 2.96e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.196771543598       residual = 6.47e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.241858029335       residual = 9.35e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.251595191343       residual = 1.77e-01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.162945088093       residual = 4.49e-01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.215376811976       residual = 8.46e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -17.177235749240       residual = 2.51e-01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -17.263422971222       residual = 3.25e-01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -17.214490186016       residual = 5.27e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -17.306169918952       residual = 1.23e+00           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -17.183884476308       residual = 1.84e-01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -17.236737655016       residual = 6.80e-02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -17.262816293574       residual = 3.42e-01           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   energy =     -17.068611648280       residual = 3.39e+00           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   energy =     -17.330940904754       residual = 2.14e+00           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   energy =     -17.098667837475       residual = 2.26e+00           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   energy =     -17.150555389921       residual = 7.10e-01           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   energy =     -17.114473969482       residual = 1.76e+00           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   energy =     -17.410509875176       residual = 6.10e+00           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   energy =     -17.217406608101       residual = 4.67e-02           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   energy =     -17.279537223482       residual = 7.54e-01           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   energy =     -17.393285415431       residual = 5.10e+00           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   energy =     -17.299537860188       residual = 1.05e+00           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   energy =     -17.161174664931       residual = 4.93e-01           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   energy =     -17.266816895276       residual = 4.43e-01           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   energy =     -17.185467186372       residual = 2.30e-01           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   energy =     -17.319239225265       residual = 1.99e+00           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   energy =     -17.240193076890       residual = 1.29e-01           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   energy =     -17.282123472492       residual = 8.27e-01           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   energy =     -17.144240394923       residual = 1.31e+00           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   energy =     -17.368578879732       residual = 3.62e+00           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   energy =     -17.309960619437       residual = 1.44e+00           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   energy =     -17.234142001217       residual = 1.03e-01           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   energy =     -17.338316336854       residual = 2.33e+00           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   energy =     -17.245394889360       residual = 1.35e-01           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   energy =     -17.137995687559       residual = 1.06e+00           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   energy =     -17.133987669139       residual = 1.15e+00           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   energy =     -17.031413432500       residual = 5.21e+00           smallest_sin_value = 9.99e-01
davidson iteration   60:   krylov dim =  61   energy =     -17.208072085338       residual = 1.26e-01           smallest_sin_value = 9.99e-01
davidson iteration   61:   krylov dim =  62   energy =     -17.463912871058       residual = 1.17e+01           smallest_sin_value = 9.98e-01
davidson iteration   62:   krylov dim =  63   energy =     -17.786555825376       residual = 5.17e+01           smallest_sin_value = 9.97e-01
davidson iteration   63:   krylov dim =  64   energy =     -17.176761628664       residual = 1.85e+00           smallest_sin_value = 9.95e-01
davidson iteration   64 stopping due to small subspace S singular value of 9.78e-01
davidson solver did not converge after         64 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.8208e+11 is 1.074621e-15

solving harmonic davidson linear method for identity shift 2.3283e+12, overlap shift 2.3283e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217168576023       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217168576023       residual = 3.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217168576023       residual = 7.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217168576023       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.218723205930       residual = 3.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.213824382212       residual = 2.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.228658865553       residual = 2.22e-02           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.222236612954       residual = 5.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.210543386760       residual = 5.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.209788712846       residual = 8.93e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.198084950668       residual = 5.87e-02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.218145239141       residual = 2.67e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.254991494195       residual = 2.21e-01           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.164577365286       residual = 4.49e-01           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.236893895895       residual = 6.12e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.358203506730       residual = 3.06e+00           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.330709846953       residual = 1.96e+00           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.204747696396       residual = 2.74e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.294923681060       residual = 9.13e-01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.268361722609       residual = 4.04e-01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.227374958472       residual = 2.66e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.143351822758       residual = 8.48e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.364626074695       residual = 3.37e+00           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.283572093953       residual = 7.09e-01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.158639595908       residual = 5.19e-01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.390922035478       residual = 4.82e+00           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.030129168852       residual = 5.26e+00           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.212328544572       residual = 1.77e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -17.293342708993       residual = 9.27e-01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -17.400326206566       residual = 5.43e+00           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -17.231653514519       residual = 3.99e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -17.114314221522       residual = 1.69e+00           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -17.045611065838       residual = 4.53e+00           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -17.334858902720       residual = 2.16e+00           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -17.246919668124       residual = 1.72e-01           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   energy =     -17.270511015012       residual = 4.93e-01           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   energy =     -17.231404888857       residual = 9.43e-02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   energy =     -17.214721000182       residual = 7.55e-02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   energy =     -17.337614541389       residual = 2.43e+00           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   energy =     -17.294413552722       residual = 9.75e-01           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   energy =     -17.383889848496       residual = 5.04e+00           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   energy =     -17.258350128917       residual = 5.63e-01           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   energy =     -17.283084177192       residual = 8.61e-01           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   energy =     -17.448832187373       residual = 8.07e+00           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   energy =     -17.181530546653       residual = 4.18e-01           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   energy =     -17.738642270609       residual = 4.25e+01           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   energy =     -17.505462272403       residual = 1.27e+01           smallest_sin_value = 9.99e-01
davidson iteration   47:   krylov dim =  48   energy =     -17.566161910517       residual = 1.98e+01           smallest_sin_value = 9.99e-01
davidson iteration   48:   krylov dim =  49   energy =     -16.990956016876       residual = 9.31e+00           smallest_sin_value = 9.99e-01
davidson iteration   49:   krylov dim =  50   energy =     -17.178207955201       residual = 7.78e-01           smallest_sin_value = 9.97e-01
davidson iteration   50:   krylov dim =  51   energy =     -17.339484316353       residual = 2.19e+00           smallest_sin_value = 9.96e-01
davidson iteration   51:   krylov dim =  52   energy =     -17.182046458305       residual = 5.44e-01           smallest_sin_value = 9.94e-01
davidson iteration   52:   krylov dim =  53   energy =     -17.136904472810       residual = 2.47e+00           smallest_sin_value = 9.94e-01
davidson iteration   53 stopping due to small subspace S singular value of 9.89e-01
davidson solver did not converge after         53 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+12 is 1.498535e-16

solving harmonic davidson linear method for identity shift 9.3132e+12, overlap shift 9.3132e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217168576023       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217168576023       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.45e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+12 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.912813 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8974e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.2078
    reference variance = 0.220022
====================================================
  Execution time = 3.7250e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1685e-01
  Total weights = 1.9568e+06
  Execution time = 3.3456e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301804000961
                                         uncertainty =       0.001946847390

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301804000961
                                         uncertainty =       0.001946847390

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388443956
  error estimate for blocks of size 2^( 2) =       0.000398578308
  error estimate for blocks of size 2^( 3) =       0.000407955577
  error estimate for blocks of size 2^( 4) =       0.000415171190
  error estimate for blocks of size 2^( 5) =       0.000419425080
  error estimate for blocks of size 2^( 6) =       0.000420999566
  error estimate for blocks of size 2^( 7) =       0.000420704986

      target function =                  N/A
              le_mean =     -17.216897479455
             les_mean =     296.738411632444
             stat err =       0.000419075205
             autocorr =       1.163930896310
              std dev =       0.549342710607
             le_variance =       0.301777413698

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301804000961
                                         uncertainty =       0.001946847390

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301804000961
                                         uncertainty =       0.001946847390

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388443956
  error estimate for blocks of size 2^( 2) =       0.000398578308
  error estimate for blocks of size 2^( 3) =       0.000407955577
  error estimate for blocks of size 2^( 4) =       0.000415171190
  error estimate for blocks of size 2^( 5) =       0.000419425080
  error estimate for blocks of size 2^( 6) =       0.000420999566
  error estimate for blocks of size 2^( 7) =       0.000420704986

      target function =                  N/A
              le_mean =     -17.216897479455
             les_mean =     296.738411632444
             stat err =       0.000419075205
             autocorr =       1.163930896309
              std dev =       0.549342710608
             le_variance =       0.301777413698

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301804000961
                                         uncertainty =       0.001946847390

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301804000961
                                         uncertainty =       0.001946847390

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388443956
  error estimate for blocks of size 2^( 2) =       0.000398578308
  error estimate for blocks of size 2^( 3) =       0.000407955577
  error estimate for blocks of size 2^( 4) =       0.000415171190
  error estimate for blocks of size 2^( 5) =       0.000419425080
  error estimate for blocks of size 2^( 6) =       0.000420999566
  error estimate for blocks of size 2^( 7) =       0.000420704986

      target function =                  N/A
              le_mean =     -17.216897479455
             les_mean =     296.738411632444
             stat err =       0.000419075205
             autocorr =       1.163930896310
              std dev =       0.549342710608
             le_variance =       0.301777413698

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301804000961
                                         uncertainty =       0.001946847390

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301804000961
                                         uncertainty =       0.001946847390

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388443956
  error estimate for blocks of size 2^( 2) =       0.000398578308
  error estimate for blocks of size 2^( 3) =       0.000407955577
  error estimate for blocks of size 2^( 4) =       0.000415171190
  error estimate for blocks of size 2^( 5) =       0.000419425080
  error estimate for blocks of size 2^( 6) =       0.000420999566
  error estimate for blocks of size 2^( 7) =       0.000420704986

      target function =                  N/A
              le_mean =     -17.216897479455
             les_mean =     296.738411632444
             stat err =       0.000419075205
             autocorr =       1.163930896310
              std dev =       0.549342710607
             le_variance =       0.301777413698


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216897479455        initial  <--
     5.8208e+11     5.8208e+12             1.0746e-15       -17.216897479455
     2.3283e+12     2.3283e+13             1.4985e-16       -17.216897479455
     9.3132e+12     9.3132e+13             0.0000e+00       -17.216897479455

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 54.1573
  </log>
  <optVariables href="H2O.s038.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0314e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7223e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.1744
    reference variance = 0.190392
====================================================
  Execution time = 3.7655e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5304e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1437e-01
  Total weights = 1.956804026e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1067e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299305910633
                                         uncertainty =       0.002011484572

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299305910633
                                         uncertainty =       0.002011484572

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386842017
  error estimate for blocks of size 2^( 2) =       0.000396767073
  error estimate for blocks of size 2^( 3) =       0.000405747773
  error estimate for blocks of size 2^( 4) =       0.000412539405
  error estimate for blocks of size 2^( 5) =       0.000417077783
  error estimate for blocks of size 2^( 6) =       0.000419027647
  error estimate for blocks of size 2^( 7) =       0.000420870847

      target function =                  N/A
              le_mean =     -17.216254579369
             les_mean =     296.713791483052
             stat err =       0.000417378920
             autocorr =       1.164109258817
              std dev =       0.547077227615
             le_variance =       0.299293492975


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721625457937e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+12, overlap shift 5.8208e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216254579418       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216254579418       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.73e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.8208e+12 is 0.000000e+00

solving harmonic davidson linear method for identity shift 2.3283e+13, overlap shift 2.3283e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216254579418       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216254579418       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.27e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 9.3132e+13, overlap shift 9.3132e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216254579418       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216254579418       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.73e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+13 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.914058 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8734e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.2311
    reference variance = 0.228995
====================================================
  Execution time = 3.7170e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2125e-01
  Total weights = 1.9566e+06
  Execution time = 3.3641e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299628050557
                                         uncertainty =       0.001844592745

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299628050557
                                         uncertainty =       0.001844592745

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387105622
  error estimate for blocks of size 2^( 2) =       0.000397589952
  error estimate for blocks of size 2^( 3) =       0.000406428227
  error estimate for blocks of size 2^( 4) =       0.000413077871
  error estimate for blocks of size 2^( 5) =       0.000417767307
  error estimate for blocks of size 2^( 6) =       0.000418753879
  error estimate for blocks of size 2^( 7) =       0.000418789537

      target function =                  N/A
              le_mean =     -17.217052279631
             les_mean =     296.748143047104
             stat err =       0.000417097149
             autocorr =       1.160955263339
              std dev =       0.547450020395
             le_variance =       0.299701524830

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299628050557
                                         uncertainty =       0.001844592745

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299628050557
                                         uncertainty =       0.001844592745

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387105622
  error estimate for blocks of size 2^( 2) =       0.000397589952
  error estimate for blocks of size 2^( 3) =       0.000406428227
  error estimate for blocks of size 2^( 4) =       0.000413077871
  error estimate for blocks of size 2^( 5) =       0.000417767307
  error estimate for blocks of size 2^( 6) =       0.000418753879
  error estimate for blocks of size 2^( 7) =       0.000418789537

      target function =                  N/A
              le_mean =     -17.217052279631
             les_mean =     296.748143047104
             stat err =       0.000417097149
             autocorr =       1.160955263339
              std dev =       0.547450020395
             le_variance =       0.299701524830

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299628050557
                                         uncertainty =       0.001844592745

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299628050557
                                         uncertainty =       0.001844592745

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387105622
  error estimate for blocks of size 2^( 2) =       0.000397589952
  error estimate for blocks of size 2^( 3) =       0.000406428227
  error estimate for blocks of size 2^( 4) =       0.000413077871
  error estimate for blocks of size 2^( 5) =       0.000417767307
  error estimate for blocks of size 2^( 6) =       0.000418753879
  error estimate for blocks of size 2^( 7) =       0.000418789537

      target function =                  N/A
              le_mean =     -17.217052279631
             les_mean =     296.748143047104
             stat err =       0.000417097149
             autocorr =       1.160955263339
              std dev =       0.547450020395
             le_variance =       0.299701524830

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299628050557
                                         uncertainty =       0.001844592745

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299628050557
                                         uncertainty =       0.001844592745

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387105622
  error estimate for blocks of size 2^( 2) =       0.000397589952
  error estimate for blocks of size 2^( 3) =       0.000406428227
  error estimate for blocks of size 2^( 4) =       0.000413077871
  error estimate for blocks of size 2^( 5) =       0.000417767307
  error estimate for blocks of size 2^( 6) =       0.000418753879
  error estimate for blocks of size 2^( 7) =       0.000418789537

      target function =                  N/A
              le_mean =     -17.217052279631
             les_mean =     296.748143047104
             stat err =       0.000417097149
             autocorr =       1.160955263339
              std dev =       0.547450020395
             le_variance =       0.299701524830


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217052279631        initial  <--
     5.8208e+12     5.8208e+13             0.0000e+00       -17.217052279631
     2.3283e+13     2.3283e+14             0.0000e+00       -17.217052279631
     9.3132e+13     9.3132e+14             0.0000e+00       -17.217052279631

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 54.7259
  </log>
  <optVariables href="H2O.s039.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0347e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s040 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s040 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=40  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7222e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -17.2191
    reference variance = 0.273989
====================================================
  Execution time = 3.7545e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s040
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5312e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0914e-01
  Total weights = 1.956711050e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1148e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295337854442
                                         uncertainty =       0.001666219803

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295337854442
                                         uncertainty =       0.001666219803

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384252247
  error estimate for blocks of size 2^( 2) =       0.000394181495
  error estimate for blocks of size 2^( 3) =       0.000403155578
  error estimate for blocks of size 2^( 4) =       0.000410113907
  error estimate for blocks of size 2^( 5) =       0.000414011367
  error estimate for blocks of size 2^( 6) =       0.000417141628
  error estimate for blocks of size 2^( 7) =       0.000419445940

      target function =                  N/A
              le_mean =     -17.215970033862
             les_mean =     296.698759361572
             stat err =       0.000415178211
             autocorr =       1.167444580389
              std dev =       0.543414739721
             le_variance =       0.295299579346


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721597003386e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+13, overlap shift 5.8208e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215970033896       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215970033896       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.25e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.8208e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 2.3283e+14, overlap shift 2.3283e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215970033896       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215970033896       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.25e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+14 is 0.000000e+00

solving harmonic davidson linear method for identity shift 9.3132e+14, overlap shift 9.3132e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215970033896       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215970033896       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.25e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+14 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.915233 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8702e+01
  </log>
  <optVariables href="H2O.s040.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -17.2396
    reference variance = 0.241592
====================================================
  Execution time = 3.6979e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s040
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1490e-01
  Total weights = 1.9564e+06
  Execution time = 3.3504e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298265408710
                                         uncertainty =       0.001999391391

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298265408710
                                         uncertainty =       0.001999391391

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386110073
  error estimate for blocks of size 2^( 2) =       0.000395716314
  error estimate for blocks of size 2^( 3) =       0.000404791784
  error estimate for blocks of size 2^( 4) =       0.000411642906
  error estimate for blocks of size 2^( 5) =       0.000414645266
  error estimate for blocks of size 2^( 6) =       0.000415852785
  error estimate for blocks of size 2^( 7) =       0.000414538552

      target function =                  N/A
              le_mean =     -17.216921404615
             les_mean =     296.737280926782
             stat err =       0.000414169877
             autocorr =       1.150627513671
              std dev =       0.546042101770
             le_variance =       0.298161976905

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298265408710
                                         uncertainty =       0.001999391391

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298265408710
                                         uncertainty =       0.001999391391

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386110073
  error estimate for blocks of size 2^( 2) =       0.000395716314
  error estimate for blocks of size 2^( 3) =       0.000404791784
  error estimate for blocks of size 2^( 4) =       0.000411642906
  error estimate for blocks of size 2^( 5) =       0.000414645266
  error estimate for blocks of size 2^( 6) =       0.000415852785
  error estimate for blocks of size 2^( 7) =       0.000414538552

      target function =                  N/A
              le_mean =     -17.216921404615
             les_mean =     296.737280926782
             stat err =       0.000414169877
             autocorr =       1.150627513671
              std dev =       0.546042101770
             le_variance =       0.298161976905

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298265408710
                                         uncertainty =       0.001999391391

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298265408710
                                         uncertainty =       0.001999391391

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386110073
  error estimate for blocks of size 2^( 2) =       0.000395716314
  error estimate for blocks of size 2^( 3) =       0.000404791784
  error estimate for blocks of size 2^( 4) =       0.000411642906
  error estimate for blocks of size 2^( 5) =       0.000414645266
  error estimate for blocks of size 2^( 6) =       0.000415852785
  error estimate for blocks of size 2^( 7) =       0.000414538552

      target function =                  N/A
              le_mean =     -17.216921404615
             les_mean =     296.737280926782
             stat err =       0.000414169877
             autocorr =       1.150627513671
              std dev =       0.546042101770
             le_variance =       0.298161976905

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298265408710
                                         uncertainty =       0.001999391391

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298265408710
                                         uncertainty =       0.001999391391

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386110073
  error estimate for blocks of size 2^( 2) =       0.000395716314
  error estimate for blocks of size 2^( 3) =       0.000404791784
  error estimate for blocks of size 2^( 4) =       0.000411642906
  error estimate for blocks of size 2^( 5) =       0.000414645266
  error estimate for blocks of size 2^( 6) =       0.000415852785
  error estimate for blocks of size 2^( 7) =       0.000414538552

      target function =                  N/A
              le_mean =     -17.216921404615
             les_mean =     296.737280926782
             stat err =       0.000414169877
             autocorr =       1.150627513671
              std dev =       0.546042101770
             le_variance =       0.298161976905


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216921404615        initial  <--
     5.8208e+13     5.8208e+14             0.0000e+00       -17.216921404615
     2.3283e+14     2.3283e+15             0.0000e+00       -17.216921404615
     9.3132e+14     9.3132e+15             0.0000e+00       -17.216921404615

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.9321
  </log>
  <optVariables href="H2O.s040.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0264e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s041 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s041 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=41  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7223e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -17.3152
    reference variance = 0.540728
====================================================
  Execution time = 3.7448e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s041
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5273e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1843e-01
  Total weights = 1.956622058e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1068e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301090288224
                                         uncertainty =       0.002048927232

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301090288224
                                         uncertainty =       0.002048927232

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388007164
  error estimate for blocks of size 2^( 2) =       0.000397841705
  error estimate for blocks of size 2^( 3) =       0.000406446658
  error estimate for blocks of size 2^( 4) =       0.000412995391
  error estimate for blocks of size 2^( 5) =       0.000417676317
  error estimate for blocks of size 2^( 6) =       0.000419245124
  error estimate for blocks of size 2^( 7) =       0.000418619798

      target function =                  N/A
              le_mean =     -17.216421350795
             les_mean =     296.723594488813
             stat err =       0.000417134157
             autocorr =       1.155771599167
              std dev =       0.548724994230
             le_variance =       0.301099119293


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721642135080e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+14, overlap shift 5.8208e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216421350831       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216421350831       residual = 2.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216421350831       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216421350830       residual = 7.65e-01           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.039527538252       residual = 1.80e+01           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -14.679898166558       residual = 1.00e+03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.278045373232       residual = 1.50e+02           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.836157665259       residual = 1.19e+02           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -14.657673968933       residual = 9.45e+02           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -27.094090385434       residual = 1.69e+04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -14.325592663101       residual = 1.42e+03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -10.671612773297       residual = 6.93e+03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -18.471269105421       residual = 3.12e+02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -13.980690741095       residual = 1.70e+03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -15.860218189206       residual = 4.88e+02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.710675790450       residual = 5.12e+03           smallest_sin_value = 1.00e+00
davidson iteration   16 stopping due to too large eigenvalue change
davidson solver did not converge after         16 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.8208e+14 is 5.772919e-19

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+15, overlap shift 2.3283e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216421350831       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216421350831       residual = 2.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216421350831       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.991821868147       residual = 7.63e+00           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216421350832       residual = 8.41e-02           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.949648469522       residual = 8.53e+01           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -19.286572784516       residual = 7.69e+02           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -24.870512911207       residual = 1.08e+04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -21.677606350770       residual = 2.41e+03           smallest_sin_value = 1.00e+00
davidson iteration    9 stopping due to too large eigenvalue change
davidson solver did not converge after          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+15 is 1.443230e-19

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+15, overlap shift 9.3132e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216421350831       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216421350831       residual = 2.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216421350831       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to small subspace S singular value of 7.93e-01
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+15 is 3.434710e-20

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.920648 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8529e+01
  </log>
  <optVariables href="H2O.s041.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -17.2638
    reference variance = 0.204188
====================================================
  Execution time = 3.7383e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s041
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1528e-01
  Total weights = 1.9567e+06
  Execution time = 3.3484e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300599097001
                                         uncertainty =       0.002492687127

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300599097001
                                         uncertainty =       0.002492687127

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387674787
  error estimate for blocks of size 2^( 2) =       0.000398065931
  error estimate for blocks of size 2^( 3) =       0.000407094004
  error estimate for blocks of size 2^( 4) =       0.000413320886
  error estimate for blocks of size 2^( 5) =       0.000417451449
  error estimate for blocks of size 2^( 6) =       0.000421989919
  error estimate for blocks of size 2^( 7) =       0.000422348717

      target function =                  N/A
              le_mean =     -17.215801647081
             les_mean =     296.699101510105
             stat err =       0.000418777743
             autocorr =       1.166895778527
              std dev =       0.548254941995
             le_variance =       0.300583481422

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300599097001
                                         uncertainty =       0.002492687127

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300599097001
                                         uncertainty =       0.002492687127

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387674787
  error estimate for blocks of size 2^( 2) =       0.000398065931
  error estimate for blocks of size 2^( 3) =       0.000407094004
  error estimate for blocks of size 2^( 4) =       0.000413320886
  error estimate for blocks of size 2^( 5) =       0.000417451449
  error estimate for blocks of size 2^( 6) =       0.000421989919
  error estimate for blocks of size 2^( 7) =       0.000422348717

      target function =                  N/A
              le_mean =     -17.215801647081
             les_mean =     296.699101510105
             stat err =       0.000418777743
             autocorr =       1.166895778528
              std dev =       0.548254941995
             le_variance =       0.300583481422

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300599097001
                                         uncertainty =       0.002492687127

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300599097001
                                         uncertainty =       0.002492687127

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387674787
  error estimate for blocks of size 2^( 2) =       0.000398065931
  error estimate for blocks of size 2^( 3) =       0.000407094004
  error estimate for blocks of size 2^( 4) =       0.000413320886
  error estimate for blocks of size 2^( 5) =       0.000417451449
  error estimate for blocks of size 2^( 6) =       0.000421989919
  error estimate for blocks of size 2^( 7) =       0.000422348717

      target function =                  N/A
              le_mean =     -17.215801647081
             les_mean =     296.699101510105
             stat err =       0.000418777743
             autocorr =       1.166895778527
              std dev =       0.548254941995
             le_variance =       0.300583481422

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300599097001
                                         uncertainty =       0.002492687127

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300599097001
                                         uncertainty =       0.002492687127

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387674787
  error estimate for blocks of size 2^( 2) =       0.000398065931
  error estimate for blocks of size 2^( 3) =       0.000407094004
  error estimate for blocks of size 2^( 4) =       0.000413320886
  error estimate for blocks of size 2^( 5) =       0.000417451449
  error estimate for blocks of size 2^( 6) =       0.000421989919
  error estimate for blocks of size 2^( 7) =       0.000422348717

      target function =                  N/A
              le_mean =     -17.215801647081
             les_mean =     296.699101510105
             stat err =       0.000418777743
             autocorr =       1.166895778527
              std dev =       0.548254941995
             le_variance =       0.300583481422


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215801647081        initial  <--
     5.8208e+14     5.8208e+15             5.7729e-19       -17.215801647081
     2.3283e+15     2.3283e+16             1.4432e-19       -17.215801647081
     9.3132e+15     9.3132e+16             3.4347e-20       -17.215801647081

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 54.3136
  </log>
  <optVariables href="H2O.s041.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0285e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s042 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s042 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=42  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7224e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -17.1753
    reference variance = 0.278519
====================================================
  Execution time = 3.7428e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s042
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5294e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1440e-01
  Total weights = 1.956900514e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1011e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300228543910
                                         uncertainty =       0.001985713506

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300228543910
                                         uncertainty =       0.001985713506

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387417267
  error estimate for blocks of size 2^( 2) =       0.000397621972
  error estimate for blocks of size 2^( 3) =       0.000407051662
  error estimate for blocks of size 2^( 4) =       0.000414392319
  error estimate for blocks of size 2^( 5) =       0.000418564446
  error estimate for blocks of size 2^( 6) =       0.000422259848
  error estimate for blocks of size 2^( 7) =       0.000426445497

      target function =                  N/A
              le_mean =     -17.217376846123
             les_mean =     296.752468512897
             stat err =       0.000420415527
             autocorr =       1.177604751389
              std dev =       0.547890753189
             le_variance =       0.300184277430


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721737684612e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+15, overlap shift 5.8208e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217376846202       residual = 2.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217376846202       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217376846202       residual = 4.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217376846202       residual = 3.55e-01           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.041039076114       residual = 1.74e+03           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.8208e+15 is 7.258623e-20

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+16, overlap shift 2.3283e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217376846202       residual = 2.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217376846202       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217376846202       residual = 4.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217376846202       residual = 8.90e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217376846201       residual = 1.36e-02           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.086656602296       residual = 6.56e+03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -13.246856738774       residual = 3.15e+04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -18.358695808629       residual = 4.39e+03           smallest_sin_value = 1.00e+00
davidson iteration    8 stopping due to too large eigenvalue change
davidson solver did not converge after          8 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+16 is 1.814656e-20

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+16, overlap shift 9.3132e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217376846202       residual = 2.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217376846202       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217376846202       residual = 4.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217376846202       residual = 3.96e-02           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+16 is 4.536639e-21

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.923170 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8449e+01
  </log>
  <optVariables href="H2O.s042.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -17.2144
    reference variance = 0.402828
====================================================
  Execution time = 3.7469e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s042
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1670e-01
  Total weights = 1.9569e+06
  Execution time = 3.3735e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303380773902
                                         uncertainty =       0.002058787976

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303380773902
                                         uncertainty =       0.002058787976

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389525595
  error estimate for blocks of size 2^( 2) =       0.000399219640
  error estimate for blocks of size 2^( 3) =       0.000408439309
  error estimate for blocks of size 2^( 4) =       0.000414752753
  error estimate for blocks of size 2^( 5) =       0.000419626311
  error estimate for blocks of size 2^( 6) =       0.000420903858
  error estimate for blocks of size 2^( 7) =       0.000421373076

      target function =                  N/A
              le_mean =     -17.216755245611
             les_mean =     296.733358355390
             stat err =       0.000419163999
             autocorr =       1.157966384786
              std dev =       0.550872378926
             le_variance =       0.303460377864

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303380773902
                                         uncertainty =       0.002058787976

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303380773902
                                         uncertainty =       0.002058787976

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389525595
  error estimate for blocks of size 2^( 2) =       0.000399219640
  error estimate for blocks of size 2^( 3) =       0.000408439309
  error estimate for blocks of size 2^( 4) =       0.000414752753
  error estimate for blocks of size 2^( 5) =       0.000419626311
  error estimate for blocks of size 2^( 6) =       0.000420903858
  error estimate for blocks of size 2^( 7) =       0.000421373076

      target function =                  N/A
              le_mean =     -17.216755245611
             les_mean =     296.733358355390
             stat err =       0.000419163999
             autocorr =       1.157966384786
              std dev =       0.550872378926
             le_variance =       0.303460377864

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303380773902
                                         uncertainty =       0.002058787976

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303380773902
                                         uncertainty =       0.002058787976

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389525595
  error estimate for blocks of size 2^( 2) =       0.000399219640
  error estimate for blocks of size 2^( 3) =       0.000408439309
  error estimate for blocks of size 2^( 4) =       0.000414752753
  error estimate for blocks of size 2^( 5) =       0.000419626311
  error estimate for blocks of size 2^( 6) =       0.000420903858
  error estimate for blocks of size 2^( 7) =       0.000421373076

      target function =                  N/A
              le_mean =     -17.216755245611
             les_mean =     296.733358355390
             stat err =       0.000419163999
             autocorr =       1.157966384786
              std dev =       0.550872378926
             le_variance =       0.303460377864

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303380773902
                                         uncertainty =       0.002058787976

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303380773902
                                         uncertainty =       0.002058787976

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389525595
  error estimate for blocks of size 2^( 2) =       0.000399219640
  error estimate for blocks of size 2^( 3) =       0.000408439309
  error estimate for blocks of size 2^( 4) =       0.000414752753
  error estimate for blocks of size 2^( 5) =       0.000419626311
  error estimate for blocks of size 2^( 6) =       0.000420903858
  error estimate for blocks of size 2^( 7) =       0.000421373076

      target function =                  N/A
              le_mean =     -17.216755245611
             les_mean =     296.733358355390
             stat err =       0.000419163999
             autocorr =       1.157966384786
              std dev =       0.550872378926
             le_variance =       0.303460377864


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216755245611        initial  <--
     5.8208e+15     5.8208e+16             7.2586e-20       -17.216755245611
     2.3283e+16     2.3283e+17             1.8147e-20       -17.216755245611
     9.3132e+16     9.3132e+17             4.5366e-21       -17.216755245611

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 54.4346
  </log>
  <optVariables href="H2O.s042.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0289e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s043 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s043 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=43  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7224e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -17.246
    reference variance = 0.181231
====================================================
  Execution time = 3.7617e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s043
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5294e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1448e-01
  Total weights = 1.956607463e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0982e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299449631908
                                         uncertainty =       0.002011485744

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299449631908
                                         uncertainty =       0.002011485744

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386998165
  error estimate for blocks of size 2^( 2) =       0.000396665558
  error estimate for blocks of size 2^( 3) =       0.000406093981
  error estimate for blocks of size 2^( 4) =       0.000412697898
  error estimate for blocks of size 2^( 5) =       0.000416679112
  error estimate for blocks of size 2^( 6) =       0.000419506278
  error estimate for blocks of size 2^( 7) =       0.000419492215

      target function =                  N/A
              le_mean =     -17.215957457922
             les_mean =     296.703673609756
             stat err =       0.000417093876
             autocorr =       1.161581839899
              std dev =       0.547298054017
             le_variance =       0.299535159931


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721595745792e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+16, overlap shift 5.8208e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215957457907       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215957457907       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.58e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.8208e+16 is 0.000000e+00

solving harmonic davidson linear method for identity shift 2.3283e+17, overlap shift 2.3283e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215957457907       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215957457907       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+17 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+17, overlap shift 9.3132e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215957457907       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215957457907       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+17 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.924386 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8609e+01
  </log>
  <optVariables href="H2O.s043.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -17.2706
    reference variance = 0.396797
====================================================
  Execution time = 3.7186e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s043
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1012e-01
  Total weights = 1.9569e+06
  Execution time = 3.3602e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295878052212
                                         uncertainty =       0.001886292463

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295878052212
                                         uncertainty =       0.001886292463

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384607459
  error estimate for blocks of size 2^( 2) =       0.000394905355
  error estimate for blocks of size 2^( 3) =       0.000404185140
  error estimate for blocks of size 2^( 4) =       0.000410864353
  error estimate for blocks of size 2^( 5) =       0.000414588794
  error estimate for blocks of size 2^( 6) =       0.000416208031
  error estimate for blocks of size 2^( 7) =       0.000417674401

      target function =                  N/A
              le_mean =     -17.216676552027
             les_mean =     296.724072586122
             stat err =       0.000414833895
             autocorr =       1.163357148578
              std dev =       0.543917084553
             le_variance =       0.295845794868

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295878052212
                                         uncertainty =       0.001886292463

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295878052212
                                         uncertainty =       0.001886292463

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384607459
  error estimate for blocks of size 2^( 2) =       0.000394905355
  error estimate for blocks of size 2^( 3) =       0.000404185140
  error estimate for blocks of size 2^( 4) =       0.000410864353
  error estimate for blocks of size 2^( 5) =       0.000414588794
  error estimate for blocks of size 2^( 6) =       0.000416208031
  error estimate for blocks of size 2^( 7) =       0.000417674401

      target function =                  N/A
              le_mean =     -17.216676552027
             les_mean =     296.724072586122
             stat err =       0.000414833895
             autocorr =       1.163357148578
              std dev =       0.543917084553
             le_variance =       0.295845794868

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295878052212
                                         uncertainty =       0.001886292463

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295878052212
                                         uncertainty =       0.001886292463

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384607459
  error estimate for blocks of size 2^( 2) =       0.000394905355
  error estimate for blocks of size 2^( 3) =       0.000404185140
  error estimate for blocks of size 2^( 4) =       0.000410864353
  error estimate for blocks of size 2^( 5) =       0.000414588794
  error estimate for blocks of size 2^( 6) =       0.000416208031
  error estimate for blocks of size 2^( 7) =       0.000417674401

      target function =                  N/A
              le_mean =     -17.216676552027
             les_mean =     296.724072586122
             stat err =       0.000414833895
             autocorr =       1.163357148578
              std dev =       0.543917084553
             le_variance =       0.295845794868

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295878052212
                                         uncertainty =       0.001886292463

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295878052212
                                         uncertainty =       0.001886292463

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384607459
  error estimate for blocks of size 2^( 2) =       0.000394905355
  error estimate for blocks of size 2^( 3) =       0.000404185140
  error estimate for blocks of size 2^( 4) =       0.000410864353
  error estimate for blocks of size 2^( 5) =       0.000414588794
  error estimate for blocks of size 2^( 6) =       0.000416208031
  error estimate for blocks of size 2^( 7) =       0.000417674401

      target function =                  N/A
              le_mean =     -17.216676552027
             les_mean =     296.724072586122
             stat err =       0.000414833895
             autocorr =       1.163357148578
              std dev =       0.543917084553
             le_variance =       0.295845794868


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216676552027        initial  <--
     5.8208e+16     5.8208e+17             0.0000e+00       -17.216676552027
     2.3283e+17     2.3283e+18             0.0000e+00       -17.216676552027
     9.3132e+17     9.3132e+18             0.0000e+00       -17.216676552027

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 54.1064
  </log>
  <optVariables href="H2O.s043.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0272e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s044 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s044 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=44  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7224e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -17.2682
    reference variance = 0.620481
====================================================
  Execution time = 3.7494e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s044
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5296e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1078e-01
  Total weights = 1.956752393e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0875e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296824294510
                                         uncertainty =       0.002046799971

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296824294510
                                         uncertainty =       0.002046799971

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385238027
  error estimate for blocks of size 2^( 2) =       0.000395498450
  error estimate for blocks of size 2^( 3) =       0.000404235736
  error estimate for blocks of size 2^( 4) =       0.000411673255
  error estimate for blocks of size 2^( 5) =       0.000415536908
  error estimate for blocks of size 2^( 6) =       0.000419119497
  error estimate for blocks of size 2^( 7) =       0.000420410862

      target function =                  N/A
              le_mean =     -17.215867992679
             les_mean =     296.696887110635
             stat err =       0.000416685130
             autocorr =       1.169924151350
              std dev =       0.544808841865
             le_variance =       0.296816674175


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721586799268e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+17, overlap shift 5.8208e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215867992721       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215867992721       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.8208e+17 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+18, overlap shift 2.3283e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215867992721       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215867992721       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+18, overlap shift 9.3132e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215867992721       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215867992721       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.925597 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8379e+01
  </log>
  <optVariables href="H2O.s044.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -17.1847
    reference variance = 0.153442
====================================================
  Execution time = 3.7113e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s044
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1092e-01
  Total weights = 1.9565e+06
  Execution time = 3.3395e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297438496514
                                         uncertainty =       0.001925439591

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297438496514
                                         uncertainty =       0.001925439591

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385598993
  error estimate for blocks of size 2^( 2) =       0.000395750036
  error estimate for blocks of size 2^( 3) =       0.000404464623
  error estimate for blocks of size 2^( 4) =       0.000411139485
  error estimate for blocks of size 2^( 5) =       0.000415467637
  error estimate for blocks of size 2^( 6) =       0.000417834116
  error estimate for blocks of size 2^( 7) =       0.000418092832

      target function =                  N/A
              le_mean =     -17.216602159035
             les_mean =     296.722309507693
             stat err =       0.000415633518
             autocorr =       1.161848079617
              std dev =       0.545319324888
             le_variance =       0.297373166096

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297438496514
                                         uncertainty =       0.001925439591

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297438496514
                                         uncertainty =       0.001925439591

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385598993
  error estimate for blocks of size 2^( 2) =       0.000395750036
  error estimate for blocks of size 2^( 3) =       0.000404464623
  error estimate for blocks of size 2^( 4) =       0.000411139485
  error estimate for blocks of size 2^( 5) =       0.000415467637
  error estimate for blocks of size 2^( 6) =       0.000417834116
  error estimate for blocks of size 2^( 7) =       0.000418092832

      target function =                  N/A
              le_mean =     -17.216602159035
             les_mean =     296.722309507693
             stat err =       0.000415633518
             autocorr =       1.161848079617
              std dev =       0.545319324888
             le_variance =       0.297373166096

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297438496514
                                         uncertainty =       0.001925439591

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297438496514
                                         uncertainty =       0.001925439591

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385598993
  error estimate for blocks of size 2^( 2) =       0.000395750036
  error estimate for blocks of size 2^( 3) =       0.000404464623
  error estimate for blocks of size 2^( 4) =       0.000411139485
  error estimate for blocks of size 2^( 5) =       0.000415467637
  error estimate for blocks of size 2^( 6) =       0.000417834116
  error estimate for blocks of size 2^( 7) =       0.000418092832

      target function =                  N/A
              le_mean =     -17.216602159035
             les_mean =     296.722309507693
             stat err =       0.000415633518
             autocorr =       1.161848079617
              std dev =       0.545319324888
             le_variance =       0.297373166096

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297438496514
                                         uncertainty =       0.001925439591

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297438496514
                                         uncertainty =       0.001925439591

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385598993
  error estimate for blocks of size 2^( 2) =       0.000395750036
  error estimate for blocks of size 2^( 3) =       0.000404464623
  error estimate for blocks of size 2^( 4) =       0.000411139485
  error estimate for blocks of size 2^( 5) =       0.000415467637
  error estimate for blocks of size 2^( 6) =       0.000417834116
  error estimate for blocks of size 2^( 7) =       0.000418092832

      target function =                  N/A
              le_mean =     -17.216602159035
             les_mean =     296.722309507693
             stat err =       0.000415633518
             autocorr =       1.161848079617
              std dev =       0.545319324888
             le_variance =       0.297373166096


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216602159035        initial  <--
     5.8208e+17     5.8208e+18             0.0000e+00       -17.216602159035
     2.3283e+18     2.3283e+19             0.0000e+00       -17.216602159035
     9.3132e+18     9.3132e+19             0.0000e+00       -17.216602159035

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.9973
  </log>
  <optVariables href="H2O.s044.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0238e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s045 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s045 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=45  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7224e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -17.2831
    reference variance = 0.219689
====================================================
  Execution time = 3.7780e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s045
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5301e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0993e-01
  Total weights = 1.956946733e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0928e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297120251288
                                         uncertainty =       0.001817874909

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297120251288
                                         uncertainty =       0.001817874909

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385392621
  error estimate for blocks of size 2^( 2) =       0.000395414945
  error estimate for blocks of size 2^( 3) =       0.000404010969
  error estimate for blocks of size 2^( 4) =       0.000410699390
  error estimate for blocks of size 2^( 5) =       0.000414484809
  error estimate for blocks of size 2^( 6) =       0.000415901764
  error estimate for blocks of size 2^( 7) =       0.000416713978

      target function =                  N/A
              le_mean =     -17.215658503550
             les_mean =     296.688825500853
             stat err =       0.000414449985
             autocorr =       1.156478240425
              std dev =       0.545027471970
             le_variance =       0.297054945202


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721565850355e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+18, overlap shift 5.8208e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215658503590       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215658503590       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.8208e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+19, overlap shift 2.3283e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215658503590       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215658503590       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+19, overlap shift 9.3132e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215658503590       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215658503590       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.926789 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8718e+01
  </log>
  <optVariables href="H2O.s045.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -17.2293
    reference variance = 0.159672
====================================================
  Execution time = 3.7539e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s045
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1484e-01
  Total weights = 1.9566e+06
  Execution time = 3.3459e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300993179344
                                         uncertainty =       0.002586135615

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300993179344
                                         uncertainty =       0.002586135615

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387979206
  error estimate for blocks of size 2^( 2) =       0.000397884934
  error estimate for blocks of size 2^( 3) =       0.000406577332
  error estimate for blocks of size 2^( 4) =       0.000412325117
  error estimate for blocks of size 2^( 5) =       0.000416754402
  error estimate for blocks of size 2^( 6) =       0.000419179605
  error estimate for blocks of size 2^( 7) =       0.000418586117

      target function =                  N/A
              le_mean =     -17.216554448556
             les_mean =     296.724584077368
             stat err =       0.000416711310
             autocorr =       1.153595824911
              std dev =       0.548685455592
             le_variance =       0.301055729179

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300993179344
                                         uncertainty =       0.002586135615

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300993179344
                                         uncertainty =       0.002586135615

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387979206
  error estimate for blocks of size 2^( 2) =       0.000397884934
  error estimate for blocks of size 2^( 3) =       0.000406577332
  error estimate for blocks of size 2^( 4) =       0.000412325117
  error estimate for blocks of size 2^( 5) =       0.000416754402
  error estimate for blocks of size 2^( 6) =       0.000419179605
  error estimate for blocks of size 2^( 7) =       0.000418586117

      target function =                  N/A
              le_mean =     -17.216554448556
             les_mean =     296.724584077368
             stat err =       0.000416711310
             autocorr =       1.153595824911
              std dev =       0.548685455592
             le_variance =       0.301055729179

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300993179344
                                         uncertainty =       0.002586135615

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300993179344
                                         uncertainty =       0.002586135615

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387979206
  error estimate for blocks of size 2^( 2) =       0.000397884934
  error estimate for blocks of size 2^( 3) =       0.000406577332
  error estimate for blocks of size 2^( 4) =       0.000412325117
  error estimate for blocks of size 2^( 5) =       0.000416754402
  error estimate for blocks of size 2^( 6) =       0.000419179605
  error estimate for blocks of size 2^( 7) =       0.000418586117

      target function =                  N/A
              le_mean =     -17.216554448556
             les_mean =     296.724584077368
             stat err =       0.000416711310
             autocorr =       1.153595824911
              std dev =       0.548685455592
             le_variance =       0.301055729179

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300993179344
                                         uncertainty =       0.002586135615

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300993179344
                                         uncertainty =       0.002586135615

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387979206
  error estimate for blocks of size 2^( 2) =       0.000397884934
  error estimate for blocks of size 2^( 3) =       0.000406577332
  error estimate for blocks of size 2^( 4) =       0.000412325117
  error estimate for blocks of size 2^( 5) =       0.000416754402
  error estimate for blocks of size 2^( 6) =       0.000419179605
  error estimate for blocks of size 2^( 7) =       0.000418586117

      target function =                  N/A
              le_mean =     -17.216554448556
             les_mean =     296.724584077368
             stat err =       0.000416711310
             autocorr =       1.153595824911
              std dev =       0.548685455592
             le_variance =       0.301055729179


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216554448556        initial  <--
     5.8208e+18     5.8208e+19             0.0000e+00       -17.216554448556
     2.3283e+19     2.3283e+20             0.0000e+00       -17.216554448556
     9.3132e+19     9.3132e+20             0.0000e+00       -17.216554448556

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 54.4813
  </log>
  <optVariables href="H2O.s045.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0321e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s046 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s046 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=46  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7225e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -17.2505
    reference variance = 0.546468
====================================================
  Execution time = 3.7732e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s046
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5278e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1009e-01
  Total weights = 1.956508064e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0985e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296457771585
                                         uncertainty =       0.002259634791

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296457771585
                                         uncertainty =       0.002259634791

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385136613
  error estimate for blocks of size 2^( 2) =       0.000395224077
  error estimate for blocks of size 2^( 3) =       0.000404798122
  error estimate for blocks of size 2^( 4) =       0.000411010816
  error estimate for blocks of size 2^( 5) =       0.000414529939
  error estimate for blocks of size 2^( 6) =       0.000417639713
  error estimate for blocks of size 2^( 7) =       0.000420846874

      target function =                  N/A
              le_mean =     -17.216042209266
             les_mean =     296.702201393191
             stat err =       0.000416006836
             autocorr =       1.166732567275
              std dev =       0.544665421086
             le_variance =       0.296660420927


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721604220927e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+19, overlap shift 5.8208e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216042209278       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216042209278       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.8208e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+20, overlap shift 2.3283e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216042209278       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216042209278       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+20, overlap shift 9.3132e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216042209278       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216042209278       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.927991 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8727e+01
  </log>
  <optVariables href="H2O.s046.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -17.2002
    reference variance = 0.169452
====================================================
  Execution time = 3.7080e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s046
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1585e-01
  Total weights = 1.9567e+06
  Execution time = 3.3537e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300336379118
                                         uncertainty =       0.002333082761

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300336379118
                                         uncertainty =       0.002333082761

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387470507
  error estimate for blocks of size 2^( 2) =       0.000397667092
  error estimate for blocks of size 2^( 3) =       0.000407328301
  error estimate for blocks of size 2^( 4) =       0.000413938855
  error estimate for blocks of size 2^( 5) =       0.000418803711
  error estimate for blocks of size 2^( 6) =       0.000421704394
  error estimate for blocks of size 2^( 7) =       0.000426140150

      target function =                  N/A
              le_mean =     -17.216751588293
             les_mean =     296.732383144232
             stat err =       0.000420146777
             autocorr =       1.175776487963
              std dev =       0.547966046100
             le_variance =       0.300266787678

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300336379118
                                         uncertainty =       0.002333082761

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300336379118
                                         uncertainty =       0.002333082761

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387470507
  error estimate for blocks of size 2^( 2) =       0.000397667092
  error estimate for blocks of size 2^( 3) =       0.000407328301
  error estimate for blocks of size 2^( 4) =       0.000413938855
  error estimate for blocks of size 2^( 5) =       0.000418803711
  error estimate for blocks of size 2^( 6) =       0.000421704394
  error estimate for blocks of size 2^( 7) =       0.000426140150

      target function =                  N/A
              le_mean =     -17.216751588293
             les_mean =     296.732383144232
             stat err =       0.000420146777
             autocorr =       1.175776487963
              std dev =       0.547966046100
             le_variance =       0.300266787678

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300336379118
                                         uncertainty =       0.002333082761

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300336379118
                                         uncertainty =       0.002333082761

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387470507
  error estimate for blocks of size 2^( 2) =       0.000397667092
  error estimate for blocks of size 2^( 3) =       0.000407328301
  error estimate for blocks of size 2^( 4) =       0.000413938855
  error estimate for blocks of size 2^( 5) =       0.000418803711
  error estimate for blocks of size 2^( 6) =       0.000421704394
  error estimate for blocks of size 2^( 7) =       0.000426140150

      target function =                  N/A
              le_mean =     -17.216751588293
             les_mean =     296.732383144232
             stat err =       0.000420146777
             autocorr =       1.175776487963
              std dev =       0.547966046100
             le_variance =       0.300266787678

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300336379118
                                         uncertainty =       0.002333082761

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300336379118
                                         uncertainty =       0.002333082761

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387470507
  error estimate for blocks of size 2^( 2) =       0.000397667092
  error estimate for blocks of size 2^( 3) =       0.000407328301
  error estimate for blocks of size 2^( 4) =       0.000413938855
  error estimate for blocks of size 2^( 5) =       0.000418803711
  error estimate for blocks of size 2^( 6) =       0.000421704394
  error estimate for blocks of size 2^( 7) =       0.000426140150

      target function =                  N/A
              le_mean =     -17.216751588293
             les_mean =     296.732383144232
             stat err =       0.000420146777
             autocorr =       1.175776487963
              std dev =       0.547966046100
             le_variance =       0.300266787678


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216751588293        initial  <--
     5.8208e+19     5.8208e+20             0.0000e+00       -17.216751588293
     2.3283e+20     2.3283e+21             0.0000e+00       -17.216751588293
     9.3132e+20     9.3132e+21             0.0000e+00       -17.216751588293

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 54.0420
  </log>
  <optVariables href="H2O.s046.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0278e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s047 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s047 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=47  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7225e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -17.1704
    reference variance = 0.380243
====================================================
  Execution time = 3.7427e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s047
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5288e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1548e-01
  Total weights = 1.956762915e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0963e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299960568367
                                         uncertainty =       0.001892000882

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299960568367
                                         uncertainty =       0.001892000882

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387332143
  error estimate for blocks of size 2^( 2) =       0.000396866790
  error estimate for blocks of size 2^( 3) =       0.000405728975
  error estimate for blocks of size 2^( 4) =       0.000412457660
  error estimate for blocks of size 2^( 5) =       0.000416975016
  error estimate for blocks of size 2^( 6) =       0.000419700785
  error estimate for blocks of size 2^( 7) =       0.000420327769

      target function =                  N/A
              le_mean =     -17.216332799350
             les_mean =     296.717594132159
             stat err =       0.000417365307
             autocorr =       1.161089281918
              std dev =       0.547770369382
             le_variance =       0.300052377573


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721633279935e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+20, overlap shift 5.8208e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216332799394       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216332799394       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.8208e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+21, overlap shift 2.3283e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216332799394       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216332799394       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+21, overlap shift 9.3132e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216332799394       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216332799394       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.929205 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8400e+01
  </log>
  <optVariables href="H2O.s047.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -17.2829
    reference variance = 0.231499
====================================================
  Execution time = 3.7542e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s047
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1082e-01
  Total weights = 1.9568e+06
  Execution time = 3.3598e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297283282369
                                         uncertainty =       0.002109909211

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297283282369
                                         uncertainty =       0.002109909211

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385488355
  error estimate for blocks of size 2^( 2) =       0.000395274986
  error estimate for blocks of size 2^( 3) =       0.000404046366
  error estimate for blocks of size 2^( 4) =       0.000411182906
  error estimate for blocks of size 2^( 5) =       0.000415148278
  error estimate for blocks of size 2^( 6) =       0.000416477351
  error estimate for blocks of size 2^( 7) =       0.000417707843

      target function =                  N/A
              le_mean =     -17.216250026789
             les_mean =     296.710085098651
             stat err =       0.000415129095
             autocorr =       1.159695087633
              std dev =       0.545162860292
             le_variance =       0.297202544242

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297283282369
                                         uncertainty =       0.002109909211

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297283282369
                                         uncertainty =       0.002109909211

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385488355
  error estimate for blocks of size 2^( 2) =       0.000395274986
  error estimate for blocks of size 2^( 3) =       0.000404046366
  error estimate for blocks of size 2^( 4) =       0.000411182906
  error estimate for blocks of size 2^( 5) =       0.000415148278
  error estimate for blocks of size 2^( 6) =       0.000416477351
  error estimate for blocks of size 2^( 7) =       0.000417707843

      target function =                  N/A
              le_mean =     -17.216250026789
             les_mean =     296.710085098651
             stat err =       0.000415129095
             autocorr =       1.159695087633
              std dev =       0.545162860292
             le_variance =       0.297202544242

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297283282369
                                         uncertainty =       0.002109909211

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297283282369
                                         uncertainty =       0.002109909211

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385488355
  error estimate for blocks of size 2^( 2) =       0.000395274986
  error estimate for blocks of size 2^( 3) =       0.000404046366
  error estimate for blocks of size 2^( 4) =       0.000411182906
  error estimate for blocks of size 2^( 5) =       0.000415148278
  error estimate for blocks of size 2^( 6) =       0.000416477351
  error estimate for blocks of size 2^( 7) =       0.000417707843

      target function =                  N/A
              le_mean =     -17.216250026789
             les_mean =     296.710085098651
             stat err =       0.000415129095
             autocorr =       1.159695087633
              std dev =       0.545162860292
             le_variance =       0.297202544242

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297283282369
                                         uncertainty =       0.002109909211

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297283282369
                                         uncertainty =       0.002109909211

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385488355
  error estimate for blocks of size 2^( 2) =       0.000395274986
  error estimate for blocks of size 2^( 3) =       0.000404046366
  error estimate for blocks of size 2^( 4) =       0.000411182906
  error estimate for blocks of size 2^( 5) =       0.000415148278
  error estimate for blocks of size 2^( 6) =       0.000416477351
  error estimate for blocks of size 2^( 7) =       0.000417707843

      target function =                  N/A
              le_mean =     -17.216250026789
             les_mean =     296.710085098651
             stat err =       0.000415129095
             autocorr =       1.159695087633
              std dev =       0.545162860292
             le_variance =       0.297202544242


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216250026789        initial  <--
     5.8208e+20     5.8208e+21             0.0000e+00       -17.216250026789
     2.3283e+21     2.3283e+22             0.0000e+00       -17.216250026789
     9.3132e+21     9.3132e+22             0.0000e+00       -17.216250026789

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 54.5119
  </log>
  <optVariables href="H2O.s047.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0292e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s048 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s048 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=48  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7225e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -17.2811
    reference variance = 0.269076
====================================================
  Execution time = 3.7528e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s048
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5285e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1635e-01
  Total weights = 1.957101302e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0917e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304286845152
                                         uncertainty =       0.004189454973

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304286845152
                                         uncertainty =       0.004189454973

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390084688
  error estimate for blocks of size 2^( 2) =       0.000400133273
  error estimate for blocks of size 2^( 3) =       0.000409073073
  error estimate for blocks of size 2^( 4) =       0.000416316121
  error estimate for blocks of size 2^( 5) =       0.000420425290
  error estimate for blocks of size 2^( 6) =       0.000422966210
  error estimate for blocks of size 2^( 7) =       0.000424420568

      target function =                  N/A
              le_mean =     -17.216232615077
             les_mean =     296.715018224165
             stat err =       0.000421032047
             autocorr =       1.164963990228
              std dev =       0.551663056313
             le_variance =       0.304332127700


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721623261508e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+21, overlap shift 5.8208e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216232615071       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216232615071       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.8208e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+22, overlap shift 2.3283e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216232615071       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216232615071       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+22, overlap shift 9.3132e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216232615071       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216232615071       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.930568 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8456e+01
  </log>
  <optVariables href="H2O.s048.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -17.2241
    reference variance = 0.274781
====================================================
  Execution time = 3.8061e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s048
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.3692e-01
  Total weights = 1.9566e+06
  Execution time = 3.3495e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304762915263
                                         uncertainty =       0.003538701510

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304762915263
                                         uncertainty =       0.003538701510

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390359592
  error estimate for blocks of size 2^( 2) =       0.000400386933
  error estimate for blocks of size 2^( 3) =       0.000409500295
  error estimate for blocks of size 2^( 4) =       0.000416176304
  error estimate for blocks of size 2^( 5) =       0.000421100690
  error estimate for blocks of size 2^( 6) =       0.000423546047
  error estimate for blocks of size 2^( 7) =       0.000425907286

      target function =                  N/A
              le_mean =     -17.216268656143
             les_mean =     296.736825368312
             stat err =       0.000421682582
             autocorr =       1.166921426627
              std dev =       0.552051828602
             le_variance =       0.304761221463

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304762915263
                                         uncertainty =       0.003538701510

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304762915263
                                         uncertainty =       0.003538701510

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390359592
  error estimate for blocks of size 2^( 2) =       0.000400386933
  error estimate for blocks of size 2^( 3) =       0.000409500295
  error estimate for blocks of size 2^( 4) =       0.000416176304
  error estimate for blocks of size 2^( 5) =       0.000421100690
  error estimate for blocks of size 2^( 6) =       0.000423546047
  error estimate for blocks of size 2^( 7) =       0.000425907286

      target function =                  N/A
              le_mean =     -17.216268656143
             les_mean =     296.736825368312
             stat err =       0.000421682582
             autocorr =       1.166921426627
              std dev =       0.552051828602
             le_variance =       0.304761221463

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304762915263
                                         uncertainty =       0.003538701510

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304762915263
                                         uncertainty =       0.003538701510

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390359592
  error estimate for blocks of size 2^( 2) =       0.000400386933
  error estimate for blocks of size 2^( 3) =       0.000409500295
  error estimate for blocks of size 2^( 4) =       0.000416176304
  error estimate for blocks of size 2^( 5) =       0.000421100690
  error estimate for blocks of size 2^( 6) =       0.000423546047
  error estimate for blocks of size 2^( 7) =       0.000425907286

      target function =                  N/A
              le_mean =     -17.216268656143
             les_mean =     296.736825368312
             stat err =       0.000421682582
             autocorr =       1.166921426627
              std dev =       0.552051828602
             le_variance =       0.304761221463

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304762915263
                                         uncertainty =       0.003538701510

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304762915263
                                         uncertainty =       0.003538701510

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390359592
  error estimate for blocks of size 2^( 2) =       0.000400386933
  error estimate for blocks of size 2^( 3) =       0.000409500295
  error estimate for blocks of size 2^( 4) =       0.000416176304
  error estimate for blocks of size 2^( 5) =       0.000421100690
  error estimate for blocks of size 2^( 6) =       0.000423546047
  error estimate for blocks of size 2^( 7) =       0.000425907286

      target function =                  N/A
              le_mean =     -17.216268656143
             les_mean =     296.736825368312
             stat err =       0.000421682582
             autocorr =       1.166921426627
              std dev =       0.552051828602
             le_variance =       0.304761221463


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216268656143        initial  <--
     5.8208e+21     5.8208e+22             0.0000e+00       -17.216268656143
     2.3283e+22     2.3283e+23             0.0000e+00       -17.216268656143
     9.3132e+22     9.3132e+23             0.0000e+00       -17.216268656143

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 55.0027
  </log>
  <optVariables href="H2O.s048.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0347e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s049 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s049 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=49  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7226e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -17.2567
    reference variance = 0.231401
====================================================
  Execution time = 3.7393e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s049
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5269e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1731e-01
  Total weights = 1.956651241e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1107e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301674266629
                                         uncertainty =       0.003098403316

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301674266629
                                         uncertainty =       0.003098403316

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388319196
  error estimate for blocks of size 2^( 2) =       0.000398200465
  error estimate for blocks of size 2^( 3) =       0.000407559165
  error estimate for blocks of size 2^( 4) =       0.000414196381
  error estimate for blocks of size 2^( 5) =       0.000418207054
  error estimate for blocks of size 2^( 6) =       0.000419439899
  error estimate for blocks of size 2^( 7) =       0.000418488305

      target function =                  N/A
              le_mean =     -17.216263955031
             les_mean =     296.717053235924
             stat err =       0.000417582910
             autocorr =       1.156399014947
              std dev =       0.549166273414
             le_variance =       0.301583595855


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721626395503e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+22, overlap shift 5.8208e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216263955078       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216263955078       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.8208e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+23, overlap shift 2.3283e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216263955078       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216263955078       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+23, overlap shift 9.3132e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216263955078       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216263955078       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.931771 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8512e+01
  </log>
  <optVariables href="H2O.s049.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -17.1669
    reference variance = 0.271128
====================================================
  Execution time = 3.7266e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s049
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1901e-01
  Total weights = 1.9565e+06
  Execution time = 3.3471e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301038821860
                                         uncertainty =       0.002961366119

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301038821860
                                         uncertainty =       0.002961366119

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387991725
  error estimate for blocks of size 2^( 2) =       0.000398171783
  error estimate for blocks of size 2^( 3) =       0.000406767876
  error estimate for blocks of size 2^( 4) =       0.000412985207
  error estimate for blocks of size 2^( 5) =       0.000417426590
  error estimate for blocks of size 2^( 6) =       0.000420110577
  error estimate for blocks of size 2^( 7) =       0.000421369110

      target function =                  N/A
              le_mean =     -17.216331646543
             les_mean =     296.721088283344
             stat err =       0.000417972871
             autocorr =       1.160516347243
              std dev =       0.548703159943
             le_variance =       0.301075157731

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301038821860
                                         uncertainty =       0.002961366119

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301038821860
                                         uncertainty =       0.002961366119

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387991725
  error estimate for blocks of size 2^( 2) =       0.000398171783
  error estimate for blocks of size 2^( 3) =       0.000406767876
  error estimate for blocks of size 2^( 4) =       0.000412985207
  error estimate for blocks of size 2^( 5) =       0.000417426590
  error estimate for blocks of size 2^( 6) =       0.000420110577
  error estimate for blocks of size 2^( 7) =       0.000421369110

      target function =                  N/A
              le_mean =     -17.216331646543
             les_mean =     296.721088283344
             stat err =       0.000417972871
             autocorr =       1.160516347243
              std dev =       0.548703159943
             le_variance =       0.301075157731

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301038821860
                                         uncertainty =       0.002961366119

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301038821860
                                         uncertainty =       0.002961366119

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387991725
  error estimate for blocks of size 2^( 2) =       0.000398171783
  error estimate for blocks of size 2^( 3) =       0.000406767876
  error estimate for blocks of size 2^( 4) =       0.000412985207
  error estimate for blocks of size 2^( 5) =       0.000417426590
  error estimate for blocks of size 2^( 6) =       0.000420110577
  error estimate for blocks of size 2^( 7) =       0.000421369110

      target function =                  N/A
              le_mean =     -17.216331646543
             les_mean =     296.721088283344
             stat err =       0.000417972871
             autocorr =       1.160516347243
              std dev =       0.548703159943
             le_variance =       0.301075157731

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301038821860
                                         uncertainty =       0.002961366119

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301038821860
                                         uncertainty =       0.002961366119

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387991725
  error estimate for blocks of size 2^( 2) =       0.000398171783
  error estimate for blocks of size 2^( 3) =       0.000406767876
  error estimate for blocks of size 2^( 4) =       0.000412985207
  error estimate for blocks of size 2^( 5) =       0.000417426590
  error estimate for blocks of size 2^( 6) =       0.000420110577
  error estimate for blocks of size 2^( 7) =       0.000421369110

      target function =                  N/A
              le_mean =     -17.216331646543
             les_mean =     296.721088283344
             stat err =       0.000417972871
             autocorr =       1.160516347243
              std dev =       0.548703159943
             le_variance =       0.301075157731


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216331646543        initial  <--
     5.8208e+22     5.8208e+23             0.0000e+00       -17.216331646543
     2.3283e+23     2.3283e+24             0.0000e+00       -17.216331646543
     9.3132e+23     9.3132e+24             0.0000e+00       -17.216331646543

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 54.2136
  </log>
  <optVariables href="H2O.s049.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0273e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s050 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s050 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=50  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7225e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -17.2179
    reference variance = 0.294574
====================================================
  Execution time = 3.7388e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s050
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5259e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1105e-01
  Total weights = 1.956518775e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0926e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297693139506
                                         uncertainty =       0.002333846898

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297693139506
                                         uncertainty =       0.002333846898

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385749808
  error estimate for blocks of size 2^( 2) =       0.000395680890
  error estimate for blocks of size 2^( 3) =       0.000404213436
  error estimate for blocks of size 2^( 4) =       0.000411138839
  error estimate for blocks of size 2^( 5) =       0.000415935445
  error estimate for blocks of size 2^( 6) =       0.000416900506
  error estimate for blocks of size 2^( 7) =       0.000416841240

      target function =                  N/A
              le_mean =     -17.216774194970
             les_mean =     296.728365793142
             stat err =       0.000415204008
             autocorr =       1.158541609538
              std dev =       0.545532610302
             le_variance =       0.297605828902


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721677419497e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+23, overlap shift 5.8208e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216774195026       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216774195026       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.8208e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+24, overlap shift 2.3283e+25 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216774195026       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216774195026       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+24 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+24, overlap shift 9.3132e+25 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216774195026       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216774195026       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+24 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.932954 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8324e+01
  </log>
  <optVariables href="H2O.s050.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -17.174
    reference variance = 0.199594
====================================================
  Execution time = 3.7208e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s050
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0849e-01
  Total weights = 1.9567e+06
  Execution time = 3.3513e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296059072109
                                         uncertainty =       0.001810858723

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296059072109
                                         uncertainty =       0.001810858723

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384738692
  error estimate for blocks of size 2^( 2) =       0.000394497658
  error estimate for blocks of size 2^( 3) =       0.000403426549
  error estimate for blocks of size 2^( 4) =       0.000410132187
  error estimate for blocks of size 2^( 5) =       0.000413424599
  error estimate for blocks of size 2^( 6) =       0.000415139871
  error estimate for blocks of size 2^( 7) =       0.000416819005

      target function =                  N/A
              le_mean =     -17.216198692289
             les_mean =     296.705987007598
             stat err =       0.000413878916
             autocorr =       1.157217191850
              std dev =       0.544102675918
             le_variance =       0.296047721941

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296059072109
                                         uncertainty =       0.001810858723

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296059072109
                                         uncertainty =       0.001810858723

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384738692
  error estimate for blocks of size 2^( 2) =       0.000394497658
  error estimate for blocks of size 2^( 3) =       0.000403426549
  error estimate for blocks of size 2^( 4) =       0.000410132187
  error estimate for blocks of size 2^( 5) =       0.000413424599
  error estimate for blocks of size 2^( 6) =       0.000415139871
  error estimate for blocks of size 2^( 7) =       0.000416819005

      target function =                  N/A
              le_mean =     -17.216198692289
             les_mean =     296.705987007598
             stat err =       0.000413878916
             autocorr =       1.157217191850
              std dev =       0.544102675918
             le_variance =       0.296047721941

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296059072109
                                         uncertainty =       0.001810858723

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296059072109
                                         uncertainty =       0.001810858723

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384738692
  error estimate for blocks of size 2^( 2) =       0.000394497658
  error estimate for blocks of size 2^( 3) =       0.000403426549
  error estimate for blocks of size 2^( 4) =       0.000410132187
  error estimate for blocks of size 2^( 5) =       0.000413424599
  error estimate for blocks of size 2^( 6) =       0.000415139871
  error estimate for blocks of size 2^( 7) =       0.000416819005

      target function =                  N/A
              le_mean =     -17.216198692289
             les_mean =     296.705987007598
             stat err =       0.000413878916
             autocorr =       1.157217191850
              std dev =       0.544102675918
             le_variance =       0.296047721941

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296059072109
                                         uncertainty =       0.001810858723

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296059072109
                                         uncertainty =       0.001810858723

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384738692
  error estimate for blocks of size 2^( 2) =       0.000394497658
  error estimate for blocks of size 2^( 3) =       0.000403426549
  error estimate for blocks of size 2^( 4) =       0.000410132187
  error estimate for blocks of size 2^( 5) =       0.000413424599
  error estimate for blocks of size 2^( 6) =       0.000415139871
  error estimate for blocks of size 2^( 7) =       0.000416819005

      target function =                  N/A
              le_mean =     -17.216198692289
             les_mean =     296.705987007598
             stat err =       0.000413878916
             autocorr =       1.157217191850
              std dev =       0.544102675918
             le_variance =       0.296047721941


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216198692289        initial  <--
     5.8208e+23     5.8208e+24             0.0000e+00       -17.216198692289
     2.3283e+24     2.3283e+25             0.0000e+00       -17.216198692289
     9.3132e+24     9.3132e+25             0.0000e+00       -17.216198692289

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 54.1399
  </log>
  <optVariables href="H2O.s050.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0247e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s051 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s051 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=51  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7225e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -17.2113
    reference variance = 0.203088
====================================================
  Execution time = 3.7521e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s051
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5296e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1354e-01
  Total weights = 1.956937381e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1123e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299047929614
                                         uncertainty =       0.001946772246

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299047929614
                                         uncertainty =       0.001946772246

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386660663
  error estimate for blocks of size 2^( 2) =       0.000396572331
  error estimate for blocks of size 2^( 3) =       0.000405789467
  error estimate for blocks of size 2^( 4) =       0.000412738463
  error estimate for blocks of size 2^( 5) =       0.000417797796
  error estimate for blocks of size 2^( 6) =       0.000420517912
  error estimate for blocks of size 2^( 7) =       0.000420125314

      target function =                  N/A
              le_mean =     -17.216491368635
             les_mean =     296.721111936078
             stat err =       0.000417794871
             autocorr =       1.167525102427
              std dev =       0.546820753338
             le_variance =       0.299012936281


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721649136864e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+24, overlap shift 5.8208e+25 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216491368671       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216491368671       residual = 2.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216491972340       residual = 1.58e+07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216491969501       residual = 9.14e+05           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.8208e+24 is 5.553234e-29

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+25, overlap shift 2.3283e+26 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216491368671       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216491368671       residual = 2.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216491368672       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+25 is 1.388309e-29

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+25, overlap shift 9.3132e+26 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216491368671       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216491368671       residual = 2.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216491368672       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+25 is 3.470771e-30

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.934593 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8655e+01
  </log>
  <optVariables href="H2O.s051.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -17.2386
    reference variance = 0.185995
====================================================
  Execution time = 3.7676e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s051
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1350e-01
  Total weights = 1.9563e+06
  Execution time = 3.3554e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298049915524
                                         uncertainty =       0.002423101699

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298049915524
                                         uncertainty =       0.002423101699

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386048014
  error estimate for blocks of size 2^( 2) =       0.000396150823
  error estimate for blocks of size 2^( 3) =       0.000405130858
  error estimate for blocks of size 2^( 4) =       0.000411813234
  error estimate for blocks of size 2^( 5) =       0.000415910696
  error estimate for blocks of size 2^( 6) =       0.000417146322
  error estimate for blocks of size 2^( 7) =       0.000418378240

      target function =                  N/A
              le_mean =     -17.216665434296
             les_mean =     296.727068900524
             stat err =       0.000415812123
             autocorr =       1.160143332848
              std dev =       0.545954337344
             le_variance =       0.298066138465

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298049915524
                                         uncertainty =       0.002423101699

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298049915524
                                         uncertainty =       0.002423101699

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386048014
  error estimate for blocks of size 2^( 2) =       0.000396150823
  error estimate for blocks of size 2^( 3) =       0.000405130858
  error estimate for blocks of size 2^( 4) =       0.000411813234
  error estimate for blocks of size 2^( 5) =       0.000415910696
  error estimate for blocks of size 2^( 6) =       0.000417146322
  error estimate for blocks of size 2^( 7) =       0.000418378240

      target function =                  N/A
              le_mean =     -17.216665434296
             les_mean =     296.727068900524
             stat err =       0.000415812123
             autocorr =       1.160143332848
              std dev =       0.545954337344
             le_variance =       0.298066138465

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298049915524
                                         uncertainty =       0.002423101699

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298049915524
                                         uncertainty =       0.002423101699

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386048014
  error estimate for blocks of size 2^( 2) =       0.000396150823
  error estimate for blocks of size 2^( 3) =       0.000405130858
  error estimate for blocks of size 2^( 4) =       0.000411813234
  error estimate for blocks of size 2^( 5) =       0.000415910696
  error estimate for blocks of size 2^( 6) =       0.000417146322
  error estimate for blocks of size 2^( 7) =       0.000418378240

      target function =                  N/A
              le_mean =     -17.216665434296
             les_mean =     296.727068900524
             stat err =       0.000415812123
             autocorr =       1.160143332848
              std dev =       0.545954337344
             le_variance =       0.298066138465

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298049915524
                                         uncertainty =       0.002423101699

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298049915524
                                         uncertainty =       0.002423101699

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386048014
  error estimate for blocks of size 2^( 2) =       0.000396150823
  error estimate for blocks of size 2^( 3) =       0.000405130858
  error estimate for blocks of size 2^( 4) =       0.000411813234
  error estimate for blocks of size 2^( 5) =       0.000415910696
  error estimate for blocks of size 2^( 6) =       0.000417146322
  error estimate for blocks of size 2^( 7) =       0.000418378240

      target function =                  N/A
              le_mean =     -17.216665434296
             les_mean =     296.727068900524
             stat err =       0.000415812123
             autocorr =       1.160143332848
              std dev =       0.545954337344
             le_variance =       0.298066138465


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216665434296        initial  <--
     5.8208e+24     5.8208e+25             5.5532e-29       -17.216665434296
     2.3283e+25     2.3283e+26             1.3883e-29       -17.216665434296
     9.3132e+25     9.3132e+26             3.4708e-30       -17.216665434296

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 54.6805
  </log>
  <optVariables href="H2O.s051.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0334e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s052 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s052 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=52  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7225e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -17.1998
    reference variance = 0.141631
====================================================
  Execution time = 3.7650e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s052
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5279e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1800e-01
  Total weights = 1.956708458e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0918e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300420956585
                                         uncertainty =       0.001743313397

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300420956585
                                         uncertainty =       0.001743313397

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387573378
  error estimate for blocks of size 2^( 2) =       0.000398020405
  error estimate for blocks of size 2^( 3) =       0.000407573934
  error estimate for blocks of size 2^( 4) =       0.000413672939
  error estimate for blocks of size 2^( 5) =       0.000418784226
  error estimate for blocks of size 2^( 6) =       0.000420947050
  error estimate for blocks of size 2^( 7) =       0.000420741238

      target function =                  N/A
              le_mean =     -17.216971930555
             les_mean =     296.742117714920
             stat err =       0.000418536363
             autocorr =       1.166161010703
              std dev =       0.548111526971
             le_variance =       0.300426245998


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721697193056e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+25, overlap shift 5.8208e+26 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216971930634       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216971930634       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.8208e+25 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+26, overlap shift 2.3283e+27 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216971930634       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216971930634       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+26 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+26, overlap shift 9.3132e+27 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216971930634       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216971930634       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+26 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.935805 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8578e+01
  </log>
  <optVariables href="H2O.s052.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -17.1992
    reference variance = 0.176875
====================================================
  Execution time = 3.7498e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s052
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1719e-01
  Total weights = 1.9568e+06
  Execution time = 3.3566e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302937671547
                                         uncertainty =       0.002133495285

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302937671547
                                         uncertainty =       0.002133495285

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389182528
  error estimate for blocks of size 2^( 2) =       0.000399409203
  error estimate for blocks of size 2^( 3) =       0.000408610876
  error estimate for blocks of size 2^( 4) =       0.000414820330
  error estimate for blocks of size 2^( 5) =       0.000419936861
  error estimate for blocks of size 2^( 6) =       0.000421975007
  error estimate for blocks of size 2^( 7) =       0.000422172982

      target function =                  N/A
              le_mean =     -17.217085114233
             les_mean =     296.745205529138
             stat err =       0.000419726295
             autocorr =       1.163123114838
              std dev =       0.550387209007
             le_variance =       0.302926079839

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302937671547
                                         uncertainty =       0.002133495285

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302937671547
                                         uncertainty =       0.002133495285

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389182528
  error estimate for blocks of size 2^( 2) =       0.000399409203
  error estimate for blocks of size 2^( 3) =       0.000408610876
  error estimate for blocks of size 2^( 4) =       0.000414820330
  error estimate for blocks of size 2^( 5) =       0.000419936861
  error estimate for blocks of size 2^( 6) =       0.000421975007
  error estimate for blocks of size 2^( 7) =       0.000422172982

      target function =                  N/A
              le_mean =     -17.217085114233
             les_mean =     296.745205529138
             stat err =       0.000419726295
             autocorr =       1.163123114838
              std dev =       0.550387209007
             le_variance =       0.302926079839

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302937671547
                                         uncertainty =       0.002133495285

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302937671547
                                         uncertainty =       0.002133495285

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389182528
  error estimate for blocks of size 2^( 2) =       0.000399409203
  error estimate for blocks of size 2^( 3) =       0.000408610876
  error estimate for blocks of size 2^( 4) =       0.000414820330
  error estimate for blocks of size 2^( 5) =       0.000419936861
  error estimate for blocks of size 2^( 6) =       0.000421975007
  error estimate for blocks of size 2^( 7) =       0.000422172982

      target function =                  N/A
              le_mean =     -17.217085114233
             les_mean =     296.745205529138
             stat err =       0.000419726295
             autocorr =       1.163123114838
              std dev =       0.550387209007
             le_variance =       0.302926079839

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302937671547
                                         uncertainty =       0.002133495285

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302937671547
                                         uncertainty =       0.002133495285

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389182528
  error estimate for blocks of size 2^( 2) =       0.000399409203
  error estimate for blocks of size 2^( 3) =       0.000408610876
  error estimate for blocks of size 2^( 4) =       0.000414820330
  error estimate for blocks of size 2^( 5) =       0.000419936861
  error estimate for blocks of size 2^( 6) =       0.000421975007
  error estimate for blocks of size 2^( 7) =       0.000422172982

      target function =                  N/A
              le_mean =     -17.217085114233
             les_mean =     296.745205529138
             stat err =       0.000419726295
             autocorr =       1.163123114838
              std dev =       0.550387209007
             le_variance =       0.302926079839


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217085114233        initial  <--
     5.8208e+25     5.8208e+26             0.0000e+00       -17.217085114233
     2.3283e+26     2.3283e+27             0.0000e+00       -17.217085114233
     9.3132e+26     9.3132e+27             0.0000e+00       -17.217085114233

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 54.4891
  </log>
  <optVariables href="H2O.s052.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0307e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s053 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s053 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=53  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7224e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -17.1678
    reference variance = 0.396721
====================================================
  Execution time = 3.7588e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s053
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5316e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1476e-01
  Total weights = 1.956691667e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0894e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298335756637
                                         uncertainty =       0.002180705934

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298335756637
                                         uncertainty =       0.002180705934

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386188460
  error estimate for blocks of size 2^( 2) =       0.000396224518
  error estimate for blocks of size 2^( 3) =       0.000405254335
  error estimate for blocks of size 2^( 4) =       0.000411369759
  error estimate for blocks of size 2^( 5) =       0.000415396779
  error estimate for blocks of size 2^( 6) =       0.000418749153
  error estimate for blocks of size 2^( 7) =       0.000419362535

      target function =                  N/A
              le_mean =     -17.216286526469
             les_mean =     296.715280843928
             stat err =       0.000416219556
             autocorr =       1.161572654933
              std dev =       0.546152957757
             le_variance =       0.298283053267


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721628652647e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+26, overlap shift 5.8208e+27 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216286526515       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216286526515       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.8208e+26 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+27, overlap shift 2.3283e+28 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216286526515       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216286526515       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+27 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+27, overlap shift 9.3132e+28 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216286526515       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216286526515       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+27 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.937008 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8492e+01
  </log>
  <optVariables href="H2O.s053.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -17.2013
    reference variance = 0.174906
====================================================
  Execution time = 3.7600e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s053
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1700e-01
  Total weights = 1.9565e+06
  Execution time = 3.3547e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301929949935
                                         uncertainty =       0.002294081043

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301929949935
                                         uncertainty =       0.002294081043

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388527976
  error estimate for blocks of size 2^( 2) =       0.000398311299
  error estimate for blocks of size 2^( 3) =       0.000407616354
  error estimate for blocks of size 2^( 4) =       0.000415321773
  error estimate for blocks of size 2^( 5) =       0.000419576161
  error estimate for blocks of size 2^( 6) =       0.000421419404
  error estimate for blocks of size 2^( 7) =       0.000423509238

      target function =                  N/A
              le_mean =     -17.216628103134
             les_mean =     296.729286247634
             stat err =       0.000419956644
             autocorr =       1.168326751412
              std dev =       0.549461533099
             le_variance =       0.301907976356

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301929949935
                                         uncertainty =       0.002294081043

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301929949935
                                         uncertainty =       0.002294081043

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388527976
  error estimate for blocks of size 2^( 2) =       0.000398311299
  error estimate for blocks of size 2^( 3) =       0.000407616354
  error estimate for blocks of size 2^( 4) =       0.000415321773
  error estimate for blocks of size 2^( 5) =       0.000419576161
  error estimate for blocks of size 2^( 6) =       0.000421419404
  error estimate for blocks of size 2^( 7) =       0.000423509238

      target function =                  N/A
              le_mean =     -17.216628103134
             les_mean =     296.729286247634
             stat err =       0.000419956644
             autocorr =       1.168326751412
              std dev =       0.549461533099
             le_variance =       0.301907976356

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301929949935
                                         uncertainty =       0.002294081043

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301929949935
                                         uncertainty =       0.002294081043

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388527976
  error estimate for blocks of size 2^( 2) =       0.000398311299
  error estimate for blocks of size 2^( 3) =       0.000407616354
  error estimate for blocks of size 2^( 4) =       0.000415321773
  error estimate for blocks of size 2^( 5) =       0.000419576161
  error estimate for blocks of size 2^( 6) =       0.000421419404
  error estimate for blocks of size 2^( 7) =       0.000423509238

      target function =                  N/A
              le_mean =     -17.216628103134
             les_mean =     296.729286247634
             stat err =       0.000419956644
             autocorr =       1.168326751412
              std dev =       0.549461533099
             le_variance =       0.301907976356

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301929949935
                                         uncertainty =       0.002294081043

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301929949935
                                         uncertainty =       0.002294081043

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388527976
  error estimate for blocks of size 2^( 2) =       0.000398311299
  error estimate for blocks of size 2^( 3) =       0.000407616354
  error estimate for blocks of size 2^( 4) =       0.000415321773
  error estimate for blocks of size 2^( 5) =       0.000419576161
  error estimate for blocks of size 2^( 6) =       0.000421419404
  error estimate for blocks of size 2^( 7) =       0.000423509238

      target function =                  N/A
              le_mean =     -17.216628103134
             les_mean =     296.729286247634
             stat err =       0.000419956644
             autocorr =       1.168326751412
              std dev =       0.549461533099
             le_variance =       0.301907976356


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216628103134        initial  <--
     5.8208e+26     5.8208e+27             0.0000e+00       -17.216628103134
     2.3283e+27     2.3283e+28             0.0000e+00       -17.216628103134
     9.3132e+27     9.3132e+28             0.0000e+00       -17.216628103134

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 54.7396
  </log>
  <optVariables href="H2O.s053.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0324e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s054 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s054 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=54  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7224e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -17.1618
    reference variance = 0.234602
====================================================
  Execution time = 3.7621e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s054
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5272e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1862e-01
  Total weights = 1.956839469e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1256e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301351603601
                                         uncertainty =       0.002688832094

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301351603601
                                         uncertainty =       0.002688832094

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388136721
  error estimate for blocks of size 2^( 2) =       0.000398319532
  error estimate for blocks of size 2^( 3) =       0.000407325522
  error estimate for blocks of size 2^( 4) =       0.000413576345
  error estimate for blocks of size 2^( 5) =       0.000417811338
  error estimate for blocks of size 2^( 6) =       0.000420052256
  error estimate for blocks of size 2^( 7) =       0.000420747450

      target function =                  N/A
              le_mean =     -17.216415167059
             les_mean =     296.723574846910
             stat err =       0.000418046847
             autocorr =       1.160059964659
              std dev =       0.548908215149
             le_variance =       0.301300228658


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721641516706e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+27, overlap shift 5.8208e+28 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216415167109       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216415167109       residual = 5.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216415167109       residual = 4.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.8208e+27 is 7.510943e-32

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+28, overlap shift 2.3283e+29 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216415167109       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216415167109       residual = 5.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216415167109       residual = 4.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+28 is 1.877736e-32

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+28, overlap shift 9.3132e+29 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216415167109       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216415167109       residual = 5.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216415167109       residual = 4.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+28 is 4.694339e-33

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.938468 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8887e+01
  </log>
  <optVariables href="H2O.s054.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -17.2015
    reference variance = 0.235047
====================================================
  Execution time = 3.7714e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s054
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1419e-01
  Total weights = 1.9567e+06
  Execution time = 3.3537e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300425452762
                                         uncertainty =       0.002008575157

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300425452762
                                         uncertainty =       0.002008575157

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387584631
  error estimate for blocks of size 2^( 2) =       0.000397551313
  error estimate for blocks of size 2^( 3) =       0.000406713076
  error estimate for blocks of size 2^( 4) =       0.000413871603
  error estimate for blocks of size 2^( 5) =       0.000417965395
  error estimate for blocks of size 2^( 6) =       0.000421215517
  error estimate for blocks of size 2^( 7) =       0.000422813085

      target function =                  N/A
              le_mean =     -17.217129241681
             les_mean =     296.743728089739
             stat err =       0.000418966400
             autocorr =       1.168490792225
              std dev =       0.548127442224
             le_variance =       0.300443692919

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300425452762
                                         uncertainty =       0.002008575157

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300425452762
                                         uncertainty =       0.002008575157

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387584631
  error estimate for blocks of size 2^( 2) =       0.000397551313
  error estimate for blocks of size 2^( 3) =       0.000406713076
  error estimate for blocks of size 2^( 4) =       0.000413871603
  error estimate for blocks of size 2^( 5) =       0.000417965395
  error estimate for blocks of size 2^( 6) =       0.000421215517
  error estimate for blocks of size 2^( 7) =       0.000422813085

      target function =                  N/A
              le_mean =     -17.217129241681
             les_mean =     296.743728089739
             stat err =       0.000418966400
             autocorr =       1.168490792225
              std dev =       0.548127442224
             le_variance =       0.300443692919

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300425452762
                                         uncertainty =       0.002008575157

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300425452762
                                         uncertainty =       0.002008575157

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387584631
  error estimate for blocks of size 2^( 2) =       0.000397551313
  error estimate for blocks of size 2^( 3) =       0.000406713076
  error estimate for blocks of size 2^( 4) =       0.000413871603
  error estimate for blocks of size 2^( 5) =       0.000417965395
  error estimate for blocks of size 2^( 6) =       0.000421215517
  error estimate for blocks of size 2^( 7) =       0.000422813085

      target function =                  N/A
              le_mean =     -17.217129241681
             les_mean =     296.743728089739
             stat err =       0.000418966400
             autocorr =       1.168490792225
              std dev =       0.548127442224
             le_variance =       0.300443692919

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300425452762
                                         uncertainty =       0.002008575157

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300425452762
                                         uncertainty =       0.002008575157

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387584631
  error estimate for blocks of size 2^( 2) =       0.000397551313
  error estimate for blocks of size 2^( 3) =       0.000406713076
  error estimate for blocks of size 2^( 4) =       0.000413871603
  error estimate for blocks of size 2^( 5) =       0.000417965395
  error estimate for blocks of size 2^( 6) =       0.000421215517
  error estimate for blocks of size 2^( 7) =       0.000422813085

      target function =                  N/A
              le_mean =     -17.217129241681
             les_mean =     296.743728089739
             stat err =       0.000418966400
             autocorr =       1.168490792225
              std dev =       0.548127442224
             le_variance =       0.300443692919


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217129241681        initial  <--
     5.8208e+27     5.8208e+28             7.5109e-32       -17.217129241681
     2.3283e+28     2.3283e+29             1.8777e-32       -17.217129241681
     9.3132e+28     9.3132e+29             4.6943e-33       -17.217129241681

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 54.6714
  </log>
  <optVariables href="H2O.s054.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0356e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s055 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s055 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=55  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7223e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -17.2532
    reference variance = 0.300754
====================================================
  Execution time = 3.7781e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s055
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5292e+04
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.1348e-01
  Total weights = 1.956465924e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0911e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299246377392
                                         uncertainty =       0.002143517626

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299246377392
                                         uncertainty =       0.002143517626

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386834300
  error estimate for blocks of size 2^( 2) =       0.000396606019
  error estimate for blocks of size 2^( 3) =       0.000405933864
  error estimate for blocks of size 2^( 4) =       0.000412346524
  error estimate for blocks of size 2^( 5) =       0.000417368360
  error estimate for blocks of size 2^( 6) =       0.000419356625
  error estimate for blocks of size 2^( 7) =       0.000421291942

      target function =                  N/A
              le_mean =     -17.217720227756
             les_mean =     296.763366384400
             stat err =       0.000417590863
             autocorr =       1.165338307881
              std dev =       0.547066314037
             le_variance =       0.299281551954


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721772022776e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+28, overlap shift 5.8208e+29 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217720227842       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217720227842       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.8208e+28 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+29, overlap shift 2.3283e+30 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217720227842       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217720227842       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+29 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+29, overlap shift 9.3132e+30 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217720227842       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217720227842       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+29 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.939682 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8702e+01
  </log>
  <optVariables href="H2O.s055.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -17.1877
    reference variance = 0.254224
====================================================
  Execution time = 3.7049e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s055
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1634e-01
  Total weights = 1.9564e+06
  Execution time = 3.3669e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300192758899
                                         uncertainty =       0.002046311676

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300192758899
                                         uncertainty =       0.002046311676

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387362887
  error estimate for blocks of size 2^( 2) =       0.000397373470
  error estimate for blocks of size 2^( 3) =       0.000406033757
  error estimate for blocks of size 2^( 4) =       0.000412535364
  error estimate for blocks of size 2^( 5) =       0.000416411973
  error estimate for blocks of size 2^( 6) =       0.000419440825
  error estimate for blocks of size 2^( 7) =       0.000421152396

      target function =                  N/A
              le_mean =     -17.217171687238
             les_mean =     296.747337758815
             stat err =       0.000417385139
             autocorr =       1.161015312919
              std dev =       0.547813847692
             le_variance =       0.300100011723

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300192758899
                                         uncertainty =       0.002046311676

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300192758899
                                         uncertainty =       0.002046311676

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387362887
  error estimate for blocks of size 2^( 2) =       0.000397373470
  error estimate for blocks of size 2^( 3) =       0.000406033757
  error estimate for blocks of size 2^( 4) =       0.000412535364
  error estimate for blocks of size 2^( 5) =       0.000416411973
  error estimate for blocks of size 2^( 6) =       0.000419440825
  error estimate for blocks of size 2^( 7) =       0.000421152396

      target function =                  N/A
              le_mean =     -17.217171687238
             les_mean =     296.747337758815
             stat err =       0.000417385139
             autocorr =       1.161015312919
              std dev =       0.547813847692
             le_variance =       0.300100011723

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300192758899
                                         uncertainty =       0.002046311676

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300192758899
                                         uncertainty =       0.002046311676

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387362887
  error estimate for blocks of size 2^( 2) =       0.000397373470
  error estimate for blocks of size 2^( 3) =       0.000406033757
  error estimate for blocks of size 2^( 4) =       0.000412535364
  error estimate for blocks of size 2^( 5) =       0.000416411973
  error estimate for blocks of size 2^( 6) =       0.000419440825
  error estimate for blocks of size 2^( 7) =       0.000421152396

      target function =                  N/A
              le_mean =     -17.217171687238
             les_mean =     296.747337758815
             stat err =       0.000417385139
             autocorr =       1.161015312919
              std dev =       0.547813847692
             le_variance =       0.300100011723

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300192758899
                                         uncertainty =       0.002046311676

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300192758899
                                         uncertainty =       0.002046311676

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387362887
  error estimate for blocks of size 2^( 2) =       0.000397373470
  error estimate for blocks of size 2^( 3) =       0.000406033757
  error estimate for blocks of size 2^( 4) =       0.000412535364
  error estimate for blocks of size 2^( 5) =       0.000416411973
  error estimate for blocks of size 2^( 6) =       0.000419440825
  error estimate for blocks of size 2^( 7) =       0.000421152396

      target function =                  N/A
              le_mean =     -17.217171687238
             les_mean =     296.747337758815
             stat err =       0.000417385139
             autocorr =       1.161015312919
              std dev =       0.547813847692
             le_variance =       0.300100011723


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217171687238        initial  <--
     5.8208e+28     5.8208e+29             0.0000e+00       -17.217171687238
     2.3283e+29     2.3283e+30             0.0000e+00       -17.217171687238
     9.3132e+29     9.3132e+30             0.0000e+00       -17.217171687238

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 54.0675
  </log>
  <optVariables href="H2O.s055.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0278e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s056 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s056 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=56  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7223e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -17.1838
    reference variance = 0.278961
====================================================
  Execution time = 3.7609e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s056
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5273e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1686e-01
  Total weights = 1.956786601e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1019e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302910663885
                                         uncertainty =       0.002413152064

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302910663885
                                         uncertainty =       0.002413152064

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389143343
  error estimate for blocks of size 2^( 2) =       0.000399040838
  error estimate for blocks of size 2^( 3) =       0.000407750858
  error estimate for blocks of size 2^( 4) =       0.000413702500
  error estimate for blocks of size 2^( 5) =       0.000418500439
  error estimate for blocks of size 2^( 6) =       0.000419752312
  error estimate for blocks of size 2^( 7) =       0.000419343152

      target function =                  N/A
              le_mean =     -17.216090612737
             les_mean =     296.710640700155
             stat err =       0.000417824601
             autocorr =       1.152839378704
              std dev =       0.550331793728
             le_variance =       0.302865083188


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721609061274e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+29, overlap shift 5.8208e+30 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216090612796       residual = 3.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216090612796       residual = 3.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.8208e+29 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+30, overlap shift 2.3283e+31 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216090612796       residual = 3.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216090612796       residual = 3.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+30 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+30, overlap shift 9.3132e+31 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216090612796       residual = 3.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216090612796       residual = 3.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+30 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.940892 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8638e+01
  </log>
  <optVariables href="H2O.s056.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -17.3555
    reference variance = 0.733397
====================================================
  Execution time = 3.7383e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s056
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1616e-01
  Total weights = 1.9566e+06
  Execution time = 3.3866e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301077633280
                                         uncertainty =       0.002251847354

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301077633280
                                         uncertainty =       0.002251847354

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387978764
  error estimate for blocks of size 2^( 2) =       0.000397894764
  error estimate for blocks of size 2^( 3) =       0.000406736452
  error estimate for blocks of size 2^( 4) =       0.000413721884
  error estimate for blocks of size 2^( 5) =       0.000416834818
  error estimate for blocks of size 2^( 6) =       0.000419060804
  error estimate for blocks of size 2^( 7) =       0.000423548309

      target function =                  N/A
              le_mean =     -17.215592172423
             les_mean =     296.692771370921
             stat err =       0.000418291454
             autocorr =       1.162363791157
              std dev =       0.548684830031
             le_variance =       0.301055042706

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301077633280
                                         uncertainty =       0.002251847354

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301077633280
                                         uncertainty =       0.002251847354

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387978764
  error estimate for blocks of size 2^( 2) =       0.000397894764
  error estimate for blocks of size 2^( 3) =       0.000406736452
  error estimate for blocks of size 2^( 4) =       0.000413721884
  error estimate for blocks of size 2^( 5) =       0.000416834818
  error estimate for blocks of size 2^( 6) =       0.000419060804
  error estimate for blocks of size 2^( 7) =       0.000423548309

      target function =                  N/A
              le_mean =     -17.215592172423
             les_mean =     296.692771370921
             stat err =       0.000418291454
             autocorr =       1.162363791157
              std dev =       0.548684830031
             le_variance =       0.301055042706

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301077633280
                                         uncertainty =       0.002251847354

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301077633280
                                         uncertainty =       0.002251847354

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387978764
  error estimate for blocks of size 2^( 2) =       0.000397894764
  error estimate for blocks of size 2^( 3) =       0.000406736452
  error estimate for blocks of size 2^( 4) =       0.000413721884
  error estimate for blocks of size 2^( 5) =       0.000416834818
  error estimate for blocks of size 2^( 6) =       0.000419060804
  error estimate for blocks of size 2^( 7) =       0.000423548309

      target function =                  N/A
              le_mean =     -17.215592172423
             les_mean =     296.692771370921
             stat err =       0.000418291454
             autocorr =       1.162363791157
              std dev =       0.548684830031
             le_variance =       0.301055042706

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301077633280
                                         uncertainty =       0.002251847354

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301077633280
                                         uncertainty =       0.002251847354

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387978764
  error estimate for blocks of size 2^( 2) =       0.000397894764
  error estimate for blocks of size 2^( 3) =       0.000406736452
  error estimate for blocks of size 2^( 4) =       0.000413721884
  error estimate for blocks of size 2^( 5) =       0.000416834818
  error estimate for blocks of size 2^( 6) =       0.000419060804
  error estimate for blocks of size 2^( 7) =       0.000423548309

      target function =                  N/A
              le_mean =     -17.215592172423
             les_mean =     296.692771370921
             stat err =       0.000418291454
             autocorr =       1.162363791157
              std dev =       0.548684830031
             le_variance =       0.301055042706


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215592172423        initial  <--
     5.8208e+29     5.8208e+30             0.0000e+00       -17.215592172423
     2.3283e+30     2.3283e+31             0.0000e+00       -17.215592172423
     9.3132e+30     9.3132e+31             0.0000e+00       -17.215592172423

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 54.4982
  </log>
  <optVariables href="H2O.s056.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0314e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s057 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s057 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=57  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7224e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -17.3044
    reference variance = 0.323837
====================================================
  Execution time = 3.7687e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s057
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5288e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2062e-01
  Total weights = 1.956243303e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1149e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303053158975
                                         uncertainty =       0.002181648084

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303053158975
                                         uncertainty =       0.002181648084

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389217999
  error estimate for blocks of size 2^( 2) =       0.000399180678
  error estimate for blocks of size 2^( 3) =       0.000408101364
  error estimate for blocks of size 2^( 4) =       0.000414749761
  error estimate for blocks of size 2^( 5) =       0.000419091208
  error estimate for blocks of size 2^( 6) =       0.000421524199
  error estimate for blocks of size 2^( 7) =       0.000423892173

      target function =                  N/A
              le_mean =     -17.217297018578
             les_mean =     296.755939223988
             stat err =       0.000419814335
             autocorr =       1.163399029863
              std dev =       0.550437373017
             le_variance =       0.302981301613


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721729701858e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+30, overlap shift 5.8208e+31 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217297018618       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217297018618       residual = 4.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217297018618       residual = 7.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217297017574       residual = 3.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.8208e+30 is 6.889248e-35

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+31, overlap shift 2.3283e+32 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217297018618       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217297018618       residual = 4.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217297018622       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+31 is 1.722312e-35

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+31, overlap shift 9.3132e+32 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217297018618       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217297018618       residual = 4.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217297018618       residual = 7.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217297017574       residual = 3.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+31 is 4.305780e-36

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.942604 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8847e+01
  </log>
  <optVariables href="H2O.s057.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -17.2176
    reference variance = 0.26731
====================================================
  Execution time = 3.7095e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s057
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1259e-01
  Total weights = 1.9568e+06
  Execution time = 3.3428e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297519081873
                                         uncertainty =       0.001896842637

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297519081873
                                         uncertainty =       0.001896842637

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385658450
  error estimate for blocks of size 2^( 2) =       0.000395643677
  error estimate for blocks of size 2^( 3) =       0.000404570430
  error estimate for blocks of size 2^( 4) =       0.000411841523
  error estimate for blocks of size 2^( 5) =       0.000416371083
  error estimate for blocks of size 2^( 6) =       0.000418740873
  error estimate for blocks of size 2^( 7) =       0.000420090028

      target function =                  N/A
              le_mean =     -17.216143811163
             les_mean =     296.708193056381
             stat err =       0.000416760877
             autocorr =       1.167799227797
              std dev =       0.545403410205
             le_variance =       0.297464879863

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297519081873
                                         uncertainty =       0.001896842637

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297519081873
                                         uncertainty =       0.001896842637

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385658450
  error estimate for blocks of size 2^( 2) =       0.000395643677
  error estimate for blocks of size 2^( 3) =       0.000404570430
  error estimate for blocks of size 2^( 4) =       0.000411841523
  error estimate for blocks of size 2^( 5) =       0.000416371083
  error estimate for blocks of size 2^( 6) =       0.000418740873
  error estimate for blocks of size 2^( 7) =       0.000420090028

      target function =                  N/A
              le_mean =     -17.216143811163
             les_mean =     296.708193056381
             stat err =       0.000416760877
             autocorr =       1.167799227797
              std dev =       0.545403410205
             le_variance =       0.297464879863

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297519081873
                                         uncertainty =       0.001896842637

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297519081873
                                         uncertainty =       0.001896842637

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385658450
  error estimate for blocks of size 2^( 2) =       0.000395643677
  error estimate for blocks of size 2^( 3) =       0.000404570430
  error estimate for blocks of size 2^( 4) =       0.000411841523
  error estimate for blocks of size 2^( 5) =       0.000416371083
  error estimate for blocks of size 2^( 6) =       0.000418740873
  error estimate for blocks of size 2^( 7) =       0.000420090028

      target function =                  N/A
              le_mean =     -17.216143811163
             les_mean =     296.708193056381
             stat err =       0.000416760877
             autocorr =       1.167799227797
              std dev =       0.545403410205
             le_variance =       0.297464879863

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297519081873
                                         uncertainty =       0.001896842637

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297519081873
                                         uncertainty =       0.001896842637

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385658450
  error estimate for blocks of size 2^( 2) =       0.000395643677
  error estimate for blocks of size 2^( 3) =       0.000404570430
  error estimate for blocks of size 2^( 4) =       0.000411841523
  error estimate for blocks of size 2^( 5) =       0.000416371083
  error estimate for blocks of size 2^( 6) =       0.000418740873
  error estimate for blocks of size 2^( 7) =       0.000420090028

      target function =                  N/A
              le_mean =     -17.216143811163
             les_mean =     296.708193056381
             stat err =       0.000416760877
             autocorr =       1.167799227797
              std dev =       0.545403410205
             le_variance =       0.297464879863


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216143811163        initial  <--
     5.8208e+30     5.8208e+31             6.8892e-35       -17.216143811163
     2.3283e+31     2.3283e+32             1.7223e-35       -17.216143811163
     9.3132e+31     9.3132e+32             4.3058e-36       -17.216143811163

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 54.0083
  </log>
  <optVariables href="H2O.s057.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0286e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s058 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s058 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=58  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7224e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -17.2449
    reference variance = 0.396586
====================================================
  Execution time = 3.7551e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s058
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5316e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1690e-01
  Total weights = 1.956416427e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1248e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299672538221
                                         uncertainty =       0.001903936478

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299672538221
                                         uncertainty =       0.001903936478

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387175021
  error estimate for blocks of size 2^( 2) =       0.000397370048
  error estimate for blocks of size 2^( 3) =       0.000406685190
  error estimate for blocks of size 2^( 4) =       0.000413033798
  error estimate for blocks of size 2^( 5) =       0.000416957290
  error estimate for blocks of size 2^( 6) =       0.000421234572
  error estimate for blocks of size 2^( 7) =       0.000422233645

      target function =                  N/A
              le_mean =     -17.216240813226
             les_mean =     296.715851805501
             stat err =       0.000418364826
             autocorr =       1.167604248746
              std dev =       0.547548166278
             le_variance =       0.299808994394


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721624081323e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+31, overlap shift 5.8208e+32 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216240813281       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216240813281       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.8208e+31 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+32, overlap shift 2.3283e+33 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216240813281       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216240813281       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+32 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+32, overlap shift 9.3132e+33 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216240813281       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216240813281       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+32 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.943817 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8809e+01
  </log>
  <optVariables href="H2O.s058.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -17.2674
    reference variance = 0.390811
====================================================
  Execution time = 3.7025e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s058
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1785e-01
  Total weights = 1.9565e+06
  Execution time = 3.3320e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302670061228
                                         uncertainty =       0.002766800655

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302670061228
                                         uncertainty =       0.002766800655

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389004870
  error estimate for blocks of size 2^( 2) =       0.000398786442
  error estimate for blocks of size 2^( 3) =       0.000407697854
  error estimate for blocks of size 2^( 4) =       0.000414777030
  error estimate for blocks of size 2^( 5) =       0.000419340504
  error estimate for blocks of size 2^( 6) =       0.000422777153
  error estimate for blocks of size 2^( 7) =       0.000422464488

      target function =                  N/A
              le_mean =     -17.217059343139
             les_mean =     296.744980784560
             stat err =       0.000419839794
             autocorr =       1.164815450867
              std dev =       0.550135963652
             le_variance =       0.302649578503

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302670061228
                                         uncertainty =       0.002766800655

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302670061228
                                         uncertainty =       0.002766800655

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389004870
  error estimate for blocks of size 2^( 2) =       0.000398786442
  error estimate for blocks of size 2^( 3) =       0.000407697854
  error estimate for blocks of size 2^( 4) =       0.000414777030
  error estimate for blocks of size 2^( 5) =       0.000419340504
  error estimate for blocks of size 2^( 6) =       0.000422777153
  error estimate for blocks of size 2^( 7) =       0.000422464488

      target function =                  N/A
              le_mean =     -17.217059343139
             les_mean =     296.744980784560
             stat err =       0.000419839794
             autocorr =       1.164815450867
              std dev =       0.550135963652
             le_variance =       0.302649578503

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302670061228
                                         uncertainty =       0.002766800655

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302670061228
                                         uncertainty =       0.002766800655

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389004870
  error estimate for blocks of size 2^( 2) =       0.000398786442
  error estimate for blocks of size 2^( 3) =       0.000407697854
  error estimate for blocks of size 2^( 4) =       0.000414777030
  error estimate for blocks of size 2^( 5) =       0.000419340504
  error estimate for blocks of size 2^( 6) =       0.000422777153
  error estimate for blocks of size 2^( 7) =       0.000422464488

      target function =                  N/A
              le_mean =     -17.217059343139
             les_mean =     296.744980784560
             stat err =       0.000419839794
             autocorr =       1.164815450867
              std dev =       0.550135963652
             le_variance =       0.302649578503

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302670061228
                                         uncertainty =       0.002766800655

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302670061228
                                         uncertainty =       0.002766800655

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389004870
  error estimate for blocks of size 2^( 2) =       0.000398786442
  error estimate for blocks of size 2^( 3) =       0.000407697854
  error estimate for blocks of size 2^( 4) =       0.000414777030
  error estimate for blocks of size 2^( 5) =       0.000419340504
  error estimate for blocks of size 2^( 6) =       0.000422777153
  error estimate for blocks of size 2^( 7) =       0.000422464488

      target function =                  N/A
              le_mean =     -17.217059343139
             les_mean =     296.744980784560
             stat err =       0.000419839794
             autocorr =       1.164815450867
              std dev =       0.550135963652
             le_variance =       0.302649578503


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217059343139        initial  <--
     5.8208e+31     5.8208e+32             0.0000e+00       -17.217059343139
     2.3283e+32     2.3283e+33             0.0000e+00       -17.217059343139
     9.3132e+32     9.3132e+33             0.0000e+00       -17.217059343139

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.8899
  </log>
  <optVariables href="H2O.s058.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0270e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s059 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s059 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=59  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7225e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -17.1891
    reference variance = 0.360719
====================================================
  Execution time = 3.7594e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s059
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5293e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1236e-01
  Total weights = 1.956386962e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0908e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298338696276
                                         uncertainty =       0.001769604852

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298338696276
                                         uncertainty =       0.001769604852

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386197309
  error estimate for blocks of size 2^( 2) =       0.000396043595
  error estimate for blocks of size 2^( 3) =       0.000405260820
  error estimate for blocks of size 2^( 4) =       0.000412251972
  error estimate for blocks of size 2^( 5) =       0.000416724488
  error estimate for blocks of size 2^( 6) =       0.000419691570
  error estimate for blocks of size 2^( 7) =       0.000422602794

      target function =                  N/A
              le_mean =     -17.216437576179
             les_mean =     296.718081935161
             stat err =       0.000417817706
             autocorr =       1.170456271926
              std dev =       0.546165472401
             le_variance =       0.298296723243


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721643757618e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+32, overlap shift 5.8208e+33 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216437576223       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216437576223       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.8208e+32 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+33, overlap shift 2.3283e+34 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216437576223       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216437576223       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+33 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+33, overlap shift 9.3132e+34 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216437576223       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216437576223       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+33 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.945027 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8512e+01
  </log>
  <optVariables href="H2O.s059.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -17.1607
    reference variance = 0.2478
====================================================
  Execution time = 3.7167e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s059
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1563e-01
  Total weights = 1.9567e+06
  Execution time = 3.3597e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301302354174
                                         uncertainty =       0.002528044905

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301302354174
                                         uncertainty =       0.002528044905

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388209128
  error estimate for blocks of size 2^( 2) =       0.000398429527
  error estimate for blocks of size 2^( 3) =       0.000407764550
  error estimate for blocks of size 2^( 4) =       0.000414897714
  error estimate for blocks of size 2^( 5) =       0.000418539596
  error estimate for blocks of size 2^( 6) =       0.000421350537
  error estimate for blocks of size 2^( 7) =       0.000422837657

      target function =                  N/A
              le_mean =     -17.216173350233
             les_mean =     296.712250808023
             stat err =       0.000419406376
             autocorr =       1.167181975017
              std dev =       0.549010613290
             le_variance =       0.301412653505

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301302354174
                                         uncertainty =       0.002528044905

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301302354174
                                         uncertainty =       0.002528044905

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388209128
  error estimate for blocks of size 2^( 2) =       0.000398429527
  error estimate for blocks of size 2^( 3) =       0.000407764550
  error estimate for blocks of size 2^( 4) =       0.000414897714
  error estimate for blocks of size 2^( 5) =       0.000418539596
  error estimate for blocks of size 2^( 6) =       0.000421350537
  error estimate for blocks of size 2^( 7) =       0.000422837657

      target function =                  N/A
              le_mean =     -17.216173350233
             les_mean =     296.712250808023
             stat err =       0.000419406376
             autocorr =       1.167181975017
              std dev =       0.549010613290
             le_variance =       0.301412653505

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301302354174
                                         uncertainty =       0.002528044905

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301302354174
                                         uncertainty =       0.002528044905

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388209128
  error estimate for blocks of size 2^( 2) =       0.000398429527
  error estimate for blocks of size 2^( 3) =       0.000407764550
  error estimate for blocks of size 2^( 4) =       0.000414897714
  error estimate for blocks of size 2^( 5) =       0.000418539596
  error estimate for blocks of size 2^( 6) =       0.000421350537
  error estimate for blocks of size 2^( 7) =       0.000422837657

      target function =                  N/A
              le_mean =     -17.216173350233
             les_mean =     296.712250808023
             stat err =       0.000419406376
             autocorr =       1.167181975017
              std dev =       0.549010613290
             le_variance =       0.301412653505

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301302354174
                                         uncertainty =       0.002528044905

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301302354174
                                         uncertainty =       0.002528044905

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388209128
  error estimate for blocks of size 2^( 2) =       0.000398429527
  error estimate for blocks of size 2^( 3) =       0.000407764550
  error estimate for blocks of size 2^( 4) =       0.000414897714
  error estimate for blocks of size 2^( 5) =       0.000418539596
  error estimate for blocks of size 2^( 6) =       0.000421350537
  error estimate for blocks of size 2^( 7) =       0.000422837657

      target function =                  N/A
              le_mean =     -17.216173350233
             les_mean =     296.712250808023
             stat err =       0.000419406376
             autocorr =       1.167181975017
              std dev =       0.549010613290
             le_variance =       0.301412653505


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216173350233        initial  <--
     5.8208e+32     5.8208e+33             0.0000e+00       -17.216173350233
     2.3283e+33     2.3283e+34             0.0000e+00       -17.216173350233
     9.3132e+33     9.3132e+34             0.0000e+00       -17.216173350233

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 54.1709
  </log>
  <optVariables href="H2O.s059.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0269e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s060 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s060 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=60  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7224e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 60
    time step          = 0.05
    reference energy   = -17.2102
    reference variance = 0.255167
====================================================
  Execution time = 3.7699e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s060
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5292e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1154e-01
  Total weights = 1.956333002e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0860e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298606544672
                                         uncertainty =       0.001989817599

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298606544672
                                         uncertainty =       0.001989817599

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386333398
  error estimate for blocks of size 2^( 2) =       0.000396553456
  error estimate for blocks of size 2^( 3) =       0.000405795493
  error estimate for blocks of size 2^( 4) =       0.000412633389
  error estimate for blocks of size 2^( 5) =       0.000416903978
  error estimate for blocks of size 2^( 6) =       0.000418991379
  error estimate for blocks of size 2^( 7) =       0.000419019831

      target function =                  N/A
              le_mean =     -17.216160959641
             les_mean =     296.707739849378
             stat err =       0.000416887144
             autocorr =       1.164427614966
              std dev =       0.546357931549
             le_variance =       0.298506989367


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721616095964e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+33, overlap shift 5.8208e+34 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216160959679       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216160959679       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.8208e+33 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+34, overlap shift 2.3283e+35 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216160959679       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216160959679       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+34 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+34, overlap shift 9.3132e+35 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216160959679       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216160959679       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+34 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.946226 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8569e+01
  </log>
  <optVariables href="H2O.s060.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 60
    time step          = 0.05
    reference energy   = -17.1848
    reference variance = 0.173881
====================================================
  Execution time = 3.6991e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s060
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.1502e-01
  Total weights = 1.9566e+06
  Execution time = 3.3553e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301628199495
                                         uncertainty =       0.001865057846

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301628199495
                                         uncertainty =       0.001865057846

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388324273
  error estimate for blocks of size 2^( 2) =       0.000398259669
  error estimate for blocks of size 2^( 3) =       0.000407131723
  error estimate for blocks of size 2^( 4) =       0.000414314570
  error estimate for blocks of size 2^( 5) =       0.000418563813
  error estimate for blocks of size 2^( 6) =       0.000421372154
  error estimate for blocks of size 2^( 7) =       0.000423422243

      target function =                  N/A
              le_mean =     -17.217508859347
             les_mean =     296.757634200152
             stat err =       0.000419418195
             autocorr =       1.166555642638
              std dev =       0.549173452996
             le_variance =       0.301591481475

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301628199495
                                         uncertainty =       0.001865057846

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301628199495
                                         uncertainty =       0.001865057846

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388324273
  error estimate for blocks of size 2^( 2) =       0.000398259669
  error estimate for blocks of size 2^( 3) =       0.000407131723
  error estimate for blocks of size 2^( 4) =       0.000414314570
  error estimate for blocks of size 2^( 5) =       0.000418563813
  error estimate for blocks of size 2^( 6) =       0.000421372154
  error estimate for blocks of size 2^( 7) =       0.000423422243

      target function =                  N/A
              le_mean =     -17.217508859347
             les_mean =     296.757634200152
             stat err =       0.000419418195
             autocorr =       1.166555642638
              std dev =       0.549173452996
             le_variance =       0.301591481475

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301628199495
                                         uncertainty =       0.001865057846

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301628199495
                                         uncertainty =       0.001865057846

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388324273
  error estimate for blocks of size 2^( 2) =       0.000398259669
  error estimate for blocks of size 2^( 3) =       0.000407131723
  error estimate for blocks of size 2^( 4) =       0.000414314570
  error estimate for blocks of size 2^( 5) =       0.000418563813
  error estimate for blocks of size 2^( 6) =       0.000421372154
  error estimate for blocks of size 2^( 7) =       0.000423422243

      target function =                  N/A
              le_mean =     -17.217508859347
             les_mean =     296.757634200152
             stat err =       0.000419418195
             autocorr =       1.166555642638
              std dev =       0.549173452996
             le_variance =       0.301591481475

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301628199495
                                         uncertainty =       0.001865057846

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301628199495
                                         uncertainty =       0.001865057846

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388324273
  error estimate for blocks of size 2^( 2) =       0.000398259669
  error estimate for blocks of size 2^( 3) =       0.000407131723
  error estimate for blocks of size 2^( 4) =       0.000414314570
  error estimate for blocks of size 2^( 5) =       0.000418563813
  error estimate for blocks of size 2^( 6) =       0.000421372154
  error estimate for blocks of size 2^( 7) =       0.000423422243

      target function =                  N/A
              le_mean =     -17.217508859347
             les_mean =     296.757634200152
             stat err =       0.000419418195
             autocorr =       1.166555642638
              std dev =       0.549173452996
             le_variance =       0.301591481475


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217508859347        initial  <--
     5.8208e+33     5.8208e+34             0.0000e+00       -17.217508859347
     2.3283e+34     2.3283e+35             0.0000e+00       -17.217508859347
     9.3132e+34     9.3132e+35             0.0000e+00       -17.217508859347

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.9495
  </log>
  <optVariables href="H2O.s060.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0252e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s061 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s061 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=61  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7224e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 61
    time step          = 0.05
    reference energy   = -17.1236
    reference variance = 0.390491
====================================================
  Execution time = 3.7493e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s061
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5294e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.0885e-01
  Total weights = 1.956774473e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1062e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296072233776
                                         uncertainty =       0.002126404409

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296072233776
                                         uncertainty =       0.002126404409

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384717055
  error estimate for blocks of size 2^( 2) =       0.000394808783
  error estimate for blocks of size 2^( 3) =       0.000403535690
  error estimate for blocks of size 2^( 4) =       0.000411046045
  error estimate for blocks of size 2^( 5) =       0.000416000112
  error estimate for blocks of size 2^( 6) =       0.000418773937
  error estimate for blocks of size 2^( 7) =       0.000420619229

      target function =                  N/A
              le_mean =     -17.216691608296
             les_mean =     296.723324403589
             stat err =       0.000416609831
             autocorr =       1.172670899357
              std dev =       0.544072077115
             le_variance =       0.296014425096


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721669160830e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+34, overlap shift 5.8208e+35 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216691608342       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216691608342       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216691608342       residual = 8.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216691608342       residual = 4.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.8208e+34 is 6.391545e-39

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+35, overlap shift 2.3283e+36 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216691608342       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216691608342       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216691970825       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+35 is 1.597886e-39

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+35, overlap shift 9.3132e+36 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216691608342       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216691608342       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216691608342       residual = 8.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216691608342       residual = 4.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+35 is 3.994716e-40

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.947950 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8565e+01
  </log>
  <optVariables href="H2O.s061.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 61
    time step          = 0.05
    reference energy   = -17.1841
    reference variance = 0.189464
====================================================
  Execution time = 3.7099e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s061
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.0975e-01
  Total weights = 1.9567e+06
  Execution time = 3.3713e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298183854378
                                         uncertainty =       0.002044184546

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298183854378
                                         uncertainty =       0.002044184546

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386127316
  error estimate for blocks of size 2^( 2) =       0.000395990193
  error estimate for blocks of size 2^( 3) =       0.000405264877
  error estimate for blocks of size 2^( 4) =       0.000411759124
  error estimate for blocks of size 2^( 5) =       0.000415940188
  error estimate for blocks of size 2^( 6) =       0.000419473104
  error estimate for blocks of size 2^( 7) =       0.000422280275

      target function =                  N/A
              le_mean =     -17.216686505191
             les_mean =     296.724042106021
             stat err =       0.000417363172
             autocorr =       1.168334492458
              std dev =       0.546066486423
             le_variance =       0.298188607594

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298183854378
                                         uncertainty =       0.002044184546

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298183854378
                                         uncertainty =       0.002044184546

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386127316
  error estimate for blocks of size 2^( 2) =       0.000395990193
  error estimate for blocks of size 2^( 3) =       0.000405264877
  error estimate for blocks of size 2^( 4) =       0.000411759124
  error estimate for blocks of size 2^( 5) =       0.000415940188
  error estimate for blocks of size 2^( 6) =       0.000419473104
  error estimate for blocks of size 2^( 7) =       0.000422280275

      target function =                  N/A
              le_mean =     -17.216686505191
             les_mean =     296.724042106021
             stat err =       0.000417363172
             autocorr =       1.168334492458
              std dev =       0.546066486423
             le_variance =       0.298188607594

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298183854378
                                         uncertainty =       0.002044184546

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298183854378
                                         uncertainty =       0.002044184546

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386127316
  error estimate for blocks of size 2^( 2) =       0.000395990193
  error estimate for blocks of size 2^( 3) =       0.000405264877
  error estimate for blocks of size 2^( 4) =       0.000411759124
  error estimate for blocks of size 2^( 5) =       0.000415940188
  error estimate for blocks of size 2^( 6) =       0.000419473104
  error estimate for blocks of size 2^( 7) =       0.000422280275

      target function =                  N/A
              le_mean =     -17.216686505191
             les_mean =     296.724042106021
             stat err =       0.000417363172
             autocorr =       1.168334492458
              std dev =       0.546066486423
             le_variance =       0.298188607594

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298183854378
                                         uncertainty =       0.002044184546

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298183854378
                                         uncertainty =       0.002044184546

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386127316
  error estimate for blocks of size 2^( 2) =       0.000395990193
  error estimate for blocks of size 2^( 3) =       0.000405264877
  error estimate for blocks of size 2^( 4) =       0.000411759124
  error estimate for blocks of size 2^( 5) =       0.000415940188
  error estimate for blocks of size 2^( 6) =       0.000419473104
  error estimate for blocks of size 2^( 7) =       0.000422280275

      target function =                  N/A
              le_mean =     -17.216686505191
             les_mean =     296.724042106021
             stat err =       0.000417363172
             autocorr =       1.168334492458
              std dev =       0.546066486423
             le_variance =       0.298188607594


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216686505191        initial  <--
     5.8208e+34     5.8208e+35             6.3915e-39       -17.216686505191
     2.3283e+35     2.3283e+36             1.5979e-39       -17.216686505191
     9.3132e+35     9.3132e+36             3.9947e-40       -17.216686505191

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 54.0610
  </log>
  <optVariables href="H2O.s061.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0263e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s062 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s062 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=62  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7222e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 62
    time step          = 0.05
    reference energy   = -17.1245
    reference variance = 0.228227
====================================================
  Execution time = 3.7700e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s062
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5278e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1202e-01
  Total weights = 1.956391197e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0864e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299223757093
                                         uncertainty =       0.002161802902

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299223757093
                                         uncertainty =       0.002161802902

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386809772
  error estimate for blocks of size 2^( 2) =       0.000396129601
  error estimate for blocks of size 2^( 3) =       0.000404824364
  error estimate for blocks of size 2^( 4) =       0.000411649840
  error estimate for blocks of size 2^( 5) =       0.000415147057
  error estimate for blocks of size 2^( 6) =       0.000417413091
  error estimate for blocks of size 2^( 7) =       0.000419080265

      target function =                  N/A
              le_mean =     -17.217242977130
             les_mean =     296.745476342815
             stat err =       0.000415822564
             autocorr =       1.155636440667
              std dev =       0.547031626115
             le_variance =       0.299243599969


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721724297713e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+35, overlap shift 5.8208e+36 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217242977172       residual = 9.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217242977172       residual = 1.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217242977172       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217242977172       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217243194580       residual = 3.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.8208e+35 is 7.608580e-40

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+36, overlap shift 2.3283e+37 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217242977172       residual = 9.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217242977172       residual = 1.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217242977172       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217242977172       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217242956161       residual = 9.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+36 is 1.902145e-40

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+36, overlap shift 9.3132e+37 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217242977172       residual = 9.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217242977172       residual = 1.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217242977172       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217242977172       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217254638672       residual = 1.39e-02           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+36 is 4.755362e-41

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.950130 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8575e+01
  </log>
  <optVariables href="H2O.s062.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 62
    time step          = 0.05
    reference energy   = -17.1664
    reference variance = 0.246232
====================================================
  Execution time = 3.7343e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s062
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2276e-01
  Total weights = 1.9565e+06
  Execution time = 3.3682e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298963559196
                                         uncertainty =       0.001530687585

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298963559196
                                         uncertainty =       0.001530687585

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386579218
  error estimate for blocks of size 2^( 2) =       0.000396330404
  error estimate for blocks of size 2^( 3) =       0.000405415828
  error estimate for blocks of size 2^( 4) =       0.000411594571
  error estimate for blocks of size 2^( 5) =       0.000415974430
  error estimate for blocks of size 2^( 6) =       0.000418469493
  error estimate for blocks of size 2^( 7) =       0.000421848861

      target function =                  N/A
              le_mean =     -17.216137106343
             les_mean =     296.718141344811
             stat err =       0.000416971838
             autocorr =       1.163419780600
              std dev =       0.546705572463
             le_variance =       0.298886982962

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298963559196
                                         uncertainty =       0.001530687585

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298963559196
                                         uncertainty =       0.001530687585

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386579218
  error estimate for blocks of size 2^( 2) =       0.000396330404
  error estimate for blocks of size 2^( 3) =       0.000405415828
  error estimate for blocks of size 2^( 4) =       0.000411594571
  error estimate for blocks of size 2^( 5) =       0.000415974430
  error estimate for blocks of size 2^( 6) =       0.000418469493
  error estimate for blocks of size 2^( 7) =       0.000421848861

      target function =                  N/A
              le_mean =     -17.216137106343
             les_mean =     296.718141344811
             stat err =       0.000416971838
             autocorr =       1.163419780600
              std dev =       0.546705572463
             le_variance =       0.298886982962

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298963559196
                                         uncertainty =       0.001530687585

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298963559196
                                         uncertainty =       0.001530687585

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386579218
  error estimate for blocks of size 2^( 2) =       0.000396330404
  error estimate for blocks of size 2^( 3) =       0.000405415828
  error estimate for blocks of size 2^( 4) =       0.000411594571
  error estimate for blocks of size 2^( 5) =       0.000415974430
  error estimate for blocks of size 2^( 6) =       0.000418469493
  error estimate for blocks of size 2^( 7) =       0.000421848861

      target function =                  N/A
              le_mean =     -17.216137106343
             les_mean =     296.718141344811
             stat err =       0.000416971838
             autocorr =       1.163419780600
              std dev =       0.546705572463
             le_variance =       0.298886982962

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298963559196
                                         uncertainty =       0.001530687585

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298963559196
                                         uncertainty =       0.001530687585

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386579218
  error estimate for blocks of size 2^( 2) =       0.000396330404
  error estimate for blocks of size 2^( 3) =       0.000405415828
  error estimate for blocks of size 2^( 4) =       0.000411594571
  error estimate for blocks of size 2^( 5) =       0.000415974430
  error estimate for blocks of size 2^( 6) =       0.000418469493
  error estimate for blocks of size 2^( 7) =       0.000421848861

      target function =                  N/A
              le_mean =     -17.216137106343
             les_mean =     296.718141344811
             stat err =       0.000416971838
             autocorr =       1.163419780600
              std dev =       0.546705572463
             le_variance =       0.298886982962


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216137106343        initial  <--
     5.8208e+35     5.8208e+36             7.6086e-40       -17.216137106343
     2.3283e+36     2.3283e+37             1.9021e-40       -17.216137106343
     9.3132e+36     9.3132e+37             4.7554e-41       -17.216137106343

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 54.3141
  </log>
  <optVariables href="H2O.s062.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0290e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s063 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s063 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=63  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 63
    time step          = 0.05
    reference energy   = -17.1634
    reference variance = 0.115181
====================================================
  Execution time = 3.7836e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s063
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5278e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1401e-01
  Total weights = 1.956796829e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0974e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300542184521
                                         uncertainty =       0.003451435995

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300542184521
                                         uncertainty =       0.003451435995

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387736493
  error estimate for blocks of size 2^( 2) =       0.000397387479
  error estimate for blocks of size 2^( 3) =       0.000406284108
  error estimate for blocks of size 2^( 4) =       0.000412715695
  error estimate for blocks of size 2^( 5) =       0.000417789826
  error estimate for blocks of size 2^( 6) =       0.000418534631
  error estimate for blocks of size 2^( 7) =       0.000419835284

      target function =                  N/A
              le_mean =     -17.216615885108
             les_mean =     296.725873013261
             stat err =       0.000417218859
             autocorr =       1.157855881176
              std dev =       0.548342207267
             le_variance =       0.300679176271


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721661588511e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+36, overlap shift 5.8208e+37 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216615885190       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216615885190       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.8208e+36 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+37, overlap shift 2.3283e+38 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216615885190       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216615885190       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+37 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+37, overlap shift 9.3132e+38 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216615885190       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216615885190       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+37 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.951375 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8819e+01
  </log>
  <optVariables href="H2O.s063.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 63
    time step          = 0.05
    reference energy   = -17.2765
    reference variance = 0.575923
====================================================
  Execution time = 3.7479e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s063
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1247e-01
  Total weights = 1.9564e+06
  Execution time = 3.3523e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297827362847
                                         uncertainty =       0.001782482591

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297827362847
                                         uncertainty =       0.001782482591

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385847812
  error estimate for blocks of size 2^( 2) =       0.000395948883
  error estimate for blocks of size 2^( 3) =       0.000404965638
  error estimate for blocks of size 2^( 4) =       0.000412001816
  error estimate for blocks of size 2^( 5) =       0.000416038107
  error estimate for blocks of size 2^( 6) =       0.000416161352
  error estimate for blocks of size 2^( 7) =       0.000417322110

      target function =                  N/A
              le_mean =     -17.216558155892
             les_mean =     296.722342441531
             stat err =       0.000415380846
             autocorr =       1.158939723925
              std dev =       0.545671208931
             le_variance =       0.297757068256

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297827362847
                                         uncertainty =       0.001782482591

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297827362847
                                         uncertainty =       0.001782482591

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385847812
  error estimate for blocks of size 2^( 2) =       0.000395948883
  error estimate for blocks of size 2^( 3) =       0.000404965638
  error estimate for blocks of size 2^( 4) =       0.000412001816
  error estimate for blocks of size 2^( 5) =       0.000416038107
  error estimate for blocks of size 2^( 6) =       0.000416161352
  error estimate for blocks of size 2^( 7) =       0.000417322110

      target function =                  N/A
              le_mean =     -17.216558155892
             les_mean =     296.722342441531
             stat err =       0.000415380846
             autocorr =       1.158939723925
              std dev =       0.545671208931
             le_variance =       0.297757068256

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297827362847
                                         uncertainty =       0.001782482591

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297827362847
                                         uncertainty =       0.001782482591

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385847812
  error estimate for blocks of size 2^( 2) =       0.000395948883
  error estimate for blocks of size 2^( 3) =       0.000404965638
  error estimate for blocks of size 2^( 4) =       0.000412001816
  error estimate for blocks of size 2^( 5) =       0.000416038107
  error estimate for blocks of size 2^( 6) =       0.000416161352
  error estimate for blocks of size 2^( 7) =       0.000417322110

      target function =                  N/A
              le_mean =     -17.216558155892
             les_mean =     296.722342441531
             stat err =       0.000415380846
             autocorr =       1.158939723925
              std dev =       0.545671208931
             le_variance =       0.297757068256

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297827362847
                                         uncertainty =       0.001782482591

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297827362847
                                         uncertainty =       0.001782482591

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385847812
  error estimate for blocks of size 2^( 2) =       0.000395948883
  error estimate for blocks of size 2^( 3) =       0.000404965638
  error estimate for blocks of size 2^( 4) =       0.000412001816
  error estimate for blocks of size 2^( 5) =       0.000416038107
  error estimate for blocks of size 2^( 6) =       0.000416161352
  error estimate for blocks of size 2^( 7) =       0.000417322110

      target function =                  N/A
              le_mean =     -17.216558155892
             les_mean =     296.722342441531
             stat err =       0.000415380846
             autocorr =       1.158939723925
              std dev =       0.545671208931
             le_variance =       0.297757068256


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216558155892        initial  <--
     5.8208e+36     5.8208e+37             0.0000e+00       -17.216558155892
     2.3283e+37     2.3283e+38             0.0000e+00       -17.216558155892
     9.3132e+37     9.3132e+38             0.0000e+00       -17.216558155892

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 54.4448
  </log>
  <optVariables href="H2O.s063.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0327e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s064 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s064 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=64  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 64
    time step          = 0.05
    reference energy   = -17.2309
    reference variance = 0.324137
====================================================
  Execution time = 3.7504e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s064
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5241e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1625e-01
  Total weights = 1.956799518e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0996e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299111295721
                                         uncertainty =       0.002144119437

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299111295721
                                         uncertainty =       0.002144119437

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386737029
  error estimate for blocks of size 2^( 2) =       0.000396964611
  error estimate for blocks of size 2^( 3) =       0.000406268519
  error estimate for blocks of size 2^( 4) =       0.000412948125
  error estimate for blocks of size 2^( 5) =       0.000416742051
  error estimate for blocks of size 2^( 6) =       0.000417691659
  error estimate for blocks of size 2^( 7) =       0.000418850682

      target function =                  N/A
              le_mean =     -17.216971000537
             les_mean =     296.740341088712
             stat err =       0.000416558129
             autocorr =       1.160164882248
              std dev =       0.546928751448
             le_variance =       0.299131059160


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721697100054e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+37, overlap shift 5.8208e+38 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216971000584       residual = 2.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216971000584       residual = 2.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.8208e+37 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+38, overlap shift 2.3283e+39 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216971000584       residual = 2.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216971000584       residual = 2.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+38 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+38, overlap shift 9.3132e+39 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216971000584       residual = 2.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216971000584       residual = 2.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+38 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.952587 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8510e+01
  </log>
  <optVariables href="H2O.s064.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 64
    time step          = 0.05
    reference energy   = -17.1759
    reference variance = 0.296085
====================================================
  Execution time = 3.7038e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s064
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1045e-01
  Total weights = 1.9564e+06
  Execution time = 3.3592e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298688547375
                                         uncertainty =       0.002407297261

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298688547375
                                         uncertainty =       0.002407297261

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386459098
  error estimate for blocks of size 2^( 2) =       0.000396316219
  error estimate for blocks of size 2^( 3) =       0.000405463518
  error estimate for blocks of size 2^( 4) =       0.000412055664
  error estimate for blocks of size 2^( 5) =       0.000415947023
  error estimate for blocks of size 2^( 6) =       0.000419112069
  error estimate for blocks of size 2^( 7) =       0.000418995233

      target function =                  N/A
              le_mean =     -17.216697602138
             les_mean =     296.725125763027
             stat err =       0.000416527497
             autocorr =       1.161663338004
              std dev =       0.546535697022
             le_variance =       0.298701268119

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298688547375
                                         uncertainty =       0.002407297261

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298688547375
                                         uncertainty =       0.002407297261

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386459098
  error estimate for blocks of size 2^( 2) =       0.000396316219
  error estimate for blocks of size 2^( 3) =       0.000405463518
  error estimate for blocks of size 2^( 4) =       0.000412055664
  error estimate for blocks of size 2^( 5) =       0.000415947023
  error estimate for blocks of size 2^( 6) =       0.000419112069
  error estimate for blocks of size 2^( 7) =       0.000418995233

      target function =                  N/A
              le_mean =     -17.216697602138
             les_mean =     296.725125763027
             stat err =       0.000416527497
             autocorr =       1.161663338004
              std dev =       0.546535697022
             le_variance =       0.298701268119

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298688547375
                                         uncertainty =       0.002407297261

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298688547375
                                         uncertainty =       0.002407297261

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386459098
  error estimate for blocks of size 2^( 2) =       0.000396316219
  error estimate for blocks of size 2^( 3) =       0.000405463518
  error estimate for blocks of size 2^( 4) =       0.000412055664
  error estimate for blocks of size 2^( 5) =       0.000415947023
  error estimate for blocks of size 2^( 6) =       0.000419112069
  error estimate for blocks of size 2^( 7) =       0.000418995233

      target function =                  N/A
              le_mean =     -17.216697602138
             les_mean =     296.725125763027
             stat err =       0.000416527497
             autocorr =       1.161663338004
              std dev =       0.546535697022
             le_variance =       0.298701268119

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298688547375
                                         uncertainty =       0.002407297261

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298688547375
                                         uncertainty =       0.002407297261

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386459098
  error estimate for blocks of size 2^( 2) =       0.000396316219
  error estimate for blocks of size 2^( 3) =       0.000405463518
  error estimate for blocks of size 2^( 4) =       0.000412055664
  error estimate for blocks of size 2^( 5) =       0.000415947023
  error estimate for blocks of size 2^( 6) =       0.000419112069
  error estimate for blocks of size 2^( 7) =       0.000418995233

      target function =                  N/A
              le_mean =     -17.216697602138
             les_mean =     296.725125763027
             stat err =       0.000416527497
             autocorr =       1.161663338004
              std dev =       0.546535697022
             le_variance =       0.298701268119


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216697602138        initial  <--
     5.8208e+37     5.8208e+38             0.0000e+00       -17.216697602138
     2.3283e+38     2.3283e+39             0.0000e+00       -17.216697602138
     9.3132e+38     9.3132e+39             0.0000e+00       -17.216697602138

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 54.0378
  </log>
  <optVariables href="H2O.s064.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0255e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s065 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s065 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=65  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 65
    time step          = 0.05
    reference energy   = -17.1635
    reference variance = 0.458689
====================================================
  Execution time = 3.7501e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s065
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5291e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1428e-01
  Total weights = 1.956670516e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1141e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300238013171
                                         uncertainty =       0.001789574488

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300238013171
                                         uncertainty =       0.001789574488

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387434414
  error estimate for blocks of size 2^( 2) =       0.000397422569
  error estimate for blocks of size 2^( 3) =       0.000406743113
  error estimate for blocks of size 2^( 4) =       0.000413408643
  error estimate for blocks of size 2^( 5) =       0.000417281543
  error estimate for blocks of size 2^( 6) =       0.000422162369
  error estimate for blocks of size 2^( 7) =       0.000424335029

      target function =                  N/A
              le_mean =     -17.217000401980
             les_mean =     296.739383988597
             stat err =       0.000419296896
             autocorr =       1.171242722904
              std dev =       0.547915003031
             le_variance =       0.300210850547


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721700040198e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+38, overlap shift 5.8208e+39 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217000402007       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217000402007       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.8208e+38 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+39, overlap shift 2.3283e+40 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217000402007       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217000402007       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+39 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+39, overlap shift 9.3132e+40 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217000402007       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217000402007       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+39 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.953783 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8652e+01
  </log>
  <optVariables href="H2O.s065.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 65
    time step          = 0.05
    reference energy   = -17.2648
    reference variance = 0.231971
====================================================
  Execution time = 3.6989e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s065
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.1145e-01
  Total weights = 1.9568e+06
  Execution time = 3.3579e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297071094238
                                         uncertainty =       0.001982621659

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297071094238
                                         uncertainty =       0.001982621659

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385380992
  error estimate for blocks of size 2^( 2) =       0.000395067166
  error estimate for blocks of size 2^( 3) =       0.000403951668
  error estimate for blocks of size 2^( 4) =       0.000411317486
  error estimate for blocks of size 2^( 5) =       0.000415169781
  error estimate for blocks of size 2^( 6) =       0.000418620591
  error estimate for blocks of size 2^( 7) =       0.000420834929

      target function =                  N/A
              le_mean =     -17.215411170563
             les_mean =     296.681827086071
             stat err =       0.000416485697
             autocorr =       1.167937495090
              std dev =       0.545011025983
             le_variance =       0.297037018443

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297071094238
                                         uncertainty =       0.001982621659

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297071094238
                                         uncertainty =       0.001982621659

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385380992
  error estimate for blocks of size 2^( 2) =       0.000395067166
  error estimate for blocks of size 2^( 3) =       0.000403951668
  error estimate for blocks of size 2^( 4) =       0.000411317486
  error estimate for blocks of size 2^( 5) =       0.000415169781
  error estimate for blocks of size 2^( 6) =       0.000418620591
  error estimate for blocks of size 2^( 7) =       0.000420834929

      target function =                  N/A
              le_mean =     -17.215411170563
             les_mean =     296.681827086071
             stat err =       0.000416485697
             autocorr =       1.167937495090
              std dev =       0.545011025983
             le_variance =       0.297037018443

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297071094238
                                         uncertainty =       0.001982621659

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297071094238
                                         uncertainty =       0.001982621659

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385380992
  error estimate for blocks of size 2^( 2) =       0.000395067166
  error estimate for blocks of size 2^( 3) =       0.000403951668
  error estimate for blocks of size 2^( 4) =       0.000411317486
  error estimate for blocks of size 2^( 5) =       0.000415169781
  error estimate for blocks of size 2^( 6) =       0.000418620591
  error estimate for blocks of size 2^( 7) =       0.000420834929

      target function =                  N/A
              le_mean =     -17.215411170563
             les_mean =     296.681827086071
             stat err =       0.000416485697
             autocorr =       1.167937495090
              std dev =       0.545011025983
             le_variance =       0.297037018443

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297071094238
                                         uncertainty =       0.001982621659

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297071094238
                                         uncertainty =       0.001982621659

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385380992
  error estimate for blocks of size 2^( 2) =       0.000395067166
  error estimate for blocks of size 2^( 3) =       0.000403951668
  error estimate for blocks of size 2^( 4) =       0.000411317486
  error estimate for blocks of size 2^( 5) =       0.000415169781
  error estimate for blocks of size 2^( 6) =       0.000418620591
  error estimate for blocks of size 2^( 7) =       0.000420834929

      target function =                  N/A
              le_mean =     -17.215411170563
             les_mean =     296.681827086071
             stat err =       0.000416485697
             autocorr =       1.167937495090
              std dev =       0.545011025983
             le_variance =       0.297037018443


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215411170563        initial  <--
     5.8208e+38     5.8208e+39             0.0000e+00       -17.215411170563
     2.3283e+39     2.3283e+40             0.0000e+00       -17.215411170563
     9.3132e+39     9.3132e+40             0.0000e+00       -17.215411170563

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.9671
  </log>
  <optVariables href="H2O.s065.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0263e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s066 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s066 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=66  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 66
    time step          = 0.05
    reference energy   = -17.2298
    reference variance = 0.169929
====================================================
  Execution time = 3.7802e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s066
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5293e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1227e-01
  Total weights = 1.956418420e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1116e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297765289522
                                         uncertainty =       0.001642466478

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297765289522
                                         uncertainty =       0.001642466478

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385799399
  error estimate for blocks of size 2^( 2) =       0.000395819766
  error estimate for blocks of size 2^( 3) =       0.000404847848
  error estimate for blocks of size 2^( 4) =       0.000411918711
  error estimate for blocks of size 2^( 5) =       0.000416793941
  error estimate for blocks of size 2^( 6) =       0.000418485016
  error estimate for blocks of size 2^( 7) =       0.000418386433

      target function =                  N/A
              le_mean =     -17.216169148589
             les_mean =     296.708752604291
             stat err =       0.000416396025
             autocorr =       1.164903789335
              std dev =       0.545602741904
             le_variance =       0.297682351974


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721616914859e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+39, overlap shift 5.8208e+40 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216169148622       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216169148622       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.8208e+39 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+40, overlap shift 2.3283e+41 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216169148622       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216169148622       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+40 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+40, overlap shift 9.3132e+41 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216169148622       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216169148622       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+40 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.954974 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8928e+01
  </log>
  <optVariables href="H2O.s066.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 66
    time step          = 0.05
    reference energy   = -17.2258
    reference variance = 0.197859
====================================================
  Execution time = 3.6906e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s066
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1674e-01
  Total weights = 1.9566e+06
  Execution time = 3.3648e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301819921086
                                         uncertainty =       0.002359165786

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301819921086
                                         uncertainty =       0.002359165786

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388495652
  error estimate for blocks of size 2^( 2) =       0.000398467417
  error estimate for blocks of size 2^( 3) =       0.000407621133
  error estimate for blocks of size 2^( 4) =       0.000414091907
  error estimate for blocks of size 2^( 5) =       0.000418177314
  error estimate for blocks of size 2^( 6) =       0.000421287698
  error estimate for blocks of size 2^( 7) =       0.000422832458

      target function =                  N/A
              le_mean =     -17.216860533758
             les_mean =     296.737026100272
             stat err =       0.000419097344
             autocorr =       1.163744099147
              std dev =       0.549415820415
             le_variance =       0.301857743723

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301819921086
                                         uncertainty =       0.002359165786

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301819921086
                                         uncertainty =       0.002359165786

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388495652
  error estimate for blocks of size 2^( 2) =       0.000398467417
  error estimate for blocks of size 2^( 3) =       0.000407621133
  error estimate for blocks of size 2^( 4) =       0.000414091907
  error estimate for blocks of size 2^( 5) =       0.000418177314
  error estimate for blocks of size 2^( 6) =       0.000421287698
  error estimate for blocks of size 2^( 7) =       0.000422832458

      target function =                  N/A
              le_mean =     -17.216860533758
             les_mean =     296.737026100272
             stat err =       0.000419097344
             autocorr =       1.163744099147
              std dev =       0.549415820415
             le_variance =       0.301857743723

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301819921086
                                         uncertainty =       0.002359165786

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301819921086
                                         uncertainty =       0.002359165786

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388495652
  error estimate for blocks of size 2^( 2) =       0.000398467417
  error estimate for blocks of size 2^( 3) =       0.000407621133
  error estimate for blocks of size 2^( 4) =       0.000414091907
  error estimate for blocks of size 2^( 5) =       0.000418177314
  error estimate for blocks of size 2^( 6) =       0.000421287698
  error estimate for blocks of size 2^( 7) =       0.000422832458

      target function =                  N/A
              le_mean =     -17.216860533758
             les_mean =     296.737026100272
             stat err =       0.000419097344
             autocorr =       1.163744099147
              std dev =       0.549415820415
             le_variance =       0.301857743723

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301819921086
                                         uncertainty =       0.002359165786

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301819921086
                                         uncertainty =       0.002359165786

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388495652
  error estimate for blocks of size 2^( 2) =       0.000398467417
  error estimate for blocks of size 2^( 3) =       0.000407621133
  error estimate for blocks of size 2^( 4) =       0.000414091907
  error estimate for blocks of size 2^( 5) =       0.000418177314
  error estimate for blocks of size 2^( 6) =       0.000421287698
  error estimate for blocks of size 2^( 7) =       0.000422832458

      target function =                  N/A
              le_mean =     -17.216860533758
             les_mean =     296.737026100272
             stat err =       0.000419097344
             autocorr =       1.163744099147
              std dev =       0.549415820415
             le_variance =       0.301857743723


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216860533758        initial  <--
     5.8208e+39     5.8208e+40             0.0000e+00       -17.216860533758
     2.3283e+40     2.3283e+41             0.0000e+00       -17.216860533758
     9.3132e+40     9.3132e+41             0.0000e+00       -17.216860533758

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.9629
  </log>
  <optVariables href="H2O.s066.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0290e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s067 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s067 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=67  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 67
    time step          = 0.05
    reference energy   = -17.2275
    reference variance = 0.29191
====================================================
  Execution time = 3.7427e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s067
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5271e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1330e-01
  Total weights = 1.956357593e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0984e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298984094066
                                         uncertainty =       0.002202306462

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298984094066
                                         uncertainty =       0.002202306462

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386642948
  error estimate for blocks of size 2^( 2) =       0.000396623258
  error estimate for blocks of size 2^( 3) =       0.000406015475
  error estimate for blocks of size 2^( 4) =       0.000413008018
  error estimate for blocks of size 2^( 5) =       0.000417016573
  error estimate for blocks of size 2^( 6) =       0.000418556602
  error estimate for blocks of size 2^( 7) =       0.000422043309

      target function =                  N/A
              le_mean =     -17.216325819117
             les_mean =     296.715174328480
             stat err =       0.000417656125
             autocorr =       1.166856697889
              std dev =       0.546795700956
             le_variance =       0.298985538584


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721632581912e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+40, overlap shift 5.8208e+41 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216325819165       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216325819165       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.8208e+40 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+41, overlap shift 2.3283e+42 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216325819165       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216325819165       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216325819165       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+41 is 1.742108e-45

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+41, overlap shift 9.3132e+42 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216325819165       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216325819165       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216325819165       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+41 is 4.355270e-46

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.956388 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8420e+01
  </log>
  <optVariables href="H2O.s067.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 67
    time step          = 0.05
    reference energy   = -17.1766
    reference variance = 0.1928
====================================================
  Execution time = 3.7067e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s067
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1242e-01
  Total weights = 1.9567e+06
  Execution time = 3.3486e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297490991277
                                         uncertainty =       0.002019195082

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297490991277
                                         uncertainty =       0.002019195082

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385659761
  error estimate for blocks of size 2^( 2) =       0.000395774625
  error estimate for blocks of size 2^( 3) =       0.000405120209
  error estimate for blocks of size 2^( 4) =       0.000411235736
  error estimate for blocks of size 2^( 5) =       0.000416298092
  error estimate for blocks of size 2^( 6) =       0.000418299435
  error estimate for blocks of size 2^( 7) =       0.000419388265

      target function =                  N/A
              le_mean =     -17.216326473989
             les_mean =     296.714312512892
             stat err =       0.000416305382
             autocorr =       1.165240029206
              std dev =       0.545405264559
             le_variance =       0.297466902609

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297490991277
                                         uncertainty =       0.002019195082

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297490991277
                                         uncertainty =       0.002019195082

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385659761
  error estimate for blocks of size 2^( 2) =       0.000395774625
  error estimate for blocks of size 2^( 3) =       0.000405120209
  error estimate for blocks of size 2^( 4) =       0.000411235736
  error estimate for blocks of size 2^( 5) =       0.000416298092
  error estimate for blocks of size 2^( 6) =       0.000418299435
  error estimate for blocks of size 2^( 7) =       0.000419388265

      target function =                  N/A
              le_mean =     -17.216326473989
             les_mean =     296.714312512892
             stat err =       0.000416305382
             autocorr =       1.165240029206
              std dev =       0.545405264559
             le_variance =       0.297466902609

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297490991277
                                         uncertainty =       0.002019195082

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297490991277
                                         uncertainty =       0.002019195082

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385659761
  error estimate for blocks of size 2^( 2) =       0.000395774625
  error estimate for blocks of size 2^( 3) =       0.000405120209
  error estimate for blocks of size 2^( 4) =       0.000411235736
  error estimate for blocks of size 2^( 5) =       0.000416298092
  error estimate for blocks of size 2^( 6) =       0.000418299435
  error estimate for blocks of size 2^( 7) =       0.000419388265

      target function =                  N/A
              le_mean =     -17.216326473989
             les_mean =     296.714312512892
             stat err =       0.000416305382
             autocorr =       1.165240029206
              std dev =       0.545405264559
             le_variance =       0.297466902609

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297490991277
                                         uncertainty =       0.002019195082

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297490991277
                                         uncertainty =       0.002019195082

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385659761
  error estimate for blocks of size 2^( 2) =       0.000395774625
  error estimate for blocks of size 2^( 3) =       0.000405120209
  error estimate for blocks of size 2^( 4) =       0.000411235736
  error estimate for blocks of size 2^( 5) =       0.000416298092
  error estimate for blocks of size 2^( 6) =       0.000418299435
  error estimate for blocks of size 2^( 7) =       0.000419388265

      target function =                  N/A
              le_mean =     -17.216326473989
             les_mean =     296.714312512892
             stat err =       0.000416305382
             autocorr =       1.165240029206
              std dev =       0.545405264559
             le_variance =       0.297466902609


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216326473989        initial  <--
     5.8208e+40     5.8208e+41             0.0000e+00       -17.216326473989
     2.3283e+41     2.3283e+42             1.7421e-45       -17.216326473989
     9.3132e+41     9.3132e+42             4.3553e-46       -17.216326473989

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.9927
  </log>
  <optVariables href="H2O.s067.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0242e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s068 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s068 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=68  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 68
    time step          = 0.05
    reference energy   = -17.2049
    reference variance = 0.238562
====================================================
  Execution time = 3.8035e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s068
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5281e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1218e-01
  Total weights = 1.956525727e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0949e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296726324784
                                         uncertainty =       0.001850998406

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296726324784
                                         uncertainty =       0.001850998406

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385161029
  error estimate for blocks of size 2^( 2) =       0.000395166606
  error estimate for blocks of size 2^( 3) =       0.000404327832
  error estimate for blocks of size 2^( 4) =       0.000410200908
  error estimate for blocks of size 2^( 5) =       0.000414216231
  error estimate for blocks of size 2^( 6) =       0.000417759252
  error estimate for blocks of size 2^( 7) =       0.000417751716

      target function =                  N/A
              le_mean =     -17.216339431686
             les_mean =     296.714519460574
             stat err =       0.000414982027
             autocorr =       1.160844100183
              std dev =       0.544699950961
             le_variance =       0.296698036577


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721633943169e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+41, overlap shift 5.8208e+42 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216339431716       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216339431716       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.8208e+41 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+42, overlap shift 2.3283e+43 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216339431716       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216339431716       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+42 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+42, overlap shift 9.3132e+43 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216339431716       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216339431716       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+42 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.957592 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8994e+01
  </log>
  <optVariables href="H2O.s068.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 68
    time step          = 0.05
    reference energy   = -17.1815
    reference variance = 0.463575
====================================================
  Execution time = 3.7206e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s068
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0702e-01
  Total weights = 1.9568e+06
  Execution time = 3.3469e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295942975475
                                         uncertainty =       0.001756282305

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295942975475
                                         uncertainty =       0.001756282305

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384696290
  error estimate for blocks of size 2^( 2) =       0.000394873408
  error estimate for blocks of size 2^( 3) =       0.000403997427
  error estimate for blocks of size 2^( 4) =       0.000410892312
  error estimate for blocks of size 2^( 5) =       0.000416707520
  error estimate for blocks of size 2^( 6) =       0.000418116747
  error estimate for blocks of size 2^( 7) =       0.000419183307

      target function =                  N/A
              le_mean =     -17.215755262432
             les_mean =     296.689247854169
             stat err =       0.000416224972
             autocorr =       1.170631670738
              std dev =       0.544042710194
             le_variance =       0.295982470515

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295942975475
                                         uncertainty =       0.001756282305

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295942975475
                                         uncertainty =       0.001756282305

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384696290
  error estimate for blocks of size 2^( 2) =       0.000394873408
  error estimate for blocks of size 2^( 3) =       0.000403997427
  error estimate for blocks of size 2^( 4) =       0.000410892312
  error estimate for blocks of size 2^( 5) =       0.000416707520
  error estimate for blocks of size 2^( 6) =       0.000418116747
  error estimate for blocks of size 2^( 7) =       0.000419183307

      target function =                  N/A
              le_mean =     -17.215755262432
             les_mean =     296.689247854169
             stat err =       0.000416224972
             autocorr =       1.170631670738
              std dev =       0.544042710194
             le_variance =       0.295982470515

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295942975475
                                         uncertainty =       0.001756282305

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295942975475
                                         uncertainty =       0.001756282305

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384696290
  error estimate for blocks of size 2^( 2) =       0.000394873408
  error estimate for blocks of size 2^( 3) =       0.000403997427
  error estimate for blocks of size 2^( 4) =       0.000410892312
  error estimate for blocks of size 2^( 5) =       0.000416707520
  error estimate for blocks of size 2^( 6) =       0.000418116747
  error estimate for blocks of size 2^( 7) =       0.000419183307

      target function =                  N/A
              le_mean =     -17.215755262432
             les_mean =     296.689247854169
             stat err =       0.000416224972
             autocorr =       1.170631670738
              std dev =       0.544042710194
             le_variance =       0.295982470515

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295942975475
                                         uncertainty =       0.001756282305

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295942975475
                                         uncertainty =       0.001756282305

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384696290
  error estimate for blocks of size 2^( 2) =       0.000394873408
  error estimate for blocks of size 2^( 3) =       0.000403997427
  error estimate for blocks of size 2^( 4) =       0.000410892312
  error estimate for blocks of size 2^( 5) =       0.000416707520
  error estimate for blocks of size 2^( 6) =       0.000418116747
  error estimate for blocks of size 2^( 7) =       0.000419183307

      target function =                  N/A
              le_mean =     -17.215755262432
             les_mean =     296.689247854169
             stat err =       0.000416224972
             autocorr =       1.170631670738
              std dev =       0.544042710194
             le_variance =       0.295982470515


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215755262432        initial  <--
     5.8208e+41     5.8208e+42             0.0000e+00       -17.215755262432
     2.3283e+42     2.3283e+43             0.0000e+00       -17.215755262432
     9.3132e+42     9.3132e+43             0.0000e+00       -17.215755262432

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 54.1658
  </log>
  <optVariables href="H2O.s068.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0317e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s069 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s069 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=69  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 69
    time step          = 0.05
    reference energy   = -17.2613
    reference variance = 0.383501
====================================================
  Execution time = 3.7740e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s069
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5274e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1357e-01
  Total weights = 1.957062508e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1171e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298474440573
                                         uncertainty =       0.002241642945

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298474440573
                                         uncertainty =       0.002241642945

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386309970
  error estimate for blocks of size 2^( 2) =       0.000396407044
  error estimate for blocks of size 2^( 3) =       0.000404974241
  error estimate for blocks of size 2^( 4) =       0.000412105324
  error estimate for blocks of size 2^( 5) =       0.000415996187
  error estimate for blocks of size 2^( 6) =       0.000418879894
  error estimate for blocks of size 2^( 7) =       0.000419875481

      target function =                  N/A
              le_mean =     -17.216424283848
             les_mean =     296.718833694500
             stat err =       0.000416714222
             autocorr =       1.163602940526
              std dev =       0.546324799513
             le_variance =       0.298470786563


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721642428385e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+42, overlap shift 5.8208e+43 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216424283878       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216424283878       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.8208e+42 is 0.000000e+00

solving harmonic davidson linear method for identity shift 2.3283e+43, overlap shift 2.3283e+44 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216424283878       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216424283878       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+43 is 0.000000e+00

solving harmonic davidson linear method for identity shift 9.3132e+43, overlap shift 9.3132e+44 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216424283878       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216424283878       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+43 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.958772 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8920e+01
  </log>
  <optVariables href="H2O.s069.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 69
    time step          = 0.05
    reference energy   = -17.2173
    reference variance = 0.231788
====================================================
  Execution time = 3.6963e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s069
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1193e-01
  Total weights = 1.9567e+06
  Execution time = 3.3530e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297974500745
                                         uncertainty =       0.001918259717

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297974500745
                                         uncertainty =       0.001918259717

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385960513
  error estimate for blocks of size 2^( 2) =       0.000396136187
  error estimate for blocks of size 2^( 3) =       0.000405057116
  error estimate for blocks of size 2^( 4) =       0.000411196555
  error estimate for blocks of size 2^( 5) =       0.000415832729
  error estimate for blocks of size 2^( 6) =       0.000417909145
  error estimate for blocks of size 2^( 7) =       0.000421393874

      target function =                  N/A
              le_mean =     -17.216384175373
             les_mean =     296.715813822145
             stat err =       0.000416583076
             autocorr =       1.164977384667
              std dev =       0.545830591825
             le_variance =       0.297931034972

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297974500745
                                         uncertainty =       0.001918259717

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297974500745
                                         uncertainty =       0.001918259717

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385960513
  error estimate for blocks of size 2^( 2) =       0.000396136187
  error estimate for blocks of size 2^( 3) =       0.000405057116
  error estimate for blocks of size 2^( 4) =       0.000411196555
  error estimate for blocks of size 2^( 5) =       0.000415832729
  error estimate for blocks of size 2^( 6) =       0.000417909145
  error estimate for blocks of size 2^( 7) =       0.000421393874

      target function =                  N/A
              le_mean =     -17.216384175373
             les_mean =     296.715813822145
             stat err =       0.000416583076
             autocorr =       1.164977384667
              std dev =       0.545830591825
             le_variance =       0.297931034972

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297974500745
                                         uncertainty =       0.001918259717

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297974500745
                                         uncertainty =       0.001918259717

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385960513
  error estimate for blocks of size 2^( 2) =       0.000396136187
  error estimate for blocks of size 2^( 3) =       0.000405057116
  error estimate for blocks of size 2^( 4) =       0.000411196555
  error estimate for blocks of size 2^( 5) =       0.000415832729
  error estimate for blocks of size 2^( 6) =       0.000417909145
  error estimate for blocks of size 2^( 7) =       0.000421393874

      target function =                  N/A
              le_mean =     -17.216384175373
             les_mean =     296.715813822145
             stat err =       0.000416583076
             autocorr =       1.164977384667
              std dev =       0.545830591825
             le_variance =       0.297931034972

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297974500745
                                         uncertainty =       0.001918259717

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297974500745
                                         uncertainty =       0.001918259717

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385960513
  error estimate for blocks of size 2^( 2) =       0.000396136187
  error estimate for blocks of size 2^( 3) =       0.000405057116
  error estimate for blocks of size 2^( 4) =       0.000411196555
  error estimate for blocks of size 2^( 5) =       0.000415832729
  error estimate for blocks of size 2^( 6) =       0.000417909145
  error estimate for blocks of size 2^( 7) =       0.000421393874

      target function =                  N/A
              le_mean =     -17.216384175373
             les_mean =     296.715813822145
             stat err =       0.000416583076
             autocorr =       1.164977384667
              std dev =       0.545830591825
             le_variance =       0.297931034972


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216384175373        initial  <--
     5.8208e+42     5.8208e+43             0.0000e+00       -17.216384175373
     2.3283e+43     2.3283e+44             0.0000e+00       -17.216384175373
     9.3132e+43     9.3132e+44             0.0000e+00       -17.216384175373

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.9051
  </log>
  <optVariables href="H2O.s069.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0283e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s070 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s070 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=70  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 70
    time step          = 0.05
    reference energy   = -17.3159
    reference variance = 0.234818
====================================================
  Execution time = 3.7578e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s070
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5249e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1036e-01
  Total weights = 1.956266968e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1067e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296830298186
                                         uncertainty =       0.001962345668

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296830298186
                                         uncertainty =       0.001962345668

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385210778
  error estimate for blocks of size 2^( 2) =       0.000395217084
  error estimate for blocks of size 2^( 3) =       0.000404687442
  error estimate for blocks of size 2^( 4) =       0.000411358242
  error estimate for blocks of size 2^( 5) =       0.000415935534
  error estimate for blocks of size 2^( 6) =       0.000418144850
  error estimate for blocks of size 2^( 7) =       0.000418549494

      target function =                  N/A
              le_mean =     -17.216040280480
             les_mean =     296.702398286237
             stat err =       0.000415997030
             autocorr =       1.166228364448
              std dev =       0.544770306951
             le_variance =       0.296774687335


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721604028048e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+43, overlap shift 5.8208e+44 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216040280512       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216040280512       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.8208e+43 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+44, overlap shift 2.3283e+45 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216040280512       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216040280512       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+44 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+44, overlap shift 9.3132e+45 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216040280512       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216040280512       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+44 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.959973 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8655e+01
  </log>
  <optVariables href="H2O.s070.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 70
    time step          = 0.05
    reference energy   = -17.2132
    reference variance = 0.419985
====================================================
  Execution time = 3.7117e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s070
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.0571e-01
  Total weights = 1.9568e+06
  Execution time = 3.3483e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292633511640
                                         uncertainty =       0.001869266276

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292633511640
                                         uncertainty =       0.001869266276

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382502867
  error estimate for blocks of size 2^( 2) =       0.000392559398
  error estimate for blocks of size 2^( 3) =       0.000401940383
  error estimate for blocks of size 2^( 4) =       0.000408665616
  error estimate for blocks of size 2^( 5) =       0.000413266486
  error estimate for blocks of size 2^( 6) =       0.000415665811
  error estimate for blocks of size 2^( 7) =       0.000417324244

      target function =                  N/A
              le_mean =     -17.217257053679
             les_mean =     296.739648844201
             stat err =       0.000413730539
             autocorr =       1.169945871206
              std dev =       0.540940742300
             le_variance =       0.292616886680

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292633511640
                                         uncertainty =       0.001869266276

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292633511640
                                         uncertainty =       0.001869266276

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382502867
  error estimate for blocks of size 2^( 2) =       0.000392559398
  error estimate for blocks of size 2^( 3) =       0.000401940383
  error estimate for blocks of size 2^( 4) =       0.000408665616
  error estimate for blocks of size 2^( 5) =       0.000413266486
  error estimate for blocks of size 2^( 6) =       0.000415665811
  error estimate for blocks of size 2^( 7) =       0.000417324244

      target function =                  N/A
              le_mean =     -17.217257053679
             les_mean =     296.739648844201
             stat err =       0.000413730539
             autocorr =       1.169945871206
              std dev =       0.540940742300
             le_variance =       0.292616886680

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292633511640
                                         uncertainty =       0.001869266276

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292633511640
                                         uncertainty =       0.001869266276

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382502867
  error estimate for blocks of size 2^( 2) =       0.000392559398
  error estimate for blocks of size 2^( 3) =       0.000401940383
  error estimate for blocks of size 2^( 4) =       0.000408665616
  error estimate for blocks of size 2^( 5) =       0.000413266486
  error estimate for blocks of size 2^( 6) =       0.000415665811
  error estimate for blocks of size 2^( 7) =       0.000417324244

      target function =                  N/A
              le_mean =     -17.217257053679
             les_mean =     296.739648844201
             stat err =       0.000413730539
             autocorr =       1.169945871206
              std dev =       0.540940742300
             le_variance =       0.292616886680

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292633511640
                                         uncertainty =       0.001869266276

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292633511640
                                         uncertainty =       0.001869266276

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382502867
  error estimate for blocks of size 2^( 2) =       0.000392559398
  error estimate for blocks of size 2^( 3) =       0.000401940383
  error estimate for blocks of size 2^( 4) =       0.000408665616
  error estimate for blocks of size 2^( 5) =       0.000413266486
  error estimate for blocks of size 2^( 6) =       0.000415665811
  error estimate for blocks of size 2^( 7) =       0.000417324244

      target function =                  N/A
              le_mean =     -17.217257053679
             les_mean =     296.739648844201
             stat err =       0.000413730539
             autocorr =       1.169945871206
              std dev =       0.540940742300
             le_variance =       0.292616886680


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217257053679        initial  <--
     5.8208e+43     5.8208e+44             0.0000e+00       -17.217257053679
     2.3283e+44     2.3283e+45             0.0000e+00       -17.217257053679
     9.3132e+44     9.3132e+45             0.0000e+00       -17.217257053679

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 54.0743
  </log>
  <optVariables href="H2O.s070.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0274e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s071 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s071 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=71  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 71
    time step          = 0.05
    reference energy   = -17.2486
    reference variance = 0.223855
====================================================
  Execution time = 3.7549e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s071
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5289e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1950e-01
  Total weights = 1.956513625e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1044e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303326158167
                                         uncertainty =       0.002439141507

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303326158167
                                         uncertainty =       0.002439141507

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389409528
  error estimate for blocks of size 2^( 2) =       0.000399372994
  error estimate for blocks of size 2^( 3) =       0.000408595006
  error estimate for blocks of size 2^( 4) =       0.000415501868
  error estimate for blocks of size 2^( 5) =       0.000419058953
  error estimate for blocks of size 2^( 6) =       0.000421715225
  error estimate for blocks of size 2^( 7) =       0.000424682128

      target function =                  N/A
              le_mean =     -17.216315216766
             les_mean =     296.721005006414
             stat err =       0.000420239544
             autocorr =       1.164610456265
              std dev =       0.550708235810
             le_variance =       0.303279560989


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721631521677e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+44, overlap shift 5.8208e+45 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216315216781       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216315216781       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.8208e+44 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+45, overlap shift 2.3283e+46 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216315216781       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216315216781       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+45 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+45, overlap shift 9.3132e+46 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216315216781       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216315216781       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+45 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.961178 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8603e+01
  </log>
  <optVariables href="H2O.s071.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 71
    time step          = 0.05
    reference energy   = -17.1743
    reference variance = 0.233981
====================================================
  Execution time = 3.7634e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s071
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1497e-01
  Total weights = 1.9565e+06
  Execution time = 3.3573e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301299550621
                                         uncertainty =       0.002695012309

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301299550621
                                         uncertainty =       0.002695012309

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388164954
  error estimate for blocks of size 2^( 2) =       0.000398351044
  error estimate for blocks of size 2^( 3) =       0.000407541421
  error estimate for blocks of size 2^( 4) =       0.000414236215
  error estimate for blocks of size 2^( 5) =       0.000418631441
  error estimate for blocks of size 2^( 6) =       0.000422529524
  error estimate for blocks of size 2^( 7) =       0.000425013878

      target function =                  N/A
              le_mean =     -17.216257356230
             les_mean =     296.714491132379
             stat err =       0.000420102765
             autocorr =       1.171327755822
              std dev =       0.548948142700
             le_variance =       0.301344063374

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301299550621
                                         uncertainty =       0.002695012309

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301299550621
                                         uncertainty =       0.002695012309

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388164954
  error estimate for blocks of size 2^( 2) =       0.000398351044
  error estimate for blocks of size 2^( 3) =       0.000407541421
  error estimate for blocks of size 2^( 4) =       0.000414236215
  error estimate for blocks of size 2^( 5) =       0.000418631441
  error estimate for blocks of size 2^( 6) =       0.000422529524
  error estimate for blocks of size 2^( 7) =       0.000425013878

      target function =                  N/A
              le_mean =     -17.216257356230
             les_mean =     296.714491132379
             stat err =       0.000420102765
             autocorr =       1.171327755822
              std dev =       0.548948142700
             le_variance =       0.301344063374

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301299550621
                                         uncertainty =       0.002695012309

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301299550621
                                         uncertainty =       0.002695012309

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388164954
  error estimate for blocks of size 2^( 2) =       0.000398351044
  error estimate for blocks of size 2^( 3) =       0.000407541421
  error estimate for blocks of size 2^( 4) =       0.000414236215
  error estimate for blocks of size 2^( 5) =       0.000418631441
  error estimate for blocks of size 2^( 6) =       0.000422529524
  error estimate for blocks of size 2^( 7) =       0.000425013878

      target function =                  N/A
              le_mean =     -17.216257356230
             les_mean =     296.714491132379
             stat err =       0.000420102765
             autocorr =       1.171327755822
              std dev =       0.548948142700
             le_variance =       0.301344063374

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301299550621
                                         uncertainty =       0.002695012309

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301299550621
                                         uncertainty =       0.002695012309

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388164954
  error estimate for blocks of size 2^( 2) =       0.000398351044
  error estimate for blocks of size 2^( 3) =       0.000407541421
  error estimate for blocks of size 2^( 4) =       0.000414236215
  error estimate for blocks of size 2^( 5) =       0.000418631441
  error estimate for blocks of size 2^( 6) =       0.000422529524
  error estimate for blocks of size 2^( 7) =       0.000425013878

      target function =                  N/A
              le_mean =     -17.216257356230
             les_mean =     296.714491132379
             stat err =       0.000420102765
             autocorr =       1.171327755822
              std dev =       0.548948142700
             le_variance =       0.301344063374


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216257356230        initial  <--
     5.8208e+44     5.8208e+45             0.0000e+00       -17.216257356230
     2.3283e+45     2.3283e+46             0.0000e+00       -17.216257356230
     9.3132e+45     9.3132e+46             0.0000e+00       -17.216257356230

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 56.2566
  </log>
  <optVariables href="H2O.s071.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0487e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s072 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s072 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=72  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 72
    time step          = 0.05
    reference energy   = -17.1914
    reference variance = 0.219799
====================================================
  Execution time = 3.7988e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s072
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5267e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0910e-01
  Total weights = 1.956781321e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0984e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297029124666
                                         uncertainty =       0.001915259842

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297029124666
                                         uncertainty =       0.001915259842

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385358445
  error estimate for blocks of size 2^( 2) =       0.000395314450
  error estimate for blocks of size 2^( 3) =       0.000404597189
  error estimate for blocks of size 2^( 4) =       0.000411386452
  error estimate for blocks of size 2^( 5) =       0.000415288409
  error estimate for blocks of size 2^( 6) =       0.000416636749
  error estimate for blocks of size 2^( 7) =       0.000418687502

      target function =                  N/A
              le_mean =     -17.216364516656
             les_mean =     296.712309045554
             stat err =       0.000415499778
             autocorr =       1.162550507456
              std dev =       0.544979139560
             le_variance =       0.297002262555


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721636451666e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+45, overlap shift 5.8208e+46 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216364516705       residual = 1.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216364516705       residual = 1.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.8208e+45 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+46, overlap shift 2.3283e+47 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216364516705       residual = 1.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216364516705       residual = 1.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+46 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+46, overlap shift 9.3132e+47 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216364516705       residual = 1.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216364516705       residual = 1.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+46 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.963234 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8983e+01
  </log>
  <optVariables href="H2O.s072.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 72
    time step          = 0.05
    reference energy   = -17.1506
    reference variance = 0.387959
====================================================
  Execution time = 3.7117e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s072
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1619e-01
  Total weights = 1.9565e+06
  Execution time = 3.3447e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302273563618
                                         uncertainty =       0.002947843383

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302273563618
                                         uncertainty =       0.002947843383

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388832117
  error estimate for blocks of size 2^( 2) =       0.000398811490
  error estimate for blocks of size 2^( 3) =       0.000408161361
  error estimate for blocks of size 2^( 4) =       0.000414365441
  error estimate for blocks of size 2^( 5) =       0.000418464250
  error estimate for blocks of size 2^( 6) =       0.000420014030
  error estimate for blocks of size 2^( 7) =       0.000421563990

      target function =                  N/A
              le_mean =     -17.216150705307
             les_mean =     296.712034069259
             stat err =       0.000418601928
             autocorr =       1.158985994067
              std dev =       0.549891653751
             le_variance =       0.302380830865

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302273563618
                                         uncertainty =       0.002947843383

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302273563618
                                         uncertainty =       0.002947843383

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388832117
  error estimate for blocks of size 2^( 2) =       0.000398811490
  error estimate for blocks of size 2^( 3) =       0.000408161361
  error estimate for blocks of size 2^( 4) =       0.000414365441
  error estimate for blocks of size 2^( 5) =       0.000418464250
  error estimate for blocks of size 2^( 6) =       0.000420014030
  error estimate for blocks of size 2^( 7) =       0.000421563990

      target function =                  N/A
              le_mean =     -17.216150705307
             les_mean =     296.712034069259
             stat err =       0.000418601928
             autocorr =       1.158985994067
              std dev =       0.549891653751
             le_variance =       0.302380830865

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302273563618
                                         uncertainty =       0.002947843383

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302273563618
                                         uncertainty =       0.002947843383

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388832117
  error estimate for blocks of size 2^( 2) =       0.000398811490
  error estimate for blocks of size 2^( 3) =       0.000408161361
  error estimate for blocks of size 2^( 4) =       0.000414365441
  error estimate for blocks of size 2^( 5) =       0.000418464250
  error estimate for blocks of size 2^( 6) =       0.000420014030
  error estimate for blocks of size 2^( 7) =       0.000421563990

      target function =                  N/A
              le_mean =     -17.216150705307
             les_mean =     296.712034069259
             stat err =       0.000418601928
             autocorr =       1.158985994067
              std dev =       0.549891653751
             le_variance =       0.302380830865

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302273563618
                                         uncertainty =       0.002947843383

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302273563618
                                         uncertainty =       0.002947843383

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388832117
  error estimate for blocks of size 2^( 2) =       0.000398811490
  error estimate for blocks of size 2^( 3) =       0.000408161361
  error estimate for blocks of size 2^( 4) =       0.000414365441
  error estimate for blocks of size 2^( 5) =       0.000418464250
  error estimate for blocks of size 2^( 6) =       0.000420014030
  error estimate for blocks of size 2^( 7) =       0.000421563990

      target function =                  N/A
              le_mean =     -17.216150705307
             les_mean =     296.712034069259
             stat err =       0.000418601928
             autocorr =       1.158985994067
              std dev =       0.549891653751
             le_variance =       0.302380830865


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216150705307        initial  <--
     5.8208e+45     5.8208e+46             0.0000e+00       -17.216150705307
     2.3283e+46     2.3283e+47             0.0000e+00       -17.216150705307
     9.3132e+46     9.3132e+47             0.0000e+00       -17.216150705307

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 54.0532
  </log>
  <optVariables href="H2O.s072.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0304e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s073 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s073 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=73  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 73
    time step          = 0.05
    reference energy   = -17.1732
    reference variance = 0.233667
====================================================
  Execution time = 3.7744e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s073
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5281e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1539e-01
  Total weights = 1.956453313e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1074e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299159891400
                                         uncertainty =       0.001793051264

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299159891400
                                         uncertainty =       0.001793051264

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386765882
  error estimate for blocks of size 2^( 2) =       0.000396812628
  error estimate for blocks of size 2^( 3) =       0.000405652589
  error estimate for blocks of size 2^( 4) =       0.000412474468
  error estimate for blocks of size 2^( 5) =       0.000417147587
  error estimate for blocks of size 2^( 6) =       0.000419951453
  error estimate for blocks of size 2^( 7) =       0.000420227549

      target function =                  N/A
              le_mean =     -17.216599742543
             les_mean =     296.726695896869
             stat err =       0.000417450264
             autocorr =       1.164965775894
              std dev =       0.546969556354
             le_variance =       0.299175695578


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721659974254e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+46, overlap shift 5.8208e+47 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216599742602       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216599742602       residual = 8.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.8208e+46 is 8.031416e-51

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+47, overlap shift 2.3283e+48 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216599742602       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216599742602       residual = 8.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+47 is 2.007854e-51

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+47, overlap shift 9.3132e+48 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216599742602       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216599742602       residual = 8.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+47 is 5.019635e-52

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.964424 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8828e+01
  </log>
  <optVariables href="H2O.s073.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 73
    time step          = 0.05
    reference energy   = -17.2532
    reference variance = 0.228342
====================================================
  Execution time = 3.7159e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s073
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1160e-01
  Total weights = 1.9566e+06
  Execution time = 3.3663e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298252708801
                                         uncertainty =       0.001980259575

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298252708801
                                         uncertainty =       0.001980259575

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386211187
  error estimate for blocks of size 2^( 2) =       0.000396159531
  error estimate for blocks of size 2^( 3) =       0.000405322800
  error estimate for blocks of size 2^( 4) =       0.000411440437
  error estimate for blocks of size 2^( 5) =       0.000416036674
  error estimate for blocks of size 2^( 6) =       0.000419277571
  error estimate for blocks of size 2^( 7) =       0.000420175731

      target function =                  N/A
              le_mean =     -17.216168046171
             les_mean =     296.708044509812
             stat err =       0.000416732603
             autocorr =       1.164300971654
              std dev =       0.546185098386
             le_variance =       0.298318161699

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298252708801
                                         uncertainty =       0.001980259575

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298252708801
                                         uncertainty =       0.001980259575

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386211187
  error estimate for blocks of size 2^( 2) =       0.000396159531
  error estimate for blocks of size 2^( 3) =       0.000405322800
  error estimate for blocks of size 2^( 4) =       0.000411440437
  error estimate for blocks of size 2^( 5) =       0.000416036674
  error estimate for blocks of size 2^( 6) =       0.000419277571
  error estimate for blocks of size 2^( 7) =       0.000420175731

      target function =                  N/A
              le_mean =     -17.216168046171
             les_mean =     296.708044509812
             stat err =       0.000416732603
             autocorr =       1.164300971654
              std dev =       0.546185098386
             le_variance =       0.298318161699

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298252708801
                                         uncertainty =       0.001980259575

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298252708801
                                         uncertainty =       0.001980259575

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386211187
  error estimate for blocks of size 2^( 2) =       0.000396159531
  error estimate for blocks of size 2^( 3) =       0.000405322800
  error estimate for blocks of size 2^( 4) =       0.000411440437
  error estimate for blocks of size 2^( 5) =       0.000416036674
  error estimate for blocks of size 2^( 6) =       0.000419277571
  error estimate for blocks of size 2^( 7) =       0.000420175731

      target function =                  N/A
              le_mean =     -17.216168046171
             les_mean =     296.708044509812
             stat err =       0.000416732603
             autocorr =       1.164300971654
              std dev =       0.546185098386
             le_variance =       0.298318161699

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298252708801
                                         uncertainty =       0.001980259575

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298252708801
                                         uncertainty =       0.001980259575

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386211187
  error estimate for blocks of size 2^( 2) =       0.000396159531
  error estimate for blocks of size 2^( 3) =       0.000405322800
  error estimate for blocks of size 2^( 4) =       0.000411440437
  error estimate for blocks of size 2^( 5) =       0.000416036674
  error estimate for blocks of size 2^( 6) =       0.000419277571
  error estimate for blocks of size 2^( 7) =       0.000420175731

      target function =                  N/A
              le_mean =     -17.216168046171
             les_mean =     296.708044509812
             stat err =       0.000416732603
             autocorr =       1.164300971654
              std dev =       0.546185098386
             le_variance =       0.298318161699


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216168046171        initial  <--
     5.8208e+46     5.8208e+47             8.0314e-51       -17.216168046171
     2.3283e+47     2.3283e+48             2.0079e-51       -17.216168046171
     9.3132e+47     9.3132e+48             5.0196e-52       -17.216168046171

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 54.2067
  </log>
  <optVariables href="H2O.s073.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0304e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s074 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s074 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=74  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 74
    time step          = 0.05
    reference energy   = -17.2491
    reference variance = 0.154279
====================================================
  Execution time = 3.7745e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s074
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5286e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1264e-01
  Total weights = 1.956385049e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1152e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298349011478
                                         uncertainty =       0.002817631492

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298349011478
                                         uncertainty =       0.002817631492

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386158953
  error estimate for blocks of size 2^( 2) =       0.000396050869
  error estimate for blocks of size 2^( 3) =       0.000405576454
  error estimate for blocks of size 2^( 4) =       0.000411664300
  error estimate for blocks of size 2^( 5) =       0.000415989368
  error estimate for blocks of size 2^( 6) =       0.000418496972
  error estimate for blocks of size 2^( 7) =       0.000417022013

      target function =                  N/A
              le_mean =     -17.216197462413
             les_mean =     296.710092965984
             stat err =       0.000415793163
             autocorr =       1.159371104370
              std dev =       0.546111227981
             le_variance =       0.298237473326


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721619746241e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+47, overlap shift 5.8208e+48 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216197462457       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216197462457       residual = 2.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216197462457       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.000000000000       residual = 7.23e+00           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.8208e+47 is 5.491039e-52

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+48, overlap shift 2.3283e+49 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216197462457       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216197462457       residual = 2.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216197462457       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -18.000000000000       residual = 9.52e+01           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+48 is 1.372760e-52

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+48, overlap shift 9.3132e+49 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216197462457       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216197462457       residual = 2.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216197462457       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.000000000000       residual = 2.29e+02           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+48 is 3.431899e-53

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.966217 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8907e+01
  </log>
  <optVariables href="H2O.s074.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 74
    time step          = 0.05
    reference energy   = -17.1966
    reference variance = 0.212405
====================================================
  Execution time = 3.7792e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s074
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1112e-01
  Total weights = 1.9568e+06
  Execution time = 3.3848e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297974687294
                                         uncertainty =       0.001756288790

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297974687294
                                         uncertainty =       0.001756288790

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385950832
  error estimate for blocks of size 2^( 2) =       0.000396066282
  error estimate for blocks of size 2^( 3) =       0.000404661590
  error estimate for blocks of size 2^( 4) =       0.000411728930
  error estimate for blocks of size 2^( 5) =       0.000414572166
  error estimate for blocks of size 2^( 6) =       0.000417243759
  error estimate for blocks of size 2^( 7) =       0.000418685556

      target function =                  N/A
              le_mean =     -17.217138491486
             les_mean =     296.740975056705
             stat err =       0.000415557603
             autocorr =       1.159307112980
              std dev =       0.545816901546
             le_variance =       0.297916090013

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297974687294
                                         uncertainty =       0.001756288790

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297974687294
                                         uncertainty =       0.001756288790

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385950832
  error estimate for blocks of size 2^( 2) =       0.000396066282
  error estimate for blocks of size 2^( 3) =       0.000404661590
  error estimate for blocks of size 2^( 4) =       0.000411728930
  error estimate for blocks of size 2^( 5) =       0.000414572166
  error estimate for blocks of size 2^( 6) =       0.000417243759
  error estimate for blocks of size 2^( 7) =       0.000418685556

      target function =                  N/A
              le_mean =     -17.217138491486
             les_mean =     296.740975056705
             stat err =       0.000415557603
             autocorr =       1.159307112980
              std dev =       0.545816901546
             le_variance =       0.297916090013

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297974687294
                                         uncertainty =       0.001756288790

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297974687294
                                         uncertainty =       0.001756288790

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385950832
  error estimate for blocks of size 2^( 2) =       0.000396066282
  error estimate for blocks of size 2^( 3) =       0.000404661590
  error estimate for blocks of size 2^( 4) =       0.000411728930
  error estimate for blocks of size 2^( 5) =       0.000414572166
  error estimate for blocks of size 2^( 6) =       0.000417243759
  error estimate for blocks of size 2^( 7) =       0.000418685556

      target function =                  N/A
              le_mean =     -17.217138491486
             les_mean =     296.740975056705
             stat err =       0.000415557603
             autocorr =       1.159307112980
              std dev =       0.545816901546
             le_variance =       0.297916090013

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297974687294
                                         uncertainty =       0.001756288790

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297974687294
                                         uncertainty =       0.001756288790

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385950832
  error estimate for blocks of size 2^( 2) =       0.000396066282
  error estimate for blocks of size 2^( 3) =       0.000404661590
  error estimate for blocks of size 2^( 4) =       0.000411728930
  error estimate for blocks of size 2^( 5) =       0.000414572166
  error estimate for blocks of size 2^( 6) =       0.000417243759
  error estimate for blocks of size 2^( 7) =       0.000418685556

      target function =                  N/A
              le_mean =     -17.217138491486
             les_mean =     296.740975056705
             stat err =       0.000415557603
             autocorr =       1.159307112980
              std dev =       0.545816901546
             le_variance =       0.297916090013


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217138491486        initial  <--
     5.8208e+47     5.8208e+48             5.4910e-52       -17.217138491486
     2.3283e+48     2.3283e+49             1.3728e-52       -17.217138491486
     9.3132e+48     9.3132e+49             3.4319e-53       -17.217138491486

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 54.8547
  </log>
  <optVariables href="H2O.s074.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0377e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s075 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s075 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=75  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 75
    time step          = 0.05
    reference energy   = -17.2273
    reference variance = 0.200418
====================================================
  Execution time = 3.7507e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s075
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5308e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1624e-01
  Total weights = 1.956995690e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1013e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300682434298
                                         uncertainty =       0.002053413433

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300682434298
                                         uncertainty =       0.002053413433

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387832805
  error estimate for blocks of size 2^( 2) =       0.000397577746
  error estimate for blocks of size 2^( 3) =       0.000406303098
  error estimate for blocks of size 2^( 4) =       0.000413689748
  error estimate for blocks of size 2^( 5) =       0.000418244300
  error estimate for blocks of size 2^( 6) =       0.000421409977
  error estimate for blocks of size 2^( 7) =       0.000423968912

      target function =                  N/A
              le_mean =     -17.216349900631
             les_mean =     296.718940095021
             stat err =       0.000419328234
             autocorr =       1.169012427724
              std dev =       0.548478412925
             le_variance =       0.300828569445


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721634990063e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+48, overlap shift 5.8208e+49 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216349900677       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216349900677       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216349900677       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.8208e+48 is 8.416139e-53

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+49, overlap shift 2.3283e+50 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216349900677       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216349900677       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+49 is 2.104035e-53

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+49, overlap shift 9.3132e+50 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216349900677       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216349900677       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+49 is 5.260087e-54

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.967520 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8531e+01
  </log>
  <optVariables href="H2O.s075.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 75
    time step          = 0.05
    reference energy   = -17.2349
    reference variance = 0.168713
====================================================
  Execution time = 3.7592e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s075
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1142e-01
  Total weights = 1.9567e+06
  Execution time = 3.3491e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297911489204
                                         uncertainty =       0.001761885273

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297911489204
                                         uncertainty =       0.001761885273

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385929422
  error estimate for blocks of size 2^( 2) =       0.000396374764
  error estimate for blocks of size 2^( 3) =       0.000405578109
  error estimate for blocks of size 2^( 4) =       0.000412503056
  error estimate for blocks of size 2^( 5) =       0.000416166828
  error estimate for blocks of size 2^( 6) =       0.000417726684
  error estimate for blocks of size 2^( 7) =       0.000420455702

      target function =                  N/A
              le_mean =     -17.216343239095
             les_mean =     296.713897229533
             stat err =       0.000416713067
             autocorr =       1.165892370283
              std dev =       0.545786622965
             le_variance =       0.297883037808

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297911489204
                                         uncertainty =       0.001761885273

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297911489204
                                         uncertainty =       0.001761885273

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385929422
  error estimate for blocks of size 2^( 2) =       0.000396374764
  error estimate for blocks of size 2^( 3) =       0.000405578109
  error estimate for blocks of size 2^( 4) =       0.000412503056
  error estimate for blocks of size 2^( 5) =       0.000416166828
  error estimate for blocks of size 2^( 6) =       0.000417726684
  error estimate for blocks of size 2^( 7) =       0.000420455702

      target function =                  N/A
              le_mean =     -17.216343239095
             les_mean =     296.713897229533
             stat err =       0.000416713067
             autocorr =       1.165892370283
              std dev =       0.545786622965
             le_variance =       0.297883037808

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297911489204
                                         uncertainty =       0.001761885273

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297911489204
                                         uncertainty =       0.001761885273

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385929422
  error estimate for blocks of size 2^( 2) =       0.000396374764
  error estimate for blocks of size 2^( 3) =       0.000405578109
  error estimate for blocks of size 2^( 4) =       0.000412503056
  error estimate for blocks of size 2^( 5) =       0.000416166828
  error estimate for blocks of size 2^( 6) =       0.000417726684
  error estimate for blocks of size 2^( 7) =       0.000420455702

      target function =                  N/A
              le_mean =     -17.216343239095
             les_mean =     296.713897229533
             stat err =       0.000416713067
             autocorr =       1.165892370283
              std dev =       0.545786622965
             le_variance =       0.297883037808

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297911489204
                                         uncertainty =       0.001761885273

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297911489204
                                         uncertainty =       0.001761885273

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385929422
  error estimate for blocks of size 2^( 2) =       0.000396374764
  error estimate for blocks of size 2^( 3) =       0.000405578109
  error estimate for blocks of size 2^( 4) =       0.000412503056
  error estimate for blocks of size 2^( 5) =       0.000416166828
  error estimate for blocks of size 2^( 6) =       0.000417726684
  error estimate for blocks of size 2^( 7) =       0.000420455702

      target function =                  N/A
              le_mean =     -17.216343239095
             les_mean =     296.713897229533
             stat err =       0.000416713067
             autocorr =       1.165892370283
              std dev =       0.545786622965
             le_variance =       0.297883037808


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216343239095        initial  <--
     5.8208e+48     5.8208e+49             8.4161e-53       -17.216343239095
     2.3283e+49     2.3283e+50             2.1040e-53       -17.216343239095
     9.3132e+49     9.3132e+50             5.2601e-54       -17.216343239095

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 54.5314
  </log>
  <optVariables href="H2O.s075.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0307e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s076 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s076 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=76  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 76
    time step          = 0.05
    reference energy   = -17.2451
    reference variance = 0.337907
====================================================
  Execution time = 3.7647e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s076
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5308e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1085e-01
  Total weights = 1.956321329e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1114e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297039294114
                                         uncertainty =       0.001678124542

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297039294114
                                         uncertainty =       0.001678124542

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385331624
  error estimate for blocks of size 2^( 2) =       0.000395188715
  error estimate for blocks of size 2^( 3) =       0.000404671478
  error estimate for blocks of size 2^( 4) =       0.000411192504
  error estimate for blocks of size 2^( 5) =       0.000414829290
  error estimate for blocks of size 2^( 6) =       0.000417383039
  error estimate for blocks of size 2^( 7) =       0.000416725941

      target function =                  N/A
              le_mean =     -17.216353658505
             les_mean =     296.713684454977
             stat err =       0.000415032693
             autocorr =       1.160099691990
              std dev =       0.544941208865
             le_variance =       0.296960921119


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721635365851e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+49, overlap shift 5.8208e+50 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216353658557       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216353658557       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.8208e+49 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+50, overlap shift 2.3283e+51 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216353658557       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216353658557       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+50 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+50, overlap shift 9.3132e+51 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216353658557       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216353658557       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+50 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.968751 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8771e+01
  </log>
  <optVariables href="H2O.s076.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 76
    time step          = 0.05
    reference energy   = -17.2852
    reference variance = 0.277281
====================================================
  Execution time = 3.7697e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s076
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1774e-01
  Total weights = 1.9566e+06
  Execution time = 3.3531e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301300596630
                                         uncertainty =       0.002626440671

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301300596630
                                         uncertainty =       0.002626440671

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388097518
  error estimate for blocks of size 2^( 2) =       0.000397902690
  error estimate for blocks of size 2^( 3) =       0.000406983233
  error estimate for blocks of size 2^( 4) =       0.000413742094
  error estimate for blocks of size 2^( 5) =       0.000418595479
  error estimate for blocks of size 2^( 6) =       0.000420958968
  error estimate for blocks of size 2^( 7) =       0.000422748411

      target function =                  N/A
              le_mean =     -17.216065228565
             les_mean =     296.710639470110
             stat err =       0.000419011238
             autocorr =       1.165653874368
              std dev =       0.548852773433
             le_variance =       0.301239366905

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301300596630
                                         uncertainty =       0.002626440671

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301300596630
                                         uncertainty =       0.002626440671

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388097518
  error estimate for blocks of size 2^( 2) =       0.000397902690
  error estimate for blocks of size 2^( 3) =       0.000406983233
  error estimate for blocks of size 2^( 4) =       0.000413742094
  error estimate for blocks of size 2^( 5) =       0.000418595479
  error estimate for blocks of size 2^( 6) =       0.000420958968
  error estimate for blocks of size 2^( 7) =       0.000422748411

      target function =                  N/A
              le_mean =     -17.216065228565
             les_mean =     296.710639470110
             stat err =       0.000419011238
             autocorr =       1.165653874368
              std dev =       0.548852773433
             le_variance =       0.301239366905

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301300596630
                                         uncertainty =       0.002626440671

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301300596630
                                         uncertainty =       0.002626440671

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388097518
  error estimate for blocks of size 2^( 2) =       0.000397902690
  error estimate for blocks of size 2^( 3) =       0.000406983233
  error estimate for blocks of size 2^( 4) =       0.000413742094
  error estimate for blocks of size 2^( 5) =       0.000418595479
  error estimate for blocks of size 2^( 6) =       0.000420958968
  error estimate for blocks of size 2^( 7) =       0.000422748411

      target function =                  N/A
              le_mean =     -17.216065228565
             les_mean =     296.710639470110
             stat err =       0.000419011238
             autocorr =       1.165653874368
              std dev =       0.548852773433
             le_variance =       0.301239366905

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301300596630
                                         uncertainty =       0.002626440671

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301300596630
                                         uncertainty =       0.002626440671

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388097518
  error estimate for blocks of size 2^( 2) =       0.000397902690
  error estimate for blocks of size 2^( 3) =       0.000406983233
  error estimate for blocks of size 2^( 4) =       0.000413742094
  error estimate for blocks of size 2^( 5) =       0.000418595479
  error estimate for blocks of size 2^( 6) =       0.000420958968
  error estimate for blocks of size 2^( 7) =       0.000422748411

      target function =                  N/A
              le_mean =     -17.216065228565
             les_mean =     296.710639470110
             stat err =       0.000419011238
             autocorr =       1.165653874368
              std dev =       0.548852773433
             le_variance =       0.301239366905


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216065228565        initial  <--
     5.8208e+49     5.8208e+50             0.0000e+00       -17.216065228565
     2.3283e+50     2.3283e+51             0.0000e+00       -17.216065228565
     9.3132e+50     9.3132e+51             0.0000e+00       -17.216065228565

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 54.6779
  </log>
  <optVariables href="H2O.s076.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0345e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s077 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s077 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=77  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 77
    time step          = 0.05
    reference energy   = -17.1959
    reference variance = 0.282662
====================================================
  Execution time = 3.7337e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s077
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5280e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1327e-01
  Total weights = 1.956776194e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1154e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299709717549
                                         uncertainty =       0.001718815771

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299709717549
                                         uncertainty =       0.001718815771

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387113961
  error estimate for blocks of size 2^( 2) =       0.000396925726
  error estimate for blocks of size 2^( 3) =       0.000406363787
  error estimate for blocks of size 2^( 4) =       0.000413149458
  error estimate for blocks of size 2^( 5) =       0.000418396946
  error estimate for blocks of size 2^( 6) =       0.000421140934
  error estimate for blocks of size 2^( 7) =       0.000423117333

      target function =                  N/A
              le_mean =     -17.217166564154
             les_mean =     296.744097058428
             stat err =       0.000418951168
             autocorr =       1.171248753118
              std dev =       0.547461814304
             le_variance =       0.299714438121


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721716656415e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+50, overlap shift 5.8208e+51 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217166564221       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217166564221       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.8208e+50 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+51, overlap shift 2.3283e+52 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217166564221       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217166564221       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+51 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+51, overlap shift 9.3132e+52 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217166564221       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217166564221       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+51 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.969953 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8501e+01
  </log>
  <optVariables href="H2O.s077.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 77
    time step          = 0.05
    reference energy   = -17.189
    reference variance = 0.211556
====================================================
  Execution time = 3.7561e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s077
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1767e-01
  Total weights = 1.9568e+06
  Execution time = 3.3569e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300812263954
                                         uncertainty =       0.002629048115

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300812263954
                                         uncertainty =       0.002629048115

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387814084
  error estimate for blocks of size 2^( 2) =       0.000397717246
  error estimate for blocks of size 2^( 3) =       0.000407174407
  error estimate for blocks of size 2^( 4) =       0.000414149403
  error estimate for blocks of size 2^( 5) =       0.000417056651
  error estimate for blocks of size 2^( 6) =       0.000419011268
  error estimate for blocks of size 2^( 7) =       0.000420326969

      target function =                  N/A
              le_mean =     -17.216503508222
             les_mean =     296.725665536205
             stat err =       0.000417636073
             autocorr =       1.159708534474
              std dev =       0.548451936681
             le_variance =       0.300799526849

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300812263954
                                         uncertainty =       0.002629048115

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300812263954
                                         uncertainty =       0.002629048115

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387814084
  error estimate for blocks of size 2^( 2) =       0.000397717246
  error estimate for blocks of size 2^( 3) =       0.000407174407
  error estimate for blocks of size 2^( 4) =       0.000414149403
  error estimate for blocks of size 2^( 5) =       0.000417056651
  error estimate for blocks of size 2^( 6) =       0.000419011268
  error estimate for blocks of size 2^( 7) =       0.000420326969

      target function =                  N/A
              le_mean =     -17.216503508222
             les_mean =     296.725665536205
             stat err =       0.000417636073
             autocorr =       1.159708534474
              std dev =       0.548451936681
             le_variance =       0.300799526849

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300812263954
                                         uncertainty =       0.002629048115

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300812263954
                                         uncertainty =       0.002629048115

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387814084
  error estimate for blocks of size 2^( 2) =       0.000397717246
  error estimate for blocks of size 2^( 3) =       0.000407174407
  error estimate for blocks of size 2^( 4) =       0.000414149403
  error estimate for blocks of size 2^( 5) =       0.000417056651
  error estimate for blocks of size 2^( 6) =       0.000419011268
  error estimate for blocks of size 2^( 7) =       0.000420326969

      target function =                  N/A
              le_mean =     -17.216503508222
             les_mean =     296.725665536205
             stat err =       0.000417636073
             autocorr =       1.159708534474
              std dev =       0.548451936681
             le_variance =       0.300799526849

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300812263954
                                         uncertainty =       0.002629048115

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300812263954
                                         uncertainty =       0.002629048115

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387814084
  error estimate for blocks of size 2^( 2) =       0.000397717246
  error estimate for blocks of size 2^( 3) =       0.000407174407
  error estimate for blocks of size 2^( 4) =       0.000414149403
  error estimate for blocks of size 2^( 5) =       0.000417056651
  error estimate for blocks of size 2^( 6) =       0.000419011268
  error estimate for blocks of size 2^( 7) =       0.000420326969

      target function =                  N/A
              le_mean =     -17.216503508222
             les_mean =     296.725665536205
             stat err =       0.000417636073
             autocorr =       1.159708534474
              std dev =       0.548451936681
             le_variance =       0.300799526849


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216503508222        initial  <--
     5.8208e+50     5.8208e+51             0.0000e+00       -17.216503508222
     2.3283e+51     2.3283e+52             0.0000e+00       -17.216503508222
     9.3132e+51     9.3132e+52             0.0000e+00       -17.216503508222

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 54.5558
  </log>
  <optVariables href="H2O.s077.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0306e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s078 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s078 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=78  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 78
    time step          = 0.05
    reference energy   = -17.1756
    reference variance = 0.152379
====================================================
  Execution time = 3.7578e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s078
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5272e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1869e-01
  Total weights = 1.956608190e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1106e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298161972566
                                         uncertainty =       0.001914060796

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298161972566
                                         uncertainty =       0.001914060796

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386145465
  error estimate for blocks of size 2^( 2) =       0.000396136681
  error estimate for blocks of size 2^( 3) =       0.000405299617
  error estimate for blocks of size 2^( 4) =       0.000412607376
  error estimate for blocks of size 2^( 5) =       0.000416894888
  error estimate for blocks of size 2^( 6) =       0.000419067137
  error estimate for blocks of size 2^( 7) =       0.000418948685

      target function =                  N/A
              le_mean =     -17.216374778274
             les_mean =     296.722250889172
             stat err =       0.000416879522
             autocorr =       1.165518697458
              std dev =       0.546092154277
             le_variance =       0.298216640963


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721637477827e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+51, overlap shift 5.8208e+52 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216374778319       residual = 2.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216374778319       residual = 2.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.8208e+51 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+52, overlap shift 2.3283e+53 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216374778319       residual = 2.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216374778319       residual = 2.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+52 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+52, overlap shift 9.3132e+53 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216374778319       residual = 2.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216374778319       residual = 2.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+52 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.971189 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8695e+01
  </log>
  <optVariables href="H2O.s078.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 78
    time step          = 0.05
    reference energy   = -17.2169
    reference variance = 0.16739
====================================================
  Execution time = 3.7517e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s078
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1909e-01
  Total weights = 1.9569e+06
  Execution time = 3.3462e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300152389158
                                         uncertainty =       0.001953126301

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300152389158
                                         uncertainty =       0.001953126301

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387347760
  error estimate for blocks of size 2^( 2) =       0.000397514420
  error estimate for blocks of size 2^( 3) =       0.000406557639
  error estimate for blocks of size 2^( 4) =       0.000413015264
  error estimate for blocks of size 2^( 5) =       0.000417257485
  error estimate for blocks of size 2^( 6) =       0.000420798951
  error estimate for blocks of size 2^( 7) =       0.000421513239

      target function =                  N/A
              le_mean =     -17.216825636120
             les_mean =     296.738171218271
             stat err =       0.000418146235
             autocorr =       1.165344370177
              std dev =       0.547792455921
             le_variance =       0.300076574764

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300152389158
                                         uncertainty =       0.001953126301

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300152389158
                                         uncertainty =       0.001953126301

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387347760
  error estimate for blocks of size 2^( 2) =       0.000397514420
  error estimate for blocks of size 2^( 3) =       0.000406557639
  error estimate for blocks of size 2^( 4) =       0.000413015264
  error estimate for blocks of size 2^( 5) =       0.000417257485
  error estimate for blocks of size 2^( 6) =       0.000420798951
  error estimate for blocks of size 2^( 7) =       0.000421513239

      target function =                  N/A
              le_mean =     -17.216825636120
             les_mean =     296.738171218271
             stat err =       0.000418146235
             autocorr =       1.165344370177
              std dev =       0.547792455921
             le_variance =       0.300076574764

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300152389158
                                         uncertainty =       0.001953126301

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300152389158
                                         uncertainty =       0.001953126301

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387347760
  error estimate for blocks of size 2^( 2) =       0.000397514420
  error estimate for blocks of size 2^( 3) =       0.000406557639
  error estimate for blocks of size 2^( 4) =       0.000413015264
  error estimate for blocks of size 2^( 5) =       0.000417257485
  error estimate for blocks of size 2^( 6) =       0.000420798951
  error estimate for blocks of size 2^( 7) =       0.000421513239

      target function =                  N/A
              le_mean =     -17.216825636120
             les_mean =     296.738171218271
             stat err =       0.000418146235
             autocorr =       1.165344370177
              std dev =       0.547792455921
             le_variance =       0.300076574764

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300152389158
                                         uncertainty =       0.001953126301

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300152389158
                                         uncertainty =       0.001953126301

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387347760
  error estimate for blocks of size 2^( 2) =       0.000397514420
  error estimate for blocks of size 2^( 3) =       0.000406557639
  error estimate for blocks of size 2^( 4) =       0.000413015264
  error estimate for blocks of size 2^( 5) =       0.000417257485
  error estimate for blocks of size 2^( 6) =       0.000420798951
  error estimate for blocks of size 2^( 7) =       0.000421513239

      target function =                  N/A
              le_mean =     -17.216825636120
             les_mean =     296.738171218271
             stat err =       0.000418146235
             autocorr =       1.165344370177
              std dev =       0.547792455921
             le_variance =       0.300076574764


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216825636120        initial  <--
     5.8208e+51     5.8208e+52             0.0000e+00       -17.216825636120
     2.3283e+52     2.3283e+53             0.0000e+00       -17.216825636120
     9.3132e+52     9.3132e+53             0.0000e+00       -17.216825636120

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 54.4526
  </log>
  <optVariables href="H2O.s078.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0315e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s079 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s079 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=79  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 79
    time step          = 0.05
    reference energy   = -17.0906
    reference variance = 0.214508
====================================================
  Execution time = 3.7433e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s079
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5288e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1814e-01
  Total weights = 1.956740624e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0993e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302523863968
                                         uncertainty =       0.002047776935

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302523863968
                                         uncertainty =       0.002047776935

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388872130
  error estimate for blocks of size 2^( 2) =       0.000398887977
  error estimate for blocks of size 2^( 3) =       0.000407240605
  error estimate for blocks of size 2^( 4) =       0.000413602208
  error estimate for blocks of size 2^( 5) =       0.000417627455
  error estimate for blocks of size 2^( 6) =       0.000421682979
  error estimate for blocks of size 2^( 7) =       0.000423293546

      target function =                  N/A
              le_mean =     -17.216203222883
             les_mean =     296.715794706376
             stat err =       0.000419051547
             autocorr =       1.161238053849
              std dev =       0.549948239981
             le_variance =       0.302443066658


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721620322288e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+52, overlap shift 5.8208e+53 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216203222923       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216203222923       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.8208e+52 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+53, overlap shift 2.3283e+54 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216203222923       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216203222923       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+53 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+53, overlap shift 9.3132e+54 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216203222923       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216203222923       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+53 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.972399 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8436e+01
  </log>
  <optVariables href="H2O.s079.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 79
    time step          = 0.05
    reference energy   = -17.1918
    reference variance = 0.223607
====================================================
  Execution time = 3.7351e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s079
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.1782e-01
  Total weights = 1.9563e+06
  Execution time = 3.3530e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302145510235
                                         uncertainty =       0.002503887777

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302145510235
                                         uncertainty =       0.002503887777

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388704051
  error estimate for blocks of size 2^( 2) =       0.000398798869
  error estimate for blocks of size 2^( 3) =       0.000408118581
  error estimate for blocks of size 2^( 4) =       0.000414913177
  error estimate for blocks of size 2^( 5) =       0.000419331310
  error estimate for blocks of size 2^( 6) =       0.000421729231
  error estimate for blocks of size 2^( 7) =       0.000425772679

      target function =                  N/A
              le_mean =     -17.215266211157
             les_mean =     296.683207869945
             stat err =       0.000420436599
             autocorr =       1.169938130209
              std dev =       0.549710540282
             le_variance =       0.302181678097

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302145510235
                                         uncertainty =       0.002503887777

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302145510235
                                         uncertainty =       0.002503887777

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388704051
  error estimate for blocks of size 2^( 2) =       0.000398798869
  error estimate for blocks of size 2^( 3) =       0.000408118581
  error estimate for blocks of size 2^( 4) =       0.000414913177
  error estimate for blocks of size 2^( 5) =       0.000419331310
  error estimate for blocks of size 2^( 6) =       0.000421729231
  error estimate for blocks of size 2^( 7) =       0.000425772679

      target function =                  N/A
              le_mean =     -17.215266211157
             les_mean =     296.683207869945
             stat err =       0.000420436599
             autocorr =       1.169938130209
              std dev =       0.549710540282
             le_variance =       0.302181678097

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302145510235
                                         uncertainty =       0.002503887777

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302145510235
                                         uncertainty =       0.002503887777

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388704051
  error estimate for blocks of size 2^( 2) =       0.000398798869
  error estimate for blocks of size 2^( 3) =       0.000408118581
  error estimate for blocks of size 2^( 4) =       0.000414913177
  error estimate for blocks of size 2^( 5) =       0.000419331310
  error estimate for blocks of size 2^( 6) =       0.000421729231
  error estimate for blocks of size 2^( 7) =       0.000425772679

      target function =                  N/A
              le_mean =     -17.215266211157
             les_mean =     296.683207869945
             stat err =       0.000420436599
             autocorr =       1.169938130209
              std dev =       0.549710540282
             le_variance =       0.302181678097

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302145510235
                                         uncertainty =       0.002503887777

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302145510235
                                         uncertainty =       0.002503887777

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388704051
  error estimate for blocks of size 2^( 2) =       0.000398798869
  error estimate for blocks of size 2^( 3) =       0.000408118581
  error estimate for blocks of size 2^( 4) =       0.000414913177
  error estimate for blocks of size 2^( 5) =       0.000419331310
  error estimate for blocks of size 2^( 6) =       0.000421729231
  error estimate for blocks of size 2^( 7) =       0.000425772679

      target function =                  N/A
              le_mean =     -17.215266211157
             les_mean =     296.683207869945
             stat err =       0.000420436599
             autocorr =       1.169938130209
              std dev =       0.549710540282
             le_variance =       0.302181678097


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215266211157        initial  <--
     5.8208e+52     5.8208e+53             0.0000e+00       -17.215266211157
     2.3283e+53     2.3283e+54             0.0000e+00       -17.215266211157
     9.3132e+53     9.3132e+54             0.0000e+00       -17.215266211157

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 54.3003
  </log>
  <optVariables href="H2O.s079.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0274e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s080 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s080 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=80  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 80
    time step          = 0.05
    reference energy   = -17.1846
    reference variance = 0.153087
====================================================
  Execution time = 3.7470e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s080
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5306e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.0828e-01
  Total weights = 1.956746406e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1089e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295269992255
                                         uncertainty =       0.001772396597

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295269992255
                                         uncertainty =       0.001772396597

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384230386
  error estimate for blocks of size 2^( 2) =       0.000394202064
  error estimate for blocks of size 2^( 3) =       0.000402807343
  error estimate for blocks of size 2^( 4) =       0.000409355729
  error estimate for blocks of size 2^( 5) =       0.000414122009
  error estimate for blocks of size 2^( 6) =       0.000416564085
  error estimate for blocks of size 2^( 7) =       0.000417326517

      target function =                  N/A
              le_mean =     -17.216967095175
             les_mean =     296.732236257331
             stat err =       0.000414342085
             autocorr =       1.162879408888
              std dev =       0.543383822710
             le_variance =       0.295265978783


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721696709517e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+53, overlap shift 5.8208e+54 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216967095201       residual = 2.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216967095201       residual = 2.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.8208e+53 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+54, overlap shift 2.3283e+55 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216967095201       residual = 2.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216967095201       residual = 2.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+54 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+54, overlap shift 9.3132e+55 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216967095201       residual = 2.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216967095201       residual = 2.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+54 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.973620 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8569e+01
  </log>
  <optVariables href="H2O.s080.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 80
    time step          = 0.05
    reference energy   = -17.2544
    reference variance = 0.292074
====================================================
  Execution time = 3.7517e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s080
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1759e-01
  Total weights = 1.9569e+06
  Execution time = 3.3580e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302438402227
                                         uncertainty =       0.002942328174

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302438402227
                                         uncertainty =       0.002942328174

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388858355
  error estimate for blocks of size 2^( 2) =       0.000398778424
  error estimate for blocks of size 2^( 3) =       0.000407524269
  error estimate for blocks of size 2^( 4) =       0.000414031324
  error estimate for blocks of size 2^( 5) =       0.000417548634
  error estimate for blocks of size 2^( 6) =       0.000418685183
  error estimate for blocks of size 2^( 7) =       0.000420604626

      target function =                  N/A
              le_mean =     -17.216873068954
             les_mean =     296.738312315583
             stat err =       0.000417717442
             autocorr =       1.153937665638
              std dev =       0.549928760107
             le_variance =       0.302421641193

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302438402227
                                         uncertainty =       0.002942328174

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302438402227
                                         uncertainty =       0.002942328174

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388858355
  error estimate for blocks of size 2^( 2) =       0.000398778424
  error estimate for blocks of size 2^( 3) =       0.000407524269
  error estimate for blocks of size 2^( 4) =       0.000414031324
  error estimate for blocks of size 2^( 5) =       0.000417548634
  error estimate for blocks of size 2^( 6) =       0.000418685183
  error estimate for blocks of size 2^( 7) =       0.000420604626

      target function =                  N/A
              le_mean =     -17.216873068954
             les_mean =     296.738312315583
             stat err =       0.000417717442
             autocorr =       1.153937665638
              std dev =       0.549928760107
             le_variance =       0.302421641193

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302438402227
                                         uncertainty =       0.002942328174

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302438402227
                                         uncertainty =       0.002942328174

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388858355
  error estimate for blocks of size 2^( 2) =       0.000398778424
  error estimate for blocks of size 2^( 3) =       0.000407524269
  error estimate for blocks of size 2^( 4) =       0.000414031324
  error estimate for blocks of size 2^( 5) =       0.000417548634
  error estimate for blocks of size 2^( 6) =       0.000418685183
  error estimate for blocks of size 2^( 7) =       0.000420604626

      target function =                  N/A
              le_mean =     -17.216873068954
             les_mean =     296.738312315583
             stat err =       0.000417717442
             autocorr =       1.153937665638
              std dev =       0.549928760107
             le_variance =       0.302421641193

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302438402227
                                         uncertainty =       0.002942328174

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302438402227
                                         uncertainty =       0.002942328174

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388858355
  error estimate for blocks of size 2^( 2) =       0.000398778424
  error estimate for blocks of size 2^( 3) =       0.000407524269
  error estimate for blocks of size 2^( 4) =       0.000414031324
  error estimate for blocks of size 2^( 5) =       0.000417548634
  error estimate for blocks of size 2^( 6) =       0.000418685183
  error estimate for blocks of size 2^( 7) =       0.000420604626

      target function =                  N/A
              le_mean =     -17.216873068954
             les_mean =     296.738312315583
             stat err =       0.000417717442
             autocorr =       1.153937665638
              std dev =       0.549928760107
             le_variance =       0.302421641193


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216873068954        initial  <--
     5.8208e+53     5.8208e+54             0.0000e+00       -17.216873068954
     2.3283e+54     2.3283e+55             0.0000e+00       -17.216873068954
     9.3132e+54     9.3132e+55             0.0000e+00       -17.216873068954

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 54.4663
  </log>
  <optVariables href="H2O.s080.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0304e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s081 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s081 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=81  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 81
    time step          = 0.05
    reference energy   = -17.2735
    reference variance = 0.233651
====================================================
  Execution time = 3.7657e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s081
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5273e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1068e-01
  Total weights = 1.956597016e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1027e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297589273605
                                         uncertainty =       0.001912358333

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297589273605
                                         uncertainty =       0.001912358333

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385743060
  error estimate for blocks of size 2^( 2) =       0.000395842334
  error estimate for blocks of size 2^( 3) =       0.000405036748
  error estimate for blocks of size 2^( 4) =       0.000411423515
  error estimate for blocks of size 2^( 5) =       0.000415847341
  error estimate for blocks of size 2^( 6) =       0.000418635385
  error estimate for blocks of size 2^( 7) =       0.000417433492

      target function =                  N/A
              le_mean =     -17.216924923057
             les_mean =     296.733187420428
             stat err =       0.000415834933
             autocorr =       1.162105881401
              std dev =       0.545523066579
             le_variance =       0.297595416170


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721692492306e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+54, overlap shift 5.8208e+55 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216924923074       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216924923074       residual = 3.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216924923074       residual = 8.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.8208e+54 is 5.366135e-59

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+55, overlap shift 2.3283e+56 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216924923074       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216924923074       residual = 3.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216924923074       residual = 8.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+55 is 1.341534e-59

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+55, overlap shift 9.3132e+56 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216924923074       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216924923074       residual = 3.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216924923074       residual = 8.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+55 is 3.353834e-60

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.975098 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8694e+01
  </log>
  <optVariables href="H2O.s081.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 81
    time step          = 0.05
    reference energy   = -17.1519
    reference variance = 0.244012
====================================================
  Execution time = 3.7152e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s081
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2289e-01
  Total weights = 1.9567e+06
  Execution time = 3.3502e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304888712743
                                         uncertainty =       0.002326913575

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304888712743
                                         uncertainty =       0.002326913575

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390461234
  error estimate for blocks of size 2^( 2) =       0.000400545322
  error estimate for blocks of size 2^( 3) =       0.000409775268
  error estimate for blocks of size 2^( 4) =       0.000416383094
  error estimate for blocks of size 2^( 5) =       0.000420324951
  error estimate for blocks of size 2^( 6) =       0.000423856225
  error estimate for blocks of size 2^( 7) =       0.000424884249

      target function =                  N/A
              le_mean =     -17.216500109284
             les_mean =     296.730763364974
             stat err =       0.000421362130
             autocorr =       1.164541995801
              std dev =       0.552195573411
             le_variance =       0.304919951295

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304888712743
                                         uncertainty =       0.002326913575

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304888712743
                                         uncertainty =       0.002326913575

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390461234
  error estimate for blocks of size 2^( 2) =       0.000400545322
  error estimate for blocks of size 2^( 3) =       0.000409775268
  error estimate for blocks of size 2^( 4) =       0.000416383094
  error estimate for blocks of size 2^( 5) =       0.000420324951
  error estimate for blocks of size 2^( 6) =       0.000423856225
  error estimate for blocks of size 2^( 7) =       0.000424884249

      target function =                  N/A
              le_mean =     -17.216500109284
             les_mean =     296.730763364974
             stat err =       0.000421362130
             autocorr =       1.164541995801
              std dev =       0.552195573411
             le_variance =       0.304919951295

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304888712743
                                         uncertainty =       0.002326913575

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304888712743
                                         uncertainty =       0.002326913575

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390461234
  error estimate for blocks of size 2^( 2) =       0.000400545322
  error estimate for blocks of size 2^( 3) =       0.000409775268
  error estimate for blocks of size 2^( 4) =       0.000416383094
  error estimate for blocks of size 2^( 5) =       0.000420324951
  error estimate for blocks of size 2^( 6) =       0.000423856225
  error estimate for blocks of size 2^( 7) =       0.000424884249

      target function =                  N/A
              le_mean =     -17.216500109284
             les_mean =     296.730763364974
             stat err =       0.000421362130
             autocorr =       1.164541995801
              std dev =       0.552195573411
             le_variance =       0.304919951295

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304888712743
                                         uncertainty =       0.002326913575

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304888712743
                                         uncertainty =       0.002326913575

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390461234
  error estimate for blocks of size 2^( 2) =       0.000400545322
  error estimate for blocks of size 2^( 3) =       0.000409775268
  error estimate for blocks of size 2^( 4) =       0.000416383094
  error estimate for blocks of size 2^( 5) =       0.000420324951
  error estimate for blocks of size 2^( 6) =       0.000423856225
  error estimate for blocks of size 2^( 7) =       0.000424884249

      target function =                  N/A
              le_mean =     -17.216500109284
             les_mean =     296.730763364974
             stat err =       0.000421362130
             autocorr =       1.164541995801
              std dev =       0.552195573411
             le_variance =       0.304919951295


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216500109284        initial  <--
     5.8208e+54     5.8208e+55             5.3661e-59       -17.216500109284
     2.3283e+55     2.3283e+56             1.3415e-59       -17.216500109284
     9.3132e+55     9.3132e+56             3.3538e-60       -17.216500109284

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 54.1019
  </log>
  <optVariables href="H2O.s081.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0280e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s082 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s082 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=82  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 82
    time step          = 0.05
    reference energy   = -17.2509
    reference variance = 0.336472
====================================================
  Execution time = 3.7627e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s082
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5301e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1737e-01
  Total weights = 1.956749562e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0942e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303465878735
                                         uncertainty =       0.002997451911

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303465878735
                                         uncertainty =       0.002997451911

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389558885
  error estimate for blocks of size 2^( 2) =       0.000399650289
  error estimate for blocks of size 2^( 3) =       0.000408732257
  error estimate for blocks of size 2^( 4) =       0.000415896263
  error estimate for blocks of size 2^( 5) =       0.000420160345
  error estimate for blocks of size 2^( 6) =       0.000422208402
  error estimate for blocks of size 2^( 7) =       0.000422786221

      target function =                  N/A
              le_mean =     -17.216721550987
             les_mean =     296.732872202071
             stat err =       0.000420262808
             autocorr =       1.163846449759
              std dev =       0.550919459208
             le_variance =       0.303512250534


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721672155099e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+55, overlap shift 5.8208e+56 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216721551008       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216721551008       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.8208e+55 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+56, overlap shift 2.3283e+57 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216721551008       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216721551008       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+56 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+56, overlap shift 9.3132e+57 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216721551008       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216721551008       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+56 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.976297 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8579e+01
  </log>
  <optVariables href="H2O.s082.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 82
    time step          = 0.05
    reference energy   = -17.1956
    reference variance = 0.169957
====================================================
  Execution time = 3.7070e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s082
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1363e-01
  Total weights = 1.9564e+06
  Execution time = 3.3682e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297918028714
                                         uncertainty =       0.002080125299

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297918028714
                                         uncertainty =       0.002080125299

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385915905
  error estimate for blocks of size 2^( 2) =       0.000395593985
  error estimate for blocks of size 2^( 3) =       0.000404143464
  error estimate for blocks of size 2^( 4) =       0.000410350166
  error estimate for blocks of size 2^( 5) =       0.000414859778
  error estimate for blocks of size 2^( 6) =       0.000415784862
  error estimate for blocks of size 2^( 7) =       0.000416811660

      target function =                  N/A
              le_mean =     -17.216083711667
             les_mean =     296.707166051836
             stat err =       0.000414451617
             autocorr =       1.153353185883
              std dev =       0.545767507160
             le_variance =       0.297862171872

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297918028714
                                         uncertainty =       0.002080125299

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297918028714
                                         uncertainty =       0.002080125299

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385915905
  error estimate for blocks of size 2^( 2) =       0.000395593985
  error estimate for blocks of size 2^( 3) =       0.000404143464
  error estimate for blocks of size 2^( 4) =       0.000410350166
  error estimate for blocks of size 2^( 5) =       0.000414859778
  error estimate for blocks of size 2^( 6) =       0.000415784862
  error estimate for blocks of size 2^( 7) =       0.000416811660

      target function =                  N/A
              le_mean =     -17.216083711667
             les_mean =     296.707166051836
             stat err =       0.000414451617
             autocorr =       1.153353185883
              std dev =       0.545767507160
             le_variance =       0.297862171872

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297918028714
                                         uncertainty =       0.002080125299

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297918028714
                                         uncertainty =       0.002080125299

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385915905
  error estimate for blocks of size 2^( 2) =       0.000395593985
  error estimate for blocks of size 2^( 3) =       0.000404143464
  error estimate for blocks of size 2^( 4) =       0.000410350166
  error estimate for blocks of size 2^( 5) =       0.000414859778
  error estimate for blocks of size 2^( 6) =       0.000415784862
  error estimate for blocks of size 2^( 7) =       0.000416811660

      target function =                  N/A
              le_mean =     -17.216083711667
             les_mean =     296.707166051836
             stat err =       0.000414451617
             autocorr =       1.153353185883
              std dev =       0.545767507160
             le_variance =       0.297862171872

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297918028714
                                         uncertainty =       0.002080125299

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297918028714
                                         uncertainty =       0.002080125299

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385915905
  error estimate for blocks of size 2^( 2) =       0.000395593985
  error estimate for blocks of size 2^( 3) =       0.000404143464
  error estimate for blocks of size 2^( 4) =       0.000410350166
  error estimate for blocks of size 2^( 5) =       0.000414859778
  error estimate for blocks of size 2^( 6) =       0.000415784862
  error estimate for blocks of size 2^( 7) =       0.000416811660

      target function =                  N/A
              le_mean =     -17.216083711667
             les_mean =     296.707166051836
             stat err =       0.000414451617
             autocorr =       1.153353185883
              std dev =       0.545767507160
             le_variance =       0.297862171872


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216083711667        initial  <--
     5.8208e+55     5.8208e+56             0.0000e+00       -17.216083711667
     2.3283e+56     2.3283e+57             0.0000e+00       -17.216083711667
     9.3132e+56     9.3132e+57             0.0000e+00       -17.216083711667

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 54.0973
  </log>
  <optVariables href="H2O.s082.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0268e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s083 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s083 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=83  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 83
    time step          = 0.05
    reference energy   = -17.1597
    reference variance = 0.270506
====================================================
  Execution time = 3.7479e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s083
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5300e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1250e-01
  Total weights = 1.956586049e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1108e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298132641992
                                         uncertainty =       0.001964286573

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298132641992
                                         uncertainty =       0.001964286573

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386235086
  error estimate for blocks of size 2^( 2) =       0.000396168834
  error estimate for blocks of size 2^( 3) =       0.000405156723
  error estimate for blocks of size 2^( 4) =       0.000411549920
  error estimate for blocks of size 2^( 5) =       0.000415643176
  error estimate for blocks of size 2^( 6) =       0.000416986566
  error estimate for blocks of size 2^( 7) =       0.000417564353

      target function =                  N/A
              le_mean =     -17.215732765410
             les_mean =     296.693954641663
             stat err =       0.000415436004
             autocorr =       1.156923967505
              std dev =       0.546218896844
             le_variance =       0.298355083269


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721573276541e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+56, overlap shift 5.8208e+57 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215732765444       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215732765444       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.8208e+56 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+57, overlap shift 2.3283e+58 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215732765444       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215732765444       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+57 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+57, overlap shift 9.3132e+58 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215732765444       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215732765444       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+57 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.977484 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8597e+01
  </log>
  <optVariables href="H2O.s083.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 83
    time step          = 0.05
    reference energy   = -17.2004
    reference variance = 0.184374
====================================================
  Execution time = 3.7471e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s083
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1438e-01
  Total weights = 1.9563e+06
  Execution time = 3.3443e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300459686992
                                         uncertainty =       0.002000700156

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300459686992
                                         uncertainty =       0.002000700156

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387592424
  error estimate for blocks of size 2^( 2) =       0.000397666452
  error estimate for blocks of size 2^( 3) =       0.000406631993
  error estimate for blocks of size 2^( 4) =       0.000413593604
  error estimate for blocks of size 2^( 5) =       0.000418750464
  error estimate for blocks of size 2^( 6) =       0.000420551993
  error estimate for blocks of size 2^( 7) =       0.000422990858

      target function =                  N/A
              le_mean =     -17.216888617988
             les_mean =     296.735638384410
             stat err =       0.000418971730
             autocorr =       1.168473535017
              std dev =       0.548138462701
             le_variance =       0.300455774293

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300459686992
                                         uncertainty =       0.002000700156

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300459686992
                                         uncertainty =       0.002000700156

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387592424
  error estimate for blocks of size 2^( 2) =       0.000397666452
  error estimate for blocks of size 2^( 3) =       0.000406631993
  error estimate for blocks of size 2^( 4) =       0.000413593604
  error estimate for blocks of size 2^( 5) =       0.000418750464
  error estimate for blocks of size 2^( 6) =       0.000420551993
  error estimate for blocks of size 2^( 7) =       0.000422990858

      target function =                  N/A
              le_mean =     -17.216888617988
             les_mean =     296.735638384410
             stat err =       0.000418971730
             autocorr =       1.168473535017
              std dev =       0.548138462701
             le_variance =       0.300455774293

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300459686992
                                         uncertainty =       0.002000700156

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300459686992
                                         uncertainty =       0.002000700156

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387592424
  error estimate for blocks of size 2^( 2) =       0.000397666452
  error estimate for blocks of size 2^( 3) =       0.000406631993
  error estimate for blocks of size 2^( 4) =       0.000413593604
  error estimate for blocks of size 2^( 5) =       0.000418750464
  error estimate for blocks of size 2^( 6) =       0.000420551993
  error estimate for blocks of size 2^( 7) =       0.000422990858

      target function =                  N/A
              le_mean =     -17.216888617988
             les_mean =     296.735638384410
             stat err =       0.000418971730
             autocorr =       1.168473535017
              std dev =       0.548138462701
             le_variance =       0.300455774293

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300459686992
                                         uncertainty =       0.002000700156

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300459686992
                                         uncertainty =       0.002000700156

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387592424
  error estimate for blocks of size 2^( 2) =       0.000397666452
  error estimate for blocks of size 2^( 3) =       0.000406631993
  error estimate for blocks of size 2^( 4) =       0.000413593604
  error estimate for blocks of size 2^( 5) =       0.000418750464
  error estimate for blocks of size 2^( 6) =       0.000420551993
  error estimate for blocks of size 2^( 7) =       0.000422990858

      target function =                  N/A
              le_mean =     -17.216888617988
             les_mean =     296.735638384410
             stat err =       0.000418971730
             autocorr =       1.168473535017
              std dev =       0.548138462701
             le_variance =       0.300455774293


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216888617988        initial  <--
     5.8208e+56     5.8208e+57             0.0000e+00       -17.216888617988
     2.3283e+57     2.3283e+58             0.0000e+00       -17.216888617988
     9.3132e+57     9.3132e+58             0.0000e+00       -17.216888617988

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 54.4379
  </log>
  <optVariables href="H2O.s083.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0304e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s084 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s084 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=84  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 84
    time step          = 0.05
    reference energy   = -17.2013
    reference variance = 0.261555
====================================================
  Execution time = 3.7493e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s084
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5287e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1834e-01
  Total weights = 1.956225041e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1055e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303731716235
                                         uncertainty =       0.002721584385

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303731716235
                                         uncertainty =       0.002721584385

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389646379
  error estimate for blocks of size 2^( 2) =       0.000399927892
  error estimate for blocks of size 2^( 3) =       0.000408259378
  error estimate for blocks of size 2^( 4) =       0.000415454802
  error estimate for blocks of size 2^( 5) =       0.000420214349
  error estimate for blocks of size 2^( 6) =       0.000422408597
  error estimate for blocks of size 2^( 7) =       0.000422964107

      target function =                  N/A
              le_mean =     -17.216523017267
             les_mean =     296.727000895781
             stat err =       0.000420260464
             autocorr =       1.163310858549
              std dev =       0.551043193294
             le_variance =       0.303648600875


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721652301727e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+57, overlap shift 5.8208e+58 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216523017296       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216523017296       residual = 7.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216523017296       residual = 3.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.8208e+57 is 5.377888e-62

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+58, overlap shift 2.3283e+59 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216523017296       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216523017296       residual = 7.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216523017296       residual = 3.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+58 is 1.344472e-62

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+58, overlap shift 9.3132e+59 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216523017296       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216523017296       residual = 7.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216523017296       residual = 3.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+58 is 3.361180e-63

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.978916 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8558e+01
  </log>
  <optVariables href="H2O.s084.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 84
    time step          = 0.05
    reference energy   = -17.2516
    reference variance = 0.407072
====================================================
  Execution time = 3.7074e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s084
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1642e-01
  Total weights = 1.9567e+06
  Execution time = 3.3452e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298706265456
                                         uncertainty =       0.002115154262

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298706265456
                                         uncertainty =       0.002115154262

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386644629
  error estimate for blocks of size 2^( 2) =       0.000396411452
  error estimate for blocks of size 2^( 3) =       0.000405288040
  error estimate for blocks of size 2^( 4) =       0.000411944730
  error estimate for blocks of size 2^( 5) =       0.000417030847
  error estimate for blocks of size 2^( 6) =       0.000419927351
  error estimate for blocks of size 2^( 7) =       0.000420686680

      target function =                  N/A
              le_mean =     -17.216273824127
             les_mean =     296.716506212965
             stat err =       0.000417397402
             autocorr =       1.165401357854
              std dev =       0.546798077998
             le_variance =       0.298988138102

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298706265456
                                         uncertainty =       0.002115154262

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298706265456
                                         uncertainty =       0.002115154262

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386644629
  error estimate for blocks of size 2^( 2) =       0.000396411452
  error estimate for blocks of size 2^( 3) =       0.000405288040
  error estimate for blocks of size 2^( 4) =       0.000411944730
  error estimate for blocks of size 2^( 5) =       0.000417030847
  error estimate for blocks of size 2^( 6) =       0.000419927351
  error estimate for blocks of size 2^( 7) =       0.000420686680

      target function =                  N/A
              le_mean =     -17.216273824127
             les_mean =     296.716506212965
             stat err =       0.000417397402
             autocorr =       1.165401357854
              std dev =       0.546798077998
             le_variance =       0.298988138102

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298706265456
                                         uncertainty =       0.002115154262

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298706265456
                                         uncertainty =       0.002115154262

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386644629
  error estimate for blocks of size 2^( 2) =       0.000396411452
  error estimate for blocks of size 2^( 3) =       0.000405288040
  error estimate for blocks of size 2^( 4) =       0.000411944730
  error estimate for blocks of size 2^( 5) =       0.000417030847
  error estimate for blocks of size 2^( 6) =       0.000419927351
  error estimate for blocks of size 2^( 7) =       0.000420686680

      target function =                  N/A
              le_mean =     -17.216273824127
             les_mean =     296.716506212965
             stat err =       0.000417397402
             autocorr =       1.165401357854
              std dev =       0.546798077998
             le_variance =       0.298988138102

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298706265456
                                         uncertainty =       0.002115154262

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298706265456
                                         uncertainty =       0.002115154262

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386644629
  error estimate for blocks of size 2^( 2) =       0.000396411452
  error estimate for blocks of size 2^( 3) =       0.000405288040
  error estimate for blocks of size 2^( 4) =       0.000411944730
  error estimate for blocks of size 2^( 5) =       0.000417030847
  error estimate for blocks of size 2^( 6) =       0.000419927351
  error estimate for blocks of size 2^( 7) =       0.000420686680

      target function =                  N/A
              le_mean =     -17.216273824127
             les_mean =     296.716506212965
             stat err =       0.000417397402
             autocorr =       1.165401357854
              std dev =       0.546798077998
             le_variance =       0.298988138102


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216273824127        initial  <--
     5.8208e+57     5.8208e+58             5.3779e-62       -17.216273824127
     2.3283e+58     2.3283e+59             1.3445e-62       -17.216273824127
     9.3132e+58     9.3132e+59             3.3612e-63       -17.216273824127

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 54.0135
  </log>
  <optVariables href="H2O.s084.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0258e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s085 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s085 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=85  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 85
    time step          = 0.05
    reference energy   = -17.2801
    reference variance = 0.214026
====================================================
  Execution time = 3.7778e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s085
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5267e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1155e-01
  Total weights = 1.956664726e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1068e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298124567141
                                         uncertainty =       0.001786583890

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298124567141
                                         uncertainty =       0.001786583890

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386158620
  error estimate for blocks of size 2^( 2) =       0.000396233285
  error estimate for blocks of size 2^( 3) =       0.000404625556
  error estimate for blocks of size 2^( 4) =       0.000411762918
  error estimate for blocks of size 2^( 5) =       0.000415914551
  error estimate for blocks of size 2^( 6) =       0.000419675884
  error estimate for blocks of size 2^( 7) =       0.000420655720

      target function =                  N/A
              le_mean =     -17.215764570796
             les_mean =     296.694096587188
             stat err =       0.000417002268
             autocorr =       1.166125699194
              std dev =       0.546110758050
             le_variance =       0.298236960058


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721576457080e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+58, overlap shift 5.8208e+59 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215764570811       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215764570811       residual = 8.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215764570811       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.8208e+58 is 3.967548e-63

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+59, overlap shift 2.3283e+60 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215764570811       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215764570811       residual = 8.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215764570811       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+59 is 1.270143e-63

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+59, overlap shift 9.3132e+60 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215764570811       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215764570811       residual = 8.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215764570811       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+59 is 3.175358e-64

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.980395 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8856e+01
  </log>
  <optVariables href="H2O.s085.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 85
    time step          = 0.05
    reference energy   = -17.2699
    reference variance = 0.330307
====================================================
  Execution time = 3.7031e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s085
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1302e-01
  Total weights = 1.9568e+06
  Execution time = 3.3426e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295172126514
                                         uncertainty =       0.002138637836

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295172126514
                                         uncertainty =       0.002138637836

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384142908
  error estimate for blocks of size 2^( 2) =       0.000393781726
  error estimate for blocks of size 2^( 3) =       0.000403197962
  error estimate for blocks of size 2^( 4) =       0.000410562264
  error estimate for blocks of size 2^( 5) =       0.000414232940
  error estimate for blocks of size 2^( 6) =       0.000415011349
  error estimate for blocks of size 2^( 7) =       0.000416191551

      target function =                  N/A
              le_mean =     -17.216505710326
             les_mean =     296.721086453001
             stat err =       0.000413999526
             autocorr =       1.161486185412
              std dev =       0.543260109805
             le_variance =       0.295131546906

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295172126514
                                         uncertainty =       0.002138637836

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295172126514
                                         uncertainty =       0.002138637836

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384142908
  error estimate for blocks of size 2^( 2) =       0.000393781726
  error estimate for blocks of size 2^( 3) =       0.000403197962
  error estimate for blocks of size 2^( 4) =       0.000410562264
  error estimate for blocks of size 2^( 5) =       0.000414232940
  error estimate for blocks of size 2^( 6) =       0.000415011349
  error estimate for blocks of size 2^( 7) =       0.000416191551

      target function =                  N/A
              le_mean =     -17.216505710326
             les_mean =     296.721086453001
             stat err =       0.000413999526
             autocorr =       1.161486185412
              std dev =       0.543260109805
             le_variance =       0.295131546906

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295172126514
                                         uncertainty =       0.002138637836

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295172126514
                                         uncertainty =       0.002138637836

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384142908
  error estimate for blocks of size 2^( 2) =       0.000393781726
  error estimate for blocks of size 2^( 3) =       0.000403197962
  error estimate for blocks of size 2^( 4) =       0.000410562264
  error estimate for blocks of size 2^( 5) =       0.000414232940
  error estimate for blocks of size 2^( 6) =       0.000415011349
  error estimate for blocks of size 2^( 7) =       0.000416191551

      target function =                  N/A
              le_mean =     -17.216505710326
             les_mean =     296.721086453001
             stat err =       0.000413999526
             autocorr =       1.161486185412
              std dev =       0.543260109805
             le_variance =       0.295131546906

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295172126514
                                         uncertainty =       0.002138637836

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295172126514
                                         uncertainty =       0.002138637836

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384142908
  error estimate for blocks of size 2^( 2) =       0.000393781726
  error estimate for blocks of size 2^( 3) =       0.000403197962
  error estimate for blocks of size 2^( 4) =       0.000410562264
  error estimate for blocks of size 2^( 5) =       0.000414232940
  error estimate for blocks of size 2^( 6) =       0.000415011349
  error estimate for blocks of size 2^( 7) =       0.000416191551

      target function =                  N/A
              le_mean =     -17.216505710326
             les_mean =     296.721086453001
             stat err =       0.000413999526
             autocorr =       1.161486185412
              std dev =       0.543260109805
             le_variance =       0.295131546906


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216505710326        initial  <--
     5.8208e+58     5.8208e+59             3.9675e-63       -17.216505710326
     2.3283e+59     2.3283e+60             1.2701e-63       -17.216505710326
     9.3132e+59     9.3132e+60             3.1754e-64       -17.216505710326

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.9475
  </log>
  <optVariables href="H2O.s085.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0281e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s086 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s086 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=86  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 86
    time step          = 0.05
    reference energy   = -17.2188
    reference variance = 0.194767
====================================================
  Execution time = 3.7313e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s086
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5273e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1885e-01
  Total weights = 1.956685359e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1016e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299441827569
                                         uncertainty =       0.001920352886

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299441827569
                                         uncertainty =       0.001920352886

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386900274
  error estimate for blocks of size 2^( 2) =       0.000397018626
  error estimate for blocks of size 2^( 3) =       0.000406314563
  error estimate for blocks of size 2^( 4) =       0.000413009519
  error estimate for blocks of size 2^( 5) =       0.000417698966
  error estimate for blocks of size 2^( 6) =       0.000419521875
  error estimate for blocks of size 2^( 7) =       0.000420479745

      target function =                  N/A
              le_mean =     -17.216343811449
             les_mean =     296.721349215018
             stat err =       0.000417677526
             autocorr =       1.165424497172
              std dev =       0.547159614110
             le_variance =       0.299383643313


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721634381145e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+59, overlap shift 5.8208e+60 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216343811480       residual = 2.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216343811480       residual = 2.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.8208e+59 is 6.332392e-64

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+60, overlap shift 2.3283e+61 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216343811480       residual = 2.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216343811480       residual = 2.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216343811480       residual = 2.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+60 is 1.583098e-64

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+60, overlap shift 9.3132e+61 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216343811480       residual = 2.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216343811480       residual = 2.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216343811480       residual = 6.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216343811480       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+60 is 4.612713e-65

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.981992 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8340e+01
  </log>
  <optVariables href="H2O.s086.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 86
    time step          = 0.05
    reference energy   = -17.2231
    reference variance = 0.797213
====================================================
  Execution time = 3.7549e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s086
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1480e-01
  Total weights = 1.9568e+06
  Execution time = 3.3601e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299699169693
                                         uncertainty =       0.002215995760

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299699169693
                                         uncertainty =       0.002215995760

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387079736
  error estimate for blocks of size 2^( 2) =       0.000397165234
  error estimate for blocks of size 2^( 3) =       0.000406253315
  error estimate for blocks of size 2^( 4) =       0.000413480832
  error estimate for blocks of size 2^( 5) =       0.000417531529
  error estimate for blocks of size 2^( 6) =       0.000420282345
  error estimate for blocks of size 2^( 7) =       0.000422177410

      target function =                  N/A
              le_mean =     -17.216806031501
             les_mean =     296.733213627478
             stat err =       0.000418368029
             autocorr =       1.168197054862
              std dev =       0.547413411754
             le_variance =       0.299661443368

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299699169693
                                         uncertainty =       0.002215995760

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299699169693
                                         uncertainty =       0.002215995760

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387079736
  error estimate for blocks of size 2^( 2) =       0.000397165234
  error estimate for blocks of size 2^( 3) =       0.000406253315
  error estimate for blocks of size 2^( 4) =       0.000413480832
  error estimate for blocks of size 2^( 5) =       0.000417531529
  error estimate for blocks of size 2^( 6) =       0.000420282345
  error estimate for blocks of size 2^( 7) =       0.000422177410

      target function =                  N/A
              le_mean =     -17.216806031501
             les_mean =     296.733213627478
             stat err =       0.000418368029
             autocorr =       1.168197054862
              std dev =       0.547413411754
             le_variance =       0.299661443368

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299699169693
                                         uncertainty =       0.002215995760

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299699169693
                                         uncertainty =       0.002215995760

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387079736
  error estimate for blocks of size 2^( 2) =       0.000397165234
  error estimate for blocks of size 2^( 3) =       0.000406253315
  error estimate for blocks of size 2^( 4) =       0.000413480832
  error estimate for blocks of size 2^( 5) =       0.000417531529
  error estimate for blocks of size 2^( 6) =       0.000420282345
  error estimate for blocks of size 2^( 7) =       0.000422177410

      target function =                  N/A
              le_mean =     -17.216806031501
             les_mean =     296.733213627478
             stat err =       0.000418368029
             autocorr =       1.168197054862
              std dev =       0.547413411754
             le_variance =       0.299661443368

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299699169693
                                         uncertainty =       0.002215995760

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299699169693
                                         uncertainty =       0.002215995760

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387079736
  error estimate for blocks of size 2^( 2) =       0.000397165234
  error estimate for blocks of size 2^( 3) =       0.000406253315
  error estimate for blocks of size 2^( 4) =       0.000413480832
  error estimate for blocks of size 2^( 5) =       0.000417531529
  error estimate for blocks of size 2^( 6) =       0.000420282345
  error estimate for blocks of size 2^( 7) =       0.000422177410

      target function =                  N/A
              le_mean =     -17.216806031501
             les_mean =     296.733213627478
             stat err =       0.000418368029
             autocorr =       1.168197054862
              std dev =       0.547413411754
             le_variance =       0.299661443368


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216806031501        initial  <--
     5.8208e+59     5.8208e+60             6.3324e-64       -17.216806031501
     2.3283e+60     2.3283e+61             1.5831e-64       -17.216806031501
     9.3132e+60     9.3132e+61             4.6127e-65       -17.216806031501

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 54.5775
  </log>
  <optVariables href="H2O.s086.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0292e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s087 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s087 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=87  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 87
    time step          = 0.05
    reference energy   = -17.292
    reference variance = 0.241438
====================================================
  Execution time = 3.7546e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s087
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5288e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1232e-01
  Total weights = 1.956648792e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0930e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299397937350
                                         uncertainty =       0.002074647387

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299397937350
                                         uncertainty =       0.002074647387

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386858676
  error estimate for blocks of size 2^( 2) =       0.000396875695
  error estimate for blocks of size 2^( 3) =       0.000406356970
  error estimate for blocks of size 2^( 4) =       0.000412740967
  error estimate for blocks of size 2^( 5) =       0.000417000937
  error estimate for blocks of size 2^( 6) =       0.000418432612
  error estimate for blocks of size 2^( 7) =       0.000419552056

      target function =                  N/A
              le_mean =     -17.216808943881
             les_mean =     296.730829286948
             stat err =       0.000416931643
             autocorr =       1.161515560375
              std dev =       0.547100786542
             le_variance =       0.299319270634


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721680894388e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+60, overlap shift 5.8208e+61 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216808943931       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216808943931       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.8208e+60 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+61, overlap shift 2.3283e+62 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216808943931       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216808943931       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+61 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+61, overlap shift 9.3132e+62 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216808943931       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216808943931       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+61 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.983247 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8486e+01
  </log>
  <optVariables href="H2O.s087.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 87
    time step          = 0.05
    reference energy   = -17.2357
    reference variance = 0.204758
====================================================
  Execution time = 3.7148e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s087
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1895e-01
  Total weights = 1.9568e+06
  Execution time = 3.3604e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304179655448
                                         uncertainty =       0.003392528780

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304179655448
                                         uncertainty =       0.003392528780

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389930259
  error estimate for blocks of size 2^( 2) =       0.000399733791
  error estimate for blocks of size 2^( 3) =       0.000408187790
  error estimate for blocks of size 2^( 4) =       0.000415072113
  error estimate for blocks of size 2^( 5) =       0.000418197398
  error estimate for blocks of size 2^( 6) =       0.000420620356
  error estimate for blocks of size 2^( 7) =       0.000422191249

      target function =                  N/A
              le_mean =     -17.216333357624
             les_mean =     296.721080460019
             stat err =       0.000419020279
             autocorr =       1.154771901682
              std dev =       0.551444660073
             le_variance =       0.304091213123

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304179655448
                                         uncertainty =       0.003392528780

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304179655448
                                         uncertainty =       0.003392528780

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389930259
  error estimate for blocks of size 2^( 2) =       0.000399733791
  error estimate for blocks of size 2^( 3) =       0.000408187790
  error estimate for blocks of size 2^( 4) =       0.000415072113
  error estimate for blocks of size 2^( 5) =       0.000418197398
  error estimate for blocks of size 2^( 6) =       0.000420620356
  error estimate for blocks of size 2^( 7) =       0.000422191249

      target function =                  N/A
              le_mean =     -17.216333357624
             les_mean =     296.721080460019
             stat err =       0.000419020279
             autocorr =       1.154771901682
              std dev =       0.551444660073
             le_variance =       0.304091213123

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304179655448
                                         uncertainty =       0.003392528780

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304179655448
                                         uncertainty =       0.003392528780

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389930259
  error estimate for blocks of size 2^( 2) =       0.000399733791
  error estimate for blocks of size 2^( 3) =       0.000408187790
  error estimate for blocks of size 2^( 4) =       0.000415072113
  error estimate for blocks of size 2^( 5) =       0.000418197398
  error estimate for blocks of size 2^( 6) =       0.000420620356
  error estimate for blocks of size 2^( 7) =       0.000422191249

      target function =                  N/A
              le_mean =     -17.216333357624
             les_mean =     296.721080460019
             stat err =       0.000419020279
             autocorr =       1.154771901682
              std dev =       0.551444660073
             le_variance =       0.304091213123

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304179655448
                                         uncertainty =       0.003392528780

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304179655448
                                         uncertainty =       0.003392528780

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389930259
  error estimate for blocks of size 2^( 2) =       0.000399733791
  error estimate for blocks of size 2^( 3) =       0.000408187790
  error estimate for blocks of size 2^( 4) =       0.000415072113
  error estimate for blocks of size 2^( 5) =       0.000418197398
  error estimate for blocks of size 2^( 6) =       0.000420620356
  error estimate for blocks of size 2^( 7) =       0.000422191249

      target function =                  N/A
              le_mean =     -17.216333357624
             les_mean =     296.721080460019
             stat err =       0.000419020279
             autocorr =       1.154771901682
              std dev =       0.551444660073
             le_variance =       0.304091213123


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216333357624        initial  <--
     5.8208e+60     5.8208e+61             0.0000e+00       -17.216333357624
     2.3283e+61     2.3283e+62             0.0000e+00       -17.216333357624
     9.3132e+61     9.3132e+62             0.0000e+00       -17.216333357624

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 54.1044
  </log>
  <optVariables href="H2O.s087.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0260e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s088 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s088 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=88  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 88
    time step          = 0.05
    reference energy   = -17.2335
    reference variance = 0.320199
====================================================
  Execution time = 3.7461e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s088
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5278e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1550e-01
  Total weights = 1.956580760e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0918e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299806391074
                                         uncertainty =       0.002100021525

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299806391074
                                         uncertainty =       0.002100021525

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387170490
  error estimate for blocks of size 2^( 2) =       0.000397137628
  error estimate for blocks of size 2^( 3) =       0.000406210373
  error estimate for blocks of size 2^( 4) =       0.000412714454
  error estimate for blocks of size 2^( 5) =       0.000417390723
  error estimate for blocks of size 2^( 6) =       0.000420821943
  error estimate for blocks of size 2^( 7) =       0.000423045587

      target function =                  N/A
              le_mean =     -17.216547862278
             les_mean =     296.725016038653
             stat err =       0.000418493177
             autocorr =       1.168348128052
              std dev =       0.547541757515
             le_variance =       0.299801976222


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721654786228e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+61, overlap shift 5.8208e+62 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216547862286       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216547862286       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.8208e+61 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+62, overlap shift 2.3283e+63 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216547862286       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216547862286       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+62 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+62, overlap shift 9.3132e+63 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216547862286       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216547862286       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+62 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.984444 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8389e+01
  </log>
  <optVariables href="H2O.s088.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 88
    time step          = 0.05
    reference energy   = -17.1457
    reference variance = 0.251708
====================================================
  Execution time = 3.6973e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s088
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1559e-01
  Total weights = 1.9563e+06
  Execution time = 3.3542e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299630309653
                                         uncertainty =       0.002052185379

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299630309653
                                         uncertainty =       0.002052185379

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387016966
  error estimate for blocks of size 2^( 2) =       0.000397141435
  error estimate for blocks of size 2^( 3) =       0.000406178056
  error estimate for blocks of size 2^( 4) =       0.000413237242
  error estimate for blocks of size 2^( 5) =       0.000417574443
  error estimate for blocks of size 2^( 6) =       0.000419316299
  error estimate for blocks of size 2^( 7) =       0.000421133010

      target function =                  N/A
              le_mean =     -17.216653707354
             les_mean =     296.728759677291
             stat err =       0.000417815248
             autocorr =       1.165490029217
              std dev =       0.547324642822
             le_variance =       0.299564264640

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299630309653
                                         uncertainty =       0.002052185379

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299630309653
                                         uncertainty =       0.002052185379

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387016966
  error estimate for blocks of size 2^( 2) =       0.000397141435
  error estimate for blocks of size 2^( 3) =       0.000406178056
  error estimate for blocks of size 2^( 4) =       0.000413237242
  error estimate for blocks of size 2^( 5) =       0.000417574443
  error estimate for blocks of size 2^( 6) =       0.000419316299
  error estimate for blocks of size 2^( 7) =       0.000421133010

      target function =                  N/A
              le_mean =     -17.216653707354
             les_mean =     296.728759677291
             stat err =       0.000417815248
             autocorr =       1.165490029217
              std dev =       0.547324642822
             le_variance =       0.299564264640

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299630309653
                                         uncertainty =       0.002052185379

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299630309653
                                         uncertainty =       0.002052185379

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387016966
  error estimate for blocks of size 2^( 2) =       0.000397141435
  error estimate for blocks of size 2^( 3) =       0.000406178056
  error estimate for blocks of size 2^( 4) =       0.000413237242
  error estimate for blocks of size 2^( 5) =       0.000417574443
  error estimate for blocks of size 2^( 6) =       0.000419316299
  error estimate for blocks of size 2^( 7) =       0.000421133010

      target function =                  N/A
              le_mean =     -17.216653707354
             les_mean =     296.728759677291
             stat err =       0.000417815248
             autocorr =       1.165490029217
              std dev =       0.547324642822
             le_variance =       0.299564264640

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299630309653
                                         uncertainty =       0.002052185379

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299630309653
                                         uncertainty =       0.002052185379

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387016966
  error estimate for blocks of size 2^( 2) =       0.000397141435
  error estimate for blocks of size 2^( 3) =       0.000406178056
  error estimate for blocks of size 2^( 4) =       0.000413237242
  error estimate for blocks of size 2^( 5) =       0.000417574443
  error estimate for blocks of size 2^( 6) =       0.000419316299
  error estimate for blocks of size 2^( 7) =       0.000421133010

      target function =                  N/A
              le_mean =     -17.216653707354
             les_mean =     296.728759677291
             stat err =       0.000417815248
             autocorr =       1.165490029217
              std dev =       0.547324642822
             le_variance =       0.299564264640


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216653707354        initial  <--
     5.8208e+61     5.8208e+62             0.0000e+00       -17.216653707354
     2.3283e+62     2.3283e+63             0.0000e+00       -17.216653707354
     9.3132e+62     9.3132e+63             0.0000e+00       -17.216653707354

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.9463
  </log>
  <optVariables href="H2O.s088.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0234e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s089 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s089 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=89  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 89
    time step          = 0.05
    reference energy   = -17.1994
    reference variance = 0.272519
====================================================
  Execution time = 3.7991e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s089
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5292e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1772e-01
  Total weights = 1.956473423e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1044e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299317833184
                                         uncertainty =       0.002038378171

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299317833184
                                         uncertainty =       0.002038378171

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386868791
  error estimate for blocks of size 2^( 2) =       0.000396996345
  error estimate for blocks of size 2^( 3) =       0.000405887069
  error estimate for blocks of size 2^( 4) =       0.000413231198
  error estimate for blocks of size 2^( 5) =       0.000416693915
  error estimate for blocks of size 2^( 6) =       0.000418700581
  error estimate for blocks of size 2^( 7) =       0.000419191997

      target function =                  N/A
              le_mean =     -17.216205752455
             les_mean =     296.715457377480
             stat err =       0.000416954423
             autocorr =       1.161581744900
              std dev =       0.547115090689
             le_variance =       0.299334922460


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721620575245e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+62, overlap shift 5.8208e+63 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216205752515       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216205752515       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216205752515       residual = 4.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.8208e+62 is 7.089113e-67

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+63, overlap shift 2.3283e+64 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216205752515       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216205752515       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216205752515       residual = 4.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+63 is 1.772278e-67

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+63, overlap shift 9.3132e+64 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216205752515       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216205752515       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216205752515       residual = 4.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+63 is 4.430695e-68

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.985903 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.9045e+01
  </log>
  <optVariables href="H2O.s089.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 89
    time step          = 0.05
    reference energy   = -17.2785
    reference variance = 0.289738
====================================================
  Execution time = 3.7552e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s089
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1133e-01
  Total weights = 1.9569e+06
  Execution time = 3.3587e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298996809101
                                         uncertainty =       0.001986508867

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298996809101
                                         uncertainty =       0.001986508867

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386684503
  error estimate for blocks of size 2^( 2) =       0.000396602145
  error estimate for blocks of size 2^( 3) =       0.000405768898
  error estimate for blocks of size 2^( 4) =       0.000411639091
  error estimate for blocks of size 2^( 5) =       0.000416259533
  error estimate for blocks of size 2^( 6) =       0.000419357809
  error estimate for blocks of size 2^( 7) =       0.000420676241

      target function =                  N/A
              le_mean =     -17.215930938284
             les_mean =     296.699613057746
             stat err =       0.000416983169
             autocorr =       1.162849516979
              std dev =       0.546854467935
             le_variance =       0.299049809100

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298996809101
                                         uncertainty =       0.001986508867

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298996809101
                                         uncertainty =       0.001986508867

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386684503
  error estimate for blocks of size 2^( 2) =       0.000396602145
  error estimate for blocks of size 2^( 3) =       0.000405768898
  error estimate for blocks of size 2^( 4) =       0.000411639091
  error estimate for blocks of size 2^( 5) =       0.000416259533
  error estimate for blocks of size 2^( 6) =       0.000419357809
  error estimate for blocks of size 2^( 7) =       0.000420676241

      target function =                  N/A
              le_mean =     -17.215930938284
             les_mean =     296.699613057746
             stat err =       0.000416983169
             autocorr =       1.162849516979
              std dev =       0.546854467935
             le_variance =       0.299049809100

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298996809101
                                         uncertainty =       0.001986508867

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298996809101
                                         uncertainty =       0.001986508867

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386684503
  error estimate for blocks of size 2^( 2) =       0.000396602145
  error estimate for blocks of size 2^( 3) =       0.000405768898
  error estimate for blocks of size 2^( 4) =       0.000411639091
  error estimate for blocks of size 2^( 5) =       0.000416259533
  error estimate for blocks of size 2^( 6) =       0.000419357809
  error estimate for blocks of size 2^( 7) =       0.000420676241

      target function =                  N/A
              le_mean =     -17.215930938284
             les_mean =     296.699613057746
             stat err =       0.000416983169
             autocorr =       1.162849516979
              std dev =       0.546854467935
             le_variance =       0.299049809100

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298996809101
                                         uncertainty =       0.001986508867

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298996809101
                                         uncertainty =       0.001986508867

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386684503
  error estimate for blocks of size 2^( 2) =       0.000396602145
  error estimate for blocks of size 2^( 3) =       0.000405768898
  error estimate for blocks of size 2^( 4) =       0.000411639091
  error estimate for blocks of size 2^( 5) =       0.000416259533
  error estimate for blocks of size 2^( 6) =       0.000419357809
  error estimate for blocks of size 2^( 7) =       0.000420676241

      target function =                  N/A
              le_mean =     -17.215930938284
             les_mean =     296.699613057746
             stat err =       0.000416983169
             autocorr =       1.162849516979
              std dev =       0.546854467935
             le_variance =       0.299049809100


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215930938284        initial  <--
     5.8208e+62     5.8208e+63             7.0891e-67       -17.215930938284
     2.3283e+63     2.3283e+64             1.7723e-67       -17.215930938284
     9.3132e+63     9.3132e+64             4.4307e-68       -17.215930938284

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 54.5280
  </log>
  <optVariables href="H2O.s089.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0358e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s090 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s090 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=90  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 90
    time step          = 0.05
    reference energy   = -17.2412
    reference variance = 0.297269
====================================================
  Execution time = 3.7782e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s090
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5277e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1311e-01
  Total weights = 1.956731847e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1004e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297137181719
                                         uncertainty =       0.001994292141

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297137181719
                                         uncertainty =       0.001994292141

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385576418
  error estimate for blocks of size 2^( 2) =       0.000395573181
  error estimate for blocks of size 2^( 3) =       0.000404796894
  error estimate for blocks of size 2^( 4) =       0.000411639198
  error estimate for blocks of size 2^( 5) =       0.000414926296
  error estimate for blocks of size 2^( 6) =       0.000417461600
  error estimate for blocks of size 2^( 7) =       0.000415863796

      target function =                  N/A
              le_mean =     -17.216308760940
             les_mean =     296.714400086885
             stat err =       0.000414972722
             autocorr =       1.158292303083
              std dev =       0.545287400073
             le_variance =       0.297338348679


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721630876094e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+63, overlap shift 5.8208e+64 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216308760968       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216308760968       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.8208e+63 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+64, overlap shift 2.3283e+65 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216308760968       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216308760968       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+64 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+64, overlap shift 9.3132e+65 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216308760968       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216308760968       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+64 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.987103 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8796e+01
  </log>
  <optVariables href="H2O.s090.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 90
    time step          = 0.05
    reference energy   = -17.1933
    reference variance = 0.173538
====================================================
  Execution time = 3.7227e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s090
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1474e-01
  Total weights = 1.9565e+06
  Execution time = 3.3559e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300028374574
                                         uncertainty =       0.001845884402

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300028374574
                                         uncertainty =       0.001845884402

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387282402
  error estimate for blocks of size 2^( 2) =       0.000397274059
  error estimate for blocks of size 2^( 3) =       0.000406207460
  error estimate for blocks of size 2^( 4) =       0.000413384912
  error estimate for blocks of size 2^( 5) =       0.000418049523
  error estimate for blocks of size 2^( 6) =       0.000420608696
  error estimate for blocks of size 2^( 7) =       0.000420076287

      target function =                  N/A
              le_mean =     -17.216835098857
             les_mean =     296.734153712913
             stat err =       0.000418029855
             autocorr =       1.165088917388
              std dev =       0.547700025734
             le_variance =       0.299975318190

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300028374574
                                         uncertainty =       0.001845884402

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300028374574
                                         uncertainty =       0.001845884402

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387282402
  error estimate for blocks of size 2^( 2) =       0.000397274059
  error estimate for blocks of size 2^( 3) =       0.000406207460
  error estimate for blocks of size 2^( 4) =       0.000413384912
  error estimate for blocks of size 2^( 5) =       0.000418049523
  error estimate for blocks of size 2^( 6) =       0.000420608696
  error estimate for blocks of size 2^( 7) =       0.000420076287

      target function =                  N/A
              le_mean =     -17.216835098857
             les_mean =     296.734153712913
             stat err =       0.000418029855
             autocorr =       1.165088917388
              std dev =       0.547700025734
             le_variance =       0.299975318190

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300028374574
                                         uncertainty =       0.001845884402

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300028374574
                                         uncertainty =       0.001845884402

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387282402
  error estimate for blocks of size 2^( 2) =       0.000397274059
  error estimate for blocks of size 2^( 3) =       0.000406207460
  error estimate for blocks of size 2^( 4) =       0.000413384912
  error estimate for blocks of size 2^( 5) =       0.000418049523
  error estimate for blocks of size 2^( 6) =       0.000420608696
  error estimate for blocks of size 2^( 7) =       0.000420076287

      target function =                  N/A
              le_mean =     -17.216835098857
             les_mean =     296.734153712913
             stat err =       0.000418029855
             autocorr =       1.165088917388
              std dev =       0.547700025734
             le_variance =       0.299975318190

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300028374574
                                         uncertainty =       0.001845884402

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300028374574
                                         uncertainty =       0.001845884402

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387282402
  error estimate for blocks of size 2^( 2) =       0.000397274059
  error estimate for blocks of size 2^( 3) =       0.000406207460
  error estimate for blocks of size 2^( 4) =       0.000413384912
  error estimate for blocks of size 2^( 5) =       0.000418049523
  error estimate for blocks of size 2^( 6) =       0.000420608696
  error estimate for blocks of size 2^( 7) =       0.000420076287

      target function =                  N/A
              le_mean =     -17.216835098857
             les_mean =     296.734153712913
             stat err =       0.000418029855
             autocorr =       1.165088917388
              std dev =       0.547700025734
             le_variance =       0.299975318190


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216835098857        initial  <--
     5.8208e+63     5.8208e+64             0.0000e+00       -17.216835098857
     2.3283e+64     2.3283e+65             0.0000e+00       -17.216835098857
     9.3132e+64     9.3132e+65             0.0000e+00       -17.216835098857

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 54.2092
  </log>
  <optVariables href="H2O.s090.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0301e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s091 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s091 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=91  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 91
    time step          = 0.05
    reference energy   = -17.2492
    reference variance = 0.238033
====================================================
  Execution time = 3.7486e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s091
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5271e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1954e-01
  Total weights = 1.956599638e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0832e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303544998850
                                         uncertainty =       0.003296112192

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303544998850
                                         uncertainty =       0.003296112192

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389564629
  error estimate for blocks of size 2^( 2) =       0.000399715230
  error estimate for blocks of size 2^( 3) =       0.000408764004
  error estimate for blocks of size 2^( 4) =       0.000416288473
  error estimate for blocks of size 2^( 5) =       0.000420476793
  error estimate for blocks of size 2^( 6) =       0.000421622501
  error estimate for blocks of size 2^( 7) =       0.000421908099

      target function =                  N/A
              le_mean =     -17.216776072994
             les_mean =     296.736916632196
             stat err =       0.000420073967
             autocorr =       1.162766472769
              std dev =       0.550927581130
             le_variance =       0.303521199650


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721677607299e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+64, overlap shift 5.8208e+65 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216776073051       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216776073051       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.8208e+64 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+65, overlap shift 2.3283e+66 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216776073051       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216776073051       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+65 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+65, overlap shift 9.3132e+66 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216776073051       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216776073051       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+65 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.988305 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8327e+01
  </log>
  <optVariables href="H2O.s091.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 91
    time step          = 0.05
    reference energy   = -17.2133
    reference variance = 0.229707
====================================================
  Execution time = 3.6899e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s091
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1343e-01
  Total weights = 1.9566e+06
  Execution time = 3.3568e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299635659375
                                         uncertainty =       0.002211305084

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299635659375
                                         uncertainty =       0.002211305084

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387106366
  error estimate for blocks of size 2^( 2) =       0.000397180748
  error estimate for blocks of size 2^( 3) =       0.000406850176
  error estimate for blocks of size 2^( 4) =       0.000413933753
  error estimate for blocks of size 2^( 5) =       0.000418906580
  error estimate for blocks of size 2^( 6) =       0.000421773720
  error estimate for blocks of size 2^( 7) =       0.000422600141

      target function =                  N/A
              le_mean =     -17.215790447244
             les_mean =     296.696867453315
             stat err =       0.000419303548
             autocorr =       1.173265898702
              std dev =       0.547451073187
             le_variance =       0.299702677534

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299635659375
                                         uncertainty =       0.002211305084

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299635659375
                                         uncertainty =       0.002211305084

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387106366
  error estimate for blocks of size 2^( 2) =       0.000397180748
  error estimate for blocks of size 2^( 3) =       0.000406850176
  error estimate for blocks of size 2^( 4) =       0.000413933753
  error estimate for blocks of size 2^( 5) =       0.000418906580
  error estimate for blocks of size 2^( 6) =       0.000421773720
  error estimate for blocks of size 2^( 7) =       0.000422600141

      target function =                  N/A
              le_mean =     -17.215790447244
             les_mean =     296.696867453315
             stat err =       0.000419303548
             autocorr =       1.173265898702
              std dev =       0.547451073187
             le_variance =       0.299702677534

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299635659375
                                         uncertainty =       0.002211305084

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299635659375
                                         uncertainty =       0.002211305084

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387106366
  error estimate for blocks of size 2^( 2) =       0.000397180748
  error estimate for blocks of size 2^( 3) =       0.000406850176
  error estimate for blocks of size 2^( 4) =       0.000413933753
  error estimate for blocks of size 2^( 5) =       0.000418906580
  error estimate for blocks of size 2^( 6) =       0.000421773720
  error estimate for blocks of size 2^( 7) =       0.000422600141

      target function =                  N/A
              le_mean =     -17.215790447244
             les_mean =     296.696867453315
             stat err =       0.000419303548
             autocorr =       1.173265898702
              std dev =       0.547451073187
             le_variance =       0.299702677534

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299635659375
                                         uncertainty =       0.002211305084

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299635659375
                                         uncertainty =       0.002211305084

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387106366
  error estimate for blocks of size 2^( 2) =       0.000397180748
  error estimate for blocks of size 2^( 3) =       0.000406850176
  error estimate for blocks of size 2^( 4) =       0.000413933753
  error estimate for blocks of size 2^( 5) =       0.000418906580
  error estimate for blocks of size 2^( 6) =       0.000421773720
  error estimate for blocks of size 2^( 7) =       0.000422600141

      target function =                  N/A
              le_mean =     -17.215790447244
             les_mean =     296.696867453315
             stat err =       0.000419303548
             autocorr =       1.173265898702
              std dev =       0.547451073187
             le_variance =       0.299702677534


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215790447244        initial  <--
     5.8208e+64     5.8208e+65             0.0000e+00       -17.215790447244
     2.3283e+65     2.3283e+66             0.0000e+00       -17.215790447244
     9.3132e+65     9.3132e+66             0.0000e+00       -17.215790447244

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 53.9069
  </log>
  <optVariables href="H2O.s091.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0224e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s092 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s092 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=92  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 92
    time step          = 0.05
    reference energy   = -17.2716
    reference variance = 0.358802
====================================================
  Execution time = 3.7848e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s092
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5281e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1659e-01
  Total weights = 1.956722217e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1020e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300371991040
                                         uncertainty =       0.002419019493

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300371991040
                                         uncertainty =       0.002419019493

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387497154
  error estimate for blocks of size 2^( 2) =       0.000397470353
  error estimate for blocks of size 2^( 3) =       0.000406114864
  error estimate for blocks of size 2^( 4) =       0.000412352143
  error estimate for blocks of size 2^( 5) =       0.000416729755
  error estimate for blocks of size 2^( 6) =       0.000418921061
  error estimate for blocks of size 2^( 7) =       0.000421097740

      target function =                  N/A
              le_mean =     -17.216684431176
             les_mean =     296.730808041924
             stat err =       0.000417275175
             autocorr =       1.159599613562
              std dev =       0.548003730226
             le_variance =       0.300308088341


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721668443118e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+65, overlap shift 5.8208e+66 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216684431242       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216684431242       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.8208e+65 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+66, overlap shift 2.3283e+67 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216684431242       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216684431242       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+66 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+66, overlap shift 9.3132e+67 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216684431242       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216684431242       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+66 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.989511 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8877e+01
  </log>
  <optVariables href="H2O.s092.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 92
    time step          = 0.05
    reference energy   = -17.2456
    reference variance = 0.299166
====================================================
  Execution time = 3.7537e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s092
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1048e-01
  Total weights = 1.9566e+06
  Execution time = 3.3438e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297564124812
                                         uncertainty =       0.002028335530

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297564124812
                                         uncertainty =       0.002028335530

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385713372
  error estimate for blocks of size 2^( 2) =       0.000395863872
  error estimate for blocks of size 2^( 3) =       0.000405207978
  error estimate for blocks of size 2^( 4) =       0.000411611703
  error estimate for blocks of size 2^( 5) =       0.000415828704
  error estimate for blocks of size 2^( 6) =       0.000416389378
  error estimate for blocks of size 2^( 7) =       0.000419430922

      target function =                  N/A
              le_mean =     -17.217074281721
             les_mean =     296.738125141429
             stat err =       0.000415815177
             autocorr =       1.162174337140
              std dev =       0.545481082458
             le_variance =       0.297549611320

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297564124812
                                         uncertainty =       0.002028335530

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297564124812
                                         uncertainty =       0.002028335530

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385713372
  error estimate for blocks of size 2^( 2) =       0.000395863872
  error estimate for blocks of size 2^( 3) =       0.000405207978
  error estimate for blocks of size 2^( 4) =       0.000411611703
  error estimate for blocks of size 2^( 5) =       0.000415828704
  error estimate for blocks of size 2^( 6) =       0.000416389378
  error estimate for blocks of size 2^( 7) =       0.000419430922

      target function =                  N/A
              le_mean =     -17.217074281721
             les_mean =     296.738125141429
             stat err =       0.000415815177
             autocorr =       1.162174337140
              std dev =       0.545481082458
             le_variance =       0.297549611320

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297564124812
                                         uncertainty =       0.002028335530

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297564124812
                                         uncertainty =       0.002028335530

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385713372
  error estimate for blocks of size 2^( 2) =       0.000395863872
  error estimate for blocks of size 2^( 3) =       0.000405207978
  error estimate for blocks of size 2^( 4) =       0.000411611703
  error estimate for blocks of size 2^( 5) =       0.000415828704
  error estimate for blocks of size 2^( 6) =       0.000416389378
  error estimate for blocks of size 2^( 7) =       0.000419430922

      target function =                  N/A
              le_mean =     -17.217074281721
             les_mean =     296.738125141429
             stat err =       0.000415815177
             autocorr =       1.162174337140
              std dev =       0.545481082458
             le_variance =       0.297549611320

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297564124812
                                         uncertainty =       0.002028335530

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297564124812
                                         uncertainty =       0.002028335530

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385713372
  error estimate for blocks of size 2^( 2) =       0.000395863872
  error estimate for blocks of size 2^( 3) =       0.000405207978
  error estimate for blocks of size 2^( 4) =       0.000411611703
  error estimate for blocks of size 2^( 5) =       0.000415828704
  error estimate for blocks of size 2^( 6) =       0.000416389378
  error estimate for blocks of size 2^( 7) =       0.000419430922

      target function =                  N/A
              le_mean =     -17.217074281721
             les_mean =     296.738125141429
             stat err =       0.000415815177
             autocorr =       1.162174337140
              std dev =       0.545481082458
             le_variance =       0.297549611320


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217074281721        initial  <--
     5.8208e+65     5.8208e+66             0.0000e+00       -17.217074281721
     2.3283e+66     2.3283e+67             0.0000e+00       -17.217074281721
     9.3132e+66     9.3132e+67             0.0000e+00       -17.217074281721

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 54.4544
  </log>
  <optVariables href="H2O.s092.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0334e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s093 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s093 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=93  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 93
    time step          = 0.05
    reference energy   = -17.2146
    reference variance = 0.264241
====================================================
  Execution time = 3.7579e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s093
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5259e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1339e-01
  Total weights = 1.956817917e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0970e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298003393373
                                         uncertainty =       0.001593838795

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298003393373
                                         uncertainty =       0.001593838795

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385985103
  error estimate for blocks of size 2^( 2) =       0.000395861411
  error estimate for blocks of size 2^( 3) =       0.000404721034
  error estimate for blocks of size 2^( 4) =       0.000411984072
  error estimate for blocks of size 2^( 5) =       0.000417859546
  error estimate for blocks of size 2^( 6) =       0.000420366545
  error estimate for blocks of size 2^( 7) =       0.000421410317

      target function =                  N/A
              le_mean =     -17.217150368354
             les_mean =     296.743658799152
             stat err =       0.000417905120
             autocorr =       1.172233950629
              std dev =       0.545865368196
             le_variance =       0.297969000195


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721715036835e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+66, overlap shift 5.8208e+67 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217150368417       residual = 2.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217150368417       residual = 2.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.8208e+66 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+67, overlap shift 2.3283e+68 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217150368417       residual = 2.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217150368417       residual = 2.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+67 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+67, overlap shift 9.3132e+68 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217150368417       residual = 2.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217150368417       residual = 2.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+67 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.990694 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8558e+01
  </log>
  <optVariables href="H2O.s093.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 93
    time step          = 0.05
    reference energy   = -17.1306
    reference variance = 0.906417
====================================================
  Execution time = 3.7607e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s093
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1727e-01
  Total weights = 1.9569e+06
  Execution time = 3.3578e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303027618060
                                         uncertainty =       0.002315542243

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303027618060
                                         uncertainty =       0.002315542243

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389387952
  error estimate for blocks of size 2^( 2) =       0.000399704299
  error estimate for blocks of size 2^( 3) =       0.000409203512
  error estimate for blocks of size 2^( 4) =       0.000416047740
  error estimate for blocks of size 2^( 5) =       0.000419866925
  error estimate for blocks of size 2^( 6) =       0.000421380374
  error estimate for blocks of size 2^( 7) =       0.000424060449

      target function =                  N/A
              le_mean =     -17.216310617855
             les_mean =     296.718619958556
             stat err =       0.000420338872
             autocorr =       1.165290187655
              std dev =       0.550677722437
             le_variance =       0.303245953989

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303027618060
                                         uncertainty =       0.002315542243

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303027618060
                                         uncertainty =       0.002315542243

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389387952
  error estimate for blocks of size 2^( 2) =       0.000399704299
  error estimate for blocks of size 2^( 3) =       0.000409203512
  error estimate for blocks of size 2^( 4) =       0.000416047740
  error estimate for blocks of size 2^( 5) =       0.000419866925
  error estimate for blocks of size 2^( 6) =       0.000421380374
  error estimate for blocks of size 2^( 7) =       0.000424060449

      target function =                  N/A
              le_mean =     -17.216310617855
             les_mean =     296.718619958556
             stat err =       0.000420338872
             autocorr =       1.165290187655
              std dev =       0.550677722437
             le_variance =       0.303245953989

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303027618060
                                         uncertainty =       0.002315542243

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303027618060
                                         uncertainty =       0.002315542243

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389387952
  error estimate for blocks of size 2^( 2) =       0.000399704299
  error estimate for blocks of size 2^( 3) =       0.000409203512
  error estimate for blocks of size 2^( 4) =       0.000416047740
  error estimate for blocks of size 2^( 5) =       0.000419866925
  error estimate for blocks of size 2^( 6) =       0.000421380374
  error estimate for blocks of size 2^( 7) =       0.000424060449

      target function =                  N/A
              le_mean =     -17.216310617855
             les_mean =     296.718619958556
             stat err =       0.000420338872
             autocorr =       1.165290187655
              std dev =       0.550677722437
             le_variance =       0.303245953989

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303027618060
                                         uncertainty =       0.002315542243

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303027618060
                                         uncertainty =       0.002315542243

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389387952
  error estimate for blocks of size 2^( 2) =       0.000399704299
  error estimate for blocks of size 2^( 3) =       0.000409203512
  error estimate for blocks of size 2^( 4) =       0.000416047740
  error estimate for blocks of size 2^( 5) =       0.000419866925
  error estimate for blocks of size 2^( 6) =       0.000421380374
  error estimate for blocks of size 2^( 7) =       0.000424060449

      target function =                  N/A
              le_mean =     -17.216310617855
             les_mean =     296.718619958556
             stat err =       0.000420338872
             autocorr =       1.165290187655
              std dev =       0.550677722437
             le_variance =       0.303245953989


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216310617855        initial  <--
     5.8208e+66     5.8208e+67             0.0000e+00       -17.216310617855
     2.3283e+67     2.3283e+68             0.0000e+00       -17.216310617855
     9.3132e+67     9.3132e+68             0.0000e+00       -17.216310617855

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 54.5677
  </log>
  <optVariables href="H2O.s093.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0313e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s094 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s094 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=94  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 94
    time step          = 0.05
    reference energy   = -17.2443
    reference variance = 0.146502
====================================================
  Execution time = 3.7484e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s094
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5267e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1120e-01
  Total weights = 1.956761017e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1178e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297897561683
                                         uncertainty =       0.001799331796

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297897561683
                                         uncertainty =       0.001799331796

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385898802
  error estimate for blocks of size 2^( 2) =       0.000396030206
  error estimate for blocks of size 2^( 3) =       0.000405462509
  error estimate for blocks of size 2^( 4) =       0.000412648858
  error estimate for blocks of size 2^( 5) =       0.000417797414
  error estimate for blocks of size 2^( 6) =       0.000420053367
  error estimate for blocks of size 2^( 7) =       0.000420477222

      target function =                  N/A
              le_mean =     -17.216722174881
             les_mean =     296.726725104400
             stat err =       0.000417744215
             autocorr =       1.171855410672
              std dev =       0.545743318901
             le_variance =       0.297835770125


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721672217488e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+67, overlap shift 5.8208e+68 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216722174915       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216722174915       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.8208e+67 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+68, overlap shift 2.3283e+69 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216722174915       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216722174915       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+68 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+68, overlap shift 9.3132e+69 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216722174915       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216722174915       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+68 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.991923 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8672e+01
  </log>
  <optVariables href="H2O.s094.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 94
    time step          = 0.05
    reference energy   = -17.2965
    reference variance = 0.239474
====================================================
  Execution time = 3.7258e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s094
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1130e-01
  Total weights = 1.9565e+06
  Execution time = 3.3649e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297171380755
                                         uncertainty =       0.002422718648

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297171380755
                                         uncertainty =       0.002422718648

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385456363
  error estimate for blocks of size 2^( 2) =       0.000395768796
  error estimate for blocks of size 2^( 3) =       0.000405356817
  error estimate for blocks of size 2^( 4) =       0.000412041859
  error estimate for blocks of size 2^( 5) =       0.000417318426
  error estimate for blocks of size 2^( 6) =       0.000419389904
  error estimate for blocks of size 2^( 7) =       0.000422759823

      target function =                  N/A
              le_mean =     -17.217086706088
             les_mean =     296.739376371445
             stat err =       0.000417877503
             autocorr =       1.175296776009
              std dev =       0.545117615827
             le_variance =       0.297153215085

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297171380755
                                         uncertainty =       0.002422718648

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297171380755
                                         uncertainty =       0.002422718648

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385456363
  error estimate for blocks of size 2^( 2) =       0.000395768796
  error estimate for blocks of size 2^( 3) =       0.000405356817
  error estimate for blocks of size 2^( 4) =       0.000412041859
  error estimate for blocks of size 2^( 5) =       0.000417318426
  error estimate for blocks of size 2^( 6) =       0.000419389904
  error estimate for blocks of size 2^( 7) =       0.000422759823

      target function =                  N/A
              le_mean =     -17.217086706088
             les_mean =     296.739376371445
             stat err =       0.000417877503
             autocorr =       1.175296776009
              std dev =       0.545117615827
             le_variance =       0.297153215085

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297171380755
                                         uncertainty =       0.002422718648

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297171380755
                                         uncertainty =       0.002422718648

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385456363
  error estimate for blocks of size 2^( 2) =       0.000395768796
  error estimate for blocks of size 2^( 3) =       0.000405356817
  error estimate for blocks of size 2^( 4) =       0.000412041859
  error estimate for blocks of size 2^( 5) =       0.000417318426
  error estimate for blocks of size 2^( 6) =       0.000419389904
  error estimate for blocks of size 2^( 7) =       0.000422759823

      target function =                  N/A
              le_mean =     -17.217086706088
             les_mean =     296.739376371445
             stat err =       0.000417877503
             autocorr =       1.175296776009
              std dev =       0.545117615827
             le_variance =       0.297153215085

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297171380755
                                         uncertainty =       0.002422718648

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297171380755
                                         uncertainty =       0.002422718648

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385456363
  error estimate for blocks of size 2^( 2) =       0.000395768796
  error estimate for blocks of size 2^( 3) =       0.000405356817
  error estimate for blocks of size 2^( 4) =       0.000412041859
  error estimate for blocks of size 2^( 5) =       0.000417318426
  error estimate for blocks of size 2^( 6) =       0.000419389904
  error estimate for blocks of size 2^( 7) =       0.000422759823

      target function =                  N/A
              le_mean =     -17.217086706088
             les_mean =     296.739376371445
             stat err =       0.000417877503
             autocorr =       1.175296776009
              std dev =       0.545117615827
             le_variance =       0.297153215085


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217086706088        initial  <--
     5.8208e+67     5.8208e+68             0.0000e+00       -17.217086706088
     2.3283e+68     2.3283e+69             0.0000e+00       -17.217086706088
     9.3132e+68     9.3132e+69             0.0000e+00       -17.217086706088

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 54.2667
  </log>
  <optVariables href="H2O.s094.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0294e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s095 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s095 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=95  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 95
    time step          = 0.05
    reference energy   = -17.1855
    reference variance = 0.234601
====================================================
  Execution time = 3.7589e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s095
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5265e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1606e-01
  Total weights = 1.956591618e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1019e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300024974357
                                         uncertainty =       0.002790069620

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300024974357
                                         uncertainty =       0.002790069620

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387304378
  error estimate for blocks of size 2^( 2) =       0.000397509796
  error estimate for blocks of size 2^( 3) =       0.000406345601
  error estimate for blocks of size 2^( 4) =       0.000413315181
  error estimate for blocks of size 2^( 5) =       0.000416805786
  error estimate for blocks of size 2^( 6) =       0.000420303538
  error estimate for blocks of size 2^( 7) =       0.000420650743

      target function =                  N/A
              le_mean =     -17.216531025295
             les_mean =     296.725001107052
             stat err =       0.000417768812
             autocorr =       1.163502225745
              std dev =       0.547731104177
             le_variance =       0.300009362483


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721653102530e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+68, overlap shift 5.8208e+69 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216531025357       residual = 1.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216531025357       residual = 2.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.8208e+68 is 5.633015e-73

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+69, overlap shift 2.3283e+70 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216531025357       residual = 1.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216531025357       residual = 2.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216531025357       residual = 3.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+69 is 1.449872e-73

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+69, overlap shift 9.3132e+70 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216531025357       residual = 1.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216531025357       residual = 2.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216531025357       residual = 3.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+69 is 3.624680e-74

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.993289 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8618e+01
  </log>
  <optVariables href="H2O.s095.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 95
    time step          = 0.05
    reference energy   = -17.1415
    reference variance = 0.192401
====================================================
  Execution time = 3.7054e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s095
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1155e-01
  Total weights = 1.9567e+06
  Execution time = 3.3564e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298075428300
                                         uncertainty =       0.001832921331

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298075428300
                                         uncertainty =       0.001832921331

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386096168
  error estimate for blocks of size 2^( 2) =       0.000396108789
  error estimate for blocks of size 2^( 3) =       0.000405226914
  error estimate for blocks of size 2^( 4) =       0.000411764162
  error estimate for blocks of size 2^( 5) =       0.000417225626
  error estimate for blocks of size 2^( 6) =       0.000417984527
  error estimate for blocks of size 2^( 7) =       0.000420456668

      target function =                  N/A
              le_mean =     -17.217177278104
             les_mean =     296.742746047536
             stat err =       0.000416857745
             autocorr =       1.165694557962
              std dev =       0.546022436656
             le_variance =       0.298140501332

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298075428300
                                         uncertainty =       0.001832921331

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298075428300
                                         uncertainty =       0.001832921331

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386096168
  error estimate for blocks of size 2^( 2) =       0.000396108789
  error estimate for blocks of size 2^( 3) =       0.000405226914
  error estimate for blocks of size 2^( 4) =       0.000411764162
  error estimate for blocks of size 2^( 5) =       0.000417225626
  error estimate for blocks of size 2^( 6) =       0.000417984527
  error estimate for blocks of size 2^( 7) =       0.000420456668

      target function =                  N/A
              le_mean =     -17.217177278104
             les_mean =     296.742746047536
             stat err =       0.000416857745
             autocorr =       1.165694557962
              std dev =       0.546022436656
             le_variance =       0.298140501332

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298075428300
                                         uncertainty =       0.001832921331

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298075428300
                                         uncertainty =       0.001832921331

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386096168
  error estimate for blocks of size 2^( 2) =       0.000396108789
  error estimate for blocks of size 2^( 3) =       0.000405226914
  error estimate for blocks of size 2^( 4) =       0.000411764162
  error estimate for blocks of size 2^( 5) =       0.000417225626
  error estimate for blocks of size 2^( 6) =       0.000417984527
  error estimate for blocks of size 2^( 7) =       0.000420456668

      target function =                  N/A
              le_mean =     -17.217177278104
             les_mean =     296.742746047536
             stat err =       0.000416857745
             autocorr =       1.165694557962
              std dev =       0.546022436656
             le_variance =       0.298140501332

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298075428300
                                         uncertainty =       0.001832921331

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298075428300
                                         uncertainty =       0.001832921331

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386096168
  error estimate for blocks of size 2^( 2) =       0.000396108789
  error estimate for blocks of size 2^( 3) =       0.000405226914
  error estimate for blocks of size 2^( 4) =       0.000411764162
  error estimate for blocks of size 2^( 5) =       0.000417225626
  error estimate for blocks of size 2^( 6) =       0.000417984527
  error estimate for blocks of size 2^( 7) =       0.000420456668

      target function =                  N/A
              le_mean =     -17.217177278104
             les_mean =     296.742746047536
             stat err =       0.000416857745
             autocorr =       1.165694557962
              std dev =       0.546022436656
             le_variance =       0.298140501332


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217177278104        initial  <--
     5.8208e+68     5.8208e+69             5.6330e-73       -17.217177278104
     2.3283e+69     2.3283e+70             1.4499e-73       -17.217177278104
     9.3132e+69     9.3132e+70             3.6247e-74       -17.217177278104

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 54.0637
  </log>
  <optVariables href="H2O.s095.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0269e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s096 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s096 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=96  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 96
    time step          = 0.05
    reference energy   = -17.2353
    reference variance = 0.211858
====================================================
  Execution time = 3.7551e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s096
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5285e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1635e-01
  Total weights = 1.956732317e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0876e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301744678159
                                         uncertainty =       0.001678580146

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301744678159
                                         uncertainty =       0.001678580146

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388485842
  error estimate for blocks of size 2^( 2) =       0.000398659026
  error estimate for blocks of size 2^( 3) =       0.000407658536
  error estimate for blocks of size 2^( 4) =       0.000414357311
  error estimate for blocks of size 2^( 5) =       0.000418102554
  error estimate for blocks of size 2^( 6) =       0.000420428305
  error estimate for blocks of size 2^( 7) =       0.000421118079

      target function =                  N/A
              le_mean =     -17.217114414542
             les_mean =     296.745381119680
             stat err =       0.000418501562
             autocorr =       1.160496338297
              std dev =       0.549401947163
             le_variance =       0.301842499547


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721711441454e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+69, overlap shift 5.8208e+70 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217114414573       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217114414573       residual = 5.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217114414573       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.8208e+69 is 5.580535e-74

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+70, overlap shift 2.3283e+71 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217114414573       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217114414573       residual = 5.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217114414573       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+70 is 1.395134e-74

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+70, overlap shift 9.3132e+71 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217114414573       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217114414573       residual = 5.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217114414573       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+70 is 3.487834e-75

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.994780 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8437e+01
  </log>
  <optVariables href="H2O.s096.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 96
    time step          = 0.05
    reference energy   = -17.2005
    reference variance = 0.201338
====================================================
  Execution time = 3.7167e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s096
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0366e-01
  Total weights = 1.9565e+06
  Execution time = 3.3686e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292372691706
                                         uncertainty =       0.001324041067

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292372691706
                                         uncertainty =       0.001324041067

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382293378
  error estimate for blocks of size 2^( 2) =       0.000392448858
  error estimate for blocks of size 2^( 3) =       0.000401255111
  error estimate for blocks of size 2^( 4) =       0.000407926708
  error estimate for blocks of size 2^( 5) =       0.000411812075
  error estimate for blocks of size 2^( 6) =       0.000414470149
  error estimate for blocks of size 2^( 7) =       0.000414251838

      target function =                  N/A
              le_mean =     -17.216017415789
             les_mean =     296.694919834034
             stat err =       0.000412115193
             autocorr =       1.162100530142
              std dev =       0.540644480241
             le_variance =       0.292296454015

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292372691706
                                         uncertainty =       0.001324041067

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292372691706
                                         uncertainty =       0.001324041067

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382293378
  error estimate for blocks of size 2^( 2) =       0.000392448858
  error estimate for blocks of size 2^( 3) =       0.000401255111
  error estimate for blocks of size 2^( 4) =       0.000407926708
  error estimate for blocks of size 2^( 5) =       0.000411812075
  error estimate for blocks of size 2^( 6) =       0.000414470149
  error estimate for blocks of size 2^( 7) =       0.000414251838

      target function =                  N/A
              le_mean =     -17.216017415789
             les_mean =     296.694919834034
             stat err =       0.000412115193
             autocorr =       1.162100530142
              std dev =       0.540644480241
             le_variance =       0.292296454015

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292372691706
                                         uncertainty =       0.001324041067

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292372691706
                                         uncertainty =       0.001324041067

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382293378
  error estimate for blocks of size 2^( 2) =       0.000392448858
  error estimate for blocks of size 2^( 3) =       0.000401255111
  error estimate for blocks of size 2^( 4) =       0.000407926708
  error estimate for blocks of size 2^( 5) =       0.000411812075
  error estimate for blocks of size 2^( 6) =       0.000414470149
  error estimate for blocks of size 2^( 7) =       0.000414251838

      target function =                  N/A
              le_mean =     -17.216017415789
             les_mean =     296.694919834034
             stat err =       0.000412115193
             autocorr =       1.162100530142
              std dev =       0.540644480241
             le_variance =       0.292296454015

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292372691706
                                         uncertainty =       0.001324041067

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292372691706
                                         uncertainty =       0.001324041067

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382293378
  error estimate for blocks of size 2^( 2) =       0.000392448858
  error estimate for blocks of size 2^( 3) =       0.000401255111
  error estimate for blocks of size 2^( 4) =       0.000407926708
  error estimate for blocks of size 2^( 5) =       0.000411812075
  error estimate for blocks of size 2^( 6) =       0.000414470149
  error estimate for blocks of size 2^( 7) =       0.000414251838

      target function =                  N/A
              le_mean =     -17.216017415789
             les_mean =     296.694919834034
             stat err =       0.000412115193
             autocorr =       1.162100530142
              std dev =       0.540644480241
             le_variance =       0.292296454015


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216017415789        initial  <--
     5.8208e+69     5.8208e+70             5.5805e-74       -17.216017415789
     2.3283e+70     2.3283e+71             1.3951e-74       -17.216017415789
     9.3132e+70     9.3132e+71             3.4878e-75       -17.216017415789

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 54.1966
  </log>
  <optVariables href="H2O.s096.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0264e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s097 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s097 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=97  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 97
    time step          = 0.05
    reference energy   = -17.1487
    reference variance = 0.26112
====================================================
  Execution time = 3.7373e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s097
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5289e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.0910e-01
  Total weights = 1.956407866e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.0945e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297929971804
                                         uncertainty =       0.002146664517

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297929971804
                                         uncertainty =       0.002146664517

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385884594
  error estimate for blocks of size 2^( 2) =       0.000395970795
  error estimate for blocks of size 2^( 3) =       0.000405093434
  error estimate for blocks of size 2^( 4) =       0.000412003768
  error estimate for blocks of size 2^( 5) =       0.000415708595
  error estimate for blocks of size 2^( 6) =       0.000417890158
  error estimate for blocks of size 2^( 7) =       0.000418677399

      target function =                  N/A
              le_mean =     -17.216655072749
             les_mean =     296.722311159222
             stat err =       0.000416069980
             autocorr =       1.162566712110
              std dev =       0.545723226254
             le_variance =       0.297813839673


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721665507275e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+70, overlap shift 5.8208e+71 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216655072813       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216655072813       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.8208e+70 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+71, overlap shift 2.3283e+72 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216655072813       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216655072813       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+71 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+71, overlap shift 9.3132e+72 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216655072813       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216655072813       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+71 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.995996 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8328e+01
  </log>
  <optVariables href="H2O.s097.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 97
    time step          = 0.05
    reference energy   = -17.2225
    reference variance = 0.168297
====================================================
  Execution time = 3.7509e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s097
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.1741e-01
  Total weights = 1.9571e+06
  Execution time = 3.3495e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297863646116
                                         uncertainty =       0.002232272246

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297863646116
                                         uncertainty =       0.002232272246

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385895008
  error estimate for blocks of size 2^( 2) =       0.000396180606
  error estimate for blocks of size 2^( 3) =       0.000405337121
  error estimate for blocks of size 2^( 4) =       0.000412403114
  error estimate for blocks of size 2^( 5) =       0.000417545097
  error estimate for blocks of size 2^( 6) =       0.000419341901
  error estimate for blocks of size 2^( 7) =       0.000419504096

      target function =                  N/A
              le_mean =     -17.217996758036
             les_mean =     296.776818964023
             stat err =       0.000417198552
             autocorr =       1.168819002806
              std dev =       0.545737953943
             le_variance =       0.297829914374

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297863646116
                                         uncertainty =       0.002232272246

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297863646116
                                         uncertainty =       0.002232272246

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385895008
  error estimate for blocks of size 2^( 2) =       0.000396180606
  error estimate for blocks of size 2^( 3) =       0.000405337121
  error estimate for blocks of size 2^( 4) =       0.000412403114
  error estimate for blocks of size 2^( 5) =       0.000417545097
  error estimate for blocks of size 2^( 6) =       0.000419341901
  error estimate for blocks of size 2^( 7) =       0.000419504096

      target function =                  N/A
              le_mean =     -17.217996758036
             les_mean =     296.776818964023
             stat err =       0.000417198552
             autocorr =       1.168819002806
              std dev =       0.545737953943
             le_variance =       0.297829914374

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297863646116
                                         uncertainty =       0.002232272246

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297863646116
                                         uncertainty =       0.002232272246

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385895008
  error estimate for blocks of size 2^( 2) =       0.000396180606
  error estimate for blocks of size 2^( 3) =       0.000405337121
  error estimate for blocks of size 2^( 4) =       0.000412403114
  error estimate for blocks of size 2^( 5) =       0.000417545097
  error estimate for blocks of size 2^( 6) =       0.000419341901
  error estimate for blocks of size 2^( 7) =       0.000419504096

      target function =                  N/A
              le_mean =     -17.217996758036
             les_mean =     296.776818964023
             stat err =       0.000417198552
             autocorr =       1.168819002806
              std dev =       0.545737953943
             le_variance =       0.297829914374

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297863646116
                                         uncertainty =       0.002232272246

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297863646116
                                         uncertainty =       0.002232272246

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385895008
  error estimate for blocks of size 2^( 2) =       0.000396180606
  error estimate for blocks of size 2^( 3) =       0.000405337121
  error estimate for blocks of size 2^( 4) =       0.000412403114
  error estimate for blocks of size 2^( 5) =       0.000417545097
  error estimate for blocks of size 2^( 6) =       0.000419341901
  error estimate for blocks of size 2^( 7) =       0.000419504096

      target function =                  N/A
              le_mean =     -17.217996758036
             les_mean =     296.776818964023
             stat err =       0.000417198552
             autocorr =       1.168819002806
              std dev =       0.545737953943
             le_variance =       0.297829914374


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217996758036        initial  <--
     5.8208e+70     5.8208e+71             0.0000e+00       -17.217996758036
     2.3283e+71     2.3283e+72             0.0000e+00       -17.217996758036
     9.3132e+71     9.3132e+72             0.0000e+00       -17.217996758036

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 54.4746
  </log>
  <optVariables href="H2O.s097.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0281e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s098 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s098 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=98  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 98
    time step          = 0.05
    reference energy   = -17.2146
    reference variance = 0.364413
====================================================
  Execution time = 3.8122e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s098
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5276e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1039e-01
  Total weights = 1.956725940e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1141e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297061798876
                                         uncertainty =       0.001973291027

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297061798876
                                         uncertainty =       0.001973291027

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385397923
  error estimate for blocks of size 2^( 2) =       0.000395687061
  error estimate for blocks of size 2^( 3) =       0.000404189116
  error estimate for blocks of size 2^( 4) =       0.000410681828
  error estimate for blocks of size 2^( 5) =       0.000415862624
  error estimate for blocks of size 2^( 6) =       0.000417662590
  error estimate for blocks of size 2^( 7) =       0.000418064397

      target function =                  N/A
              le_mean =     -17.216920525620
             les_mean =     296.732743792877
             stat err =       0.000415567860
             autocorr =       1.162693283482
              std dev =       0.545034969485
             le_variance =       0.297063117962


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721692052562e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+71, overlap shift 5.8208e+72 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216920525712       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216920525712       residual = 4.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216920525712       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.8208e+71 is 6.031856e-76

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+72, overlap shift 2.3283e+73 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216920525712       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216920525712       residual = 4.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216920525712       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+72 is 1.507964e-76

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+72, overlap shift 9.3132e+73 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216920525712       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216920525712       residual = 4.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216920525712       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+72 is 3.769910e-77

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.997474 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.9273e+01
  </log>
  <optVariables href="H2O.s098.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 98
    time step          = 0.05
    reference energy   = -17.2606
    reference variance = 0.499359
====================================================
  Execution time = 3.7401e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s098
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.0858e-01
  Total weights = 1.9567e+06
  Execution time = 3.3427e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296138114207
                                         uncertainty =       0.001765696498

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296138114207
                                         uncertainty =       0.001765696498

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384866781
  error estimate for blocks of size 2^( 2) =       0.000394651746
  error estimate for blocks of size 2^( 3) =       0.000403598533
  error estimate for blocks of size 2^( 4) =       0.000410245371
  error estimate for blocks of size 2^( 5) =       0.000414213351
  error estimate for blocks of size 2^( 6) =       0.000416995549
  error estimate for blocks of size 2^( 7) =       0.000418953191

      target function =                  N/A
              le_mean =     -17.216538042570
             les_mean =     296.717765318939
             stat err =       0.000415101865
             autocorr =       1.163291390077
              std dev =       0.544283822024
             le_variance =       0.296244878918

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296138114207
                                         uncertainty =       0.001765696498

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296138114207
                                         uncertainty =       0.001765696498

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384866781
  error estimate for blocks of size 2^( 2) =       0.000394651746
  error estimate for blocks of size 2^( 3) =       0.000403598533
  error estimate for blocks of size 2^( 4) =       0.000410245371
  error estimate for blocks of size 2^( 5) =       0.000414213351
  error estimate for blocks of size 2^( 6) =       0.000416995549
  error estimate for blocks of size 2^( 7) =       0.000418953191

      target function =                  N/A
              le_mean =     -17.216538042570
             les_mean =     296.717765318939
             stat err =       0.000415101865
             autocorr =       1.163291390077
              std dev =       0.544283822024
             le_variance =       0.296244878918

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296138114207
                                         uncertainty =       0.001765696498

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296138114207
                                         uncertainty =       0.001765696498

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384866781
  error estimate for blocks of size 2^( 2) =       0.000394651746
  error estimate for blocks of size 2^( 3) =       0.000403598533
  error estimate for blocks of size 2^( 4) =       0.000410245371
  error estimate for blocks of size 2^( 5) =       0.000414213351
  error estimate for blocks of size 2^( 6) =       0.000416995549
  error estimate for blocks of size 2^( 7) =       0.000418953191

      target function =                  N/A
              le_mean =     -17.216538042570
             les_mean =     296.717765318939
             stat err =       0.000415101865
             autocorr =       1.163291390077
              std dev =       0.544283822024
             le_variance =       0.296244878918

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296138114207
                                         uncertainty =       0.001765696498

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296138114207
                                         uncertainty =       0.001765696498

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384866781
  error estimate for blocks of size 2^( 2) =       0.000394651746
  error estimate for blocks of size 2^( 3) =       0.000403598533
  error estimate for blocks of size 2^( 4) =       0.000410245371
  error estimate for blocks of size 2^( 5) =       0.000414213351
  error estimate for blocks of size 2^( 6) =       0.000416995549
  error estimate for blocks of size 2^( 7) =       0.000418953191

      target function =                  N/A
              le_mean =     -17.216538042570
             les_mean =     296.717765318939
             stat err =       0.000415101865
             autocorr =       1.163291390077
              std dev =       0.544283822024
             le_variance =       0.296244878918


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216538042570        initial  <--
     5.8208e+71     5.8208e+72             6.0319e-76       -17.216538042570
     2.3283e+72     2.3283e+73             1.5080e-76       -17.216538042570
     9.3132e+72     9.3132e+73             3.7699e-77       -17.216538042570

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 54.3705
  </log>
  <optVariables href="H2O.s098.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0365e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s099 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s099 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=99  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 99
    time step          = 0.05
    reference energy   = -17.2828
    reference variance = 0.318207
====================================================
  Execution time = 3.7514e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s099
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5282e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1023e-01
  Total weights = 1.956543100e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.1119e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297610891546
                                         uncertainty =       0.001900393365

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297610891546
                                         uncertainty =       0.001900393365

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385758648
  error estimate for blocks of size 2^( 2) =       0.000396139177
  error estimate for blocks of size 2^( 3) =       0.000405029806
  error estimate for blocks of size 2^( 4) =       0.000412438614
  error estimate for blocks of size 2^( 5) =       0.000416143389
  error estimate for blocks of size 2^( 6) =       0.000417831199
  error estimate for blocks of size 2^( 7) =       0.000416843940

      target function =                  N/A
              le_mean =     -17.216287174335
             les_mean =     296.710769402427
             stat err =       0.000415814286
             autocorr =       1.161896570859
              std dev =       0.545545111868
             le_variance =       0.297619469083


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721628717434e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+72, overlap shift 5.8208e+73 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216287174403       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216287174403       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 5.8208e+72 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+73, overlap shift 2.3283e+74 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216287174403       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216287174403       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.3283e+73 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+73, overlap shift 9.3132e+74 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216287174403       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216287174403       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.3132e+73 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.999435 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.8644e+01
  </log>
  <optVariables href="H2O.s099.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 99
    time step          = 0.05
    reference energy   = -17.2036
    reference variance = 0.259076
====================================================
  Execution time = 3.7778e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s099
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1076e-01
  Total weights = 1.9566e+06
  Execution time = 3.3496e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295594422161
                                         uncertainty =       0.001792756696

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295594422161
                                         uncertainty =       0.001792756696

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384487249
  error estimate for blocks of size 2^( 2) =       0.000394853051
  error estimate for blocks of size 2^( 3) =       0.000404613308
  error estimate for blocks of size 2^( 4) =       0.000411757792
  error estimate for blocks of size 2^( 5) =       0.000416130367
  error estimate for blocks of size 2^( 6) =       0.000418097290
  error estimate for blocks of size 2^( 7) =       0.000420191144

      target function =                  N/A
              le_mean =     -17.216719606032
             les_mean =     296.726197740396
             stat err =       0.000416544148
             autocorr =       1.173702939810
              std dev =       0.543747081952
             le_variance =       0.295660889132

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295594422161
                                         uncertainty =       0.001792756696

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295594422161
                                         uncertainty =       0.001792756696

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384487249
  error estimate for blocks of size 2^( 2) =       0.000394853051
  error estimate for blocks of size 2^( 3) =       0.000404613308
  error estimate for blocks of size 2^( 4) =       0.000411757792
  error estimate for blocks of size 2^( 5) =       0.000416130367
  error estimate for blocks of size 2^( 6) =       0.000418097290
  error estimate for blocks of size 2^( 7) =       0.000420191144

      target function =                  N/A
              le_mean =     -17.216719606032
             les_mean =     296.726197740396
             stat err =       0.000416544148
             autocorr =       1.173702939810
              std dev =       0.543747081952
             le_variance =       0.295660889132

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295594422161
                                         uncertainty =       0.001792756696

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295594422161
                                         uncertainty =       0.001792756696

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384487249
  error estimate for blocks of size 2^( 2) =       0.000394853051
  error estimate for blocks of size 2^( 3) =       0.000404613308
  error estimate for blocks of size 2^( 4) =       0.000411757792
  error estimate for blocks of size 2^( 5) =       0.000416130367
  error estimate for blocks of size 2^( 6) =       0.000418097290
  error estimate for blocks of size 2^( 7) =       0.000420191144

      target function =                  N/A
              le_mean =     -17.216719606032
             les_mean =     296.726197740396
             stat err =       0.000416544148
             autocorr =       1.173702939810
              std dev =       0.543747081952
             le_variance =       0.295660889132

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295594422161
                                         uncertainty =       0.001792756696

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295594422161
                                         uncertainty =       0.001792756696

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384487249
  error estimate for blocks of size 2^( 2) =       0.000394853051
  error estimate for blocks of size 2^( 3) =       0.000404613308
  error estimate for blocks of size 2^( 4) =       0.000411757792
  error estimate for blocks of size 2^( 5) =       0.000416130367
  error estimate for blocks of size 2^( 6) =       0.000418097290
  error estimate for blocks of size 2^( 7) =       0.000420191144

      target function =                  N/A
              le_mean =     -17.216719606032
             les_mean =     296.726197740396
             stat err =       0.000416544148
             autocorr =       1.173702939810
              std dev =       0.543747081952
             le_variance =       0.295660889132


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216719606032        initial  <--
     5.8208e+72     5.8208e+73             0.0000e+00       -17.216719606032
     2.3283e+73     2.3283e+74             0.0000e+00       -17.216719606032
     9.3132e+73     9.3132e+74             0.0000e+00       -17.216719606032

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 54.7340
  </log>
  <optVariables href="H2O.s099.opt.xml">
  uu_0                 2.061949e-01 1 1  ON 0
  uu_1                 4.539117e-02 1 1  ON 1
  uu_2                -4.680481e-02 1 1  ON 2
  uu_3                -9.936272e-02 1 1  ON 3
  uu_4                -1.304449e-01 1 1  ON 4
  uu_5                -1.356413e-01 1 1  ON 5
  uu_6                -1.130357e-01 1 1  ON 6
  uu_7                -3.972344e-02 1 1  ON 7
  uu_8                 9.988696e-02 1 1  ON 8
  uu_9                 1.208933e-01 1 1  ON 9
  ud_0                 3.495801e-01 1 1  ON 10
  ud_1                 9.178565e-02 1 1  ON 11
  ud_2                -1.648758e-02 1 1  ON 12
  ud_3                -7.596335e-02 1 1  ON 13
  ud_4                -1.217524e-01 1 1  ON 14
  ud_5                -1.523214e-01 1 1  ON 15
  ud_6                -1.544624e-01 1 1  ON 16
  ud_7                -1.100034e-01 1 1  ON 17
  ud_8                 4.463187e-03 1 1  ON 18
  ud_9                 9.258159e-02 1 1  ON 19
  eO_0                -7.504332e-01 1 1  ON 20
  eO_1                -4.354966e-01 1 1  ON 21
  eO_2                -3.598301e-02 1 1  ON 22
  eO_3                 2.081612e-01 1 1  ON 23
  eO_4                 2.891481e-01 1 1  ON 24
  eO_5                 3.052708e-01 1 1  ON 25
  eO_6                 2.501148e-01 1 1  ON 26
  eO_7                 1.121837e-01 1 1  ON 27
  eO_8                 2.793060e-02 1 1  ON 28
  eO_9                 1.846823e-02 1 1  ON 29
 eH1_0                -1.820113e-01 1 1  ON 30
 eH1_1                -1.027126e-01 1 1  ON 31
 eH1_2                -6.202978e-02 1 1  ON 32
 eH1_3                -2.594624e-02 1 1  ON 33
 eH1_4                 1.931583e-02 1 1  ON 34
 eH1_5                 3.552903e-02 1 1  ON 35
 eH1_6                 7.728065e-02 1 1  ON 36
 eH1_7                 1.103061e-01 1 1  ON 37
 eH1_8                 9.073801e-02 1 1  ON 38
 eH1_9                 2.428776e-02 1 1  ON 39
 eH2_0                -1.835289e-01 1 1  ON 40
 eH2_1                -1.038380e-01 1 1  ON 41
 eH2_2                -6.350521e-02 1 1  ON 42
 eH2_3                -2.706107e-02 1 1  ON 43
 eH2_4                 1.856801e-02 1 1  ON 44
 eH2_5                 3.504988e-02 1 1  ON 45
 eH2_6                 7.827831e-02 1 1  ON 46
 eH2_7                 1.134121e-01 1 1  ON 47
 eH2_8                 9.397367e-02 1 1  ON 48
 eH2_9                 2.639279e-02 1 1  ON 49
ci_001                -3.996251e-02 3 1  ON 50
ci_002                -3.016470e-02 3 1  ON 51
ci_003                -2.507292e-02 3 1  ON 52
ci_004                 2.111232e-02 3 1  ON 53
ci_005                 2.113442e-02 3 1  ON 54
ci_006                -1.943373e-02 3 1  ON 55
ci_007                -1.880569e-02 3 1  ON 56
ci_008                -1.774337e-02 3 1  ON 57
ci_009                -1.805528e-02 3 1  ON 58
ci_010                -1.730267e-02 3 1  ON 59
ci_011                -1.626617e-02 3 1  ON 60
ci_012                -1.614701e-02 3 1  ON 61
ci_013                -1.921603e-02 3 1  ON 62
ci_014                 1.385483e-02 3 1  ON 63
ci_015                 1.356487e-02 3 1  ON 64
ci_016                 1.626481e-02 3 1  ON 65
ci_017                 1.653411e-02 3 1  ON 66
ci_018                 1.263030e-02 3 1  ON 67
ci_019                 1.309171e-02 3 1  ON 68
ci_020                 1.328128e-02 3 1  ON 69
ci_021                 1.336533e-02 3 1  ON 70
ci_022                 1.114552e-02 3 1  ON 71
ci_023                 1.122686e-02 3 1  ON 72
ci_024                 1.228163e-02 3 1  ON 73
ci_025                 1.155261e-02 3 1  ON 74
ci_026                 1.090693e-02 3 1  ON 75
ci_027                 1.132471e-02 3 1  ON 76
ci_028                -1.426208e-02 3 1  ON 77
ci_029                -1.490778e-02 3 1  ON 78
ci_030                -1.110705e-02 3 1  ON 79
ci_031                -1.141193e-02 3 1  ON 80
ci_032                -1.348836e-02 3 1  ON 81
ci_033                 1.065831e-02 3 1  ON 82
ci_034                 1.063465e-02 3 1  ON 83
ci_035                -4.704041e-03 3 1  ON 84
ci_036                -1.040363e-02 3 1  ON 85
ci_037                -1.005821e-02 3 1  ON 86
ci_038                 1.872212e-03 3 1  ON 87
ci_039                 1.473333e-03 3 1  ON 88
ci_040                -4.066129e-03 3 1  ON 89
ci_041                 9.803941e-03 3 1  ON 90
ci_042                 9.856503e-03 3 1  ON 91
ci_043                -2.929534e-03 3 1  ON 92
ci_044                -1.514679e-02 3 1  ON 93
ci_045                -1.824958e-03 3 1  ON 94
ci_046                 5.707923e-03 3 1  ON 95
ci_047                 5.452918e-03 3 1  ON 96
ci_048                -1.169098e-02 3 1  ON 97
ci_049                -1.200810e-02 3 1  ON 98
ci_050                 7.412632e-03 3 1  ON 99
ci_051                 7.765616e-03 3 1  ON 100
ci_052                -6.441188e-03 3 1  ON 101
ci_053                -6.307082e-03 3 1  ON 102
ci_054                -3.216822e-03 3 1  ON 103
ci_055                -3.042689e-03 3 1  ON 104
ci_056                 4.495683e-03 3 1  ON 105
ci_057                 4.397754e-03 3 1  ON 106
ci_058                -6.795347e-03 3 1  ON 107
ci_059                -6.377680e-03 3 1  ON 108
ci_060                 8.242621e-03 3 1  ON 109
ci_061                 7.908871e-03 3 1  ON 110
ci_062                -3.256098e-03 3 1  ON 111
ci_063                -2.908159e-03 3 1  ON 112
ci_064                -3.133222e-03 3 1  ON 113
ci_065                -4.350138e-03 3 1  ON 114
ci_066                 5.564963e-03 3 1  ON 115
ci_067                 5.749491e-03 3 1  ON 116
ci_068                -4.597367e-03 3 1  ON 117
ci_069                -4.608457e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.0338e+02 secs
  Total Execution time = 1.0308e+04 secs

=========================================================
  A new xml input file : H2O.s099.cont.xml
