Rank =    0  Free Memory = 87585 MB
Rank =    1  Free Memory = 87585 MB
Rank =    2  Free Memory = 87585 MB
Rank =    3  Free Memory = 87585 MB
Rank =    4  Free Memory = 87584 MB
Rank =    5  Free Memory = 87584 MB
Rank =    6  Free Memory = 87584 MB
Rank =    7  Free Memory = 87584 MB
Rank =    8  Free Memory = 87584 MB
Rank =    9  Free Memory = 87584 MB
Rank =   10  Free Memory = 87583 MB
Rank =   11  Free Memory = 87583 MB
Rank =   12  Free Memory = 87583 MB
Rank =   13  Free Memory = 87583 MB
Rank =   14  Free Memory = 87582 MB
Rank =   15  Free Memory = 87569 MB
Rank =   16  Free Memory = 87569 MB
Rank =   17  Free Memory = 87569 MB
Rank =   18  Free Memory = 87569 MB
Rank =   19  Free Memory = 87569 MB
Rank =   20  Free Memory = 87569 MB
Rank =   21  Free Memory = 87569 MB
Rank =   22  Free Memory = 87569 MB
Rank =   23  Free Memory = 87569 MB
Rank =   24  Free Memory = 87569 MB
Rank =   25  Free Memory = 87569 MB
Rank =   26  Free Memory = 87569 MB
Rank =   27  Free Memory = 87569 MB
Rank =   28  Free Memory = 87569 MB
Rank =   29  Free Memory = 87569 MB
Rank =   30  Free Memory = 87569 MB
Rank =   31  Free Memory = 87569 MB
Rank =   32  Free Memory = 86862 MB
Rank =   33  Free Memory = 86862 MB
Rank =   34  Free Memory = 86862 MB
Rank =   35  Free Memory = 86862 MB
Rank =   36  Free Memory = 86862 MB
Rank =   37  Free Memory = 86862 MB
Rank =   38  Free Memory = 86862 MB
Rank =   39  Free Memory = 86862 MB
Rank =   40  Free Memory = 86862 MB
Rank =   41  Free Memory = 86861 MB
Rank =   42  Free Memory = 86861 MB
Rank =   43  Free Memory = 86861 MB
Rank =   44  Free Memory = 86861 MB
Rank =   45  Free Memory = 86861 MB
Rank =   46  Free Memory = 86861 MB
Rank =   47  Free Memory = 86861 MB
Rank =   48  Free Memory = 86861 MB
Rank =   49  Free Memory = 86861 MB
Rank =   50  Free Memory = 86861 MB
Rank =   51  Free Memory = 86861 MB
Rank =   52  Free Memory = 86861 MB
Rank =   53  Free Memory = 86861 MB
Rank =   54  Free Memory = 86861 MB
Rank =   55  Free Memory = 86861 MB
Rank =   56  Free Memory = 86861 MB
Rank =   57  Free Memory = 86861 MB
Rank =   58  Free Memory = 86861 MB
Rank =   59  Free Memory = 86861 MB
Rank =   60  Free Memory = 86861 MB
Rank =   61  Free Memory = 86861 MB
Rank =   62  Free Memory = 86861 MB
Rank =   63  Free Memory = 86861 MB
Rank =   64  Free Memory = 84756 MB
Rank =   65  Free Memory = 84756 MB
Rank =   66  Free Memory = 84756 MB
Rank =   67  Free Memory = 84755 MB
Rank =   68  Free Memory = 84755 MB
Rank =   69  Free Memory = 84755 MB
Rank =   70  Free Memory = 84755 MB
Rank =   71  Free Memory = 84755 MB
Rank =   72  Free Memory = 84755 MB
Rank =   73  Free Memory = 84755 MB
Rank =   74  Free Memory = 84755 MB
Rank =   75  Free Memory = 84755 MB
Rank =   76  Free Memory = 84755 MB
Rank =   77  Free Memory = 84755 MB
Rank =   78  Free Memory = 84755 MB
Rank =   79  Free Memory = 84755 MB
Rank =   80  Free Memory = 84755 MB
Rank =   81  Free Memory = 84755 MB
Rank =   82  Free Memory = 84755 MB
Rank =   83  Free Memory = 84755 MB
Rank =   84  Free Memory = 84755 MB
Rank =   85  Free Memory = 84755 MB
Rank =   86  Free Memory = 84755 MB
Rank =   87  Free Memory = 84755 MB
Rank =   88  Free Memory = 84755 MB
Rank =   89  Free Memory = 84755 MB
Rank =   90  Free Memory = 84755 MB
Rank =   91  Free Memory = 84755 MB
Rank =   92  Free Memory = 84755 MB
Rank =   93  Free Memory = 84755 MB
Rank =   94  Free Memory = 84755 MB
Rank =   95  Free Memory = 84755 MB
Rank =   96  Free Memory = 89603 MB
Rank =   97  Free Memory = 89603 MB
Rank =   98  Free Memory = 89603 MB
Rank =   99  Free Memory = 89603 MB
Rank =  100  Free Memory = 89603 MB
Rank =  101  Free Memory = 89603 MB
Rank =  102  Free Memory = 89603 MB
Rank =  103  Free Memory = 89603 MB
Rank =  104  Free Memory = 89603 MB
Rank =  105  Free Memory = 89603 MB
Rank =  106  Free Memory = 89603 MB
Rank =  107  Free Memory = 89603 MB
Rank =  108  Free Memory = 89603 MB
Rank =  109  Free Memory = 89603 MB
Rank =  110  Free Memory = 89603 MB
Rank =  111  Free Memory = 89603 MB
Rank =  112  Free Memory = 89603 MB
Rank =  113  Free Memory = 89603 MB
Rank =  114  Free Memory = 89603 MB
Rank =  115  Free Memory = 89603 MB
Rank =  116  Free Memory = 89603 MB
Rank =  117  Free Memory = 89603 MB
Rank =  118  Free Memory = 89603 MB
Rank =  119  Free Memory = 89603 MB
Rank =  120  Free Memory = 89603 MB
Rank =  121  Free Memory = 89603 MB
Rank =  122  Free Memory = 89603 MB
Rank =  123  Free Memory = 89603 MB
Rank =  124  Free Memory = 89603 MB
Rank =  125  Free Memory = 89603 MB
Rank =  126  Free Memory = 89603 MB
Rank =  127  Free Memory = 89603 MB
  Input file(s): opt_h2o_gs_gvpabs_run001h.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: 39b7557df04c29964085ccccce933740e3918067-dirty
  Last git commit date: Wed Mar 22 11:37:25 2023 -0700
  Last git commit subject: deleting more debugging statements
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_gs_gvpabs_run001h.xml

  Project = H2O
  date    = 2023-04-01 14:33:29 PDT
  host    = n0096.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 809

  Range of prime numbers to use as seeds over processors and threads = 6229-7393


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 2.140041e-01    1         1  ON     0
     uu_1                 5.172333e-02    1         1  ON     1
     uu_2                -4.338672e-02    1         1  ON     2
     uu_3                -9.921375e-02    1         1  ON     3
     uu_4                -1.338101e-01    1         1  ON     4
     uu_5                -1.417154e-01    1         1  ON     5
     uu_6                -1.187752e-01    1         1  ON     6
     uu_7                -4.806010e-02    1         1  ON     7
     uu_8                 9.380523e-02    1         1  ON     8
     uu_9                 1.263746e-01    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 3.553682e-01    1         1  ON     0
     ud_1                 9.625189e-02    1         1  ON     1
     ud_2                -1.377189e-02    1         1  ON     2
     ud_3                -7.514253e-02    1         1  ON     3
     ud_4                -1.232213e-01    1         1  ON     4
     ud_5                -1.553997e-01    1         1  ON     5
     ud_6                -1.571744e-01    1         1  ON     6
     ud_7                -1.129173e-01    1         1  ON     7
     ud_8                -4.439346e-03    1         1  ON     8
     ud_9                 9.261256e-02    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -7.826318e-01    1         1  ON     0
     eO_1                -4.611713e-01    1         1  ON     1
     eO_2                -4.947444e-02    1         1  ON     2
     eO_3                 2.108996e-01    1         1  ON     3
     eO_4                 3.113940e-01    1         1  ON     4
     eO_5                 3.257260e-01    1         1  ON     5
     eO_6                 2.616139e-01    1         1  ON     6
     eO_7                 1.236500e-01    1         1  ON     7
     eO_8                 2.976814e-02    1         1  ON     8
     eO_9                 1.903237e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -1.843797e-01    1         1  ON     0
     eH1_1                -1.049468e-01    1         1  ON     1
     eH1_2                -6.354579e-02    1         1  ON     2
     eH1_3                -2.637285e-02    1         1  ON     3
     eH1_4                 1.892484e-02    1         1  ON     4
     eH1_5                 3.364216e-02    1         1  ON     5
     eH1_6                 7.764953e-02    1         1  ON     6
     eH1_7                 1.097060e-01    1         1  ON     7
     eH1_8                 9.704786e-02    1         1  ON     8
     eH1_9                 2.631513e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -1.857767e-01    1         1  ON     0
     eH2_1                -1.063393e-01    1         1  ON     1
     eH2_2                -6.490806e-02    1         1  ON     2
     eH2_3                -2.788502e-02    1         1  ON     3
     eH2_4                 1.764768e-02    1         1  ON     4
     eH2_5                 3.176197e-02    1         1  ON     5
     eH2_6                 7.963021e-02    1         1  ON     6
     eH2_7                 1.142250e-01    1         1  ON     7
     eH2_8                 1.002520e-01    1         1  ON     8
     eH2_9                 2.859010e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 70 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 9.701702e-01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 26 unique up determinants.
Found 26 unique down determinants.
Number of terms in pairs array: 22
Number of terms in pairs array: 22
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 3.1415e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u -2.1647635618e-01 -6.7439216895e-01  1.9880537318e-01
    u -8.6004520714e-01 -3.1964226924e-01  6.9171823675e-02
    u -1.1165451895e+00 -5.3850544216e-01 -4.9152162246e-01
    u -4.0992137844e-01  2.3431241626e+00  1.4534834924e+00
    d -6.4716027047e-02 -8.0296334917e-01 -7.3676750950e-01
    d -4.9793133381e-01 -5.0450915047e-01 -7.6892777308e-01
    d  1.5908260425e-01  3.7531282770e-01 -1.4289189837e-01
    d -1.4507602779e-01 -1.2740118097e+00  2.0922709319e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 50
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.1364
    reference variance = 0.21176
====================================================
  Execution time = 2.0956e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1936e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4724e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319254187860
                                         uncertainty =       0.004608348512

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319254187860
                                         uncertainty =       0.004608348512

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399602114
  error estimate for blocks of size 2^( 2) =       0.000409721057
  error estimate for blocks of size 2^( 3) =       0.000418776260
  error estimate for blocks of size 2^( 4) =       0.000425503837
  error estimate for blocks of size 2^( 5) =       0.000430396412
  error estimate for blocks of size 2^( 6) =       0.000431684497
  error estimate for blocks of size 2^( 7) =       0.000432020588

      target function =                  N/A
              le_mean =     -17.216500031006
             les_mean =     296.727236856627
             stat err =       0.000429901333
             autocorr =       1.157396142696
              std dev =       0.565122728861
             le_variance =       0.319363698675


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.721650003101e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216500031006       residual = 4.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216498588412       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216497651635       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216500013525       residual = 6.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216499924217       residual = 3.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216500007849       residual = 5.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216500029705       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216499488360       residual = 2.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216499702878       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216499619869       residual = 3.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 9.421241e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216500031006       residual = 4.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216499399455       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216499025647       residual = 6.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216499777167       residual = 4.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216499783959       residual = 3.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216499809939       residual = 8.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216499784267       residual = 2.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216499630336       residual = 3.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 2.783552e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216500031006       residual = 4.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216499836613       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216499722810       residual = 5.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216499896508       residual = 5.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216499902093       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216499931184       residual = 2.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216499905427       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216499884379       residual = 1.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+00 is 7.530677e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.195215 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6630e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0  2.140430e-01                 1 1 ON  0
uu_1  5.175003e-02                 1 1 ON  1
uu_2  -4.328771e-02                1 1 ON  2
uu_3  -9.909945e-02                1 1 ON  3
uu_4  -1.338536e-01                1 1 ON  4
uu_5  -1.417514e-01                1 1 ON  5
uu_6  -1.188840e-01                1 1 ON  6
uu_7  -4.818453e-02                1 1 ON  7
uu_8  9.369721e-02                 1 1 ON  8
uu_9  1.264257e-01                 1 1 ON  9
ud_0  3.554685e-01                 1 1 ON  10
ud_1  9.634183e-02                 1 1 ON  11
ud_2  -1.380521e-02                1 1 ON  12
ud_3  -7.519902e-02                1 1 ON  13
ud_4  -1.232494e-01                1 1 ON  14
ud_5  -1.553303e-01                1 1 ON  15
ud_6  -1.572259e-01                1 1 ON  16
ud_7  -1.129644e-01                1 1 ON  17
ud_8  -4.549660e-03                1 1 ON  18
ud_9  9.261667e-02                 1 1 ON  19
eO_0  -7.827904e-01                1 1 ON  20
eO_1  -4.614497e-01                1 1 ON  21
eO_2  -4.960391e-02                1 1 ON  22
eO_3  2.109496e-01                 1 1 ON  23
eO_4  3.115367e-01                 1 1 ON  24
eO_5  3.258753e-01                 1 1 ON  25
eO_6  2.616924e-01                 1 1 ON  26
eO_7  1.237600e-01                 1 1 ON  27
eO_8  2.978582e-02                 1 1 ON  28
eO_9  1.904369e-02                 1 1 ON  29
eH1_0 -1.843355e-01                1 1 ON  30
eH1_1 -1.049867e-01                1 1 ON  31
eH1_2 -6.363370e-02                1 1 ON  32
eH1_3 -2.640106e-02                1 1 ON  33
eH1_4 1.895524e-02                 1 1 ON  34
eH1_5 3.361885e-02                 1 1 ON  35
eH1_6 7.766930e-02                 1 1 ON  36
eH1_7 1.096921e-01                 1 1 ON  37
eH1_8 9.711338e-02                 1 1 ON  38
eH1_9 2.634134e-02                 1 1 ON  39
eH2_0 -1.857422e-01                1 1 ON  40
eH2_1 -1.063550e-01                1 1 ON  41
eH2_2 -6.490700e-02                1 1 ON  42
eH2_3 -2.782965e-02                1 1 ON  43
eH2_4 1.760643e-02                 1 1 ON  44
eH2_5 3.172298e-02                 1 1 ON  45
eH2_6 7.959766e-02                 1 1 ON  46
eH2_7 1.141748e-01                 1 1 ON  47
eH2_8 1.003191e-01                 1 1 ON  48
eH2_9 2.860848e-02                 1 1 ON  49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.1554
    reference variance = 0.29876
====================================================
  Execution time = 2.0013e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1793e-01
  Total weights = 2.0000e+06
  Execution time = 1.8308e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317934174298
                                         uncertainty =       0.002795697277

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317934174298
                                         uncertainty =       0.002795697277

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398671205
  error estimate for blocks of size 2^( 2) =       0.000408250072
  error estimate for blocks of size 2^( 3) =       0.000416932780
  error estimate for blocks of size 2^( 4) =       0.000423477911
  error estimate for blocks of size 2^( 5) =       0.000427602164
  error estimate for blocks of size 2^( 6) =       0.000429728377
  error estimate for blocks of size 2^( 7) =       0.000429980100

      target function =                  N/A
              le_mean =     -17.217095844317
             les_mean =     296.746266613240
             stat err =       0.000427697138
             autocorr =       1.150914204897
              std dev =       0.563806225384
             le_variance =       0.317877459781

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318106923443
                                         uncertainty =       0.002797797082

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318106923443
                                         uncertainty =       0.002797797082

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398779542
  error estimate for blocks of size 2^( 2) =       0.000408351313
  error estimate for blocks of size 2^( 3) =       0.000417023164
  error estimate for blocks of size 2^( 4) =       0.000423560596
  error estimate for blocks of size 2^( 5) =       0.000427683259
  error estimate for blocks of size 2^( 6) =       0.000429809405
  error estimate for blocks of size 2^( 7) =       0.000430060344

      target function =                  N/A
              le_mean =     -17.217095681534
             les_mean =     296.746433794500
             stat err =       0.000427778401
             autocorr =       1.150726101988
              std dev =       0.563959436861
             le_variance =       0.318050246425

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318036968541
                                         uncertainty =       0.002796945361

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318036968541
                                         uncertainty =       0.002796945361

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398735673
  error estimate for blocks of size 2^( 2) =       0.000408309578
  error estimate for blocks of size 2^( 3) =       0.000416984626
  error estimate for blocks of size 2^( 4) =       0.000423524065
  error estimate for blocks of size 2^( 5) =       0.000427647083
  error estimate for blocks of size 2^( 6) =       0.000429772786
  error estimate for blocks of size 2^( 7) =       0.000430023023

      target function =                  N/A
              le_mean =     -17.217095713422
             les_mean =     296.746364920013
             stat err =       0.000427741739
             autocorr =       1.150782047691
              std dev =       0.563897396584
             le_variance =       0.317980273875

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317948326906
                                         uncertainty =       0.002795864029

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317948326906
                                         uncertainty =       0.002795864029

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398680081
  error estimate for blocks of size 2^( 2) =       0.000408258198
  error estimate for blocks of size 2^( 3) =       0.000416939762
  error estimate for blocks of size 2^( 4) =       0.000423484043
  error estimate for blocks of size 2^( 5) =       0.000427608089
  error estimate for blocks of size 2^( 6) =       0.000429734192
  error estimate for blocks of size 2^( 7) =       0.000429985686

      target function =                  N/A
              le_mean =     -17.217095782991
             les_mean =     296.746278656366
             stat err =       0.000427703003
             autocorr =       1.150894519544
              std dev =       0.563818778166
             le_variance =       0.317891614613


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217095844317        initial  <--
     2.5000e-01     2.5000e+00             9.4212e-04       -17.217095681534
     1.0000e+00     1.0000e+01             2.7836e-04       -17.217095713422
     4.0000e+00     4.0000e+01             7.5307e-05       -17.217095782991

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.2619
  </log>
  <optVariables href="H2O.s000.opt.xml">
 uu_0                 2.140041e-01 1 1  ON 0
 uu_1                 5.172333e-02 1 1  ON 1
 uu_2                -4.338672e-02 1 1  ON 2
 uu_3                -9.921375e-02 1 1  ON 3
 uu_4                -1.338101e-01 1 1  ON 4
 uu_5                -1.417154e-01 1 1  ON 5
 uu_6                -1.187752e-01 1 1  ON 6
 uu_7                -4.806010e-02 1 1  ON 7
 uu_8                 9.380523e-02 1 1  ON 8
 uu_9                 1.263746e-01 1 1  ON 9
 ud_0                 3.553682e-01 1 1  ON 10
 ud_1                 9.625189e-02 1 1  ON 11
 ud_2                -1.377189e-02 1 1  ON 12
 ud_3                -7.514253e-02 1 1  ON 13
 ud_4                -1.232213e-01 1 1  ON 14
 ud_5                -1.553997e-01 1 1  ON 15
 ud_6                -1.571744e-01 1 1  ON 16
 ud_7                -1.129173e-01 1 1  ON 17
 ud_8                -4.439346e-03 1 1  ON 18
 ud_9                 9.261256e-02 1 1  ON 19
 eO_0                -7.826318e-01 1 1  ON 20
 eO_1                -4.611713e-01 1 1  ON 21
 eO_2                -4.947444e-02 1 1  ON 22
 eO_3                 2.108996e-01 1 1  ON 23
 eO_4                 3.113940e-01 1 1  ON 24
 eO_5                 3.257260e-01 1 1  ON 25
 eO_6                 2.616139e-01 1 1  ON 26
 eO_7                 1.236500e-01 1 1  ON 27
 eO_8                 2.976814e-02 1 1  ON 28
 eO_9                 1.903237e-02 1 1  ON 29
eH1_0                -1.843797e-01 1 1  ON 30
eH1_1                -1.049468e-01 1 1  ON 31
eH1_2                -6.354579e-02 1 1  ON 32
eH1_3                -2.637285e-02 1 1  ON 33
eH1_4                 1.892484e-02 1 1  ON 34
eH1_5                 3.364216e-02 1 1  ON 35
eH1_6                 7.764953e-02 1 1  ON 36
eH1_7                 1.097060e-01 1 1  ON 37
eH1_8                 9.704786e-02 1 1  ON 38
eH1_9                 2.631513e-02 1 1  ON 39
eH2_0                -1.857767e-01 1 1  ON 40
eH2_1                -1.063393e-01 1 1  ON 41
eH2_2                -6.490806e-02 1 1  ON 42
eH2_3                -2.788502e-02 1 1  ON 43
eH2_4                 1.764768e-02 1 1  ON 44
eH2_5                 3.176197e-02 1 1  ON 45
eH2_6                 7.963021e-02 1 1  ON 46
eH2_7                 1.142250e-01 1 1  ON 47
eH2_8                 1.002520e-01 1 1  ON 48
eH2_9                 2.859010e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5938e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7146e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.1757
    reference variance = 0.147227
====================================================
  Execution time = 2.0286e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1963e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5820e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319715229628
                                         uncertainty =       0.004272339988

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319715229628
                                         uncertainty =       0.004272339988

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399771292
  error estimate for blocks of size 2^( 2) =       0.000409567694
  error estimate for blocks of size 2^( 3) =       0.000417953580
  error estimate for blocks of size 2^( 4) =       0.000424688716
  error estimate for blocks of size 2^( 5) =       0.000427562722
  error estimate for blocks of size 2^( 6) =       0.000429280936
  error estimate for blocks of size 2^( 7) =       0.000430823755

      target function =                  N/A
              le_mean =     -17.215995018477
             les_mean =     296.710118488229
             stat err =       0.000428089032
             autocorr =       1.146687280200
              std dev =       0.565361982997
             le_variance =       0.319634171818


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721599501848e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215995018477       residual = 7.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215995465571       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215995657179       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215995605580       residual = 5.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215995601241       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215995603805       residual = 6.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215995612019       residual = 8.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 8.962251e-05

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215995018477       residual = 7.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215995141079       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215995195579       residual = 9.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215995182913       residual = 6.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215995191124       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215995189642       residual = 4.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215995191380       residual = 5.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+01 is 2.286559e-05

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215995018477       residual = 7.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215995049888       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215995064002       residual = 9.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215995060852       residual = 6.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215995063678       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215995063167       residual = 4.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215995063598       residual = 5.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+01 is 5.747733e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.197589 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5874e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 2.140138e-01 1 1  ON 0
 uu_1                 5.171521e-02 1 1  ON 1
 uu_2                -4.338538e-02 1 1  ON 2
 uu_3                -9.920648e-02 1 1  ON 3
 uu_4                -1.338082e-01 1 1  ON 4
 uu_5                -1.417199e-01 1 1  ON 5
 uu_6                -1.187836e-01 1 1  ON 6
 uu_7                -4.806882e-02 1 1  ON 7
 uu_8                 9.379954e-02 1 1  ON 8
 uu_9                 1.263801e-01 1 1  ON 9
 ud_0                 3.553692e-01 1 1  ON 10
 ud_1                 9.627342e-02 1 1  ON 11
 ud_2                -1.378682e-02 1 1  ON 12
 ud_3                -7.515271e-02 1 1  ON 13
 ud_4                -1.232283e-01 1 1  ON 14
 ud_5                -1.554017e-01 1 1  ON 15
 ud_6                -1.571640e-01 1 1  ON 16
 ud_7                -1.129192e-01 1 1  ON 17
 ud_8                -4.448338e-03 1 1  ON 18
 ud_9                 9.261348e-02 1 1  ON 19
 eO_0                -7.826547e-01 1 1  ON 20
 eO_1                -4.611931e-01 1 1  ON 21
 eO_2                -4.948607e-02 1 1  ON 22
 eO_3                 2.108994e-01 1 1  ON 23
 eO_4                 3.114000e-01 1 1  ON 24
 eO_5                 3.257451e-01 1 1  ON 25
 eO_6                 2.616281e-01 1 1  ON 26
 eO_7                 1.236622e-01 1 1  ON 27
 eO_8                 2.977053e-02 1 1  ON 28
 eO_9                 1.903323e-02 1 1  ON 29
eH1_0                -1.843882e-01 1 1  ON 30
eH1_1                -1.049515e-01 1 1  ON 31
eH1_2                -6.355370e-02 1 1  ON 32
eH1_3                -2.636650e-02 1 1  ON 33
eH1_4                 1.892879e-02 1 1  ON 34
eH1_5                 3.363841e-02 1 1  ON 35
eH1_6                 7.765260e-02 1 1  ON 36
eH1_7                 1.097070e-01 1 1  ON 37
eH1_8                 9.705465e-02 1 1  ON 38
eH1_9                 2.631690e-02 1 1  ON 39
eH2_0                -1.857753e-01 1 1  ON 40
eH2_1                -1.063452e-01 1 1  ON 41
eH2_2                -6.490937e-02 1 1  ON 42
eH2_3                -2.788437e-02 1 1  ON 43
eH2_4                 1.765084e-02 1 1  ON 44
eH2_5                 3.175321e-02 1 1  ON 45
eH2_6                 7.962406e-02 1 1  ON 46
eH2_7                 1.142279e-01 1 1  ON 47
eH2_8                 1.002614e-01 1 1  ON 48
eH2_9                 2.859340e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.2007
    reference variance = 0.207577
====================================================
  Execution time = 1.9668e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.3340e-01
  Total weights = 2.0000e+06
  Execution time = 1.8352e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333236875774
                                         uncertainty =       0.014360111474

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333236875774
                                         uncertainty =       0.014360111474

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408289132
  error estimate for blocks of size 2^( 2) =       0.000418021757
  error estimate for blocks of size 2^( 3) =       0.000426390089
  error estimate for blocks of size 2^( 4) =       0.000432627410
  error estimate for blocks of size 2^( 5) =       0.000436373352
  error estimate for blocks of size 2^( 6) =       0.000436339934
  error estimate for blocks of size 2^( 7) =       0.000437945830

      target function =                  N/A
              le_mean =     -17.215791557408
             les_mean =     296.716878811920
             stat err =       0.000435821631
             autocorr =       1.139414978659
              std dev =       0.577408027754
             le_variance =       0.333400030515

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333247731391
                                         uncertainty =       0.014358552585

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333247731391
                                         uncertainty =       0.014358552585

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408295783
  error estimate for blocks of size 2^( 2) =       0.000418027196
  error estimate for blocks of size 2^( 3) =       0.000426394049
  error estimate for blocks of size 2^( 4) =       0.000432630185
  error estimate for blocks of size 2^( 5) =       0.000436374909
  error estimate for blocks of size 2^( 6) =       0.000436342847
  error estimate for blocks of size 2^( 7) =       0.000437951972

      target function =                  N/A
              le_mean =     -17.215791678210
             les_mean =     296.716893834134
             stat err =       0.000435824978
             autocorr =       1.139395356854
              std dev =       0.577417434191
             le_variance =       0.333410893307

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333240152549
                                         uncertainty =       0.014359144324

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333240152549
                                         uncertainty =       0.014359144324

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408291140
  error estimate for blocks of size 2^( 2) =       0.000418023134
  error estimate for blocks of size 2^( 3) =       0.000426390672
  error estimate for blocks of size 2^( 4) =       0.000432627351
  error estimate for blocks of size 2^( 5) =       0.000436372640
  error estimate for blocks of size 2^( 6) =       0.000436340123
  error estimate for blocks of size 2^( 7) =       0.000437947974

      target function =                  N/A
              le_mean =     -17.215791596384
             les_mean =     296.716883432766
             stat err =       0.000435822022
             autocorr =       1.139405815922
              std dev =       0.577410867008
             le_variance =       0.333403309339

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333237189958
                                         uncertainty =       0.014359983505

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333237189958
                                         uncertainty =       0.014359983505

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408289324
  error estimate for blocks of size 2^( 2) =       0.000418021869
  error estimate for blocks of size 2^( 3) =       0.000426390100
  error estimate for blocks of size 2^( 4) =       0.000432627338
  error estimate for blocks of size 2^( 5) =       0.000436373197
  error estimate for blocks of size 2^( 6) =       0.000436339901
  error estimate for blocks of size 2^( 7) =       0.000437946054

      target function =                  N/A
              le_mean =     -17.215791560271
             les_mean =     296.716879224877
             stat err =       0.000435821623
             autocorr =       1.139413858345
              std dev =       0.577408299984
             le_variance =       0.333400344890


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215791557408        initial
     2.5000e+00     2.5000e+01             8.9623e-05       -17.215791678210  <--
     1.0000e+01     1.0000e+02             2.2866e-05       -17.215791596384
     4.0000e+01     4.0000e+02             5.7477e-06       -17.215791560271

*****************************************************************************
Applying the update for shift_i =   2.5000e+00     and shift_s =   2.5000e+01
*****************************************************************************

  Execution time = 3.2241e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 2.140397e-01 1 1  ON 0
 uu_1                 5.169469e-02 1 1  ON 1
 uu_2                -4.337957e-02 1 1  ON 2
 uu_3                -9.918710e-02 1 1  ON 3
 uu_4                -1.338015e-01 1 1  ON 4
 uu_5                -1.417337e-01 1 1  ON 5
 uu_6                -1.188091e-01 1 1  ON 6
 uu_7                -4.809481e-02 1 1  ON 7
 uu_8                 9.378263e-02 1 1  ON 8
 uu_9                 1.263965e-01 1 1  ON 9
 ud_0                 3.553781e-01 1 1  ON 10
 ud_1                 9.632455e-02 1 1  ON 11
 ud_2                -1.382349e-02 1 1  ON 12
 ud_3                -7.518453e-02 1 1  ON 13
 ud_4                -1.232495e-01 1 1  ON 14
 ud_5                -1.554074e-01 1 1  ON 15
 ud_6                -1.571326e-01 1 1  ON 16
 ud_7                -1.129241e-01 1 1  ON 17
 ud_8                -4.474940e-03 1 1  ON 18
 ud_9                 9.261625e-02 1 1  ON 19
 eO_0                -7.827214e-01 1 1  ON 20
 eO_1                -4.612571e-01 1 1  ON 21
 eO_2                -4.952347e-02 1 1  ON 22
 eO_3                 2.108987e-01 1 1  ON 23
 eO_4                 3.114183e-01 1 1  ON 24
 eO_5                 3.258020e-01 1 1  ON 25
 eO_6                 2.616703e-01 1 1  ON 26
 eO_7                 1.236983e-01 1 1  ON 27
 eO_8                 2.977762e-02 1 1  ON 28
 eO_9                 1.903579e-02 1 1  ON 29
eH1_0                -1.844139e-01 1 1  ON 30
eH1_1                -1.049655e-01 1 1  ON 31
eH1_2                -6.357504e-02 1 1  ON 32
eH1_3                -2.635008e-02 1 1  ON 33
eH1_4                 1.894092e-02 1 1  ON 34
eH1_5                 3.362749e-02 1 1  ON 35
eH1_6                 7.766176e-02 1 1  ON 36
eH1_7                 1.097101e-01 1 1  ON 37
eH1_8                 9.707487e-02 1 1  ON 38
eH1_9                 2.632215e-02 1 1  ON 39
eH2_0                -1.857715e-01 1 1  ON 40
eH2_1                -1.063626e-01 1 1  ON 41
eH2_2                -6.491344e-02 1 1  ON 42
eH2_3                -2.788214e-02 1 1  ON 43
eH2_4                 1.766055e-02 1 1  ON 44
eH2_5                 3.172688e-02 1 1  ON 45
eH2_6                 7.960567e-02 1 1  ON 46
eH2_7                 1.142366e-01 1 1  ON 47
eH2_8                 1.002892e-01 1 1  ON 48
eH2_9                 2.860319e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8122e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7167e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.175
    reference variance = 0.195909
====================================================
  Execution time = 1.9933e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2258e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8335e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322662961847
                                         uncertainty =       0.005480817635

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322662961847
                                         uncertainty =       0.005480817635

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401610971
  error estimate for blocks of size 2^( 2) =       0.000411048560
  error estimate for blocks of size 2^( 3) =       0.000419926702
  error estimate for blocks of size 2^( 4) =       0.000426602164
  error estimate for blocks of size 2^( 5) =       0.000429965670
  error estimate for blocks of size 2^( 6) =       0.000432087042
  error estimate for blocks of size 2^( 7) =       0.000431981001

      target function =                  N/A
              le_mean =     -17.217264950636
             les_mean =     296.756794963876
             stat err =       0.000430158969
             autocorr =       1.147220314616
              std dev =       0.567963682603
             le_variance =       0.322582744756


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721726495064e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217264950636       residual = 8.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217265918236       residual = 5.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217266511385       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217266575563       residual = 5.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217266848541       residual = 3.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217266566006       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217266826933       residual = 4.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217266923618       residual = 7.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 3.200306e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217264950636       residual = 8.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217265246466       residual = 5.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217265487431       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217265520981       residual = 4.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217265631579       residual = 2.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217265526920       residual = 3.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217265571617       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217265589000       residual = 2.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 8.488710e-05

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217264950636       residual = 8.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217265028959       residual = 6.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217265099148       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217265109632       residual = 4.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217265142333       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217265114121       residual = 2.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217265122650       residual = 6.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+01 is 2.118889e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.213394 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8782e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 2.140722e-01 1 1  ON 0
 uu_1                 5.168048e-02 1 1  ON 1
 uu_2                -4.338927e-02 1 1  ON 2
 uu_3                -9.913136e-02 1 1  ON 3
 uu_4                -1.337981e-01 1 1  ON 4
 uu_5                -1.417860e-01 1 1  ON 5
 uu_6                -1.188550e-01 1 1  ON 6
 uu_7                -4.810939e-02 1 1  ON 7
 uu_8                 9.376693e-02 1 1  ON 8
 uu_9                 1.264228e-01 1 1  ON 9
 ud_0                 3.554340e-01 1 1  ON 10
 ud_1                 9.634553e-02 1 1  ON 11
 ud_2                -1.386571e-02 1 1  ON 12
 ud_3                -7.521209e-02 1 1  ON 13
 ud_4                -1.232586e-01 1 1  ON 14
 ud_5                -1.554144e-01 1 1  ON 15
 ud_6                -1.571569e-01 1 1  ON 16
 ud_7                -1.128997e-01 1 1  ON 17
 ud_8                -4.498780e-03 1 1  ON 18
 ud_9                 9.262151e-02 1 1  ON 19
 eO_0                -7.828063e-01 1 1  ON 20
 eO_1                -4.613047e-01 1 1  ON 21
 eO_2                -4.958399e-02 1 1  ON 22
 eO_3                 2.108797e-01 1 1  ON 23
 eO_4                 3.114518e-01 1 1  ON 24
 eO_5                 3.258476e-01 1 1  ON 25
 eO_6                 2.617229e-01 1 1  ON 26
 eO_7                 1.237614e-01 1 1  ON 27
 eO_8                 2.978783e-02 1 1  ON 28
 eO_9                 1.903965e-02 1 1  ON 29
eH1_0                -1.844121e-01 1 1  ON 30
eH1_1                -1.049535e-01 1 1  ON 31
eH1_2                -6.359192e-02 1 1  ON 32
eH1_3                -2.636009e-02 1 1  ON 33
eH1_4                 1.896067e-02 1 1  ON 34
eH1_5                 3.356716e-02 1 1  ON 35
eH1_6                 7.765667e-02 1 1  ON 36
eH1_7                 1.097252e-01 1 1  ON 37
eH1_8                 9.710453e-02 1 1  ON 38
eH1_9                 2.633072e-02 1 1  ON 39
eH2_0                -1.857775e-01 1 1  ON 40
eH2_1                -1.064050e-01 1 1  ON 41
eH2_2                -6.491772e-02 1 1  ON 42
eH2_3                -2.788560e-02 1 1  ON 43
eH2_4                 1.766066e-02 1 1  ON 44
eH2_5                 3.175008e-02 1 1  ON 45
eH2_6                 7.958604e-02 1 1  ON 46
eH2_7                 1.142379e-01 1 1  ON 47
eH2_8                 1.003290e-01 1 1  ON 48
eH2_9                 2.861256e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.2491
    reference variance = 0.159059
====================================================
  Execution time = 1.9662e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1699e-01
  Total weights = 2.0000e+06
  Execution time = 1.8636e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317013481953
                                         uncertainty =       0.003375629881

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317013481953
                                         uncertainty =       0.003375629881

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398072450
  error estimate for blocks of size 2^( 2) =       0.000407872150
  error estimate for blocks of size 2^( 3) =       0.000416726832
  error estimate for blocks of size 2^( 4) =       0.000423289461
  error estimate for blocks of size 2^( 5) =       0.000427936015
  error estimate for blocks of size 2^( 6) =       0.000430662321
  error estimate for blocks of size 2^( 7) =       0.000431727737

      target function =                  N/A
              le_mean =     -17.216777638603
             les_mean =     296.734355450094
             stat err =       0.000428403883
             autocorr =       1.158197314795
              std dev =       0.562959458085
             le_variance =       0.316923351448

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317202792516
                                         uncertainty =       0.003377700537

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317202792516
                                         uncertainty =       0.003377700537

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398191274
  error estimate for blocks of size 2^( 2) =       0.000407985091
  error estimate for blocks of size 2^( 3) =       0.000416833027
  error estimate for blocks of size 2^( 4) =       0.000423389669
  error estimate for blocks of size 2^( 5) =       0.000428033904
  error estimate for blocks of size 2^( 6) =       0.000430754813
  error estimate for blocks of size 2^( 7) =       0.000431810977

      target function =                  N/A
              le_mean =     -17.216777294342
             les_mean =     296.734532826215
             stat err =       0.000428497341
             autocorr =       1.158011266160
              std dev =       0.563127500479
             le_variance =       0.317112581796

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317144192748
                                         uncertainty =       0.003377076445

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317144192748
                                         uncertainty =       0.003377076445

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398154492
  error estimate for blocks of size 2^( 2) =       0.000407950079
  error estimate for blocks of size 2^( 3) =       0.000416799985
  error estimate for blocks of size 2^( 4) =       0.000423358568
  error estimate for blocks of size 2^( 5) =       0.000428003618
  error estimate for blocks of size 2^( 6) =       0.000430726187
  error estimate for blocks of size 2^( 7) =       0.000431784647

      target function =                  N/A
              le_mean =     -17.216777350341
             les_mean =     296.734476172048
             stat err =       0.000428468255
             autocorr =       1.158067999603
              std dev =       0.563075482817
             le_variance =       0.317053999349

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317031888857
                                         uncertainty =       0.003375829565

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317031888857
                                         uncertainty =       0.003375829565

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398084004
  error estimate for blocks of size 2^( 2) =       0.000407883125
  error estimate for blocks of size 2^( 3) =       0.000416737142
  error estimate for blocks of size 2^( 4) =       0.000423299205
  error estimate for blocks of size 2^( 5) =       0.000427945564
  error estimate for blocks of size 2^( 6) =       0.000430671362
  error estimate for blocks of size 2^( 7) =       0.000431735775

      target function =                  N/A
              le_mean =     -17.216777582945
             les_mean =     296.734371931320
             stat err =       0.000428412976
             autocorr =       1.158179247656
              std dev =       0.562975798043
             le_variance =       0.316941749182


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216777638603        initial  <--
     6.2500e-01     6.2500e+00             3.2003e-04       -17.216777294342
     2.5000e+00     2.5000e+01             8.4887e-05       -17.216777350341
     1.0000e+01     1.0000e+02             2.1189e-05       -17.216777582945

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.9313
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 2.140397e-01 1 1  ON 0
 uu_1                 5.169469e-02 1 1  ON 1
 uu_2                -4.337957e-02 1 1  ON 2
 uu_3                -9.918710e-02 1 1  ON 3
 uu_4                -1.338015e-01 1 1  ON 4
 uu_5                -1.417337e-01 1 1  ON 5
 uu_6                -1.188091e-01 1 1  ON 6
 uu_7                -4.809481e-02 1 1  ON 7
 uu_8                 9.378263e-02 1 1  ON 8
 uu_9                 1.263965e-01 1 1  ON 9
 ud_0                 3.553781e-01 1 1  ON 10
 ud_1                 9.632455e-02 1 1  ON 11
 ud_2                -1.382349e-02 1 1  ON 12
 ud_3                -7.518453e-02 1 1  ON 13
 ud_4                -1.232495e-01 1 1  ON 14
 ud_5                -1.554074e-01 1 1  ON 15
 ud_6                -1.571326e-01 1 1  ON 16
 ud_7                -1.129241e-01 1 1  ON 17
 ud_8                -4.474940e-03 1 1  ON 18
 ud_9                 9.261625e-02 1 1  ON 19
 eO_0                -7.827214e-01 1 1  ON 20
 eO_1                -4.612571e-01 1 1  ON 21
 eO_2                -4.952347e-02 1 1  ON 22
 eO_3                 2.108987e-01 1 1  ON 23
 eO_4                 3.114183e-01 1 1  ON 24
 eO_5                 3.258020e-01 1 1  ON 25
 eO_6                 2.616703e-01 1 1  ON 26
 eO_7                 1.236983e-01 1 1  ON 27
 eO_8                 2.977762e-02 1 1  ON 28
 eO_9                 1.903579e-02 1 1  ON 29
eH1_0                -1.844139e-01 1 1  ON 30
eH1_1                -1.049655e-01 1 1  ON 31
eH1_2                -6.357504e-02 1 1  ON 32
eH1_3                -2.635008e-02 1 1  ON 33
eH1_4                 1.894092e-02 1 1  ON 34
eH1_5                 3.362749e-02 1 1  ON 35
eH1_6                 7.766176e-02 1 1  ON 36
eH1_7                 1.097101e-01 1 1  ON 37
eH1_8                 9.707487e-02 1 1  ON 38
eH1_9                 2.632215e-02 1 1  ON 39
eH2_0                -1.857715e-01 1 1  ON 40
eH2_1                -1.063626e-01 1 1  ON 41
eH2_2                -6.491344e-02 1 1  ON 42
eH2_3                -2.788214e-02 1 1  ON 43
eH2_4                 1.766055e-02 1 1  ON 44
eH2_5                 3.172688e-02 1 1  ON 45
eH2_6                 7.960567e-02 1 1  ON 46
eH2_7                 1.142366e-01 1 1  ON 47
eH2_8                 1.002892e-01 1 1  ON 48
eH2_9                 2.860319e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7722e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7182e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.2073
    reference variance = 0.17453
====================================================
  Execution time = 2.0341e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1663e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6100e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316707824961
                                         uncertainty =       0.002843248855

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316707824961
                                         uncertainty =       0.002843248855

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397889989
  error estimate for blocks of size 2^( 2) =       0.000407702708
  error estimate for blocks of size 2^( 3) =       0.000416682831
  error estimate for blocks of size 2^( 4) =       0.000423595777
  error estimate for blocks of size 2^( 5) =       0.000428492045
  error estimate for blocks of size 2^( 6) =       0.000430225015
  error estimate for blocks of size 2^( 7) =       0.000432655470

      target function =                  N/A
              le_mean =     -17.216252938503
             les_mean =     296.715997971019
             stat err =       0.000428742077
             autocorr =       1.161090816382
              std dev =       0.562701418887
             le_variance =       0.316632886818


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721625293850e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216252938503       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216252900589       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216252945035       residual = 9.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216252936815       residual = 5.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216252910502       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216252968201       residual = 1.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216252948940       residual = 4.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 3.397948e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216252938503       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216252928677       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216252939935       residual = 9.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216252938169       residual = 5.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216252931548       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216252945607       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216252940751       residual = 4.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+01 is 8.555638e-06

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216252938503       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216252936024       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216252938848       residual = 9.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216252938425       residual = 5.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216252936767       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216252940256       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216252939044       residual = 3.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+02 is 2.142928e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.215627 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5958e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 2.140399e-01 1 1  ON 0
 uu_1                 5.169442e-02 1 1  ON 1
 uu_2                -4.337700e-02 1 1  ON 2
 uu_3                -9.918634e-02 1 1  ON 3
 uu_4                -1.338004e-01 1 1  ON 4
 uu_5                -1.417392e-01 1 1  ON 5
 uu_6                -1.188106e-01 1 1  ON 6
 uu_7                -4.809487e-02 1 1  ON 7
 uu_8                 9.378127e-02 1 1  ON 8
 uu_9                 1.263983e-01 1 1  ON 9
 ud_0                 3.553745e-01 1 1  ON 10
 ud_1                 9.632906e-02 1 1  ON 11
 ud_2                -1.382634e-02 1 1  ON 12
 ud_3                -7.518566e-02 1 1  ON 13
 ud_4                -1.232490e-01 1 1  ON 14
 ud_5                -1.554063e-01 1 1  ON 15
 ud_6                -1.571306e-01 1 1  ON 16
 ud_7                -1.129236e-01 1 1  ON 17
 ud_8                -4.477795e-03 1 1  ON 18
 ud_9                 9.261654e-02 1 1  ON 19
 eO_0                -7.827299e-01 1 1  ON 20
 eO_1                -4.612656e-01 1 1  ON 21
 eO_2                -4.952760e-02 1 1  ON 22
 eO_3                 2.108981e-01 1 1  ON 23
 eO_4                 3.114203e-01 1 1  ON 24
 eO_5                 3.258088e-01 1 1  ON 25
 eO_6                 2.616762e-01 1 1  ON 26
 eO_7                 1.237041e-01 1 1  ON 27
 eO_8                 2.977860e-02 1 1  ON 28
 eO_9                 1.903596e-02 1 1  ON 29
eH1_0                -1.844142e-01 1 1  ON 30
eH1_1                -1.049628e-01 1 1  ON 31
eH1_2                -6.357287e-02 1 1  ON 32
eH1_3                -2.635236e-02 1 1  ON 33
eH1_4                 1.893804e-02 1 1  ON 34
eH1_5                 3.362429e-02 1 1  ON 35
eH1_6                 7.766228e-02 1 1  ON 36
eH1_7                 1.097102e-01 1 1  ON 37
eH1_8                 9.707719e-02 1 1  ON 38
eH1_9                 2.632282e-02 1 1  ON 39
eH2_0                -1.857734e-01 1 1  ON 40
eH2_1                -1.063616e-01 1 1  ON 41
eH2_2                -6.491568e-02 1 1  ON 42
eH2_3                -2.787950e-02 1 1  ON 43
eH2_4                 1.766061e-02 1 1  ON 44
eH2_5                 3.172701e-02 1 1  ON 45
eH2_6                 7.960239e-02 1 1  ON 46
eH2_7                 1.142361e-01 1 1  ON 47
eH2_8                 1.002921e-01 1 1  ON 48
eH2_9                 2.860415e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.2466
    reference variance = 0.191447
====================================================
  Execution time = 2.0195e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1553e-01
  Total weights = 2.0000e+06
  Execution time = 1.8458e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315552169582
                                         uncertainty =       0.002656767507

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315552169582
                                         uncertainty =       0.002656767507

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397199023
  error estimate for blocks of size 2^( 2) =       0.000407045648
  error estimate for blocks of size 2^( 3) =       0.000415637668
  error estimate for blocks of size 2^( 4) =       0.000421794728
  error estimate for blocks of size 2^( 5) =       0.000425878446
  error estimate for blocks of size 2^( 6) =       0.000427110064
  error estimate for blocks of size 2^( 7) =       0.000430417333

      target function =                  N/A
              le_mean =     -17.216700786301
             les_mean =     296.730319935690
             stat err =       0.000426300143
             autocorr =       1.151899559255
              std dev =       0.561724245914
             le_variance =       0.315534128448

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315539474797
                                         uncertainty =       0.002656746093

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315539474797
                                         uncertainty =       0.002656746093

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397191055
  error estimate for blocks of size 2^( 2) =       0.000407037778
  error estimate for blocks of size 2^( 3) =       0.000415629828
  error estimate for blocks of size 2^( 4) =       0.000421786960
  error estimate for blocks of size 2^( 5) =       0.000425870378
  error estimate for blocks of size 2^( 6) =       0.000427101736
  error estimate for blocks of size 2^( 7) =       0.000430408589

      target function =                  N/A
              le_mean =     -17.216700821563
             les_mean =     296.730308490019
             stat err =       0.000426291916
             autocorr =       1.151901317570
              std dev =       0.561712977049
             le_variance =       0.315521468585

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315545287465
                                         uncertainty =       0.002656754640

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315545287465
                                         uncertainty =       0.002656754640

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397194703
  error estimate for blocks of size 2^( 2) =       0.000407041382
  error estimate for blocks of size 2^( 3) =       0.000415633420
  error estimate for blocks of size 2^( 4) =       0.000421790522
  error estimate for blocks of size 2^( 5) =       0.000425874080
  error estimate for blocks of size 2^( 6) =       0.000427105560
  error estimate for blocks of size 2^( 7) =       0.000430412594

      target function =                  N/A
              le_mean =     -17.216700801886
             les_mean =     296.730313608599
             stat err =       0.000426295689
             autocorr =       1.151900547379
              std dev =       0.561718136332
             le_variance =       0.315527264685

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315551290175
                                         uncertainty =       0.002656765821

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315551290175
                                         uncertainty =       0.002656765821

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397198471
  error estimate for blocks of size 2^( 2) =       0.000407045103
  error estimate for blocks of size 2^( 3) =       0.000415637125
  error estimate for blocks of size 2^( 4) =       0.000421794191
  error estimate for blocks of size 2^( 5) =       0.000425877888
  error estimate for blocks of size 2^( 6) =       0.000427109489
  error estimate for blocks of size 2^( 7) =       0.000430416728

      target function =                  N/A
              le_mean =     -17.216700788123
             les_mean =     296.730319121368
             stat err =       0.000426299574
             autocorr =       1.151899686689
              std dev =       0.561723465208
             le_variance =       0.315533251365


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216700786301        initial
     6.2500e+00     6.2500e+01             3.3979e-05       -17.216700821563  <--
     2.5000e+01     2.5000e+02             8.5556e-06       -17.216700801886
     1.0000e+02     1.0000e+03             2.1429e-06       -17.216700788123

*****************************************************************************
Applying the update for shift_i =   6.2500e+00     and shift_s =   6.2500e+01
*****************************************************************************

  Execution time = 2.9424e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 2.140405e-01 1 1  ON 0
 uu_1                 5.169404e-02 1 1  ON 1
 uu_2                -4.336974e-02 1 1  ON 2
 uu_3                -9.918383e-02 1 1  ON 3
 uu_4                -1.337973e-01 1 1  ON 4
 uu_5                -1.417553e-01 1 1  ON 5
 uu_6                -1.188153e-01 1 1  ON 6
 uu_7                -4.809510e-02 1 1  ON 7
 uu_8                 9.377722e-02 1 1  ON 8
 uu_9                 1.264037e-01 1 1  ON 9
 ud_0                 3.553647e-01 1 1  ON 10
 ud_1                 9.634124e-02 1 1  ON 11
 ud_2                -1.383420e-02 1 1  ON 12
 ud_3                -7.518935e-02 1 1  ON 13
 ud_4                -1.232478e-01 1 1  ON 14
 ud_5                -1.554028e-01 1 1  ON 15
 ud_6                -1.571247e-01 1 1  ON 16
 ud_7                -1.129222e-01 1 1  ON 17
 ud_8                -4.486327e-03 1 1  ON 18
 ud_9                 9.261743e-02 1 1  ON 19
 eO_0                -7.827552e-01 1 1  ON 20
 eO_1                -4.612910e-01 1 1  ON 21
 eO_2                -4.954015e-02 1 1  ON 22
 eO_3                 2.108964e-01 1 1  ON 23
 eO_4                 3.114261e-01 1 1  ON 24
 eO_5                 3.258292e-01 1 1  ON 25
 eO_6                 2.616938e-01 1 1  ON 26
 eO_7                 1.237215e-01 1 1  ON 27
 eO_8                 2.978154e-02 1 1  ON 28
 eO_9                 1.903647e-02 1 1  ON 29
eH1_0                -1.844151e-01 1 1  ON 30
eH1_1                -1.049548e-01 1 1  ON 31
eH1_2                -6.356666e-02 1 1  ON 32
eH1_3                -2.635880e-02 1 1  ON 33
eH1_4                 1.892933e-02 1 1  ON 34
eH1_5                 3.361466e-02 1 1  ON 35
eH1_6                 7.766382e-02 1 1  ON 36
eH1_7                 1.097105e-01 1 1  ON 37
eH1_8                 9.708414e-02 1 1  ON 38
eH1_9                 2.632483e-02 1 1  ON 39
eH2_0                -1.857791e-01 1 1  ON 40
eH2_1                -1.063587e-01 1 1  ON 41
eH2_2                -6.492200e-02 1 1  ON 42
eH2_3                -2.787184e-02 1 1  ON 43
eH2_4                 1.766074e-02 1 1  ON 44
eH2_5                 3.172741e-02 1 1  ON 45
eH2_6                 7.959256e-02 1 1  ON 46
eH2_7                 1.142347e-01 1 1  ON 47
eH2_8                 1.003010e-01 1 1  ON 48
eH2_9                 2.860700e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5389e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7193e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.2492
    reference variance = 0.409107
====================================================
  Execution time = 2.0220e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1730e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5329e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317363304893
                                         uncertainty =       0.003974188935

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317363304893
                                         uncertainty =       0.003974188935

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398310807
  error estimate for blocks of size 2^( 2) =       0.000408076938
  error estimate for blocks of size 2^( 3) =       0.000417117557
  error estimate for blocks of size 2^( 4) =       0.000423420398
  error estimate for blocks of size 2^( 5) =       0.000427518805
  error estimate for blocks of size 2^( 6) =       0.000429250419
  error estimate for blocks of size 2^( 7) =       0.000430322965

      target function =                  N/A
              le_mean =     -17.217091609261
             les_mean =     296.745546321614
             stat err =       0.000427628147
             autocorr =       1.152625930459
              std dev =       0.563296545859
             le_variance =       0.317302998576


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721709160926e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217091609261       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217091687730       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217091810906       residual = 6.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217091771410       residual = 9.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217091925002       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217092127018       residual = 5.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217092096712       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217092070350       residual = 2.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 1.366573e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217091609261       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217091631797       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217091666365       residual = 5.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217091654606       residual = 8.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217091694349       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217091741506       residual = 3.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217091737181       residual = 5.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 3.397159e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217091609261       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217091615113       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217091624050       residual = 5.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217091620978       residual = 8.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217091630976       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217091642296       residual = 2.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217091641688       residual = 4.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+01 is 8.556463e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.218133 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5759e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 2.140366e-01 1 1  ON 0
 uu_1                 5.169457e-02 1 1  ON 1
 uu_2                -4.335384e-02 1 1  ON 2
 uu_3                -9.916343e-02 1 1  ON 3
 uu_4                -1.337960e-01 1 1  ON 4
 uu_5                -1.417588e-01 1 1  ON 5
 uu_6                -1.188273e-01 1 1  ON 6
 uu_7                -4.811473e-02 1 1  ON 7
 uu_8                 9.376151e-02 1 1  ON 8
 uu_9                 1.264105e-01 1 1  ON 9
 ud_0                 3.553751e-01 1 1  ON 10
 ud_1                 9.635933e-02 1 1  ON 11
 ud_2                -1.383779e-02 1 1  ON 12
 ud_3                -7.519075e-02 1 1  ON 13
 ud_4                -1.232527e-01 1 1  ON 14
 ud_5                -1.553938e-01 1 1  ON 15
 ud_6                -1.571410e-01 1 1  ON 16
 ud_7                -1.129243e-01 1 1  ON 17
 ud_8                -4.500494e-03 1 1  ON 18
 ud_9                 9.261615e-02 1 1  ON 19
 eO_0                -7.827892e-01 1 1  ON 20
 eO_1                -4.613158e-01 1 1  ON 21
 eO_2                -4.957242e-02 1 1  ON 22
 eO_3                 2.109057e-01 1 1  ON 23
 eO_4                 3.114434e-01 1 1  ON 24
 eO_5                 3.258553e-01 1 1  ON 25
 eO_6                 2.617113e-01 1 1  ON 26
 eO_7                 1.237387e-01 1 1  ON 27
 eO_8                 2.978409e-02 1 1  ON 28
 eO_9                 1.903719e-02 1 1  ON 29
eH1_0                -1.844238e-01 1 1  ON 30
eH1_1                -1.049453e-01 1 1  ON 31
eH1_2                -6.357745e-02 1 1  ON 32
eH1_3                -2.636601e-02 1 1  ON 33
eH1_4                 1.892496e-02 1 1  ON 34
eH1_5                 3.361027e-02 1 1  ON 35
eH1_6                 7.767494e-02 1 1  ON 36
eH1_7                 1.097130e-01 1 1  ON 37
eH1_8                 9.709349e-02 1 1  ON 38
eH1_9                 2.632726e-02 1 1  ON 39
eH2_0                -1.857630e-01 1 1  ON 40
eH2_1                -1.063691e-01 1 1  ON 41
eH2_2                -6.492636e-02 1 1  ON 42
eH2_3                -2.788397e-02 1 1  ON 43
eH2_4                 1.766032e-02 1 1  ON 44
eH2_5                 3.173811e-02 1 1  ON 45
eH2_6                 7.958501e-02 1 1  ON 46
eH2_7                 1.142321e-01 1 1  ON 47
eH2_8                 1.003090e-01 1 1  ON 48
eH2_9                 2.860886e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.0838
    reference variance = 0.395568
====================================================
  Execution time = 1.9849e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1632e-01
  Total weights = 2.0000e+06
  Execution time = 1.8519e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316349992208
                                         uncertainty =       0.003526940286

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316349992208
                                         uncertainty =       0.003526940286

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397690379
  error estimate for blocks of size 2^( 2) =       0.000407381351
  error estimate for blocks of size 2^( 3) =       0.000416018170
  error estimate for blocks of size 2^( 4) =       0.000422851550
  error estimate for blocks of size 2^( 5) =       0.000426975254
  error estimate for blocks of size 2^( 6) =       0.000429437982
  error estimate for blocks of size 2^( 7) =       0.000430842194

      target function =                  N/A
              le_mean =     -17.216790614335
             les_mean =     296.734194175261
             stat err =       0.000427526745
             autocorr =       1.155676832922
              std dev =       0.562419128028
             le_variance =       0.316315275572

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316355221555
                                         uncertainty =       0.003527312441

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316355221555
                                         uncertainty =       0.003527312441

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397693660
  error estimate for blocks of size 2^( 2) =       0.000407383728
  error estimate for blocks of size 2^( 3) =       0.000416018217
  error estimate for blocks of size 2^( 4) =       0.000422849629
  error estimate for blocks of size 2^( 5) =       0.000426972612
  error estimate for blocks of size 2^( 6) =       0.000429433584
  error estimate for blocks of size 2^( 7) =       0.000430836653

      target function =                  N/A
              le_mean =     -17.216790685102
             les_mean =     296.734201831013
             stat err =       0.000427523120
             autocorr =       1.155638164089
              std dev =       0.562423767771
             le_variance =       0.316320494554

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316350726661
                                         uncertainty =       0.003527150479

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316350726661
                                         uncertainty =       0.003527150479

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397690839
  error estimate for blocks of size 2^( 2) =       0.000407381329
  error estimate for blocks of size 2^( 3) =       0.000416016845
  error estimate for blocks of size 2^( 4) =       0.000422849078
  error estimate for blocks of size 2^( 5) =       0.000426972325
  error estimate for blocks of size 2^( 6) =       0.000429434070
  error estimate for blocks of size 2^( 7) =       0.000430837803

      target function =                  N/A
              le_mean =     -17.216790677752
             les_mean =     296.734197090046
             stat err =       0.000427523319
             autocorr =       1.155655637178
              std dev =       0.562419777984
             le_variance =       0.316316006667

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316349987862
                                         uncertainty =       0.003526967920

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316349987862
                                         uncertainty =       0.003526967920

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397690376
  error estimate for blocks of size 2^( 2) =       0.000407381287
  error estimate for blocks of size 2^( 3) =       0.000416017938
  error estimate for blocks of size 2^( 4) =       0.000422851169
  error estimate for blocks of size 2^( 5) =       0.000426974813
  error estimate for blocks of size 2^( 6) =       0.000429437415
  error estimate for blocks of size 2^( 7) =       0.000430841567

      target function =                  N/A
              le_mean =     -17.216790623005
             les_mean =     296.734194469057
             stat err =       0.000427526241
             autocorr =       1.155674123437
              std dev =       0.562419123815
             le_variance =       0.316315270833


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216790614335        initial
     1.5625e+00     1.5625e+01             1.3666e-04       -17.216790685102  <--
     6.2500e+00     6.2500e+01             3.3972e-05       -17.216790677752
     2.5000e+01     2.5000e+02             8.5565e-06       -17.216790623005

*****************************************************************************
Applying the update for shift_i =   1.5625e+00     and shift_s =   1.5625e+01
*****************************************************************************

  Execution time = 2.9064e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 2.140294e-01 1 1  ON 0
 uu_1                 5.170332e-02 1 1  ON 1
 uu_2                -4.330940e-02 1 1  ON 2
 uu_3                -9.911004e-02 1 1  ON 3
 uu_4                -1.337931e-01 1 1  ON 4
 uu_5                -1.417699e-01 1 1  ON 5
 uu_6                -1.188625e-01 1 1  ON 6
 uu_7                -4.817411e-02 1 1  ON 7
 uu_8                 9.371316e-02 1 1  ON 8
 uu_9                 1.264317e-01 1 1  ON 9
 ud_0                 3.554084e-01 1 1  ON 10
 ud_1                 9.640320e-02 1 1  ON 11
 ud_2                -1.384284e-02 1 1  ON 12
 ud_3                -7.519486e-02 1 1  ON 13
 ud_4                -1.232629e-01 1 1  ON 14
 ud_5                -1.553723e-01 1 1  ON 15
 ud_6                -1.571878e-01 1 1  ON 16
 ud_7                -1.129290e-01 1 1  ON 17
 ud_8                -4.543960e-03 1 1  ON 18
 ud_9                 9.261228e-02 1 1  ON 19
 eO_0                -7.828919e-01 1 1  ON 20
 eO_1                -4.613987e-01 1 1  ON 21
 eO_2                -4.966036e-02 1 1  ON 22
 eO_3                 2.109264e-01 1 1  ON 23
 eO_4                 3.114942e-01 1 1  ON 24
 eO_5                 3.259370e-01 1 1  ON 25
 eO_6                 2.617664e-01 1 1  ON 26
 eO_7                 1.237923e-01 1 1  ON 27
 eO_8                 2.979206e-02 1 1  ON 28
 eO_9                 1.903946e-02 1 1  ON 29
eH1_0                -1.844479e-01 1 1  ON 30
eH1_1                -1.049248e-01 1 1  ON 31
eH1_2                -6.360267e-02 1 1  ON 32
eH1_3                -2.639240e-02 1 1  ON 33
eH1_4                 1.891188e-02 1 1  ON 34
eH1_5                 3.359742e-02 1 1  ON 35
eH1_6                 7.770945e-02 1 1  ON 36
eH1_7                 1.097214e-01 1 1  ON 37
eH1_8                 9.712261e-02 1 1  ON 38
eH1_9                 2.633482e-02 1 1  ON 39
eH2_0                -1.857192e-01 1 1  ON 40
eH2_1                -1.063970e-01 1 1  ON 41
eH2_2                -6.493787e-02 1 1  ON 42
eH2_3                -2.791711e-02 1 1  ON 43
eH2_4                 1.765689e-02 1 1  ON 44
eH2_5                 3.176711e-02 1 1  ON 45
eH2_6                 7.956233e-02 1 1  ON 46
eH2_7                 1.142247e-01 1 1  ON 47
eH2_8                 1.003340e-01 1 1  ON 48
eH2_9                 2.861467e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4830e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7188e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.1772
    reference variance = 0.186576
====================================================
  Execution time = 2.0046e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1647e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6006e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316434303561
                                         uncertainty =       0.003725619216

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316434303561
                                         uncertainty =       0.003725619216

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397786972
  error estimate for blocks of size 2^( 2) =       0.000407382647
  error estimate for blocks of size 2^( 3) =       0.000415799404
  error estimate for blocks of size 2^( 4) =       0.000422217254
  error estimate for blocks of size 2^( 5) =       0.000424831352
  error estimate for blocks of size 2^( 6) =       0.000425236310
  error estimate for blocks of size 2^( 7) =       0.000425806425

      target function =                  N/A
              le_mean =     -17.216300995261
             les_mean =     296.717488751666
             stat err =       0.000424522835
             autocorr =       1.138940406723
              std dev =       0.562555730987
             le_variance =       0.316468950466


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721630099526e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216300995261       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216300720477       residual = 9.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216300846802       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216301529022       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216301982937       residual = 2.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216302292744       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216302123880       residual = 8.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216302385635       residual = 9.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-01 is 6.283674e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216300995261       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216300891880       residual = 8.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216300887207       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216300995658       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216301249019       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216301381433       residual = 7.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216301320991       residual = 2.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216301362522       residual = 2.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 1.925736e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216300995261       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216300965682       residual = 8.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216300959890       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216300980208       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216301053034       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216301092716       residual = 5.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216301079267       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216301089031       residual = 1.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 5.221342e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.220929 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5655e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 2.139999e-01 1 1  ON 0
 uu_1                 5.169661e-02 1 1  ON 1
 uu_2                -4.325947e-02 1 1  ON 2
 uu_3                -9.904865e-02 1 1  ON 3
 uu_4                -1.337599e-01 1 1  ON 4
 uu_5                -1.418513e-01 1 1  ON 5
 uu_6                -1.189239e-01 1 1  ON 6
 uu_7                -4.817391e-02 1 1  ON 7
 uu_8                 9.367966e-02 1 1  ON 8
 uu_9                 1.264563e-01 1 1  ON 9
 ud_0                 3.554497e-01 1 1  ON 10
 ud_1                 9.641896e-02 1 1  ON 11
 ud_2                -1.381941e-02 1 1  ON 12
 ud_3                -7.527016e-02 1 1  ON 13
 ud_4                -1.232814e-01 1 1  ON 14
 ud_5                -1.553752e-01 1 1  ON 15
 ud_6                -1.571680e-01 1 1  ON 16
 ud_7                -1.129179e-01 1 1  ON 17
 ud_8                -4.597924e-03 1 1  ON 18
 ud_9                 9.261313e-02 1 1  ON 19
 eO_0                -7.829411e-01 1 1  ON 20
 eO_1                -4.615913e-01 1 1  ON 21
 eO_2                -4.975354e-02 1 1  ON 22
 eO_3                 2.109244e-01 1 1  ON 23
 eO_4                 3.115371e-01 1 1  ON 24
 eO_5                 3.260270e-01 1 1  ON 25
 eO_6                 2.618645e-01 1 1  ON 26
 eO_7                 1.238799e-01 1 1  ON 27
 eO_8                 2.980373e-02 1 1  ON 28
 eO_9                 1.904172e-02 1 1  ON 29
eH1_0                -1.843998e-01 1 1  ON 30
eH1_1                -1.049519e-01 1 1  ON 31
eH1_2                -6.357320e-02 1 1  ON 32
eH1_3                -2.642069e-02 1 1  ON 33
eH1_4                 1.891005e-02 1 1  ON 34
eH1_5                 3.353202e-02 1 1  ON 35
eH1_6                 7.768724e-02 1 1  ON 36
eH1_7                 1.097206e-01 1 1  ON 37
eH1_8                 9.716881e-02 1 1  ON 38
eH1_9                 2.634934e-02 1 1  ON 39
eH2_0                -1.857345e-01 1 1  ON 40
eH2_1                -1.064533e-01 1 1  ON 41
eH2_2                -6.493637e-02 1 1  ON 42
eH2_3                -2.795670e-02 1 1  ON 43
eH2_4                 1.770797e-02 1 1  ON 44
eH2_5                 3.178398e-02 1 1  ON 45
eH2_6                 7.953712e-02 1 1  ON 46
eH2_7                 1.142310e-01 1 1  ON 47
eH2_8                 1.003772e-01 1 1  ON 48
eH2_9                 2.862787e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.1291
    reference variance = 0.85432
====================================================
  Execution time = 1.9744e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1580e-01
  Total weights = 2.0000e+06
  Execution time = 1.8366e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315817620773
                                         uncertainty =       0.004255162450

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315817620773
                                         uncertainty =       0.004255162450

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397381849
  error estimate for blocks of size 2^( 2) =       0.000406781487
  error estimate for blocks of size 2^( 3) =       0.000415319397
  error estimate for blocks of size 2^( 4) =       0.000421746290
  error estimate for blocks of size 2^( 5) =       0.000425373527
  error estimate for blocks of size 2^( 6) =       0.000428789053
  error estimate for blocks of size 2^( 7) =       0.000430841407

      target function =                  N/A
              le_mean =     -17.216724902509
             les_mean =     296.731440878190
             stat err =       0.000426687569
             autocorr =       1.152932625338
              std dev =       0.561982799932
             le_variance =       0.315824667420

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315744931721
                                         uncertainty =       0.004255972845

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315744931721
                                         uncertainty =       0.004255972845

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397336144
  error estimate for blocks of size 2^( 2) =       0.000406737862
  error estimate for blocks of size 2^( 3) =       0.000415275635
  error estimate for blocks of size 2^( 4) =       0.000421701733
  error estimate for blocks of size 2^( 5) =       0.000425328470
  error estimate for blocks of size 2^( 6) =       0.000428747150
  error estimate for blocks of size 2^( 7) =       0.000430790368

      target function =                  N/A
              le_mean =     -17.216725299992
             les_mean =     296.731381920406
             stat err =       0.000426641930
             autocorr =       1.152951198768
              std dev =       0.561918163865
             le_variance =       0.315752022882

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315763603859
                                         uncertainty =       0.004256076130

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315763603859
                                         uncertainty =       0.004256076130

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397347867
  error estimate for blocks of size 2^( 2) =       0.000406749460
  error estimate for blocks of size 2^( 3) =       0.000415287802
  error estimate for blocks of size 2^( 4) =       0.000421714337
  error estimate for blocks of size 2^( 5) =       0.000425341584
  error estimate for blocks of size 2^( 6) =       0.000428759347
  error estimate for blocks of size 2^( 7) =       0.000430804610

      target function =                  N/A
              le_mean =     -17.216725176635
             les_mean =     296.731396305221
             stat err =       0.000426654969
             autocorr =       1.152953638159
              std dev =       0.561934742947
             le_variance =       0.315770655331

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315809586886
                                         uncertainty =       0.004255316645

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315809586886
                                         uncertainty =       0.004255316645

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397376794
  error estimate for blocks of size 2^( 2) =       0.000406776740
  error estimate for blocks of size 2^( 3) =       0.000415314740
  error estimate for blocks of size 2^( 4) =       0.000421741600
  error estimate for blocks of size 2^( 5) =       0.000425368857
  error estimate for blocks of size 2^( 6) =       0.000428784709
  error estimate for blocks of size 2^( 7) =       0.000430836029

      target function =                  N/A
              le_mean =     -17.216724919698
             les_mean =     296.731433435265
             stat err =       0.000426682799
             autocorr =       1.152936178711
              std dev =       0.561975651277
             le_variance =       0.315816632628


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216724902509        initial
     3.9062e-01     3.9062e+00             6.2837e-04       -17.216725299992  <--
     1.5625e+00     1.5625e+01             1.9257e-04       -17.216725176635
     6.2500e+00     6.2500e+01             5.2213e-05       -17.216724919698

*****************************************************************************
Applying the update for shift_i =   3.9062e-01     and shift_s =   3.9062e+00
*****************************************************************************

  Execution time = 2.8974e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 2.139269e-01 1 1  ON 0
 uu_1                 5.174020e-02 1 1  ON 1
 uu_2                -4.314805e-02 1 1  ON 2
 uu_3                -9.891027e-02 1 1  ON 3
 uu_4                -1.337062e-01 1 1  ON 4
 uu_5                -1.420307e-01 1 1  ON 5
 uu_6                -1.191094e-01 1 1  ON 6
 uu_7                -4.818098e-02 1 1  ON 7
 uu_8                 9.358401e-02 1 1  ON 8
 uu_9                 1.265264e-01 1 1  ON 9
 ud_0                 3.555130e-01 1 1  ON 10
 ud_1                 9.645785e-02 1 1  ON 11
 ud_2                -1.379604e-02 1 1  ON 12
 ud_3                -7.538516e-02 1 1  ON 13
 ud_4                -1.233465e-01 1 1  ON 14
 ud_5                -1.553838e-01 1 1  ON 15
 ud_6                -1.571011e-01 1 1  ON 16
 ud_7                -1.128814e-01 1 1  ON 17
 ud_8                -4.750288e-03 1 1  ON 18
 ud_9                 9.261571e-02 1 1  ON 19
 eO_0                -7.831815e-01 1 1  ON 20
 eO_1                -4.620271e-01 1 1  ON 21
 eO_2                -5.002400e-02 1 1  ON 22
 eO_3                 2.109006e-01 1 1  ON 23
 eO_4                 3.116695e-01 1 1  ON 24
 eO_5                 3.262845e-01 1 1  ON 25
 eO_6                 2.621432e-01 1 1  ON 26
 eO_7                 1.241296e-01 1 1  ON 27
 eO_8                 2.983704e-02 1 1  ON 28
 eO_9                 1.904816e-02 1 1  ON 29
eH1_0                -1.842676e-01 1 1  ON 30
eH1_1                -1.049991e-01 1 1  ON 31
eH1_2                -6.352936e-02 1 1  ON 32
eH1_3                -2.647165e-02 1 1  ON 33
eH1_4                 1.889634e-02 1 1  ON 34
eH1_5                 3.334440e-02 1 1  ON 35
eH1_6                 7.762003e-02 1 1  ON 36
eH1_7                 1.097178e-01 1 1  ON 37
eH1_8                 9.730049e-02 1 1  ON 38
eH1_9                 2.639077e-02 1 1  ON 39
eH2_0                -1.857913e-01 1 1  ON 40
eH2_1                -1.065850e-01 1 1  ON 41
eH2_2                -6.495478e-02 1 1  ON 42
eH2_3                -2.803747e-02 1 1  ON 43
eH2_4                 1.780850e-02 1 1  ON 44
eH2_5                 3.184789e-02 1 1  ON 45
eH2_6                 7.947023e-02 1 1  ON 46
eH2_7                 1.142489e-01 1 1  ON 47
eH2_8                 1.005003e-01 1 1  ON 48
eH2_9                 2.866549e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4720e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7182e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.2347
    reference variance = 0.140493
====================================================
  Execution time = 2.0258e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1400e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5255e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314068509521
                                         uncertainty =       0.002793467936

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314068509521
                                         uncertainty =       0.002793467936

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396234448
  error estimate for blocks of size 2^( 2) =       0.000405552519
  error estimate for blocks of size 2^( 3) =       0.000414406732
  error estimate for blocks of size 2^( 4) =       0.000421556749
  error estimate for blocks of size 2^( 5) =       0.000424403591
  error estimate for blocks of size 2^( 6) =       0.000427660480
  error estimate for blocks of size 2^( 7) =       0.000427013711

      target function =                  N/A
              le_mean =     -17.216545815611
             les_mean =     296.723453138949
             stat err =       0.000425158633
             autocorr =       1.151323965169
              std dev =       0.560360129661
             le_variance =       0.314003474913


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721654581561e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216545815611       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216547450213       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216547007081       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216546343846       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216546822845       residual = 8.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216549689214       residual = 6.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216550870123       residual = 3.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216549107291       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216549209793       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216549311241       residual = 2.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216549172596       residual = 8.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-02 is 2.495791e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216545815611       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216546724086       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216546256417       residual = 7.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216546250217       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216545980358       residual = 3.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216546927254       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216547171071       residual = 7.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216546819005       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216546883023       residual = 7.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-01 is 7.993498e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216545815611       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216546142766       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216545985244       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216545975575       residual = 5.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216545768447       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216545967540       residual = 6.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216546014111       residual = 2.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216545960552       residual = 3.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 2.381717e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.224976 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5791e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 2.139936e-01 1 1  ON 0
 uu_1                 5.160806e-02 1 1  ON 1
 uu_2                -4.323449e-02 1 1  ON 2
 uu_3                -9.894061e-02 1 1  ON 3
 uu_4                -1.336874e-01 1 1  ON 4
 uu_5                -1.420457e-01 1 1  ON 5
 uu_6                -1.192281e-01 1 1  ON 6
 uu_7                -4.819620e-02 1 1  ON 7
 uu_8                 9.350953e-02 1 1  ON 8
 uu_9                 1.266915e-01 1 1  ON 9
 ud_0                 3.555253e-01 1 1  ON 10
 ud_1                 9.663399e-02 1 1  ON 11
 ud_2                -1.382559e-02 1 1  ON 12
 ud_3                -7.541378e-02 1 1  ON 13
 ud_4                -1.235451e-01 1 1  ON 14
 ud_5                -1.555452e-01 1 1  ON 15
 ud_6                -1.570128e-01 1 1  ON 16
 ud_7                -1.128647e-01 1 1  ON 17
 ud_8                -4.891868e-03 1 1  ON 18
 ud_9                 9.265713e-02 1 1  ON 19
 eO_0                -7.839809e-01 1 1  ON 20
 eO_1                -4.622945e-01 1 1  ON 21
 eO_2                -5.033811e-02 1 1  ON 22
 eO_3                 2.109329e-01 1 1  ON 23
 eO_4                 3.116587e-01 1 1  ON 24
 eO_5                 3.267446e-01 1 1  ON 25
 eO_6                 2.625706e-01 1 1  ON 26
 eO_7                 1.244746e-01 1 1  ON 27
 eO_8                 2.991285e-02 1 1  ON 28
 eO_9                 1.907733e-02 1 1  ON 29
eH1_0                -1.844705e-01 1 1  ON 30
eH1_1                -1.050069e-01 1 1  ON 31
eH1_2                -6.355161e-02 1 1  ON 32
eH1_3                -2.637210e-02 1 1  ON 33
eH1_4                 1.895551e-02 1 1  ON 34
eH1_5                 3.312456e-02 1 1  ON 35
eH1_6                 7.757529e-02 1 1  ON 36
eH1_7                 1.097451e-01 1 1  ON 37
eH1_8                 9.752326e-02 1 1  ON 38
eH1_9                 2.646683e-02 1 1  ON 39
eH2_0                -1.856693e-01 1 1  ON 40
eH2_1                -1.065182e-01 1 1  ON 41
eH2_2                -6.500166e-02 1 1  ON 42
eH2_3                -2.791162e-02 1 1  ON 43
eH2_4                 1.767139e-02 1 1  ON 44
eH2_5                 3.164562e-02 1 1  ON 45
eH2_6                 7.927621e-02 1 1  ON 46
eH2_7                 1.142095e-01 1 1  ON 47
eH2_8                 1.007081e-01 1 1  ON 48
eH2_9                 2.872747e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.1835
    reference variance = 0.450898
====================================================
  Execution time = 2.0007e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2679e-01
  Total weights = 2.0000e+06
  Execution time = 1.8519e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326871577816
                                         uncertainty =       0.007645459445

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326871577816
                                         uncertainty =       0.007645459445

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404197142
  error estimate for blocks of size 2^( 2) =       0.000413726251
  error estimate for blocks of size 2^( 3) =       0.000422470382
  error estimate for blocks of size 2^( 4) =       0.000428915933
  error estimate for blocks of size 2^( 5) =       0.000433717924
  error estimate for blocks of size 2^( 6) =       0.000436986101
  error estimate for blocks of size 2^( 7) =       0.000439044215

      target function =                  N/A
              le_mean =     -17.217319804645
             les_mean =     296.762851751377
             stat err =       0.000434666043
             autocorr =       1.156444914202
              std dev =       0.571621080206
             le_variance =       0.326750659335

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327052464257
                                         uncertainty =       0.007644476516

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327052464257
                                         uncertainty =       0.007644476516

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404309000
  error estimate for blocks of size 2^( 2) =       0.000413832128
  error estimate for blocks of size 2^( 3) =       0.000422563782
  error estimate for blocks of size 2^( 4) =       0.000429004196
  error estimate for blocks of size 2^( 5) =       0.000433796972
  error estimate for blocks of size 2^( 6) =       0.000437064551
  error estimate for blocks of size 2^( 7) =       0.000439142167

      target function =                  N/A
              le_mean =     -17.217320632863
             les_mean =     296.763061145562
             stat err =       0.000434751972
             autocorr =       1.156262134663
              std dev =       0.571779270526
             le_variance =       0.326931534204

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326951892140
                                         uncertainty =       0.007637938328

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326951892140
                                         uncertainty =       0.007637938328

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404246835
  error estimate for blocks of size 2^( 2) =       0.000413771924
  error estimate for blocks of size 2^( 3) =       0.000422505197
  error estimate for blocks of size 2^( 4) =       0.000428948069
  error estimate for blocks of size 2^( 5) =       0.000433742080
  error estimate for blocks of size 2^( 6) =       0.000437010630
  error estimate for blocks of size 2^( 7) =       0.000439091981

      target function =                  N/A
              le_mean =     -17.217320656741
             les_mean =     296.762961440505
             stat err =       0.000434698190
             autocorr =       1.156331636647
              std dev =       0.571691356310
             le_variance =       0.326831006880

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326864706077
                                         uncertainty =       0.007643226290

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326864706077
                                         uncertainty =       0.007643226290

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404192905
  error estimate for blocks of size 2^( 2) =       0.000413721573
  error estimate for blocks of size 2^( 3) =       0.000422463850
  error estimate for blocks of size 2^( 4) =       0.000428909274
  error estimate for blocks of size 2^( 5) =       0.000433709680
  error estimate for blocks of size 2^( 6) =       0.000436978254
  error estimate for blocks of size 2^( 7) =       0.000439041492

      target function =                  N/A
              le_mean =     -17.217319795345
             les_mean =     296.762844580976
             stat err =       0.000434659675
             autocorr =       1.156435273418
              std dev =       0.571615088298
             le_variance =       0.326743809170


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217319804645        initial
     9.7656e-02     9.7656e-01             2.4958e-03       -17.217320632863
     3.9062e-01     3.9062e+00             7.9935e-04       -17.217320656741  <--
     1.5625e+00     1.5625e+01             2.3817e-04       -17.217319795345

*****************************************************************************
Applying the update for shift_i =   3.9062e-01     and shift_s =   3.9062e+00
*****************************************************************************

  Execution time = 2.9242e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 2.139936e-01 1 1  ON 0
 uu_1                 5.160806e-02 1 1  ON 1
 uu_2                -4.323449e-02 1 1  ON 2
 uu_3                -9.894061e-02 1 1  ON 3
 uu_4                -1.336874e-01 1 1  ON 4
 uu_5                -1.420457e-01 1 1  ON 5
 uu_6                -1.192281e-01 1 1  ON 6
 uu_7                -4.819620e-02 1 1  ON 7
 uu_8                 9.350953e-02 1 1  ON 8
 uu_9                 1.266915e-01 1 1  ON 9
 ud_0                 3.555253e-01 1 1  ON 10
 ud_1                 9.663399e-02 1 1  ON 11
 ud_2                -1.382559e-02 1 1  ON 12
 ud_3                -7.541378e-02 1 1  ON 13
 ud_4                -1.235451e-01 1 1  ON 14
 ud_5                -1.555452e-01 1 1  ON 15
 ud_6                -1.570128e-01 1 1  ON 16
 ud_7                -1.128647e-01 1 1  ON 17
 ud_8                -4.891868e-03 1 1  ON 18
 ud_9                 9.265713e-02 1 1  ON 19
 eO_0                -7.839809e-01 1 1  ON 20
 eO_1                -4.622945e-01 1 1  ON 21
 eO_2                -5.033811e-02 1 1  ON 22
 eO_3                 2.109329e-01 1 1  ON 23
 eO_4                 3.116587e-01 1 1  ON 24
 eO_5                 3.267446e-01 1 1  ON 25
 eO_6                 2.625706e-01 1 1  ON 26
 eO_7                 1.244746e-01 1 1  ON 27
 eO_8                 2.991285e-02 1 1  ON 28
 eO_9                 1.907733e-02 1 1  ON 29
eH1_0                -1.844705e-01 1 1  ON 30
eH1_1                -1.050069e-01 1 1  ON 31
eH1_2                -6.355161e-02 1 1  ON 32
eH1_3                -2.637210e-02 1 1  ON 33
eH1_4                 1.895551e-02 1 1  ON 34
eH1_5                 3.312456e-02 1 1  ON 35
eH1_6                 7.757529e-02 1 1  ON 36
eH1_7                 1.097451e-01 1 1  ON 37
eH1_8                 9.752326e-02 1 1  ON 38
eH1_9                 2.646683e-02 1 1  ON 39
eH2_0                -1.856693e-01 1 1  ON 40
eH2_1                -1.065182e-01 1 1  ON 41
eH2_2                -6.500166e-02 1 1  ON 42
eH2_3                -2.791162e-02 1 1  ON 43
eH2_4                 1.767139e-02 1 1  ON 44
eH2_5                 3.164562e-02 1 1  ON 45
eH2_6                 7.927621e-02 1 1  ON 46
eH2_7                 1.142095e-01 1 1  ON 47
eH2_8                 1.007081e-01 1 1  ON 48
eH2_9                 2.872747e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5040e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7186e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.2318
    reference variance = 0.182786
====================================================
  Execution time = 2.2102e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2287e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5623e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322837723236
                                         uncertainty =       0.004027857797

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322837723236
                                         uncertainty =       0.004027857797

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401787729
  error estimate for blocks of size 2^( 2) =       0.000411815626
  error estimate for blocks of size 2^( 3) =       0.000420309714
  error estimate for blocks of size 2^( 4) =       0.000426624810
  error estimate for blocks of size 2^( 5) =       0.000430527740
  error estimate for blocks of size 2^( 6) =       0.000432446749
  error estimate for blocks of size 2^( 7) =       0.000434266932

      target function =                  N/A
              le_mean =     -17.216696914019
             les_mean =     296.737519226905
             stat err =       0.000430966558
             autocorr =       1.150519020858
              std dev =       0.568213656249
             le_variance =       0.322866759148


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721669691402e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216696914019       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216696334998       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216697690932       residual = 7.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216695604617       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216696899915       residual = 7.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216700124296       residual = 6.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216700071386       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216698977576       residual = 7.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216699300772       residual = 4.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216699208082       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216699652217       residual = 3.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-02 is 2.022471e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216696914019       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216696653741       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216697329581       residual = 7.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216696202073       residual = 6.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216696379217       residual = 2.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216697441552       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216697529707       residual = 2.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216697410766       residual = 5.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-01 is 5.096774e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216696914019       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216696832731       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216697063033       residual = 8.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216696654134       residual = 4.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216696594936       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216696842640       residual = 4.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216696923661       residual = 8.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 1.265508e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.228159 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7671e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 2.139291e-01 1 1  ON 0
 uu_1                 5.170326e-02 1 1  ON 1
 uu_2                -4.309735e-02 1 1  ON 2
 uu_3                -9.890160e-02 1 1  ON 3
 uu_4                -1.336770e-01 1 1  ON 4
 uu_5                -1.420539e-01 1 1  ON 5
 uu_6                -1.193229e-01 1 1  ON 6
 uu_7                -4.839787e-02 1 1  ON 7
 uu_8                 9.333068e-02 1 1  ON 8
 uu_9                 1.268083e-01 1 1  ON 9
 ud_0                 3.556076e-01 1 1  ON 10
 ud_1                 9.657687e-02 1 1  ON 11
 ud_2                -1.379221e-02 1 1  ON 12
 ud_3                -7.546060e-02 1 1  ON 13
 ud_4                -1.234663e-01 1 1  ON 14
 ud_5                -1.555608e-01 1 1  ON 15
 ud_6                -1.569578e-01 1 1  ON 16
 ud_7                -1.128618e-01 1 1  ON 17
 ud_8                -5.175337e-03 1 1  ON 18
 ud_9                 9.262390e-02 1 1  ON 19
 eO_0                -7.844906e-01 1 1  ON 20
 eO_1                -4.627817e-01 1 1  ON 21
 eO_2                -5.072655e-02 1 1  ON 22
 eO_3                 2.108528e-01 1 1  ON 23
 eO_4                 3.119175e-01 1 1  ON 24
 eO_5                 3.271823e-01 1 1  ON 25
 eO_6                 2.629229e-01 1 1  ON 26
 eO_7                 1.248013e-01 1 1  ON 27
 eO_8                 2.997459e-02 1 1  ON 28
 eO_9                 1.909385e-02 1 1  ON 29
eH1_0                -1.844179e-01 1 1  ON 30
eH1_1                -1.050182e-01 1 1  ON 31
eH1_2                -6.354477e-02 1 1  ON 32
eH1_3                -2.647635e-02 1 1  ON 33
eH1_4                 1.893029e-02 1 1  ON 34
eH1_5                 3.294369e-02 1 1  ON 35
eH1_6                 7.760147e-02 1 1  ON 36
eH1_7                 1.097715e-01 1 1  ON 37
eH1_8                 9.767501e-02 1 1  ON 38
eH1_9                 2.651661e-02 1 1  ON 39
eH2_0                -1.854263e-01 1 1  ON 40
eH2_1                -1.065523e-01 1 1  ON 41
eH2_2                -6.496975e-02 1 1  ON 42
eH2_3                -2.789799e-02 1 1  ON 43
eH2_4                 1.751145e-02 1 1  ON 44
eH2_5                 3.152875e-02 1 1  ON 45
eH2_6                 7.912287e-02 1 1  ON 46
eH2_7                 1.141653e-01 1 1  ON 47
eH2_8                 1.008611e-01 1 1  ON 48
eH2_9                 2.877377e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.1868
    reference variance = 0.211752
====================================================
  Execution time = 2.0106e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1626e-01
  Total weights = 2.0000e+06
  Execution time = 2.2422e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316205236031
                                         uncertainty =       0.003052896952

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316205236031
                                         uncertainty =       0.003052896952

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397638398
  error estimate for blocks of size 2^( 2) =       0.000407234654
  error estimate for blocks of size 2^( 3) =       0.000415893787
  error estimate for blocks of size 2^( 4) =       0.000421827468
  error estimate for blocks of size 2^( 5) =       0.000424772321
  error estimate for blocks of size 2^( 6) =       0.000425944670
  error estimate for blocks of size 2^( 7) =       0.000426878012

      target function =                  N/A
              le_mean =     -17.217460371753
             les_mean =     296.757174085551
             stat err =       0.000424855618
             autocorr =       1.141579338795
              std dev =       0.562345615049
             le_variance =       0.316232590765

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316328651416
                                         uncertainty =       0.003053739450

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316328651416
                                         uncertainty =       0.003053739450

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397715967
  error estimate for blocks of size 2^( 2) =       0.000407307654
  error estimate for blocks of size 2^( 3) =       0.000415960998
  error estimate for blocks of size 2^( 4) =       0.000421890897
  error estimate for blocks of size 2^( 5) =       0.000424833957
  error estimate for blocks of size 2^( 6) =       0.000426006850
  error estimate for blocks of size 2^( 7) =       0.000426941326

      target function =                  N/A
              le_mean =     -17.217459933524
             les_mean =     296.757282385612
             stat err =       0.000424918257
             autocorr =       1.141470597770
              std dev =       0.562455314934
             le_variance =       0.316355981297

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316271564055
                                         uncertainty =       0.003053266157

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316271564055
                                         uncertainty =       0.003053266157

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397680050
  error estimate for blocks of size 2^( 2) =       0.000407273830
  error estimate for blocks of size 2^( 3) =       0.000415929468
  error estimate for blocks of size 2^( 4) =       0.000421862261
  error estimate for blocks of size 2^( 5) =       0.000424808111
  error estimate for blocks of size 2^( 6) =       0.000425983123
  error estimate for blocks of size 2^( 7) =       0.000426920539

      target function =                  N/A
              le_mean =     -17.217459125507
             les_mean =     296.757197424801
             stat err =       0.000424893508
             autocorr =       1.141543806171
              std dev =       0.562404520292
             le_variance =       0.316298844445

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316233299665
                                         uncertainty =       0.003053102019

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316233299665
                                         uncertainty =       0.003053102019

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397656024
  error estimate for blocks of size 2^( 2) =       0.000407251423
  error estimate for blocks of size 2^( 3) =       0.000415909665
  error estimate for blocks of size 2^( 4) =       0.000421843190
  error estimate for blocks of size 2^( 5) =       0.000424788416
  error estimate for blocks of size 2^( 6) =       0.000425962089
  error estimate for blocks of size 2^( 7) =       0.000426896640

      target function =                  N/A
              le_mean =     -17.217460006132
             les_mean =     296.757189531868
             stat err =       0.000424872584
             autocorr =       1.141569307098
              std dev =       0.562370542642
             le_variance =       0.316260627231


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217460371753        initial  <--
     9.7656e-02     9.7656e-01             2.0225e-03       -17.217459933524
     3.9062e-01     3.9062e+00             5.0968e-04       -17.217459125507
     1.5625e+00     1.5625e+01             1.2655e-04       -17.217460006132

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9214
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 2.139936e-01 1 1  ON 0
 uu_1                 5.160806e-02 1 1  ON 1
 uu_2                -4.323449e-02 1 1  ON 2
 uu_3                -9.894061e-02 1 1  ON 3
 uu_4                -1.336874e-01 1 1  ON 4
 uu_5                -1.420457e-01 1 1  ON 5
 uu_6                -1.192281e-01 1 1  ON 6
 uu_7                -4.819620e-02 1 1  ON 7
 uu_8                 9.350953e-02 1 1  ON 8
 uu_9                 1.266915e-01 1 1  ON 9
 ud_0                 3.555253e-01 1 1  ON 10
 ud_1                 9.663399e-02 1 1  ON 11
 ud_2                -1.382559e-02 1 1  ON 12
 ud_3                -7.541378e-02 1 1  ON 13
 ud_4                -1.235451e-01 1 1  ON 14
 ud_5                -1.555452e-01 1 1  ON 15
 ud_6                -1.570128e-01 1 1  ON 16
 ud_7                -1.128647e-01 1 1  ON 17
 ud_8                -4.891868e-03 1 1  ON 18
 ud_9                 9.265713e-02 1 1  ON 19
 eO_0                -7.839809e-01 1 1  ON 20
 eO_1                -4.622945e-01 1 1  ON 21
 eO_2                -5.033811e-02 1 1  ON 22
 eO_3                 2.109329e-01 1 1  ON 23
 eO_4                 3.116587e-01 1 1  ON 24
 eO_5                 3.267446e-01 1 1  ON 25
 eO_6                 2.625706e-01 1 1  ON 26
 eO_7                 1.244746e-01 1 1  ON 27
 eO_8                 2.991285e-02 1 1  ON 28
 eO_9                 1.907733e-02 1 1  ON 29
eH1_0                -1.844705e-01 1 1  ON 30
eH1_1                -1.050069e-01 1 1  ON 31
eH1_2                -6.355161e-02 1 1  ON 32
eH1_3                -2.637210e-02 1 1  ON 33
eH1_4                 1.895551e-02 1 1  ON 34
eH1_5                 3.312456e-02 1 1  ON 35
eH1_6                 7.757529e-02 1 1  ON 36
eH1_7                 1.097451e-01 1 1  ON 37
eH1_8                 9.752326e-02 1 1  ON 38
eH1_9                 2.646683e-02 1 1  ON 39
eH2_0                -1.856693e-01 1 1  ON 40
eH2_1                -1.065182e-01 1 1  ON 41
eH2_2                -6.500166e-02 1 1  ON 42
eH2_3                -2.791162e-02 1 1  ON 43
eH2_4                 1.767139e-02 1 1  ON 44
eH2_5                 3.164562e-02 1 1  ON 45
eH2_6                 7.927621e-02 1 1  ON 46
eH2_7                 1.142095e-01 1 1  ON 47
eH2_8                 1.007081e-01 1 1  ON 48
eH2_9                 2.872747e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7599e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7189e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.2101
    reference variance = 0.20898
====================================================
  Execution time = 2.0236e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1269e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5221e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312770918158
                                         uncertainty =       0.002695140500

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312770918158
                                         uncertainty =       0.002695140500

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395405218
  error estimate for blocks of size 2^( 2) =       0.000405279010
  error estimate for blocks of size 2^( 3) =       0.000414234854
  error estimate for blocks of size 2^( 4) =       0.000420829608
  error estimate for blocks of size 2^( 5) =       0.000424727726
  error estimate for blocks of size 2^( 6) =       0.000426531153
  error estimate for blocks of size 2^( 7) =       0.000427002640

      target function =                  N/A
              le_mean =     -17.217270884221
             les_mean =     296.747107117017
             stat err =       0.000424772782
             autocorr =       1.154060480092
              std dev =       0.559187421831
             le_variance =       0.312690572733


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721727088422e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217270884221       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217271231598       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217271551578       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217271960280       residual = 7.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217271772891       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217271818097       residual = 8.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217271694740       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217271703593       residual = 3.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-01 is 2.551918e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217270884221       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217270994324       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217271073982       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217271204296       residual = 6.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217271154161       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217271145700       residual = 4.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217271147299       residual = 7.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+00 is 7.108763e-05

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217270884221       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217270913722       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217270933676       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217270968554       residual = 5.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217270955967       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217270952025       residual = 3.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217270954580       residual = 5.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+01 is 1.836012e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.230642 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5765e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 2.139642e-01 1 1  ON 0
 uu_1                 5.162391e-02 1 1  ON 1
 uu_2                -4.320544e-02 1 1  ON 2
 uu_3                -9.891914e-02 1 1  ON 3
 uu_4                -1.336991e-01 1 1  ON 4
 uu_5                -1.420513e-01 1 1  ON 5
 uu_6                -1.192393e-01 1 1  ON 6
 uu_7                -4.821413e-02 1 1  ON 7
 uu_8                 9.349171e-02 1 1  ON 8
 uu_9                 1.267013e-01 1 1  ON 9
 ud_0                 3.554982e-01 1 1  ON 10
 ud_1                 9.664065e-02 1 1  ON 11
 ud_2                -1.382861e-02 1 1  ON 12
 ud_3                -7.541441e-02 1 1  ON 13
 ud_4                -1.235296e-01 1 1  ON 14
 ud_5                -1.555347e-01 1 1  ON 15
 ud_6                -1.570113e-01 1 1  ON 16
 ud_7                -1.128617e-01 1 1  ON 17
 ud_8                -4.914128e-03 1 1  ON 18
 ud_9                 9.265664e-02 1 1  ON 19
 eO_0                -7.840520e-01 1 1  ON 20
 eO_1                -4.623062e-01 1 1  ON 21
 eO_2                -5.038016e-02 1 1  ON 22
 eO_3                 2.109058e-01 1 1  ON 23
 eO_4                 3.116854e-01 1 1  ON 24
 eO_5                 3.267988e-01 1 1  ON 25
 eO_6                 2.626049e-01 1 1  ON 26
 eO_7                 1.245039e-01 1 1  ON 27
 eO_8                 2.991679e-02 1 1  ON 28
 eO_9                 1.907913e-02 1 1  ON 29
eH1_0                -1.844586e-01 1 1  ON 30
eH1_1                -1.050214e-01 1 1  ON 31
eH1_2                -6.356390e-02 1 1  ON 32
eH1_3                -2.636960e-02 1 1  ON 33
eH1_4                 1.895303e-02 1 1  ON 34
eH1_5                 3.310286e-02 1 1  ON 35
eH1_6                 7.758029e-02 1 1  ON 36
eH1_7                 1.097524e-01 1 1  ON 37
eH1_8                 9.754105e-02 1 1  ON 38
eH1_9                 2.647198e-02 1 1  ON 39
eH2_0                -1.856971e-01 1 1  ON 40
eH2_1                -1.065226e-01 1 1  ON 41
eH2_2                -6.499692e-02 1 1  ON 42
eH2_3                -2.791918e-02 1 1  ON 43
eH2_4                 1.766944e-02 1 1  ON 44
eH2_5                 3.164232e-02 1 1  ON 45
eH2_6                 7.928085e-02 1 1  ON 46
eH2_7                 1.142154e-01 1 1  ON 47
eH2_8                 1.007294e-01 1 1  ON 48
eH2_9                 2.873326e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.2495
    reference variance = 0.228595
====================================================
  Execution time = 1.9768e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2852e-01
  Total weights = 2.0000e+06
  Execution time = 1.8399e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328335401347
                                         uncertainty =       0.011669251540

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328335401347
                                         uncertainty =       0.011669251540

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405307321
  error estimate for blocks of size 2^( 2) =       0.000414626067
  error estimate for blocks of size 2^( 3) =       0.000423054445
  error estimate for blocks of size 2^( 4) =       0.000429704473
  error estimate for blocks of size 2^( 5) =       0.000433157231
  error estimate for blocks of size 2^( 6) =       0.000435553325
  error estimate for blocks of size 2^( 7) =       0.000436067300

      target function =                  N/A
              le_mean =     -17.216186717337
             les_mean =     296.725632971355
             stat err =       0.000433620582
             autocorr =       1.144592456491
              std dev =       0.573191110716
             le_variance =       0.328548049403

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328257734820
                                         uncertainty =       0.011676869168

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328257734820
                                         uncertainty =       0.011676869168

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405259314
  error estimate for blocks of size 2^( 2) =       0.000414579437
  error estimate for blocks of size 2^( 3) =       0.000423009177
  error estimate for blocks of size 2^( 4) =       0.000429660399
  error estimate for blocks of size 2^( 5) =       0.000433113630
  error estimate for blocks of size 2^( 6) =       0.000435510481
  error estimate for blocks of size 2^( 7) =       0.000436026394

      target function =                  N/A
              le_mean =     -17.216186241819
             les_mean =     296.725538772069
             stat err =       0.000433577726
             autocorr =       1.144637358428
              std dev =       0.573123218262
             le_variance =       0.328470223310

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328280958579
                                         uncertainty =       0.011674030472

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328280958579
                                         uncertainty =       0.011674030472

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405273673
  error estimate for blocks of size 2^( 2) =       0.000414593412
  error estimate for blocks of size 2^( 3) =       0.000423022800
  error estimate for blocks of size 2^( 4) =       0.000429673805
  error estimate for blocks of size 2^( 5) =       0.000433127011
  error estimate for blocks of size 2^( 6) =       0.000435523584
  error estimate for blocks of size 2^( 7) =       0.000436038517

      target function =                  N/A
              le_mean =     -17.216186456598
             les_mean =     296.725569444113
             stat err =       0.000433590729
             autocorr =       1.144624904116
              std dev =       0.573143524797
             le_variance =       0.328493500017

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328327973467
                                         uncertainty =       0.011669885411

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328327973467
                                         uncertainty =       0.011669885411

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405302731
  error estimate for blocks of size 2^( 2) =       0.000414621611
  error estimate for blocks of size 2^( 3) =       0.000423050127
  error estimate for blocks of size 2^( 4) =       0.000429700292
  error estimate for blocks of size 2^( 5) =       0.000433153113
  error estimate for blocks of size 2^( 6) =       0.000435549269
  error estimate for blocks of size 2^( 7) =       0.000436063363

      target function =                  N/A
              le_mean =     -17.216186679502
             les_mean =     296.725624226229
             stat err =       0.000433616509
             autocorr =       1.144596880062
              std dev =       0.573184618626
             le_variance =       0.328540607029


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216186717337        initial  <--
     9.7656e-01     9.7656e+00             2.5519e-04       -17.216186241819
     3.9062e+00     3.9062e+01             7.1088e-05       -17.216186456598
     1.5625e+01     1.5625e+02             1.8360e-05       -17.216186679502

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.0078
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 2.139936e-01 1 1  ON 0
 uu_1                 5.160806e-02 1 1  ON 1
 uu_2                -4.323449e-02 1 1  ON 2
 uu_3                -9.894061e-02 1 1  ON 3
 uu_4                -1.336874e-01 1 1  ON 4
 uu_5                -1.420457e-01 1 1  ON 5
 uu_6                -1.192281e-01 1 1  ON 6
 uu_7                -4.819620e-02 1 1  ON 7
 uu_8                 9.350953e-02 1 1  ON 8
 uu_9                 1.266915e-01 1 1  ON 9
 ud_0                 3.555253e-01 1 1  ON 10
 ud_1                 9.663399e-02 1 1  ON 11
 ud_2                -1.382559e-02 1 1  ON 12
 ud_3                -7.541378e-02 1 1  ON 13
 ud_4                -1.235451e-01 1 1  ON 14
 ud_5                -1.555452e-01 1 1  ON 15
 ud_6                -1.570128e-01 1 1  ON 16
 ud_7                -1.128647e-01 1 1  ON 17
 ud_8                -4.891868e-03 1 1  ON 18
 ud_9                 9.265713e-02 1 1  ON 19
 eO_0                -7.839809e-01 1 1  ON 20
 eO_1                -4.622945e-01 1 1  ON 21
 eO_2                -5.033811e-02 1 1  ON 22
 eO_3                 2.109329e-01 1 1  ON 23
 eO_4                 3.116587e-01 1 1  ON 24
 eO_5                 3.267446e-01 1 1  ON 25
 eO_6                 2.625706e-01 1 1  ON 26
 eO_7                 1.244746e-01 1 1  ON 27
 eO_8                 2.991285e-02 1 1  ON 28
 eO_9                 1.907733e-02 1 1  ON 29
eH1_0                -1.844705e-01 1 1  ON 30
eH1_1                -1.050069e-01 1 1  ON 31
eH1_2                -6.355161e-02 1 1  ON 32
eH1_3                -2.637210e-02 1 1  ON 33
eH1_4                 1.895551e-02 1 1  ON 34
eH1_5                 3.312456e-02 1 1  ON 35
eH1_6                 7.757529e-02 1 1  ON 36
eH1_7                 1.097451e-01 1 1  ON 37
eH1_8                 9.752326e-02 1 1  ON 38
eH1_9                 2.646683e-02 1 1  ON 39
eH2_0                -1.856693e-01 1 1  ON 40
eH2_1                -1.065182e-01 1 1  ON 41
eH2_2                -6.500166e-02 1 1  ON 42
eH2_3                -2.791162e-02 1 1  ON 43
eH2_4                 1.767139e-02 1 1  ON 44
eH2_5                 3.164562e-02 1 1  ON 45
eH2_6                 7.927621e-02 1 1  ON 46
eH2_7                 1.142095e-01 1 1  ON 47
eH2_8                 1.007081e-01 1 1  ON 48
eH2_9                 2.872747e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4784e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7193e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.2272
    reference variance = 0.349171
====================================================
  Execution time = 2.0249e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1537e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5199e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315347958759
                                         uncertainty =       0.003114392018

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315347958759
                                         uncertainty =       0.003114392018

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397098365
  error estimate for blocks of size 2^( 2) =       0.000407050410
  error estimate for blocks of size 2^( 3) =       0.000415865894
  error estimate for blocks of size 2^( 4) =       0.000421733668
  error estimate for blocks of size 2^( 5) =       0.000426269054
  error estimate for blocks of size 2^( 6) =       0.000430219657
  error estimate for blocks of size 2^( 7) =       0.000430410458

      target function =                  N/A
              le_mean =     -17.216175325233
             les_mean =     296.712066894404
             stat err =       0.000427158209
             autocorr =       1.157127771423
              std dev =       0.561581893335
             le_variance =       0.315374222922


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721617532523e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216175325233       residual = 4.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216175319888       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216175406928       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216175355150       residual = 5.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216175417088       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216175410916       residual = 2.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216175417098       residual = 7.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+00 is 3.601949e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216175325233       residual = 4.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216175323882       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216175345975       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216175332562       residual = 5.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216175348168       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216175346851       residual = 2.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216175348309       residual = 7.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+01 is 9.095875e-06

solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216175325233       residual = 4.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216175324894       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216175330439       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216175327056       residual = 5.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216175330964       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216175330649       residual = 2.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216175331009       residual = 7.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+02 is 2.279819e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.232949 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5776e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 2.139911e-01 1 1  ON 0
 uu_1                 5.160997e-02 1 1  ON 1
 uu_2                -4.323161e-02 1 1  ON 2
 uu_3                -9.894110e-02 1 1  ON 3
 uu_4                -1.336881e-01 1 1  ON 4
 uu_5                -1.420459e-01 1 1  ON 5
 uu_6                -1.192291e-01 1 1  ON 6
 uu_7                -4.819808e-02 1 1  ON 7
 uu_8                 9.350779e-02 1 1  ON 8
 uu_9                 1.266931e-01 1 1  ON 9
 ud_0                 3.555273e-01 1 1  ON 10
 ud_1                 9.663336e-02 1 1  ON 11
 ud_2                -1.382574e-02 1 1  ON 12
 ud_3                -7.541469e-02 1 1  ON 13
 ud_4                -1.235454e-01 1 1  ON 14
 ud_5                -1.555438e-01 1 1  ON 15
 ud_6                -1.570128e-01 1 1  ON 16
 ud_7                -1.128649e-01 1 1  ON 17
 ud_8                -4.894671e-03 1 1  ON 18
 ud_9                 9.265710e-02 1 1  ON 19
 eO_0                -7.839851e-01 1 1  ON 20
 eO_1                -4.623036e-01 1 1  ON 21
 eO_2                -5.034131e-02 1 1  ON 22
 eO_3                 2.109356e-01 1 1  ON 23
 eO_4                 3.116609e-01 1 1  ON 24
 eO_5                 3.267490e-01 1 1  ON 25
 eO_6                 2.625740e-01 1 1  ON 26
 eO_7                 1.244776e-01 1 1  ON 27
 eO_8                 2.991342e-02 1 1  ON 28
 eO_9                 1.907746e-02 1 1  ON 29
eH1_0                -1.844696e-01 1 1  ON 30
eH1_1                -1.050082e-01 1 1  ON 31
eH1_2                -6.355234e-02 1 1  ON 32
eH1_3                -2.637198e-02 1 1  ON 33
eH1_4                 1.895290e-02 1 1  ON 34
eH1_5                 3.312387e-02 1 1  ON 35
eH1_6                 7.757648e-02 1 1  ON 36
eH1_7                 1.097455e-01 1 1  ON 37
eH1_8                 9.752516e-02 1 1  ON 38
eH1_9                 2.646743e-02 1 1  ON 39
eH2_0                -1.856691e-01 1 1  ON 40
eH2_1                -1.065184e-01 1 1  ON 41
eH2_2                -6.500206e-02 1 1  ON 42
eH2_3                -2.791140e-02 1 1  ON 43
eH2_4                 1.767120e-02 1 1  ON 44
eH2_5                 3.164481e-02 1 1  ON 45
eH2_6                 7.927602e-02 1 1  ON 46
eH2_7                 1.142089e-01 1 1  ON 47
eH2_8                 1.007095e-01 1 1  ON 48
eH2_9                 2.872782e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.3124
    reference variance = 0.334099
====================================================
  Execution time = 2.0283e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.3199e-01
  Total weights = 2.0000e+06
  Execution time = 1.8189e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332089265193
                                         uncertainty =       0.014132896957

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332089265193
                                         uncertainty =       0.014132896957

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407424204
  error estimate for blocks of size 2^( 2) =       0.000416982480
  error estimate for blocks of size 2^( 3) =       0.000425996505
  error estimate for blocks of size 2^( 4) =       0.000432660535
  error estimate for blocks of size 2^( 5) =       0.000436378002
  error estimate for blocks of size 2^( 6) =       0.000438899763
  error estimate for blocks of size 2^( 7) =       0.000441422793

      target function =                  N/A
              le_mean =     -17.216196016023
             les_mean =     296.729394059726
             stat err =       0.000437340273
             autocorr =       1.152246222620
              std dev =       0.576184834577
             le_variance =       0.331988963597

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332092478120
                                         uncertainty =       0.014133246112

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332092478120
                                         uncertainty =       0.014133246112

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407426175
  error estimate for blocks of size 2^( 2) =       0.000416984281
  error estimate for blocks of size 2^( 3) =       0.000425998141
  error estimate for blocks of size 2^( 4) =       0.000432662287
  error estimate for blocks of size 2^( 5) =       0.000436379679
  error estimate for blocks of size 2^( 6) =       0.000438901359
  error estimate for blocks of size 2^( 7) =       0.000441424733

      target function =                  N/A
              le_mean =     -17.216196030613
             les_mean =     296.729397774357
             stat err =       0.000437342015
             autocorr =       1.152244250235
              std dev =       0.576187622094
             le_variance =       0.331992175854

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332090950607
                                         uncertainty =       0.014133078427

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332090950607
                                         uncertainty =       0.014133078427

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407425238
  error estimate for blocks of size 2^( 2) =       0.000416983426
  error estimate for blocks of size 2^( 3) =       0.000425997366
  error estimate for blocks of size 2^( 4) =       0.000432661457
  error estimate for blocks of size 2^( 5) =       0.000436378887
  error estimate for blocks of size 2^( 6) =       0.000438900607
  error estimate for blocks of size 2^( 7) =       0.000441423818

      target function =                  N/A
              le_mean =     -17.216196023665
             les_mean =     296.729396007843
             stat err =       0.000437341192
             autocorr =       1.152245217725
              std dev =       0.576186296768
             le_variance =       0.331990648583

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332089478247
                                         uncertainty =       0.014132919863

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332089478247
                                         uncertainty =       0.014132919863

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407424334
  error estimate for blocks of size 2^( 2) =       0.000416982600
  error estimate for blocks of size 2^( 3) =       0.000425996614
  error estimate for blocks of size 2^( 4) =       0.000432660652
  error estimate for blocks of size 2^( 5) =       0.000436378114
  error estimate for blocks of size 2^( 6) =       0.000438899870
  error estimate for blocks of size 2^( 7) =       0.000441422923

      target function =                  N/A
              le_mean =     -17.216196016974
             les_mean =     296.729394305476
             stat err =       0.000437340390
             autocorr =       1.152246096433
              std dev =       0.576185019411
             le_variance =       0.331989176594


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216196016023        initial
     9.7656e+00     9.7656e+01             3.6019e-05       -17.216196030613  <--
     3.9062e+01     3.9062e+02             9.0959e-06       -17.216196023665
     1.5625e+02     1.5625e+03             2.2798e-06       -17.216196016974

*****************************************************************************
Applying the update for shift_i =   9.7656e+00     and shift_s =   9.7656e+01
*****************************************************************************

  Execution time = 2.9453e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 2.139840e-01 1 1  ON 0
 uu_1                 5.161576e-02 1 1  ON 1
 uu_2                -4.322332e-02 1 1  ON 2
 uu_3                -9.894242e-02 1 1  ON 3
 uu_4                -1.336902e-01 1 1  ON 4
 uu_5                -1.420464e-01 1 1  ON 5
 uu_6                -1.192318e-01 1 1  ON 6
 uu_7                -4.820368e-02 1 1  ON 7
 uu_8                 9.350258e-02 1 1  ON 8
 uu_9                 1.266979e-01 1 1  ON 9
 ud_0                 3.555332e-01 1 1  ON 10
 ud_1                 9.663167e-02 1 1  ON 11
 ud_2                -1.382617e-02 1 1  ON 12
 ud_3                -7.541732e-02 1 1  ON 13
 ud_4                -1.235461e-01 1 1  ON 14
 ud_5                -1.555396e-01 1 1  ON 15
 ud_6                -1.570128e-01 1 1  ON 16
 ud_7                -1.128657e-01 1 1  ON 17
 ud_8                -4.903044e-03 1 1  ON 18
 ud_9                 9.265700e-02 1 1  ON 19
 eO_0                -7.839980e-01 1 1  ON 20
 eO_1                -4.623305e-01 1 1  ON 21
 eO_2                -5.035087e-02 1 1  ON 22
 eO_3                 2.109434e-01 1 1  ON 23
 eO_4                 3.116675e-01 1 1  ON 24
 eO_5                 3.267621e-01 1 1  ON 25
 eO_6                 2.625840e-01 1 1  ON 26
 eO_7                 1.244867e-01 1 1  ON 27
 eO_8                 2.991513e-02 1 1  ON 28
 eO_9                 1.907786e-02 1 1  ON 29
eH1_0                -1.844668e-01 1 1  ON 30
eH1_1                -1.050120e-01 1 1  ON 31
eH1_2                -6.355457e-02 1 1  ON 32
eH1_3                -2.637162e-02 1 1  ON 33
eH1_4                 1.894506e-02 1 1  ON 34
eH1_5                 3.312177e-02 1 1  ON 35
eH1_6                 7.758006e-02 1 1  ON 36
eH1_7                 1.097467e-01 1 1  ON 37
eH1_8                 9.753085e-02 1 1  ON 38
eH1_9                 2.646924e-02 1 1  ON 39
eH2_0                -1.856684e-01 1 1  ON 40
eH2_1                -1.065188e-01 1 1  ON 41
eH2_2                -6.500326e-02 1 1  ON 42
eH2_3                -2.791069e-02 1 1  ON 43
eH2_4                 1.767057e-02 1 1  ON 44
eH2_5                 3.164238e-02 1 1  ON 45
eH2_6                 7.927547e-02 1 1  ON 46
eH2_7                 1.142071e-01 1 1  ON 47
eH2_8                 1.007138e-01 1 1  ON 48
eH2_9                 2.872886e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5235e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7201e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.3297
    reference variance = 1.65055
====================================================
  Execution time = 2.0356e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1926e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6438e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319172404324
                                         uncertainty =       0.003781799011

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319172404324
                                         uncertainty =       0.003781799011

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399534899
  error estimate for blocks of size 2^( 2) =       0.000409128247
  error estimate for blocks of size 2^( 3) =       0.000418113373
  error estimate for blocks of size 2^( 4) =       0.000424588896
  error estimate for blocks of size 2^( 5) =       0.000428558392
  error estimate for blocks of size 2^( 6) =       0.000431131010
  error estimate for blocks of size 2^( 7) =       0.000433714413

      target function =                  N/A
              le_mean =     -17.216502752224
             les_mean =     296.727223128749
             stat err =       0.000429498178
             autocorr =       1.155615106713
              std dev =       0.565027672794
             le_variance =       0.319256271023


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721650275222e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216502752224       residual = 7.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216502602805       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216502612525       residual = 4.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216502334310       residual = 7.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216502409985       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216502552134       residual = 4.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216502503974       residual = 9.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+00 is 9.010298e-05

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216502752224       residual = 7.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216502713026       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216502713385       residual = 4.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216502636095       residual = 7.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216502653831       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216502689456       residual = 3.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216502678669       residual = 6.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+00 is 2.293181e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216502752224       residual = 7.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216502742302       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216502742234       residual = 4.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216502722346       residual = 7.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216502726681       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216502735545       residual = 2.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216502732997       residual = 5.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+01 is 5.761474e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.235306 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6006e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 2.139940e-01 1 1  ON 0
 uu_1                 5.160456e-02 1 1  ON 1
 uu_2                -4.321317e-02 1 1  ON 2
 uu_3                -9.894014e-02 1 1  ON 3
 uu_4                -1.337004e-01 1 1  ON 4
 uu_5                -1.420402e-01 1 1  ON 5
 uu_6                -1.192406e-01 1 1  ON 6
 uu_7                -4.820959e-02 1 1  ON 7
 uu_8                 9.349420e-02 1 1  ON 8
 uu_9                 1.267035e-01 1 1  ON 9
 ud_0                 3.555393e-01 1 1  ON 10
 ud_1                 9.663118e-02 1 1  ON 11
 ud_2                -1.382776e-02 1 1  ON 12
 ud_3                -7.542684e-02 1 1  ON 13
 ud_4                -1.235467e-01 1 1  ON 14
 ud_5                -1.555380e-01 1 1  ON 15
 ud_6                -1.570140e-01 1 1  ON 16
 ud_7                -1.128625e-01 1 1  ON 17
 ud_8                -4.908561e-03 1 1  ON 18
 ud_9                 9.265781e-02 1 1  ON 19
 eO_0                -7.840169e-01 1 1  ON 20
 eO_1                -4.623534e-01 1 1  ON 21
 eO_2                -5.036604e-02 1 1  ON 22
 eO_3                 2.109467e-01 1 1  ON 23
 eO_4                 3.116741e-01 1 1  ON 24
 eO_5                 3.267783e-01 1 1  ON 25
 eO_6                 2.625973e-01 1 1  ON 26
 eO_7                 1.245003e-01 1 1  ON 27
 eO_8                 2.991712e-02 1 1  ON 28
 eO_9                 1.907874e-02 1 1  ON 29
eH1_0                -1.844651e-01 1 1  ON 30
eH1_1                -1.050144e-01 1 1  ON 31
eH1_2                -6.355845e-02 1 1  ON 32
eH1_3                -2.637813e-02 1 1  ON 33
eH1_4                 1.895337e-02 1 1  ON 34
eH1_5                 3.311509e-02 1 1  ON 35
eH1_6                 7.757942e-02 1 1  ON 36
eH1_7                 1.097470e-01 1 1  ON 37
eH1_8                 9.753819e-02 1 1  ON 38
eH1_9                 2.647137e-02 1 1  ON 39
eH2_0                -1.856704e-01 1 1  ON 40
eH2_1                -1.065352e-01 1 1  ON 41
eH2_2                -6.500518e-02 1 1  ON 42
eH2_3                -2.790527e-02 1 1  ON 43
eH2_4                 1.766767e-02 1 1  ON 44
eH2_5                 3.164819e-02 1 1  ON 45
eH2_6                 7.927648e-02 1 1  ON 46
eH2_7                 1.142042e-01 1 1  ON 47
eH2_8                 1.007224e-01 1 1  ON 48
eH2_9                 2.873229e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.1608
    reference variance = 0.204941
====================================================
  Execution time = 2.0081e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1596e-01
  Total weights = 2.0000e+06
  Execution time = 1.8232e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316079916462
                                         uncertainty =       0.002946363947

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316079916462
                                         uncertainty =       0.002946363947

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397466396
  error estimate for blocks of size 2^( 2) =       0.000406711325
  error estimate for blocks of size 2^( 3) =       0.000415302728
  error estimate for blocks of size 2^( 4) =       0.000421924854
  error estimate for blocks of size 2^( 5) =       0.000426320165
  error estimate for blocks of size 2^( 6) =       0.000428080106
  error estimate for blocks of size 2^( 7) =       0.000428488248

      target function =                  N/A
              le_mean =     -17.217185159726
             les_mean =     296.747423737671
             stat err =       0.000426203343
             autocorr =       1.149827975486
              std dev =       0.562102367340
             le_variance =       0.315959071369

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316089475544
                                         uncertainty =       0.002946347184

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316089475544
                                         uncertainty =       0.002946347184

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397472404
  error estimate for blocks of size 2^( 2) =       0.000406716836
  error estimate for blocks of size 2^( 3) =       0.000415307992
  error estimate for blocks of size 2^( 4) =       0.000421929304
  error estimate for blocks of size 2^( 5) =       0.000426323528
  error estimate for blocks of size 2^( 6) =       0.000428083568
  error estimate for blocks of size 2^( 7) =       0.000428492008

      target function =                  N/A
              le_mean =     -17.217184917841
             les_mean =     296.747424960488
             stat err =       0.000426207102
             autocorr =       1.149813496615
              std dev =       0.562110863916
             le_variance =       0.315968623332

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316084766560
                                         uncertainty =       0.002946353654

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316084766560
                                         uncertainty =       0.002946353654

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397469444
  error estimate for blocks of size 2^( 2) =       0.000406714114
  error estimate for blocks of size 2^( 3) =       0.000415305401
  error estimate for blocks of size 2^( 4) =       0.000421927091
  error estimate for blocks of size 2^( 5) =       0.000426321789
  error estimate for blocks of size 2^( 6) =       0.000428081814
  error estimate for blocks of size 2^( 7) =       0.000428490161

      target function =                  N/A
              le_mean =     -17.217185013830
             les_mean =     296.747423560226
             stat err =       0.000426205214
             autocorr =       1.149820431475
              std dev =       0.562106678272
             le_variance =       0.315963917758

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316080516764
                                         uncertainty =       0.002946362592

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316080516764
                                         uncertainty =       0.002946362592

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397466773
  error estimate for blocks of size 2^( 2) =       0.000406711669
  error estimate for blocks of size 2^( 3) =       0.000415303058
  error estimate for blocks of size 2^( 4) =       0.000421925129
  error estimate for blocks of size 2^( 5) =       0.000426320360
  error estimate for blocks of size 2^( 6) =       0.000428080313
  error estimate for blocks of size 2^( 7) =       0.000428488483

      target function =                  N/A
              le_mean =     -17.217185140030
             les_mean =     296.747423659282
             stat err =       0.000426203571
             autocorr =       1.149827023442
              std dev =       0.562102900904
             le_variance =       0.315959671205


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217185159726        initial  <--
     2.4414e+00     2.4414e+01             9.0103e-05       -17.217184917841
     9.7656e+00     9.7656e+01             2.2932e-05       -17.217185013830
     3.9062e+01     3.9062e+02             5.7615e-06       -17.217185140030

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.2771
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 2.139840e-01 1 1  ON 0
 uu_1                 5.161576e-02 1 1  ON 1
 uu_2                -4.322332e-02 1 1  ON 2
 uu_3                -9.894242e-02 1 1  ON 3
 uu_4                -1.336902e-01 1 1  ON 4
 uu_5                -1.420464e-01 1 1  ON 5
 uu_6                -1.192318e-01 1 1  ON 6
 uu_7                -4.820368e-02 1 1  ON 7
 uu_8                 9.350258e-02 1 1  ON 8
 uu_9                 1.266979e-01 1 1  ON 9
 ud_0                 3.555332e-01 1 1  ON 10
 ud_1                 9.663167e-02 1 1  ON 11
 ud_2                -1.382617e-02 1 1  ON 12
 ud_3                -7.541732e-02 1 1  ON 13
 ud_4                -1.235461e-01 1 1  ON 14
 ud_5                -1.555396e-01 1 1  ON 15
 ud_6                -1.570128e-01 1 1  ON 16
 ud_7                -1.128657e-01 1 1  ON 17
 ud_8                -4.903044e-03 1 1  ON 18
 ud_9                 9.265700e-02 1 1  ON 19
 eO_0                -7.839980e-01 1 1  ON 20
 eO_1                -4.623305e-01 1 1  ON 21
 eO_2                -5.035087e-02 1 1  ON 22
 eO_3                 2.109434e-01 1 1  ON 23
 eO_4                 3.116675e-01 1 1  ON 24
 eO_5                 3.267621e-01 1 1  ON 25
 eO_6                 2.625840e-01 1 1  ON 26
 eO_7                 1.244867e-01 1 1  ON 27
 eO_8                 2.991513e-02 1 1  ON 28
 eO_9                 1.907786e-02 1 1  ON 29
eH1_0                -1.844668e-01 1 1  ON 30
eH1_1                -1.050120e-01 1 1  ON 31
eH1_2                -6.355457e-02 1 1  ON 32
eH1_3                -2.637162e-02 1 1  ON 33
eH1_4                 1.894506e-02 1 1  ON 34
eH1_5                 3.312177e-02 1 1  ON 35
eH1_6                 7.758006e-02 1 1  ON 36
eH1_7                 1.097467e-01 1 1  ON 37
eH1_8                 9.753085e-02 1 1  ON 38
eH1_9                 2.646924e-02 1 1  ON 39
eH2_0                -1.856684e-01 1 1  ON 40
eH2_1                -1.065188e-01 1 1  ON 41
eH2_2                -6.500326e-02 1 1  ON 42
eH2_3                -2.791069e-02 1 1  ON 43
eH2_4                 1.767057e-02 1 1  ON 44
eH2_5                 3.164238e-02 1 1  ON 45
eH2_6                 7.927547e-02 1 1  ON 46
eH2_7                 1.142071e-01 1 1  ON 47
eH2_8                 1.007138e-01 1 1  ON 48
eH2_9                 2.872886e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5291e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7205e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.1965
    reference variance = 0.162209
====================================================
  Execution time = 2.0437e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.3046e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.7280e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330440818351
                                         uncertainty =       0.009267171248

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330440818351
                                         uncertainty =       0.009267171248

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406482594
  error estimate for blocks of size 2^( 2) =       0.000415906374
  error estimate for blocks of size 2^( 3) =       0.000424210313
  error estimate for blocks of size 2^( 4) =       0.000429956114
  error estimate for blocks of size 2^( 5) =       0.000434857239
  error estimate for blocks of size 2^( 6) =       0.000437493627
  error estimate for blocks of size 2^( 7) =       0.000438151673

      target function =                  N/A
              le_mean =     -17.216776312353
             les_mean =     296.747842623393
             stat err =       0.000435114663
             autocorr =       1.145838817421
              std dev =       0.574853197800
             le_variance =       0.330456199020


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721677631235e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216776312353       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216776315413       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216776327149       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216776330634       residual = 4.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216776358606       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216776366696       residual = 3.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216776367835       residual = 5.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+01 is 8.376096e-06

solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216776312353       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216776313123       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216776316096       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216776316988       residual = 4.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216776324051       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216776326097       residual = 3.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216776326411       residual = 4.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+01 is 2.120315e-06

solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216776312353       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216776312546       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216776313292       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216776313516       residual = 4.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216776315286       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216776315799       residual = 3.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216776315880       residual = 4.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+02 is 5.317556e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.237611 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6171e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 2.139823e-01 1 1  ON 0
 uu_1                 5.161638e-02 1 1  ON 1
 uu_2                -4.322233e-02 1 1  ON 2
 uu_3                -9.894178e-02 1 1  ON 3
 uu_4                -1.336898e-01 1 1  ON 4
 uu_5                -1.420462e-01 1 1  ON 5
 uu_6                -1.192329e-01 1 1  ON 6
 uu_7                -4.820448e-02 1 1  ON 7
 uu_8                 9.350180e-02 1 1  ON 8
 uu_9                 1.266985e-01 1 1  ON 9
 ud_0                 3.555353e-01 1 1  ON 10
 ud_1                 9.663079e-02 1 1  ON 11
 ud_2                -1.382532e-02 1 1  ON 12
 ud_3                -7.541805e-02 1 1  ON 13
 ud_4                -1.235450e-01 1 1  ON 14
 ud_5                -1.555403e-01 1 1  ON 15
 ud_6                -1.570139e-01 1 1  ON 16
 ud_7                -1.128661e-01 1 1  ON 17
 ud_8                -4.904039e-03 1 1  ON 18
 ud_9                 9.265688e-02 1 1  ON 19
 eO_0                -7.839998e-01 1 1  ON 20
 eO_1                -4.623317e-01 1 1  ON 21
 eO_2                -5.035216e-02 1 1  ON 22
 eO_3                 2.109425e-01 1 1  ON 23
 eO_4                 3.116683e-01 1 1  ON 24
 eO_5                 3.267636e-01 1 1  ON 25
 eO_6                 2.625853e-01 1 1  ON 26
 eO_7                 1.244879e-01 1 1  ON 27
 eO_8                 2.991537e-02 1 1  ON 28
 eO_9                 1.907792e-02 1 1  ON 29
eH1_0                -1.844670e-01 1 1  ON 30
eH1_1                -1.050123e-01 1 1  ON 31
eH1_2                -6.355558e-02 1 1  ON 32
eH1_3                -2.637174e-02 1 1  ON 33
eH1_4                 1.894473e-02 1 1  ON 34
eH1_5                 3.312225e-02 1 1  ON 35
eH1_6                 7.758026e-02 1 1  ON 36
eH1_7                 1.097466e-01 1 1  ON 37
eH1_8                 9.753176e-02 1 1  ON 38
eH1_9                 2.646957e-02 1 1  ON 39
eH2_0                -1.856691e-01 1 1  ON 40
eH2_1                -1.065189e-01 1 1  ON 41
eH2_2                -6.500278e-02 1 1  ON 42
eH2_3                -2.791104e-02 1 1  ON 43
eH2_4                 1.767144e-02 1 1  ON 44
eH2_5                 3.164205e-02 1 1  ON 45
eH2_6                 7.927486e-02 1 1  ON 46
eH2_7                 1.142069e-01 1 1  ON 47
eH2_8                 1.007144e-01 1 1  ON 48
eH2_9                 2.872907e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.2173
    reference variance = 0.173698
====================================================
  Execution time = 2.0156e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1876e-01
  Total weights = 2.0000e+06
  Execution time = 1.8200e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318725377241
                                         uncertainty =       0.003222203819

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318725377241
                                         uncertainty =       0.003222203819

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399223225
  error estimate for blocks of size 2^( 2) =       0.000409190077
  error estimate for blocks of size 2^( 3) =       0.000417440944
  error estimate for blocks of size 2^( 4) =       0.000423016722
  error estimate for blocks of size 2^( 5) =       0.000426879366
  error estimate for blocks of size 2^( 6) =       0.000429093589
  error estimate for blocks of size 2^( 7) =       0.000428085624

      target function =                  N/A
              le_mean =     -17.216343075639
             les_mean =     296.721227105459
             stat err =       0.000426768825
             autocorr =       1.142756703302
              std dev =       0.564586899178
             le_variance =       0.318758366723

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318728915817
                                         uncertainty =       0.003222217813

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318728915817
                                         uncertainty =       0.003222217813

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399225439
  error estimate for blocks of size 2^( 2) =       0.000409192192
  error estimate for blocks of size 2^( 3) =       0.000417442959
  error estimate for blocks of size 2^( 4) =       0.000423018564
  error estimate for blocks of size 2^( 5) =       0.000426881243
  error estimate for blocks of size 2^( 6) =       0.000429095533
  error estimate for blocks of size 2^( 7) =       0.000428087567

      target function =                  N/A
              le_mean =     -17.216342968849
             les_mean =     296.721226963824
             stat err =       0.000426770727
             autocorr =       1.142754211619
              std dev =       0.564590030163
             le_variance =       0.318761902159

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318727174537
                                         uncertainty =       0.003222210795

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318727174537
                                         uncertainty =       0.003222210795

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399224349
  error estimate for blocks of size 2^( 2) =       0.000409191152
  error estimate for blocks of size 2^( 3) =       0.000417441968
  error estimate for blocks of size 2^( 4) =       0.000423017658
  error estimate for blocks of size 2^( 5) =       0.000426880321
  error estimate for blocks of size 2^( 6) =       0.000429094577
  error estimate for blocks of size 2^( 7) =       0.000428086612

      target function =                  N/A
              le_mean =     -17.216343021283
             les_mean =     296.721227029529
             stat err =       0.000426769792
             autocorr =       1.142755443262
              std dev =       0.564588489455
             le_variance =       0.318760162425

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318725602721
                                         uncertainty =       0.003222204690

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318725602721
                                         uncertainty =       0.003222204690

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399223366
  error estimate for blocks of size 2^( 2) =       0.000409190212
  error estimate for blocks of size 2^( 3) =       0.000417441072
  error estimate for blocks of size 2^( 4) =       0.000423016839
  error estimate for blocks of size 2^( 5) =       0.000426879486
  error estimate for blocks of size 2^( 6) =       0.000429093713
  error estimate for blocks of size 2^( 7) =       0.000428085748

      target function =                  N/A
              le_mean =     -17.216343068809
             les_mean =     296.721227095549
             stat err =       0.000426768947
             autocorr =       1.142756545364
              std dev =       0.564587098686
             le_variance =       0.318758592003


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216343075639        initial  <--
     2.4414e+01     2.4414e+02             8.3761e-06       -17.216342968849
     9.7656e+01     9.7656e+02             2.1203e-06       -17.216343021283
     3.9062e+02     3.9062e+03             5.3176e-07       -17.216343068809

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.4835
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 2.139840e-01 1 1  ON 0
 uu_1                 5.161576e-02 1 1  ON 1
 uu_2                -4.322332e-02 1 1  ON 2
 uu_3                -9.894242e-02 1 1  ON 3
 uu_4                -1.336902e-01 1 1  ON 4
 uu_5                -1.420464e-01 1 1  ON 5
 uu_6                -1.192318e-01 1 1  ON 6
 uu_7                -4.820368e-02 1 1  ON 7
 uu_8                 9.350258e-02 1 1  ON 8
 uu_9                 1.266979e-01 1 1  ON 9
 ud_0                 3.555332e-01 1 1  ON 10
 ud_1                 9.663167e-02 1 1  ON 11
 ud_2                -1.382617e-02 1 1  ON 12
 ud_3                -7.541732e-02 1 1  ON 13
 ud_4                -1.235461e-01 1 1  ON 14
 ud_5                -1.555396e-01 1 1  ON 15
 ud_6                -1.570128e-01 1 1  ON 16
 ud_7                -1.128657e-01 1 1  ON 17
 ud_8                -4.903044e-03 1 1  ON 18
 ud_9                 9.265700e-02 1 1  ON 19
 eO_0                -7.839980e-01 1 1  ON 20
 eO_1                -4.623305e-01 1 1  ON 21
 eO_2                -5.035087e-02 1 1  ON 22
 eO_3                 2.109434e-01 1 1  ON 23
 eO_4                 3.116675e-01 1 1  ON 24
 eO_5                 3.267621e-01 1 1  ON 25
 eO_6                 2.625840e-01 1 1  ON 26
 eO_7                 1.244867e-01 1 1  ON 27
 eO_8                 2.991513e-02 1 1  ON 28
 eO_9                 1.907786e-02 1 1  ON 29
eH1_0                -1.844668e-01 1 1  ON 30
eH1_1                -1.050120e-01 1 1  ON 31
eH1_2                -6.355457e-02 1 1  ON 32
eH1_3                -2.637162e-02 1 1  ON 33
eH1_4                 1.894506e-02 1 1  ON 34
eH1_5                 3.312177e-02 1 1  ON 35
eH1_6                 7.758006e-02 1 1  ON 36
eH1_7                 1.097467e-01 1 1  ON 37
eH1_8                 9.753085e-02 1 1  ON 38
eH1_9                 2.646924e-02 1 1  ON 39
eH2_0                -1.856684e-01 1 1  ON 40
eH2_1                -1.065188e-01 1 1  ON 41
eH2_2                -6.500326e-02 1 1  ON 42
eH2_3                -2.791069e-02 1 1  ON 43
eH2_4                 1.767057e-02 1 1  ON 44
eH2_5                 3.164238e-02 1 1  ON 45
eH2_6                 7.927547e-02 1 1  ON 46
eH2_7                 1.142071e-01 1 1  ON 47
eH2_8                 1.007138e-01 1 1  ON 48
eH2_9                 2.872886e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5668e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7205e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.175
    reference variance = 0.250262
====================================================
  Execution time = 2.0637e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.2929e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5431e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329384662699
                                         uncertainty =       0.010895030091

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329384662699
                                         uncertainty =       0.010895030091

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405762527
  error estimate for blocks of size 2^( 2) =       0.000415106997
  error estimate for blocks of size 2^( 3) =       0.000423370754
  error estimate for blocks of size 2^( 4) =       0.000429382312
  error estimate for blocks of size 2^( 5) =       0.000433280360
  error estimate for blocks of size 2^( 6) =       0.000435403000
  error estimate for blocks of size 2^( 7) =       0.000435800653

      target function =                  N/A
              le_mean =     -17.217616494626
             les_mean =     296.775604048738
             stat err =       0.000433466581
             autocorr =       1.141214726302
              std dev =       0.573834869426
             le_variance =       0.329286457369


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721761649463e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217616494626       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217616497703       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217616501251       residual = 5.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217616502064       residual = 7.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217616504823       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217616503475       residual = 2.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217616503736       residual = 5.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+02 is 8.594130e-07

solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217616494626       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217616495396       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217616496284       residual = 5.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217616496486       residual = 7.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217616497178       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217616496841       residual = 2.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217616496906       residual = 5.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+02 is 2.149407e-07

solving harmonic davidson linear method for identity shift 3.9062e+03, overlap shift 3.9062e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217616494626       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217616494818       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217616495040       residual = 5.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217616495091       residual = 7.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217616495264       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217616495179       residual = 2.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217616495196       residual = 5.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+03 is 5.374064e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.239878 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6186e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 2.139839e-01 1 1  ON 0
 uu_1                 5.161573e-02 1 1  ON 1
 uu_2                -4.322321e-02 1 1  ON 2
 uu_3                -9.894235e-02 1 1  ON 3
 uu_4                -1.336902e-01 1 1  ON 4
 uu_5                -1.420464e-01 1 1  ON 5
 uu_6                -1.192319e-01 1 1  ON 6
 uu_7                -4.820373e-02 1 1  ON 7
 uu_8                 9.350252e-02 1 1  ON 8
 uu_9                 1.266980e-01 1 1  ON 9
 ud_0                 3.555333e-01 1 1  ON 10
 ud_1                 9.663158e-02 1 1  ON 11
 ud_2                -1.382615e-02 1 1  ON 12
 ud_3                -7.541737e-02 1 1  ON 13
 ud_4                -1.235462e-01 1 1  ON 14
 ud_5                -1.555396e-01 1 1  ON 15
 ud_6                -1.570128e-01 1 1  ON 16
 ud_7                -1.128657e-01 1 1  ON 17
 ud_8                -4.903123e-03 1 1  ON 18
 ud_9                 9.265701e-02 1 1  ON 19
 eO_0                -7.839982e-01 1 1  ON 20
 eO_1                -4.623307e-01 1 1  ON 21
 eO_2                -5.035109e-02 1 1  ON 22
 eO_3                 2.109434e-01 1 1  ON 23
 eO_4                 3.116677e-01 1 1  ON 24
 eO_5                 3.267622e-01 1 1  ON 25
 eO_6                 2.625842e-01 1 1  ON 26
 eO_7                 1.244868e-01 1 1  ON 27
 eO_8                 2.991515e-02 1 1  ON 28
 eO_9                 1.907786e-02 1 1  ON 29
eH1_0                -1.844667e-01 1 1  ON 30
eH1_1                -1.050121e-01 1 1  ON 31
eH1_2                -6.355469e-02 1 1  ON 32
eH1_3                -2.637161e-02 1 1  ON 33
eH1_4                 1.894507e-02 1 1  ON 34
eH1_5                 3.312179e-02 1 1  ON 35
eH1_6                 7.758003e-02 1 1  ON 36
eH1_7                 1.097467e-01 1 1  ON 37
eH1_8                 9.753093e-02 1 1  ON 38
eH1_9                 2.646926e-02 1 1  ON 39
eH2_0                -1.856684e-01 1 1  ON 40
eH2_1                -1.065187e-01 1 1  ON 41
eH2_2                -6.500329e-02 1 1  ON 42
eH2_3                -2.791074e-02 1 1  ON 43
eH2_4                 1.767055e-02 1 1  ON 44
eH2_5                 3.164238e-02 1 1  ON 45
eH2_6                 7.927545e-02 1 1  ON 46
eH2_7                 1.142071e-01 1 1  ON 47
eH2_8                 1.007139e-01 1 1  ON 48
eH2_9                 2.872888e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.2225
    reference variance = 0.127513
====================================================
  Execution time = 2.2242e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2052e-01
  Total weights = 2.0000e+06
  Execution time = 1.8184e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320293167476
                                         uncertainty =       0.003146552844

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320293167476
                                         uncertainty =       0.003146552844

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400326879
  error estimate for blocks of size 2^( 2) =       0.000409805062
  error estimate for blocks of size 2^( 3) =       0.000418381025
  error estimate for blocks of size 2^( 4) =       0.000424531529
  error estimate for blocks of size 2^( 5) =       0.000427492513
  error estimate for blocks of size 2^( 6) =       0.000429775944
  error estimate for blocks of size 2^( 7) =       0.000430898872

      target function =                  N/A
              le_mean =     -17.215883544209
             les_mean =     296.707169267336
             stat err =       0.000428174714
             autocorr =       1.143964460578
              std dev =       0.566147701417
             le_variance =       0.320523219820

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320293575640
                                         uncertainty =       0.003146559263

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320293575640
                                         uncertainty =       0.003146559263

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400327133
  error estimate for blocks of size 2^( 2) =       0.000409805306
  error estimate for blocks of size 2^( 3) =       0.000418381256
  error estimate for blocks of size 2^( 4) =       0.000424531746
  error estimate for blocks of size 2^( 5) =       0.000427492726
  error estimate for blocks of size 2^( 6) =       0.000429776144
  error estimate for blocks of size 2^( 7) =       0.000430899069

      target function =                  N/A
              le_mean =     -17.215883545214
             les_mean =     296.707169709525
             stat err =       0.000428174921
             autocorr =       1.143964110857
              std dev =       0.566148061394
             le_variance =       0.320523627420

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320293371935
                                         uncertainty =       0.003146556059

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320293371935
                                         uncertainty =       0.003146556059

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400327006
  error estimate for blocks of size 2^( 2) =       0.000409805184
  error estimate for blocks of size 2^( 3) =       0.000418381141
  error estimate for blocks of size 2^( 4) =       0.000424531638
  error estimate for blocks of size 2^( 5) =       0.000427492620
  error estimate for blocks of size 2^( 6) =       0.000429776044
  error estimate for blocks of size 2^( 7) =       0.000430898971

      target function =                  N/A
              le_mean =     -17.215883544712
             les_mean =     296.707169488821
             stat err =       0.000428174818
             autocorr =       1.143964285456
              std dev =       0.566147881738
             le_variance =       0.320523423996

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320293193045
                                         uncertainty =       0.003146553246

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320293193045
                                         uncertainty =       0.003146553246

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400326895
  error estimate for blocks of size 2^( 2) =       0.000409805077
  error estimate for blocks of size 2^( 3) =       0.000418381040
  error estimate for blocks of size 2^( 4) =       0.000424531543
  error estimate for blocks of size 2^( 5) =       0.000427492526
  error estimate for blocks of size 2^( 6) =       0.000429775956
  error estimate for blocks of size 2^( 7) =       0.000430898885

      target function =                  N/A
              le_mean =     -17.215883544272
             les_mean =     296.707169295032
             stat err =       0.000428174727
             autocorr =       1.143964438688
              std dev =       0.566147723967
             le_variance =       0.320523245353


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215883544209        initial
     2.4414e+02     2.4414e+03             8.5941e-07       -17.215883545214  <--
     9.7656e+02     9.7656e+03             2.1494e-07       -17.215883544712
     3.9062e+03     3.9062e+04             5.3741e-08       -17.215883544272

*****************************************************************************
Applying the update for shift_i =   2.4414e+02     and shift_s =   2.4414e+03
*****************************************************************************

  Execution time = 3.1406e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 2.139837e-01 1 1  ON 0
 uu_1                 5.161563e-02 1 1  ON 1
 uu_2                -4.322288e-02 1 1  ON 2
 uu_3                -9.894214e-02 1 1  ON 3
 uu_4                -1.336901e-01 1 1  ON 4
 uu_5                -1.420464e-01 1 1  ON 5
 uu_6                -1.192322e-01 1 1  ON 6
 uu_7                -4.820391e-02 1 1  ON 7
 uu_8                 9.350232e-02 1 1  ON 8
 uu_9                 1.266981e-01 1 1  ON 9
 ud_0                 3.555338e-01 1 1  ON 10
 ud_1                 9.663131e-02 1 1  ON 11
 ud_2                -1.382608e-02 1 1  ON 12
 ud_3                -7.541753e-02 1 1  ON 13
 ud_4                -1.235462e-01 1 1  ON 14
 ud_5                -1.555396e-01 1 1  ON 15
 ud_6                -1.570129e-01 1 1  ON 16
 ud_7                -1.128658e-01 1 1  ON 17
 ud_8                -4.903361e-03 1 1  ON 18
 ud_9                 9.265703e-02 1 1  ON 19
 eO_0                -7.839987e-01 1 1  ON 20
 eO_1                -4.623312e-01 1 1  ON 21
 eO_2                -5.035173e-02 1 1  ON 22
 eO_3                 2.109432e-01 1 1  ON 23
 eO_4                 3.116683e-01 1 1  ON 24
 eO_5                 3.267627e-01 1 1  ON 25
 eO_6                 2.625845e-01 1 1  ON 26
 eO_7                 1.244872e-01 1 1  ON 27
 eO_8                 2.991522e-02 1 1  ON 28
 eO_9                 1.907789e-02 1 1  ON 29
eH1_0                -1.844665e-01 1 1  ON 30
eH1_1                -1.050123e-01 1 1  ON 31
eH1_2                -6.355507e-02 1 1  ON 32
eH1_3                -2.637157e-02 1 1  ON 33
eH1_4                 1.894511e-02 1 1  ON 34
eH1_5                 3.312187e-02 1 1  ON 35
eH1_6                 7.757993e-02 1 1  ON 36
eH1_7                 1.097467e-01 1 1  ON 37
eH1_8                 9.753118e-02 1 1  ON 38
eH1_9                 2.646933e-02 1 1  ON 39
eH2_0                -1.856684e-01 1 1  ON 40
eH2_1                -1.065185e-01 1 1  ON 41
eH2_2                -6.500339e-02 1 1  ON 42
eH2_3                -2.791090e-02 1 1  ON 43
eH2_4                 1.767048e-02 1 1  ON 44
eH2_5                 3.164236e-02 1 1  ON 45
eH2_6                 7.927541e-02 1 1  ON 46
eH2_7                 1.142069e-01 1 1  ON 47
eH2_8                 1.007140e-01 1 1  ON 48
eH2_9                 2.872896e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7599e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7205e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.2022
    reference variance = 0.213198
====================================================
  Execution time = 2.2475e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1554e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5155e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315621436874
                                         uncertainty =       0.002935366149

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315621436874
                                         uncertainty =       0.002935366149

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397201845
  error estimate for blocks of size 2^( 2) =       0.000406969773
  error estimate for blocks of size 2^( 3) =       0.000415426842
  error estimate for blocks of size 2^( 4) =       0.000422256859
  error estimate for blocks of size 2^( 5) =       0.000427217424
  error estimate for blocks of size 2^( 6) =       0.000429257179
  error estimate for blocks of size 2^( 7) =       0.000429529703

      target function =                  N/A
              le_mean =     -17.216882685690
             les_mean =     296.736587865973
             stat err =       0.000427065291
             autocorr =       1.156021841959
              std dev =       0.561728235846
             le_variance =       0.315538610947


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721688268569e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216882685690       residual = 9.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216882698881       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216882700949       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216882705265       residual = 6.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216882713726       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216882708889       residual = 2.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216882708851       residual = 5.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+01 is 3.714132e-06

solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216882685690       residual = 9.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216882689003       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216882689520       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216882690592       residual = 5.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216882692707       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216882691501       residual = 2.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216882691490       residual = 5.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+02 is 9.291465e-07

solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216882685690       residual = 9.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216882686519       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216882686648       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216882686916       residual = 5.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216882687444       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216882687143       residual = 2.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216882687140       residual = 4.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+02 is 2.323250e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.242184 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8000e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 2.139842e-01 1 1  ON 0
 uu_1                 5.161547e-02 1 1  ON 1
 uu_2                -4.322253e-02 1 1  ON 2
 uu_3                -9.894239e-02 1 1  ON 3
 uu_4                -1.336900e-01 1 1  ON 4
 uu_5                -1.420464e-01 1 1  ON 5
 uu_6                -1.192326e-01 1 1  ON 6
 uu_7                -4.820434e-02 1 1  ON 7
 uu_8                 9.350201e-02 1 1  ON 8
 uu_9                 1.266983e-01 1 1  ON 9
 ud_0                 3.555341e-01 1 1  ON 10
 ud_1                 9.663151e-02 1 1  ON 11
 ud_2                -1.382621e-02 1 1  ON 12
 ud_3                -7.541753e-02 1 1  ON 13
 ud_4                -1.235464e-01 1 1  ON 14
 ud_5                -1.555397e-01 1 1  ON 15
 ud_6                -1.570128e-01 1 1  ON 16
 ud_7                -1.128657e-01 1 1  ON 17
 ud_8                -4.903750e-03 1 1  ON 18
 ud_9                 9.265705e-02 1 1  ON 19
 eO_0                -7.839995e-01 1 1  ON 20
 eO_1                -4.623321e-01 1 1  ON 21
 eO_2                -5.035221e-02 1 1  ON 22
 eO_3                 2.109432e-01 1 1  ON 23
 eO_4                 3.116688e-01 1 1  ON 24
 eO_5                 3.267632e-01 1 1  ON 25
 eO_6                 2.625850e-01 1 1  ON 26
 eO_7                 1.244877e-01 1 1  ON 27
 eO_8                 2.991530e-02 1 1  ON 28
 eO_9                 1.907792e-02 1 1  ON 29
eH1_0                -1.844662e-01 1 1  ON 30
eH1_1                -1.050124e-01 1 1  ON 31
eH1_2                -6.355515e-02 1 1  ON 32
eH1_3                -2.637143e-02 1 1  ON 33
eH1_4                 1.894513e-02 1 1  ON 34
eH1_5                 3.312138e-02 1 1  ON 35
eH1_6                 7.757973e-02 1 1  ON 36
eH1_7                 1.097467e-01 1 1  ON 37
eH1_8                 9.753149e-02 1 1  ON 38
eH1_9                 2.646943e-02 1 1  ON 39
eH2_0                -1.856684e-01 1 1  ON 40
eH2_1                -1.065184e-01 1 1  ON 41
eH2_2                -6.500361e-02 1 1  ON 42
eH2_3                -2.791054e-02 1 1  ON 43
eH2_4                 1.766992e-02 1 1  ON 44
eH2_5                 3.164241e-02 1 1  ON 45
eH2_6                 7.927536e-02 1 1  ON 46
eH2_7                 1.142069e-01 1 1  ON 47
eH2_8                 1.007143e-01 1 1  ON 48
eH2_9                 2.872906e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.2397
    reference variance = 0.188686
====================================================
  Execution time = 1.9676e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.1358e-01
  Total weights = 2.0000e+06
  Execution time = 1.8220e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313684962061
                                         uncertainty =       0.002608740307

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313684962061
                                         uncertainty =       0.002608740307

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395968024
  error estimate for blocks of size 2^( 2) =       0.000405692251
  error estimate for blocks of size 2^( 3) =       0.000414272696
  error estimate for blocks of size 2^( 4) =       0.000420994607
  error estimate for blocks of size 2^( 5) =       0.000425894588
  error estimate for blocks of size 2^( 6) =       0.000428419709
  error estimate for blocks of size 2^( 7) =       0.000432835482

      target function =                  N/A
              le_mean =     -17.217655001436
             les_mean =     296.761224944289
             stat err =       0.000427036097
             autocorr =       1.163078264938
              std dev =       0.559983350278
             le_variance =       0.313581352589

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313685936403
                                         uncertainty =       0.002608751939

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313685936403
                                         uncertainty =       0.002608751939

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395968639
  error estimate for blocks of size 2^( 2) =       0.000405692825
  error estimate for blocks of size 2^( 3) =       0.000414273195
  error estimate for blocks of size 2^( 4) =       0.000420995083
  error estimate for blocks of size 2^( 5) =       0.000425895049
  error estimate for blocks of size 2^( 6) =       0.000428420112
  error estimate for blocks of size 2^( 7) =       0.000432835822

      target function =                  N/A
              le_mean =     -17.217655000588
             les_mean =     296.761225888228
             stat err =       0.000427036516
             autocorr =       1.163076942558
              std dev =       0.559984219194
             le_variance =       0.313582325746

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313685449353
                                         uncertainty =       0.002608746138

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313685449353
                                         uncertainty =       0.002608746138

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395968332
  error estimate for blocks of size 2^( 2) =       0.000405692538
  error estimate for blocks of size 2^( 3) =       0.000414272945
  error estimate for blocks of size 2^( 4) =       0.000420994845
  error estimate for blocks of size 2^( 5) =       0.000425894818
  error estimate for blocks of size 2^( 6) =       0.000428419910
  error estimate for blocks of size 2^( 7) =       0.000432835651

      target function =                  N/A
              le_mean =     -17.217655000995
             les_mean =     296.761225415766
             stat err =       0.000427036306
             autocorr =       1.163077601656
              std dev =       0.559983784841
             le_variance =       0.313581839285

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313685022972
                                         uncertainty =       0.002608741036

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313685022972
                                         uncertainty =       0.002608741036

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395968063
  error estimate for blocks of size 2^( 2) =       0.000405692287
  error estimate for blocks of size 2^( 3) =       0.000414272727
  error estimate for blocks of size 2^( 4) =       0.000420994637
  error estimate for blocks of size 2^( 5) =       0.000425894617
  error estimate for blocks of size 2^( 6) =       0.000428419734
  error estimate for blocks of size 2^( 7) =       0.000432835503

      target function =                  N/A
              le_mean =     -17.217655001380
             les_mean =     296.761225003191
             stat err =       0.000427036123
             autocorr =       1.163078181965
              std dev =       0.559983404598
             le_variance =       0.313581413425


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217655001436        initial  <--
     6.1035e+01     6.1035e+02             3.7141e-06       -17.217655000588
     2.4414e+02     2.4414e+03             9.2915e-07       -17.217655000995
     9.7656e+02     9.7656e+03             2.3233e-07       -17.217655001380

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.8548
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 2.139837e-01 1 1  ON 0
 uu_1                 5.161563e-02 1 1  ON 1
 uu_2                -4.322288e-02 1 1  ON 2
 uu_3                -9.894214e-02 1 1  ON 3
 uu_4                -1.336901e-01 1 1  ON 4
 uu_5                -1.420464e-01 1 1  ON 5
 uu_6                -1.192322e-01 1 1  ON 6
 uu_7                -4.820391e-02 1 1  ON 7
 uu_8                 9.350232e-02 1 1  ON 8
 uu_9                 1.266981e-01 1 1  ON 9
 ud_0                 3.555338e-01 1 1  ON 10
 ud_1                 9.663131e-02 1 1  ON 11
 ud_2                -1.382608e-02 1 1  ON 12
 ud_3                -7.541753e-02 1 1  ON 13
 ud_4                -1.235462e-01 1 1  ON 14
 ud_5                -1.555396e-01 1 1  ON 15
 ud_6                -1.570129e-01 1 1  ON 16
 ud_7                -1.128658e-01 1 1  ON 17
 ud_8                -4.903361e-03 1 1  ON 18
 ud_9                 9.265703e-02 1 1  ON 19
 eO_0                -7.839987e-01 1 1  ON 20
 eO_1                -4.623312e-01 1 1  ON 21
 eO_2                -5.035173e-02 1 1  ON 22
 eO_3                 2.109432e-01 1 1  ON 23
 eO_4                 3.116683e-01 1 1  ON 24
 eO_5                 3.267627e-01 1 1  ON 25
 eO_6                 2.625845e-01 1 1  ON 26
 eO_7                 1.244872e-01 1 1  ON 27
 eO_8                 2.991522e-02 1 1  ON 28
 eO_9                 1.907789e-02 1 1  ON 29
eH1_0                -1.844665e-01 1 1  ON 30
eH1_1                -1.050123e-01 1 1  ON 31
eH1_2                -6.355507e-02 1 1  ON 32
eH1_3                -2.637157e-02 1 1  ON 33
eH1_4                 1.894511e-02 1 1  ON 34
eH1_5                 3.312187e-02 1 1  ON 35
eH1_6                 7.757993e-02 1 1  ON 36
eH1_7                 1.097467e-01 1 1  ON 37
eH1_8                 9.753118e-02 1 1  ON 38
eH1_9                 2.646933e-02 1 1  ON 39
eH2_0                -1.856684e-01 1 1  ON 40
eH2_1                -1.065185e-01 1 1  ON 41
eH2_2                -6.500339e-02 1 1  ON 42
eH2_3                -2.791090e-02 1 1  ON 43
eH2_4                 1.767048e-02 1 1  ON 44
eH2_5                 3.164236e-02 1 1  ON 45
eH2_6                 7.927541e-02 1 1  ON 46
eH2_7                 1.142069e-01 1 1  ON 47
eH2_8                 1.007140e-01 1 1  ON 48
eH2_9                 2.872896e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6869e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.2455
    reference variance = 0.278428
====================================================
  Execution time = 2.0309e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2481e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6008e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324789554585
                                         uncertainty =       0.005835931852

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324789554585
                                         uncertainty =       0.005835931852

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402993002
  error estimate for blocks of size 2^( 2) =       0.000412700408
  error estimate for blocks of size 2^( 3) =       0.000421193040
  error estimate for blocks of size 2^( 4) =       0.000427110822
  error estimate for blocks of size 2^( 5) =       0.000430042646
  error estimate for blocks of size 2^( 6) =       0.000431254434
  error estimate for blocks of size 2^( 7) =       0.000433173245

      target function =                  N/A
              le_mean =     -17.216817062397
             les_mean =     296.743596316801
             stat err =       0.000430395287
             autocorr =       1.140617431801
              std dev =       0.569918168823
             le_variance =       0.324806719155


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721681706240e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216817062397       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216817062189       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216817062011       residual = 4.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216817062959       residual = 5.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216817063141       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216817063048       residual = 2.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216817063231       residual = 6.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+02 is 4.417856e-07

solving harmonic davidson linear method for identity shift 2.4414e+03, overlap shift 2.4414e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216817062397       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216817062345       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216817062301       residual = 4.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216817062538       residual = 5.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216817062583       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216817062560       residual = 2.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216817062604       residual = 6.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+03 is 1.104592e-07

solving harmonic davidson linear method for identity shift 9.7656e+03, overlap shift 9.7656e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216817062397       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216817062384       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216817062373       residual = 4.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216817062432       residual = 5.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216817062448       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216817062435       residual = 2.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216817062439       residual = 6.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+03 is 2.761559e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.244442 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5916e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 2.139837e-01 1 1  ON 0
 uu_1                 5.161566e-02 1 1  ON 1
 uu_2                -4.322286e-02 1 1  ON 2
 uu_3                -9.894213e-02 1 1  ON 3
 uu_4                -1.336901e-01 1 1  ON 4
 uu_5                -1.420465e-01 1 1  ON 5
 uu_6                -1.192323e-01 1 1  ON 6
 uu_7                -4.820392e-02 1 1  ON 7
 uu_8                 9.350229e-02 1 1  ON 8
 uu_9                 1.266981e-01 1 1  ON 9
 ud_0                 3.555339e-01 1 1  ON 10
 ud_1                 9.663133e-02 1 1  ON 11
 ud_2                -1.382612e-02 1 1  ON 12
 ud_3                -7.541754e-02 1 1  ON 13
 ud_4                -1.235462e-01 1 1  ON 14
 ud_5                -1.555396e-01 1 1  ON 15
 ud_6                -1.570129e-01 1 1  ON 16
 ud_7                -1.128658e-01 1 1  ON 17
 ud_8                -4.903401e-03 1 1  ON 18
 ud_9                 9.265702e-02 1 1  ON 19
 eO_0                -7.839988e-01 1 1  ON 20
 eO_1                -4.623312e-01 1 1  ON 21
 eO_2                -5.035173e-02 1 1  ON 22
 eO_3                 2.109431e-01 1 1  ON 23
 eO_4                 3.116683e-01 1 1  ON 24
 eO_5                 3.267627e-01 1 1  ON 25
 eO_6                 2.625846e-01 1 1  ON 26
 eO_7                 1.244872e-01 1 1  ON 27
 eO_8                 2.991523e-02 1 1  ON 28
 eO_9                 1.907789e-02 1 1  ON 29
eH1_0                -1.844665e-01 1 1  ON 30
eH1_1                -1.050123e-01 1 1  ON 31
eH1_2                -6.355510e-02 1 1  ON 32
eH1_3                -2.637156e-02 1 1  ON 33
eH1_4                 1.894513e-02 1 1  ON 34
eH1_5                 3.312181e-02 1 1  ON 35
eH1_6                 7.757993e-02 1 1  ON 36
eH1_7                 1.097467e-01 1 1  ON 37
eH1_8                 9.753121e-02 1 1  ON 38
eH1_9                 2.646934e-02 1 1  ON 39
eH2_0                -1.856684e-01 1 1  ON 40
eH2_1                -1.065185e-01 1 1  ON 41
eH2_2                -6.500339e-02 1 1  ON 42
eH2_3                -2.791092e-02 1 1  ON 43
eH2_4                 1.767052e-02 1 1  ON 44
eH2_5                 3.164238e-02 1 1  ON 45
eH2_6                 7.927536e-02 1 1  ON 46
eH2_7                 1.142069e-01 1 1  ON 47
eH2_8                 1.007141e-01 1 1  ON 48
eH2_9                 2.872897e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.1855
    reference variance = 0.255487
====================================================
  Execution time = 1.9909e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.2672e-01
  Total weights = 2.0000e+06
  Execution time = 1.8206e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326693395418
                                         uncertainty =       0.005693946880

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326693395418
                                         uncertainty =       0.005693946880

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404178208
  error estimate for blocks of size 2^( 2) =       0.000413473890
  error estimate for blocks of size 2^( 3) =       0.000422044835
  error estimate for blocks of size 2^( 4) =       0.000428371621
  error estimate for blocks of size 2^( 5) =       0.000432424306
  error estimate for blocks of size 2^( 6) =       0.000434284894
  error estimate for blocks of size 2^( 7) =       0.000435215996

      target function =                  N/A
              le_mean =     -17.217627233813
             les_mean =     296.773407446189
             stat err =       0.000432574204
             autocorr =       1.145448183992
              std dev =       0.571594302822
             le_variance =       0.326720047019

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326693670729
                                         uncertainty =       0.005693954067

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326693670729
                                         uncertainty =       0.005693954067

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404178378
  error estimate for blocks of size 2^( 2) =       0.000413474051
  error estimate for blocks of size 2^( 3) =       0.000422044987
  error estimate for blocks of size 2^( 4) =       0.000428371767
  error estimate for blocks of size 2^( 5) =       0.000432424450
  error estimate for blocks of size 2^( 6) =       0.000434285039
  error estimate for blocks of size 2^( 7) =       0.000435216141

      target function =                  N/A
              le_mean =     -17.217627234707
             les_mean =     296.773407752338
             stat err =       0.000432574349
             autocorr =       1.145447985810
              std dev =       0.571594543676
             le_variance =       0.326720322361

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326693533112
                                         uncertainty =       0.005693950474

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326693533112
                                         uncertainty =       0.005693950474

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404178293
  error estimate for blocks of size 2^( 2) =       0.000413473971
  error estimate for blocks of size 2^( 3) =       0.000422044911
  error estimate for blocks of size 2^( 4) =       0.000428371694
  error estimate for blocks of size 2^( 5) =       0.000432424378
  error estimate for blocks of size 2^( 6) =       0.000434284966
  error estimate for blocks of size 2^( 7) =       0.000435216069

      target function =                  N/A
              le_mean =     -17.217627234260
             les_mean =     296.773407599300
             stat err =       0.000432574277
             autocorr =       1.145448084869
              std dev =       0.571594423283
             le_variance =       0.326720184728

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326693412631
                                         uncertainty =       0.005693947329

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326693412631
                                         uncertainty =       0.005693947329

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404178218
  error estimate for blocks of size 2^( 2) =       0.000413473900
  error estimate for blocks of size 2^( 3) =       0.000422044845
  error estimate for blocks of size 2^( 4) =       0.000428371630
  error estimate for blocks of size 2^( 5) =       0.000432424315
  error estimate for blocks of size 2^( 6) =       0.000434284903
  error estimate for blocks of size 2^( 7) =       0.000435216005

      target function =                  N/A
              le_mean =     -17.217627233869
             les_mean =     296.773407465329
             stat err =       0.000432574213
             autocorr =       1.145448171603
              std dev =       0.571594317881
             le_variance =       0.326720064234


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217627233813        initial
     6.1035e+02     6.1035e+03             4.4179e-07       -17.217627234707  <--
     2.4414e+03     2.4414e+04             1.1046e-07       -17.217627234260
     9.7656e+03     9.7656e+04             2.7616e-08       -17.217627233869

*****************************************************************************
Applying the update for shift_i =   6.1035e+02     and shift_s =   6.1035e+03
*****************************************************************************

  Execution time = 2.9081e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 2.139838e-01 1 1  ON 0
 uu_1                 5.161576e-02 1 1  ON 1
 uu_2                -4.322282e-02 1 1  ON 2
 uu_3                -9.894209e-02 1 1  ON 3
 uu_4                -1.336901e-01 1 1  ON 4
 uu_5                -1.420466e-01 1 1  ON 5
 uu_6                -1.192323e-01 1 1  ON 6
 uu_7                -4.820395e-02 1 1  ON 7
 uu_8                 9.350220e-02 1 1  ON 8
 uu_9                 1.266982e-01 1 1  ON 9
 ud_0                 3.555341e-01 1 1  ON 10
 ud_1                 9.663142e-02 1 1  ON 11
 ud_2                -1.382622e-02 1 1  ON 12
 ud_3                -7.541758e-02 1 1  ON 13
 ud_4                -1.235462e-01 1 1  ON 14
 ud_5                -1.555396e-01 1 1  ON 15
 ud_6                -1.570129e-01 1 1  ON 16
 ud_7                -1.128658e-01 1 1  ON 17
 ud_8                -4.903522e-03 1 1  ON 18
 ud_9                 9.265698e-02 1 1  ON 19
 eO_0                -7.839991e-01 1 1  ON 20
 eO_1                -4.623314e-01 1 1  ON 21
 eO_2                -5.035171e-02 1 1  ON 22
 eO_3                 2.109431e-01 1 1  ON 23
 eO_4                 3.116683e-01 1 1  ON 24
 eO_5                 3.267629e-01 1 1  ON 25
 eO_6                 2.625848e-01 1 1  ON 26
 eO_7                 1.244874e-01 1 1  ON 27
 eO_8                 2.991524e-02 1 1  ON 28
 eO_9                 1.907788e-02 1 1  ON 29
eH1_0                -1.844666e-01 1 1  ON 30
eH1_1                -1.050123e-01 1 1  ON 31
eH1_2                -6.355517e-02 1 1  ON 32
eH1_3                -2.637150e-02 1 1  ON 33
eH1_4                 1.894519e-02 1 1  ON 34
eH1_5                 3.312163e-02 1 1  ON 35
eH1_6                 7.757990e-02 1 1  ON 36
eH1_7                 1.097468e-01 1 1  ON 37
eH1_8                 9.753129e-02 1 1  ON 38
eH1_9                 2.646936e-02 1 1  ON 39
eH2_0                -1.856684e-01 1 1  ON 40
eH2_1                -1.065185e-01 1 1  ON 41
eH2_2                -6.500339e-02 1 1  ON 42
eH2_3                -2.791096e-02 1 1  ON 43
eH2_4                 1.767064e-02 1 1  ON 44
eH2_5                 3.164242e-02 1 1  ON 45
eH2_6                 7.927520e-02 1 1  ON 46
eH2_7                 1.142069e-01 1 1  ON 47
eH2_8                 1.007142e-01 1 1  ON 48
eH2_9                 2.872899e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5011e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.1709
    reference variance = 0.213642
====================================================
  Execution time = 2.0428e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.2141e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6446e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321457452568
                                         uncertainty =       0.004952567053

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321457452568
                                         uncertainty =       0.004952567053

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400877813
  error estimate for blocks of size 2^( 2) =       0.000410906678
  error estimate for blocks of size 2^( 3) =       0.000419037365
  error estimate for blocks of size 2^( 4) =       0.000425925084
  error estimate for blocks of size 2^( 5) =       0.000430113283
  error estimate for blocks of size 2^( 6) =       0.000432105143
  error estimate for blocks of size 2^( 7) =       0.000432968520

      target function =                  N/A
              le_mean =     -17.217637286998
             les_mean =     296.768439628593
             stat err =       0.000430278007
             autocorr =       1.152057765368
              std dev =       0.566926840681
             le_variance =       0.321406042685


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721763728700e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217637286998       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217637286727       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217637285016       residual = 7.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217637286035       residual = 4.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217637287892       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217637289301       residual = 3.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217637289100       residual = 7.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+02 is 1.909691e-06

solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217637286998       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217637286930       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217637286501       residual = 7.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217637286755       residual = 4.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217637287217       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217637287569       residual = 3.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217637287521       residual = 7.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+02 is 4.777488e-07

solving harmonic davidson linear method for identity shift 2.4414e+03, overlap shift 2.4414e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217637286998       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217637286981       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217637286873       residual = 7.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217637286937       residual = 4.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217637287050       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217637287140       residual = 3.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217637287130       residual = 7.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+03 is 1.194576e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.246721 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6079e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 2.139837e-01 1 1  ON 0
 uu_1                 5.161573e-02 1 1  ON 1
 uu_2                -4.322279e-02 1 1  ON 2
 uu_3                -9.894201e-02 1 1  ON 3
 uu_4                -1.336900e-01 1 1  ON 4
 uu_5                -1.420465e-01 1 1  ON 5
 uu_6                -1.192324e-01 1 1  ON 6
 uu_7                -4.820403e-02 1 1  ON 7
 uu_8                 9.350206e-02 1 1  ON 8
 uu_9                 1.266982e-01 1 1  ON 9
 ud_0                 3.555340e-01 1 1  ON 10
 ud_1                 9.663148e-02 1 1  ON 11
 ud_2                -1.382616e-02 1 1  ON 12
 ud_3                -7.541766e-02 1 1  ON 13
 ud_4                -1.235461e-01 1 1  ON 14
 ud_5                -1.555395e-01 1 1  ON 15
 ud_6                -1.570130e-01 1 1  ON 16
 ud_7                -1.128657e-01 1 1  ON 17
 ud_8                -4.903663e-03 1 1  ON 18
 ud_9                 9.265697e-02 1 1  ON 19
 eO_0                -7.839996e-01 1 1  ON 20
 eO_1                -4.623316e-01 1 1  ON 21
 eO_2                -5.035179e-02 1 1  ON 22
 eO_3                 2.109429e-01 1 1  ON 23
 eO_4                 3.116684e-01 1 1  ON 24
 eO_5                 3.267632e-01 1 1  ON 25
 eO_6                 2.625850e-01 1 1  ON 26
 eO_7                 1.244876e-01 1 1  ON 27
 eO_8                 2.991527e-02 1 1  ON 28
 eO_9                 1.907789e-02 1 1  ON 29
eH1_0                -1.844665e-01 1 1  ON 30
eH1_1                -1.050122e-01 1 1  ON 31
eH1_2                -6.355524e-02 1 1  ON 32
eH1_3                -2.637155e-02 1 1  ON 33
eH1_4                 1.894515e-02 1 1  ON 34
eH1_5                 3.312146e-02 1 1  ON 35
eH1_6                 7.757995e-02 1 1  ON 36
eH1_7                 1.097468e-01 1 1  ON 37
eH1_8                 9.753144e-02 1 1  ON 38
eH1_9                 2.646939e-02 1 1  ON 39
eH2_0                -1.856684e-01 1 1  ON 40
eH2_1                -1.065184e-01 1 1  ON 41
eH2_2                -6.500332e-02 1 1  ON 42
eH2_3                -2.791103e-02 1 1  ON 43
eH2_4                 1.767047e-02 1 1  ON 44
eH2_5                 3.164241e-02 1 1  ON 45
eH2_6                 7.927510e-02 1 1  ON 46
eH2_7                 1.142069e-01 1 1  ON 47
eH2_8                 1.007143e-01 1 1  ON 48
eH2_9                 2.872901e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.173
    reference variance = 0.147723
====================================================
  Execution time = 2.0019e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2553e-01
  Total weights = 2.0000e+06
  Execution time = 1.8109e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325660731279
                                         uncertainty =       0.006104174793

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325660731279
                                         uncertainty =       0.006104174793

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403440284
  error estimate for blocks of size 2^( 2) =       0.000413013583
  error estimate for blocks of size 2^( 3) =       0.000421311279
  error estimate for blocks of size 2^( 4) =       0.000427712896
  error estimate for blocks of size 2^( 5) =       0.000432025402
  error estimate for blocks of size 2^( 6) =       0.000434896197
  error estimate for blocks of size 2^( 7) =       0.000438248035

      target function =                  N/A
              le_mean =     -17.217131815718
             les_mean =     296.755155922984
             stat err =       0.000433220633
             autocorr =       1.153080803672
              std dev =       0.570550721626
             le_variance =       0.325528125948

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325660323054
                                         uncertainty =       0.006104151396

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325660323054
                                         uncertainty =       0.006104151396

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403440032
  error estimate for blocks of size 2^( 2) =       0.000413013344
  error estimate for blocks of size 2^( 3) =       0.000421311052
  error estimate for blocks of size 2^( 4) =       0.000427712672
  error estimate for blocks of size 2^( 5) =       0.000432025168
  error estimate for blocks of size 2^( 6) =       0.000434895947
  error estimate for blocks of size 2^( 7) =       0.000438247762

      target function =                  N/A
              le_mean =     -17.217131812563
             les_mean =     296.755155406521
             stat err =       0.000433220387
             autocorr =       1.153080942800
              std dev =       0.570550364214
             le_variance =       0.325527718105

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325660526444
                                         uncertainty =       0.006104163061

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325660526444
                                         uncertainty =       0.006104163061

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403440157
  error estimate for blocks of size 2^( 2) =       0.000413013463
  error estimate for blocks of size 2^( 3) =       0.000421311165
  error estimate for blocks of size 2^( 4) =       0.000427712784
  error estimate for blocks of size 2^( 5) =       0.000432025285
  error estimate for blocks of size 2^( 6) =       0.000434896072
  error estimate for blocks of size 2^( 7) =       0.000438247898

      target function =                  N/A
              le_mean =     -17.217131814136
             les_mean =     296.755155663858
             stat err =       0.000433220510
             autocorr =       1.153080873611
              std dev =       0.570550542287
             le_variance =       0.325527921304

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325660705651
                                         uncertainty =       0.006104173325

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325660705651
                                         uncertainty =       0.006104173325

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403440268
  error estimate for blocks of size 2^( 2) =       0.000413013568
  error estimate for blocks of size 2^( 3) =       0.000421311265
  error estimate for blocks of size 2^( 4) =       0.000427712882
  error estimate for blocks of size 2^( 5) =       0.000432025388
  error estimate for blocks of size 2^( 6) =       0.000434896181
  error estimate for blocks of size 2^( 7) =       0.000438248018

      target function =                  N/A
              le_mean =     -17.217131815520
             les_mean =     296.755155890562
             stat err =       0.000433220617
             autocorr =       1.153080812432
              std dev =       0.570550699188
             le_variance =       0.325528100344


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217131815718        initial  <--
     1.5259e+02     1.5259e+03             1.9097e-06       -17.217131812563
     6.1035e+02     6.1035e+03             4.7775e-07       -17.217131814136
     2.4414e+03     2.4414e+04             1.1946e-07       -17.217131815520

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.1645
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 2.139838e-01 1 1  ON 0
 uu_1                 5.161576e-02 1 1  ON 1
 uu_2                -4.322282e-02 1 1  ON 2
 uu_3                -9.894209e-02 1 1  ON 3
 uu_4                -1.336901e-01 1 1  ON 4
 uu_5                -1.420466e-01 1 1  ON 5
 uu_6                -1.192323e-01 1 1  ON 6
 uu_7                -4.820395e-02 1 1  ON 7
 uu_8                 9.350220e-02 1 1  ON 8
 uu_9                 1.266982e-01 1 1  ON 9
 ud_0                 3.555341e-01 1 1  ON 10
 ud_1                 9.663142e-02 1 1  ON 11
 ud_2                -1.382622e-02 1 1  ON 12
 ud_3                -7.541758e-02 1 1  ON 13
 ud_4                -1.235462e-01 1 1  ON 14
 ud_5                -1.555396e-01 1 1  ON 15
 ud_6                -1.570129e-01 1 1  ON 16
 ud_7                -1.128658e-01 1 1  ON 17
 ud_8                -4.903522e-03 1 1  ON 18
 ud_9                 9.265698e-02 1 1  ON 19
 eO_0                -7.839991e-01 1 1  ON 20
 eO_1                -4.623314e-01 1 1  ON 21
 eO_2                -5.035171e-02 1 1  ON 22
 eO_3                 2.109431e-01 1 1  ON 23
 eO_4                 3.116683e-01 1 1  ON 24
 eO_5                 3.267629e-01 1 1  ON 25
 eO_6                 2.625848e-01 1 1  ON 26
 eO_7                 1.244874e-01 1 1  ON 27
 eO_8                 2.991524e-02 1 1  ON 28
 eO_9                 1.907788e-02 1 1  ON 29
eH1_0                -1.844666e-01 1 1  ON 30
eH1_1                -1.050123e-01 1 1  ON 31
eH1_2                -6.355517e-02 1 1  ON 32
eH1_3                -2.637150e-02 1 1  ON 33
eH1_4                 1.894519e-02 1 1  ON 34
eH1_5                 3.312163e-02 1 1  ON 35
eH1_6                 7.757990e-02 1 1  ON 36
eH1_7                 1.097468e-01 1 1  ON 37
eH1_8                 9.753129e-02 1 1  ON 38
eH1_9                 2.646936e-02 1 1  ON 39
eH2_0                -1.856684e-01 1 1  ON 40
eH2_1                -1.065185e-01 1 1  ON 41
eH2_2                -6.500339e-02 1 1  ON 42
eH2_3                -2.791096e-02 1 1  ON 43
eH2_4                 1.767064e-02 1 1  ON 44
eH2_5                 3.164242e-02 1 1  ON 45
eH2_6                 7.927520e-02 1 1  ON 46
eH2_7                 1.142069e-01 1 1  ON 47
eH2_8                 1.007142e-01 1 1  ON 48
eH2_9                 2.872899e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5249e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7204e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.2384
    reference variance = 0.211327
====================================================
  Execution time = 2.0866e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1542e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5221e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315442095664
                                         uncertainty =       0.005018347413

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315442095664
                                         uncertainty =       0.005018347413

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397128167
  error estimate for blocks of size 2^( 2) =       0.000406723624
  error estimate for blocks of size 2^( 3) =       0.000415576214
  error estimate for blocks of size 2^( 4) =       0.000421656151
  error estimate for blocks of size 2^( 5) =       0.000426371451
  error estimate for blocks of size 2^( 6) =       0.000429487074
  error estimate for blocks of size 2^( 7) =       0.000429466893

      target function =                  N/A
              le_mean =     -17.217058872196
             les_mean =     296.742537612909
             stat err =       0.000426745392
             autocorr =       1.154718965310
              std dev =       0.561624039681
             le_variance =       0.315421561947


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721705887220e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+03, overlap shift 1.5259e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217058872196       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217058872526       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217058873023       residual = 9.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217058872868       residual = 6.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217058872822       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217058872861       residual = 1.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217058872862       residual = 3.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+03 is 1.372893e-07

solving harmonic davidson linear method for identity shift 6.1035e+03, overlap shift 6.1035e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217058872196       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217058872279       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217058872403       residual = 9.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217058872364       residual = 6.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217058872353       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217058872362       residual = 1.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217058872360       residual = 3.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+03 is 3.432368e-08

solving harmonic davidson linear method for identity shift 2.4414e+04, overlap shift 2.4414e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217058872196       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217058872217       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217058872248       residual = 9.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217058872238       residual = 6.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217058872237       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217058872233       residual = 1.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217058872237       residual = 3.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+04 is 8.581004e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.249035 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6394e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 2.139837e-01 1 1  ON 0
 uu_1                 5.161578e-02 1 1  ON 1
 uu_2                -4.322280e-02 1 1  ON 2
 uu_3                -9.894207e-02 1 1  ON 3
 uu_4                -1.336900e-01 1 1  ON 4
 uu_5                -1.420466e-01 1 1  ON 5
 uu_6                -1.192323e-01 1 1  ON 6
 uu_7                -4.820398e-02 1 1  ON 7
 uu_8                 9.350217e-02 1 1  ON 8
 uu_9                 1.266982e-01 1 1  ON 9
 ud_0                 3.555341e-01 1 1  ON 10
 ud_1                 9.663142e-02 1 1  ON 11
 ud_2                -1.382622e-02 1 1  ON 12
 ud_3                -7.541758e-02 1 1  ON 13
 ud_4                -1.235462e-01 1 1  ON 14
 ud_5                -1.555396e-01 1 1  ON 15
 ud_6                -1.570129e-01 1 1  ON 16
 ud_7                -1.128658e-01 1 1  ON 17
 ud_8                -4.903549e-03 1 1  ON 18
 ud_9                 9.265698e-02 1 1  ON 19
 eO_0                -7.839991e-01 1 1  ON 20
 eO_1                -4.623315e-01 1 1  ON 21
 eO_2                -5.035172e-02 1 1  ON 22
 eO_3                 2.109431e-01 1 1  ON 23
 eO_4                 3.116683e-01 1 1  ON 24
 eO_5                 3.267629e-01 1 1  ON 25
 eO_6                 2.625848e-01 1 1  ON 26
 eO_7                 1.244874e-01 1 1  ON 27
 eO_8                 2.991524e-02 1 1  ON 28
 eO_9                 1.907789e-02 1 1  ON 29
eH1_0                -1.844666e-01 1 1  ON 30
eH1_1                -1.050122e-01 1 1  ON 31
eH1_2                -6.355517e-02 1 1  ON 32
eH1_3                -2.637150e-02 1 1  ON 33
eH1_4                 1.894519e-02 1 1  ON 34
eH1_5                 3.312161e-02 1 1  ON 35
eH1_6                 7.757989e-02 1 1  ON 36
eH1_7                 1.097468e-01 1 1  ON 37
eH1_8                 9.753130e-02 1 1  ON 38
eH1_9                 2.646937e-02 1 1  ON 39
eH2_0                -1.856684e-01 1 1  ON 40
eH2_1                -1.065185e-01 1 1  ON 41
eH2_2                -6.500340e-02 1 1  ON 42
eH2_3                -2.791095e-02 1 1  ON 43
eH2_4                 1.767064e-02 1 1  ON 44
eH2_5                 3.164241e-02 1 1  ON 45
eH2_6                 7.927520e-02 1 1  ON 46
eH2_7                 1.142069e-01 1 1  ON 47
eH2_8                 1.007142e-01 1 1  ON 48
eH2_9                 2.872899e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.2173
    reference variance = 0.18272
====================================================
  Execution time = 2.0347e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1775e-01
  Total weights = 2.0000e+06
  Execution time = 1.8149e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317846809299
                                         uncertainty =       0.006648200883

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317846809299
                                         uncertainty =       0.006648200883

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398590419
  error estimate for blocks of size 2^( 2) =       0.000408557855
  error estimate for blocks of size 2^( 3) =       0.000417049254
  error estimate for blocks of size 2^( 4) =       0.000422723023
  error estimate for blocks of size 2^( 5) =       0.000426248384
  error estimate for blocks of size 2^( 6) =       0.000427450703
  error estimate for blocks of size 2^( 7) =       0.000428505789

      target function =                  N/A
              le_mean =     -17.215968841782
             les_mean =     296.707331645869
             stat err =       0.000426231975
             autocorr =       1.143505723127
              std dev =       0.563691975766
             le_variance =       0.317748643543

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317846827713
                                         uncertainty =       0.006648201789

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317846827713
                                         uncertainty =       0.006648201789

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398590430
  error estimate for blocks of size 2^( 2) =       0.000408557866
  error estimate for blocks of size 2^( 3) =       0.000417049263
  error estimate for blocks of size 2^( 4) =       0.000422723031
  error estimate for blocks of size 2^( 5) =       0.000426248392
  error estimate for blocks of size 2^( 6) =       0.000427450711
  error estimate for blocks of size 2^( 7) =       0.000428505798

      target function =                  N/A
              le_mean =     -17.215968841618
             les_mean =     296.707331658602
             stat err =       0.000426231983
             autocorr =       1.143505701606
              std dev =       0.563691992076
             le_variance =       0.317748661931

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317846818508
                                         uncertainty =       0.006648201336

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317846818508
                                         uncertainty =       0.006648201336

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398590424
  error estimate for blocks of size 2^( 2) =       0.000408557860
  error estimate for blocks of size 2^( 3) =       0.000417049259
  error estimate for blocks of size 2^( 4) =       0.000422723027
  error estimate for blocks of size 2^( 5) =       0.000426248388
  error estimate for blocks of size 2^( 6) =       0.000427450707
  error estimate for blocks of size 2^( 7) =       0.000428505794

      target function =                  N/A
              le_mean =     -17.215968841700
             les_mean =     296.707331652237
             stat err =       0.000426231979
             autocorr =       1.143505712358
              std dev =       0.563691983923
             le_variance =       0.317748652740

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317846810450
                                         uncertainty =       0.006648200940

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317846810450
                                         uncertainty =       0.006648200940

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398590419
  error estimate for blocks of size 2^( 2) =       0.000408557856
  error estimate for blocks of size 2^( 3) =       0.000417049255
  error estimate for blocks of size 2^( 4) =       0.000422723024
  error estimate for blocks of size 2^( 5) =       0.000426248384
  error estimate for blocks of size 2^( 6) =       0.000427450703
  error estimate for blocks of size 2^( 7) =       0.000428505790

      target function =                  N/A
              le_mean =     -17.215968841771
             les_mean =     296.707331646665
             stat err =       0.000426231975
             autocorr =       1.143505721783
              std dev =       0.563691976786
             le_variance =       0.317748644693


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215968841782        initial  <--
     1.5259e+03     1.5259e+04             1.3729e-07       -17.215968841618
     6.1035e+03     6.1035e+04             3.4324e-08       -17.215968841700
     2.4414e+04     2.4414e+05             8.5810e-09       -17.215968841771

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.4986
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 2.139838e-01 1 1  ON 0
 uu_1                 5.161576e-02 1 1  ON 1
 uu_2                -4.322282e-02 1 1  ON 2
 uu_3                -9.894209e-02 1 1  ON 3
 uu_4                -1.336901e-01 1 1  ON 4
 uu_5                -1.420466e-01 1 1  ON 5
 uu_6                -1.192323e-01 1 1  ON 6
 uu_7                -4.820395e-02 1 1  ON 7
 uu_8                 9.350220e-02 1 1  ON 8
 uu_9                 1.266982e-01 1 1  ON 9
 ud_0                 3.555341e-01 1 1  ON 10
 ud_1                 9.663142e-02 1 1  ON 11
 ud_2                -1.382622e-02 1 1  ON 12
 ud_3                -7.541758e-02 1 1  ON 13
 ud_4                -1.235462e-01 1 1  ON 14
 ud_5                -1.555396e-01 1 1  ON 15
 ud_6                -1.570129e-01 1 1  ON 16
 ud_7                -1.128658e-01 1 1  ON 17
 ud_8                -4.903522e-03 1 1  ON 18
 ud_9                 9.265698e-02 1 1  ON 19
 eO_0                -7.839991e-01 1 1  ON 20
 eO_1                -4.623314e-01 1 1  ON 21
 eO_2                -5.035171e-02 1 1  ON 22
 eO_3                 2.109431e-01 1 1  ON 23
 eO_4                 3.116683e-01 1 1  ON 24
 eO_5                 3.267629e-01 1 1  ON 25
 eO_6                 2.625848e-01 1 1  ON 26
 eO_7                 1.244874e-01 1 1  ON 27
 eO_8                 2.991524e-02 1 1  ON 28
 eO_9                 1.907788e-02 1 1  ON 29
eH1_0                -1.844666e-01 1 1  ON 30
eH1_1                -1.050123e-01 1 1  ON 31
eH1_2                -6.355517e-02 1 1  ON 32
eH1_3                -2.637150e-02 1 1  ON 33
eH1_4                 1.894519e-02 1 1  ON 34
eH1_5                 3.312163e-02 1 1  ON 35
eH1_6                 7.757990e-02 1 1  ON 36
eH1_7                 1.097468e-01 1 1  ON 37
eH1_8                 9.753129e-02 1 1  ON 38
eH1_9                 2.646936e-02 1 1  ON 39
eH2_0                -1.856684e-01 1 1  ON 40
eH2_1                -1.065185e-01 1 1  ON 41
eH2_2                -6.500339e-02 1 1  ON 42
eH2_3                -2.791096e-02 1 1  ON 43
eH2_4                 1.767064e-02 1 1  ON 44
eH2_5                 3.164242e-02 1 1  ON 45
eH2_6                 7.927520e-02 1 1  ON 46
eH2_7                 1.142069e-01 1 1  ON 47
eH2_8                 1.007142e-01 1 1  ON 48
eH2_9                 2.872899e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5984e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.2648
    reference variance = 0.338809
====================================================
  Execution time = 2.0198e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1505e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5498e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315033169070
                                         uncertainty =       0.003381748659

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315033169070
                                         uncertainty =       0.003381748659

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396895486
  error estimate for blocks of size 2^( 2) =       0.000406927685
  error estimate for blocks of size 2^( 3) =       0.000416152819
  error estimate for blocks of size 2^( 4) =       0.000422153553
  error estimate for blocks of size 2^( 5) =       0.000426844317
  error estimate for blocks of size 2^( 6) =       0.000428460066
  error estimate for blocks of size 2^( 7) =       0.000429588778

      target function =                  N/A
              le_mean =     -17.216383077822
             les_mean =     296.718898177915
             stat err =       0.000426761678
             autocorr =       1.156161519006
              std dev =       0.561294978697
             le_variance =       0.315052053111


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721638307782e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+04, overlap shift 1.5259e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216383077822       residual = 6.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216383077834       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216383077832       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216383077803       residual = 4.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216383077799       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216383077789       residual = 2.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216383077788       residual = 7.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+04 is 1.449388e-08

solving harmonic davidson linear method for identity shift 6.1035e+04, overlap shift 6.1035e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216383077822       residual = 6.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216383077825       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216383077825       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216383077823       residual = 4.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216383077834       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216383077847       residual = 2.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216383077777       residual = 7.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+04 is 3.623481e-09

solving harmonic davidson linear method for identity shift 2.4414e+05, overlap shift 2.4414e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216383077822       residual = 6.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216383077823       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216383077823       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216383077770       residual = 4.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216383077821       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216383077820       residual = 2.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216383077821       residual = 7.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+05 is 9.058710e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.251320 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5754e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 2.139838e-01 1 1  ON 0
 uu_1                 5.161576e-02 1 1  ON 1
 uu_2                -4.322282e-02 1 1  ON 2
 uu_3                -9.894209e-02 1 1  ON 3
 uu_4                -1.336900e-01 1 1  ON 4
 uu_5                -1.420466e-01 1 1  ON 5
 uu_6                -1.192323e-01 1 1  ON 6
 uu_7                -4.820395e-02 1 1  ON 7
 uu_8                 9.350219e-02 1 1  ON 8
 uu_9                 1.266982e-01 1 1  ON 9
 ud_0                 3.555341e-01 1 1  ON 10
 ud_1                 9.663141e-02 1 1  ON 11
 ud_2                -1.382622e-02 1 1  ON 12
 ud_3                -7.541758e-02 1 1  ON 13
 ud_4                -1.235462e-01 1 1  ON 14
 ud_5                -1.555396e-01 1 1  ON 15
 ud_6                -1.570129e-01 1 1  ON 16
 ud_7                -1.128658e-01 1 1  ON 17
 ud_8                -4.903524e-03 1 1  ON 18
 ud_9                 9.265698e-02 1 1  ON 19
 eO_0                -7.839991e-01 1 1  ON 20
 eO_1                -4.623314e-01 1 1  ON 21
 eO_2                -5.035171e-02 1 1  ON 22
 eO_3                 2.109431e-01 1 1  ON 23
 eO_4                 3.116683e-01 1 1  ON 24
 eO_5                 3.267629e-01 1 1  ON 25
 eO_6                 2.625848e-01 1 1  ON 26
 eO_7                 1.244874e-01 1 1  ON 27
 eO_8                 2.991524e-02 1 1  ON 28
 eO_9                 1.907788e-02 1 1  ON 29
eH1_0                -1.844666e-01 1 1  ON 30
eH1_1                -1.050123e-01 1 1  ON 31
eH1_2                -6.355517e-02 1 1  ON 32
eH1_3                -2.637151e-02 1 1  ON 33
eH1_4                 1.894519e-02 1 1  ON 34
eH1_5                 3.312163e-02 1 1  ON 35
eH1_6                 7.757990e-02 1 1  ON 36
eH1_7                 1.097468e-01 1 1  ON 37
eH1_8                 9.753129e-02 1 1  ON 38
eH1_9                 2.646936e-02 1 1  ON 39
eH2_0                -1.856684e-01 1 1  ON 40
eH2_1                -1.065185e-01 1 1  ON 41
eH2_2                -6.500339e-02 1 1  ON 42
eH2_3                -2.791096e-02 1 1  ON 43
eH2_4                 1.767064e-02 1 1  ON 44
eH2_5                 3.164242e-02 1 1  ON 45
eH2_6                 7.927520e-02 1 1  ON 46
eH2_7                 1.142069e-01 1 1  ON 47
eH2_8                 1.007142e-01 1 1  ON 48
eH2_9                 2.872899e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.241
    reference variance = 0.155488
====================================================
  Execution time = 1.9843e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1346e-01
  Total weights = 2.0000e+06
  Execution time = 1.8056e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313521737396
                                         uncertainty =       0.003238408150

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313521737396
                                         uncertainty =       0.003238408150

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395891485
  error estimate for blocks of size 2^( 2) =       0.000405616907
  error estimate for blocks of size 2^( 3) =       0.000414175537
  error estimate for blocks of size 2^( 4) =       0.000420566587
  error estimate for blocks of size 2^( 5) =       0.000423955549
  error estimate for blocks of size 2^( 6) =       0.000426291889
  error estimate for blocks of size 2^( 7) =       0.000426793151

      target function =                  N/A
              le_mean =     -17.216135338661
             les_mean =     296.708775977990
             stat err =       0.000424401794
             autocorr =       1.149217156205
              std dev =       0.559875107168
             le_variance =       0.313460135627

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313521746857
                                         uncertainty =       0.003238408322

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313521746857
                                         uncertainty =       0.003238408322

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395891491
  error estimate for blocks of size 2^( 2) =       0.000405616912
  error estimate for blocks of size 2^( 3) =       0.000414175543
  error estimate for blocks of size 2^( 4) =       0.000420566592
  error estimate for blocks of size 2^( 5) =       0.000423955555
  error estimate for blocks of size 2^( 6) =       0.000426291894
  error estimate for blocks of size 2^( 7) =       0.000426793156

      target function =                  N/A
              le_mean =     -17.216135338606
             les_mean =     296.708775985557
             stat err =       0.000424401799
             autocorr =       1.149217149001
              std dev =       0.559875115617
             le_variance =       0.313460145087

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313521742127
                                         uncertainty =       0.003238408236

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313521742127
                                         uncertainty =       0.003238408236

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395891488
  error estimate for blocks of size 2^( 2) =       0.000405616909
  error estimate for blocks of size 2^( 3) =       0.000414175540
  error estimate for blocks of size 2^( 4) =       0.000420566590
  error estimate for blocks of size 2^( 5) =       0.000423955552
  error estimate for blocks of size 2^( 6) =       0.000426291891
  error estimate for blocks of size 2^( 7) =       0.000426793153

      target function =                  N/A
              le_mean =     -17.216135338634
             les_mean =     296.708775981773
             stat err =       0.000424401797
             autocorr =       1.149217152605
              std dev =       0.559875111393
             le_variance =       0.313460140357

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313521737988
                                         uncertainty =       0.003238408161

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313521737988
                                         uncertainty =       0.003238408161

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395891485
  error estimate for blocks of size 2^( 2) =       0.000405616907
  error estimate for blocks of size 2^( 3) =       0.000414175537
  error estimate for blocks of size 2^( 4) =       0.000420566587
  error estimate for blocks of size 2^( 5) =       0.000423955550
  error estimate for blocks of size 2^( 6) =       0.000426291889
  error estimate for blocks of size 2^( 7) =       0.000426793151

      target function =                  N/A
              le_mean =     -17.216135338658
             les_mean =     296.708775978463
             stat err =       0.000424401794
             autocorr =       1.149217155755
              std dev =       0.559875107696
             le_variance =       0.313460136218


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216135338661        initial  <--
     1.5259e+04     1.5259e+05             1.4494e-08       -17.216135338606
     6.1035e+04     6.1035e+05             3.6235e-09       -17.216135338634
     2.4414e+05     2.4414e+06             9.0587e-10       -17.216135338658

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.9549
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 2.139838e-01 1 1  ON 0
 uu_1                 5.161576e-02 1 1  ON 1
 uu_2                -4.322282e-02 1 1  ON 2
 uu_3                -9.894209e-02 1 1  ON 3
 uu_4                -1.336901e-01 1 1  ON 4
 uu_5                -1.420466e-01 1 1  ON 5
 uu_6                -1.192323e-01 1 1  ON 6
 uu_7                -4.820395e-02 1 1  ON 7
 uu_8                 9.350220e-02 1 1  ON 8
 uu_9                 1.266982e-01 1 1  ON 9
 ud_0                 3.555341e-01 1 1  ON 10
 ud_1                 9.663142e-02 1 1  ON 11
 ud_2                -1.382622e-02 1 1  ON 12
 ud_3                -7.541758e-02 1 1  ON 13
 ud_4                -1.235462e-01 1 1  ON 14
 ud_5                -1.555396e-01 1 1  ON 15
 ud_6                -1.570129e-01 1 1  ON 16
 ud_7                -1.128658e-01 1 1  ON 17
 ud_8                -4.903522e-03 1 1  ON 18
 ud_9                 9.265698e-02 1 1  ON 19
 eO_0                -7.839991e-01 1 1  ON 20
 eO_1                -4.623314e-01 1 1  ON 21
 eO_2                -5.035171e-02 1 1  ON 22
 eO_3                 2.109431e-01 1 1  ON 23
 eO_4                 3.116683e-01 1 1  ON 24
 eO_5                 3.267629e-01 1 1  ON 25
 eO_6                 2.625848e-01 1 1  ON 26
 eO_7                 1.244874e-01 1 1  ON 27
 eO_8                 2.991524e-02 1 1  ON 28
 eO_9                 1.907788e-02 1 1  ON 29
eH1_0                -1.844666e-01 1 1  ON 30
eH1_1                -1.050123e-01 1 1  ON 31
eH1_2                -6.355517e-02 1 1  ON 32
eH1_3                -2.637150e-02 1 1  ON 33
eH1_4                 1.894519e-02 1 1  ON 34
eH1_5                 3.312163e-02 1 1  ON 35
eH1_6                 7.757990e-02 1 1  ON 36
eH1_7                 1.097468e-01 1 1  ON 37
eH1_8                 9.753129e-02 1 1  ON 38
eH1_9                 2.646936e-02 1 1  ON 39
eH2_0                -1.856684e-01 1 1  ON 40
eH2_1                -1.065185e-01 1 1  ON 41
eH2_2                -6.500339e-02 1 1  ON 42
eH2_3                -2.791096e-02 1 1  ON 43
eH2_4                 1.767064e-02 1 1  ON 44
eH2_5                 3.164242e-02 1 1  ON 45
eH2_6                 7.927520e-02 1 1  ON 46
eH2_7                 1.142069e-01 1 1  ON 47
eH2_8                 1.007142e-01 1 1  ON 48
eH2_9                 2.872899e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4726e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.2664
    reference variance = 0.168886
====================================================
  Execution time = 2.2232e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2018e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5999e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320256069651
                                         uncertainty =       0.003835687976

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320256069651
                                         uncertainty =       0.003835687976

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400109719
  error estimate for blocks of size 2^( 2) =       0.000409871062
  error estimate for blocks of size 2^( 3) =       0.000418736882
  error estimate for blocks of size 2^( 4) =       0.000425772549
  error estimate for blocks of size 2^( 5) =       0.000429662936
  error estimate for blocks of size 2^( 6) =       0.000429525874
  error estimate for blocks of size 2^( 7) =       0.000430165518

      target function =                  N/A
              le_mean =     -17.216768338751
             les_mean =     296.737287444773
             stat err =       0.000428781719
             autocorr =       1.148455894061
              std dev =       0.565840591183
             le_variance =       0.320175574630


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721676833875e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+05, overlap shift 1.5259e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216768338751       residual = 4.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216768338743       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216768338743       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216768338748       residual = 4.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216768338748       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216768338768       residual = 3.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216768338715       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216768338653       residual = 1.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+05 is 1.730155e-09

solving harmonic davidson linear method for identity shift 6.1035e+05, overlap shift 6.1035e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216768338751       residual = 4.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216768338749       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216768338749       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216768338585       residual = 4.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216768339073       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216768338438       residual = 3.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216768338950       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216768338093       residual = 1.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+05 is 4.325384e-10

solving harmonic davidson linear method for identity shift 2.4414e+06, overlap shift 2.4414e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216768338751       residual = 4.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216768338751       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216768338751       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216768338702       residual = 4.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216768337256       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216768339736       residual = 3.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216768338542       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216768341300       residual = 1.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+06 is 1.081345e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.253970 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7839e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 2.139838e-01 1 1  ON 0
 uu_1                 5.161576e-02 1 1  ON 1
 uu_2                -4.322282e-02 1 1  ON 2
 uu_3                -9.894209e-02 1 1  ON 3
 uu_4                -1.336901e-01 1 1  ON 4
 uu_5                -1.420466e-01 1 1  ON 5
 uu_6                -1.192323e-01 1 1  ON 6
 uu_7                -4.820395e-02 1 1  ON 7
 uu_8                 9.350219e-02 1 1  ON 8
 uu_9                 1.266982e-01 1 1  ON 9
 ud_0                 3.555341e-01 1 1  ON 10
 ud_1                 9.663142e-02 1 1  ON 11
 ud_2                -1.382622e-02 1 1  ON 12
 ud_3                -7.541758e-02 1 1  ON 13
 ud_4                -1.235462e-01 1 1  ON 14
 ud_5                -1.555396e-01 1 1  ON 15
 ud_6                -1.570129e-01 1 1  ON 16
 ud_7                -1.128658e-01 1 1  ON 17
 ud_8                -4.903522e-03 1 1  ON 18
 ud_9                 9.265698e-02 1 1  ON 19
 eO_0                -7.839991e-01 1 1  ON 20
 eO_1                -4.623314e-01 1 1  ON 21
 eO_2                -5.035171e-02 1 1  ON 22
 eO_3                 2.109431e-01 1 1  ON 23
 eO_4                 3.116683e-01 1 1  ON 24
 eO_5                 3.267629e-01 1 1  ON 25
 eO_6                 2.625848e-01 1 1  ON 26
 eO_7                 1.244874e-01 1 1  ON 27
 eO_8                 2.991524e-02 1 1  ON 28
 eO_9                 1.907788e-02 1 1  ON 29
eH1_0                -1.844666e-01 1 1  ON 30
eH1_1                -1.050123e-01 1 1  ON 31
eH1_2                -6.355517e-02 1 1  ON 32
eH1_3                -2.637150e-02 1 1  ON 33
eH1_4                 1.894519e-02 1 1  ON 34
eH1_5                 3.312163e-02 1 1  ON 35
eH1_6                 7.757990e-02 1 1  ON 36
eH1_7                 1.097468e-01 1 1  ON 37
eH1_8                 9.753129e-02 1 1  ON 38
eH1_9                 2.646936e-02 1 1  ON 39
eH2_0                -1.856684e-01 1 1  ON 40
eH2_1                -1.065185e-01 1 1  ON 41
eH2_2                -6.500339e-02 1 1  ON 42
eH2_3                -2.791096e-02 1 1  ON 43
eH2_4                 1.767064e-02 1 1  ON 44
eH2_5                 3.164242e-02 1 1  ON 45
eH2_6                 7.927520e-02 1 1  ON 46
eH2_7                 1.142069e-01 1 1  ON 47
eH2_8                 1.007142e-01 1 1  ON 48
eH2_9                 2.872899e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.2813
    reference variance = 0.221831
====================================================
  Execution time = 2.1903e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2376e-01
  Total weights = 2.0000e+06
  Execution time = 1.8109e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323863614019
                                         uncertainty =       0.008519748438

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323863614019
                                         uncertainty =       0.008519748438

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402341351
  error estimate for blocks of size 2^( 2) =       0.000411903235
  error estimate for blocks of size 2^( 3) =       0.000420616082
  error estimate for blocks of size 2^( 4) =       0.000426979038
  error estimate for blocks of size 2^( 5) =       0.000430534210
  error estimate for blocks of size 2^( 6) =       0.000432624165
  error estimate for blocks of size 2^( 7) =       0.000431877120

      target function =                  N/A
              le_mean =     -17.216550468754
             les_mean =     296.733367006249
             stat err =       0.000430503633
             autocorr =       1.144891425498
              std dev =       0.568996594862
             le_variance =       0.323757124964

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323863614963
                                         uncertainty =       0.008519748468

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323863614963
                                         uncertainty =       0.008519748468

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402341351
  error estimate for blocks of size 2^( 2) =       0.000411903236
  error estimate for blocks of size 2^( 3) =       0.000420616083
  error estimate for blocks of size 2^( 4) =       0.000426979038
  error estimate for blocks of size 2^( 5) =       0.000430534211
  error estimate for blocks of size 2^( 6) =       0.000432624165
  error estimate for blocks of size 2^( 7) =       0.000431877120

      target function =                  N/A
              le_mean =     -17.216550468764
             les_mean =     296.733367007537
             stat err =       0.000430503634
             autocorr =       1.144891424827
              std dev =       0.568996595691
             le_variance =       0.323757125908

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323863614491
                                         uncertainty =       0.008519748453

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323863614491
                                         uncertainty =       0.008519748453

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402341351
  error estimate for blocks of size 2^( 2) =       0.000411903236
  error estimate for blocks of size 2^( 3) =       0.000420616083
  error estimate for blocks of size 2^( 4) =       0.000426979038
  error estimate for blocks of size 2^( 5) =       0.000430534211
  error estimate for blocks of size 2^( 6) =       0.000432624165
  error estimate for blocks of size 2^( 7) =       0.000431877120

      target function =                  N/A
              le_mean =     -17.216550468759
             les_mean =     296.733367006893
             stat err =       0.000430503633
             autocorr =       1.144891425170
              std dev =       0.568996595276
             le_variance =       0.323757125436

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323863614078
                                         uncertainty =       0.008519748440

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323863614078
                                         uncertainty =       0.008519748440

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402341351
  error estimate for blocks of size 2^( 2) =       0.000411903235
  error estimate for blocks of size 2^( 3) =       0.000420616083
  error estimate for blocks of size 2^( 4) =       0.000426979038
  error estimate for blocks of size 2^( 5) =       0.000430534211
  error estimate for blocks of size 2^( 6) =       0.000432624165
  error estimate for blocks of size 2^( 7) =       0.000431877120

      target function =                  N/A
              le_mean =     -17.216550468755
             les_mean =     296.733367006330
             stat err =       0.000430503633
             autocorr =       1.144891425454
              std dev =       0.568996594913
             le_variance =       0.323757125023


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216550468754        initial
     1.5259e+05     1.5259e+06             1.7302e-09       -17.216550468764  <--
     6.1035e+05     6.1035e+06             4.3254e-10       -17.216550468759
     2.4414e+06     2.4414e+07             1.0813e-10       -17.216550468755

*****************************************************************************
Applying the update for shift_i =   1.5259e+05     and shift_s =   1.5259e+06
*****************************************************************************

  Execution time = 3.1025e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 2.139838e-01 1 1  ON 0
 uu_1                 5.161576e-02 1 1  ON 1
 uu_2                -4.322282e-02 1 1  ON 2
 uu_3                -9.894209e-02 1 1  ON 3
 uu_4                -1.336901e-01 1 1  ON 4
 uu_5                -1.420466e-01 1 1  ON 5
 uu_6                -1.192323e-01 1 1  ON 6
 uu_7                -4.820395e-02 1 1  ON 7
 uu_8                 9.350219e-02 1 1  ON 8
 uu_9                 1.266982e-01 1 1  ON 9
 ud_0                 3.555341e-01 1 1  ON 10
 ud_1                 9.663141e-02 1 1  ON 11
 ud_2                -1.382622e-02 1 1  ON 12
 ud_3                -7.541758e-02 1 1  ON 13
 ud_4                -1.235462e-01 1 1  ON 14
 ud_5                -1.555396e-01 1 1  ON 15
 ud_6                -1.570129e-01 1 1  ON 16
 ud_7                -1.128658e-01 1 1  ON 17
 ud_8                -4.903523e-03 1 1  ON 18
 ud_9                 9.265698e-02 1 1  ON 19
 eO_0                -7.839991e-01 1 1  ON 20
 eO_1                -4.623314e-01 1 1  ON 21
 eO_2                -5.035171e-02 1 1  ON 22
 eO_3                 2.109431e-01 1 1  ON 23
 eO_4                 3.116683e-01 1 1  ON 24
 eO_5                 3.267629e-01 1 1  ON 25
 eO_6                 2.625848e-01 1 1  ON 26
 eO_7                 1.244874e-01 1 1  ON 27
 eO_8                 2.991524e-02 1 1  ON 28
 eO_9                 1.907788e-02 1 1  ON 29
eH1_0                -1.844666e-01 1 1  ON 30
eH1_1                -1.050123e-01 1 1  ON 31
eH1_2                -6.355517e-02 1 1  ON 32
eH1_3                -2.637151e-02 1 1  ON 33
eH1_4                 1.894519e-02 1 1  ON 34
eH1_5                 3.312163e-02 1 1  ON 35
eH1_6                 7.757990e-02 1 1  ON 36
eH1_7                 1.097468e-01 1 1  ON 37
eH1_8                 9.753129e-02 1 1  ON 38
eH1_9                 2.646936e-02 1 1  ON 39
eH2_0                -1.856684e-01 1 1  ON 40
eH2_1                -1.065185e-01 1 1  ON 41
eH2_2                -6.500339e-02 1 1  ON 42
eH2_3                -2.791096e-02 1 1  ON 43
eH2_4                 1.767064e-02 1 1  ON 44
eH2_5                 3.164242e-02 1 1  ON 45
eH2_6                 7.927520e-02 1 1  ON 46
eH2_7                 1.142069e-01 1 1  ON 47
eH2_8                 1.007142e-01 1 1  ON 48
eH2_9                 2.872899e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8870e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.2076
    reference variance = 0.254593
====================================================
  Execution time = 2.0009e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1071e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4961e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310717040313
                                         uncertainty =       0.002776269603

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310717040313
                                         uncertainty =       0.002776269603

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394150799
  error estimate for blocks of size 2^( 2) =       0.000403847895
  error estimate for blocks of size 2^( 3) =       0.000413047520
  error estimate for blocks of size 2^( 4) =       0.000419091219
  error estimate for blocks of size 2^( 5) =       0.000423532693
  error estimate for blocks of size 2^( 6) =       0.000426977394
  error estimate for blocks of size 2^( 7) =       0.000430300042

      target function =                  N/A
              le_mean =     -17.216134592501
             les_mean =     296.705999856903
             stat err =       0.000424975337
             autocorr =       1.162525883257
              std dev =       0.557413405956
             le_variance =       0.310709705140


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721613459250e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+04, overlap shift 3.8147e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216134592501       residual = 8.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216134592488       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216134592479       residual = 7.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216134592486       residual = 4.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216134592470       residual = 8.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216134592488       residual = 2.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216134592428       residual = 3.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+04 is 5.737508e-09

solving harmonic davidson linear method for identity shift 1.5259e+05, overlap shift 1.5259e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216134592501       residual = 8.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216134592498       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216134592496       residual = 7.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216134592584       residual = 4.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216134592493       residual = 8.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216134592454       residual = 2.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216134592398       residual = 3.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+05 is 1.434383e-09

solving harmonic davidson linear method for identity shift 6.1035e+05, overlap shift 6.1035e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216134592501       residual = 8.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216134592500       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216134592500       residual = 7.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216134592500       residual = 4.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216134592506       residual = 8.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216134592721       residual = 2.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216134592529       residual = 3.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+05 is 3.585962e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.256249 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5511e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 2.139838e-01 1 1  ON 0
 uu_1                 5.161576e-02 1 1  ON 1
 uu_2                -4.322282e-02 1 1  ON 2
 uu_3                -9.894209e-02 1 1  ON 3
 uu_4                -1.336901e-01 1 1  ON 4
 uu_5                -1.420466e-01 1 1  ON 5
 uu_6                -1.192323e-01 1 1  ON 6
 uu_7                -4.820395e-02 1 1  ON 7
 uu_8                 9.350219e-02 1 1  ON 8
 uu_9                 1.266982e-01 1 1  ON 9
 ud_0                 3.555341e-01 1 1  ON 10
 ud_1                 9.663142e-02 1 1  ON 11
 ud_2                -1.382622e-02 1 1  ON 12
 ud_3                -7.541758e-02 1 1  ON 13
 ud_4                -1.235462e-01 1 1  ON 14
 ud_5                -1.555396e-01 1 1  ON 15
 ud_6                -1.570129e-01 1 1  ON 16
 ud_7                -1.128658e-01 1 1  ON 17
 ud_8                -4.903523e-03 1 1  ON 18
 ud_9                 9.265698e-02 1 1  ON 19
 eO_0                -7.839991e-01 1 1  ON 20
 eO_1                -4.623314e-01 1 1  ON 21
 eO_2                -5.035171e-02 1 1  ON 22
 eO_3                 2.109431e-01 1 1  ON 23
 eO_4                 3.116683e-01 1 1  ON 24
 eO_5                 3.267629e-01 1 1  ON 25
 eO_6                 2.625848e-01 1 1  ON 26
 eO_7                 1.244874e-01 1 1  ON 27
 eO_8                 2.991524e-02 1 1  ON 28
 eO_9                 1.907788e-02 1 1  ON 29
eH1_0                -1.844666e-01 1 1  ON 30
eH1_1                -1.050123e-01 1 1  ON 31
eH1_2                -6.355517e-02 1 1  ON 32
eH1_3                -2.637151e-02 1 1  ON 33
eH1_4                 1.894519e-02 1 1  ON 34
eH1_5                 3.312163e-02 1 1  ON 35
eH1_6                 7.757990e-02 1 1  ON 36
eH1_7                 1.097468e-01 1 1  ON 37
eH1_8                 9.753129e-02 1 1  ON 38
eH1_9                 2.646936e-02 1 1  ON 39
eH2_0                -1.856684e-01 1 1  ON 40
eH2_1                -1.065185e-01 1 1  ON 41
eH2_2                -6.500339e-02 1 1  ON 42
eH2_3                -2.791096e-02 1 1  ON 43
eH2_4                 1.767064e-02 1 1  ON 44
eH2_5                 3.164242e-02 1 1  ON 45
eH2_6                 7.927520e-02 1 1  ON 46
eH2_7                 1.142069e-01 1 1  ON 47
eH2_8                 1.007142e-01 1 1  ON 48
eH2_9                 2.872899e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.2015
    reference variance = 0.131957
====================================================
  Execution time = 1.9874e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2131e-01
  Total weights = 2.0000e+06
  Execution time = 1.8099e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321314014503
                                         uncertainty =       0.004213056423

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321314014503
                                         uncertainty =       0.004213056423

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400819508
  error estimate for blocks of size 2^( 2) =       0.000410483242
  error estimate for blocks of size 2^( 3) =       0.000419332271
  error estimate for blocks of size 2^( 4) =       0.000425716946
  error estimate for blocks of size 2^( 5) =       0.000429887961
  error estimate for blocks of size 2^( 6) =       0.000432135845
  error estimate for blocks of size 2^( 7) =       0.000432733096

      target function =                  N/A
              le_mean =     -17.217179336932
             les_mean =     296.752576715456
             stat err =       0.000430118462
             autocorr =       1.151538511598
              std dev =       0.566844384314
             le_variance =       0.321312556029

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321314019193
                                         uncertainty =       0.004213056464

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321314019193
                                         uncertainty =       0.004213056464

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400819511
  error estimate for blocks of size 2^( 2) =       0.000410483245
  error estimate for blocks of size 2^( 3) =       0.000419332274
  error estimate for blocks of size 2^( 4) =       0.000425716948
  error estimate for blocks of size 2^( 5) =       0.000429887963
  error estimate for blocks of size 2^( 6) =       0.000432135848
  error estimate for blocks of size 2^( 7) =       0.000432733098

      target function =                  N/A
              le_mean =     -17.217179336916
             les_mean =     296.752576719600
             stat err =       0.000430118464
             autocorr =       1.151538508228
              std dev =       0.566844388451
             le_variance =       0.321312560719

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321314016848
                                         uncertainty =       0.004213056444

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321314016848
                                         uncertainty =       0.004213056444

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400819509
  error estimate for blocks of size 2^( 2) =       0.000410483243
  error estimate for blocks of size 2^( 3) =       0.000419332273
  error estimate for blocks of size 2^( 4) =       0.000425716947
  error estimate for blocks of size 2^( 5) =       0.000429887962
  error estimate for blocks of size 2^( 6) =       0.000432135847
  error estimate for blocks of size 2^( 7) =       0.000432733097

      target function =                  N/A
              le_mean =     -17.217179336924
             les_mean =     296.752576717528
             stat err =       0.000430118463
             autocorr =       1.151538509916
              std dev =       0.566844386383
             le_variance =       0.321312558374

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321314014796
                                         uncertainty =       0.004213056426

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321314014796
                                         uncertainty =       0.004213056426

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400819508
  error estimate for blocks of size 2^( 2) =       0.000410483242
  error estimate for blocks of size 2^( 3) =       0.000419332272
  error estimate for blocks of size 2^( 4) =       0.000425716946
  error estimate for blocks of size 2^( 5) =       0.000429887961
  error estimate for blocks of size 2^( 6) =       0.000432135846
  error estimate for blocks of size 2^( 7) =       0.000432733096

      target function =                  N/A
              le_mean =     -17.217179336931
             les_mean =     296.752576715715
             stat err =       0.000430118462
             autocorr =       1.151538511386
              std dev =       0.566844384573
             le_variance =       0.321312556322


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217179336932        initial  <--
     3.8147e+04     3.8147e+05             5.7375e-09       -17.217179336916
     1.5259e+05     1.5259e+06             1.4344e-09       -17.217179336924
     6.1035e+05     6.1035e+06             3.5860e-10       -17.217179336931

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.9874
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 2.139838e-01 1 1  ON 0
 uu_1                 5.161576e-02 1 1  ON 1
 uu_2                -4.322282e-02 1 1  ON 2
 uu_3                -9.894209e-02 1 1  ON 3
 uu_4                -1.336901e-01 1 1  ON 4
 uu_5                -1.420466e-01 1 1  ON 5
 uu_6                -1.192323e-01 1 1  ON 6
 uu_7                -4.820395e-02 1 1  ON 7
 uu_8                 9.350219e-02 1 1  ON 8
 uu_9                 1.266982e-01 1 1  ON 9
 ud_0                 3.555341e-01 1 1  ON 10
 ud_1                 9.663141e-02 1 1  ON 11
 ud_2                -1.382622e-02 1 1  ON 12
 ud_3                -7.541758e-02 1 1  ON 13
 ud_4                -1.235462e-01 1 1  ON 14
 ud_5                -1.555396e-01 1 1  ON 15
 ud_6                -1.570129e-01 1 1  ON 16
 ud_7                -1.128658e-01 1 1  ON 17
 ud_8                -4.903523e-03 1 1  ON 18
 ud_9                 9.265698e-02 1 1  ON 19
 eO_0                -7.839991e-01 1 1  ON 20
 eO_1                -4.623314e-01 1 1  ON 21
 eO_2                -5.035171e-02 1 1  ON 22
 eO_3                 2.109431e-01 1 1  ON 23
 eO_4                 3.116683e-01 1 1  ON 24
 eO_5                 3.267629e-01 1 1  ON 25
 eO_6                 2.625848e-01 1 1  ON 26
 eO_7                 1.244874e-01 1 1  ON 27
 eO_8                 2.991524e-02 1 1  ON 28
 eO_9                 1.907788e-02 1 1  ON 29
eH1_0                -1.844666e-01 1 1  ON 30
eH1_1                -1.050123e-01 1 1  ON 31
eH1_2                -6.355517e-02 1 1  ON 32
eH1_3                -2.637151e-02 1 1  ON 33
eH1_4                 1.894519e-02 1 1  ON 34
eH1_5                 3.312163e-02 1 1  ON 35
eH1_6                 7.757990e-02 1 1  ON 36
eH1_7                 1.097468e-01 1 1  ON 37
eH1_8                 9.753129e-02 1 1  ON 38
eH1_9                 2.646936e-02 1 1  ON 39
eH2_0                -1.856684e-01 1 1  ON 40
eH2_1                -1.065185e-01 1 1  ON 41
eH2_2                -6.500339e-02 1 1  ON 42
eH2_3                -2.791096e-02 1 1  ON 43
eH2_4                 1.767064e-02 1 1  ON 44
eH2_5                 3.164242e-02 1 1  ON 45
eH2_6                 7.927520e-02 1 1  ON 46
eH2_7                 1.142069e-01 1 1  ON 47
eH2_8                 1.007142e-01 1 1  ON 48
eH2_9                 2.872899e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4505e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.2315
    reference variance = 0.232724
====================================================
  Execution time = 1.9867e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1388e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5539e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313944258681
                                         uncertainty =       0.003512589362

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313944258681
                                         uncertainty =       0.003512589362

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396155323
  error estimate for blocks of size 2^( 2) =       0.000405791709
  error estimate for blocks of size 2^( 3) =       0.000414456690
  error estimate for blocks of size 2^( 4) =       0.000420833878
  error estimate for blocks of size 2^( 5) =       0.000425363714
  error estimate for blocks of size 2^( 6) =       0.000425870468
  error estimate for blocks of size 2^( 7) =       0.000428363194

      target function =                  N/A
              le_mean =     -17.217047305349
             les_mean =     296.740595837707
             stat err =       0.000425107813
             autocorr =       1.151508592451
              std dev =       0.560248230704
             le_variance =       0.313878080007


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721704730535e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+05, overlap shift 3.8147e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217047305349       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217047305350       residual = 3.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217047305351       residual = 7.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217047305252       residual = 4.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217047304831       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217047305319       residual = 4.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217047305434       residual = 5.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+05 is 5.722537e-10

solving harmonic davidson linear method for identity shift 1.5259e+06, overlap shift 1.5259e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217047305349       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217047305350       residual = 3.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217047305350       residual = 7.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217047305242       residual = 4.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217047305184       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217047305345       residual = 4.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217047303833       residual = 5.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+06 is 1.430634e-10

solving harmonic davidson linear method for identity shift 6.1035e+06, overlap shift 6.1035e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217047305349       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217047305349       residual = 3.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217047305349       residual = 7.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217047303895       residual = 4.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217047305350       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217047305489       residual = 4.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217047306873       residual = 5.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+06 is 3.576580e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.258495 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5427e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 2.139838e-01 1 1  ON 0
 uu_1                 5.161576e-02 1 1  ON 1
 uu_2                -4.322282e-02 1 1  ON 2
 uu_3                -9.894209e-02 1 1  ON 3
 uu_4                -1.336901e-01 1 1  ON 4
 uu_5                -1.420466e-01 1 1  ON 5
 uu_6                -1.192323e-01 1 1  ON 6
 uu_7                -4.820395e-02 1 1  ON 7
 uu_8                 9.350219e-02 1 1  ON 8
 uu_9                 1.266982e-01 1 1  ON 9
 ud_0                 3.555341e-01 1 1  ON 10
 ud_1                 9.663142e-02 1 1  ON 11
 ud_2                -1.382622e-02 1 1  ON 12
 ud_3                -7.541758e-02 1 1  ON 13
 ud_4                -1.235462e-01 1 1  ON 14
 ud_5                -1.555396e-01 1 1  ON 15
 ud_6                -1.570129e-01 1 1  ON 16
 ud_7                -1.128658e-01 1 1  ON 17
 ud_8                -4.903523e-03 1 1  ON 18
 ud_9                 9.265698e-02 1 1  ON 19
 eO_0                -7.839991e-01 1 1  ON 20
 eO_1                -4.623314e-01 1 1  ON 21
 eO_2                -5.035171e-02 1 1  ON 22
 eO_3                 2.109431e-01 1 1  ON 23
 eO_4                 3.116683e-01 1 1  ON 24
 eO_5                 3.267629e-01 1 1  ON 25
 eO_6                 2.625848e-01 1 1  ON 26
 eO_7                 1.244874e-01 1 1  ON 27
 eO_8                 2.991524e-02 1 1  ON 28
 eO_9                 1.907788e-02 1 1  ON 29
eH1_0                -1.844666e-01 1 1  ON 30
eH1_1                -1.050123e-01 1 1  ON 31
eH1_2                -6.355517e-02 1 1  ON 32
eH1_3                -2.637151e-02 1 1  ON 33
eH1_4                 1.894519e-02 1 1  ON 34
eH1_5                 3.312163e-02 1 1  ON 35
eH1_6                 7.757990e-02 1 1  ON 36
eH1_7                 1.097468e-01 1 1  ON 37
eH1_8                 9.753129e-02 1 1  ON 38
eH1_9                 2.646936e-02 1 1  ON 39
eH2_0                -1.856684e-01 1 1  ON 40
eH2_1                -1.065185e-01 1 1  ON 41
eH2_2                -6.500339e-02 1 1  ON 42
eH2_3                -2.791096e-02 1 1  ON 43
eH2_4                 1.767064e-02 1 1  ON 44
eH2_5                 3.164242e-02 1 1  ON 45
eH2_6                 7.927520e-02 1 1  ON 46
eH2_7                 1.142069e-01 1 1  ON 47
eH2_8                 1.007142e-01 1 1  ON 48
eH2_9                 2.872899e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.2182
    reference variance = 0.335227
====================================================
  Execution time = 1.9623e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1240e-01
  Total weights = 2.0000e+06
  Execution time = 1.8126e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312482760986
                                         uncertainty =       0.002230099240

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312482760986
                                         uncertainty =       0.002230099240

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395219778
  error estimate for blocks of size 2^( 2) =       0.000404931010
  error estimate for blocks of size 2^( 3) =       0.000413654662
  error estimate for blocks of size 2^( 4) =       0.000420835766
  error estimate for blocks of size 2^( 5) =       0.000425072601
  error estimate for blocks of size 2^( 6) =       0.000427935802
  error estimate for blocks of size 2^( 7) =       0.000427893320

      target function =                  N/A
              le_mean =     -17.217236598469
             les_mean =     296.745633276603
             stat err =       0.000425434372
             autocorr =       1.158744835931
              std dev =       0.558925169541
             le_variance =       0.312397345147

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312482761141
                                         uncertainty =       0.002230099241

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312482761141
                                         uncertainty =       0.002230099241

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395219778
  error estimate for blocks of size 2^( 2) =       0.000404931010
  error estimate for blocks of size 2^( 3) =       0.000413654662
  error estimate for blocks of size 2^( 4) =       0.000420835766
  error estimate for blocks of size 2^( 5) =       0.000425072601
  error estimate for blocks of size 2^( 6) =       0.000427935802
  error estimate for blocks of size 2^( 7) =       0.000427893321

      target function =                  N/A
              le_mean =     -17.217236598468
             les_mean =     296.745633276738
             stat err =       0.000425434372
             autocorr =       1.158744835793
              std dev =       0.558925169680
             le_variance =       0.312397345302

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312482761064
                                         uncertainty =       0.002230099240

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312482761064
                                         uncertainty =       0.002230099240

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395219778
  error estimate for blocks of size 2^( 2) =       0.000404931010
  error estimate for blocks of size 2^( 3) =       0.000413654662
  error estimate for blocks of size 2^( 4) =       0.000420835766
  error estimate for blocks of size 2^( 5) =       0.000425072601
  error estimate for blocks of size 2^( 6) =       0.000427935802
  error estimate for blocks of size 2^( 7) =       0.000427893321

      target function =                  N/A
              le_mean =     -17.217236598469
             les_mean =     296.745633276670
             stat err =       0.000425434372
             autocorr =       1.158744835857
              std dev =       0.558925169610
             le_variance =       0.312397345224

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312482760996
                                         uncertainty =       0.002230099240

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312482760996
                                         uncertainty =       0.002230099240

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395219778
  error estimate for blocks of size 2^( 2) =       0.000404931010
  error estimate for blocks of size 2^( 3) =       0.000413654662
  error estimate for blocks of size 2^( 4) =       0.000420835766
  error estimate for blocks of size 2^( 5) =       0.000425072601
  error estimate for blocks of size 2^( 6) =       0.000427935802
  error estimate for blocks of size 2^( 7) =       0.000427893320

      target function =                  N/A
              le_mean =     -17.217236598469
             les_mean =     296.745633276611
             stat err =       0.000425434372
             autocorr =       1.158744835917
              std dev =       0.558925169550
             le_variance =       0.312397345156


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217236598469        initial  <--
     3.8147e+05     3.8147e+06             5.7225e-10       -17.217236598468
     1.5259e+06     1.5259e+07             1.4306e-10       -17.217236598469
     6.1035e+06     6.1035e+07             3.5766e-11       -17.217236598469

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.8038
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 2.139838e-01 1 1  ON 0
 uu_1                 5.161576e-02 1 1  ON 1
 uu_2                -4.322282e-02 1 1  ON 2
 uu_3                -9.894209e-02 1 1  ON 3
 uu_4                -1.336901e-01 1 1  ON 4
 uu_5                -1.420466e-01 1 1  ON 5
 uu_6                -1.192323e-01 1 1  ON 6
 uu_7                -4.820395e-02 1 1  ON 7
 uu_8                 9.350219e-02 1 1  ON 8
 uu_9                 1.266982e-01 1 1  ON 9
 ud_0                 3.555341e-01 1 1  ON 10
 ud_1                 9.663141e-02 1 1  ON 11
 ud_2                -1.382622e-02 1 1  ON 12
 ud_3                -7.541758e-02 1 1  ON 13
 ud_4                -1.235462e-01 1 1  ON 14
 ud_5                -1.555396e-01 1 1  ON 15
 ud_6                -1.570129e-01 1 1  ON 16
 ud_7                -1.128658e-01 1 1  ON 17
 ud_8                -4.903523e-03 1 1  ON 18
 ud_9                 9.265698e-02 1 1  ON 19
 eO_0                -7.839991e-01 1 1  ON 20
 eO_1                -4.623314e-01 1 1  ON 21
 eO_2                -5.035171e-02 1 1  ON 22
 eO_3                 2.109431e-01 1 1  ON 23
 eO_4                 3.116683e-01 1 1  ON 24
 eO_5                 3.267629e-01 1 1  ON 25
 eO_6                 2.625848e-01 1 1  ON 26
 eO_7                 1.244874e-01 1 1  ON 27
 eO_8                 2.991524e-02 1 1  ON 28
 eO_9                 1.907788e-02 1 1  ON 29
eH1_0                -1.844666e-01 1 1  ON 30
eH1_1                -1.050123e-01 1 1  ON 31
eH1_2                -6.355517e-02 1 1  ON 32
eH1_3                -2.637151e-02 1 1  ON 33
eH1_4                 1.894519e-02 1 1  ON 34
eH1_5                 3.312163e-02 1 1  ON 35
eH1_6                 7.757990e-02 1 1  ON 36
eH1_7                 1.097468e-01 1 1  ON 37
eH1_8                 9.753129e-02 1 1  ON 38
eH1_9                 2.646936e-02 1 1  ON 39
eH2_0                -1.856684e-01 1 1  ON 40
eH2_1                -1.065185e-01 1 1  ON 41
eH2_2                -6.500339e-02 1 1  ON 42
eH2_3                -2.791096e-02 1 1  ON 43
eH2_4                 1.767064e-02 1 1  ON 44
eH2_5                 3.164242e-02 1 1  ON 45
eH2_6                 7.927520e-02 1 1  ON 46
eH2_7                 1.142069e-01 1 1  ON 47
eH2_8                 1.007142e-01 1 1  ON 48
eH2_9                 2.872899e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4239e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.2427
    reference variance = 0.183571
====================================================
  Execution time = 2.0052e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1808e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5182e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318118756596
                                         uncertainty =       0.006001556598

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318118756596
                                         uncertainty =       0.006001556598

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398801154
  error estimate for blocks of size 2^( 2) =       0.000408336656
  error estimate for blocks of size 2^( 3) =       0.000416339830
  error estimate for blocks of size 2^( 4) =       0.000422927105
  error estimate for blocks of size 2^( 5) =       0.000427207781
  error estimate for blocks of size 2^( 6) =       0.000429016047
  error estimate for blocks of size 2^( 7) =       0.000427779115

      target function =                  N/A
              le_mean =     -17.217131939535
             les_mean =     296.747716784605
             stat err =       0.000426732512
             autocorr =       1.144981981805
              std dev =       0.563990000156
             le_variance =       0.318084720276


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721713193954e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+06, overlap shift 3.8147e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217131939535       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217131939535       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217131939535       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217131937921       residual = 3.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217131939464       residual = 7.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217131936482       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217131933316       residual = 4.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+06 is 6.445045e-11

solving harmonic davidson linear method for identity shift 1.5259e+07, overlap shift 1.5259e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217131939535       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217131939535       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217131939535       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217131937596       residual = 3.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217131939649       residual = 7.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217131939529       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217131928685       residual = 4.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+07 is 1.611254e-11

solving harmonic davidson linear method for identity shift 6.1035e+07, overlap shift 6.1035e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217131939535       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217131939535       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217131939535       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217131939535       residual = 3.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217131924062       residual = 7.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217131934317       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217131933742       residual = 4.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+07 is 4.028267e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.260798 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5577e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 2.139838e-01 1 1  ON 0
 uu_1                 5.161576e-02 1 1  ON 1
 uu_2                -4.322282e-02 1 1  ON 2
 uu_3                -9.894209e-02 1 1  ON 3
 uu_4                -1.336901e-01 1 1  ON 4
 uu_5                -1.420466e-01 1 1  ON 5
 uu_6                -1.192323e-01 1 1  ON 6
 uu_7                -4.820395e-02 1 1  ON 7
 uu_8                 9.350219e-02 1 1  ON 8
 uu_9                 1.266982e-01 1 1  ON 9
 ud_0                 3.555341e-01 1 1  ON 10
 ud_1                 9.663141e-02 1 1  ON 11
 ud_2                -1.382622e-02 1 1  ON 12
 ud_3                -7.541758e-02 1 1  ON 13
 ud_4                -1.235462e-01 1 1  ON 14
 ud_5                -1.555396e-01 1 1  ON 15
 ud_6                -1.570129e-01 1 1  ON 16
 ud_7                -1.128658e-01 1 1  ON 17
 ud_8                -4.903523e-03 1 1  ON 18
 ud_9                 9.265698e-02 1 1  ON 19
 eO_0                -7.839991e-01 1 1  ON 20
 eO_1                -4.623314e-01 1 1  ON 21
 eO_2                -5.035171e-02 1 1  ON 22
 eO_3                 2.109431e-01 1 1  ON 23
 eO_4                 3.116683e-01 1 1  ON 24
 eO_5                 3.267629e-01 1 1  ON 25
 eO_6                 2.625848e-01 1 1  ON 26
 eO_7                 1.244874e-01 1 1  ON 27
 eO_8                 2.991524e-02 1 1  ON 28
 eO_9                 1.907788e-02 1 1  ON 29
eH1_0                -1.844666e-01 1 1  ON 30
eH1_1                -1.050123e-01 1 1  ON 31
eH1_2                -6.355517e-02 1 1  ON 32
eH1_3                -2.637151e-02 1 1  ON 33
eH1_4                 1.894519e-02 1 1  ON 34
eH1_5                 3.312163e-02 1 1  ON 35
eH1_6                 7.757990e-02 1 1  ON 36
eH1_7                 1.097468e-01 1 1  ON 37
eH1_8                 9.753129e-02 1 1  ON 38
eH1_9                 2.646936e-02 1 1  ON 39
eH2_0                -1.856684e-01 1 1  ON 40
eH2_1                -1.065185e-01 1 1  ON 41
eH2_2                -6.500339e-02 1 1  ON 42
eH2_3                -2.791096e-02 1 1  ON 43
eH2_4                 1.767064e-02 1 1  ON 44
eH2_5                 3.164242e-02 1 1  ON 45
eH2_6                 7.927520e-02 1 1  ON 46
eH2_7                 1.142069e-01 1 1  ON 47
eH2_8                 1.007142e-01 1 1  ON 48
eH2_9                 2.872899e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.1365
    reference variance = 0.156413
====================================================
  Execution time = 1.9945e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1375e-01
  Total weights = 2.0000e+06
  Execution time = 1.8062e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313428959387
                                         uncertainty =       0.002780651887

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313428959387
                                         uncertainty =       0.002780651887

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396073583
  error estimate for blocks of size 2^( 2) =       0.000405945242
  error estimate for blocks of size 2^( 3) =       0.000414613730
  error estimate for blocks of size 2^( 4) =       0.000420704534
  error estimate for blocks of size 2^( 5) =       0.000425470549
  error estimate for blocks of size 2^( 6) =       0.000427568333
  error estimate for blocks of size 2^( 7) =       0.000430704097

      target function =                  N/A
              le_mean =     -17.216855936889
             les_mean =     296.733876760788
             stat err =       0.000426111878
             autocorr =       1.157432111883
              std dev =       0.560132632565
             le_variance =       0.313748566064

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313428959427
                                         uncertainty =       0.002780651888

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313428959427
                                         uncertainty =       0.002780651888

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396073583
  error estimate for blocks of size 2^( 2) =       0.000405945242
  error estimate for blocks of size 2^( 3) =       0.000414613730
  error estimate for blocks of size 2^( 4) =       0.000420704534
  error estimate for blocks of size 2^( 5) =       0.000425470549
  error estimate for blocks of size 2^( 6) =       0.000427568333
  error estimate for blocks of size 2^( 7) =       0.000430704097

      target function =                  N/A
              le_mean =     -17.216855936889
             les_mean =     296.733876760829
             stat err =       0.000426111878
             autocorr =       1.157432111846
              std dev =       0.560132632601
             le_variance =       0.313748566105

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313428959407
                                         uncertainty =       0.002780651888

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313428959407
                                         uncertainty =       0.002780651888

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396073583
  error estimate for blocks of size 2^( 2) =       0.000405945242
  error estimate for blocks of size 2^( 3) =       0.000414613730
  error estimate for blocks of size 2^( 4) =       0.000420704534
  error estimate for blocks of size 2^( 5) =       0.000425470549
  error estimate for blocks of size 2^( 6) =       0.000427568333
  error estimate for blocks of size 2^( 7) =       0.000430704097

      target function =                  N/A
              le_mean =     -17.216855936889
             les_mean =     296.733876760809
             stat err =       0.000426111878
             autocorr =       1.157432111855
              std dev =       0.560132632583
             le_variance =       0.313748566084

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313428959389
                                         uncertainty =       0.002780651887

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313428959389
                                         uncertainty =       0.002780651887

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396073583
  error estimate for blocks of size 2^( 2) =       0.000405945242
  error estimate for blocks of size 2^( 3) =       0.000414613730
  error estimate for blocks of size 2^( 4) =       0.000420704534
  error estimate for blocks of size 2^( 5) =       0.000425470549
  error estimate for blocks of size 2^( 6) =       0.000427568333
  error estimate for blocks of size 2^( 7) =       0.000430704097

      target function =                  N/A
              le_mean =     -17.216855936889
             les_mean =     296.733876760791
             stat err =       0.000426111878
             autocorr =       1.157432111881
              std dev =       0.560132632567
             le_variance =       0.313748566067


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216855936889        initial
     3.8147e+06     3.8147e+07             6.4450e-11       -17.216855936889  <--
     1.5259e+07     1.5259e+08             1.6113e-11       -17.216855936889
     6.1035e+07     6.1035e+08             4.0283e-12       -17.216855936889

*****************************************************************************
Applying the update for shift_i =   3.8147e+06     and shift_s =   3.8147e+07
*****************************************************************************

  Execution time = 2.9041e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 2.139838e-01 1 1  ON 0
 uu_1                 5.161576e-02 1 1  ON 1
 uu_2                -4.322282e-02 1 1  ON 2
 uu_3                -9.894209e-02 1 1  ON 3
 uu_4                -1.336901e-01 1 1  ON 4
 uu_5                -1.420466e-01 1 1  ON 5
 uu_6                -1.192323e-01 1 1  ON 6
 uu_7                -4.820395e-02 1 1  ON 7
 uu_8                 9.350219e-02 1 1  ON 8
 uu_9                 1.266982e-01 1 1  ON 9
 ud_0                 3.555341e-01 1 1  ON 10
 ud_1                 9.663141e-02 1 1  ON 11
 ud_2                -1.382622e-02 1 1  ON 12
 ud_3                -7.541758e-02 1 1  ON 13
 ud_4                -1.235462e-01 1 1  ON 14
 ud_5                -1.555396e-01 1 1  ON 15
 ud_6                -1.570129e-01 1 1  ON 16
 ud_7                -1.128658e-01 1 1  ON 17
 ud_8                -4.903523e-03 1 1  ON 18
 ud_9                 9.265698e-02 1 1  ON 19
 eO_0                -7.839991e-01 1 1  ON 20
 eO_1                -4.623314e-01 1 1  ON 21
 eO_2                -5.035171e-02 1 1  ON 22
 eO_3                 2.109431e-01 1 1  ON 23
 eO_4                 3.116683e-01 1 1  ON 24
 eO_5                 3.267629e-01 1 1  ON 25
 eO_6                 2.625848e-01 1 1  ON 26
 eO_7                 1.244874e-01 1 1  ON 27
 eO_8                 2.991524e-02 1 1  ON 28
 eO_9                 1.907788e-02 1 1  ON 29
eH1_0                -1.844666e-01 1 1  ON 30
eH1_1                -1.050123e-01 1 1  ON 31
eH1_2                -6.355517e-02 1 1  ON 32
eH1_3                -2.637151e-02 1 1  ON 33
eH1_4                 1.894519e-02 1 1  ON 34
eH1_5                 3.312163e-02 1 1  ON 35
eH1_6                 7.757990e-02 1 1  ON 36
eH1_7                 1.097468e-01 1 1  ON 37
eH1_8                 9.753129e-02 1 1  ON 38
eH1_9                 2.646936e-02 1 1  ON 39
eH2_0                -1.856684e-01 1 1  ON 40
eH2_1                -1.065185e-01 1 1  ON 41
eH2_2                -6.500339e-02 1 1  ON 42
eH2_3                -2.791096e-02 1 1  ON 43
eH2_4                 1.767064e-02 1 1  ON 44
eH2_5                 3.164242e-02 1 1  ON 45
eH2_6                 7.927520e-02 1 1  ON 46
eH2_7                 1.142069e-01 1 1  ON 47
eH2_8                 1.007142e-01 1 1  ON 48
eH2_9                 2.872899e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4624e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.1873
    reference variance = 0.246088
====================================================
  Execution time = 2.0232e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1847e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5315e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318526702830
                                         uncertainty =       0.003257226308

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318526702830
                                         uncertainty =       0.003257226308

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399041408
  error estimate for blocks of size 2^( 2) =       0.000408677019
  error estimate for blocks of size 2^( 3) =       0.000417392412
  error estimate for blocks of size 2^( 4) =       0.000423689456
  error estimate for blocks of size 2^( 5) =       0.000428070678
  error estimate for blocks of size 2^( 6) =       0.000428927644
  error estimate for blocks of size 2^( 7) =       0.000431073294

      target function =                  N/A
              le_mean =     -17.216632811893
             les_mean =     296.730913310893
             stat err =       0.000427940268
             autocorr =       1.150086168170
              std dev =       0.564329771115
             le_variance =       0.318468090566


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721663281189e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+05, overlap shift 9.5367e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216632811893       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216632811893       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216632811893       residual = 5.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216632811893       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216632811893       residual = 2.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216632811906       residual = 3.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216632811239       residual = 8.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+05 is 2.989495e-10

solving harmonic davidson linear method for identity shift 3.8147e+06, overlap shift 3.8147e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216632811893       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216632811893       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216632811893       residual = 5.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216632813801       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216632811965       residual = 2.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216632810398       residual = 3.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216632811204       residual = 8.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+06 is 7.473739e-11

solving harmonic davidson linear method for identity shift 1.5259e+07, overlap shift 1.5259e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216632811893       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216632811893       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216632811893       residual = 5.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216632811893       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216632811893       residual = 2.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216632815915       residual = 3.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216632811389       residual = 8.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+07 is 1.868434e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.263100 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5770e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 2.139838e-01 1 1  ON 0
 uu_1                 5.161576e-02 1 1  ON 1
 uu_2                -4.322282e-02 1 1  ON 2
 uu_3                -9.894209e-02 1 1  ON 3
 uu_4                -1.336901e-01 1 1  ON 4
 uu_5                -1.420466e-01 1 1  ON 5
 uu_6                -1.192323e-01 1 1  ON 6
 uu_7                -4.820395e-02 1 1  ON 7
 uu_8                 9.350219e-02 1 1  ON 8
 uu_9                 1.266982e-01 1 1  ON 9
 ud_0                 3.555341e-01 1 1  ON 10
 ud_1                 9.663141e-02 1 1  ON 11
 ud_2                -1.382622e-02 1 1  ON 12
 ud_3                -7.541758e-02 1 1  ON 13
 ud_4                -1.235462e-01 1 1  ON 14
 ud_5                -1.555396e-01 1 1  ON 15
 ud_6                -1.570129e-01 1 1  ON 16
 ud_7                -1.128658e-01 1 1  ON 17
 ud_8                -4.903523e-03 1 1  ON 18
 ud_9                 9.265698e-02 1 1  ON 19
 eO_0                -7.839991e-01 1 1  ON 20
 eO_1                -4.623314e-01 1 1  ON 21
 eO_2                -5.035171e-02 1 1  ON 22
 eO_3                 2.109431e-01 1 1  ON 23
 eO_4                 3.116683e-01 1 1  ON 24
 eO_5                 3.267629e-01 1 1  ON 25
 eO_6                 2.625848e-01 1 1  ON 26
 eO_7                 1.244874e-01 1 1  ON 27
 eO_8                 2.991524e-02 1 1  ON 28
 eO_9                 1.907788e-02 1 1  ON 29
eH1_0                -1.844666e-01 1 1  ON 30
eH1_1                -1.050123e-01 1 1  ON 31
eH1_2                -6.355517e-02 1 1  ON 32
eH1_3                -2.637151e-02 1 1  ON 33
eH1_4                 1.894519e-02 1 1  ON 34
eH1_5                 3.312163e-02 1 1  ON 35
eH1_6                 7.757990e-02 1 1  ON 36
eH1_7                 1.097468e-01 1 1  ON 37
eH1_8                 9.753129e-02 1 1  ON 38
eH1_9                 2.646936e-02 1 1  ON 39
eH2_0                -1.856684e-01 1 1  ON 40
eH2_1                -1.065185e-01 1 1  ON 41
eH2_2                -6.500339e-02 1 1  ON 42
eH2_3                -2.791096e-02 1 1  ON 43
eH2_4                 1.767064e-02 1 1  ON 44
eH2_5                 3.164242e-02 1 1  ON 45
eH2_6                 7.927520e-02 1 1  ON 46
eH2_7                 1.142069e-01 1 1  ON 47
eH2_8                 1.007142e-01 1 1  ON 48
eH2_9                 2.872899e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.2418
    reference variance = 0.177065
====================================================
  Execution time = 1.9752e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2109e-01
  Total weights = 2.0000e+06
  Execution time = 1.8126e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321167043535
                                         uncertainty =       0.004014699490

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321167043535
                                         uncertainty =       0.004014699490

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400677830
  error estimate for blocks of size 2^( 2) =       0.000410247885
  error estimate for blocks of size 2^( 3) =       0.000418940878
  error estimate for blocks of size 2^( 4) =       0.000425160658
  error estimate for blocks of size 2^( 5) =       0.000428932321
  error estimate for blocks of size 2^( 6) =       0.000432571948
  error estimate for blocks of size 2^( 7) =       0.000431840450

      target function =                  N/A
              le_mean =     -17.216593895742
             les_mean =     296.732190657417
             stat err =       0.000429626344
             autocorr =       1.149717604106
              std dev =       0.566644021459
             le_variance =       0.321085447056

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321167043641
                                         uncertainty =       0.004014699491

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321167043641
                                         uncertainty =       0.004014699491

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400677830
  error estimate for blocks of size 2^( 2) =       0.000410247885
  error estimate for blocks of size 2^( 3) =       0.000418940878
  error estimate for blocks of size 2^( 4) =       0.000425160658
  error estimate for blocks of size 2^( 5) =       0.000428932321
  error estimate for blocks of size 2^( 6) =       0.000432571948
  error estimate for blocks of size 2^( 7) =       0.000431840450

      target function =                  N/A
              le_mean =     -17.216593895742
             les_mean =     296.732190657511
             stat err =       0.000429626344
             autocorr =       1.149717604026
              std dev =       0.566644021553
             le_variance =       0.321085447162

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321167043588
                                         uncertainty =       0.004014699491

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321167043588
                                         uncertainty =       0.004014699491

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400677830
  error estimate for blocks of size 2^( 2) =       0.000410247885
  error estimate for blocks of size 2^( 3) =       0.000418940878
  error estimate for blocks of size 2^( 4) =       0.000425160658
  error estimate for blocks of size 2^( 5) =       0.000428932321
  error estimate for blocks of size 2^( 6) =       0.000432571948
  error estimate for blocks of size 2^( 7) =       0.000431840450

      target function =                  N/A
              le_mean =     -17.216593895742
             les_mean =     296.732190657464
             stat err =       0.000429626344
             autocorr =       1.149717604077
              std dev =       0.566644021506
             le_variance =       0.321085447109

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321167043542
                                         uncertainty =       0.004014699490

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321167043542
                                         uncertainty =       0.004014699490

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400677830
  error estimate for blocks of size 2^( 2) =       0.000410247885
  error estimate for blocks of size 2^( 3) =       0.000418940878
  error estimate for blocks of size 2^( 4) =       0.000425160658
  error estimate for blocks of size 2^( 5) =       0.000428932321
  error estimate for blocks of size 2^( 6) =       0.000432571948
  error estimate for blocks of size 2^( 7) =       0.000431840450

      target function =                  N/A
              le_mean =     -17.216593895742
             les_mean =     296.732190657423
             stat err =       0.000429626344
             autocorr =       1.149717604100
              std dev =       0.566644021465
             le_variance =       0.321085447062


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216593895742        initial  <--
     9.5367e+05     9.5367e+06             2.9895e-10       -17.216593895742
     3.8147e+06     3.8147e+07             7.4737e-11       -17.216593895742
     1.5259e+07     1.5259e+08             1.8684e-11       -17.216593895742

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.9028
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 2.139838e-01 1 1  ON 0
 uu_1                 5.161576e-02 1 1  ON 1
 uu_2                -4.322282e-02 1 1  ON 2
 uu_3                -9.894209e-02 1 1  ON 3
 uu_4                -1.336901e-01 1 1  ON 4
 uu_5                -1.420466e-01 1 1  ON 5
 uu_6                -1.192323e-01 1 1  ON 6
 uu_7                -4.820395e-02 1 1  ON 7
 uu_8                 9.350219e-02 1 1  ON 8
 uu_9                 1.266982e-01 1 1  ON 9
 ud_0                 3.555341e-01 1 1  ON 10
 ud_1                 9.663141e-02 1 1  ON 11
 ud_2                -1.382622e-02 1 1  ON 12
 ud_3                -7.541758e-02 1 1  ON 13
 ud_4                -1.235462e-01 1 1  ON 14
 ud_5                -1.555396e-01 1 1  ON 15
 ud_6                -1.570129e-01 1 1  ON 16
 ud_7                -1.128658e-01 1 1  ON 17
 ud_8                -4.903523e-03 1 1  ON 18
 ud_9                 9.265698e-02 1 1  ON 19
 eO_0                -7.839991e-01 1 1  ON 20
 eO_1                -4.623314e-01 1 1  ON 21
 eO_2                -5.035171e-02 1 1  ON 22
 eO_3                 2.109431e-01 1 1  ON 23
 eO_4                 3.116683e-01 1 1  ON 24
 eO_5                 3.267629e-01 1 1  ON 25
 eO_6                 2.625848e-01 1 1  ON 26
 eO_7                 1.244874e-01 1 1  ON 27
 eO_8                 2.991524e-02 1 1  ON 28
 eO_9                 1.907788e-02 1 1  ON 29
eH1_0                -1.844666e-01 1 1  ON 30
eH1_1                -1.050123e-01 1 1  ON 31
eH1_2                -6.355517e-02 1 1  ON 32
eH1_3                -2.637151e-02 1 1  ON 33
eH1_4                 1.894519e-02 1 1  ON 34
eH1_5                 3.312163e-02 1 1  ON 35
eH1_6                 7.757990e-02 1 1  ON 36
eH1_7                 1.097468e-01 1 1  ON 37
eH1_8                 9.753129e-02 1 1  ON 38
eH1_9                 2.646936e-02 1 1  ON 39
eH2_0                -1.856684e-01 1 1  ON 40
eH2_1                -1.065185e-01 1 1  ON 41
eH2_2                -6.500339e-02 1 1  ON 42
eH2_3                -2.791096e-02 1 1  ON 43
eH2_4                 1.767064e-02 1 1  ON 44
eH2_5                 3.164242e-02 1 1  ON 45
eH2_6                 7.927520e-02 1 1  ON 46
eH2_7                 1.142069e-01 1 1  ON 47
eH2_8                 1.007142e-01 1 1  ON 48
eH2_9                 2.872899e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4679e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.1918
    reference variance = 0.167945
====================================================
  Execution time = 1.9768e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1847e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8231e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318459775068
                                         uncertainty =       0.002973619851

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318459775068
                                         uncertainty =       0.002973619851

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399043521
  error estimate for blocks of size 2^( 2) =       0.000408893758
  error estimate for blocks of size 2^( 3) =       0.000417213094
  error estimate for blocks of size 2^( 4) =       0.000424297910
  error estimate for blocks of size 2^( 5) =       0.000428553442
  error estimate for blocks of size 2^( 6) =       0.000429103507
  error estimate for blocks of size 2^( 7) =       0.000429610035

      target function =                  N/A
              le_mean =     -17.216938856080
             les_mean =     296.741454878813
             stat err =       0.000427891223
             autocorr =       1.149810389778
              std dev =       0.564332760032
             le_variance =       0.318471464045


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721693885608e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+06, overlap shift 9.5367e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216938856080       residual = 3.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216938856080       residual = 3.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216938856080       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216938856080       residual = 4.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216938854762       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216938860831       residual = 3.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216938843623       residual = 4.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+06 is 2.309066e-11

solving harmonic davidson linear method for identity shift 3.8147e+07, overlap shift 3.8147e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216938856080       residual = 3.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216938856080       residual = 3.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216938856080       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216938853051       residual = 4.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216938851568       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216938857813       residual = 3.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216938848089       residual = 4.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+07 is 5.772526e-12

solving harmonic davidson linear method for identity shift 1.5259e+08, overlap shift 1.5259e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216938856080       residual = 3.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216938856080       residual = 3.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216938856080       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216938857639       residual = 4.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216938849999       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216939028692       residual = 3.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216938385544       residual = 4.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+08 is 1.442721e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.265388 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8744e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 2.139838e-01 1 1  ON 0
 uu_1                 5.161576e-02 1 1  ON 1
 uu_2                -4.322282e-02 1 1  ON 2
 uu_3                -9.894209e-02 1 1  ON 3
 uu_4                -1.336901e-01 1 1  ON 4
 uu_5                -1.420466e-01 1 1  ON 5
 uu_6                -1.192323e-01 1 1  ON 6
 uu_7                -4.820395e-02 1 1  ON 7
 uu_8                 9.350219e-02 1 1  ON 8
 uu_9                 1.266982e-01 1 1  ON 9
 ud_0                 3.555341e-01 1 1  ON 10
 ud_1                 9.663141e-02 1 1  ON 11
 ud_2                -1.382622e-02 1 1  ON 12
 ud_3                -7.541758e-02 1 1  ON 13
 ud_4                -1.235462e-01 1 1  ON 14
 ud_5                -1.555396e-01 1 1  ON 15
 ud_6                -1.570129e-01 1 1  ON 16
 ud_7                -1.128658e-01 1 1  ON 17
 ud_8                -4.903523e-03 1 1  ON 18
 ud_9                 9.265698e-02 1 1  ON 19
 eO_0                -7.839991e-01 1 1  ON 20
 eO_1                -4.623314e-01 1 1  ON 21
 eO_2                -5.035171e-02 1 1  ON 22
 eO_3                 2.109431e-01 1 1  ON 23
 eO_4                 3.116683e-01 1 1  ON 24
 eO_5                 3.267629e-01 1 1  ON 25
 eO_6                 2.625848e-01 1 1  ON 26
 eO_7                 1.244874e-01 1 1  ON 27
 eO_8                 2.991524e-02 1 1  ON 28
 eO_9                 1.907788e-02 1 1  ON 29
eH1_0                -1.844666e-01 1 1  ON 30
eH1_1                -1.050123e-01 1 1  ON 31
eH1_2                -6.355517e-02 1 1  ON 32
eH1_3                -2.637151e-02 1 1  ON 33
eH1_4                 1.894519e-02 1 1  ON 34
eH1_5                 3.312163e-02 1 1  ON 35
eH1_6                 7.757990e-02 1 1  ON 36
eH1_7                 1.097468e-01 1 1  ON 37
eH1_8                 9.753129e-02 1 1  ON 38
eH1_9                 2.646936e-02 1 1  ON 39
eH2_0                -1.856684e-01 1 1  ON 40
eH2_1                -1.065185e-01 1 1  ON 41
eH2_2                -6.500339e-02 1 1  ON 42
eH2_3                -2.791096e-02 1 1  ON 43
eH2_4                 1.767064e-02 1 1  ON 44
eH2_5                 3.164242e-02 1 1  ON 45
eH2_6                 7.927520e-02 1 1  ON 46
eH2_7                 1.142069e-01 1 1  ON 47
eH2_8                 1.007142e-01 1 1  ON 48
eH2_9                 2.872899e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.1681
    reference variance = 0.387444
====================================================
  Execution time = 1.9384e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1654e-01
  Total weights = 2.0000e+06
  Execution time = 1.8278e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316513026321
                                         uncertainty =       0.003812680164

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316513026321
                                         uncertainty =       0.003812680164

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397832126
  error estimate for blocks of size 2^( 2) =       0.000407265805
  error estimate for blocks of size 2^( 3) =       0.000415802871
  error estimate for blocks of size 2^( 4) =       0.000421886393
  error estimate for blocks of size 2^( 5) =       0.000425574292
  error estimate for blocks of size 2^( 6) =       0.000427568255
  error estimate for blocks of size 2^( 7) =       0.000428696937

      target function =                  N/A
              le_mean =     -17.216561889480
             les_mean =     296.726543937768
             stat err =       0.000425931469
             autocorr =       1.146251071130
              std dev =       0.562619588831
             le_variance =       0.316540801736

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316513026326
                                         uncertainty =       0.003812680164

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316513026326
                                         uncertainty =       0.003812680164

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397832126
  error estimate for blocks of size 2^( 2) =       0.000407265805
  error estimate for blocks of size 2^( 3) =       0.000415802871
  error estimate for blocks of size 2^( 4) =       0.000421886393
  error estimate for blocks of size 2^( 5) =       0.000425574292
  error estimate for blocks of size 2^( 6) =       0.000427568255
  error estimate for blocks of size 2^( 7) =       0.000428696937

      target function =                  N/A
              le_mean =     -17.216561889480
             les_mean =     296.726543937770
             stat err =       0.000425931469
             autocorr =       1.146251071127
              std dev =       0.562619588836
             le_variance =       0.316540801742

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316513026323
                                         uncertainty =       0.003812680164

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316513026323
                                         uncertainty =       0.003812680164

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397832126
  error estimate for blocks of size 2^( 2) =       0.000407265805
  error estimate for blocks of size 2^( 3) =       0.000415802871
  error estimate for blocks of size 2^( 4) =       0.000421886393
  error estimate for blocks of size 2^( 5) =       0.000425574292
  error estimate for blocks of size 2^( 6) =       0.000427568255
  error estimate for blocks of size 2^( 7) =       0.000428696937

      target function =                  N/A
              le_mean =     -17.216561889480
             les_mean =     296.726543937769
             stat err =       0.000425931469
             autocorr =       1.146251071126
              std dev =       0.562619588833
             le_variance =       0.316540801739

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316513026321
                                         uncertainty =       0.003812680164

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316513026321
                                         uncertainty =       0.003812680164

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397832126
  error estimate for blocks of size 2^( 2) =       0.000407265805
  error estimate for blocks of size 2^( 3) =       0.000415802871
  error estimate for blocks of size 2^( 4) =       0.000421886393
  error estimate for blocks of size 2^( 5) =       0.000425574292
  error estimate for blocks of size 2^( 6) =       0.000427568255
  error estimate for blocks of size 2^( 7) =       0.000428696937

      target function =                  N/A
              le_mean =     -17.216561889480
             les_mean =     296.726543937768
             stat err =       0.000425931469
             autocorr =       1.146251071131
              std dev =       0.562619588831
             le_variance =       0.316540801736


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216561889480        initial  <--
     9.5367e+06     9.5367e+07             2.3091e-11       -17.216561889480
     3.8147e+07     3.8147e+08             5.7725e-12       -17.216561889480
     1.5259e+08     1.5259e+09             1.4427e-12       -17.216561889480

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.2937
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 2.139838e-01 1 1  ON 0
 uu_1                 5.161576e-02 1 1  ON 1
 uu_2                -4.322282e-02 1 1  ON 2
 uu_3                -9.894209e-02 1 1  ON 3
 uu_4                -1.336901e-01 1 1  ON 4
 uu_5                -1.420466e-01 1 1  ON 5
 uu_6                -1.192323e-01 1 1  ON 6
 uu_7                -4.820395e-02 1 1  ON 7
 uu_8                 9.350219e-02 1 1  ON 8
 uu_9                 1.266982e-01 1 1  ON 9
 ud_0                 3.555341e-01 1 1  ON 10
 ud_1                 9.663141e-02 1 1  ON 11
 ud_2                -1.382622e-02 1 1  ON 12
 ud_3                -7.541758e-02 1 1  ON 13
 ud_4                -1.235462e-01 1 1  ON 14
 ud_5                -1.555396e-01 1 1  ON 15
 ud_6                -1.570129e-01 1 1  ON 16
 ud_7                -1.128658e-01 1 1  ON 17
 ud_8                -4.903523e-03 1 1  ON 18
 ud_9                 9.265698e-02 1 1  ON 19
 eO_0                -7.839991e-01 1 1  ON 20
 eO_1                -4.623314e-01 1 1  ON 21
 eO_2                -5.035171e-02 1 1  ON 22
 eO_3                 2.109431e-01 1 1  ON 23
 eO_4                 3.116683e-01 1 1  ON 24
 eO_5                 3.267629e-01 1 1  ON 25
 eO_6                 2.625848e-01 1 1  ON 26
 eO_7                 1.244874e-01 1 1  ON 27
 eO_8                 2.991524e-02 1 1  ON 28
 eO_9                 1.907788e-02 1 1  ON 29
eH1_0                -1.844666e-01 1 1  ON 30
eH1_1                -1.050123e-01 1 1  ON 31
eH1_2                -6.355517e-02 1 1  ON 32
eH1_3                -2.637151e-02 1 1  ON 33
eH1_4                 1.894519e-02 1 1  ON 34
eH1_5                 3.312163e-02 1 1  ON 35
eH1_6                 7.757990e-02 1 1  ON 36
eH1_7                 1.097468e-01 1 1  ON 37
eH1_8                 9.753129e-02 1 1  ON 38
eH1_9                 2.646936e-02 1 1  ON 39
eH2_0                -1.856684e-01 1 1  ON 40
eH2_1                -1.065185e-01 1 1  ON 41
eH2_2                -6.500339e-02 1 1  ON 42
eH2_3                -2.791096e-02 1 1  ON 43
eH2_4                 1.767064e-02 1 1  ON 44
eH2_5                 3.164242e-02 1 1  ON 45
eH2_6                 7.927520e-02 1 1  ON 46
eH2_7                 1.142069e-01 1 1  ON 47
eH2_8                 1.007142e-01 1 1  ON 48
eH2_9                 2.872899e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.0060e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.2572
    reference variance = 0.264893
====================================================
  Execution time = 2.0063e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1899e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5911e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319000267233
                                         uncertainty =       0.004438179744

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319000267233
                                         uncertainty =       0.004438179744

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399365808
  error estimate for blocks of size 2^( 2) =       0.000409076875
  error estimate for blocks of size 2^( 3) =       0.000417099291
  error estimate for blocks of size 2^( 4) =       0.000424058009
  error estimate for blocks of size 2^( 5) =       0.000427863186
  error estimate for blocks of size 2^( 6) =       0.000429677014
  error estimate for blocks of size 2^( 7) =       0.000430455300

      target function =                  N/A
              le_mean =     -17.216840266348
             les_mean =     296.738574694371
             stat err =       0.000428013377
             autocorr =       1.148610881862
              std dev =       0.564788541767
             le_variance =       0.318986096911


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721684026635e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+07, overlap shift 9.5367e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216840266348       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216840266348       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216840266348       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216840266348       residual = 3.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216840266792       residual = 8.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216840269785       residual = 3.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216840280615       residual = 3.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+07 is 2.336667e-12

solving harmonic davidson linear method for identity shift 3.8147e+08, overlap shift 3.8147e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216840266348       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216840266348       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216840266348       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216840266348       residual = 3.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216840266348       residual = 8.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216840232787       residual = 3.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216840156289       residual = 3.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+08 is 5.841882e-13

solving harmonic davidson linear method for identity shift 1.5259e+09, overlap shift 1.5259e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216840266348       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216840266348       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216840266348       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216840266348       residual = 3.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216839638441       residual = 8.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216839400284       residual = 3.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216840937127       residual = 3.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+09 is 1.463002e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.267667 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5660e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 2.139838e-01 1 1  ON 0
 uu_1                 5.161576e-02 1 1  ON 1
 uu_2                -4.322282e-02 1 1  ON 2
 uu_3                -9.894209e-02 1 1  ON 3
 uu_4                -1.336901e-01 1 1  ON 4
 uu_5                -1.420466e-01 1 1  ON 5
 uu_6                -1.192323e-01 1 1  ON 6
 uu_7                -4.820395e-02 1 1  ON 7
 uu_8                 9.350219e-02 1 1  ON 8
 uu_9                 1.266982e-01 1 1  ON 9
 ud_0                 3.555341e-01 1 1  ON 10
 ud_1                 9.663141e-02 1 1  ON 11
 ud_2                -1.382622e-02 1 1  ON 12
 ud_3                -7.541758e-02 1 1  ON 13
 ud_4                -1.235462e-01 1 1  ON 14
 ud_5                -1.555396e-01 1 1  ON 15
 ud_6                -1.570129e-01 1 1  ON 16
 ud_7                -1.128658e-01 1 1  ON 17
 ud_8                -4.903523e-03 1 1  ON 18
 ud_9                 9.265698e-02 1 1  ON 19
 eO_0                -7.839991e-01 1 1  ON 20
 eO_1                -4.623314e-01 1 1  ON 21
 eO_2                -5.035171e-02 1 1  ON 22
 eO_3                 2.109431e-01 1 1  ON 23
 eO_4                 3.116683e-01 1 1  ON 24
 eO_5                 3.267629e-01 1 1  ON 25
 eO_6                 2.625848e-01 1 1  ON 26
 eO_7                 1.244874e-01 1 1  ON 27
 eO_8                 2.991524e-02 1 1  ON 28
 eO_9                 1.907788e-02 1 1  ON 29
eH1_0                -1.844666e-01 1 1  ON 30
eH1_1                -1.050123e-01 1 1  ON 31
eH1_2                -6.355517e-02 1 1  ON 32
eH1_3                -2.637151e-02 1 1  ON 33
eH1_4                 1.894519e-02 1 1  ON 34
eH1_5                 3.312163e-02 1 1  ON 35
eH1_6                 7.757990e-02 1 1  ON 36
eH1_7                 1.097468e-01 1 1  ON 37
eH1_8                 9.753129e-02 1 1  ON 38
eH1_9                 2.646936e-02 1 1  ON 39
eH2_0                -1.856684e-01 1 1  ON 40
eH2_1                -1.065185e-01 1 1  ON 41
eH2_2                -6.500339e-02 1 1  ON 42
eH2_3                -2.791096e-02 1 1  ON 43
eH2_4                 1.767064e-02 1 1  ON 44
eH2_5                 3.164242e-02 1 1  ON 45
eH2_6                 7.927520e-02 1 1  ON 46
eH2_7                 1.142069e-01 1 1  ON 47
eH2_8                 1.007142e-01 1 1  ON 48
eH2_9                 2.872899e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.2675
    reference variance = 0.212181
====================================================
  Execution time = 1.9410e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1226e-01
  Total weights = 2.0000e+06
  Execution time = 1.8086e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312259249354
                                         uncertainty =       0.002487542368

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312259249354
                                         uncertainty =       0.002487542368

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395133737
  error estimate for blocks of size 2^( 2) =       0.000404772595
  error estimate for blocks of size 2^( 3) =       0.000413071131
  error estimate for blocks of size 2^( 4) =       0.000419167669
  error estimate for blocks of size 2^( 5) =       0.000423821902
  error estimate for blocks of size 2^( 6) =       0.000426660360
  error estimate for blocks of size 2^( 7) =       0.000426419384

      target function =                  N/A
              le_mean =     -17.217189028784
             les_mean =     296.743859236242
             stat err =       0.000424017329
             autocorr =       1.151539895174
              std dev =       0.558803489144
             le_variance =       0.312261339480

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312259249356
                                         uncertainty =       0.002487542368

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312259249356
                                         uncertainty =       0.002487542368

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395133737
  error estimate for blocks of size 2^( 2) =       0.000404772595
  error estimate for blocks of size 2^( 3) =       0.000413071131
  error estimate for blocks of size 2^( 4) =       0.000419167669
  error estimate for blocks of size 2^( 5) =       0.000423821902
  error estimate for blocks of size 2^( 6) =       0.000426660360
  error estimate for blocks of size 2^( 7) =       0.000426419384

      target function =                  N/A
              le_mean =     -17.217189028784
             les_mean =     296.743859236243
             stat err =       0.000424017329
             autocorr =       1.151539895179
              std dev =       0.558803489146
             le_variance =       0.312261339482

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312259249355
                                         uncertainty =       0.002487542368

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312259249355
                                         uncertainty =       0.002487542368

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395133737
  error estimate for blocks of size 2^( 2) =       0.000404772595
  error estimate for blocks of size 2^( 3) =       0.000413071131
  error estimate for blocks of size 2^( 4) =       0.000419167669
  error estimate for blocks of size 2^( 5) =       0.000423821902
  error estimate for blocks of size 2^( 6) =       0.000426660360
  error estimate for blocks of size 2^( 7) =       0.000426419384

      target function =                  N/A
              le_mean =     -17.217189028784
             les_mean =     296.743859236242
             stat err =       0.000424017329
             autocorr =       1.151539895180
              std dev =       0.558803489145
             le_variance =       0.312261339481

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312259249354
                                         uncertainty =       0.002487542368

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312259249354
                                         uncertainty =       0.002487542368

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395133737
  error estimate for blocks of size 2^( 2) =       0.000404772595
  error estimate for blocks of size 2^( 3) =       0.000413071131
  error estimate for blocks of size 2^( 4) =       0.000419167669
  error estimate for blocks of size 2^( 5) =       0.000423821902
  error estimate for blocks of size 2^( 6) =       0.000426660360
  error estimate for blocks of size 2^( 7) =       0.000426419384

      target function =                  N/A
              le_mean =     -17.217189028784
             les_mean =     296.743859236242
             stat err =       0.000424017329
             autocorr =       1.151539895187
              std dev =       0.558803489144
             le_variance =       0.312261339480


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217189028784        initial
     9.5367e+07     9.5367e+08             2.3367e-12       -17.217189028784
     3.8147e+08     3.8147e+09             5.8419e-13       -17.217189028784
     1.5259e+09     1.5259e+10             1.4630e-13       -17.217189028784  <--

*****************************************************************************
Applying the update for shift_i =   1.5259e+09     and shift_s =   1.5259e+10
*****************************************************************************

  Execution time = 2.8521e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 2.139838e-01 1 1  ON 0
 uu_1                 5.161576e-02 1 1  ON 1
 uu_2                -4.322282e-02 1 1  ON 2
 uu_3                -9.894209e-02 1 1  ON 3
 uu_4                -1.336901e-01 1 1  ON 4
 uu_5                -1.420466e-01 1 1  ON 5
 uu_6                -1.192323e-01 1 1  ON 6
 uu_7                -4.820395e-02 1 1  ON 7
 uu_8                 9.350219e-02 1 1  ON 8
 uu_9                 1.266982e-01 1 1  ON 9
 ud_0                 3.555341e-01 1 1  ON 10
 ud_1                 9.663141e-02 1 1  ON 11
 ud_2                -1.382622e-02 1 1  ON 12
 ud_3                -7.541758e-02 1 1  ON 13
 ud_4                -1.235462e-01 1 1  ON 14
 ud_5                -1.555396e-01 1 1  ON 15
 ud_6                -1.570129e-01 1 1  ON 16
 ud_7                -1.128658e-01 1 1  ON 17
 ud_8                -4.903523e-03 1 1  ON 18
 ud_9                 9.265698e-02 1 1  ON 19
 eO_0                -7.839991e-01 1 1  ON 20
 eO_1                -4.623314e-01 1 1  ON 21
 eO_2                -5.035171e-02 1 1  ON 22
 eO_3                 2.109431e-01 1 1  ON 23
 eO_4                 3.116683e-01 1 1  ON 24
 eO_5                 3.267629e-01 1 1  ON 25
 eO_6                 2.625848e-01 1 1  ON 26
 eO_7                 1.244874e-01 1 1  ON 27
 eO_8                 2.991524e-02 1 1  ON 28
 eO_9                 1.907788e-02 1 1  ON 29
eH1_0                -1.844666e-01 1 1  ON 30
eH1_1                -1.050123e-01 1 1  ON 31
eH1_2                -6.355517e-02 1 1  ON 32
eH1_3                -2.637151e-02 1 1  ON 33
eH1_4                 1.894519e-02 1 1  ON 34
eH1_5                 3.312163e-02 1 1  ON 35
eH1_6                 7.757990e-02 1 1  ON 36
eH1_7                 1.097468e-01 1 1  ON 37
eH1_8                 9.753129e-02 1 1  ON 38
eH1_9                 2.646936e-02 1 1  ON 39
eH2_0                -1.856684e-01 1 1  ON 40
eH2_1                -1.065185e-01 1 1  ON 41
eH2_2                -6.500339e-02 1 1  ON 42
eH2_3                -2.791096e-02 1 1  ON 43
eH2_4                 1.767064e-02 1 1  ON 44
eH2_5                 3.164242e-02 1 1  ON 45
eH2_6                 7.927520e-02 1 1  ON 46
eH2_7                 1.142069e-01 1 1  ON 47
eH2_8                 1.007142e-01 1 1  ON 48
eH2_9                 2.872899e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4356e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.2983
    reference variance = 0.312105
====================================================
  Execution time = 2.0224e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2438e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4793e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324429113159
                                         uncertainty =       0.004194054812

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324429113159
                                         uncertainty =       0.004194054812

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402727554
  error estimate for blocks of size 2^( 2) =       0.000411908446
  error estimate for blocks of size 2^( 3) =       0.000420003724
  error estimate for blocks of size 2^( 4) =       0.000426611677
  error estimate for blocks of size 2^( 5) =       0.000430799694
  error estimate for blocks of size 2^( 6) =       0.000433048901
  error estimate for blocks of size 2^( 7) =       0.000435255788

      target function =                  N/A
              le_mean =     -17.216616211562
             les_mean =     296.736252579954
             stat err =       0.000431429015
             autocorr =       1.147614454650
              std dev =       0.569542769180
             le_variance =       0.324378965926


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721661621156e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+08, overlap shift 3.8147e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216616211562       residual = 7.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216616211562       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216616211562       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216616124266       residual = 4.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216616193563       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216616173852       residual = 3.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216615972031       residual = 6.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+08 is 7.627626e-13

solving harmonic davidson linear method for identity shift 1.5259e+09, overlap shift 1.5259e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216616211562       residual = 7.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216616211562       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216616211562       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216616211562       residual = 4.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216616678306       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216615178992       residual = 3.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216616634940       residual = 6.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+09 is 1.907906e-13

solving harmonic davidson linear method for identity shift 6.1035e+09, overlap shift 6.1035e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216616211562       residual = 7.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216616211562       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216616211562       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216613540448       residual = 4.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216616427765       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216615942300       residual = 3.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216604400337       residual = 2.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216610824312       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216639503844       residual = 9.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216657385490       residual = 2.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216588136119       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216608166723       residual = 7.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+09 is 4.831283e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.270954 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5710e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 2.139838e-01 1 1  ON 0
 uu_1                 5.161576e-02 1 1  ON 1
 uu_2                -4.322282e-02 1 1  ON 2
 uu_3                -9.894209e-02 1 1  ON 3
 uu_4                -1.336901e-01 1 1  ON 4
 uu_5                -1.420466e-01 1 1  ON 5
 uu_6                -1.192323e-01 1 1  ON 6
 uu_7                -4.820395e-02 1 1  ON 7
 uu_8                 9.350219e-02 1 1  ON 8
 uu_9                 1.266982e-01 1 1  ON 9
 ud_0                 3.555341e-01 1 1  ON 10
 ud_1                 9.663141e-02 1 1  ON 11
 ud_2                -1.382622e-02 1 1  ON 12
 ud_3                -7.541758e-02 1 1  ON 13
 ud_4                -1.235462e-01 1 1  ON 14
 ud_5                -1.555396e-01 1 1  ON 15
 ud_6                -1.570129e-01 1 1  ON 16
 ud_7                -1.128658e-01 1 1  ON 17
 ud_8                -4.903523e-03 1 1  ON 18
 ud_9                 9.265698e-02 1 1  ON 19
 eO_0                -7.839991e-01 1 1  ON 20
 eO_1                -4.623314e-01 1 1  ON 21
 eO_2                -5.035171e-02 1 1  ON 22
 eO_3                 2.109431e-01 1 1  ON 23
 eO_4                 3.116683e-01 1 1  ON 24
 eO_5                 3.267629e-01 1 1  ON 25
 eO_6                 2.625848e-01 1 1  ON 26
 eO_7                 1.244874e-01 1 1  ON 27
 eO_8                 2.991524e-02 1 1  ON 28
 eO_9                 1.907788e-02 1 1  ON 29
eH1_0                -1.844666e-01 1 1  ON 30
eH1_1                -1.050123e-01 1 1  ON 31
eH1_2                -6.355517e-02 1 1  ON 32
eH1_3                -2.637151e-02 1 1  ON 33
eH1_4                 1.894519e-02 1 1  ON 34
eH1_5                 3.312163e-02 1 1  ON 35
eH1_6                 7.757990e-02 1 1  ON 36
eH1_7                 1.097468e-01 1 1  ON 37
eH1_8                 9.753129e-02 1 1  ON 38
eH1_9                 2.646936e-02 1 1  ON 39
eH2_0                -1.856684e-01 1 1  ON 40
eH2_1                -1.065185e-01 1 1  ON 41
eH2_2                -6.500339e-02 1 1  ON 42
eH2_3                -2.791096e-02 1 1  ON 43
eH2_4                 1.767064e-02 1 1  ON 44
eH2_5                 3.164242e-02 1 1  ON 45
eH2_6                 7.927520e-02 1 1  ON 46
eH2_7                 1.142069e-01 1 1  ON 47
eH2_8                 1.007142e-01 1 1  ON 48
eH2_9                 2.872899e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.2088
    reference variance = 0.191543
====================================================
  Execution time = 1.9411e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1714e-01
  Total weights = 2.0000e+06
  Execution time = 1.8068e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317169707474
                                         uncertainty =       0.003028257681

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317169707474
                                         uncertainty =       0.003028257681

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398209922
  error estimate for blocks of size 2^( 2) =       0.000407685095
  error estimate for blocks of size 2^( 3) =       0.000415973029
  error estimate for blocks of size 2^( 4) =       0.000422410076
  error estimate for blocks of size 2^( 5) =       0.000426189052
  error estimate for blocks of size 2^( 6) =       0.000427900718
  error estimate for blocks of size 2^( 7) =       0.000429335466

      target function =                  N/A
              le_mean =     -17.216607418064
             les_mean =     296.728713113742
             stat err =       0.000426458828
             autocorr =       1.146911912012
              std dev =       0.563153872913
             le_variance =       0.317142284577

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317169707474
                                         uncertainty =       0.003028257681

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317169707474
                                         uncertainty =       0.003028257681

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398209922
  error estimate for blocks of size 2^( 2) =       0.000407685095
  error estimate for blocks of size 2^( 3) =       0.000415973029
  error estimate for blocks of size 2^( 4) =       0.000422410076
  error estimate for blocks of size 2^( 5) =       0.000426189052
  error estimate for blocks of size 2^( 6) =       0.000427900718
  error estimate for blocks of size 2^( 7) =       0.000429335466

      target function =                  N/A
              le_mean =     -17.216607418064
             les_mean =     296.728713113742
             stat err =       0.000426458828
             autocorr =       1.146911912005
              std dev =       0.563153872913
             le_variance =       0.317142284577

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317169707474
                                         uncertainty =       0.003028257681

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317169707474
                                         uncertainty =       0.003028257681

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398209922
  error estimate for blocks of size 2^( 2) =       0.000407685095
  error estimate for blocks of size 2^( 3) =       0.000415973029
  error estimate for blocks of size 2^( 4) =       0.000422410076
  error estimate for blocks of size 2^( 5) =       0.000426189052
  error estimate for blocks of size 2^( 6) =       0.000427900718
  error estimate for blocks of size 2^( 7) =       0.000429335466

      target function =                  N/A
              le_mean =     -17.216607418064
             les_mean =     296.728713113742
             stat err =       0.000426458828
             autocorr =       1.146911912011
              std dev =       0.563153872913
             le_variance =       0.317142284577

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317169707474
                                         uncertainty =       0.003028257681

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317169707474
                                         uncertainty =       0.003028257681

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398209922
  error estimate for blocks of size 2^( 2) =       0.000407685095
  error estimate for blocks of size 2^( 3) =       0.000415973029
  error estimate for blocks of size 2^( 4) =       0.000422410076
  error estimate for blocks of size 2^( 5) =       0.000426189052
  error estimate for blocks of size 2^( 6) =       0.000427900718
  error estimate for blocks of size 2^( 7) =       0.000429335466

      target function =                  N/A
              le_mean =     -17.216607418064
             les_mean =     296.728713113742
             stat err =       0.000426458828
             autocorr =       1.146911912011
              std dev =       0.563153872913
             le_variance =       0.317142284577


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216607418064        initial  <--
     3.8147e+08     3.8147e+09             7.6276e-13       -17.216607418064
     1.5259e+09     1.5259e+10             1.9079e-13       -17.216607418064
     6.1035e+09     6.1035e+10             4.8313e-14       -17.216607418064

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.5401
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 2.139838e-01 1 1  ON 0
 uu_1                 5.161576e-02 1 1  ON 1
 uu_2                -4.322282e-02 1 1  ON 2
 uu_3                -9.894209e-02 1 1  ON 3
 uu_4                -1.336901e-01 1 1  ON 4
 uu_5                -1.420466e-01 1 1  ON 5
 uu_6                -1.192323e-01 1 1  ON 6
 uu_7                -4.820395e-02 1 1  ON 7
 uu_8                 9.350219e-02 1 1  ON 8
 uu_9                 1.266982e-01 1 1  ON 9
 ud_0                 3.555341e-01 1 1  ON 10
 ud_1                 9.663141e-02 1 1  ON 11
 ud_2                -1.382622e-02 1 1  ON 12
 ud_3                -7.541758e-02 1 1  ON 13
 ud_4                -1.235462e-01 1 1  ON 14
 ud_5                -1.555396e-01 1 1  ON 15
 ud_6                -1.570129e-01 1 1  ON 16
 ud_7                -1.128658e-01 1 1  ON 17
 ud_8                -4.903523e-03 1 1  ON 18
 ud_9                 9.265698e-02 1 1  ON 19
 eO_0                -7.839991e-01 1 1  ON 20
 eO_1                -4.623314e-01 1 1  ON 21
 eO_2                -5.035171e-02 1 1  ON 22
 eO_3                 2.109431e-01 1 1  ON 23
 eO_4                 3.116683e-01 1 1  ON 24
 eO_5                 3.267629e-01 1 1  ON 25
 eO_6                 2.625848e-01 1 1  ON 26
 eO_7                 1.244874e-01 1 1  ON 27
 eO_8                 2.991524e-02 1 1  ON 28
 eO_9                 1.907788e-02 1 1  ON 29
eH1_0                -1.844666e-01 1 1  ON 30
eH1_1                -1.050123e-01 1 1  ON 31
eH1_2                -6.355517e-02 1 1  ON 32
eH1_3                -2.637151e-02 1 1  ON 33
eH1_4                 1.894519e-02 1 1  ON 34
eH1_5                 3.312163e-02 1 1  ON 35
eH1_6                 7.757990e-02 1 1  ON 36
eH1_7                 1.097468e-01 1 1  ON 37
eH1_8                 9.753129e-02 1 1  ON 38
eH1_9                 2.646936e-02 1 1  ON 39
eH2_0                -1.856684e-01 1 1  ON 40
eH2_1                -1.065185e-01 1 1  ON 41
eH2_2                -6.500339e-02 1 1  ON 42
eH2_3                -2.791096e-02 1 1  ON 43
eH2_4                 1.767064e-02 1 1  ON 44
eH2_5                 3.164242e-02 1 1  ON 45
eH2_6                 7.927520e-02 1 1  ON 46
eH2_7                 1.142069e-01 1 1  ON 47
eH2_8                 1.007142e-01 1 1  ON 48
eH2_9                 2.872899e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4297e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.2432
    reference variance = 0.548455
====================================================
  Execution time = 2.1303e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1378e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4603e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313804213928
                                         uncertainty =       0.003424177040

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313804213928
                                         uncertainty =       0.003424177040

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396095277
  error estimate for blocks of size 2^( 2) =       0.000405514293
  error estimate for blocks of size 2^( 3) =       0.000414332510
  error estimate for blocks of size 2^( 4) =       0.000420560347
  error estimate for blocks of size 2^( 5) =       0.000424554952
  error estimate for blocks of size 2^( 6) =       0.000425938615
  error estimate for blocks of size 2^( 7) =       0.000427598309

      target function =                  N/A
              le_mean =     -17.215663969695
             les_mean =     296.692868696766
             stat err =       0.000424663056
             autocorr =       1.149448807453
              std dev =       0.560163312096
             le_variance =       0.313782936219


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721566396969e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+09, overlap shift 3.8147e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215663969695       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215663969695       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215663969695       residual = 4.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215664210590       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215663935757       residual = 9.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215663730371       residual = 2.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215662281802       residual = 9.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+09 is 8.543609e-14

solving harmonic davidson linear method for identity shift 1.5259e+10, overlap shift 1.5259e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215663969695       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215663969695       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215663969695       residual = 4.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215666168170       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215664036341       residual = 9.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215664789874       residual = 2.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215701415751       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215704433202       residual = 2.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215628172983       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215597078341       residual = 7.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.215823566351       residual = 4.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.215612469408       residual = 4.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.215811197934       residual = 3.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.215836893212       residual = 5.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.214171959793       residual = 3.36e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.214025693614       residual = 4.18e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.216147171451       residual = 3.81e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.214643307985       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.216207327847       residual = 4.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.213727225264       residual = 5.66e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.218048191085       residual = 8.65e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.216556780879       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.208075918580       residual = 8.82e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.211624133830       residual = 2.44e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.217559817447       residual = 5.32e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.210898776483       residual = 3.39e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.214627847072       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.212728800444       residual = 1.26e-03           smallest_sin_value = 9.99e-01
davidson iteration   28 stopping due to small subspace S singular value of 9.89e-01
davidson solver did not converge after         28 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+10 is 2.108783e-14

solving harmonic davidson linear method for identity shift 6.1035e+10, overlap shift 6.1035e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215663969695       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215663969695       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215663969695       residual = 4.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215663969695       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215646668020       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215676070867       residual = 6.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215657533555       residual = 4.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215075825589       residual = 5.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215343400949       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215949330331       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216307278069       residual = 6.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.217401057267       residual = 4.84e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.215937724155       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.217218439062       residual = 3.86e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.216974915783       residual = 2.80e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.216550258315       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.210870295151       residual = 3.53e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.218444755874       residual = 1.27e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.209188689899       residual = 6.85e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.216060693187       residual = 2.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.216974914647       residual = 2.41e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.223556473722       residual = 9.33e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.204584832721       residual = 1.85e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.208653710213       residual = 8.42e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.225176971980       residual = 1.30e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.218776436782       residual = 3.37e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.205887932029       residual = 1.57e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.201956013686       residual = 2.68e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -17.199934846861       residual = 4.33e-02           smallest_sin_value = 1.00e+00
davidson iteration   29 stopping due to small subspace S singular value of 9.89e-01
davidson solver did not converge after         29 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+10 is 5.313681e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.294095 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6790e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 2.139838e-01 1 1  ON 0
 uu_1                 5.161576e-02 1 1  ON 1
 uu_2                -4.322282e-02 1 1  ON 2
 uu_3                -9.894209e-02 1 1  ON 3
 uu_4                -1.336901e-01 1 1  ON 4
 uu_5                -1.420466e-01 1 1  ON 5
 uu_6                -1.192323e-01 1 1  ON 6
 uu_7                -4.820395e-02 1 1  ON 7
 uu_8                 9.350219e-02 1 1  ON 8
 uu_9                 1.266982e-01 1 1  ON 9
 ud_0                 3.555341e-01 1 1  ON 10
 ud_1                 9.663141e-02 1 1  ON 11
 ud_2                -1.382622e-02 1 1  ON 12
 ud_3                -7.541758e-02 1 1  ON 13
 ud_4                -1.235462e-01 1 1  ON 14
 ud_5                -1.555396e-01 1 1  ON 15
 ud_6                -1.570129e-01 1 1  ON 16
 ud_7                -1.128658e-01 1 1  ON 17
 ud_8                -4.903523e-03 1 1  ON 18
 ud_9                 9.265698e-02 1 1  ON 19
 eO_0                -7.839991e-01 1 1  ON 20
 eO_1                -4.623314e-01 1 1  ON 21
 eO_2                -5.035171e-02 1 1  ON 22
 eO_3                 2.109431e-01 1 1  ON 23
 eO_4                 3.116683e-01 1 1  ON 24
 eO_5                 3.267629e-01 1 1  ON 25
 eO_6                 2.625848e-01 1 1  ON 26
 eO_7                 1.244874e-01 1 1  ON 27
 eO_8                 2.991524e-02 1 1  ON 28
 eO_9                 1.907788e-02 1 1  ON 29
eH1_0                -1.844666e-01 1 1  ON 30
eH1_1                -1.050123e-01 1 1  ON 31
eH1_2                -6.355517e-02 1 1  ON 32
eH1_3                -2.637151e-02 1 1  ON 33
eH1_4                 1.894519e-02 1 1  ON 34
eH1_5                 3.312163e-02 1 1  ON 35
eH1_6                 7.757990e-02 1 1  ON 36
eH1_7                 1.097468e-01 1 1  ON 37
eH1_8                 9.753129e-02 1 1  ON 38
eH1_9                 2.646936e-02 1 1  ON 39
eH2_0                -1.856684e-01 1 1  ON 40
eH2_1                -1.065185e-01 1 1  ON 41
eH2_2                -6.500339e-02 1 1  ON 42
eH2_3                -2.791096e-02 1 1  ON 43
eH2_4                 1.767064e-02 1 1  ON 44
eH2_5                 3.164242e-02 1 1  ON 45
eH2_6                 7.927520e-02 1 1  ON 46
eH2_7                 1.142069e-01 1 1  ON 47
eH2_8                 1.007142e-01 1 1  ON 48
eH2_9                 2.872899e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.1889
    reference variance = 0.202833
====================================================
  Execution time = 2.0091e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1903e-01
  Total weights = 2.0000e+06
  Execution time = 1.8120e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319087732028
                                         uncertainty =       0.002853436386

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319087732028
                                         uncertainty =       0.002853436386

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399393458
  error estimate for blocks of size 2^( 2) =       0.000409007326
  error estimate for blocks of size 2^( 3) =       0.000417542812
  error estimate for blocks of size 2^( 4) =       0.000423928112
  error estimate for blocks of size 2^( 5) =       0.000429638800
  error estimate for blocks of size 2^( 6) =       0.000431506653
  error estimate for blocks of size 2^( 7) =       0.000432458697

      target function =                  N/A
              le_mean =     -17.217290205408
             les_mean =     296.754112125543
             stat err =       0.000429383065
             autocorr =       1.155813949096
              std dev =       0.564827644354
             le_variance =       0.319030267826

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319087732028
                                         uncertainty =       0.002853436386

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319087732028
                                         uncertainty =       0.002853436386

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399393458
  error estimate for blocks of size 2^( 2) =       0.000409007326
  error estimate for blocks of size 2^( 3) =       0.000417542812
  error estimate for blocks of size 2^( 4) =       0.000423928112
  error estimate for blocks of size 2^( 5) =       0.000429638800
  error estimate for blocks of size 2^( 6) =       0.000431506653
  error estimate for blocks of size 2^( 7) =       0.000432458697

      target function =                  N/A
              le_mean =     -17.217290205408
             les_mean =     296.754112125544
             stat err =       0.000429383065
             autocorr =       1.155813949096
              std dev =       0.564827644354
             le_variance =       0.319030267826

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319087732028
                                         uncertainty =       0.002853436386

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319087732028
                                         uncertainty =       0.002853436386

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399393458
  error estimate for blocks of size 2^( 2) =       0.000409007326
  error estimate for blocks of size 2^( 3) =       0.000417542812
  error estimate for blocks of size 2^( 4) =       0.000423928112
  error estimate for blocks of size 2^( 5) =       0.000429638800
  error estimate for blocks of size 2^( 6) =       0.000431506653
  error estimate for blocks of size 2^( 7) =       0.000432458697

      target function =                  N/A
              le_mean =     -17.217290205408
             les_mean =     296.754112125543
             stat err =       0.000429383065
             autocorr =       1.155813949097
              std dev =       0.564827644354
             le_variance =       0.319030267826

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319087732028
                                         uncertainty =       0.002853436386

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319087732028
                                         uncertainty =       0.002853436386

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399393458
  error estimate for blocks of size 2^( 2) =       0.000409007326
  error estimate for blocks of size 2^( 3) =       0.000417542812
  error estimate for blocks of size 2^( 4) =       0.000423928112
  error estimate for blocks of size 2^( 5) =       0.000429638800
  error estimate for blocks of size 2^( 6) =       0.000431506653
  error estimate for blocks of size 2^( 7) =       0.000432458697

      target function =                  N/A
              le_mean =     -17.217290205408
             les_mean =     296.754112125543
             stat err =       0.000429383065
             autocorr =       1.155813949095
              std dev =       0.564827644354
             le_variance =       0.319030267826


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217290205408        initial  <--
     3.8147e+09     3.8147e+10             8.5436e-14       -17.217290205408
     1.5259e+10     1.5259e+11             2.1088e-14       -17.217290205408
     6.1035e+10     6.1035e+11             5.3137e-15       -17.217290205408

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.2154
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 2.139838e-01 1 1  ON 0
 uu_1                 5.161576e-02 1 1  ON 1
 uu_2                -4.322282e-02 1 1  ON 2
 uu_3                -9.894209e-02 1 1  ON 3
 uu_4                -1.336901e-01 1 1  ON 4
 uu_5                -1.420466e-01 1 1  ON 5
 uu_6                -1.192323e-01 1 1  ON 6
 uu_7                -4.820395e-02 1 1  ON 7
 uu_8                 9.350219e-02 1 1  ON 8
 uu_9                 1.266982e-01 1 1  ON 9
 ud_0                 3.555341e-01 1 1  ON 10
 ud_1                 9.663141e-02 1 1  ON 11
 ud_2                -1.382622e-02 1 1  ON 12
 ud_3                -7.541758e-02 1 1  ON 13
 ud_4                -1.235462e-01 1 1  ON 14
 ud_5                -1.555396e-01 1 1  ON 15
 ud_6                -1.570129e-01 1 1  ON 16
 ud_7                -1.128658e-01 1 1  ON 17
 ud_8                -4.903523e-03 1 1  ON 18
 ud_9                 9.265698e-02 1 1  ON 19
 eO_0                -7.839991e-01 1 1  ON 20
 eO_1                -4.623314e-01 1 1  ON 21
 eO_2                -5.035171e-02 1 1  ON 22
 eO_3                 2.109431e-01 1 1  ON 23
 eO_4                 3.116683e-01 1 1  ON 24
 eO_5                 3.267629e-01 1 1  ON 25
 eO_6                 2.625848e-01 1 1  ON 26
 eO_7                 1.244874e-01 1 1  ON 27
 eO_8                 2.991524e-02 1 1  ON 28
 eO_9                 1.907788e-02 1 1  ON 29
eH1_0                -1.844666e-01 1 1  ON 30
eH1_1                -1.050123e-01 1 1  ON 31
eH1_2                -6.355517e-02 1 1  ON 32
eH1_3                -2.637151e-02 1 1  ON 33
eH1_4                 1.894519e-02 1 1  ON 34
eH1_5                 3.312163e-02 1 1  ON 35
eH1_6                 7.757990e-02 1 1  ON 36
eH1_7                 1.097468e-01 1 1  ON 37
eH1_8                 9.753129e-02 1 1  ON 38
eH1_9                 2.646936e-02 1 1  ON 39
eH2_0                -1.856684e-01 1 1  ON 40
eH2_1                -1.065185e-01 1 1  ON 41
eH2_2                -6.500339e-02 1 1  ON 42
eH2_3                -2.791096e-02 1 1  ON 43
eH2_4                 1.767064e-02 1 1  ON 44
eH2_5                 3.164242e-02 1 1  ON 45
eH2_6                 7.927520e-02 1 1  ON 46
eH2_7                 1.142069e-01 1 1  ON 47
eH2_8                 1.007142e-01 1 1  ON 48
eH2_9                 2.872899e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6013e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.1991
    reference variance = 0.278911
====================================================
  Execution time = 2.0003e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1904e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5328e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319090515373
                                         uncertainty =       0.002825915972

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319090515373
                                         uncertainty =       0.002825915972

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399402273
  error estimate for blocks of size 2^( 2) =       0.000409199318
  error estimate for blocks of size 2^( 3) =       0.000417747711
  error estimate for blocks of size 2^( 4) =       0.000424845014
  error estimate for blocks of size 2^( 5) =       0.000427869523
  error estimate for blocks of size 2^( 6) =       0.000430350449
  error estimate for blocks of size 2^( 7) =       0.000430633842

      target function =                  N/A
              le_mean =     -17.216744826755
             les_mean =     296.735346621066
             stat err =       0.000428424707
             autocorr =       1.150609494824
              std dev =       0.564840111002
             le_variance =       0.319044350997


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721674482675e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+10, overlap shift 3.8147e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216744826755       residual = 3.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216744826755       residual = 3.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216744826755       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216750058293       residual = 3.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216738052015       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216733059896       residual = 5.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216745563094       residual = 2.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216756214943       residual = 2.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216695652846       residual = 3.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216587298291       residual = 4.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216289616085       residual = 3.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216272230628       residual = 3.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.217321907731       residual = 5.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216286638967       residual = 3.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.218485262010       residual = 4.68e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.214838793219       residual = 5.58e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.215574740671       residual = 2.20e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.218616652664       residual = 5.89e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.218288441169       residual = 3.71e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.214313260814       residual = 9.43e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.231477672554       residual = 3.38e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.201901347103       residual = 3.39e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.222330022946       residual = 4.84e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.222865623746       residual = 6.12e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.222687694359       residual = 5.39e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.241285975928       residual = 9.73e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.228522242338       residual = 2.10e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.202172959088       residual = 3.25e-02           smallest_sin_value = 9.99e-01
davidson iteration   28 stopping due to small subspace S singular value of 9.85e-01
davidson solver did not converge after         28 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+10 is 6.014381e-15

solving harmonic davidson linear method for identity shift 1.5259e+11, overlap shift 1.5259e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216744826755       residual = 3.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216744826755       residual = 3.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216744826755       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216767151185       residual = 3.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216744901575       residual = 3.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216754746536       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216776071231       residual = 3.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.218218656657       residual = 3.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216376308482       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216888974153       residual = 9.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.219977032669       residual = 1.67e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.223642936717       residual = 7.53e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.220760163272       residual = 2.57e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.212280176055       residual = 3.18e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.225541325082       residual = 1.15e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.206979267435       residual = 1.45e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.224086388368       residual = 8.39e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.219580310611       residual = 1.20e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.213414352947       residual = 1.87e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.235149432286       residual = 5.32e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.231270954821       residual = 3.20e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.221692223405       residual = 4.06e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.221039210700       residual = 3.05e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.190548345054       residual = 1.05e-01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.167307454689       residual = 3.99e-01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.223239273955       residual = 1.04e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.212914621925       residual = 2.78e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.206712446218       residual = 2.18e-02           smallest_sin_value = 9.99e-01
davidson iteration   28:   krylov dim =  29   energy =     -17.238924921511       residual = 8.11e-02           smallest_sin_value = 9.93e-01
davidson iteration   29 stopping due to small subspace S singular value of 9.41e-01
davidson solver did not converge after         29 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+11 is 1.253309e-15

solving harmonic davidson linear method for identity shift 6.1035e+11, overlap shift 6.1035e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216744826755       residual = 3.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216744826755       residual = 3.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.20e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+11 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.315730 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5562e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 2.139838e-01 1 1  ON 0
 uu_1                 5.161576e-02 1 1  ON 1
 uu_2                -4.322282e-02 1 1  ON 2
 uu_3                -9.894209e-02 1 1  ON 3
 uu_4                -1.336901e-01 1 1  ON 4
 uu_5                -1.420466e-01 1 1  ON 5
 uu_6                -1.192323e-01 1 1  ON 6
 uu_7                -4.820395e-02 1 1  ON 7
 uu_8                 9.350219e-02 1 1  ON 8
 uu_9                 1.266982e-01 1 1  ON 9
 ud_0                 3.555341e-01 1 1  ON 10
 ud_1                 9.663141e-02 1 1  ON 11
 ud_2                -1.382622e-02 1 1  ON 12
 ud_3                -7.541758e-02 1 1  ON 13
 ud_4                -1.235462e-01 1 1  ON 14
 ud_5                -1.555396e-01 1 1  ON 15
 ud_6                -1.570129e-01 1 1  ON 16
 ud_7                -1.128658e-01 1 1  ON 17
 ud_8                -4.903523e-03 1 1  ON 18
 ud_9                 9.265698e-02 1 1  ON 19
 eO_0                -7.839991e-01 1 1  ON 20
 eO_1                -4.623314e-01 1 1  ON 21
 eO_2                -5.035171e-02 1 1  ON 22
 eO_3                 2.109431e-01 1 1  ON 23
 eO_4                 3.116683e-01 1 1  ON 24
 eO_5                 3.267629e-01 1 1  ON 25
 eO_6                 2.625848e-01 1 1  ON 26
 eO_7                 1.244874e-01 1 1  ON 27
 eO_8                 2.991524e-02 1 1  ON 28
 eO_9                 1.907788e-02 1 1  ON 29
eH1_0                -1.844666e-01 1 1  ON 30
eH1_1                -1.050123e-01 1 1  ON 31
eH1_2                -6.355517e-02 1 1  ON 32
eH1_3                -2.637151e-02 1 1  ON 33
eH1_4                 1.894519e-02 1 1  ON 34
eH1_5                 3.312163e-02 1 1  ON 35
eH1_6                 7.757990e-02 1 1  ON 36
eH1_7                 1.097468e-01 1 1  ON 37
eH1_8                 9.753129e-02 1 1  ON 38
eH1_9                 2.646936e-02 1 1  ON 39
eH2_0                -1.856684e-01 1 1  ON 40
eH2_1                -1.065185e-01 1 1  ON 41
eH2_2                -6.500339e-02 1 1  ON 42
eH2_3                -2.791096e-02 1 1  ON 43
eH2_4                 1.767064e-02 1 1  ON 44
eH2_5                 3.164242e-02 1 1  ON 45
eH2_6                 7.927520e-02 1 1  ON 46
eH2_7                 1.142069e-01 1 1  ON 47
eH2_8                 1.007142e-01 1 1  ON 48
eH2_9                 2.872899e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.2774
    reference variance = 0.144379
====================================================
  Execution time = 1.9535e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.3080e-01
  Total weights = 2.0000e+06
  Execution time = 1.8017e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330662073979
                                         uncertainty =       0.007072841730

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330662073979
                                         uncertainty =       0.007072841730

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406693849
  error estimate for blocks of size 2^( 2) =       0.000416350632
  error estimate for blocks of size 2^( 3) =       0.000425197782
  error estimate for blocks of size 2^( 4) =       0.000432560294
  error estimate for blocks of size 2^( 5) =       0.000435913254
  error estimate for blocks of size 2^( 6) =       0.000437451542
  error estimate for blocks of size 2^( 7) =       0.000439445932

      target function =                  N/A
              le_mean =     -17.217653689893
             les_mean =     296.778398193850
             stat err =       0.000436342756
             autocorr =       1.151119288145
              std dev =       0.575151957463
             le_variance =       0.330799774173

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330662073979
                                         uncertainty =       0.007072841730

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330662073979
                                         uncertainty =       0.007072841730

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406693849
  error estimate for blocks of size 2^( 2) =       0.000416350632
  error estimate for blocks of size 2^( 3) =       0.000425197782
  error estimate for blocks of size 2^( 4) =       0.000432560294
  error estimate for blocks of size 2^( 5) =       0.000435913254
  error estimate for blocks of size 2^( 6) =       0.000437451542
  error estimate for blocks of size 2^( 7) =       0.000439445932

      target function =                  N/A
              le_mean =     -17.217653689893
             les_mean =     296.778398193850
             stat err =       0.000436342756
             autocorr =       1.151119288145
              std dev =       0.575151957463
             le_variance =       0.330799774173

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330662073979
                                         uncertainty =       0.007072841730

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330662073979
                                         uncertainty =       0.007072841730

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406693849
  error estimate for blocks of size 2^( 2) =       0.000416350632
  error estimate for blocks of size 2^( 3) =       0.000425197782
  error estimate for blocks of size 2^( 4) =       0.000432560294
  error estimate for blocks of size 2^( 5) =       0.000435913254
  error estimate for blocks of size 2^( 6) =       0.000437451542
  error estimate for blocks of size 2^( 7) =       0.000439445932

      target function =                  N/A
              le_mean =     -17.217653689893
             les_mean =     296.778398193850
             stat err =       0.000436342756
             autocorr =       1.151119288145
              std dev =       0.575151957463
             le_variance =       0.330799774173

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330662073979
                                         uncertainty =       0.007072841730

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330662073979
                                         uncertainty =       0.007072841730

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406693849
  error estimate for blocks of size 2^( 2) =       0.000416350632
  error estimate for blocks of size 2^( 3) =       0.000425197782
  error estimate for blocks of size 2^( 4) =       0.000432560294
  error estimate for blocks of size 2^( 5) =       0.000435913254
  error estimate for blocks of size 2^( 6) =       0.000437451542
  error estimate for blocks of size 2^( 7) =       0.000439445932

      target function =                  N/A
              le_mean =     -17.217653689893
             les_mean =     296.778398193850
             stat err =       0.000436342756
             autocorr =       1.151119288145
              std dev =       0.575151957463
             le_variance =       0.330799774173


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217653689893        initial  <--
     3.8147e+10     3.8147e+11             6.0144e-15       -17.217653689893
     1.5259e+11     1.5259e+12             1.2533e-15       -17.217653689893
     6.1035e+11     6.1035e+12             0.0000e+00       -17.217653689893

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.6284
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 2.139838e-01 1 1  ON 0
 uu_1                 5.161576e-02 1 1  ON 1
 uu_2                -4.322282e-02 1 1  ON 2
 uu_3                -9.894209e-02 1 1  ON 3
 uu_4                -1.336901e-01 1 1  ON 4
 uu_5                -1.420466e-01 1 1  ON 5
 uu_6                -1.192323e-01 1 1  ON 6
 uu_7                -4.820395e-02 1 1  ON 7
 uu_8                 9.350219e-02 1 1  ON 8
 uu_9                 1.266982e-01 1 1  ON 9
 ud_0                 3.555341e-01 1 1  ON 10
 ud_1                 9.663141e-02 1 1  ON 11
 ud_2                -1.382622e-02 1 1  ON 12
 ud_3                -7.541758e-02 1 1  ON 13
 ud_4                -1.235462e-01 1 1  ON 14
 ud_5                -1.555396e-01 1 1  ON 15
 ud_6                -1.570129e-01 1 1  ON 16
 ud_7                -1.128658e-01 1 1  ON 17
 ud_8                -4.903523e-03 1 1  ON 18
 ud_9                 9.265698e-02 1 1  ON 19
 eO_0                -7.839991e-01 1 1  ON 20
 eO_1                -4.623314e-01 1 1  ON 21
 eO_2                -5.035171e-02 1 1  ON 22
 eO_3                 2.109431e-01 1 1  ON 23
 eO_4                 3.116683e-01 1 1  ON 24
 eO_5                 3.267629e-01 1 1  ON 25
 eO_6                 2.625848e-01 1 1  ON 26
 eO_7                 1.244874e-01 1 1  ON 27
 eO_8                 2.991524e-02 1 1  ON 28
 eO_9                 1.907788e-02 1 1  ON 29
eH1_0                -1.844666e-01 1 1  ON 30
eH1_1                -1.050123e-01 1 1  ON 31
eH1_2                -6.355517e-02 1 1  ON 32
eH1_3                -2.637151e-02 1 1  ON 33
eH1_4                 1.894519e-02 1 1  ON 34
eH1_5                 3.312163e-02 1 1  ON 35
eH1_6                 7.757990e-02 1 1  ON 36
eH1_7                 1.097468e-01 1 1  ON 37
eH1_8                 9.753129e-02 1 1  ON 38
eH1_9                 2.646936e-02 1 1  ON 39
eH2_0                -1.856684e-01 1 1  ON 40
eH2_1                -1.065185e-01 1 1  ON 41
eH2_2                -6.500339e-02 1 1  ON 42
eH2_3                -2.791096e-02 1 1  ON 43
eH2_4                 1.767064e-02 1 1  ON 44
eH2_5                 3.164242e-02 1 1  ON 45
eH2_6                 7.927520e-02 1 1  ON 46
eH2_7                 1.142069e-01 1 1  ON 47
eH2_8                 1.007142e-01 1 1  ON 48
eH2_9                 2.872899e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4196e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7215e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.2212
    reference variance = 0.177936
====================================================
  Execution time = 2.0260e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1153e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5646e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311489748610
                                         uncertainty =       0.003216855266

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311489748610
                                         uncertainty =       0.003216855266

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394669158
  error estimate for blocks of size 2^( 2) =       0.000404494689
  error estimate for blocks of size 2^( 3) =       0.000413376158
  error estimate for blocks of size 2^( 4) =       0.000419601652
  error estimate for blocks of size 2^( 5) =       0.000424370468
  error estimate for blocks of size 2^( 6) =       0.000427873895
  error estimate for blocks of size 2^( 7) =       0.000430369630

      target function =                  N/A
              le_mean =     -17.216800271583
             les_mean =     296.729738924463
             stat err =       0.000425553911
             autocorr =       1.162633398246
              std dev =       0.558146475976
             le_variance =       0.311527488644


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721680027158e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+11, overlap shift 3.8147e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216800271583       residual = 4.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216800271583       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216800271583       residual = 3.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216800271583       residual = 4.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216772594054       residual = 5.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216587240349       residual = 7.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215151408185       residual = 4.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215828579679       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216737531585       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.214271875724       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.217171503554       residual = 5.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.222436086462       residual = 4.22e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.226996195771       residual = 1.57e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.217694924660       residual = 3.12e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.201398531110       residual = 3.72e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.188883305201       residual = 1.23e-01           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.197170307990       residual = 6.17e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.242439102201       residual = 1.00e-01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.245216678429       residual = 1.23e-01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.185433006132       residual = 1.60e-01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.205843476123       residual = 1.82e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.243367856147       residual = 1.15e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.092152323670       residual = 2.47e+00           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.217363383268       residual = 1.19e-01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.178235676823       residual = 2.22e-01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.208151547533       residual = 3.61e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.237927590499       residual = 9.29e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.286087148422       residual = 9.76e-01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -17.218362894680       residual = 4.75e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -17.158518912871       residual = 6.25e-01           smallest_sin_value = 9.99e-01
davidson iteration   30:   krylov dim =  31   energy =     -16.984697390191       residual = 8.24e+00           smallest_sin_value = 9.97e-01
davidson iteration   31 stopping due to small subspace S singular value of 9.12e-01
davidson solver did not converge after         31 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+11 is 2.911034e-16

solving harmonic davidson linear method for identity shift 1.5259e+12, overlap shift 1.5259e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216800271583       residual = 4.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216800271583       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216800271583       residual = 4.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to small subspace S singular value of 6.18e-01
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+12 is 2.176999e-17

solving harmonic davidson linear method for identity shift 6.1035e+12, overlap shift 6.1035e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216800271583       residual = 4.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216800271583       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216800271583       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216515985226       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.221133205380       residual = 7.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.230283187951       residual = 2.76e-02           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.258608762101       residual = 2.81e-01           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.212151503926       residual = 8.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215009480741       residual = 5.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.285812097758       residual = 7.51e-01           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.196786208385       residual = 6.97e-02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.164452978979       residual = 4.27e-01           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.798765500423       residual = 2.84e+01           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.535722322070       residual = 1.59e+01           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.418093496181       residual = 7.02e+00           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.085534965533       residual = 2.71e+00           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.224354918390       residual = 4.52e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.812738353870       residual = 2.68e+01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.368644632447       residual = 4.18e+00           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.167467207588       residual = 5.56e-01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.453191656683       residual = 9.08e+01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.705968298942       residual = 3.82e+01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.346147751996       residual = 1.14e+02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.366475229142       residual = 1.16e+02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -15.363036320334       residual = 5.31e+02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.618727143319       residual = 2.97e+01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -15.323707135187       residual = 5.52e+02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.057763638997       residual = 4.75e+00           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -18.992788075880       residual = 5.22e+02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.809570404787       residual = 2.04e+01           smallest_sin_value = 9.99e-01
davidson iteration   30:   krylov dim =  31   energy =     -17.477047958695       residual = 9.99e+00           smallest_sin_value = 9.92e-01
davidson iteration   31 stopping due to small subspace S singular value of 8.88e-01
davidson solver did not converge after         31 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+12 is 1.181892e-17

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.342764 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5855e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 2.139838e-01 1 1  ON 0
 uu_1                 5.161576e-02 1 1  ON 1
 uu_2                -4.322282e-02 1 1  ON 2
 uu_3                -9.894209e-02 1 1  ON 3
 uu_4                -1.336901e-01 1 1  ON 4
 uu_5                -1.420466e-01 1 1  ON 5
 uu_6                -1.192323e-01 1 1  ON 6
 uu_7                -4.820395e-02 1 1  ON 7
 uu_8                 9.350219e-02 1 1  ON 8
 uu_9                 1.266982e-01 1 1  ON 9
 ud_0                 3.555341e-01 1 1  ON 10
 ud_1                 9.663141e-02 1 1  ON 11
 ud_2                -1.382622e-02 1 1  ON 12
 ud_3                -7.541758e-02 1 1  ON 13
 ud_4                -1.235462e-01 1 1  ON 14
 ud_5                -1.555396e-01 1 1  ON 15
 ud_6                -1.570129e-01 1 1  ON 16
 ud_7                -1.128658e-01 1 1  ON 17
 ud_8                -4.903523e-03 1 1  ON 18
 ud_9                 9.265698e-02 1 1  ON 19
 eO_0                -7.839991e-01 1 1  ON 20
 eO_1                -4.623314e-01 1 1  ON 21
 eO_2                -5.035171e-02 1 1  ON 22
 eO_3                 2.109431e-01 1 1  ON 23
 eO_4                 3.116683e-01 1 1  ON 24
 eO_5                 3.267629e-01 1 1  ON 25
 eO_6                 2.625848e-01 1 1  ON 26
 eO_7                 1.244874e-01 1 1  ON 27
 eO_8                 2.991524e-02 1 1  ON 28
 eO_9                 1.907788e-02 1 1  ON 29
eH1_0                -1.844666e-01 1 1  ON 30
eH1_1                -1.050123e-01 1 1  ON 31
eH1_2                -6.355517e-02 1 1  ON 32
eH1_3                -2.637151e-02 1 1  ON 33
eH1_4                 1.894519e-02 1 1  ON 34
eH1_5                 3.312163e-02 1 1  ON 35
eH1_6                 7.757990e-02 1 1  ON 36
eH1_7                 1.097468e-01 1 1  ON 37
eH1_8                 9.753129e-02 1 1  ON 38
eH1_9                 2.646936e-02 1 1  ON 39
eH2_0                -1.856684e-01 1 1  ON 40
eH2_1                -1.065185e-01 1 1  ON 41
eH2_2                -6.500339e-02 1 1  ON 42
eH2_3                -2.791096e-02 1 1  ON 43
eH2_4                 1.767064e-02 1 1  ON 44
eH2_5                 3.164242e-02 1 1  ON 45
eH2_6                 7.927520e-02 1 1  ON 46
eH2_7                 1.142069e-01 1 1  ON 47
eH2_8                 1.007142e-01 1 1  ON 48
eH2_9                 2.872899e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.2609
    reference variance = 0.325768
====================================================
  Execution time = 2.0146e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2431e-01
  Total weights = 2.0000e+06
  Execution time = 2.2587e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324229052586
                                         uncertainty =       0.008620669108

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324229052586
                                         uncertainty =       0.008620669108

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402682222
  error estimate for blocks of size 2^( 2) =       0.000412410107
  error estimate for blocks of size 2^( 3) =       0.000420486516
  error estimate for blocks of size 2^( 4) =       0.000427039189
  error estimate for blocks of size 2^( 5) =       0.000430888107
  error estimate for blocks of size 2^( 6) =       0.000433934280
  error estimate for blocks of size 2^( 7) =       0.000435879362

      target function =                  N/A
              le_mean =     -17.216396757557
             les_mean =     296.728623094847
             stat err =       0.000431935235
             autocorr =       1.150568164094
              std dev =       0.569478659270
             le_variance =       0.324305943364

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324229052586
                                         uncertainty =       0.008620669108

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324229052586
                                         uncertainty =       0.008620669108

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402682222
  error estimate for blocks of size 2^( 2) =       0.000412410107
  error estimate for blocks of size 2^( 3) =       0.000420486516
  error estimate for blocks of size 2^( 4) =       0.000427039189
  error estimate for blocks of size 2^( 5) =       0.000430888107
  error estimate for blocks of size 2^( 6) =       0.000433934280
  error estimate for blocks of size 2^( 7) =       0.000435879362

      target function =                  N/A
              le_mean =     -17.216396757557
             les_mean =     296.728623094847
             stat err =       0.000431935235
             autocorr =       1.150568164093
              std dev =       0.569478659270
             le_variance =       0.324305943364

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324229052586
                                         uncertainty =       0.008620669108

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324229052586
                                         uncertainty =       0.008620669108

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402682222
  error estimate for blocks of size 2^( 2) =       0.000412410107
  error estimate for blocks of size 2^( 3) =       0.000420486516
  error estimate for blocks of size 2^( 4) =       0.000427039189
  error estimate for blocks of size 2^( 5) =       0.000430888107
  error estimate for blocks of size 2^( 6) =       0.000433934280
  error estimate for blocks of size 2^( 7) =       0.000435879362

      target function =                  N/A
              le_mean =     -17.216396757557
             les_mean =     296.728623094847
             stat err =       0.000431935235
             autocorr =       1.150568164092
              std dev =       0.569478659270
             le_variance =       0.324305943364

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324229052586
                                         uncertainty =       0.008620669108

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324229052586
                                         uncertainty =       0.008620669108

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402682222
  error estimate for blocks of size 2^( 2) =       0.000412410107
  error estimate for blocks of size 2^( 3) =       0.000420486516
  error estimate for blocks of size 2^( 4) =       0.000427039189
  error estimate for blocks of size 2^( 5) =       0.000430888107
  error estimate for blocks of size 2^( 6) =       0.000433934280
  error estimate for blocks of size 2^( 7) =       0.000435879362

      target function =                  N/A
              le_mean =     -17.216396757557
             les_mean =     296.728623094847
             stat err =       0.000431935235
             autocorr =       1.150568164088
              std dev =       0.569478659270
             le_variance =       0.324305943364


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216396757557        initial
     3.8147e+11     3.8147e+12             2.9110e-16       -17.216396757557  <--
     1.5259e+12     1.5259e+13             2.1770e-17       -17.216396757557
     6.1035e+12     6.1035e+13             1.1819e-17       -17.216396757557

*****************************************************************************
Applying the update for shift_i =   3.8147e+11     and shift_s =   3.8147e+12
*****************************************************************************

  Execution time = 3.0042e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 2.139838e-01 1 1  ON 0
 uu_1                 5.161576e-02 1 1  ON 1
 uu_2                -4.322282e-02 1 1  ON 2
 uu_3                -9.894209e-02 1 1  ON 3
 uu_4                -1.336901e-01 1 1  ON 4
 uu_5                -1.420466e-01 1 1  ON 5
 uu_6                -1.192323e-01 1 1  ON 6
 uu_7                -4.820395e-02 1 1  ON 7
 uu_8                 9.350219e-02 1 1  ON 8
 uu_9                 1.266982e-01 1 1  ON 9
 ud_0                 3.555341e-01 1 1  ON 10
 ud_1                 9.663141e-02 1 1  ON 11
 ud_2                -1.382622e-02 1 1  ON 12
 ud_3                -7.541758e-02 1 1  ON 13
 ud_4                -1.235462e-01 1 1  ON 14
 ud_5                -1.555396e-01 1 1  ON 15
 ud_6                -1.570129e-01 1 1  ON 16
 ud_7                -1.128658e-01 1 1  ON 17
 ud_8                -4.903523e-03 1 1  ON 18
 ud_9                 9.265698e-02 1 1  ON 19
 eO_0                -7.839991e-01 1 1  ON 20
 eO_1                -4.623314e-01 1 1  ON 21
 eO_2                -5.035171e-02 1 1  ON 22
 eO_3                 2.109431e-01 1 1  ON 23
 eO_4                 3.116683e-01 1 1  ON 24
 eO_5                 3.267629e-01 1 1  ON 25
 eO_6                 2.625848e-01 1 1  ON 26
 eO_7                 1.244874e-01 1 1  ON 27
 eO_8                 2.991524e-02 1 1  ON 28
 eO_9                 1.907788e-02 1 1  ON 29
eH1_0                -1.844666e-01 1 1  ON 30
eH1_1                -1.050123e-01 1 1  ON 31
eH1_2                -6.355517e-02 1 1  ON 32
eH1_3                -2.637151e-02 1 1  ON 33
eH1_4                 1.894519e-02 1 1  ON 34
eH1_5                 3.312163e-02 1 1  ON 35
eH1_6                 7.757990e-02 1 1  ON 36
eH1_7                 1.097468e-01 1 1  ON 37
eH1_8                 9.753129e-02 1 1  ON 38
eH1_9                 2.646936e-02 1 1  ON 39
eH2_0                -1.856684e-01 1 1  ON 40
eH2_1                -1.065185e-01 1 1  ON 41
eH2_2                -6.500339e-02 1 1  ON 42
eH2_3                -2.791096e-02 1 1  ON 43
eH2_4                 1.767064e-02 1 1  ON 44
eH2_5                 3.164242e-02 1 1  ON 45
eH2_6                 7.927520e-02 1 1  ON 46
eH2_7                 1.142069e-01 1 1  ON 47
eH2_8                 1.007142e-01 1 1  ON 48
eH2_9                 2.872899e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5905e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7215e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.2467
    reference variance = 0.211949
====================================================
  Execution time = 2.0467e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.3350e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0450e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333629821302
                                         uncertainty =       0.009070548995

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333629821302
                                         uncertainty =       0.009070548995

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408349723
  error estimate for blocks of size 2^( 2) =       0.000418263662
  error estimate for blocks of size 2^( 3) =       0.000426561242
  error estimate for blocks of size 2^( 4) =       0.000432617428
  error estimate for blocks of size 2^( 5) =       0.000436377845
  error estimate for blocks of size 2^( 6) =       0.000437288164
  error estimate for blocks of size 2^( 7) =       0.000438956507

      target function =                  N/A
              le_mean =     -17.216457771909
             les_mean =     296.739917037116
             stat err =       0.000436309986
             autocorr =       1.141631059077
              std dev =       0.577493715934
             le_variance =       0.333498991943


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721645777191e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+10, overlap shift 9.5367e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216457771909       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216457771909       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216457771909       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216457771909       residual = 4.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216451833441       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216368376687       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216477897696       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216424630228       residual = 5.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216309340561       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216615327340       residual = 3.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216514903407       residual = 8.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.215368394692       residual = 1.86e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.214890306674       residual = 4.08e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216171052366       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.214735133511       residual = 4.64e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.217158527955       residual = 8.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.214659255787       residual = 5.02e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.205994210552       residual = 1.77e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.223633211881       residual = 8.00e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.196814451398       residual = 6.10e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.197900125972       residual = 5.45e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.221048578355       residual = 3.77e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.207068244738       residual = 1.38e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.211774155842       residual = 3.31e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.223271243273       residual = 7.30e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.228833908898       residual = 2.46e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.188138267349       residual = 1.24e-01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.269144290654       residual = 4.42e-01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -17.180401486111       residual = 2.04e-01           smallest_sin_value = 9.99e-01
davidson iteration   29:   krylov dim =  30   energy =     -17.192862757397       residual = 9.25e-02           smallest_sin_value = 9.96e-01
davidson iteration   30 stopping due to small subspace S singular value of 9.76e-01
davidson solver did not converge after         30 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+10 is 2.119915e-15

solving harmonic davidson linear method for identity shift 3.8147e+11, overlap shift 3.8147e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216457771909       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216457771909       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216457771909       residual = 9.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216457771909       residual = 3.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216457771909       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216469464031       residual = 3.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.218873301448       residual = 8.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215877771790       residual = 7.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216214629720       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.213251303718       residual = 1.59e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.215130579241       residual = 2.58e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.214485856875       residual = 5.33e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.221570688760       residual = 3.99e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.223962337957       residual = 8.93e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.201152909884       residual = 3.57e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.194659266650       residual = 7.26e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.199446903747       residual = 4.77e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.214821780871       residual = 5.64e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.213902109117       residual = 2.09e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.250105473346       residual = 1.76e-01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.217449522174       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.119897242776       residual = 1.44e+00           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.222139334662       residual = 4.64e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.185151110039       residual = 1.55e-01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.105623887221       residual = 1.85e+00           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.174931278418       residual = 2.72e-01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.275404846807       residual = 5.17e-01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.206130316618       residual = 1.36e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -17.298858721127       residual = 1.24e+00           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -17.110091495819       residual = 1.64e+00           smallest_sin_value = 9.99e-01
davidson iteration   30:   krylov dim =  31   energy =     -17.059131721186       residual = 3.78e+00           smallest_sin_value = 9.99e-01
davidson iteration   31 stopping due to small subspace S singular value of 9.89e-01
davidson solver did not converge after         31 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+11 is 4.522220e-16

solving harmonic davidson linear method for identity shift 1.5259e+12, overlap shift 1.5259e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216457771909       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216457771909       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.21e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+12 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.368318 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6542e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 2.139838e-01 1 1  ON 0
 uu_1                 5.161576e-02 1 1  ON 1
 uu_2                -4.322282e-02 1 1  ON 2
 uu_3                -9.894209e-02 1 1  ON 3
 uu_4                -1.336901e-01 1 1  ON 4
 uu_5                -1.420466e-01 1 1  ON 5
 uu_6                -1.192323e-01 1 1  ON 6
 uu_7                -4.820395e-02 1 1  ON 7
 uu_8                 9.350219e-02 1 1  ON 8
 uu_9                 1.266982e-01 1 1  ON 9
 ud_0                 3.555341e-01 1 1  ON 10
 ud_1                 9.663141e-02 1 1  ON 11
 ud_2                -1.382622e-02 1 1  ON 12
 ud_3                -7.541758e-02 1 1  ON 13
 ud_4                -1.235462e-01 1 1  ON 14
 ud_5                -1.555396e-01 1 1  ON 15
 ud_6                -1.570129e-01 1 1  ON 16
 ud_7                -1.128658e-01 1 1  ON 17
 ud_8                -4.903523e-03 1 1  ON 18
 ud_9                 9.265698e-02 1 1  ON 19
 eO_0                -7.839991e-01 1 1  ON 20
 eO_1                -4.623314e-01 1 1  ON 21
 eO_2                -5.035171e-02 1 1  ON 22
 eO_3                 2.109431e-01 1 1  ON 23
 eO_4                 3.116683e-01 1 1  ON 24
 eO_5                 3.267629e-01 1 1  ON 25
 eO_6                 2.625848e-01 1 1  ON 26
 eO_7                 1.244874e-01 1 1  ON 27
 eO_8                 2.991524e-02 1 1  ON 28
 eO_9                 1.907788e-02 1 1  ON 29
eH1_0                -1.844666e-01 1 1  ON 30
eH1_1                -1.050123e-01 1 1  ON 31
eH1_2                -6.355517e-02 1 1  ON 32
eH1_3                -2.637151e-02 1 1  ON 33
eH1_4                 1.894519e-02 1 1  ON 34
eH1_5                 3.312163e-02 1 1  ON 35
eH1_6                 7.757990e-02 1 1  ON 36
eH1_7                 1.097468e-01 1 1  ON 37
eH1_8                 9.753129e-02 1 1  ON 38
eH1_9                 2.646936e-02 1 1  ON 39
eH2_0                -1.856684e-01 1 1  ON 40
eH2_1                -1.065185e-01 1 1  ON 41
eH2_2                -6.500339e-02 1 1  ON 42
eH2_3                -2.791096e-02 1 1  ON 43
eH2_4                 1.767064e-02 1 1  ON 44
eH2_5                 3.164242e-02 1 1  ON 45
eH2_6                 7.927520e-02 1 1  ON 46
eH2_7                 1.142069e-01 1 1  ON 47
eH2_8                 1.007142e-01 1 1  ON 48
eH2_9                 2.872899e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.186
    reference variance = 0.261918
====================================================
  Execution time = 1.9536e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1841e-01
  Total weights = 2.0000e+06
  Execution time = 1.8091e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318375070143
                                         uncertainty =       0.002895996526

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318375070143
                                         uncertainty =       0.002895996526

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399008081
  error estimate for blocks of size 2^( 2) =       0.000408712272
  error estimate for blocks of size 2^( 3) =       0.000417553447
  error estimate for blocks of size 2^( 4) =       0.000424374681
  error estimate for blocks of size 2^( 5) =       0.000428776963
  error estimate for blocks of size 2^( 6) =       0.000430057108
  error estimate for blocks of size 2^( 7) =       0.000430459298

      target function =                  N/A
              le_mean =     -17.215895665403
             les_mean =     296.705478300249
             stat err =       0.000428417013
             autocorr =       1.152842647436
              std dev =       0.564282639667
             le_variance =       0.318414897430

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318375070143
                                         uncertainty =       0.002895996526

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318375070143
                                         uncertainty =       0.002895996526

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399008081
  error estimate for blocks of size 2^( 2) =       0.000408712272
  error estimate for blocks of size 2^( 3) =       0.000417553447
  error estimate for blocks of size 2^( 4) =       0.000424374681
  error estimate for blocks of size 2^( 5) =       0.000428776963
  error estimate for blocks of size 2^( 6) =       0.000430057108
  error estimate for blocks of size 2^( 7) =       0.000430459298

      target function =                  N/A
              le_mean =     -17.215895665403
             les_mean =     296.705478300249
             stat err =       0.000428417013
             autocorr =       1.152842647436
              std dev =       0.564282639667
             le_variance =       0.318414897430

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318375070143
                                         uncertainty =       0.002895996526

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318375070143
                                         uncertainty =       0.002895996526

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399008081
  error estimate for blocks of size 2^( 2) =       0.000408712272
  error estimate for blocks of size 2^( 3) =       0.000417553447
  error estimate for blocks of size 2^( 4) =       0.000424374681
  error estimate for blocks of size 2^( 5) =       0.000428776963
  error estimate for blocks of size 2^( 6) =       0.000430057108
  error estimate for blocks of size 2^( 7) =       0.000430459298

      target function =                  N/A
              le_mean =     -17.215895665403
             les_mean =     296.705478300249
             stat err =       0.000428417013
             autocorr =       1.152842647436
              std dev =       0.564282639667
             le_variance =       0.318414897430

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318375070143
                                         uncertainty =       0.002895996526

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318375070143
                                         uncertainty =       0.002895996526

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399008081
  error estimate for blocks of size 2^( 2) =       0.000408712272
  error estimate for blocks of size 2^( 3) =       0.000417553447
  error estimate for blocks of size 2^( 4) =       0.000424374681
  error estimate for blocks of size 2^( 5) =       0.000428776963
  error estimate for blocks of size 2^( 6) =       0.000430057108
  error estimate for blocks of size 2^( 7) =       0.000430459298

      target function =                  N/A
              le_mean =     -17.215895665403
             les_mean =     296.705478300249
             stat err =       0.000428417013
             autocorr =       1.152842647436
              std dev =       0.564282639667
             le_variance =       0.318414897430


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215895665403        initial  <--
     9.5367e+10     9.5367e+11             2.1199e-15       -17.215895665403
     3.8147e+11     3.8147e+12             4.5222e-16       -17.215895665403
     1.5259e+12     1.5259e+13             0.0000e+00       -17.215895665403

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.6520
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 2.139838e-01 1 1  ON 0
 uu_1                 5.161576e-02 1 1  ON 1
 uu_2                -4.322282e-02 1 1  ON 2
 uu_3                -9.894209e-02 1 1  ON 3
 uu_4                -1.336901e-01 1 1  ON 4
 uu_5                -1.420466e-01 1 1  ON 5
 uu_6                -1.192323e-01 1 1  ON 6
 uu_7                -4.820395e-02 1 1  ON 7
 uu_8                 9.350219e-02 1 1  ON 8
 uu_9                 1.266982e-01 1 1  ON 9
 ud_0                 3.555341e-01 1 1  ON 10
 ud_1                 9.663141e-02 1 1  ON 11
 ud_2                -1.382622e-02 1 1  ON 12
 ud_3                -7.541758e-02 1 1  ON 13
 ud_4                -1.235462e-01 1 1  ON 14
 ud_5                -1.555396e-01 1 1  ON 15
 ud_6                -1.570129e-01 1 1  ON 16
 ud_7                -1.128658e-01 1 1  ON 17
 ud_8                -4.903523e-03 1 1  ON 18
 ud_9                 9.265698e-02 1 1  ON 19
 eO_0                -7.839991e-01 1 1  ON 20
 eO_1                -4.623314e-01 1 1  ON 21
 eO_2                -5.035171e-02 1 1  ON 22
 eO_3                 2.109431e-01 1 1  ON 23
 eO_4                 3.116683e-01 1 1  ON 24
 eO_5                 3.267629e-01 1 1  ON 25
 eO_6                 2.625848e-01 1 1  ON 26
 eO_7                 1.244874e-01 1 1  ON 27
 eO_8                 2.991524e-02 1 1  ON 28
 eO_9                 1.907788e-02 1 1  ON 29
eH1_0                -1.844666e-01 1 1  ON 30
eH1_1                -1.050123e-01 1 1  ON 31
eH1_2                -6.355517e-02 1 1  ON 32
eH1_3                -2.637151e-02 1 1  ON 33
eH1_4                 1.894519e-02 1 1  ON 34
eH1_5                 3.312163e-02 1 1  ON 35
eH1_6                 7.757990e-02 1 1  ON 36
eH1_7                 1.097468e-01 1 1  ON 37
eH1_8                 9.753129e-02 1 1  ON 38
eH1_9                 2.646936e-02 1 1  ON 39
eH2_0                -1.856684e-01 1 1  ON 40
eH2_1                -1.065185e-01 1 1  ON 41
eH2_2                -6.500339e-02 1 1  ON 42
eH2_3                -2.791096e-02 1 1  ON 43
eH2_4                 1.767064e-02 1 1  ON 44
eH2_5                 3.164242e-02 1 1  ON 45
eH2_6                 7.927520e-02 1 1  ON 46
eH2_7                 1.142069e-01 1 1  ON 47
eH2_8                 1.007142e-01 1 1  ON 48
eH2_9                 2.872899e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5200e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7216e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.1529
    reference variance = 0.293738
====================================================
  Execution time = 2.0099e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1885e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4427e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318609925897
                                         uncertainty =       0.004162079979

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318609925897
                                         uncertainty =       0.004162079979

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399278116
  error estimate for blocks of size 2^( 2) =       0.000408903984
  error estimate for blocks of size 2^( 3) =       0.000416946992
  error estimate for blocks of size 2^( 4) =       0.000423045662
  error estimate for blocks of size 2^( 5) =       0.000427452066
  error estimate for blocks of size 2^( 6) =       0.000427657151
  error estimate for blocks of size 2^( 7) =       0.000429575137

      target function =                  N/A
              le_mean =     -17.216897995414
             les_mean =     296.740422453356
             stat err =       0.000426932504
             autocorr =       1.143319011564
              std dev =       0.564664527205
             le_variance =       0.318846028284


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721689799541e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+11, overlap shift 9.5367e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216897995414       residual = 5.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216897995414       residual = 5.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.18e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+11 is 0.000000e+00

solving harmonic davidson linear method for identity shift 3.8147e+12, overlap shift 3.8147e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216897995414       residual = 5.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216897995414       residual = 5.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.18e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+12 is 0.000000e+00

solving harmonic davidson linear method for identity shift 1.5259e+13, overlap shift 1.5259e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216897995414       residual = 5.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216897995414       residual = 5.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.20e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+13 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.369369 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5548e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 2.139838e-01 1 1  ON 0
 uu_1                 5.161576e-02 1 1  ON 1
 uu_2                -4.322282e-02 1 1  ON 2
 uu_3                -9.894209e-02 1 1  ON 3
 uu_4                -1.336901e-01 1 1  ON 4
 uu_5                -1.420466e-01 1 1  ON 5
 uu_6                -1.192323e-01 1 1  ON 6
 uu_7                -4.820395e-02 1 1  ON 7
 uu_8                 9.350219e-02 1 1  ON 8
 uu_9                 1.266982e-01 1 1  ON 9
 ud_0                 3.555341e-01 1 1  ON 10
 ud_1                 9.663141e-02 1 1  ON 11
 ud_2                -1.382622e-02 1 1  ON 12
 ud_3                -7.541758e-02 1 1  ON 13
 ud_4                -1.235462e-01 1 1  ON 14
 ud_5                -1.555396e-01 1 1  ON 15
 ud_6                -1.570129e-01 1 1  ON 16
 ud_7                -1.128658e-01 1 1  ON 17
 ud_8                -4.903523e-03 1 1  ON 18
 ud_9                 9.265698e-02 1 1  ON 19
 eO_0                -7.839991e-01 1 1  ON 20
 eO_1                -4.623314e-01 1 1  ON 21
 eO_2                -5.035171e-02 1 1  ON 22
 eO_3                 2.109431e-01 1 1  ON 23
 eO_4                 3.116683e-01 1 1  ON 24
 eO_5                 3.267629e-01 1 1  ON 25
 eO_6                 2.625848e-01 1 1  ON 26
 eO_7                 1.244874e-01 1 1  ON 27
 eO_8                 2.991524e-02 1 1  ON 28
 eO_9                 1.907788e-02 1 1  ON 29
eH1_0                -1.844666e-01 1 1  ON 30
eH1_1                -1.050123e-01 1 1  ON 31
eH1_2                -6.355517e-02 1 1  ON 32
eH1_3                -2.637151e-02 1 1  ON 33
eH1_4                 1.894519e-02 1 1  ON 34
eH1_5                 3.312163e-02 1 1  ON 35
eH1_6                 7.757990e-02 1 1  ON 36
eH1_7                 1.097468e-01 1 1  ON 37
eH1_8                 9.753129e-02 1 1  ON 38
eH1_9                 2.646936e-02 1 1  ON 39
eH2_0                -1.856684e-01 1 1  ON 40
eH2_1                -1.065185e-01 1 1  ON 41
eH2_2                -6.500339e-02 1 1  ON 42
eH2_3                -2.791096e-02 1 1  ON 43
eH2_4                 1.767064e-02 1 1  ON 44
eH2_5                 3.164242e-02 1 1  ON 45
eH2_6                 7.927520e-02 1 1  ON 46
eH2_7                 1.142069e-01 1 1  ON 47
eH2_8                 1.007142e-01 1 1  ON 48
eH2_9                 2.872899e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.2128
    reference variance = 0.246179
====================================================
  Execution time = 1.9752e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2796e-01
  Total weights = 2.0000e+06
  Execution time = 1.8057e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327992805570
                                         uncertainty =       0.013725526377

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327992805570
                                         uncertainty =       0.013725526377

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404941973
  error estimate for blocks of size 2^( 2) =       0.000414441637
  error estimate for blocks of size 2^( 3) =       0.000422764534
  error estimate for blocks of size 2^( 4) =       0.000428767781
  error estimate for blocks of size 2^( 5) =       0.000432686142
  error estimate for blocks of size 2^( 6) =       0.000435614883
  error estimate for blocks of size 2^( 7) =       0.000436545027

      target function =                  N/A
              le_mean =     -17.216445029644
             les_mean =     296.733935297581
             stat err =       0.000433403458
             autocorr =       1.145510714560
              std dev =       0.572674430032
             le_variance =       0.327956002812

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327992805570
                                         uncertainty =       0.013725526377

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327992805570
                                         uncertainty =       0.013725526377

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404941973
  error estimate for blocks of size 2^( 2) =       0.000414441637
  error estimate for blocks of size 2^( 3) =       0.000422764534
  error estimate for blocks of size 2^( 4) =       0.000428767781
  error estimate for blocks of size 2^( 5) =       0.000432686142
  error estimate for blocks of size 2^( 6) =       0.000435614883
  error estimate for blocks of size 2^( 7) =       0.000436545027

      target function =                  N/A
              le_mean =     -17.216445029644
             les_mean =     296.733935297581
             stat err =       0.000433403458
             autocorr =       1.145510714560
              std dev =       0.572674430032
             le_variance =       0.327956002812

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327992805570
                                         uncertainty =       0.013725526377

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327992805570
                                         uncertainty =       0.013725526377

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404941973
  error estimate for blocks of size 2^( 2) =       0.000414441637
  error estimate for blocks of size 2^( 3) =       0.000422764534
  error estimate for blocks of size 2^( 4) =       0.000428767781
  error estimate for blocks of size 2^( 5) =       0.000432686142
  error estimate for blocks of size 2^( 6) =       0.000435614883
  error estimate for blocks of size 2^( 7) =       0.000436545027

      target function =                  N/A
              le_mean =     -17.216445029644
             les_mean =     296.733935297581
             stat err =       0.000433403458
             autocorr =       1.145510714560
              std dev =       0.572674430032
             le_variance =       0.327956002812

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327992805570
                                         uncertainty =       0.013725526377

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327992805570
                                         uncertainty =       0.013725526377

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404941973
  error estimate for blocks of size 2^( 2) =       0.000414441637
  error estimate for blocks of size 2^( 3) =       0.000422764534
  error estimate for blocks of size 2^( 4) =       0.000428767781
  error estimate for blocks of size 2^( 5) =       0.000432686142
  error estimate for blocks of size 2^( 6) =       0.000435614883
  error estimate for blocks of size 2^( 7) =       0.000436545027

      target function =                  N/A
              le_mean =     -17.216445029644
             les_mean =     296.733935297581
             stat err =       0.000433403458
             autocorr =       1.145510714560
              std dev =       0.572674430032
             le_variance =       0.327956002812


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216445029644        initial  <--
     9.5367e+11     9.5367e+12             0.0000e+00       -17.216445029644
     3.8147e+12     3.8147e+13             0.0000e+00       -17.216445029644
     1.5259e+13     1.5259e+14             0.0000e+00       -17.216445029644

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.8588
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 2.139838e-01 1 1  ON 0
 uu_1                 5.161576e-02 1 1  ON 1
 uu_2                -4.322282e-02 1 1  ON 2
 uu_3                -9.894209e-02 1 1  ON 3
 uu_4                -1.336901e-01 1 1  ON 4
 uu_5                -1.420466e-01 1 1  ON 5
 uu_6                -1.192323e-01 1 1  ON 6
 uu_7                -4.820395e-02 1 1  ON 7
 uu_8                 9.350219e-02 1 1  ON 8
 uu_9                 1.266982e-01 1 1  ON 9
 ud_0                 3.555341e-01 1 1  ON 10
 ud_1                 9.663141e-02 1 1  ON 11
 ud_2                -1.382622e-02 1 1  ON 12
 ud_3                -7.541758e-02 1 1  ON 13
 ud_4                -1.235462e-01 1 1  ON 14
 ud_5                -1.555396e-01 1 1  ON 15
 ud_6                -1.570129e-01 1 1  ON 16
 ud_7                -1.128658e-01 1 1  ON 17
 ud_8                -4.903523e-03 1 1  ON 18
 ud_9                 9.265698e-02 1 1  ON 19
 eO_0                -7.839991e-01 1 1  ON 20
 eO_1                -4.623314e-01 1 1  ON 21
 eO_2                -5.035171e-02 1 1  ON 22
 eO_3                 2.109431e-01 1 1  ON 23
 eO_4                 3.116683e-01 1 1  ON 24
 eO_5                 3.267629e-01 1 1  ON 25
 eO_6                 2.625848e-01 1 1  ON 26
 eO_7                 1.244874e-01 1 1  ON 27
 eO_8                 2.991524e-02 1 1  ON 28
 eO_9                 1.907788e-02 1 1  ON 29
eH1_0                -1.844666e-01 1 1  ON 30
eH1_1                -1.050123e-01 1 1  ON 31
eH1_2                -6.355517e-02 1 1  ON 32
eH1_3                -2.637151e-02 1 1  ON 33
eH1_4                 1.894519e-02 1 1  ON 34
eH1_5                 3.312163e-02 1 1  ON 35
eH1_6                 7.757990e-02 1 1  ON 36
eH1_7                 1.097468e-01 1 1  ON 37
eH1_8                 9.753129e-02 1 1  ON 38
eH1_9                 2.646936e-02 1 1  ON 39
eH2_0                -1.856684e-01 1 1  ON 40
eH2_1                -1.065185e-01 1 1  ON 41
eH2_2                -6.500339e-02 1 1  ON 42
eH2_3                -2.791096e-02 1 1  ON 43
eH2_4                 1.767064e-02 1 1  ON 44
eH2_5                 3.164242e-02 1 1  ON 45
eH2_6                 7.927520e-02 1 1  ON 46
eH2_7                 1.142069e-01 1 1  ON 47
eH2_8                 1.007142e-01 1 1  ON 48
eH2_9                 2.872899e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4416e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.2266
    reference variance = 0.196928
====================================================
  Execution time = 1.9604e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1936e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5238e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319408245004
                                         uncertainty =       0.003128647731

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319408245004
                                         uncertainty =       0.003128647731

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399597801
  error estimate for blocks of size 2^( 2) =       0.000409267586
  error estimate for blocks of size 2^( 3) =       0.000417717306
  error estimate for blocks of size 2^( 4) =       0.000423911228
  error estimate for blocks of size 2^( 5) =       0.000427534533
  error estimate for blocks of size 2^( 6) =       0.000428915043
  error estimate for blocks of size 2^( 7) =       0.000431253129

      target function =                  N/A
              le_mean =     -17.216549800800
             les_mean =     296.728943689183
             stat err =       0.000427903483
             autocorr =       1.146688518758
              std dev =       0.565116629938
             le_variance =       0.319356805432


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721654980080e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+12, overlap shift 9.5367e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216549800800       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216549800800       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.19e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+12 is 0.000000e+00

solving harmonic davidson linear method for identity shift 3.8147e+13, overlap shift 3.8147e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216549800800       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216549800800       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.19e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 1.5259e+14, overlap shift 1.5259e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216549800800       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216549800800       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.19e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+14 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.370420 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5133e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 2.139838e-01 1 1  ON 0
 uu_1                 5.161576e-02 1 1  ON 1
 uu_2                -4.322282e-02 1 1  ON 2
 uu_3                -9.894209e-02 1 1  ON 3
 uu_4                -1.336901e-01 1 1  ON 4
 uu_5                -1.420466e-01 1 1  ON 5
 uu_6                -1.192323e-01 1 1  ON 6
 uu_7                -4.820395e-02 1 1  ON 7
 uu_8                 9.350219e-02 1 1  ON 8
 uu_9                 1.266982e-01 1 1  ON 9
 ud_0                 3.555341e-01 1 1  ON 10
 ud_1                 9.663141e-02 1 1  ON 11
 ud_2                -1.382622e-02 1 1  ON 12
 ud_3                -7.541758e-02 1 1  ON 13
 ud_4                -1.235462e-01 1 1  ON 14
 ud_5                -1.555396e-01 1 1  ON 15
 ud_6                -1.570129e-01 1 1  ON 16
 ud_7                -1.128658e-01 1 1  ON 17
 ud_8                -4.903523e-03 1 1  ON 18
 ud_9                 9.265698e-02 1 1  ON 19
 eO_0                -7.839991e-01 1 1  ON 20
 eO_1                -4.623314e-01 1 1  ON 21
 eO_2                -5.035171e-02 1 1  ON 22
 eO_3                 2.109431e-01 1 1  ON 23
 eO_4                 3.116683e-01 1 1  ON 24
 eO_5                 3.267629e-01 1 1  ON 25
 eO_6                 2.625848e-01 1 1  ON 26
 eO_7                 1.244874e-01 1 1  ON 27
 eO_8                 2.991524e-02 1 1  ON 28
 eO_9                 1.907788e-02 1 1  ON 29
eH1_0                -1.844666e-01 1 1  ON 30
eH1_1                -1.050123e-01 1 1  ON 31
eH1_2                -6.355517e-02 1 1  ON 32
eH1_3                -2.637151e-02 1 1  ON 33
eH1_4                 1.894519e-02 1 1  ON 34
eH1_5                 3.312163e-02 1 1  ON 35
eH1_6                 7.757990e-02 1 1  ON 36
eH1_7                 1.097468e-01 1 1  ON 37
eH1_8                 9.753129e-02 1 1  ON 38
eH1_9                 2.646936e-02 1 1  ON 39
eH2_0                -1.856684e-01 1 1  ON 40
eH2_1                -1.065185e-01 1 1  ON 41
eH2_2                -6.500339e-02 1 1  ON 42
eH2_3                -2.791096e-02 1 1  ON 43
eH2_4                 1.767064e-02 1 1  ON 44
eH2_5                 3.164242e-02 1 1  ON 45
eH2_6                 7.927520e-02 1 1  ON 46
eH2_7                 1.142069e-01 1 1  ON 47
eH2_8                 1.007142e-01 1 1  ON 48
eH2_9                 2.872899e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.2376
    reference variance = 0.256321
====================================================
  Execution time = 1.9895e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1645e-01
  Total weights = 2.0000e+06
  Execution time = 1.8050e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316436533044
                                         uncertainty =       0.002908281916

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316436533044
                                         uncertainty =       0.002908281916

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397773531
  error estimate for blocks of size 2^( 2) =       0.000407265118
  error estimate for blocks of size 2^( 3) =       0.000416225774
  error estimate for blocks of size 2^( 4) =       0.000423005015
  error estimate for blocks of size 2^( 5) =       0.000427563540
  error estimate for blocks of size 2^( 6) =       0.000431662908
  error estimate for blocks of size 2^( 7) =       0.000431712688

      target function =                  N/A
              le_mean =     -17.215925548826
             les_mean =     296.704539908693
             stat err =       0.000428486038
             autocorr =       1.160383617049
              std dev =       0.562536722545
             le_variance =       0.316447564211

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316436533044
                                         uncertainty =       0.002908281916

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316436533044
                                         uncertainty =       0.002908281916

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397773531
  error estimate for blocks of size 2^( 2) =       0.000407265118
  error estimate for blocks of size 2^( 3) =       0.000416225774
  error estimate for blocks of size 2^( 4) =       0.000423005015
  error estimate for blocks of size 2^( 5) =       0.000427563540
  error estimate for blocks of size 2^( 6) =       0.000431662908
  error estimate for blocks of size 2^( 7) =       0.000431712688

      target function =                  N/A
              le_mean =     -17.215925548826
             les_mean =     296.704539908693
             stat err =       0.000428486038
             autocorr =       1.160383617049
              std dev =       0.562536722545
             le_variance =       0.316447564211

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316436533044
                                         uncertainty =       0.002908281916

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316436533044
                                         uncertainty =       0.002908281916

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397773531
  error estimate for blocks of size 2^( 2) =       0.000407265118
  error estimate for blocks of size 2^( 3) =       0.000416225774
  error estimate for blocks of size 2^( 4) =       0.000423005015
  error estimate for blocks of size 2^( 5) =       0.000427563540
  error estimate for blocks of size 2^( 6) =       0.000431662908
  error estimate for blocks of size 2^( 7) =       0.000431712688

      target function =                  N/A
              le_mean =     -17.215925548826
             les_mean =     296.704539908693
             stat err =       0.000428486038
             autocorr =       1.160383617049
              std dev =       0.562536722545
             le_variance =       0.316447564211

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316436533044
                                         uncertainty =       0.002908281916

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316436533044
                                         uncertainty =       0.002908281916

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397773531
  error estimate for blocks of size 2^( 2) =       0.000407265118
  error estimate for blocks of size 2^( 3) =       0.000416225774
  error estimate for blocks of size 2^( 4) =       0.000423005015
  error estimate for blocks of size 2^( 5) =       0.000427563540
  error estimate for blocks of size 2^( 6) =       0.000431662908
  error estimate for blocks of size 2^( 7) =       0.000431712688

      target function =                  N/A
              le_mean =     -17.215925548826
             les_mean =     296.704539908693
             stat err =       0.000428486038
             autocorr =       1.160383617049
              std dev =       0.562536722545
             le_variance =       0.316447564211


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215925548826        initial  <--
     9.5367e+12     9.5367e+13             0.0000e+00       -17.215925548826
     3.8147e+13     3.8147e+14             0.0000e+00       -17.215925548826
     1.5259e+14     1.5259e+15             0.0000e+00       -17.215925548826

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.9901
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 2.139838e-01 1 1  ON 0
 uu_1                 5.161576e-02 1 1  ON 1
 uu_2                -4.322282e-02 1 1  ON 2
 uu_3                -9.894209e-02 1 1  ON 3
 uu_4                -1.336901e-01 1 1  ON 4
 uu_5                -1.420466e-01 1 1  ON 5
 uu_6                -1.192323e-01 1 1  ON 6
 uu_7                -4.820395e-02 1 1  ON 7
 uu_8                 9.350219e-02 1 1  ON 8
 uu_9                 1.266982e-01 1 1  ON 9
 ud_0                 3.555341e-01 1 1  ON 10
 ud_1                 9.663141e-02 1 1  ON 11
 ud_2                -1.382622e-02 1 1  ON 12
 ud_3                -7.541758e-02 1 1  ON 13
 ud_4                -1.235462e-01 1 1  ON 14
 ud_5                -1.555396e-01 1 1  ON 15
 ud_6                -1.570129e-01 1 1  ON 16
 ud_7                -1.128658e-01 1 1  ON 17
 ud_8                -4.903523e-03 1 1  ON 18
 ud_9                 9.265698e-02 1 1  ON 19
 eO_0                -7.839991e-01 1 1  ON 20
 eO_1                -4.623314e-01 1 1  ON 21
 eO_2                -5.035171e-02 1 1  ON 22
 eO_3                 2.109431e-01 1 1  ON 23
 eO_4                 3.116683e-01 1 1  ON 24
 eO_5                 3.267629e-01 1 1  ON 25
 eO_6                 2.625848e-01 1 1  ON 26
 eO_7                 1.244874e-01 1 1  ON 27
 eO_8                 2.991524e-02 1 1  ON 28
 eO_9                 1.907788e-02 1 1  ON 29
eH1_0                -1.844666e-01 1 1  ON 30
eH1_1                -1.050123e-01 1 1  ON 31
eH1_2                -6.355517e-02 1 1  ON 32
eH1_3                -2.637151e-02 1 1  ON 33
eH1_4                 1.894519e-02 1 1  ON 34
eH1_5                 3.312163e-02 1 1  ON 35
eH1_6                 7.757990e-02 1 1  ON 36
eH1_7                 1.097468e-01 1 1  ON 37
eH1_8                 9.753129e-02 1 1  ON 38
eH1_9                 2.646936e-02 1 1  ON 39
eH2_0                -1.856684e-01 1 1  ON 40
eH2_1                -1.065185e-01 1 1  ON 41
eH2_2                -6.500339e-02 1 1  ON 42
eH2_3                -2.791096e-02 1 1  ON 43
eH2_4                 1.767064e-02 1 1  ON 44
eH2_5                 3.164242e-02 1 1  ON 45
eH2_6                 7.927520e-02 1 1  ON 46
eH2_7                 1.142069e-01 1 1  ON 47
eH2_8                 1.007142e-01 1 1  ON 48
eH2_9                 2.872899e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4141e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7215e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.2198
    reference variance = 0.215362
====================================================
  Execution time = 2.0139e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1588e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5140e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315949698524
                                         uncertainty =       0.002746869301

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315949698524
                                         uncertainty =       0.002746869301

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397414018
  error estimate for blocks of size 2^( 2) =       0.000407086635
  error estimate for blocks of size 2^( 3) =       0.000415528816
  error estimate for blocks of size 2^( 4) =       0.000421953450
  error estimate for blocks of size 2^( 5) =       0.000425325257
  error estimate for blocks of size 2^( 6) =       0.000427457928
  error estimate for blocks of size 2^( 7) =       0.000427199686

      target function =                  N/A
              le_mean =     -17.217004716294
             les_mean =     296.741127046908
             stat err =       0.000425484080
             autocorr =       1.146252421287
              std dev =       0.562028294609
             le_variance =       0.315875803941


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721700471629e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+13, overlap shift 9.5367e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217004716294       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217004716294       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.22e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 3.8147e+14, overlap shift 3.8147e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217004716294       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217004716294       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+14 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+15, overlap shift 1.5259e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217004716294       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217004716294       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+15 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.371513 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5658e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 2.139838e-01 1 1  ON 0
 uu_1                 5.161576e-02 1 1  ON 1
 uu_2                -4.322282e-02 1 1  ON 2
 uu_3                -9.894209e-02 1 1  ON 3
 uu_4                -1.336901e-01 1 1  ON 4
 uu_5                -1.420466e-01 1 1  ON 5
 uu_6                -1.192323e-01 1 1  ON 6
 uu_7                -4.820395e-02 1 1  ON 7
 uu_8                 9.350219e-02 1 1  ON 8
 uu_9                 1.266982e-01 1 1  ON 9
 ud_0                 3.555341e-01 1 1  ON 10
 ud_1                 9.663141e-02 1 1  ON 11
 ud_2                -1.382622e-02 1 1  ON 12
 ud_3                -7.541758e-02 1 1  ON 13
 ud_4                -1.235462e-01 1 1  ON 14
 ud_5                -1.555396e-01 1 1  ON 15
 ud_6                -1.570129e-01 1 1  ON 16
 ud_7                -1.128658e-01 1 1  ON 17
 ud_8                -4.903523e-03 1 1  ON 18
 ud_9                 9.265698e-02 1 1  ON 19
 eO_0                -7.839991e-01 1 1  ON 20
 eO_1                -4.623314e-01 1 1  ON 21
 eO_2                -5.035171e-02 1 1  ON 22
 eO_3                 2.109431e-01 1 1  ON 23
 eO_4                 3.116683e-01 1 1  ON 24
 eO_5                 3.267629e-01 1 1  ON 25
 eO_6                 2.625848e-01 1 1  ON 26
 eO_7                 1.244874e-01 1 1  ON 27
 eO_8                 2.991524e-02 1 1  ON 28
 eO_9                 1.907788e-02 1 1  ON 29
eH1_0                -1.844666e-01 1 1  ON 30
eH1_1                -1.050123e-01 1 1  ON 31
eH1_2                -6.355517e-02 1 1  ON 32
eH1_3                -2.637151e-02 1 1  ON 33
eH1_4                 1.894519e-02 1 1  ON 34
eH1_5                 3.312163e-02 1 1  ON 35
eH1_6                 7.757990e-02 1 1  ON 36
eH1_7                 1.097468e-01 1 1  ON 37
eH1_8                 9.753129e-02 1 1  ON 38
eH1_9                 2.646936e-02 1 1  ON 39
eH2_0                -1.856684e-01 1 1  ON 40
eH2_1                -1.065185e-01 1 1  ON 41
eH2_2                -6.500339e-02 1 1  ON 42
eH2_3                -2.791096e-02 1 1  ON 43
eH2_4                 1.767064e-02 1 1  ON 44
eH2_5                 3.164242e-02 1 1  ON 45
eH2_6                 7.927520e-02 1 1  ON 46
eH2_7                 1.142069e-01 1 1  ON 47
eH2_8                 1.007142e-01 1 1  ON 48
eH2_9                 2.872899e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.2385
    reference variance = 0.219043
====================================================
  Execution time = 1.9886e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1867e-01
  Total weights = 2.0000e+06
  Execution time = 1.8026e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318736760734
                                         uncertainty =       0.003790672199

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318736760734
                                         uncertainty =       0.003790672199

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399169914
  error estimate for blocks of size 2^( 2) =       0.000408596042
  error estimate for blocks of size 2^( 3) =       0.000417488454
  error estimate for blocks of size 2^( 4) =       0.000423786324
  error estimate for blocks of size 2^( 5) =       0.000427428171
  error estimate for blocks of size 2^( 6) =       0.000429348142
  error estimate for blocks of size 2^( 7) =       0.000428198049

      target function =                  N/A
              le_mean =     -17.216223623156
             les_mean =     296.717028923480
             stat err =       0.000427190171
             autocorr =       1.145320155520
              std dev =       0.564511505902
             le_variance =       0.318673240296

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318736760734
                                         uncertainty =       0.003790672199

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318736760734
                                         uncertainty =       0.003790672199

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399169914
  error estimate for blocks of size 2^( 2) =       0.000408596042
  error estimate for blocks of size 2^( 3) =       0.000417488454
  error estimate for blocks of size 2^( 4) =       0.000423786324
  error estimate for blocks of size 2^( 5) =       0.000427428171
  error estimate for blocks of size 2^( 6) =       0.000429348142
  error estimate for blocks of size 2^( 7) =       0.000428198049

      target function =                  N/A
              le_mean =     -17.216223623156
             les_mean =     296.717028923480
             stat err =       0.000427190171
             autocorr =       1.145320155520
              std dev =       0.564511505902
             le_variance =       0.318673240296

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318736760734
                                         uncertainty =       0.003790672199

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318736760734
                                         uncertainty =       0.003790672199

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399169914
  error estimate for blocks of size 2^( 2) =       0.000408596042
  error estimate for blocks of size 2^( 3) =       0.000417488454
  error estimate for blocks of size 2^( 4) =       0.000423786324
  error estimate for blocks of size 2^( 5) =       0.000427428171
  error estimate for blocks of size 2^( 6) =       0.000429348142
  error estimate for blocks of size 2^( 7) =       0.000428198049

      target function =                  N/A
              le_mean =     -17.216223623156
             les_mean =     296.717028923480
             stat err =       0.000427190171
             autocorr =       1.145320155520
              std dev =       0.564511505902
             le_variance =       0.318673240296

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318736760734
                                         uncertainty =       0.003790672199

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318736760734
                                         uncertainty =       0.003790672199

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399169914
  error estimate for blocks of size 2^( 2) =       0.000408596042
  error estimate for blocks of size 2^( 3) =       0.000417488454
  error estimate for blocks of size 2^( 4) =       0.000423786324
  error estimate for blocks of size 2^( 5) =       0.000427428171
  error estimate for blocks of size 2^( 6) =       0.000429348142
  error estimate for blocks of size 2^( 7) =       0.000428198049

      target function =                  N/A
              le_mean =     -17.216223623156
             les_mean =     296.717028923480
             stat err =       0.000427190171
             autocorr =       1.145320155520
              std dev =       0.564511505902
             le_variance =       0.318673240296


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216223623156        initial  <--
     9.5367e+13     9.5367e+14             0.0000e+00       -17.216223623156
     3.8147e+14     3.8147e+15             0.0000e+00       -17.216223623156
     1.5259e+15     1.5259e+16             0.0000e+00       -17.216223623156

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.0174
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 2.139838e-01 1 1  ON 0
 uu_1                 5.161576e-02 1 1  ON 1
 uu_2                -4.322282e-02 1 1  ON 2
 uu_3                -9.894209e-02 1 1  ON 3
 uu_4                -1.336901e-01 1 1  ON 4
 uu_5                -1.420466e-01 1 1  ON 5
 uu_6                -1.192323e-01 1 1  ON 6
 uu_7                -4.820395e-02 1 1  ON 7
 uu_8                 9.350219e-02 1 1  ON 8
 uu_9                 1.266982e-01 1 1  ON 9
 ud_0                 3.555341e-01 1 1  ON 10
 ud_1                 9.663141e-02 1 1  ON 11
 ud_2                -1.382622e-02 1 1  ON 12
 ud_3                -7.541758e-02 1 1  ON 13
 ud_4                -1.235462e-01 1 1  ON 14
 ud_5                -1.555396e-01 1 1  ON 15
 ud_6                -1.570129e-01 1 1  ON 16
 ud_7                -1.128658e-01 1 1  ON 17
 ud_8                -4.903523e-03 1 1  ON 18
 ud_9                 9.265698e-02 1 1  ON 19
 eO_0                -7.839991e-01 1 1  ON 20
 eO_1                -4.623314e-01 1 1  ON 21
 eO_2                -5.035171e-02 1 1  ON 22
 eO_3                 2.109431e-01 1 1  ON 23
 eO_4                 3.116683e-01 1 1  ON 24
 eO_5                 3.267629e-01 1 1  ON 25
 eO_6                 2.625848e-01 1 1  ON 26
 eO_7                 1.244874e-01 1 1  ON 27
 eO_8                 2.991524e-02 1 1  ON 28
 eO_9                 1.907788e-02 1 1  ON 29
eH1_0                -1.844666e-01 1 1  ON 30
eH1_1                -1.050123e-01 1 1  ON 31
eH1_2                -6.355517e-02 1 1  ON 32
eH1_3                -2.637151e-02 1 1  ON 33
eH1_4                 1.894519e-02 1 1  ON 34
eH1_5                 3.312163e-02 1 1  ON 35
eH1_6                 7.757990e-02 1 1  ON 36
eH1_7                 1.097468e-01 1 1  ON 37
eH1_8                 9.753129e-02 1 1  ON 38
eH1_9                 2.646936e-02 1 1  ON 39
eH2_0                -1.856684e-01 1 1  ON 40
eH2_1                -1.065185e-01 1 1  ON 41
eH2_2                -6.500339e-02 1 1  ON 42
eH2_3                -2.791096e-02 1 1  ON 43
eH2_4                 1.767064e-02 1 1  ON 44
eH2_5                 3.164242e-02 1 1  ON 45
eH2_6                 7.927520e-02 1 1  ON 46
eH2_7                 1.142069e-01 1 1  ON 47
eH2_8                 1.007142e-01 1 1  ON 48
eH2_9                 2.872899e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4681e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7215e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.2296
    reference variance = 0.255776
====================================================
  Execution time = 1.9911e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1939e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4736e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319473369992
                                         uncertainty =       0.004998675398

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319473369992
                                         uncertainty =       0.004998675398

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399618426
  error estimate for blocks of size 2^( 2) =       0.000408837201
  error estimate for blocks of size 2^( 3) =       0.000417313526
  error estimate for blocks of size 2^( 4) =       0.000423903543
  error estimate for blocks of size 2^( 5) =       0.000427654888
  error estimate for blocks of size 2^( 6) =       0.000430297104
  error estimate for blocks of size 2^( 7) =       0.000432129301

      target function =                  N/A
              le_mean =     -17.216083041588
             les_mean =     296.712904908353
             stat err =       0.000428496209
             autocorr =       1.149748781859
              std dev =       0.565145798186
             le_variance =       0.319389773208


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721608304159e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+14, overlap shift 9.5367e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216083041588       residual = 3.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216083041588       residual = 6.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216083041588       residual = 3.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+14 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+15, overlap shift 3.8147e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216083041588       residual = 3.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216083041588       residual = 6.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216083041588       residual = 5.88e+00           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.139315800443       residual = 9.32e-01           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.529330588342       residual = 1.51e+01           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+15 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+16, overlap shift 1.5259e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216083041588       residual = 3.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216083041588       residual = 6.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216083041588       residual = 8.74e+00           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216083041588       residual = 4.50e+00           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -24.044789686944       residual = 7.17e+03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -20.637752406891       residual = 3.98e+03           smallest_sin_value = 1.00e+00
davidson iteration    6 stopping due to too large eigenvalue change
davidson solver did not converge after          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+16 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.373431 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5390e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 2.139838e-01 1 1  ON 0
 uu_1                 5.161576e-02 1 1  ON 1
 uu_2                -4.322282e-02 1 1  ON 2
 uu_3                -9.894209e-02 1 1  ON 3
 uu_4                -1.336901e-01 1 1  ON 4
 uu_5                -1.420466e-01 1 1  ON 5
 uu_6                -1.192323e-01 1 1  ON 6
 uu_7                -4.820395e-02 1 1  ON 7
 uu_8                 9.350219e-02 1 1  ON 8
 uu_9                 1.266982e-01 1 1  ON 9
 ud_0                 3.555341e-01 1 1  ON 10
 ud_1                 9.663141e-02 1 1  ON 11
 ud_2                -1.382622e-02 1 1  ON 12
 ud_3                -7.541758e-02 1 1  ON 13
 ud_4                -1.235462e-01 1 1  ON 14
 ud_5                -1.555396e-01 1 1  ON 15
 ud_6                -1.570129e-01 1 1  ON 16
 ud_7                -1.128658e-01 1 1  ON 17
 ud_8                -4.903523e-03 1 1  ON 18
 ud_9                 9.265698e-02 1 1  ON 19
 eO_0                -7.839991e-01 1 1  ON 20
 eO_1                -4.623314e-01 1 1  ON 21
 eO_2                -5.035171e-02 1 1  ON 22
 eO_3                 2.109431e-01 1 1  ON 23
 eO_4                 3.116683e-01 1 1  ON 24
 eO_5                 3.267629e-01 1 1  ON 25
 eO_6                 2.625848e-01 1 1  ON 26
 eO_7                 1.244874e-01 1 1  ON 27
 eO_8                 2.991524e-02 1 1  ON 28
 eO_9                 1.907788e-02 1 1  ON 29
eH1_0                -1.844666e-01 1 1  ON 30
eH1_1                -1.050123e-01 1 1  ON 31
eH1_2                -6.355517e-02 1 1  ON 32
eH1_3                -2.637151e-02 1 1  ON 33
eH1_4                 1.894519e-02 1 1  ON 34
eH1_5                 3.312163e-02 1 1  ON 35
eH1_6                 7.757990e-02 1 1  ON 36
eH1_7                 1.097468e-01 1 1  ON 37
eH1_8                 9.753129e-02 1 1  ON 38
eH1_9                 2.646936e-02 1 1  ON 39
eH2_0                -1.856684e-01 1 1  ON 40
eH2_1                -1.065185e-01 1 1  ON 41
eH2_2                -6.500339e-02 1 1  ON 42
eH2_3                -2.791096e-02 1 1  ON 43
eH2_4                 1.767064e-02 1 1  ON 44
eH2_5                 3.164242e-02 1 1  ON 45
eH2_6                 7.927520e-02 1 1  ON 46
eH2_7                 1.142069e-01 1 1  ON 47
eH2_8                 1.007142e-01 1 1  ON 48
eH2_9                 2.872899e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.171
    reference variance = 0.498757
====================================================
  Execution time = 1.9708e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1396e-01
  Total weights = 2.0000e+06
  Execution time = 1.8117e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314060699363
                                         uncertainty =       0.002894799390

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314060699363
                                         uncertainty =       0.002894799390

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396208344
  error estimate for blocks of size 2^( 2) =       0.000405510290
  error estimate for blocks of size 2^( 3) =       0.000414312577
  error estimate for blocks of size 2^( 4) =       0.000420038615
  error estimate for blocks of size 2^( 5) =       0.000425657827
  error estimate for blocks of size 2^( 6) =       0.000426404223
  error estimate for blocks of size 2^( 7) =       0.000430143074

      target function =                  N/A
              le_mean =     -17.216345509674
             les_mean =     296.716514655614
             stat err =       0.000425560935
             autocorr =       1.153655851012
              std dev =       0.560323213972
             le_variance =       0.313962104116

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314060699363
                                         uncertainty =       0.002894799390

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314060699363
                                         uncertainty =       0.002894799390

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396208344
  error estimate for blocks of size 2^( 2) =       0.000405510290
  error estimate for blocks of size 2^( 3) =       0.000414312577
  error estimate for blocks of size 2^( 4) =       0.000420038615
  error estimate for blocks of size 2^( 5) =       0.000425657827
  error estimate for blocks of size 2^( 6) =       0.000426404223
  error estimate for blocks of size 2^( 7) =       0.000430143074

      target function =                  N/A
              le_mean =     -17.216345509674
             les_mean =     296.716514655614
             stat err =       0.000425560935
             autocorr =       1.153655851012
              std dev =       0.560323213972
             le_variance =       0.313962104116

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314060699363
                                         uncertainty =       0.002894799390

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314060699363
                                         uncertainty =       0.002894799390

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396208344
  error estimate for blocks of size 2^( 2) =       0.000405510290
  error estimate for blocks of size 2^( 3) =       0.000414312577
  error estimate for blocks of size 2^( 4) =       0.000420038615
  error estimate for blocks of size 2^( 5) =       0.000425657827
  error estimate for blocks of size 2^( 6) =       0.000426404223
  error estimate for blocks of size 2^( 7) =       0.000430143074

      target function =                  N/A
              le_mean =     -17.216345509674
             les_mean =     296.716514655614
             stat err =       0.000425560935
             autocorr =       1.153655851012
              std dev =       0.560323213972
             le_variance =       0.313962104116

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314060699363
                                         uncertainty =       0.002894799390

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314060699363
                                         uncertainty =       0.002894799390

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396208344
  error estimate for blocks of size 2^( 2) =       0.000405510290
  error estimate for blocks of size 2^( 3) =       0.000414312577
  error estimate for blocks of size 2^( 4) =       0.000420038615
  error estimate for blocks of size 2^( 5) =       0.000425657827
  error estimate for blocks of size 2^( 6) =       0.000426404223
  error estimate for blocks of size 2^( 7) =       0.000430143074

      target function =                  N/A
              le_mean =     -17.216345509674
             les_mean =     296.716514655614
             stat err =       0.000425560935
             autocorr =       1.153655851012
              std dev =       0.560323213972
             le_variance =       0.313962104116


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216345509674        initial  <--
     9.5367e+14     9.5367e+15             0.0000e+00       -17.216345509674
     3.8147e+15     3.8147e+16             0.0000e+00       -17.216345509674
     1.5259e+16     1.5259e+17             0.0000e+00       -17.216345509674

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.8357
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 2.139838e-01 1 1  ON 0
 uu_1                 5.161576e-02 1 1  ON 1
 uu_2                -4.322282e-02 1 1  ON 2
 uu_3                -9.894209e-02 1 1  ON 3
 uu_4                -1.336901e-01 1 1  ON 4
 uu_5                -1.420466e-01 1 1  ON 5
 uu_6                -1.192323e-01 1 1  ON 6
 uu_7                -4.820395e-02 1 1  ON 7
 uu_8                 9.350219e-02 1 1  ON 8
 uu_9                 1.266982e-01 1 1  ON 9
 ud_0                 3.555341e-01 1 1  ON 10
 ud_1                 9.663141e-02 1 1  ON 11
 ud_2                -1.382622e-02 1 1  ON 12
 ud_3                -7.541758e-02 1 1  ON 13
 ud_4                -1.235462e-01 1 1  ON 14
 ud_5                -1.555396e-01 1 1  ON 15
 ud_6                -1.570129e-01 1 1  ON 16
 ud_7                -1.128658e-01 1 1  ON 17
 ud_8                -4.903523e-03 1 1  ON 18
 ud_9                 9.265698e-02 1 1  ON 19
 eO_0                -7.839991e-01 1 1  ON 20
 eO_1                -4.623314e-01 1 1  ON 21
 eO_2                -5.035171e-02 1 1  ON 22
 eO_3                 2.109431e-01 1 1  ON 23
 eO_4                 3.116683e-01 1 1  ON 24
 eO_5                 3.267629e-01 1 1  ON 25
 eO_6                 2.625848e-01 1 1  ON 26
 eO_7                 1.244874e-01 1 1  ON 27
 eO_8                 2.991524e-02 1 1  ON 28
 eO_9                 1.907788e-02 1 1  ON 29
eH1_0                -1.844666e-01 1 1  ON 30
eH1_1                -1.050123e-01 1 1  ON 31
eH1_2                -6.355517e-02 1 1  ON 32
eH1_3                -2.637151e-02 1 1  ON 33
eH1_4                 1.894519e-02 1 1  ON 34
eH1_5                 3.312163e-02 1 1  ON 35
eH1_6                 7.757990e-02 1 1  ON 36
eH1_7                 1.097468e-01 1 1  ON 37
eH1_8                 9.753129e-02 1 1  ON 38
eH1_9                 2.646936e-02 1 1  ON 39
eH2_0                -1.856684e-01 1 1  ON 40
eH2_1                -1.065185e-01 1 1  ON 41
eH2_2                -6.500339e-02 1 1  ON 42
eH2_3                -2.791096e-02 1 1  ON 43
eH2_4                 1.767064e-02 1 1  ON 44
eH2_5                 3.164242e-02 1 1  ON 45
eH2_6                 7.927520e-02 1 1  ON 46
eH2_7                 1.142069e-01 1 1  ON 47
eH2_8                 1.007142e-01 1 1  ON 48
eH2_9                 2.872899e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4356e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7215e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.1948
    reference variance = 0.251069
====================================================
  Execution time = 2.1882e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2055e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5063e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320632753484
                                         uncertainty =       0.004095776857

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320632753484
                                         uncertainty =       0.004095776857

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400343371
  error estimate for blocks of size 2^( 2) =       0.000409887716
  error estimate for blocks of size 2^( 3) =       0.000419168751
  error estimate for blocks of size 2^( 4) =       0.000425643759
  error estimate for blocks of size 2^( 5) =       0.000429228391
  error estimate for blocks of size 2^( 6) =       0.000431147052
  error estimate for blocks of size 2^( 7) =       0.000434938803

      target function =                  N/A
              le_mean =     -17.216319614179
             les_mean =     296.722210526802
             stat err =       0.000430239501
             autocorr =       1.154928979941
              std dev =       0.566171024961
             le_variance =       0.320549629505


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721631961418e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+15, overlap shift 9.5367e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216319614179       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216319614179       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+15 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+16, overlap shift 3.8147e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216319614179       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216319614179       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+16 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+17, overlap shift 1.5259e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216319614179       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216319614179       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+17 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.374544 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7394e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 2.139838e-01 1 1  ON 0
 uu_1                 5.161576e-02 1 1  ON 1
 uu_2                -4.322282e-02 1 1  ON 2
 uu_3                -9.894209e-02 1 1  ON 3
 uu_4                -1.336901e-01 1 1  ON 4
 uu_5                -1.420466e-01 1 1  ON 5
 uu_6                -1.192323e-01 1 1  ON 6
 uu_7                -4.820395e-02 1 1  ON 7
 uu_8                 9.350219e-02 1 1  ON 8
 uu_9                 1.266982e-01 1 1  ON 9
 ud_0                 3.555341e-01 1 1  ON 10
 ud_1                 9.663141e-02 1 1  ON 11
 ud_2                -1.382622e-02 1 1  ON 12
 ud_3                -7.541758e-02 1 1  ON 13
 ud_4                -1.235462e-01 1 1  ON 14
 ud_5                -1.555396e-01 1 1  ON 15
 ud_6                -1.570129e-01 1 1  ON 16
 ud_7                -1.128658e-01 1 1  ON 17
 ud_8                -4.903523e-03 1 1  ON 18
 ud_9                 9.265698e-02 1 1  ON 19
 eO_0                -7.839991e-01 1 1  ON 20
 eO_1                -4.623314e-01 1 1  ON 21
 eO_2                -5.035171e-02 1 1  ON 22
 eO_3                 2.109431e-01 1 1  ON 23
 eO_4                 3.116683e-01 1 1  ON 24
 eO_5                 3.267629e-01 1 1  ON 25
 eO_6                 2.625848e-01 1 1  ON 26
 eO_7                 1.244874e-01 1 1  ON 27
 eO_8                 2.991524e-02 1 1  ON 28
 eO_9                 1.907788e-02 1 1  ON 29
eH1_0                -1.844666e-01 1 1  ON 30
eH1_1                -1.050123e-01 1 1  ON 31
eH1_2                -6.355517e-02 1 1  ON 32
eH1_3                -2.637151e-02 1 1  ON 33
eH1_4                 1.894519e-02 1 1  ON 34
eH1_5                 3.312163e-02 1 1  ON 35
eH1_6                 7.757990e-02 1 1  ON 36
eH1_7                 1.097468e-01 1 1  ON 37
eH1_8                 9.753129e-02 1 1  ON 38
eH1_9                 2.646936e-02 1 1  ON 39
eH2_0                -1.856684e-01 1 1  ON 40
eH2_1                -1.065185e-01 1 1  ON 41
eH2_2                -6.500339e-02 1 1  ON 42
eH2_3                -2.791096e-02 1 1  ON 43
eH2_4                 1.767064e-02 1 1  ON 44
eH2_5                 3.164242e-02 1 1  ON 45
eH2_6                 7.927520e-02 1 1  ON 46
eH2_7                 1.142069e-01 1 1  ON 47
eH2_8                 1.007142e-01 1 1  ON 48
eH2_9                 2.872899e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.1329
    reference variance = 0.362253
====================================================
  Execution time = 2.0163e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1878e-01
  Total weights = 2.0000e+06
  Execution time = 2.3181e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318475314651
                                         uncertainty =       0.003934992956

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318475314651
                                         uncertainty =       0.003934992956

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399238633
  error estimate for blocks of size 2^( 2) =       0.000408944155
  error estimate for blocks of size 2^( 3) =       0.000417897250
  error estimate for blocks of size 2^( 4) =       0.000423975568
  error estimate for blocks of size 2^( 5) =       0.000428642204
  error estimate for blocks of size 2^( 6) =       0.000431019708
  error estimate for blocks of size 2^( 7) =       0.000430708377

      target function =                  N/A
              le_mean =     -17.216279756180
             les_mean =     296.719071455478
             stat err =       0.000428586464
             autocorr =       1.152422641105
              std dev =       0.564608689116
             le_variance =       0.318782971826

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318475314651
                                         uncertainty =       0.003934992956

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318475314651
                                         uncertainty =       0.003934992956

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399238633
  error estimate for blocks of size 2^( 2) =       0.000408944155
  error estimate for blocks of size 2^( 3) =       0.000417897250
  error estimate for blocks of size 2^( 4) =       0.000423975568
  error estimate for blocks of size 2^( 5) =       0.000428642204
  error estimate for blocks of size 2^( 6) =       0.000431019708
  error estimate for blocks of size 2^( 7) =       0.000430708377

      target function =                  N/A
              le_mean =     -17.216279756180
             les_mean =     296.719071455478
             stat err =       0.000428586464
             autocorr =       1.152422641105
              std dev =       0.564608689116
             le_variance =       0.318782971826

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318475314651
                                         uncertainty =       0.003934992956

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318475314651
                                         uncertainty =       0.003934992956

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399238633
  error estimate for blocks of size 2^( 2) =       0.000408944155
  error estimate for blocks of size 2^( 3) =       0.000417897250
  error estimate for blocks of size 2^( 4) =       0.000423975568
  error estimate for blocks of size 2^( 5) =       0.000428642204
  error estimate for blocks of size 2^( 6) =       0.000431019708
  error estimate for blocks of size 2^( 7) =       0.000430708377

      target function =                  N/A
              le_mean =     -17.216279756180
             les_mean =     296.719071455478
             stat err =       0.000428586464
             autocorr =       1.152422641105
              std dev =       0.564608689116
             le_variance =       0.318782971826

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318475314651
                                         uncertainty =       0.003934992956

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318475314651
                                         uncertainty =       0.003934992956

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399238633
  error estimate for blocks of size 2^( 2) =       0.000408944155
  error estimate for blocks of size 2^( 3) =       0.000417897250
  error estimate for blocks of size 2^( 4) =       0.000423975568
  error estimate for blocks of size 2^( 5) =       0.000428642204
  error estimate for blocks of size 2^( 6) =       0.000431019708
  error estimate for blocks of size 2^( 7) =       0.000430708377

      target function =                  N/A
              le_mean =     -17.216279756180
             les_mean =     296.719071455478
             stat err =       0.000428586464
             autocorr =       1.152422641105
              std dev =       0.564608689116
             le_variance =       0.318782971826


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216279756180        initial  <--
     9.5367e+15     9.5367e+16             0.0000e+00       -17.216279756180
     3.8147e+16     3.8147e+17             0.0000e+00       -17.216279756180
     1.5259e+17     1.5259e+18             0.0000e+00       -17.216279756180

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9888
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 2.139838e-01 1 1  ON 0
 uu_1                 5.161576e-02 1 1  ON 1
 uu_2                -4.322282e-02 1 1  ON 2
 uu_3                -9.894209e-02 1 1  ON 3
 uu_4                -1.336901e-01 1 1  ON 4
 uu_5                -1.420466e-01 1 1  ON 5
 uu_6                -1.192323e-01 1 1  ON 6
 uu_7                -4.820395e-02 1 1  ON 7
 uu_8                 9.350219e-02 1 1  ON 8
 uu_9                 1.266982e-01 1 1  ON 9
 ud_0                 3.555341e-01 1 1  ON 10
 ud_1                 9.663141e-02 1 1  ON 11
 ud_2                -1.382622e-02 1 1  ON 12
 ud_3                -7.541758e-02 1 1  ON 13
 ud_4                -1.235462e-01 1 1  ON 14
 ud_5                -1.555396e-01 1 1  ON 15
 ud_6                -1.570129e-01 1 1  ON 16
 ud_7                -1.128658e-01 1 1  ON 17
 ud_8                -4.903523e-03 1 1  ON 18
 ud_9                 9.265698e-02 1 1  ON 19
 eO_0                -7.839991e-01 1 1  ON 20
 eO_1                -4.623314e-01 1 1  ON 21
 eO_2                -5.035171e-02 1 1  ON 22
 eO_3                 2.109431e-01 1 1  ON 23
 eO_4                 3.116683e-01 1 1  ON 24
 eO_5                 3.267629e-01 1 1  ON 25
 eO_6                 2.625848e-01 1 1  ON 26
 eO_7                 1.244874e-01 1 1  ON 27
 eO_8                 2.991524e-02 1 1  ON 28
 eO_9                 1.907788e-02 1 1  ON 29
eH1_0                -1.844666e-01 1 1  ON 30
eH1_1                -1.050123e-01 1 1  ON 31
eH1_2                -6.355517e-02 1 1  ON 32
eH1_3                -2.637151e-02 1 1  ON 33
eH1_4                 1.894519e-02 1 1  ON 34
eH1_5                 3.312163e-02 1 1  ON 35
eH1_6                 7.757990e-02 1 1  ON 36
eH1_7                 1.097468e-01 1 1  ON 37
eH1_8                 9.753129e-02 1 1  ON 38
eH1_9                 2.646936e-02 1 1  ON 39
eH2_0                -1.856684e-01 1 1  ON 40
eH2_1                -1.065185e-01 1 1  ON 41
eH2_2                -6.500339e-02 1 1  ON 42
eH2_3                -2.791096e-02 1 1  ON 43
eH2_4                 1.767064e-02 1 1  ON 44
eH2_5                 3.164242e-02 1 1  ON 45
eH2_6                 7.927520e-02 1 1  ON 46
eH2_7                 1.142069e-01 1 1  ON 47
eH2_8                 1.007142e-01 1 1  ON 48
eH2_9                 2.872899e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7401e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.2891
    reference variance = 0.424641
====================================================
  Execution time = 2.0028e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2105e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6795e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321074212203
                                         uncertainty =       0.003648486896

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321074212203
                                         uncertainty =       0.003648486896

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400654057
  error estimate for blocks of size 2^( 2) =       0.000410596343
  error estimate for blocks of size 2^( 3) =       0.000419117493
  error estimate for blocks of size 2^( 4) =       0.000425713487
  error estimate for blocks of size 2^( 5) =       0.000428813731
  error estimate for blocks of size 2^( 6) =       0.000428803154
  error estimate for blocks of size 2^( 7) =       0.000429433549

      target function =                  N/A
              le_mean =     -17.216202145197
             les_mean =     296.718663490875
             stat err =       0.000428190981
             autocorr =       1.142183653309
              std dev =       0.566610401525
             le_variance =       0.321047347116


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721620214520e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+16, overlap shift 9.5367e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216202145197       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216202145197       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+16 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+17, overlap shift 3.8147e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216202145197       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216202145197       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+17 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+18, overlap shift 1.5259e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216202145197       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216202145197       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.375660 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5712e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 2.139838e-01 1 1  ON 0
 uu_1                 5.161576e-02 1 1  ON 1
 uu_2                -4.322282e-02 1 1  ON 2
 uu_3                -9.894209e-02 1 1  ON 3
 uu_4                -1.336901e-01 1 1  ON 4
 uu_5                -1.420466e-01 1 1  ON 5
 uu_6                -1.192323e-01 1 1  ON 6
 uu_7                -4.820395e-02 1 1  ON 7
 uu_8                 9.350219e-02 1 1  ON 8
 uu_9                 1.266982e-01 1 1  ON 9
 ud_0                 3.555341e-01 1 1  ON 10
 ud_1                 9.663141e-02 1 1  ON 11
 ud_2                -1.382622e-02 1 1  ON 12
 ud_3                -7.541758e-02 1 1  ON 13
 ud_4                -1.235462e-01 1 1  ON 14
 ud_5                -1.555396e-01 1 1  ON 15
 ud_6                -1.570129e-01 1 1  ON 16
 ud_7                -1.128658e-01 1 1  ON 17
 ud_8                -4.903523e-03 1 1  ON 18
 ud_9                 9.265698e-02 1 1  ON 19
 eO_0                -7.839991e-01 1 1  ON 20
 eO_1                -4.623314e-01 1 1  ON 21
 eO_2                -5.035171e-02 1 1  ON 22
 eO_3                 2.109431e-01 1 1  ON 23
 eO_4                 3.116683e-01 1 1  ON 24
 eO_5                 3.267629e-01 1 1  ON 25
 eO_6                 2.625848e-01 1 1  ON 26
 eO_7                 1.244874e-01 1 1  ON 27
 eO_8                 2.991524e-02 1 1  ON 28
 eO_9                 1.907788e-02 1 1  ON 29
eH1_0                -1.844666e-01 1 1  ON 30
eH1_1                -1.050123e-01 1 1  ON 31
eH1_2                -6.355517e-02 1 1  ON 32
eH1_3                -2.637151e-02 1 1  ON 33
eH1_4                 1.894519e-02 1 1  ON 34
eH1_5                 3.312163e-02 1 1  ON 35
eH1_6                 7.757990e-02 1 1  ON 36
eH1_7                 1.097468e-01 1 1  ON 37
eH1_8                 9.753129e-02 1 1  ON 38
eH1_9                 2.646936e-02 1 1  ON 39
eH2_0                -1.856684e-01 1 1  ON 40
eH2_1                -1.065185e-01 1 1  ON 41
eH2_2                -6.500339e-02 1 1  ON 42
eH2_3                -2.791096e-02 1 1  ON 43
eH2_4                 1.767064e-02 1 1  ON 44
eH2_5                 3.164242e-02 1 1  ON 45
eH2_6                 7.927520e-02 1 1  ON 46
eH2_7                 1.142069e-01 1 1  ON 47
eH2_8                 1.007142e-01 1 1  ON 48
eH2_9                 2.872899e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.2561
    reference variance = 0.186834
====================================================
  Execution time = 1.9609e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1629e-01
  Total weights = 2.0000e+06
  Execution time = 1.8140e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316352828473
                                         uncertainty =       0.003158929684

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316352828473
                                         uncertainty =       0.003158929684

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397676480
  error estimate for blocks of size 2^( 2) =       0.000407427166
  error estimate for blocks of size 2^( 3) =       0.000416281427
  error estimate for blocks of size 2^( 4) =       0.000422775942
  error estimate for blocks of size 2^( 5) =       0.000426340723
  error estimate for blocks of size 2^( 6) =       0.000427428894
  error estimate for blocks of size 2^( 7) =       0.000429939383

      target function =                  N/A
              le_mean =     -17.216738764025
             les_mean =     296.732386676187
             stat err =       0.000426621236
             autocorr =       1.150866970345
              std dev =       0.562399471602
             le_variance =       0.316293165658

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316352828473
                                         uncertainty =       0.003158929684

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316352828473
                                         uncertainty =       0.003158929684

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397676480
  error estimate for blocks of size 2^( 2) =       0.000407427166
  error estimate for blocks of size 2^( 3) =       0.000416281427
  error estimate for blocks of size 2^( 4) =       0.000422775942
  error estimate for blocks of size 2^( 5) =       0.000426340723
  error estimate for blocks of size 2^( 6) =       0.000427428894
  error estimate for blocks of size 2^( 7) =       0.000429939383

      target function =                  N/A
              le_mean =     -17.216738764025
             les_mean =     296.732386676187
             stat err =       0.000426621236
             autocorr =       1.150866970345
              std dev =       0.562399471602
             le_variance =       0.316293165658

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316352828473
                                         uncertainty =       0.003158929684

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316352828473
                                         uncertainty =       0.003158929684

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397676480
  error estimate for blocks of size 2^( 2) =       0.000407427166
  error estimate for blocks of size 2^( 3) =       0.000416281427
  error estimate for blocks of size 2^( 4) =       0.000422775942
  error estimate for blocks of size 2^( 5) =       0.000426340723
  error estimate for blocks of size 2^( 6) =       0.000427428894
  error estimate for blocks of size 2^( 7) =       0.000429939383

      target function =                  N/A
              le_mean =     -17.216738764025
             les_mean =     296.732386676187
             stat err =       0.000426621236
             autocorr =       1.150866970345
              std dev =       0.562399471602
             le_variance =       0.316293165658

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316352828473
                                         uncertainty =       0.003158929684

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316352828473
                                         uncertainty =       0.003158929684

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397676480
  error estimate for blocks of size 2^( 2) =       0.000407427166
  error estimate for blocks of size 2^( 3) =       0.000416281427
  error estimate for blocks of size 2^( 4) =       0.000422775942
  error estimate for blocks of size 2^( 5) =       0.000426340723
  error estimate for blocks of size 2^( 6) =       0.000427428894
  error estimate for blocks of size 2^( 7) =       0.000429939383

      target function =                  N/A
              le_mean =     -17.216738764025
             les_mean =     296.732386676187
             stat err =       0.000426621236
             autocorr =       1.150866970345
              std dev =       0.562399471602
             le_variance =       0.316293165658


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216738764025        initial  <--
     9.5367e+16     9.5367e+17             0.0000e+00       -17.216738764025
     3.8147e+17     3.8147e+18             0.0000e+00       -17.216738764025
     1.5259e+18     1.5259e+19             0.0000e+00       -17.216738764025

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.7450
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 2.139838e-01 1 1  ON 0
 uu_1                 5.161576e-02 1 1  ON 1
 uu_2                -4.322282e-02 1 1  ON 2
 uu_3                -9.894209e-02 1 1  ON 3
 uu_4                -1.336901e-01 1 1  ON 4
 uu_5                -1.420466e-01 1 1  ON 5
 uu_6                -1.192323e-01 1 1  ON 6
 uu_7                -4.820395e-02 1 1  ON 7
 uu_8                 9.350219e-02 1 1  ON 8
 uu_9                 1.266982e-01 1 1  ON 9
 ud_0                 3.555341e-01 1 1  ON 10
 ud_1                 9.663141e-02 1 1  ON 11
 ud_2                -1.382622e-02 1 1  ON 12
 ud_3                -7.541758e-02 1 1  ON 13
 ud_4                -1.235462e-01 1 1  ON 14
 ud_5                -1.555396e-01 1 1  ON 15
 ud_6                -1.570129e-01 1 1  ON 16
 ud_7                -1.128658e-01 1 1  ON 17
 ud_8                -4.903523e-03 1 1  ON 18
 ud_9                 9.265698e-02 1 1  ON 19
 eO_0                -7.839991e-01 1 1  ON 20
 eO_1                -4.623314e-01 1 1  ON 21
 eO_2                -5.035171e-02 1 1  ON 22
 eO_3                 2.109431e-01 1 1  ON 23
 eO_4                 3.116683e-01 1 1  ON 24
 eO_5                 3.267629e-01 1 1  ON 25
 eO_6                 2.625848e-01 1 1  ON 26
 eO_7                 1.244874e-01 1 1  ON 27
 eO_8                 2.991524e-02 1 1  ON 28
 eO_9                 1.907788e-02 1 1  ON 29
eH1_0                -1.844666e-01 1 1  ON 30
eH1_1                -1.050123e-01 1 1  ON 31
eH1_2                -6.355517e-02 1 1  ON 32
eH1_3                -2.637151e-02 1 1  ON 33
eH1_4                 1.894519e-02 1 1  ON 34
eH1_5                 3.312163e-02 1 1  ON 35
eH1_6                 7.757990e-02 1 1  ON 36
eH1_7                 1.097468e-01 1 1  ON 37
eH1_8                 9.753129e-02 1 1  ON 38
eH1_9                 2.646936e-02 1 1  ON 39
eH2_0                -1.856684e-01 1 1  ON 40
eH2_1                -1.065185e-01 1 1  ON 41
eH2_2                -6.500339e-02 1 1  ON 42
eH2_3                -2.791096e-02 1 1  ON 43
eH2_4                 1.767064e-02 1 1  ON 44
eH2_5                 3.164242e-02 1 1  ON 45
eH2_6                 7.927520e-02 1 1  ON 46
eH2_7                 1.142069e-01 1 1  ON 47
eH2_8                 1.007142e-01 1 1  ON 48
eH2_9                 2.872899e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4463e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7215e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.1966
    reference variance = 0.130582
====================================================
  Execution time = 1.9948e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2756e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6252e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327630165197
                                         uncertainty =       0.005808403787

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327630165197
                                         uncertainty =       0.005808403787

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404699367
  error estimate for blocks of size 2^( 2) =       0.000413916902
  error estimate for blocks of size 2^( 3) =       0.000422346933
  error estimate for blocks of size 2^( 4) =       0.000428174924
  error estimate for blocks of size 2^( 5) =       0.000432692082
  error estimate for blocks of size 2^( 6) =       0.000433479864
  error estimate for blocks of size 2^( 7) =       0.000434223605

      target function =                  N/A
              le_mean =     -17.216616238393
             les_mean =     296.739437690902
             stat err =       0.000432142619
             autocorr =       1.140221300417
              std dev =       0.572331332885
             le_variance =       0.327563154602


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721661623839e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+17, overlap shift 9.5367e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216616238393       residual = 9.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216616238393       residual = 5.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216616238393       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216616238393       residual = 3.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216616238394       residual = 1.44e-02           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+17 is 1.119351e-22

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+18, overlap shift 3.8147e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216616238393       residual = 9.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216616238393       residual = 5.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216616238394       residual = 8.42e-01           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+18 is 2.798378e-23

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+19, overlap shift 1.5259e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216616238393       residual = 9.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216616238393       residual = 5.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216616238393       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216616238393       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+19 is 6.995946e-24

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.377326 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5579e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 2.139838e-01 1 1  ON 0
 uu_1                 5.161576e-02 1 1  ON 1
 uu_2                -4.322282e-02 1 1  ON 2
 uu_3                -9.894209e-02 1 1  ON 3
 uu_4                -1.336901e-01 1 1  ON 4
 uu_5                -1.420466e-01 1 1  ON 5
 uu_6                -1.192323e-01 1 1  ON 6
 uu_7                -4.820395e-02 1 1  ON 7
 uu_8                 9.350219e-02 1 1  ON 8
 uu_9                 1.266982e-01 1 1  ON 9
 ud_0                 3.555341e-01 1 1  ON 10
 ud_1                 9.663141e-02 1 1  ON 11
 ud_2                -1.382622e-02 1 1  ON 12
 ud_3                -7.541758e-02 1 1  ON 13
 ud_4                -1.235462e-01 1 1  ON 14
 ud_5                -1.555396e-01 1 1  ON 15
 ud_6                -1.570129e-01 1 1  ON 16
 ud_7                -1.128658e-01 1 1  ON 17
 ud_8                -4.903523e-03 1 1  ON 18
 ud_9                 9.265698e-02 1 1  ON 19
 eO_0                -7.839991e-01 1 1  ON 20
 eO_1                -4.623314e-01 1 1  ON 21
 eO_2                -5.035171e-02 1 1  ON 22
 eO_3                 2.109431e-01 1 1  ON 23
 eO_4                 3.116683e-01 1 1  ON 24
 eO_5                 3.267629e-01 1 1  ON 25
 eO_6                 2.625848e-01 1 1  ON 26
 eO_7                 1.244874e-01 1 1  ON 27
 eO_8                 2.991524e-02 1 1  ON 28
 eO_9                 1.907788e-02 1 1  ON 29
eH1_0                -1.844666e-01 1 1  ON 30
eH1_1                -1.050123e-01 1 1  ON 31
eH1_2                -6.355517e-02 1 1  ON 32
eH1_3                -2.637151e-02 1 1  ON 33
eH1_4                 1.894519e-02 1 1  ON 34
eH1_5                 3.312163e-02 1 1  ON 35
eH1_6                 7.757990e-02 1 1  ON 36
eH1_7                 1.097468e-01 1 1  ON 37
eH1_8                 9.753129e-02 1 1  ON 38
eH1_9                 2.646936e-02 1 1  ON 39
eH2_0                -1.856684e-01 1 1  ON 40
eH2_1                -1.065185e-01 1 1  ON 41
eH2_2                -6.500339e-02 1 1  ON 42
eH2_3                -2.791096e-02 1 1  ON 43
eH2_4                 1.767064e-02 1 1  ON 44
eH2_5                 3.164242e-02 1 1  ON 45
eH2_6                 7.927520e-02 1 1  ON 46
eH2_7                 1.142069e-01 1 1  ON 47
eH2_8                 1.007142e-01 1 1  ON 48
eH2_9                 2.872899e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.2317
    reference variance = 0.17821
====================================================
  Execution time = 1.9611e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1946e-01
  Total weights = 2.0000e+06
  Execution time = 1.8091e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319359364400
                                         uncertainty =       0.003345173431

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319359364400
                                         uncertainty =       0.003345173431

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399663639
  error estimate for blocks of size 2^( 2) =       0.000409298934
  error estimate for blocks of size 2^( 3) =       0.000418425427
  error estimate for blocks of size 2^( 4) =       0.000424625598
  error estimate for blocks of size 2^( 5) =       0.000427867980
  error estimate for blocks of size 2^( 6) =       0.000429251172
  error estimate for blocks of size 2^( 7) =       0.000430179485

      target function =                  N/A
              le_mean =     -17.216174459879
             les_mean =     296.716124921631
             stat err =       0.000427981059
             autocorr =       1.146726427711
              std dev =       0.565209738401
             le_variance =       0.319462048383

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319359364400
                                         uncertainty =       0.003345173431

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319359364400
                                         uncertainty =       0.003345173431

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399663639
  error estimate for blocks of size 2^( 2) =       0.000409298934
  error estimate for blocks of size 2^( 3) =       0.000418425427
  error estimate for blocks of size 2^( 4) =       0.000424625598
  error estimate for blocks of size 2^( 5) =       0.000427867980
  error estimate for blocks of size 2^( 6) =       0.000429251172
  error estimate for blocks of size 2^( 7) =       0.000430179485

      target function =                  N/A
              le_mean =     -17.216174459879
             les_mean =     296.716124921631
             stat err =       0.000427981059
             autocorr =       1.146726427711
              std dev =       0.565209738401
             le_variance =       0.319462048383

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319359364400
                                         uncertainty =       0.003345173431

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319359364400
                                         uncertainty =       0.003345173431

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399663639
  error estimate for blocks of size 2^( 2) =       0.000409298934
  error estimate for blocks of size 2^( 3) =       0.000418425427
  error estimate for blocks of size 2^( 4) =       0.000424625598
  error estimate for blocks of size 2^( 5) =       0.000427867980
  error estimate for blocks of size 2^( 6) =       0.000429251172
  error estimate for blocks of size 2^( 7) =       0.000430179485

      target function =                  N/A
              le_mean =     -17.216174459879
             les_mean =     296.716124921631
             stat err =       0.000427981059
             autocorr =       1.146726427711
              std dev =       0.565209738401
             le_variance =       0.319462048383

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319359364400
                                         uncertainty =       0.003345173431

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319359364400
                                         uncertainty =       0.003345173431

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399663639
  error estimate for blocks of size 2^( 2) =       0.000409298934
  error estimate for blocks of size 2^( 3) =       0.000418425427
  error estimate for blocks of size 2^( 4) =       0.000424625598
  error estimate for blocks of size 2^( 5) =       0.000427867980
  error estimate for blocks of size 2^( 6) =       0.000429251172
  error estimate for blocks of size 2^( 7) =       0.000430179485

      target function =                  N/A
              le_mean =     -17.216174459879
             les_mean =     296.716124921631
             stat err =       0.000427981059
             autocorr =       1.146726427711
              std dev =       0.565209738401
             le_variance =       0.319462048383


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216174459879        initial  <--
     9.5367e+17     9.5367e+18             1.1194e-22       -17.216174459879
     3.8147e+18     3.8147e+19             2.7984e-23       -17.216174459879
     1.5259e+19     1.5259e+20             6.9959e-24       -17.216174459879

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.7648
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 2.139838e-01 1 1  ON 0
 uu_1                 5.161576e-02 1 1  ON 1
 uu_2                -4.322282e-02 1 1  ON 2
 uu_3                -9.894209e-02 1 1  ON 3
 uu_4                -1.336901e-01 1 1  ON 4
 uu_5                -1.420466e-01 1 1  ON 5
 uu_6                -1.192323e-01 1 1  ON 6
 uu_7                -4.820395e-02 1 1  ON 7
 uu_8                 9.350219e-02 1 1  ON 8
 uu_9                 1.266982e-01 1 1  ON 9
 ud_0                 3.555341e-01 1 1  ON 10
 ud_1                 9.663141e-02 1 1  ON 11
 ud_2                -1.382622e-02 1 1  ON 12
 ud_3                -7.541758e-02 1 1  ON 13
 ud_4                -1.235462e-01 1 1  ON 14
 ud_5                -1.555396e-01 1 1  ON 15
 ud_6                -1.570129e-01 1 1  ON 16
 ud_7                -1.128658e-01 1 1  ON 17
 ud_8                -4.903523e-03 1 1  ON 18
 ud_9                 9.265698e-02 1 1  ON 19
 eO_0                -7.839991e-01 1 1  ON 20
 eO_1                -4.623314e-01 1 1  ON 21
 eO_2                -5.035171e-02 1 1  ON 22
 eO_3                 2.109431e-01 1 1  ON 23
 eO_4                 3.116683e-01 1 1  ON 24
 eO_5                 3.267629e-01 1 1  ON 25
 eO_6                 2.625848e-01 1 1  ON 26
 eO_7                 1.244874e-01 1 1  ON 27
 eO_8                 2.991524e-02 1 1  ON 28
 eO_9                 1.907788e-02 1 1  ON 29
eH1_0                -1.844666e-01 1 1  ON 30
eH1_1                -1.050123e-01 1 1  ON 31
eH1_2                -6.355517e-02 1 1  ON 32
eH1_3                -2.637151e-02 1 1  ON 33
eH1_4                 1.894519e-02 1 1  ON 34
eH1_5                 3.312163e-02 1 1  ON 35
eH1_6                 7.757990e-02 1 1  ON 36
eH1_7                 1.097468e-01 1 1  ON 37
eH1_8                 9.753129e-02 1 1  ON 38
eH1_9                 2.646936e-02 1 1  ON 39
eH2_0                -1.856684e-01 1 1  ON 40
eH2_1                -1.065185e-01 1 1  ON 41
eH2_2                -6.500339e-02 1 1  ON 42
eH2_3                -2.791096e-02 1 1  ON 43
eH2_4                 1.767064e-02 1 1  ON 44
eH2_5                 3.164242e-02 1 1  ON 45
eH2_6                 7.927520e-02 1 1  ON 46
eH2_7                 1.142069e-01 1 1  ON 47
eH2_8                 1.007142e-01 1 1  ON 48
eH2_9                 2.872899e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4350e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7215e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.1332
    reference variance = 0.202858
====================================================
  Execution time = 2.0219e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.3644e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5385e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336492981464
                                         uncertainty =       0.016468195703

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336492981464
                                         uncertainty =       0.016468195703

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410144297
  error estimate for blocks of size 2^( 2) =       0.000419709178
  error estimate for blocks of size 2^( 3) =       0.000428497080
  error estimate for blocks of size 2^( 4) =       0.000434633904
  error estimate for blocks of size 2^( 5) =       0.000438585121
  error estimate for blocks of size 2^( 6) =       0.000439774417
  error estimate for blocks of size 2^( 7) =       0.000441298272

      target function =                  N/A
              le_mean =     -17.216872187993
             les_mean =     296.757124457844
             stat err =       0.000438572928
             autocorr =       1.143431856237
              std dev =       0.580031627046
             le_variance =       0.336436688374


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721687218799e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+18, overlap shift 9.5367e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216872187993       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216872187993       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+19, overlap shift 3.8147e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216872187993       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216872187993       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+20, overlap shift 1.5259e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216872187993       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216872187993       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.378426 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5764e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 2.139838e-01 1 1  ON 0
 uu_1                 5.161576e-02 1 1  ON 1
 uu_2                -4.322282e-02 1 1  ON 2
 uu_3                -9.894209e-02 1 1  ON 3
 uu_4                -1.336901e-01 1 1  ON 4
 uu_5                -1.420466e-01 1 1  ON 5
 uu_6                -1.192323e-01 1 1  ON 6
 uu_7                -4.820395e-02 1 1  ON 7
 uu_8                 9.350219e-02 1 1  ON 8
 uu_9                 1.266982e-01 1 1  ON 9
 ud_0                 3.555341e-01 1 1  ON 10
 ud_1                 9.663141e-02 1 1  ON 11
 ud_2                -1.382622e-02 1 1  ON 12
 ud_3                -7.541758e-02 1 1  ON 13
 ud_4                -1.235462e-01 1 1  ON 14
 ud_5                -1.555396e-01 1 1  ON 15
 ud_6                -1.570129e-01 1 1  ON 16
 ud_7                -1.128658e-01 1 1  ON 17
 ud_8                -4.903523e-03 1 1  ON 18
 ud_9                 9.265698e-02 1 1  ON 19
 eO_0                -7.839991e-01 1 1  ON 20
 eO_1                -4.623314e-01 1 1  ON 21
 eO_2                -5.035171e-02 1 1  ON 22
 eO_3                 2.109431e-01 1 1  ON 23
 eO_4                 3.116683e-01 1 1  ON 24
 eO_5                 3.267629e-01 1 1  ON 25
 eO_6                 2.625848e-01 1 1  ON 26
 eO_7                 1.244874e-01 1 1  ON 27
 eO_8                 2.991524e-02 1 1  ON 28
 eO_9                 1.907788e-02 1 1  ON 29
eH1_0                -1.844666e-01 1 1  ON 30
eH1_1                -1.050123e-01 1 1  ON 31
eH1_2                -6.355517e-02 1 1  ON 32
eH1_3                -2.637151e-02 1 1  ON 33
eH1_4                 1.894519e-02 1 1  ON 34
eH1_5                 3.312163e-02 1 1  ON 35
eH1_6                 7.757990e-02 1 1  ON 36
eH1_7                 1.097468e-01 1 1  ON 37
eH1_8                 9.753129e-02 1 1  ON 38
eH1_9                 2.646936e-02 1 1  ON 39
eH2_0                -1.856684e-01 1 1  ON 40
eH2_1                -1.065185e-01 1 1  ON 41
eH2_2                -6.500339e-02 1 1  ON 42
eH2_3                -2.791096e-02 1 1  ON 43
eH2_4                 1.767064e-02 1 1  ON 44
eH2_5                 3.164242e-02 1 1  ON 45
eH2_6                 7.927520e-02 1 1  ON 46
eH2_7                 1.142069e-01 1 1  ON 47
eH2_8                 1.007142e-01 1 1  ON 48
eH2_9                 2.872899e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.2057
    reference variance = 0.184518
====================================================
  Execution time = 1.9861e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2501e-01
  Total weights = 2.0000e+06
  Execution time = 1.8263e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325164951309
                                         uncertainty =       0.006797522054

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325164951309
                                         uncertainty =       0.006797522054

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403117613
  error estimate for blocks of size 2^( 2) =       0.000412729336
  error estimate for blocks of size 2^( 3) =       0.000421328901
  error estimate for blocks of size 2^( 4) =       0.000428251928
  error estimate for blocks of size 2^( 5) =       0.000432457548
  error estimate for blocks of size 2^( 6) =       0.000434148346
  error estimate for blocks of size 2^( 7) =       0.000436109366

      target function =                  N/A
              le_mean =     -17.216383131762
             les_mean =     296.728855596830
             stat err =       0.000432741797
             autocorr =       1.152375830508
              std dev =       0.570094395430
             le_variance =       0.325007619701

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325164951309
                                         uncertainty =       0.006797522054

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325164951309
                                         uncertainty =       0.006797522054

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403117613
  error estimate for blocks of size 2^( 2) =       0.000412729336
  error estimate for blocks of size 2^( 3) =       0.000421328901
  error estimate for blocks of size 2^( 4) =       0.000428251928
  error estimate for blocks of size 2^( 5) =       0.000432457548
  error estimate for blocks of size 2^( 6) =       0.000434148346
  error estimate for blocks of size 2^( 7) =       0.000436109366

      target function =                  N/A
              le_mean =     -17.216383131762
             les_mean =     296.728855596830
             stat err =       0.000432741797
             autocorr =       1.152375830508
              std dev =       0.570094395430
             le_variance =       0.325007619701

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325164951309
                                         uncertainty =       0.006797522054

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325164951309
                                         uncertainty =       0.006797522054

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403117613
  error estimate for blocks of size 2^( 2) =       0.000412729336
  error estimate for blocks of size 2^( 3) =       0.000421328901
  error estimate for blocks of size 2^( 4) =       0.000428251928
  error estimate for blocks of size 2^( 5) =       0.000432457548
  error estimate for blocks of size 2^( 6) =       0.000434148346
  error estimate for blocks of size 2^( 7) =       0.000436109366

      target function =                  N/A
              le_mean =     -17.216383131762
             les_mean =     296.728855596830
             stat err =       0.000432741797
             autocorr =       1.152375830508
              std dev =       0.570094395430
             le_variance =       0.325007619701

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325164951309
                                         uncertainty =       0.006797522054

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325164951309
                                         uncertainty =       0.006797522054

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403117613
  error estimate for blocks of size 2^( 2) =       0.000412729336
  error estimate for blocks of size 2^( 3) =       0.000421328901
  error estimate for blocks of size 2^( 4) =       0.000428251928
  error estimate for blocks of size 2^( 5) =       0.000432457548
  error estimate for blocks of size 2^( 6) =       0.000434148346
  error estimate for blocks of size 2^( 7) =       0.000436109366

      target function =                  N/A
              le_mean =     -17.216383131762
             les_mean =     296.728855596830
             stat err =       0.000432741797
             autocorr =       1.152375830508
              std dev =       0.570094395430
             le_variance =       0.325007619701


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216383131762        initial  <--
     9.5367e+18     9.5367e+19             0.0000e+00       -17.216383131762
     3.8147e+19     3.8147e+20             0.0000e+00       -17.216383131762
     1.5259e+20     1.5259e+21             0.0000e+00       -17.216383131762

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.0262
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 2.139838e-01 1 1  ON 0
 uu_1                 5.161576e-02 1 1  ON 1
 uu_2                -4.322282e-02 1 1  ON 2
 uu_3                -9.894209e-02 1 1  ON 3
 uu_4                -1.336901e-01 1 1  ON 4
 uu_5                -1.420466e-01 1 1  ON 5
 uu_6                -1.192323e-01 1 1  ON 6
 uu_7                -4.820395e-02 1 1  ON 7
 uu_8                 9.350219e-02 1 1  ON 8
 uu_9                 1.266982e-01 1 1  ON 9
 ud_0                 3.555341e-01 1 1  ON 10
 ud_1                 9.663141e-02 1 1  ON 11
 ud_2                -1.382622e-02 1 1  ON 12
 ud_3                -7.541758e-02 1 1  ON 13
 ud_4                -1.235462e-01 1 1  ON 14
 ud_5                -1.555396e-01 1 1  ON 15
 ud_6                -1.570129e-01 1 1  ON 16
 ud_7                -1.128658e-01 1 1  ON 17
 ud_8                -4.903523e-03 1 1  ON 18
 ud_9                 9.265698e-02 1 1  ON 19
 eO_0                -7.839991e-01 1 1  ON 20
 eO_1                -4.623314e-01 1 1  ON 21
 eO_2                -5.035171e-02 1 1  ON 22
 eO_3                 2.109431e-01 1 1  ON 23
 eO_4                 3.116683e-01 1 1  ON 24
 eO_5                 3.267629e-01 1 1  ON 25
 eO_6                 2.625848e-01 1 1  ON 26
 eO_7                 1.244874e-01 1 1  ON 27
 eO_8                 2.991524e-02 1 1  ON 28
 eO_9                 1.907788e-02 1 1  ON 29
eH1_0                -1.844666e-01 1 1  ON 30
eH1_1                -1.050123e-01 1 1  ON 31
eH1_2                -6.355517e-02 1 1  ON 32
eH1_3                -2.637151e-02 1 1  ON 33
eH1_4                 1.894519e-02 1 1  ON 34
eH1_5                 3.312163e-02 1 1  ON 35
eH1_6                 7.757990e-02 1 1  ON 36
eH1_7                 1.097468e-01 1 1  ON 37
eH1_8                 9.753129e-02 1 1  ON 38
eH1_9                 2.646936e-02 1 1  ON 39
eH2_0                -1.856684e-01 1 1  ON 40
eH2_1                -1.065185e-01 1 1  ON 41
eH2_2                -6.500339e-02 1 1  ON 42
eH2_3                -2.791096e-02 1 1  ON 43
eH2_4                 1.767064e-02 1 1  ON 44
eH2_5                 3.164242e-02 1 1  ON 45
eH2_6                 7.927520e-02 1 1  ON 46
eH2_7                 1.142069e-01 1 1  ON 47
eH2_8                 1.007142e-01 1 1  ON 48
eH2_9                 2.872899e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4798e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.1007
    reference variance = 1.29549
====================================================
  Execution time = 1.9986e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1744e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5206e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317352596534
                                         uncertainty =       0.004063461605

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317352596534
                                         uncertainty =       0.004063461605

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398395846
  error estimate for blocks of size 2^( 2) =       0.000408280431
  error estimate for blocks of size 2^( 3) =       0.000416876041
  error estimate for blocks of size 2^( 4) =       0.000423543050
  error estimate for blocks of size 2^( 5) =       0.000427638373
  error estimate for blocks of size 2^( 6) =       0.000430492320
  error estimate for blocks of size 2^( 7) =       0.000431297100

      target function =                  N/A
              le_mean =     -17.216598903700
             les_mean =     296.728716152333
             stat err =       0.000428242711
             autocorr =       1.155447869266
              std dev =       0.563416808558
             le_variance =       0.317438500166


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721659890370e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+19, overlap shift 9.5367e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216598903700       residual = 4.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216598903700       residual = 4.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+20, overlap shift 3.8147e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216598903700       residual = 4.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216598903700       residual = 4.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+21, overlap shift 1.5259e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216598903700       residual = 4.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216598903700       residual = 4.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.379473 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5512e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 2.139838e-01 1 1  ON 0
 uu_1                 5.161576e-02 1 1  ON 1
 uu_2                -4.322282e-02 1 1  ON 2
 uu_3                -9.894209e-02 1 1  ON 3
 uu_4                -1.336901e-01 1 1  ON 4
 uu_5                -1.420466e-01 1 1  ON 5
 uu_6                -1.192323e-01 1 1  ON 6
 uu_7                -4.820395e-02 1 1  ON 7
 uu_8                 9.350219e-02 1 1  ON 8
 uu_9                 1.266982e-01 1 1  ON 9
 ud_0                 3.555341e-01 1 1  ON 10
 ud_1                 9.663141e-02 1 1  ON 11
 ud_2                -1.382622e-02 1 1  ON 12
 ud_3                -7.541758e-02 1 1  ON 13
 ud_4                -1.235462e-01 1 1  ON 14
 ud_5                -1.555396e-01 1 1  ON 15
 ud_6                -1.570129e-01 1 1  ON 16
 ud_7                -1.128658e-01 1 1  ON 17
 ud_8                -4.903523e-03 1 1  ON 18
 ud_9                 9.265698e-02 1 1  ON 19
 eO_0                -7.839991e-01 1 1  ON 20
 eO_1                -4.623314e-01 1 1  ON 21
 eO_2                -5.035171e-02 1 1  ON 22
 eO_3                 2.109431e-01 1 1  ON 23
 eO_4                 3.116683e-01 1 1  ON 24
 eO_5                 3.267629e-01 1 1  ON 25
 eO_6                 2.625848e-01 1 1  ON 26
 eO_7                 1.244874e-01 1 1  ON 27
 eO_8                 2.991524e-02 1 1  ON 28
 eO_9                 1.907788e-02 1 1  ON 29
eH1_0                -1.844666e-01 1 1  ON 30
eH1_1                -1.050123e-01 1 1  ON 31
eH1_2                -6.355517e-02 1 1  ON 32
eH1_3                -2.637151e-02 1 1  ON 33
eH1_4                 1.894519e-02 1 1  ON 34
eH1_5                 3.312163e-02 1 1  ON 35
eH1_6                 7.757990e-02 1 1  ON 36
eH1_7                 1.097468e-01 1 1  ON 37
eH1_8                 9.753129e-02 1 1  ON 38
eH1_9                 2.646936e-02 1 1  ON 39
eH2_0                -1.856684e-01 1 1  ON 40
eH2_1                -1.065185e-01 1 1  ON 41
eH2_2                -6.500339e-02 1 1  ON 42
eH2_3                -2.791096e-02 1 1  ON 43
eH2_4                 1.767064e-02 1 1  ON 44
eH2_5                 3.164242e-02 1 1  ON 45
eH2_6                 7.927520e-02 1 1  ON 46
eH2_7                 1.142069e-01 1 1  ON 47
eH2_8                 1.007142e-01 1 1  ON 48
eH2_9                 2.872899e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.2787
    reference variance = 0.240412
====================================================
  Execution time = 1.9870e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2353e-01
  Total weights = 2.0000e+06
  Execution time = 1.8163e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323481908179
                                         uncertainty =       0.006319778813

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323481908179
                                         uncertainty =       0.006319778813

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402200317
  error estimate for blocks of size 2^( 2) =       0.000411728491
  error estimate for blocks of size 2^( 3) =       0.000420254197
  error estimate for blocks of size 2^( 4) =       0.000425780562
  error estimate for blocks of size 2^( 5) =       0.000429454791
  error estimate for blocks of size 2^( 6) =       0.000431428833
  error estimate for blocks of size 2^( 7) =       0.000432013265

      target function =                  N/A
              le_mean =     -17.216203603749
             les_mean =     296.721196554232
             stat err =       0.000429669363
             autocorr =       1.141258323461
              std dev =       0.568797143316
             le_variance =       0.323530190244

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323481908179
                                         uncertainty =       0.006319778813

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323481908179
                                         uncertainty =       0.006319778813

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402200317
  error estimate for blocks of size 2^( 2) =       0.000411728491
  error estimate for blocks of size 2^( 3) =       0.000420254197
  error estimate for blocks of size 2^( 4) =       0.000425780562
  error estimate for blocks of size 2^( 5) =       0.000429454791
  error estimate for blocks of size 2^( 6) =       0.000431428833
  error estimate for blocks of size 2^( 7) =       0.000432013265

      target function =                  N/A
              le_mean =     -17.216203603749
             les_mean =     296.721196554232
             stat err =       0.000429669363
             autocorr =       1.141258323461
              std dev =       0.568797143316
             le_variance =       0.323530190244

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323481908179
                                         uncertainty =       0.006319778813

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323481908179
                                         uncertainty =       0.006319778813

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402200317
  error estimate for blocks of size 2^( 2) =       0.000411728491
  error estimate for blocks of size 2^( 3) =       0.000420254197
  error estimate for blocks of size 2^( 4) =       0.000425780562
  error estimate for blocks of size 2^( 5) =       0.000429454791
  error estimate for blocks of size 2^( 6) =       0.000431428833
  error estimate for blocks of size 2^( 7) =       0.000432013265

      target function =                  N/A
              le_mean =     -17.216203603749
             les_mean =     296.721196554232
             stat err =       0.000429669363
             autocorr =       1.141258323461
              std dev =       0.568797143316
             le_variance =       0.323530190244

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323481908179
                                         uncertainty =       0.006319778813

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323481908179
                                         uncertainty =       0.006319778813

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402200317
  error estimate for blocks of size 2^( 2) =       0.000411728491
  error estimate for blocks of size 2^( 3) =       0.000420254197
  error estimate for blocks of size 2^( 4) =       0.000425780562
  error estimate for blocks of size 2^( 5) =       0.000429454791
  error estimate for blocks of size 2^( 6) =       0.000431428833
  error estimate for blocks of size 2^( 7) =       0.000432013265

      target function =                  N/A
              le_mean =     -17.216203603749
             les_mean =     296.721196554232
             stat err =       0.000429669363
             autocorr =       1.141258323461
              std dev =       0.568797143316
             le_variance =       0.323530190244


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216203603749        initial  <--
     9.5367e+19     9.5367e+20             0.0000e+00       -17.216203603749
     3.8147e+20     3.8147e+21             0.0000e+00       -17.216203603749
     1.5259e+21     1.5259e+22             0.0000e+00       -17.216203603749

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.9890
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 2.139838e-01 1 1  ON 0
 uu_1                 5.161576e-02 1 1  ON 1
 uu_2                -4.322282e-02 1 1  ON 2
 uu_3                -9.894209e-02 1 1  ON 3
 uu_4                -1.336901e-01 1 1  ON 4
 uu_5                -1.420466e-01 1 1  ON 5
 uu_6                -1.192323e-01 1 1  ON 6
 uu_7                -4.820395e-02 1 1  ON 7
 uu_8                 9.350219e-02 1 1  ON 8
 uu_9                 1.266982e-01 1 1  ON 9
 ud_0                 3.555341e-01 1 1  ON 10
 ud_1                 9.663141e-02 1 1  ON 11
 ud_2                -1.382622e-02 1 1  ON 12
 ud_3                -7.541758e-02 1 1  ON 13
 ud_4                -1.235462e-01 1 1  ON 14
 ud_5                -1.555396e-01 1 1  ON 15
 ud_6                -1.570129e-01 1 1  ON 16
 ud_7                -1.128658e-01 1 1  ON 17
 ud_8                -4.903523e-03 1 1  ON 18
 ud_9                 9.265698e-02 1 1  ON 19
 eO_0                -7.839991e-01 1 1  ON 20
 eO_1                -4.623314e-01 1 1  ON 21
 eO_2                -5.035171e-02 1 1  ON 22
 eO_3                 2.109431e-01 1 1  ON 23
 eO_4                 3.116683e-01 1 1  ON 24
 eO_5                 3.267629e-01 1 1  ON 25
 eO_6                 2.625848e-01 1 1  ON 26
 eO_7                 1.244874e-01 1 1  ON 27
 eO_8                 2.991524e-02 1 1  ON 28
 eO_9                 1.907788e-02 1 1  ON 29
eH1_0                -1.844666e-01 1 1  ON 30
eH1_1                -1.050123e-01 1 1  ON 31
eH1_2                -6.355517e-02 1 1  ON 32
eH1_3                -2.637151e-02 1 1  ON 33
eH1_4                 1.894519e-02 1 1  ON 34
eH1_5                 3.312163e-02 1 1  ON 35
eH1_6                 7.757990e-02 1 1  ON 36
eH1_7                 1.097468e-01 1 1  ON 37
eH1_8                 9.753129e-02 1 1  ON 38
eH1_9                 2.646936e-02 1 1  ON 39
eH2_0                -1.856684e-01 1 1  ON 40
eH2_1                -1.065185e-01 1 1  ON 41
eH2_2                -6.500339e-02 1 1  ON 42
eH2_3                -2.791096e-02 1 1  ON 43
eH2_4                 1.767064e-02 1 1  ON 44
eH2_5                 3.164242e-02 1 1  ON 45
eH2_6                 7.927520e-02 1 1  ON 46
eH2_7                 1.142069e-01 1 1  ON 47
eH2_8                 1.007142e-01 1 1  ON 48
eH2_9                 2.872899e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4507e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.1931
    reference variance = 0.322687
====================================================
  Execution time = 1.9967e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1854e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4544e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318609813666
                                         uncertainty =       0.003449687335

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318609813666
                                         uncertainty =       0.003449687335

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399086479
  error estimate for blocks of size 2^( 2) =       0.000407913338
  error estimate for blocks of size 2^( 3) =       0.000416335444
  error estimate for blocks of size 2^( 4) =       0.000421850608
  error estimate for blocks of size 2^( 5) =       0.000426532222
  error estimate for blocks of size 2^( 6) =       0.000428376274
  error estimate for blocks of size 2^( 7) =       0.000429422703

      target function =                  N/A
              le_mean =     -17.216167676043
             les_mean =     296.714969325527
             stat err =       0.000426545452
             autocorr =       1.142343206634
              std dev =       0.564393510936
             le_variance =       0.318540035186


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721616767604e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+20, overlap shift 9.5367e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216167676043       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216167676043       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216167676043       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+20 is 3.335879e-26

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+21, overlap shift 3.8147e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216167676043       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216167676043       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216167676043       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+21 is 8.339698e-27

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+22, overlap shift 1.5259e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216167676043       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216167676043       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216167676043       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+22 is 2.084925e-27

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.380829 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5427e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 2.139838e-01 1 1  ON 0
 uu_1                 5.161576e-02 1 1  ON 1
 uu_2                -4.322282e-02 1 1  ON 2
 uu_3                -9.894209e-02 1 1  ON 3
 uu_4                -1.336901e-01 1 1  ON 4
 uu_5                -1.420466e-01 1 1  ON 5
 uu_6                -1.192323e-01 1 1  ON 6
 uu_7                -4.820395e-02 1 1  ON 7
 uu_8                 9.350219e-02 1 1  ON 8
 uu_9                 1.266982e-01 1 1  ON 9
 ud_0                 3.555341e-01 1 1  ON 10
 ud_1                 9.663141e-02 1 1  ON 11
 ud_2                -1.382622e-02 1 1  ON 12
 ud_3                -7.541758e-02 1 1  ON 13
 ud_4                -1.235462e-01 1 1  ON 14
 ud_5                -1.555396e-01 1 1  ON 15
 ud_6                -1.570129e-01 1 1  ON 16
 ud_7                -1.128658e-01 1 1  ON 17
 ud_8                -4.903523e-03 1 1  ON 18
 ud_9                 9.265698e-02 1 1  ON 19
 eO_0                -7.839991e-01 1 1  ON 20
 eO_1                -4.623314e-01 1 1  ON 21
 eO_2                -5.035171e-02 1 1  ON 22
 eO_3                 2.109431e-01 1 1  ON 23
 eO_4                 3.116683e-01 1 1  ON 24
 eO_5                 3.267629e-01 1 1  ON 25
 eO_6                 2.625848e-01 1 1  ON 26
 eO_7                 1.244874e-01 1 1  ON 27
 eO_8                 2.991524e-02 1 1  ON 28
 eO_9                 1.907788e-02 1 1  ON 29
eH1_0                -1.844666e-01 1 1  ON 30
eH1_1                -1.050123e-01 1 1  ON 31
eH1_2                -6.355517e-02 1 1  ON 32
eH1_3                -2.637151e-02 1 1  ON 33
eH1_4                 1.894519e-02 1 1  ON 34
eH1_5                 3.312163e-02 1 1  ON 35
eH1_6                 7.757990e-02 1 1  ON 36
eH1_7                 1.097468e-01 1 1  ON 37
eH1_8                 9.753129e-02 1 1  ON 38
eH1_9                 2.646936e-02 1 1  ON 39
eH2_0                -1.856684e-01 1 1  ON 40
eH2_1                -1.065185e-01 1 1  ON 41
eH2_2                -6.500339e-02 1 1  ON 42
eH2_3                -2.791096e-02 1 1  ON 43
eH2_4                 1.767064e-02 1 1  ON 44
eH2_5                 3.164242e-02 1 1  ON 45
eH2_6                 7.927520e-02 1 1  ON 46
eH2_7                 1.142069e-01 1 1  ON 47
eH2_8                 1.007142e-01 1 1  ON 48
eH2_9                 2.872899e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.2026
    reference variance = 0.437796
====================================================
  Execution time = 2.1801e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1483e-01
  Total weights = 2.0000e+06
  Execution time = 1.8206e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314918743109
                                         uncertainty =       0.002763950879

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314918743109
                                         uncertainty =       0.002763950879

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396757675
  error estimate for blocks of size 2^( 2) =       0.000406808114
  error estimate for blocks of size 2^( 3) =       0.000415396604
  error estimate for blocks of size 2^( 4) =       0.000421765121
  error estimate for blocks of size 2^( 5) =       0.000425634050
  error estimate for blocks of size 2^( 6) =       0.000428505660
  error estimate for blocks of size 2^( 7) =       0.000429068057

      target function =                  N/A
              le_mean =     -17.216598361723
             les_mean =     296.726092296613
             stat err =       0.000426243222
             autocorr =       1.154155429446
              std dev =       0.561100084793
             le_variance =       0.314833305154

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314918743109
                                         uncertainty =       0.002763950879

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314918743109
                                         uncertainty =       0.002763950879

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396757675
  error estimate for blocks of size 2^( 2) =       0.000406808114
  error estimate for blocks of size 2^( 3) =       0.000415396604
  error estimate for blocks of size 2^( 4) =       0.000421765121
  error estimate for blocks of size 2^( 5) =       0.000425634050
  error estimate for blocks of size 2^( 6) =       0.000428505660
  error estimate for blocks of size 2^( 7) =       0.000429068057

      target function =                  N/A
              le_mean =     -17.216598361723
             les_mean =     296.726092296613
             stat err =       0.000426243222
             autocorr =       1.154155429446
              std dev =       0.561100084793
             le_variance =       0.314833305154

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314918743109
                                         uncertainty =       0.002763950879

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314918743109
                                         uncertainty =       0.002763950879

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396757675
  error estimate for blocks of size 2^( 2) =       0.000406808114
  error estimate for blocks of size 2^( 3) =       0.000415396604
  error estimate for blocks of size 2^( 4) =       0.000421765121
  error estimate for blocks of size 2^( 5) =       0.000425634050
  error estimate for blocks of size 2^( 6) =       0.000428505660
  error estimate for blocks of size 2^( 7) =       0.000429068057

      target function =                  N/A
              le_mean =     -17.216598361723
             les_mean =     296.726092296613
             stat err =       0.000426243222
             autocorr =       1.154155429446
              std dev =       0.561100084793
             le_variance =       0.314833305154

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314918743109
                                         uncertainty =       0.002763950879

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314918743109
                                         uncertainty =       0.002763950879

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396757675
  error estimate for blocks of size 2^( 2) =       0.000406808114
  error estimate for blocks of size 2^( 3) =       0.000415396604
  error estimate for blocks of size 2^( 4) =       0.000421765121
  error estimate for blocks of size 2^( 5) =       0.000425634050
  error estimate for blocks of size 2^( 6) =       0.000428505660
  error estimate for blocks of size 2^( 7) =       0.000429068057

      target function =                  N/A
              le_mean =     -17.216598361723
             les_mean =     296.726092296613
             stat err =       0.000426243222
             autocorr =       1.154155429446
              std dev =       0.561100084793
             le_variance =       0.314833305154


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216598361723        initial  <--
     9.5367e+20     9.5367e+21             3.3359e-26       -17.216598361723
     3.8147e+21     3.8147e+22             8.3397e-27       -17.216598361723
     1.5259e+22     1.5259e+23             2.0849e-27       -17.216598361723

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.9353
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 2.139838e-01 1 1  ON 0
 uu_1                 5.161576e-02 1 1  ON 1
 uu_2                -4.322282e-02 1 1  ON 2
 uu_3                -9.894209e-02 1 1  ON 3
 uu_4                -1.336901e-01 1 1  ON 4
 uu_5                -1.420466e-01 1 1  ON 5
 uu_6                -1.192323e-01 1 1  ON 6
 uu_7                -4.820395e-02 1 1  ON 7
 uu_8                 9.350219e-02 1 1  ON 8
 uu_9                 1.266982e-01 1 1  ON 9
 ud_0                 3.555341e-01 1 1  ON 10
 ud_1                 9.663141e-02 1 1  ON 11
 ud_2                -1.382622e-02 1 1  ON 12
 ud_3                -7.541758e-02 1 1  ON 13
 ud_4                -1.235462e-01 1 1  ON 14
 ud_5                -1.555396e-01 1 1  ON 15
 ud_6                -1.570129e-01 1 1  ON 16
 ud_7                -1.128658e-01 1 1  ON 17
 ud_8                -4.903523e-03 1 1  ON 18
 ud_9                 9.265698e-02 1 1  ON 19
 eO_0                -7.839991e-01 1 1  ON 20
 eO_1                -4.623314e-01 1 1  ON 21
 eO_2                -5.035171e-02 1 1  ON 22
 eO_3                 2.109431e-01 1 1  ON 23
 eO_4                 3.116683e-01 1 1  ON 24
 eO_5                 3.267629e-01 1 1  ON 25
 eO_6                 2.625848e-01 1 1  ON 26
 eO_7                 1.244874e-01 1 1  ON 27
 eO_8                 2.991524e-02 1 1  ON 28
 eO_9                 1.907788e-02 1 1  ON 29
eH1_0                -1.844666e-01 1 1  ON 30
eH1_1                -1.050123e-01 1 1  ON 31
eH1_2                -6.355517e-02 1 1  ON 32
eH1_3                -2.637151e-02 1 1  ON 33
eH1_4                 1.894519e-02 1 1  ON 34
eH1_5                 3.312163e-02 1 1  ON 35
eH1_6                 7.757990e-02 1 1  ON 36
eH1_7                 1.097468e-01 1 1  ON 37
eH1_8                 9.753129e-02 1 1  ON 38
eH1_9                 2.646936e-02 1 1  ON 39
eH2_0                -1.856684e-01 1 1  ON 40
eH2_1                -1.065185e-01 1 1  ON 41
eH2_2                -6.500339e-02 1 1  ON 42
eH2_3                -2.791096e-02 1 1  ON 43
eH2_4                 1.767064e-02 1 1  ON 44
eH2_5                 3.164242e-02 1 1  ON 45
eH2_6                 7.927520e-02 1 1  ON 46
eH2_7                 1.142069e-01 1 1  ON 47
eH2_8                 1.007142e-01 1 1  ON 48
eH2_9                 2.872899e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6367e+01 secs
  Total Execution time = 2.2236e+03 secs

=========================================================
  A new xml input file : H2O.s039.cont.xml
